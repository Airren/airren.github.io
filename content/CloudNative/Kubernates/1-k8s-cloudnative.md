---
title: K8s Cloud Native

---

Kubenetesç”Ÿäº§è½åœ°å…¨ç¨‹å®è·µ



æ ¸å¿ƒæ¦‚å¿µ

æ¶æ„è®¾è®¡

è®¤è¯æˆæƒ

é«˜å¯ç”¨é›†ç¾¤æ­å»º

äºŒè¿›åˆ¶& kubeadm



3å°masterä¸¤å°2 node



calicoã€corednsã€dashboard

ä¸šåŠ¡è¿ç§»åˆ°Kubenetes

Harbor

æœåŠ¡å‘ç°ç­–ç•¥

IngressNginx

Docker åŒ–æœåŠ¡ã€K8sã€æœåŠ¡å‘ç°

CICD



namespaceã€resourcesã€label



æœåŠ¡çš„è°ƒåº¦ä¸ç¼–æ’

å¥åº·æ£€æŸ¥

è°ƒåº¦ç­–ç•¥

éƒ¨ç½²ç­–ç•¥

æ—¥å¿—ä¸ç›‘æ§





## ç¬¬2ç«  kuberneteså¿«é€Ÿå…¥é—¨

æœ¬ç« ä¸­å°†ä»æ ¸å¿ƒæ¦‚å¿µã€æ¶æ„è®¾è®¡ã€è®¤è¯æˆæƒä»¥åŠé›†ç¾¤æ­å»ºæ–¹æ¡ˆå¯¹æ¯”å‡ æ–¹é¢ï¼Œå¸¦é¢†å¤§å®¶å¿«é€ŸæŒæ¡kubernetesçš„é‡è¦çŸ¥è¯†ç‚¹ï¼ŒåŠ©åŠ›å¿«é€Ÿå…¥é—¨ã€‚



### 2-1 äº†è§£kubernetes 

èˆµæ‰‹ï¼š æ¸”ç½‘ã€æ¸”èˆ¹  docker : é²¸é±¼ï¼Œé›†è£…ç®± ğŸ³

Kubernetes is an open-source system for automating deployment, scaling, and management of containerized applications.

It groups containers that makeup application in to logical units for easy management and discovery.Kubernetes builds upon 15 years of  experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community.

kubernetesçš„ä¸»è¦ç‰¹å¾

- ä»¥æœåŠ¡ä¸ºä¸­å¿ƒ
- è‡ªåŠ¨åŒ–ï¼Œ è‡ªåŠ¨æ‰©ç¼©å®¹ï¼Œæ›´æ–°ã€è´Ÿè½½å‡è¡¡ã€å®ä¾‹çŠ¶æ€

kubernetes vs docker

- ä»¥docker å®¹å™¨æŠ€æœ¯æŠ€æœ¯çš„æ ‡å‡†ä¸ºåŸºç¡€ï¼ŒCRI



K8sæ¶æ„è®¾è®¡

podï¼š pause ä½œä¸ºæ ¹å®¹å™¨ï¼Œå…±äº«ç½‘ç»œæ–‡ä»¶ç­‰èµ„æº

![image-20210929221556408](1-k8s-cloudnative.assets/image-20210929221556408.png)

labelï¼š deploy/pod/container

![image-20210929221845565](1-k8s-cloudnative.assets/image-20210929221845565.png)







## 



### 2-2 kubernetesçš„æ ¸å¿ƒæ¦‚å¿µ 

### 2-3 kubernetesçš„æ¶æ„è®¾è®¡ 

master (APIServer/Scheduler(èµ„æºã€å†…å­˜ã€cpu)/controller(k8sèµ„æºrs,service))        etcd 

worker   worker (kubeletç»´æŠ¤podçš„ç”Ÿå‘½å‘¨æœŸï¼Œç½‘ç»œã€volume/ docker )

<img src="1-k8s-cloudnative.assets/image-20210929224628590.png" alt="image-20210929224628590" style="zoom:50%;" />

### 2-4 kubernetesè®¤è¯çš„å¯†ç å­¦åŸç† (15:30)

è®¤è¯(Authentication)  é˜²æ­¢æœ‰äººå…¥ä¾µ

æˆæƒ(Authorization)

APIserver



A --8 ç¯¡æ”¹-- >  B 





å¯¹ç§°åŠ å¯†ï¼šå°å§å§å¥½å¯çˆ± --> å¯¹ç§°åŠ å¯† abc123--->  wqerjqwoeurfasdhjfskalj -> å¯¹ç§°è§£å¯†abc123 ---> å°å§å§å¥½å¯çˆ±

éå¯¹ç§°åŠ å¯†: å°å§å§å¥½å¯çˆ± --> éå¯¹ç§°åŠ å¯† abc123(å…¬é’¥ public key)--->  wuqyieruzsxchjfvash -> éå¯¹ç§°è§£å¯†cde987(ç§é’¥ private key) ---> å°å§å§å¥½å¯çˆ±





å‘é€ä¸€ä¸ªhello

serviceA       ------------------------->             ServiceB



serviceA --------asdfqwefwsadfasd å¯†æ–‡----------> serviceB



A ä½¿ç”¨ serverBçš„pubkeyè¿›è¡ŒåŠ å¯†ï¼Œç„¶åå‘é€åˆ°serverBã€‚ cæˆªè·åä¹Ÿè§£ä¸å¼€ã€‚åªæœ‰Bç”¨è‡ªå·±çš„ç§é’¥æ‰å¯ä»¥è§£å¼€ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•çš„æ¶ˆè€—æ¯”è¾ƒå¤§ã€‚å¯¹ç§°åŠ å¯†çš„ç®—æ³•æ¶ˆè€—è¾ƒä½ã€‚



ç»“åˆéå¯¹ç§°åŠ å¯†å’Œå¯¹ç§°åŠ å¯†ã€‚

ä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ŒåŠ å¯†å¯¹ç§°åŠ å¯†è¦ä½¿ç”¨çš„å¯†é’¥ã€‚å¯ä»¥æŠŠå¯¹ç§°åŠ å¯†éœ€è¦çš„å¯†é’¥å®‰å…¨å¸¦çš„é€åˆ°Bã€‚æ¥ä¸‹æ¥åŒæ–¹å°±å¯ä»¥ä½¿ç”¨å¯¹ç§°åŠ å¯†è¿›è¡Œé€šä¿¡ã€‚

æ€§èƒ½å’Œå®‰å…¨æ€§éƒ½å¾—åˆ°äº†è§£å†³ã€‚

SSL/TLSåè®®  ---> HTTPS



ç›®å‰å¯èƒ½å­˜åœ¨çš„é£é™©å°±æ˜¯B åœ¨è¿”å›pubkeyçš„æ—¶å€™ï¼Œæœ‰å¯èƒ½è¢«Cæˆªè·ï¼ŒCæˆªè·åè¿”å›Cçš„å…¬é’¥ç»™Aï¼Œè¿™æ ·Aå°±æ‹¿åˆ°äº†Cçš„å…¬é’¥ã€‚

CA è®¤è¯æœºæ„ï¼Œè®©Aå¯ä»¥éªŒè¯æ‹¿åˆ°çš„Bçš„pubkey ç¡®å®æ˜¯Bçš„ï¼Œç¡®å®æ˜¯åˆæ³•çš„ï¼Œæ˜¯CAé¢å‘çš„ã€‚





### 2-5 kubernetesçš„è®¤è¯ä¸æˆæƒ 

è®¤è¯

**1. å®¢æˆ·ç«¯è¯ä¹¦è®¤è¯(TLSåŒå‘è®¤è¯)**



CA è‡ªå·±çš„è®¤è¯æœºæ„

ç»™å„ä¸ªç»„ä»¶é¢å‘è¯ä¹¦



kubectl  --->   API server 

åŒå‘è®¤è¯ ï¼š äº’ç›¸éªŒè¯è¯ä¹¦æ˜¯å¦ä¸ºCAé¢å‘

- API serveræ˜¯å¦æ˜¯kubectl éœ€è¦è®¿é—®çš„

- kubectl å®¢æˆ·ç«¯æ˜¯å¦æ˜¯ä¸€ä¸ªåˆæ³•çš„å®¢æˆ·ç«¯



**2.BearerToken**

**3.ServcieAccount**

Podä¸API serveræ‰“äº¤é“

(namespaceï¼Œtokenï¼Œca) æŒ‚è½½åˆ°podçš„æ–‡ä»¶ç³»ç»Ÿä¸­



æˆæƒ

ABAC

webhook

RBAC(Role Based Access Control)



User ---------------------->  Role -------------------------> Authority(Resource, Verbs:Curd)

|_ User     

|_ ServiceAccount 



RoleBinding

<img src="1-k8s-cloudnative.assets/image-20211002162137603.png" alt="image-20211002162137603" style="zoom:50%;" />



AdmisionControl: å‡†å…¥æ§åˆ¶

AlwaysAdmitã€AlwaysDenyã€ServiceAccountã€DenyEscolatingExec





### 2-6 é›†ç¾¤æ­å»ºæ–¹æ¡ˆå¯¹æ¯” 

ç¤¾åŒºæ–¹æ¡ˆ

Kubeadmï¼š

Binaryï¼š

æ˜“äºç»´æŠ¤



iterm çº§è”åŠŸèƒ½





## ç¬¬3ç«  å®¹å™¨è¿è¡Œæ—¶-Docker or Containerd

æœ¬ç« ä¸»è¦è®²è§£Docker or Containerdå¦‚ä½•é€‰æ‹©å’Œå…¨é¢ä¸Šæ‰‹å®è·µContainerdã€‚



3-1 Docker or Containerdå¦‚ä½•é€‰æ‹© (07:40)

3-2 Containerdå…¨é¢ä¸Šæ‰‹å®è·µ (26:18)
ç¬¬4ç«  é«˜å¯ç”¨é›†ç¾¤æ­å»º---kubesprayæ–¹å¼ã€é›†ç¾¤è½åœ°æ–¹æ¡ˆ1ã€‘6 èŠ‚ | 52åˆ†é’Ÿ
æœ¬ç« ä¸­å°†è®²è§£kubesprayé›†ç¾¤æ­å»ºæ–¹æ¡ˆã€‚å¸¦é¢†å¤§å®¶ä¸€èµ·åˆ†ækubesprayéƒ¨ç½²æ–¹æ¡ˆã€åŸºç¡€ç¯å¢ƒã€kubesprayçš„å®‰è£…é…ç½®ã€ç”¨kubesprayä¸€é”®éƒ¨ç½²ç”Ÿäº§çº§K8sé›†ç¾¤ç­‰ï¼Œå…¨é¢ç³»ç»Ÿå­¦ä¼škubesprayçš„é›†ç¾¤è½åœ°æ–¹æ¡ˆã€‚



4-1 åˆ†ækubesprayéƒ¨ç½²æ–¹æ¡ˆï¼Œå‡†å¤‡åŸºç¡€ç¯å¢ƒ (08:42)

4-2 kubesprayçš„å®‰è£…ã€é…ç½® (15:13)

4-3 ç”¨kubesprayä¸€é”®éƒ¨ç½²ç”Ÿäº§çº§k8sé›†ç¾¤ (08:28)

4-4 é›†ç¾¤å†’çƒŸæµ‹è¯• (06:52)

4-5 è®¿é—®dashboard (04:41)

4-6 åŸºäºkubesprayçš„é›†ç¾¤è¿ç»´ (07:20)
ç¬¬5ç«  é«˜å¯ç”¨é›†ç¾¤æ­å»º---äºŒè¿›åˆ¶æ–¹å¼ã€é›†ç¾¤è½åœ°æ–¹æ¡ˆ2ã€‘9 èŠ‚ | 73åˆ†é’Ÿ
æœ¬ç« ä¸­å°†è®²è§£ï¼Œå¦‚ä½•ä½¿ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼ï¼Œæ­å»ºæœ€æ–°ç‰ˆæœ¬çš„kubernetesé«˜å¯ç”¨é›†ç¾¤ã€‚åŒæ ·ä¼šä»¥ä¸‰ä¸ªmasterï¼Œä¸¤ä¸ªworkerèŠ‚ç‚¹ä¸ºä¾‹ï¼Œä¼šé’ˆå¯¹é›†ç¾¤å¯ç”¨æ€§è¿›è¡Œçš„æµ‹è¯•ï¼Œå¹¶å®Œæˆdashboardçš„æ­å»ºå’Œä½¿ç”¨ã€‚å¹¶åœ¨æœ¬ç« ç»“å°¾ï¼Œé€šè¿‡æ–‡æ¡£æ–¹å¼ï¼Œé’ˆå¯¹å‰é¢å†…å®¹è¿›è¡Œæ€»ç»“ï¼Œä¾¿äºåŒå­¦ä»¬å›é¡¾æŸ¥é˜…ã€‚...



5-1 åŸºç¡€ç¯å¢ƒå‡†å¤‡ (13:58)

5-2 ç”Ÿæˆè¯ä¹¦ (10:58)

5-3 kuberneteså„ç»„ä»¶çš„è®¤è¯é…ç½® (04:31)

5-4 éƒ¨ç½²etcdé›†ç¾¤ (04:08)

5-5 éƒ¨ç½²kubernetesæ§åˆ¶å¹³é¢ (08:16)

5-6 éƒ¨ç½²kuberneteså·¥ä½œèŠ‚ç‚¹ (13:38)

5-7 ç½‘ç»œæ’ä»¶-Calico_1 (06:00)

5-8 DNSæ’ä»¶-CoreDNS (04:40)

5-9 é›†ç¾¤å†’çƒŸæµ‹è¯• (06:36)
ç¬¬6ç«  ä¸šåŠ¡ç³»ç»Ÿè¿ç§»kubernetes---å‡†å¤‡å·¥ä½œã€ä¸ºå¹³ç¨³è¿ç§»åšå¥½å‚¨å¤‡ã€‘6 èŠ‚ | 90åˆ†é’Ÿ
æ­å»ºå®Œé›†ç¾¤è¿˜ä¸èƒ½é©¬ä¸Šè¿ç§»ä¸šåŠ¡ï¼Œæœ¬ç« ä¸­å°†è®²è§£è¿ç§»å‰çš„ä¸€äº›å‡†å¤‡å·¥ä½œï¼šåŒ…æ‹¬é•œåƒä»“åº“harborçš„å…¥é—¨å’Œéƒ¨ç½²ã€å¯¹kubernetesæœåŠ¡å‘ç°æ–¹æ¡ˆçš„å­¦ä¹ åˆ†æä»¥åŠingress-nginxæœåŠ¡å‘ç°æ–¹æ¡ˆçš„éƒ¨ç½²ã€‚



6-1 Harborå…¥é—¨ (17:06)

6-2 Harboré«˜å¯ç”¨éƒ¨ç½²ï¼ˆä¸Šï¼‰ (11:50)

6-3 Harboré«˜å¯ç”¨éƒ¨ç½²ï¼ˆä¸‹ï¼‰ (12:21)

<img src="1-k8s-cloudnative.assets/image-20211002222547781.png" alt="image-20211002222547781" style="zoom:50%;" />

### 6-4 kubernetesçš„æœåŠ¡å‘ç° 

é›†ç¾¤å†…éƒ¨



é›†ç¾¤å†…-> é›†ç¾¤å¤–

é›†ç¾¤å¤–-> é›†ç¾¤å†…

![image-20211002225039041](1-k8s-cloudnative.assets/image-20211002225039041.png)

6-5 éƒ¨ç½²ingress-nginxï¼ˆä¸Šï¼‰ (14:52)

6-6 éƒ¨ç½²ingress-nginxï¼ˆä¸‹ï¼‰ (13:36)
ç¬¬7ç«  ä¸šåŠ¡ç³»ç»Ÿè¿ç§»kubernetes---æœ€ä½³å®è·µã€å¤šç±»å‹ä¸šåŠ¡è¿ç§»è½åœ°ã€‘7 èŠ‚ | 86åˆ†é’Ÿ
æœ¬ç« ä¸­å°†åˆ†æå¦‚ä½•å°†édockerä¸šåŠ¡è¿ç§»åˆ°dockerã€ä½¿dockeræœåŠ¡è¿è¡Œåœ¨kubernetesä¸­ï¼Œä»¥åŠåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚åŒæ—¶ä¹Ÿä¼šä»‹ç»ï¼Œå°†å®šæ—¶ä»»åŠ¡ã€ä¼ ç»Ÿçš„webæœåŠ¡ã€springbootçš„webæœåŠ¡è¿˜æœ‰dubboæœåŠ¡è¿ç§»éƒ¨ç½²åœ¨kubernetesä¸­çš„å…¨è¿‡ç¨‹ã€‚



7-1 å®šæ—¶ä»»åŠ¡è¿ç§»kubernetes (21:56)

æœåŠ¡åšåˆ°é•œåƒé‡Œ

- åŸºç¡€é•œåƒ
- æå®šæœåŠ¡è¿è¡Œçš„ç›¸å…³æ–‡ä»¶
- æ„å»ºé•œåƒ Dockerfile

åˆ¶ä½œK8sæœåŠ¡ï¼Œå¹¶è°ƒåº¦

- ç¡®å®šæœåŠ¡å‘ç°çš„ç­–ç•¥
- ç¼–å†™K8sé…ç½®
- 



å›¾æ–‡ï¼š
7-2 ã€ä¸ç†Ÿæ‚‰SpringBootçš„ç­’å­çœ‹è¿‡æ¥ã€‘SpringBootå¿«é€Ÿå…¥é—¨

7-3 springbootçš„webæœåŠ¡è¿ç§»kubernetes (11:29)
å›¾æ–‡ï¼š
7-4 ã€ä¸ç†Ÿæ‚‰Dubboçš„ç­’å­çœ‹è¿‡æ¥ã€‘Dubboå¿«é€Ÿå…¥é—¨

7-5 ä¼ ç»ŸdubboæœåŠ¡è¿ç§»kubernetesï¼ˆä¸Šï¼‰ (16:22)

7-6 ä¼ ç»ŸdubboæœåŠ¡è¿ç§»kubernetesï¼ˆä¸‹ï¼‰ (16:08)

7-7 ä¼ ç»ŸwebæœåŠ¡è¿ç§»kubernetes (19:40)
ç¬¬8ç«  CICDå®è·µã€åªä¼šè¿ç§»è¿˜ä¸å¤Ÿï¼ŒæŒç»­é›†æˆèµ°èµ·ã€‘5 èŠ‚ | 70åˆ†é’Ÿ
æœ¬ç« å°†è®²è§£å¦‚ä½•è®©æœåŠ¡å¯ä»¥åœ¨kubernetesé‡Œé¢å®ç°æŒç»­é›†æˆã€‚é€æ­¥å®ç°gitlabç®¡ç†ä»£ç ã€mavenæ„å»ºã€dockerå®ç°é•œåƒçš„æ„å»ºã€æ¨é€åˆ°harborä»“åº“ä»¥åŠé€šè¿‡è„šæœ¬è·Ÿkuberneteså¯¹æ¥å®ŒæˆæŒç»­å‘å¸ƒã€‚æœ€åè¿˜ä¼šåº”ç”¨jenkinsé€šè¿‡pipelineæ•´åˆæ•´ä¸ªæµç¨‹å®ç°CICDã€‚...



8-1 kubernetesä¸cicd (12:41)

8-2 cicdå®è·µï¼ˆ1ï¼‰ (12:56)

8-3 cicdå®è·µï¼ˆ2ï¼‰ (13:26)

8-4 cicdå®è·µï¼ˆ3ï¼‰ (13:31)

8-5 cicdå®è·µï¼ˆ4ï¼‰ (17:18)

## ç¬¬9ç«  æ·±å…¥kubernete---å‡ ä¸ªé‡è¦çš„èµ„æºå¯¹è±¡ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨&è£…é€¼å¯é€‰åŒ…ã€‘4 èŠ‚ | 83åˆ†é’Ÿ

æœ¬ç« ä¸­ä»‹ç»äº†kubernetesçš„é‡è¦èµ„æºï¼šnamespaceã€resourceså’Œlabelã€‚ è®²è§£å¹¶å®è·µäº†ï¼Œå‘½åç©ºé—´å¯¹èµ„æºå¯¹è±¡å’Œèµ„æºé…é¢å¤šå±‚é¢çš„éš”ç¦»æœºåˆ¶ã€podèµ„æºé™åˆ¶çš„é…ç½®æ–¹å¼ã€podåœ¨èŠ‚ç‚¹èµ„æºç´§ç¼ºæ—¶çš„é©±é€æœºåˆ¶ã€labelä½œç”¨äºä¸åŒèµ„æºå¯¹è±¡ä¸Šçš„ä¸åŒçš„ä½œç”¨ç­‰æ ¸å¿ƒçŸ¥è¯†ã€‚ ...



### 9-1 Namespace --- é›†ç¾¤çš„å…±äº«ä¸éš”ç¦» 

åˆ›å»ºä¸€ä¸ªnamespace

```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: dev
```





9-2 Resources---å¤šç»´åº¦é›†ç¾¤èµ„æºç®¡ç†ï¼ˆä¸Šï¼‰ (22:45)

9-3 Resources---å¤šç»´åº¦é›†ç¾¤èµ„æºç®¡ç†ï¼ˆä¸‹ï¼‰ (22:26)

9-4 Label---å°æ ‡ç­¾å¤§ä½œä¸º (19:31)
ç¬¬10ç«  æ·±å…¥kubernete---æœåŠ¡è°ƒåº¦ä¸ç¼–æ’ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨&è£…é€¼å¯é€‰åŒ…ã€‘6 èŠ‚ | 121åˆ†é’Ÿ
æœ¬ç« ä¸­ä¸»è¦å›´ç»•æœåŠ¡çš„è°ƒåº¦ä¸ç¼–æ’è®²è§£è®²è§£å¹¶å®è·µäº†ï¼špodçš„å¥åº·æ£€æŸ¥çš„å‚æ•°é…ç½®åŠå½±å“ã€è°ƒåº¦å™¨çš„æ•´ä½“å·¥ä½œåŸç†ä»¥åŠå¸¸è§çš„é¢„é€‰ç­–ç•¥å’Œä¼˜é€‰ç­–ç•¥ã€å¦‚ä½•åˆ©ç”¨kubernetesæœ¬èº«çš„æœºåˆ¶å®Œæˆä¸åŒçš„éƒ¨ç½²æ–¹å¼ã€‚



10-1 å¥åº·æ£€æŸ¥---é«˜å¯ç”¨çš„å®ˆæŠ¤è€… (23:06)

10-2 Scheduler--- ç©è½¬podè°ƒåº¦ï¼ˆä¸Šï¼‰ (13:57)

10-3 Scheduler --- ç©è½¬podè°ƒåº¦ï¼ˆä¸‹ï¼‰ (13:49)

10-4 éƒ¨ç½²ç­–ç•¥è¯¦è§£ --- é‡å»ºã€æ»šåŠ¨ã€è“ç»¿ã€é‡‘ä¸é›€ (26:11)

10-5 æ·±å…¥Pod - podç›¸å…³çš„ç‚¹ç‚¹æ»´æ»´ï¼ˆä¸Šï¼‰ (21:24)

10-6 æ·±å…¥Pod - podç›¸å…³çš„ç‚¹ç‚¹æ»´æ»´ï¼ˆä¸‹ï¼‰ (22:04)
ç¬¬11ç«  æ·±å…¥kubernete--- è½åœ°å®è·µæ·±å…¥ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨&è£…é€¼å¯é€‰åŒ…ã€‘7 èŠ‚ | 123åˆ†é’Ÿ
æœ¬ç« ä¸»è¦ä»kubernetesè½åœ°çš„è§’åº¦è¿›è¡Œæ·±å…¥è®²è§£ï¼Œåˆ†åˆ«ä»‹ç»ï¼šingressåœ¨è½åœ°è¿‡ç¨‹å¯èƒ½é‡åˆ°çš„é—®é¢˜ä¸åº”å¯¹æ–¹å¼ã€åŸºäºglusterfsçš„å…±äº«å­˜å‚¨ã€kubernetes apiçš„è®¾è®¡ï¼Œå¹¶ä»¥ä¸€ä¸ªçœŸå®çš„ç¤ºä¾‹é¡¹ç›®è®©å¤§å®¶çœ‹åˆ°å®¹å™¨ç®¡ç†å¹³å°å¯ä»¥åšæˆä»€ä¹ˆæ ·å­çš„ã€‚



11-1 ingress --- å››å±‚ä»£ç†ã€sessionä¿æŒã€å®šåˆ¶é…ç½®ã€æµé‡æ§åˆ¶ï¼ˆä¸Šï¼‰ (17:42)

11-2 ingress -- å››å±‚ä»£ç†ã€sessionä¿æŒã€å®šåˆ¶é…ç½®ã€æµé‡æ§åˆ¶ï¼ˆä¸­ï¼‰ (17:18)

11-3 ingress --- å››å±‚ä»£ç†ã€sessionä¿æŒã€å®šåˆ¶é…ç½®ã€æµé‡æ§åˆ¶ï¼ˆä¸‹ï¼‰ (16:42)

11-4 å…±äº«å­˜å‚¨ --- PVã€PVCå’ŒStorageClassï¼ˆä¸Šï¼‰.mp4 (16:13)

11-5 å…±äº«å­˜å‚¨ --- PVã€PVCå’ŒStorageClassï¼ˆä¸‹ï¼‰ (16:04)

11-6 StatefulSet --- æœ‰çŠ¶æ€åº”ç”¨çš„å®ˆæŠ¤è€… (18:47)

11-7 KubernetesAPI ---å¦‚ä½•å¼€å‘ä¸€ä¸ªåŸºäºkubernetesçš„å®¹å™¨ç®¡ç†å¹³å° (19:38)
ç¬¬12ç«  æ·±å…¥kubernete---æ—¥å¿—å’Œç›‘æ§ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨&è£…é€¼å¯é€‰åŒ…ã€‘10 èŠ‚ | 131åˆ†é’Ÿ
æœ¬ç« ä¸­å°†ä»‹ç»K8Sä½¿ç”¨è€…å¿…é¡»è€ƒè™‘çš„é‡é‡çº§é—®é¢˜ï¼šæ—¥å¿—ä¸ç›‘æ§ã€‚è¯¾ç¨‹ä¸­ä¼šåˆ†æå½“ä¸‹ä¸»æµçš„æ—¥å¿—å¤„ç†æ–¹æ¡ˆå¹¶é€‰æ‹©ä¸€ç§æ–¹æ¡ˆè¿›è¡Œæ—¥å¿—ä»é‡‡é›†åˆ°å±•ç¤ºçš„å®Œæ•´å®è·µï¼›ä¼šè®²è§£ä¸»æµk8sç›‘æ§æ–¹æ¡ˆprometheusï¼ŒåŒ…æ‹¬å®ƒçš„å®ç°åŸç†ï¼Œæ”¯æŒçš„å„ç§æŒ‡æ ‡ç­‰ã€‚



12-1 å¸¸è§æ—¥å¿—é‡‡é›†é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆåˆ†æ (08:41)

12-2 logpilot+elasticsearch+kibanaæ—¥å¿—å®è·µ (19:26)

12-3 ç›‘æ§å…¥é—¨---ä»æ•´ä½“æŠŠæ¡ç›‘æ§ (07:39)

12-4 Prometheuså…¥é—¨---æ¶æ„å’ŒåŸç† (11:45)

12-5 éƒ¨ç½²å‰å¥ - Helm & Operator (10:31)

12-6 ç›‘æ§éƒ¨ç½²å®æˆ˜ - Helm+PrometheusOperator (19:30)

12-7 ç›‘æ§è½åœ° - æŒ‡æ ‡å®Œå–„ã€Grafanaçœ‹æ¿å’Œé‚®ä»¶æŠ¥è­¦ï¼ˆä¸Šï¼‰ (17:16)

12-8 ç›‘æ§è½åœ° - æŒ‡æ ‡å®Œå–„ã€Grafanaçœ‹æ¿å’Œé‚®ä»¶æŠ¥è­¦ï¼ˆä¸­ï¼‰ (17:28)

12-9 ç›‘æ§è½åœ° - æŒ‡æ ‡å®Œå–„ã€Grafanaçœ‹æ¿å’Œé‚®ä»¶æŠ¥è­¦ï¼ˆä¸‹ï¼‰ (18:21)
å›¾æ–‡ï¼š
12-10 ã€æ­¥éª¤æ€»ç»“ï¼Œä¾¿äºå¿«é€Ÿå›é¡¾ã€‘Helméƒ¨ç½²æ–‡æ¡£

## ç¬¬13ç«  ServiceMeshä»£è¡¨ä½œistio

æœ¬ç« ä¸­æˆ‘ä»¬ä¼šä»istioçš„æ¶æ„è®¾è®¡å¼€å§‹è®©ä½ å¯¹å®ƒçš„å®ç°åŸç†æœ‰æ·±å…¥äº†è§£ï¼Œå¹¶ä¼šéƒ¨ç½²å®Œæ•´çš„istioç¯å¢ƒï¼Œä»æ¶æ„ä¸Šè®©æˆ‘ä»¬çš„æœåŠ¡è‡ªåŠ¨æ”¯æŒistioçš„åŠŸèƒ½ï¼Œæœ€åä½¿ç”¨å‡ ä¸ªistioçš„å¸¸è§å·¥å…·é›†å®ç°æ•°æ®å±•ç°ã€‚



13-1 ä»€ä¹ˆæ˜¯ServiceMeshï¼Ÿä»€ä¹ˆæ˜¯Istioï¼Ÿ (04:51)

å¾®æœåŠ¡æ¶æ„

è®¾ä¹ˆæ˜¯ServiceMesh

- æœåŠ¡ç½‘æ ¼
- æ˜¯æ¦‚å¿µä¸æ˜¯äº§å“
- è§£å†³ç½‘ç»œå±‚é¢çš„é—®é¢˜

æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€è·¯ç”±ã€æµé‡æ§åˆ¶ã€æœåŠ¡é—´é€šä¿¡çš„å¯é æ€§ã€ç›‘æ§----  API ç½‘å…³ï¼Ÿ

Linkerd

å§‹äº2016å¹´CNCFå®˜æ–¹é¡¹ç›®

1.x åŸºäºèŠ‚ç‚¹(è™šæ‹Ÿæœºã€ç‰©ç†æœº)

2.x åŸºäºkubernetes(conduit)

Istio

Google/IBM/Lyft å‘èµ·çš„å¼€æºé¡¹ç›®ï¼Œ17å¹´æ¨å‡ºï¼Œ18å¹´7æœˆå‘å¸ƒ1.0ã€å¤šå¹³å°æ”¯æŒ

éƒ½æ˜¯åŸºäºsidecaræ¨¡å¼

éƒ½åˆ†ä¸ºæ•°æ®å±‚å’Œæ§åˆ¶å±‚

Istio æ›´å—æ¬¢è¿





Pilot -> envoy æä¾›ä¿¡æ¯ï¼ŒæœåŠ¡å‘ç°ï¼Œ ABæµ‹è¯•



Mixerï¼šç­–ç•¥(è®¿é—®æ§åˆ¶)ã€é¥æµ‹(æ•°æ®æ”¶é›†å’Œæ±‡æŠ¥ï¼ŒæœåŠ¡ä¹‹é—´æµè½¬çš„æ•°æ®)

Galley:  é…ç½®ç®¡ç†ä¸­å¿ƒ

Citadelï¼š å®‰å…¨



æ•…éšœæ’æŸ¥ï¼š

è¯·æ±‚åœ¨å“ªå¤±è´¥çš„ï¼ŒAæœ‰è°ƒç”¨Bå—

ä¸ºä»€ä¹ˆç”¨æˆ·è¯·æ±‚/é¡µé¢hungä½äº†

ä¸ºä»€ä¹ˆç³»ç»Ÿç»„ä»¶è¿™ä¹ˆæ…¢ï¼Ÿé‚£ä¸ªç»„ä»¶æœ€æ…¢ï¼Ÿ

åº”ç”¨å®¹é”™æ€§

å®¢æˆ·ç«¯æ²¡æœ‰è®¾ç½®timeoutå¯¼è‡´åº”ç”¨å¡ä½

æ²¡æœ‰é‡è¯•æœºåˆ¶ï¼ŒæŸä¸ªæœåŠ¡å¶å°”å¼‚å¸¸å¯¼è‡´ç”¨æˆ·é¡µé¢é”™è¯¯

æŸäº›èŠ‚ç‚¹å¼‚å¸¸ï¼Œå¯¼è‡´æœåŠ¡å“åº”æ—¶é—´è¿‡é•¿

åº”ç”¨å‡çº§å‘å¸ƒ

æ–°ç‰ˆæœ¬ä¸€æ¬¡æ€§å‡çº§ï¼Œä¸€æ—¦å‡ºé”™å½±å“èŒƒå›´å¾ˆå¤§

æ— æ³•è¿›è¡ŒABæµ‹è¯•ï¼Œæ ¹æ®ç”¨æˆ·å±æ€§è®¿é—®ä¸åŒç‰ˆæœ¬

æœåŠ¡ç‰ˆæœ¬çš„ä¾èµ–å…³ç³»å¤„ç†ä¸å½“å¯¼è‡´æœåŠ¡ä¸å¯ç”¨

ç³»ç»Ÿå®‰å…¨

æœåŠ¡éƒ½æ˜¯HTTPè€Œéhttps

æ²¡æœ‰æµé‡é™åˆ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥å¯¹æœåŠ¡å‘èµ·æ”»å‡»









13-2 Istioæ¶æ„å’ŒåŸç† (11:41)

13-3 éƒ¨ç½²istio 



13-4 éƒ¨ç½²BookInfoç¤ºä¾‹åº”ç”¨ (11:38)

13-5 é…ç½®è¯·æ±‚è·¯ç”± (08:47)

13-6 æ•…éšœæ³¨å…¥ (07:38)

13-7 æµé‡è½¬ç§» (09:27)

13-8 è®¾ç½®è¯·æ±‚è¶…æ—¶ (03:16)

13-9 ç†”æ–­ (08:44)

13-10 æµé‡é•œåƒ (05:58)

13-11 Istioä¸­çš„Prometheuså’ŒGrafana (11:44)

13-12 åˆ†å¸ƒå¼è¿½è¸ªJaeger (09:29)

13-13 ç½‘æ ¼å¯è§†åŒ– (10:59)
ç¬¬14ç«  è¯¾ç¨‹æ€»ç»“ã€æ²‰æ·€&å±•æœ›ã€‘1 èŠ‚ | 6åˆ†é’Ÿ
æœ¬ç« ä¸­å°†æ€»ç»“æœ¬è¯¾ç¨‹æ‰€å­¦çŸ¥è¯†ï¼Œå±•æœ›dockerå’Œkubernetesçš„å‘å±•ã€‚



https://www.youtube.com/watch?v=2b7MRI6tmMo&list=PLsbVibQXuLjqZwdpSBXR27gNGgtHlQLHR&index=2



https://www.youtube.com/watch?v=8MlW9nixkwk&list=PLsbVibQXuLjqw6mCC4QMyLZ282dhdPWr3&index=13