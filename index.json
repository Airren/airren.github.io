[{"categories":null,"contents":" ä¸è¦åå•¬ä½ çš„æ‰¹è¯„ä¸æ„Ÿæ‚Ÿï¼Œæ•¬è¯·ç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ã€‚\nå¦‚æœä½ æœ‰è¿‡ä»¥ä¸‹é—®é¢˜ï¼Œæ¬¢è¿é˜…è¯»æ–‡ç« ï¼Œæå‡ºæ„è§ä¸å»ºè®®\ngo mod æ€ä¹ˆä½¿ç”¨ï¼Ÿ GOPATHæ˜¯ä»€ä¹ˆï¼Ÿ GO111MODULE=\u0026quot;\u0026quot; è¿™ä¸ªå‚æ•°å†³å®šäº†ä»€ä¹ˆï¼Ÿ go getã€go download æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ importåˆ°åº•importçš„ä»€ä¹ˆä¸œè¥¿ï¼Ÿ ä¾èµ–ç®¡ç†å·¥å…· ç”¨è¿‡Java çš„åŒå­¦éƒ½çŸ¥é“ï¼Œå¯¹ä¾èµ–çš„ç®¡ç†ç»å†äº†ä»åŸå§‹çš„æ‰‹åŠ¨å¼•å…¥jaråŒ…ï¼Œåˆ°ä½¿ç”¨mavenç­‰è‡ªåŠ¨åŒ–ç®¡ç†å·¥å…·å»å¼•å…¥ç¬¬ä¸‰æ–¹ä¾èµ–çš„è¿‡ç¨‹ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨åˆ«äººå·²ç»å¼€å‘å¥½çš„ä¼˜ç§€å·¥å…·ã€‚å¦‚æœä½¿ç”¨è¿‡Pythonçš„åŒå­¦å¯èƒ½ä¼šç†Ÿç»ƒçš„ä½¿ç”¨pip install ç¬¬ä¸‰æ–¹çš„å·¥å…·åŒ…ã€‚Java å’ŒPythonçš„ç¬¬ä¸‰æ–¹å·¥å…·åŒ…éƒ½æ˜¯é›†ä¸­å¼ç®¡ç†çš„ï¼Œä½¿ç”¨maven æˆ–è€…æ˜¯pip éƒ½æ˜¯ä»å¯¹åº”çš„ç®¡ç†ä¸­å¿ƒä¸‹è½½æ›´æ–°ä¾èµ–ã€‚å½“ç„¶è¿˜æœ‰ npmã€yarnã€gradleç­‰å…¶ä»–è¯­è¨€çš„ä¾èµ–ç‰ˆæœ¬å·¥å…·ã€‚\nåœ¨goè¯­è¨€ä¸­ï¼Œç¬¬ä¸‰æ–¹ä¾èµ–çš„ç®¡ç†å·¥å…·ç»è¿‡äº†ä¸€ä¸ªæ¼«é•¿çš„å‘å±•è¿‡ç¨‹ã€‚åœ¨GO1.11 å‘å¸ƒä¹‹å‰govendorã€depç­‰å·¥å…·ç™¾èŠ±é½æ”¾ã€‚ç›´åˆ°go mod å‡ºç°ï¼Œå¼€å§‹ä¸€ç»Ÿå¤©ä¸‹ã€‚go çš„ä¾èµ–éå¸¸ç®€å•ç²—æš´ï¼Œåªè¦ä¾èµ–æºç å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ï¼š\n1import \u0026#34;github.com/jinzhu/gorm\u0026#34; github.com/jinzhu/gorm å°±æ˜¯gormçš„GitHubé¡¹ç›®è·¯å¾„ã€‚\nGOPATHæ—¶æœŸ Go åœ¨1.11 ä¹‹å‰ä½¿ç”¨GOPATHæ¨¡å¼è¿›è¡Œä¾èµ–çš„ç®¡ç†ã€‚å®‰è£…éƒ¨ç½²goç¯å¢ƒï¼Œä½¿ç”¨go è¿›è¡Œå¼€å‘çš„æ—¶å€™å¼ºåˆ¶è¢«è¦æ±‚è¦è®¾ç½®GOPATHï¼ˆå½“ç„¶å®‰è£…è¿‡ç¨‹ä¸­ä¹Ÿä¼šé»˜è®¤æŒ‡å®š$GOPATH=~/goï¼‰ã€‚ è¦åœ¨GOPATHè·¯å¾„ä¸‹æ–°å»º /src /bin /pkgæ–‡ä»¶å¤¹ã€‚\n1âœ ~/go 2â”œâ”€â”€ bin # å­˜å‚¨goç¼–è¯‘ç”Ÿæˆçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸€èˆ¬ä¼šæŠŠè¯¥è·¯å¾„é…ç½®åˆ°PATHä¸­,PATH=$PATH:$GOPATH/bin 3â”œâ”€â”€ pkg # å­˜å‚¨é¢„ç¼–è¯‘çš„ç›®æ ‡æ–‡ä»¶ï¼Œä»¥åŠ å¿«åç»­çš„ç¼–è¯‘é€Ÿåº¦ 4â””â”€â”€ src # å­˜å‚¨Goçš„æºä»£ç ï¼Œä¸€èˆ¬ä»¥$GOPATH/src/github.com/foo/barçš„è·¯å¾„å­˜æ”¾ 1âœ ~ go env |grep GOPATH 2GOPATH=\u0026#34;/Users/bytedance/go\u0026#34; åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå¦‚æœä½¿ç”¨go get æ‹‰å–å¤–éƒ¨ä¾èµ–ä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…åˆ°$GOPATH/src ç›®å½•ä¸‹ã€‚\nè¿™ç§æ¨¡å¼ä¸‹ï¼Œgo getæ²¡æœ‰ç‰ˆæœ¬ç®¡ç†çš„æ¦‚å¿µï¼Œæ— æ³•å¤„ç†ä¾èµ–ä¸åŒç‰ˆæœ¬çš„é—®é¢˜ï¼Œå› ä¸ºåŒä¸€ä¸ªä¾èµ–éƒ½å­˜åœ¨åŒä¸€ä¸ªè·¯å¾„ä¸‹é¢ã€‚\nåœ¨Goå®˜æ–¹è¿˜æ²¡æœ‰æ¨å‡ºGo Modules çš„æ—¶å€™ï¼Œgoçš„ä¾èµ–ç®¡ç†å·¥å…·å¯è°“æ˜¯ç™¾èŠ±é½æ”¾ï¼Œä¾‹å¦‚ govendorï¼Œ depï¼Œä½†æ˜¯æœ€ç»ˆGo Moduleså‘å¸ƒï¼Œå¹³æ¯äº†è¯¸ä¾¯å‰²æ®çš„å±€é¢ã€‚\nGO Modules Go1.11 å¼€å§‹æ¨å‡ºGo Modules ,Go1.13å¼€å§‹ä¸å†æ¨èä½¿ç”¨GOPATHã€‚æ„æ€å°±æ˜¯è¯´ä½ å¯ä»¥åœ¨ä»»ä½•è·¯å¾„ä¸‹å­˜æ”¾ä½ çš„Goæºç æ–‡ä»¶, ä¸ç”¨å†åƒä»¥å‰ä¸€æ ·éå¾—æ”¾åˆ°$GOPATH/srcä¸­ã€‚ æ¯ä¸€ä¸ªgoé¡¹ç›® éƒ½æ˜¯ä¸€ä¸ª Modulesã€‚vgo æ˜¯Go Modulesçš„å‰èº«ã€‚\nåœ¨Go Modulesç¯å¢ƒä¸‹å‡ºç°äº†ä¸€ä¸ªå¾ˆé‡è¦çš„ç¯å¢ƒå˜é‡GO111MODULE\n1âœ ~ go env 2GO111MODULE=\u0026#34;auto\u0026#34; # å½“ä¸º aotu æ¨¡å¼æ—¶å€™å¦‚æœå½“å‰ç›®å½•ä¸­æœ‰go.modåˆ™ä¸ºGO Moduleæ¨¡å¼ 3GOPROXY=\u0026#34;https://proxy.golang.org,direct\u0026#34; 4GONOPROXY=\u0026#34;\u0026#34; 5GOSUMDB=\u0026#34;sum.golang.org\u0026#34; 6GONOSUMDB=\u0026#34;\u0026#34; 7GOPRIVATE=\u0026#34;\u0026#34; å¦‚æœè¦å¯¹go çš„ç¯å¢ƒå˜é‡è¿›è¡Œè®¾ç½®ï¼Œå¯ä»¥ä½¿ç”¨\n1go env -w GO111MODULE=on # è®¾ç½®go ç¯å¢ƒå˜é‡ 2go env -u # æ¢å¤åˆå§‹è®¾ç½® GO111MODULE GO111MODULE è¿™ä¸ªç¯å¢ƒå˜é‡æ˜¯ç”¨æ¥ä½œä¸ºä½¿ç”¨Go Modules çš„å¼€å…³ã€‚å¯ä»¥è¯´è¿™ä¸ªå˜é‡æ˜¯å†å²äº§ç‰©ï¼Œå¾ˆæœ‰è‚¯èƒ½ä¼šåœ¨å°†æ¥Goçš„æ–°ç‰ˆæœ¬ä¸­å»é™¤æ‰ã€‚\n1GO111MODULE=\u0026#34;auto\u0026#34; # åªè¦é¡¹ç›®åŒ…å«äº†go.mod æ–‡ä»¶çš„è¯å°±å¯ç”¨Go modulesï¼Œ åœ¨Go1.11-1.14 ä¸­æ˜¯é»˜è®¤å€¼ 2GO111MODULE=\u0026#34;on\u0026#34; # å¯ç”¨Go Modules 3GO111MODULE=\u0026#34;off\u0026#34; # ç¦ç”¨Go Modulesï¼Œ å¯¹è€çš„é¡¹ç›®è¿›è¡Œå…¼å®¹ GOPROXY GOPROXY æ˜¯Go Modulesçš„ä»£ç†ï¼Œå¯ä»¥é€šè¿‡é•œåƒç«™ç‚¹å¿«é€Ÿæ‹‰å–ï¼ˆå¾ˆå¤šå…¬å¸éƒ½ä¼šè®¾ç½®è‡ªå·±çš„é•œåƒç«™ç‚¹ï¼‰ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ªä»£ç†ã€‚\n1GOPROXY=\u0026#34;https://proxy.golang.org,direct\u0026#34; directçš„æ„æ€æ˜¯å¦‚æœé€šè¿‡ä»£ç†è·å–ä¸åˆ°go get å°±ä¼šé€šè¿‡æºåœ°å€ç›´æ¥å»æŠ“å–\ngo mod åˆ›å»ºGo Modulesçš„åŸºæœ¬å‘½ä»¤\n1âœ ~ go mod 2Go mod provides access to operations on modules. 3 4Note that support for modules is built into all the go commands, 5not just \u0026#39;go mod\u0026#39;. For example, day-to-day adding, removing, upgrading, 6and downgrading of dependencies should be done using \u0026#39;go get\u0026#39;. 7See \u0026#39;go help modules\u0026#39; for an overview of module functionality. 8# æ‰€æœ‰çš„go commands éƒ½æ”¯æŒ modulesã€‚ 9Usage: 10 11 go mod \u0026lt;command\u0026gt; [arguments] 12 13The commands are: 14 15 download download modules to local cache 16 edit edit go.mod from tools or scripts 17 graph print module requirement graph 18 init initialize new module in current directory 19 tidy add missing and remove unused modules 20 vendor make vendored copy of dependencies 21 verify verify dependencies have expected content 22 why explain why packages or modules are needed 23 24Use \u0026#34;go help mod \u0026lt;command\u0026gt;\u0026#34; for more information about a command. go mod init\nåœ¨å½“å‰ç›®å½•åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„moduleï¼Œ å°±æ˜¯è¯´å°†è¯¥ç›®å½•ä¸‹çš„å·¥ç¨‹æ–‡ä»¶åˆå§‹åŒ–ä¸ºä¸€ä¸ªGo Module.\nå¦‚æœå½“å‰ç›®å½•åœ¨GOPATHä¸­ï¼Œè¿™æ¡å‘½ä»¤æ— éœ€ä¼ å…¥å‚æ•°ï¼Œå‚æ•°é»˜è®¤ä¸º GOPATH/src åˆ°è¯¥ç›®å½•çš„ç›¸å¯¹è·¯å¾„ã€‚\n1âœ demo pwd 2/Users/bytedance/go/src/github.com/airren/demo # å½“å‰è·¯å¾„ 3âœ demo go mod init 4go: creating new go.mod: module github.com/airren/demo 5âœ demo ls 6go.mod 7âœ demo cat go.mod 8module github.com/airren/demo 9 10go 1.14 11âœ demo å¦‚æœå½“å‰ç›®å½•ä¸åœ¨GOPATHä¸­ï¼Œè¦æ‰‹åŠ¨æŒ‡å®šmoduleçš„åå­—\n1âœ gotest pwd 2/Users/bytedance/Desktop/gotest 3âœ gotest go mod init # å¦‚æœä¸åœ¨GOPATHè·¯å¾„ä¸‹ 4go: cannot determine module path for source directory /Users/bytedance/Desktop/gotest (outside GOPATH, module path must be specified) 5 6Example usage: 7 \u0026#39;go mod init example.com/m\u0026#39; to initialize a v0 or v1 module 8 \u0026#39;go mod init example.com/m/v2\u0026#39; to initialize a v2 module 9 10Run \u0026#39;go help mod init\u0026#39; for more information. 11âœ gotest go mod init github.com/airren/gotest 12go: creating new go.mod: module github.com/airren/gotest 13âœ gotest cat go.mod 14module github.com/airren/gotest 15 16go 1.14 go mod download\ngo mod download å‘½ä»¤ä¼šæŠŠpackageä¸‹è½½åˆ° GOPATH/pkg/modè·¯å¾„ä¸‹ï¼Œä¸‹è½½æ—¶è¦æŒ‡å®šç‰ˆæœ¬å¯ä»¥ç”¨@latestã€‚å¯ä»¥ä»»æ„è·¯å¾„ä¸‹ä½¿ç”¨go mod download\n1âœ jinzhu pwd 2/Users/bytedance/go/pkg/mod/github.com/jinzhu 3âœ jinzhu ls 4gorm@v1.9.11-0.20190912141731-0c98e7d712e2 inflection@v1.0.0 5gorm@v1.9.12 now@v1.0.1 6inflection@v0.0.0-20180308033659-04140366298a now@v1.1.1 7âœ jinzhu go mod download -x github.com/jinzhu/gorm@v1.9.8 # è¦æŒ‡å®šç‰ˆæœ¬ 8âœ jinzhu ls 9gorm@v1.9.11-0.20190912141731-0c98e7d712e2 inflection@v1.0.0 10gorm@v1.9.12 now@v1.0.1 11gorm@v1.9.8 now@v1.1.1 12inflection@v0.0.0-20180308033659-04140366298a 13âœ jinzhu cd gorm@v1.9.8 vendor\ngo mod vendorä¼šåœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªvendoræ–‡ä»¶å¤¹ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ -mod=vendor ï¼Œä½¿ç”¨ä»£ç ä¸»ç›®å½•æ–‡ä»¶å¤¹ä¸‹vendorç›®å½•æ»¡è¶³ä¾èµ–è·å–ï¼Œgo build -mod=vendorã€‚æ­¤æ—¶ï¼Œgo build å¿½ç•¥go.mod ä¸­çš„ä¾èµ–ï¼Œï¼ˆè¿™é‡Œä»…ä½¿ç”¨ä»£ç rootç›®å½•ä¸‹çš„vendorå…¶ä»–åœ°æ–¹çš„å°†å¿½ç•¥ï¼‰\n1GOFLAGS=-mod=vendor` è®¾ç½®é¡¶çº§vendorä½œä¸ºä¾èµ– `go env -w GOFLAGS=\u0026#34;-mod=vendor\u0026#34;` è¿›è¡Œè®¾ç½®ã€‚ å–æ¶ˆ `go env -w GOFLAGS=\u0026#34;-mod=\u0026#34; import import å¯¼å…¥çš„æ˜¯æ–‡ä»¶å­˜å‚¨çš„ç›¸å¯¹è·¯å¾„ï¼ˆä¸èƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼‰æˆ–è€…æ˜¯Modules Nameï¼Œå¹¶ä¸æ˜¯packageçš„nameï¼Œä½†æ˜¯åœ¨è°ƒç”¨Functionçš„æ—¶å€™ä½¿ç”¨çš„æ˜¯packageçš„nameã€‚\nimport é¦–å…ˆä¼šä»$GOROOTä¸­å¯»æ‰¾ï¼Œç„¶åä»$GOPATH/src ä¸­å¯»æ‰¾ï¼Œå¦‚æœæ˜¯ä»¥./ æˆ–è€… ../ å¼€å¤´çš„import ç›´æ¥å»å¯¹åº”çš„ç›¸å¯¹è·¯å¾„å¯»æ‰¾ã€‚\nimport æ—¶å€™æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥åœ¨goé¡¹ç›®ä¸­folderçš„nameå°½é‡æ˜¯å°å†™ï¼Œå¯ä»¥æœ‰ä¸‹åˆ’çº¿_, ä½†æ˜¯packagenameä¸€å®šä¸èƒ½æœ‰ _ï¼Œå¦åˆ™golintä¼šæœ‰æç¤ºã€‚\nä¸¾ä¸ªä¾‹å­ğŸŒ°æ–‡ä»¶ç»“æ„å¦‚å›¾æ‰€ç¤º\n1gotest 2â”œâ”€â”€ format_print 3â”‚ â””â”€â”€ colorprintpath.go # æ–‡ä»¶åå¹¶ä¸å½±å“ import 4â””â”€â”€ sdemo 5 â”œâ”€â”€ demo.go colorprintpath.go\n1package colorprintfile // è°ƒç”¨æ–¹æ³•æ—¶å€™é€šè¿‡package name è°ƒç”¨ 2import \u0026#34;fmt\u0026#34; 3// NewPirnt is the new format print å…¬å¼€æ–¹æ³•è¦æœ‰æ³¨é‡Š 4func NewPrint(content string) { 5\tfmt.Printf(\u0026#34;This is the content: %v \\n\u0026#34;, content) 6} demo.go è°ƒç”¨ä¸Šè¿°æ–¹æ³•\n1package main 2import \u0026#34;../format_print\u0026#34; // import ä½¿ç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„ 3func main(){ 4\tcolorprintfile.NewPrint(\u0026#34;hello\u0026#34;)\t// è°ƒç”¨packageä¸­çš„å…¬å¼€æ–¹æ³• 5} å¦‚æœä½¿ç”¨äº†go modï¼Œ åœ¨é¡¹ç›®æ–‡ä»¶ä¸‹æœ‰äº†go.mod, æ–‡ä»¶ä¸­ä¼šæœ‰\n1module github.com/airren/gotest æ­¤æ—¶å°±ä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨package, è¦é€šè¿‡modulesçš„æ–¹å¼å¼•ç”¨\n1package main 2import \u0026#34;github.com/airren/gotest/format_print\u0026#34; 3func main(){ 4\tcolorprintfile.NewPrint(\u0026#34;hello\u0026#34;)\t// è°ƒç”¨packageä¸­çš„å…¬å¼€æ–¹æ³• 5} go get å¯ä»¥åœ¨ä»»æ„è·¯å¾„ä¸‹æ‰§è¡Œgo get\nç”¨äºä»è¿œç¨‹ä»£ç ä»“åº“(github, gitlab,gogs)ä¸Šä¸‹è½½å¹¶å®‰è£…ä»£ç åŒ…\næ”¯æŒçš„ä»£ç ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæœ‰: Git , Mercurial(hg)ï¼ŒSVN, Bazaar\næŒ‡å®šçš„ä»£ç åŒ…ä¼šè¢«ä¸‹è½½åˆ°$GOPATHä¸­åŒ…å«çš„ç¬¬ä¸€ä¸ªå·¥ä½œåŒºçš„srcç›®å½•ä¸­ï¼Œç„¶åå†å®‰è£…\nå¸¸ç”¨å‚æ•°\n1-d # åªæ‰§è¡Œä¸‹è½½åŠ¨ä½œï¼Œè€Œä¸æ‰§è¡Œå®‰è£…åŠ¨ä½œ 2-fix # åœ¨ä¸‹è½½ä»£ç åŒ…åå…ˆæ‰§è¡Œä¿®æ­£åŠ¨ä½œï¼Œè€Œåå†è¿›è¡Œç¼–è¯‘å’Œå®‰è£… 3-u # åˆ©ç”¨ç½‘ç»œæ¥æ›´æ–°å·²æœ‰çš„ä»£ç åŒ…åŠå…¶ä¾èµ–åŒ… 4-x # æ˜¾ç¤ºè¿‡ç¨‹ ä¾‹å¦‚ä½¿ç”¨go get è·å– gormã€‚ é€šè¿‡-x å‚æ•°å¯ä»¥å±•ç¤ºè¯¦ç»†çš„è¿‡ç¨‹ã€‚\n1âœ ~ go get -u -x github.com/jinzhu/gorm 2cd . 3git clone -- https://github.com/jinzhu/gorm /Users/bytedance/go/src/github.com/jinzhu/gorm 4cd /Users/bytedance/go/src/github.com/jinzhu/gorm 5git submodule update --init --recursive 6cd /Users/bytedance/go/src/github.com/jinzhu/gorm 7git show-ref 8cd /Users/bytedance/go/src/github.com/jinzhu/gorm 9git submodule update --init --recursive 10cd /Users/bytedance/go/src/github.com/jinzhu/inflection 11git config remote.origin.url 12cd /Users/bytedance/go/src/github.com/jinzhu/inflection 13git pull --ff-only 14cd /Users/bytedance/go/src/github.com/jinzhu/inflection 15git submodule update --init --recursive 16cd /Users/bytedance/go/src/github.com/jinzhu/inflection 17git show-ref 18cd /Users/bytedance/go/src/github.com/jinzhu/inflection 19git submodule update --init --recursive 20WORK=/var/folders/pz/w7jm4wm933lcspm82kff26600000gn/T/go-build644292157 å¦‚æœåœ¨å…·æœ‰go.mod çš„é¡¹ç›®çš„æ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨go get , ä¼šå°†å¯¹åº”çš„ä¾èµ–ä»¥åŠç‰ˆæœ¬å†™å…¥go.mod, go.sum æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå…·ä½“ä»‹ç»å¯ä»¥æŸ¥çœ‹https://studygolang.com/articles/25658\n1âœ gotest cat go.mod 2module github.com/airren/gotest 3 4go 1.14 5âœ gotest cat go.sum 6cat: go.sum: No such file or directory 7âœ gotest go get -u github.com/jinzhu/gorm/ # æ‹‰å–gorm 8go: github.com/jinzhu/gorm upgrade =\u0026gt; v1.9.12 9âœ gotest cat go.mod 10module github.com/airren/gotest 11 12go 1.14 13 14require github.com/jinzhu/gorm v1.9.12 // indirect # æ–°å¢ä¾èµ–ï¼Œ æœªè¢«ä½¿ç”¨æˆ–è€…é—´æ¥ä½¿ç”¨ä¼šæœ‰ indirect 15âœ gotest cat go.sum 16github.com/denisenkom/go-mssqldb v0.0.0-20191124224453-732737034ffd/go.mod h1:xbL0rPBG9cCiLr28tMa8zpbdarY27NDyej4t/EjAShU= 17github.com/erikstmartin/go-testdb v0.0.0-20160219214506-8d10e4a1bae5/go.mod h1:a2zkGnVExMxdzMo3M0Hi/3sEU+cWnZpSni0O6/Yb/P0= 18github.com/go-sql-driver/mysql v1.4.1/go.mod h1:zAC/RDZ24gD3HViQzih4MyKcchzm+sOG5ZlKdlhCg5w= 19github.com/golang-sql/civil v0.0.0-20190719163853-cb61b32ac6fe/go.mod h1:8vg3r2VgvsThLBIFL93Qb5yWzgyZWhEmBwUJWevAkK0= 20github.com/golang/protobuf v1.2.0/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U= 21github.com/jinzhu/gorm v1.9.12 h1:Drgk1clyWT9t9ERbzHza6Mj/8FY/CqMyVzOiHviMo6Q= 22github.com/jinzhu/gorm v1.9.12/go.mod h1:vhTjlKSJUTWNtcbQtrMBFCxy7eXTzeCAzfL5fBZT/Qs= 23github.com/jinzhu/inflection v1.0.0 h1:K317FqzuhWc8YvSVlFMCCUb36O/S9MCKRDI7QkRKD/E= 24github.com/jinzhu/inflection v1.0.0/go.mod h1:h+uFLlag+Qp1Va5pdKtLDYj+kHp5pxUVkryuEj+Srlc= 25github.com/jinzhu/now v1.0.1/go.mod h1:d3SSVoowX0Lcu0IBviAWJpolVfI5UJVZZ7cO71lE/z8= 26github.com/lib/pq v1.1.1/go.mod h1:5WUZQaWbwv1U+lTReE5YruASi9Al49XbQIvNi/34Woo= 27github.com/mattn/go-sqlite3 v2.0.1+incompatible/go.mod h1:FPy6KqzDD04eiIsT53CuJW3U88zkxoIYsOqkbpncsNc= 28golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= 29golang.org/x/crypto v0.0.0-20190325154230-a5d413f7728c/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= 30golang.org/x/crypto v0.0.0-20191205180655-e7c4368fe9dd/go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto= 31golang.org/x/net v0.0.0-20180724234803-3673e40ba225/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4= 32golang.org/x/net v0.0.0-20190404232315-eb5bcb51f2a3/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg= 33golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY= 34golang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs= 35golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ= 36google.golang.org/appengine v1.4.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4= ä¸è¦åå•¬ä½ çš„æ‰¹è¯„ä¸æ„Ÿæ‚Ÿï¼Œæ•¬è¯·ç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ã€‚\nå‚è€ƒèµ„æ–™ https://github.com/golang/go/wiki/Modules\nhttps://blog.golang.org/using-go-modules\nhttps://juejin.im/post/5e57537cf265da57584da62b\nhttps://learnku.com/go/t/39086\nhttps://studygolang.com/articles/25658\n","date":"August 4, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/1_go_modules/","summary":"ä¸è¦åå•¬ä½ çš„æ‰¹è¯„ä¸æ„Ÿæ‚Ÿï¼Œæ•¬è¯·ç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ã€‚\nå¦‚æœä½ æœ‰è¿‡ä»¥ä¸‹é—®é¢˜ï¼Œæ¬¢è¿é˜…è¯»æ–‡ç« ï¼Œæå‡ºæ„è§ä¸å»ºè®®\ngo mod æ€ä¹ˆä½¿ç”¨ï¼Ÿ GOPATHæ˜¯ä»€ä¹ˆï¼Ÿ GO111MODULE=\u0026quot;\u0026quot; è¿™ä¸ªå‚æ•°å†³å®šäº†ä»€ä¹ˆï¼Ÿ go getã€go download æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ importåˆ°åº•importçš„ä»€ä¹ˆä¸œè¥¿ï¼Ÿ ä¾èµ–ç®¡ç†å·¥å…· ç”¨è¿‡Java çš„åŒå­¦éƒ½çŸ¥é“ï¼Œå¯¹ä¾èµ–çš„ç®¡ç†ç»å†äº†ä»åŸå§‹çš„æ‰‹åŠ¨å¼•å…¥jaråŒ…ï¼Œåˆ°ä½¿ç”¨mavenç­‰è‡ªåŠ¨åŒ–ç®¡ç†å·¥å…·å»å¼•å…¥ç¬¬ä¸‰æ–¹ä¾èµ–çš„è¿‡ç¨‹ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨åˆ«äººå·²ç»å¼€å‘å¥½çš„ä¼˜ç§€å·¥å…·ã€‚å¦‚æœä½¿ç”¨è¿‡Pythonçš„åŒå­¦å¯èƒ½ä¼šç†Ÿç»ƒçš„ä½¿ç”¨pip install ç¬¬ä¸‰æ–¹çš„å·¥å…·åŒ…ã€‚Java å’ŒPythonçš„ç¬¬ä¸‰æ–¹å·¥å…·åŒ…éƒ½æ˜¯é›†ä¸­å¼ç®¡ç†çš„ï¼Œä½¿ç”¨maven æˆ–è€…æ˜¯pip éƒ½æ˜¯ä»å¯¹åº”çš„ç®¡ç†ä¸­å¿ƒä¸‹è½½æ›´æ–°ä¾èµ–ã€‚å½“ç„¶è¿˜æœ‰ npmã€yarnã€gradleç­‰å…¶ä»–è¯­è¨€çš„ä¾èµ–ç‰ˆæœ¬å·¥å…·ã€‚\nåœ¨goè¯­è¨€ä¸­ï¼Œç¬¬ä¸‰æ–¹ä¾èµ–çš„ç®¡ç†å·¥å…·ç»è¿‡äº†ä¸€ä¸ªæ¼«é•¿çš„å‘å±•è¿‡ç¨‹ã€‚åœ¨GO1.11 å‘å¸ƒä¹‹å‰govendorã€depç­‰å·¥å…·ç™¾èŠ±é½æ”¾ã€‚ç›´åˆ°go mod å‡ºç°ï¼Œå¼€å§‹ä¸€ç»Ÿå¤©ä¸‹ã€‚go çš„ä¾èµ–éå¸¸ç®€å•ç²—æš´ï¼Œåªè¦ä¾èµ–æºç å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ï¼š\n1import \u0026#34;github.com/jinzhu/gorm\u0026#34; github.com/jinzhu/gorm å°±æ˜¯gormçš„GitHubé¡¹ç›®è·¯å¾„ã€‚\nGOPATHæ—¶æœŸ Go åœ¨1.11 ä¹‹å‰ä½¿ç”¨GOPATHæ¨¡å¼è¿›è¡Œä¾èµ–çš„ç®¡ç†ã€‚å®‰è£…éƒ¨ç½²goç¯å¢ƒï¼Œä½¿ç”¨go è¿›è¡Œå¼€å‘çš„æ—¶å€™å¼ºåˆ¶è¢«è¦æ±‚è¦è®¾ç½®GOPATHï¼ˆå½“ç„¶å®‰è£…è¿‡ç¨‹ä¸­ä¹Ÿä¼šé»˜è®¤æŒ‡å®š$GOPATH=~/goï¼‰ã€‚ è¦åœ¨GOPATHè·¯å¾„ä¸‹æ–°å»º /src /bin /pkgæ–‡ä»¶å¤¹ã€‚\n1âœ ~/go 2â”œâ”€â”€ bin # å­˜å‚¨goç¼–è¯‘ç”Ÿæˆçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸€èˆ¬ä¼šæŠŠè¯¥è·¯å¾„é…ç½®åˆ°PATHä¸­,PATH=$PATH:$GOPATH/bin 3â”œâ”€â”€ pkg # å­˜å‚¨é¢„ç¼–è¯‘çš„ç›®æ ‡æ–‡ä»¶ï¼Œä»¥åŠ å¿«åç»­çš„ç¼–è¯‘é€Ÿåº¦ 4â””â”€â”€ src # å­˜å‚¨Goçš„æºä»£ç ï¼Œä¸€èˆ¬ä»¥$GOPATH/src/github.com/foo/barçš„è·¯å¾„å­˜æ”¾ 1âœ ~ go env |grep GOPATH 2GOPATH=\u0026#34;/Users/bytedance/go\u0026#34; åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå¦‚æœä½¿ç”¨go get æ‹‰å–å¤–éƒ¨ä¾èµ–ä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…åˆ°$GOPATH/src ç›®å½•ä¸‹ã€‚\nè¿™ç§æ¨¡å¼ä¸‹ï¼Œgo getæ²¡æœ‰ç‰ˆæœ¬ç®¡ç†çš„æ¦‚å¿µï¼Œæ— æ³•å¤„ç†ä¾èµ–ä¸åŒç‰ˆæœ¬çš„é—®é¢˜ï¼Œå› ä¸ºåŒä¸€ä¸ªä¾èµ–éƒ½å­˜åœ¨åŒä¸€ä¸ªè·¯å¾„ä¸‹é¢ã€‚\nåœ¨Goå®˜æ–¹è¿˜æ²¡æœ‰æ¨å‡ºGo Modules çš„æ—¶å€™ï¼Œgoçš„ä¾èµ–ç®¡ç†å·¥å…·å¯è°“æ˜¯ç™¾èŠ±é½æ”¾ï¼Œä¾‹å¦‚ govendorï¼Œ depï¼Œä½†æ˜¯æœ€ç»ˆGo Moduleså‘å¸ƒï¼Œå¹³æ¯äº†è¯¸ä¾¯å‰²æ®çš„å±€é¢ã€‚","tags":null,"title":"ã€ŒGoã€ä¾èµ–ç®¡ç† Go Modues/ GOPATH"},{"categories":null,"contents":" å¦‚ä½•ç”¨goå®ç°ä¸€ä¸ªç®€å•çš„å¹¶è¡Œä»»åŠ¡\nGolangå¹¶å‘ 1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sync\u0026#34; 6) 7 8var wg sync.WaitGroup 9 10func printer(ch chan int) { 11\tfor i := range ch { 12\tfmt.Printf(\u0026#34;Received %d \u0026#34;, i) 13\t} 14\twg.Done() // 15} 16 17// main is the entry point for the program. 18func main() { 19\tc := make(chan int) 20\tgo printer(c) 21\twg.Add(1) 22 23\t// Send 10 integers on the channel. 24\tfor i := 1; i \u0026lt;= 10; i++ { 25\tc \u0026lt;- i 26\t} 27 28\tclose(c) 29\twg.Wait() 30} æ­£å¸¸æƒ…å†µä¸‹goroutineçš„ç»“æŸè¿‡ç¨‹æ˜¯ä¸å¯æ§åˆ¶çš„ã€‚\nå­˜åœ¨è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œä¸»ç¨‹åºå·²ç»ç»“æŸäº†ï¼Œä½†æ˜¯ä¸»ç¨‹åºä¸­æ–°æ¿€æ´»çš„goroutineå¹¶æ²¡æœ‰è¿è¡Œå®Œã€‚ä¸»ç¨‹åºä¸€æ—¦ç»“æŸï¼Œä¸»ç¨‹åºä¸­çš„goroutineä¹Ÿå°±ç»“æŸäº†ã€‚\n1import ( 2\t\u0026#34;fmt\u0026#34; 3\t\u0026#34;time\u0026#34; 4) 5 6func main() { 7 8\tgo func() { 9\tfor index := 0; index \u0026lt; 10; index++ { 10\tfmt.Print(index, \u0026#34; \u0026#34;) 11\ttime.Sleep(time.Second * 1) 12\t} 13\t}() 14 15\tfmt.Println(\u0026#34;end\u0026#34;) 16} 17// è¿è¡Œç»“æœä¸º 18// end åŒ¿åå‡½æ•°ä¸­çš„ä»£ç å¹¶æ²¡æœ‰è¿è¡Œ,ä½¿ç”¨sync.WaitGroupä¿®æ”¹ä»£ç å¦‚ä¸‹\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sync\u0026#34; 6\t\u0026#34;time\u0026#34; 7) 8 9var wg sync.WaitGroup 10 11func main() { 12\twg.Add(1) // è¡¨ç¤ºç­‰å¾…ä¸€ä¸ª goroutineè¿è¡Œç»“æŸ 13\tgo func() { 14\tfor index := 0; index \u0026lt; 10; index++ { 15\tfmt.Print(index, \u0026#34; \u0026#34;) 16\ttime.Sleep(time.Second*1) 17\t} 18\twg.Done() 19\t}() 20 21\twg.Wait() 22\tfmt.Println(\u0026#34;end\u0026#34;) 23} 24// è¿è¡Œç»“æœä¸º 25// 0 1 2 3 4 5 6 7 8 9 end å½“wg.Add(1)ï¼Œä¸”æœ‰ä¸¤ä¸ªæ‰§è¡Œé€Ÿåº¦ä¸ä¸€æ ·çš„çº¿ç¨‹æ—¶å€™\n1func main() { 2\twg.Add(1) 3\tgo func() { 4\tfor index := 0; index \u0026lt; 10; index++ { 5\tfmt.Print(index, \u0026#34; \u0026#34;) 6\ttime.Sleep(time.Second*1) 7\t} 8\twg.Done() 9\t}() 10 11\tgo func() { 12\tfor index := 0; index \u0026lt; 10; index++ { 13\tfmt.Print(index, \u0026#34;+ \u0026#34;) 14\ttime.Sleep(time.Second*10) 15\t} 16\twg.Done() 17\t}() 18 19\twg.Wait() 20\tfmt.Println(\u0026#34;end\u0026#34;) 21} 22// è¿è¡Œç»“æœä¸º 23// 0+ 0 1 2 3 4 5 6 7 8 9 1+ end sycc.WaitGroup æœ‰ä¸‰ä¸ªæ–¹æ³•\nAdd()ç”¨æ¥è®¾ç½®æˆ–è€…æ·»åŠ éœ€è¦ç­‰å¾…å®Œæˆçš„goroutineçš„æ•°é‡ï¼Œ Add(2) æˆ–è€…ä¸¤æ¬¡è°ƒç”¨Add(1)è¡¨ç¤ºè¦ç­‰å¾…ä¸¤ä¸ªgoroutineå®Œæˆ\nDone()åœ¨goroutineçœŸæ­£å®Œæˆä¹‹å‰è°ƒç”¨æœ¬æ–¹æ³•æ¥è¡¨ç¤ºgoroutineå·²ç»å®Œæˆäº†ï¼Œä¼šå¯¹ç­‰å¾…è®¡æ•°å™¨çš„å€¼å‡ä¸€ã€‚ Done()çš„æ•°ç›®ä¸€å®šè¦ä¸Add()çš„æ•°é‡ä¸€è‡´,å¦åˆ™ä¼šé€ æˆæ°¸ä¹…é˜»å¡è€Œå‡ºç°æ­»é”ã€‚fatal error: all goroutines are asleep - deadlock!\nWait() åœ¨ç­‰å¾…è®¡æ•°å™¨å‡ä¸º0ä¹‹å‰ï¼ŒWait() ä¼šä¸€ç›´é˜»å¡å½“å‰çš„goroutineã€‚\nç®€å•çš„åç¨‹æ±  å¼€è¾Ÿå›ºå®šæ•°é‡çš„åç¨‹æ± å¤„ç†ä»»åŠ¡ï¼Œé€šè¿‡chan ä¼ é€’Taskã€‚\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sync\u0026#34; 6\t\u0026#34;sync/atomic\u0026#34; 7\t\u0026#34;time\u0026#34; 8) 9 10var ( 11\tcount int64 12\twg = sync.WaitGroup{} 13\tch = make(chan int) // no buffer chan need consume first 14) 15 16func main() { 17 18\t// total task N 19\tconst N = 1000 20 21\t// build a pool with 5 goroutine, every goroutine deal the data form the chan 22\tfor i := 0; i \u0026lt; 5; i++ { 23\twg.Add(1) 24\tgo func() { 25\tdefer wg.Done() 26\tfor val := range ch { 27\tcount2 := atomic.AddInt64(\u0026amp;count, 1) 28\t\u0026lt;-time.After(100 * time.Millisecond) 29\tfmt.Printf(\u0026#34;%vvar: %v\\n\u0026#34;, count2, val) // count2 is a new local variable 30\t} 31\t}() 32\t} 33 34\tfmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; Start Work\u0026#34;) 35\tstartAt := time.Now() 36 37\t// task producer 38\tfor i := 0; i \u0026lt; N; i++ { 39\tch \u0026lt;- i 40\t} 41 42\tclose(ch) // need to close the chan first, or lead to deadlock due to all goroutines are asleep. 43\twg.Wait() 44 45\tfmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; Finished\u0026#34;) 46\ttotalTime := time.Now().Sub(startAt) 47\tfmt.Printf(\u0026#34;Total time is %v, total task: %v, avg time: %v\u0026#34;, totalTime, count, totalTime/time.Duration(N)) 48} 1\u0026gt;\u0026gt;\u0026gt; Finished 2Total time is 20.359523649s, total task: 1000, avg time: 20.359523ms å¦‚æœæ•°æ®å¤„ç†çš„é‡è¿œè¿œå°äºå¼€è¾Ÿçš„åç¨‹æ± çš„æ•°é‡æ— ç–‘æ˜¯èµ„æºçš„æµªè´¹ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å¤ç”¨åç¨‹ï¼Œå‡å°‘äº†åç¨‹åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€\nåŠ¨æ€åç¨‹æ±  å½“æ¯ä¸€ä¸ªä»»åŠ¡æ¥ä¸´çš„æ—¶å€™åˆ›å»ºä¸€ä¸ªåç¨‹ï¼Œåˆ›å»ºçš„åç¨‹çš„æœ€å¤§æ•°é‡ç”±æœ‰å®¹é‡çš„chan æ§åˆ¶\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sync\u0026#34; 6\t\u0026#34;sync/atomic\u0026#34; 7\t\u0026#34;time\u0026#34; 8) 9 10var ( 11\tcount int64 12\twg = sync.WaitGroup{} 13\tconcurCh = make(chan bool, 5) 14) 15 16func main() { 17\t// total task N 18\tconst N = 1000 19 20\tfmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; Start Work\u0026#34;) 21\tstartAt := time.Now() 22 23\tfor i := 0; i \u0026lt; N; i++ { 24\twg.Add(1) 25\tgo func(val int) { 26\tdefer func() { 27\t\u0026lt;-concurCh 28\twg.Done() 29\t}() 30\tconcurCh \u0026lt;- true 31\tcount2 := atomic.AddInt64(\u0026amp;count, 1) 32\t\u0026lt;-time.After(100 * time.Millisecond) 33\tfmt.Printf(\u0026#34;%2d var: %v\\n\u0026#34;, count2, val) 34\t}(i) 35\t} 36 37\twg.Wait() 38\tdefer close(concurCh) 39\tfmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; Finished\u0026#34;) 40\ttotalTime := time.Now().Sub(startAt) 41\tfmt.Printf(\u0026#34;Total time is %v, total task: %v, avg time: %v\u0026#34;, totalTime, count, totalTime/time.Duration(N)) 42} 1\u0026gt;\u0026gt;\u0026gt; Finished 2Total time is 20.392798952s, total task: 1000, avg time: 20.392798ms éœ€è¦ä¸æ–­åœ°åˆ›å»ºå’Œé”€æ¯goroutineå¯èƒ½ä¼šé€ æˆé¢å¤–çš„å¼€é”€\nå®é™…æµ‹è¯•ä¸‹æ¥è¿™ä¸¤ç§å†™æ³•çš„æ€§èƒ½å·®åˆ«ä¸æ˜¯å¾ˆå¤§ã€‚\nGoroutine çš„èµ„æºå¼€é”€éå¸¸å°ï¼Œè¦é¿å…è¿‡æ¸¡çš„æ»¥ç”¨ã€‚ç‰¹åˆ«æ˜¯åœ¨å¹¶å‘è¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœGoroutineè®¾ç½®çš„è¿‡å¤šå¾ˆå®¹æ˜“æŠŠä¸‹æ¸¸æ‰“æŒ‚\n1func TestConcurrency(t *testing.T) { 2\tids := make([]int, 0) 3\tfor i := 0; i \u0026lt; 100; i++ { 4\tids = append(ids, i) 5\t} 6 7\twork := func(i, j int) { 8\t\u0026lt;-time.After(1 * time.Second) 9\tprintln(i) 10 11\t} 12 13\tblchan := make(chan int, 10) 14 15\tstartAt := time.Now() 16\twg := sync.WaitGroup{} 17\tfor i, v := range ids { 18\twg.Add(1) 19\tblchan \u0026lt;- 1 20\tgo func(i, j int) { 21\tdefer wg.Done() 22\twork(i, j) 23\t\u0026lt;- blchan 24\t}(i, v) 25\t} 26\twg.Wait() 27\tclose(blchan) 28\tprintln(time.Now().Sub(startAt).Round(time.Second).String()) 29} ","date":"August 5, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/8_go_concurrency/","summary":"å¦‚ä½•ç”¨goå®ç°ä¸€ä¸ªç®€å•çš„å¹¶è¡Œä»»åŠ¡\nGolangå¹¶å‘ 1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sync\u0026#34; 6) 7 8var wg sync.WaitGroup 9 10func printer(ch chan int) { 11\tfor i := range ch { 12\tfmt.Printf(\u0026#34;Received %d \u0026#34;, i) 13\t} 14\twg.Done() // 15} 16 17// main is the entry point for the program. 18func main() { 19\tc := make(chan int) 20\tgo printer(c) 21\twg.Add(1) 22 23\t// Send 10 integers on the channel.","tags":["Go"],"title":"ã€ŒGoã€å¹¶å‘å®ç°"},{"categories":null,"contents":"context.Contextç”¨æ¥è®¾ç½®æˆªæ­¢æ—¥æœŸã€åŒæ­¥ä¿¡å·ï¼Œä¼ é€’è¯·æ±‚ç›¸å…³å€¼çš„ç»“æ„ä½“ã€‚ä¸Šä¸‹æ–‡ä¸Goroutineæœ‰éå¸¸å¯†åˆ‡çš„å…³ç³»ã€‚\n1type Context interface{ 2 Deadline()(deadline time.Time, ok bool) 3 Done() \u0026lt;-chan struct{} 4 Err() error 5 Value(key interface{}) interface{} 6} context.Contextæœ‰å››ä¸ªæ–¹æ³•ï¼š\nDeadline() è¿”å›context.Contextè¢«å–æ¶ˆæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯å®Œæˆå·¥ä½œçš„æˆªæ­¢æ—¥æœŸï¼›\nDone() è¿”å›ä¸€ä¸ªchannelï¼Œè¿™ä¸ªchannel ä¼šåœ¨å½“å‰å·¥ä½œå®Œæˆæˆ–è€…ä¸Šä¸‹æ–‡è¢«å–æ¶ˆåå…³é—­ï¼Œå¤šæ¬¡è°ƒç”¨Doneæ–¹æ³•è¿”å›çš„æ˜¯åŒä¸€ä¸ªchannelï¼›\nErr() è¿”å›context.Context ç»“æŸçš„åŸå› ï¼Œå®ƒåªä¼šåœ¨Doneè¿”å›çš„Channelè¢«å…³é—­æ—¶æ‰ä¼šè¿”å›éç©ºçš„å€¼\nå¦‚æœ context.Context è¢«å–æ¶ˆï¼Œä¼šè¿”å›Canceledé”™è¯¯ï¼›\nå¦‚æœ context.Context è¶…æ—¶ï¼Œä¼šè¿”å›DeadlineExceededé”™è¯¯ï¼›\nValue ä»context.Context ä¸­è·å–é”®å¯¹åº”çš„å€¼ã€‚å¯¹åŒä¸€ä¸ªä¸Šä¸‹æ–‡æ¥è¯´ï¼Œå¤šæ¬¡è°ƒç”¨valueå¹¶ä¼ å…¥ç›¸åŒçš„keyä¼šè¿”å›ç›¸åŒçš„ç»“æœï¼Œè¯¥æ–¹æ³•ç”¨æ¥ä¼ é€’è¯·æ±‚ç‰¹å®šçš„æ•°æ®ã€‚\n1func main() { 2\tctx := context.Background() // new empty context 3 4\tctx = context.WithValue(ctx, \u0026#34;org\u0026#34;, \u0026#34;ali\u0026#34;) 5\tctx, _ = context.WithCancel(ctx) 6\tctx, _ = context.WithDeadline(ctx, time.Now().Add(10*time.Second)) 7\tctx, _ = context.WithTimeout(ctx, time.Second) 8 9} å‚è€ƒæ–‡æ¡£ï¼š\nhttps://draveness.me/golang/docs/part3-runtime/ch06-concurrency/golang-context/\n","date":"August 11, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/7_go_context/","summary":"context.Contextç”¨æ¥è®¾ç½®æˆªæ­¢æ—¥æœŸã€åŒæ­¥ä¿¡å·ï¼Œä¼ é€’è¯·æ±‚ç›¸å…³å€¼çš„ç»“æ„ä½“ã€‚ä¸Šä¸‹æ–‡ä¸Goroutineæœ‰éå¸¸å¯†åˆ‡çš„å…³ç³»ã€‚\n1type Context interface{ 2 Deadline()(deadline time.Time, ok bool) 3 Done() \u0026lt;-chan struct{} 4 Err() error 5 Value(key interface{}) interface{} 6} context.Contextæœ‰å››ä¸ªæ–¹æ³•ï¼š\nDeadline() è¿”å›context.Contextè¢«å–æ¶ˆæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯å®Œæˆå·¥ä½œçš„æˆªæ­¢æ—¥æœŸï¼›\nDone() è¿”å›ä¸€ä¸ªchannelï¼Œè¿™ä¸ªchannel ä¼šåœ¨å½“å‰å·¥ä½œå®Œæˆæˆ–è€…ä¸Šä¸‹æ–‡è¢«å–æ¶ˆåå…³é—­ï¼Œå¤šæ¬¡è°ƒç”¨Doneæ–¹æ³•è¿”å›çš„æ˜¯åŒä¸€ä¸ªchannelï¼›\nErr() è¿”å›context.Context ç»“æŸçš„åŸå› ï¼Œå®ƒåªä¼šåœ¨Doneè¿”å›çš„Channelè¢«å…³é—­æ—¶æ‰ä¼šè¿”å›éç©ºçš„å€¼\nå¦‚æœ context.Context è¢«å–æ¶ˆï¼Œä¼šè¿”å›Canceledé”™è¯¯ï¼›\nå¦‚æœ context.Context è¶…æ—¶ï¼Œä¼šè¿”å›DeadlineExceededé”™è¯¯ï¼›\nValue ä»context.Context ä¸­è·å–é”®å¯¹åº”çš„å€¼ã€‚å¯¹åŒä¸€ä¸ªä¸Šä¸‹æ–‡æ¥è¯´ï¼Œå¤šæ¬¡è°ƒç”¨valueå¹¶ä¼ å…¥ç›¸åŒçš„keyä¼šè¿”å›ç›¸åŒçš„ç»“æœï¼Œè¯¥æ–¹æ³•ç”¨æ¥ä¼ é€’è¯·æ±‚ç‰¹å®šçš„æ•°æ®ã€‚\n1func main() { 2\tctx := context.Background() // new empty context 3 4\tctx = context.WithValue(ctx, \u0026#34;org\u0026#34;, \u0026#34;ali\u0026#34;) 5\tctx, _ = context.WithCancel(ctx) 6\tctx, _ = context.WithDeadline(ctx, time.Now().Add(10*time.Second)) 7\tctx, _ = context.","tags":["Go"],"title":"ã€ŒGoã€context"},{"categories":null,"contents":" NRI ç›®å‰çœ‹æ¥ä¸»è¦æ˜¯å¯¹CPU å®ç°æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶ã€‚\nHistory and Background\nVarious extension mechanisms over the years\nOCI hooks\ncustom actions executed at various container lifecycle events runc , cri-o ? Runtime wrapper using runtime classes\nCustom actions implemented by custom runtime wrapper a bit of kludge runc/crun/etc.. containers/cri-o NRI\ncustom actions at pod or container creation/stop containerd NRI evolution\nSubject of this presentation? What is NRI\nNRI: Node resource interface, a common framework for\nPlugging extensionsinto OCI-compatible runtimes\nImplementing custom container configuration logic\ncommon\nplugins work identically i supported runtimes Support present in commonly used runtimes framework\nmultiple NRI pieces collectively achieve NRI\u0026rsquo;s goal pluggable extensions\nAlter behavior without runtime modifications Custom logic\nYour cluster, you plugin, your rules within the allowed boundaries imposed by NRI plumbing to enforce how containers are configured\nInitially, during container creation Subsequently, by container updates Potentially, in response to some external events =\u0026gt; you cluster, you plugin, your rules\nwithin the allowed boundaries imposed by NRI How Does it work?\nWhat can it do?\nWrite An NRI Plugin\nCPUç®¡ç†çš„ç°çŠ¶ k8sçš„cpu manger å®ŒæˆèŠ‚ç‚¹æµ‹çš„cpuèµ„æºåˆ†é…å’Œéš”ç¦»(core pinning and isolation). å¤„ç†æµç¨‹\nå‘ç°æœºå™¨cpuçš„æ‹“æ‰‘ ä¸ŠæŠ¥k8sæœºå™¨çš„å¯ç”¨èµ„æº åˆ†é…èµ„æºä¾›workloadè¿è¡Œ è¿½è¸ªpodçš„èµ„æºåˆ†é…æƒ…å†µã€‚ kubelet å°†ç³»ç»Ÿçš„CPUåˆ†ä¸ºä¸¤ä¸ªèµ„æºæ± \nexclusive poolï¼š åŒæ—¶åªæœ‰ä¸€ä¸ªä»»åŠ¡å¯ä»¥åˆ†é…åˆ°cpu share poolï¼š å¤šä¸ªè¿›ç¨‹åˆ†é…åˆ°cpu åŸç”Ÿçš„K8s cpumanger ç›®å‰åªæä¾›é™æ€çš„CPUåˆ†é…ç­–ç•¥ã€‚ å½“K8såˆ›å»ºä¸€ä¸ªpodåï¼Œpodä¼šè¢«åˆ†ç±»ä¸ºä¸€ä¸ªQos\nGuaranteed Burstable BestEffort å¹¶ä¸”kubeletå…è®¸ç®¡ç†å‘˜é€šè¿‡-reserved-cpusæŒ‡å®šä¿ç•™çš„CPUæä¾›ç»™ç³»ç»Ÿè¿›ç¨‹æˆ–è€…kube å®ˆæŠ¤è¿›ç¨‹ã€‚ä¿ç•™çš„è¿™éƒ¨åˆ†èµ„æºä¸»è¦ç»™ç³»ç»Ÿè¿›ç¨‹ä½¿ç”¨ã€‚å¯ä»¥ä½œä¸ºå…±äº«æ± åˆ†ç»™éguranteed çš„podå®¹å™¨ã€‚ ä½†æ˜¯guaranteed ç±»podæ— æ³•åˆ†é…è¿™äº›cpusã€‚\nç›®å‰K8sçš„èŠ‚ç‚¹ä¾§ä¾æ®cpuMangerçš„åˆ†é…ç­–ç•¥æ¥åˆ†é… numa nodeçš„cpusetï¼Œ èƒ½å¤Ÿåšåˆ°\nå®¹å™¨åˆ†é…åˆ°ä¸€ä¸ªnuma nodeä¸Š å®¹å™¨åˆ†é…åˆ°ä¸€ç»„å…±äº«çš„numa nodeä¸Šã€‚ cpuMangerå½“å‰é™åˆ¶ï¼š\næœ€å¤§numa nodeæ•°é‡ä¸èƒ½å¤§äº8ï¼Œé˜²æ­¢state explosion ç­–ç•¥åªæ”¯æŒé™æ€åˆ†é…cpusetï¼Œæœªæ¥ä¼šæ”¯æŒåœ¨å®¹å™¨ç”Ÿå‘½å‘¨æœŸå†…åŠ¨æ€è°ƒæ•´cpuset è°ƒåº¦å™¨ä¸æ„ŸçŸ¥èŠ‚ç‚¹ä¸Šçš„æ‹“æ‰‘ä¿¡æ¯ã€‚ å¯¹äºçº¿ç¨‹å¸ƒå±€ï¼ˆthread placementï¼‰çš„åº”ç”¨ï¼Œé˜²æ­¢ç‰©ç†æ ¸çš„å…±äº«å’Œé‚»å±…å¹²æ‰°ã€‚ CPUmanger å½“å‰ä¸æ”¯æŒã€‚ POD CPU limit Node Resource Interface containerd ä¸»è¦å·¥ä½œåœ¨å¹³å°(docker or k8s)å’Œæ›´åº•å±‚çš„ runtime (runc , kata)ä¹‹é—´ã€‚containerdæä¾›å®¹å™¨è¿›ç¨‹çš„ç®¡ç†ï¼Œ é•œåƒçš„ç®¡ç†ï¼Œæ–‡ä»¶ç³»ç»Ÿå¿«ç…§ä»¥åŠå…ƒæ•°æ®å’Œä¾èµ–ç®¡ç†ã€‚\nNRI plugin: èŠ‚ç‚¹èµ„æºæ¥å£æ’ä»¶ï¼Œç®¡ç†cgroups å’Œæ‹“æ‰‘\nNRIå¯ä»¥ç”¨æ¥è§£å†³æ‰¹é‡è®¡ç®—ï¼Œå»¶è¿Ÿæ•æ„Ÿæ€§æœåŠ¡çš„æ€§èƒ½é—®é¢˜ï¼Œ ä»¥æ»¡è¶³æœåŠ¡SLA/SLO,ä¼˜å…ˆçº§ç­‰ç”¨æˆ·éœ€æ±‚ã€‚ ä¾‹å¦‚æ€§èƒ½éœ€æ±‚ï¼Œ é€šè¿‡å°†å®¹å™¨çš„CPUåˆ†é…ç»Ÿä¸€NUMA nodeï¼Œæ¥ä¿è¯numaå†…çš„å†…å­˜è°ƒç”¨ã€‚é™¤äº†NUMAï¼Œè¿˜æœ‰CPUï¼ŒL3 cache ç­‰èµ„æºæ‹“æ‰‘äº²å’Œæ€§ã€‚\nå½“å‰kubeletçš„å®ç°çš„æ˜¯é€šè¿‡cpumanager çš„å¤„ç†å¯¹è±¡åªèƒ½æ˜¯guaranteed ç±»çš„podï¼Œ topologyManger é€šè¿‡cpuManageræä¾›çš„hintså®ç°èµ„æºåˆ†é…ã€‚\nkubelet å½“å‰ä¹Ÿä¸é€‚åˆå¤„ç†å¤šç§éœ€æ±‚çš„æ‰©å±•ï¼Œå› ä¸ºåœ¨kubeletå¢åŠ ç»†ç²’åº¦çš„èµ„æºåˆ†é…ä¼šå¯¼è‡´kubelet å’ŒCRIçš„ç•Œé™è¶Šæ¥è¶Šæ¨¡ç³Šã€‚\nè€ŒNRIï¼Œåˆ™æ˜¯åœ¨CRIåŒæœŸç”Ÿå‘½å‘¨æœŸé—´åšè°ƒç”¨ï¼Œé€‚åˆåš resource pinning å’ŒèŠ‚ç‚¹çš„æ‹“æ‰‘æ„ŸçŸ¥ã€‚å¹¶ä¸”åœ¨CRIå†…éƒ¨åšæ’ä»¶å®šä¹‰å’Œè¿­ä»£ï¼Œå¯ä»¥åšåˆ°ä¸Šå±‚ kubenetes ä»¥æœ€å°çš„ä»£ä»·æ¥é€‚é…å˜åŒ–ã€‚\nåœ¨å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼ŒCNI/NRIæ’ä»¶èƒ½å¤Ÿæ³¨å…¥å®¹å™¨åˆå§‹åŒ–è¿›ç¨‹çš„Createå’Œstartä¹‹é—´ï¼š\nCreate-\u0026gt; NRI-\u0026gt; Start\nä»¥å®˜æ–¹ä¾‹å­ clearfsï¼š åœ¨å¯åŠ¨å®¹å™¨å‰ï¼Œ ä¾æ®Qosç±»å‹è°ƒç”¨cgroupå‘½ä»¤ï¼Œcpu.cfs_quota_usä¸º-1 è¡¨ç¤ºä¸è®¾ä¸Šé™ã€‚\nNRIç›´æ¥æ§åˆ¶cgroupï¼Œæ‰€ä»¥æœ‰æ›´åº•å±‚çš„èµ„æºåˆ†é…æ–¹å¼ã€‚ ä¸è¿‡è¶Šæ¥è¿‘åº•å±‚ï¼Œå¤„ç†é€»è¾‘è¶Šå¤æ‚ã€‚\nWhy NRI:\næ”¯æŒå®šåˆ¶åŒ–æ‰©å±•ï¼Œkubelet å¯ä»¥ç›´æ¥è½½å…¥æ‰©å±•é…ç½®ï¼Œæ— éœ€ä¿®æ”¹è‡ªèº«ä»£ç \né€šè¿‡ä¸CRIäº¤äº’ï¼Œkubelet å¯ä»¥å°†éƒ¨åˆ†å¤æ‚çš„CPUåˆ†é…éœ€æ±‚ä¸‹æ–¹åˆ° runtime æ¥å¤„ç†ã€‚\nåº”ç”¨ç¨‹åºå¦‚ä½•ç‹¬å ä¸€ä¸ªCPUï¼Ÿ\nNUMA ç®€ä»‹ï¼Ÿ\ndocker -\u0026gt; containerd -\u0026gt; runc?\nhttps://www.modb.pro/db/462537\nhttps://zhuanlan.zhihu.com/p/490585683\n","date":"December 12, 2022","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/cloudnative_nri/","summary":"NRI ç›®å‰çœ‹æ¥ä¸»è¦æ˜¯å¯¹CPU å®ç°æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶ã€‚\nHistory and Background\nVarious extension mechanisms over the years\nOCI hooks\ncustom actions executed at various container lifecycle events runc , cri-o ? Runtime wrapper using runtime classes\nCustom actions implemented by custom runtime wrapper a bit of kludge runc/crun/etc.. containers/cri-o NRI\ncustom actions at pod or container creation/stop containerd NRI evolution\nSubject of this presentation? What is NRI\nNRI: Node resource interface, a common framework for","tags":null,"title":"K8s Cpu è°ƒåº¦ç®¡ç†çš„ç°çŠ¶ä¸é™åˆ¶"},{"categories":null,"contents":"Prometheus Intro Prometheus æ˜¯SoundCloudå¼€æºçš„ç³»ç»Ÿç›‘æ§å’ŒæŠ¥è­¦å·¥å…·é›†ã€‚é€šè¿‡Prometheuså¯ä»¥è¿›è¡Œæ—¶åºæ•°æ®çš„é‡‡é›†ã€ç›‘æ§å’ŒæŠ¥è­¦ã€‚\næ—¶åºæ•°æ®æ¨¡å‹ Time Series Data Model Metric æ˜¯ä¸€ä¸ªå¯¹æ—¶åºæŒ‡æ ‡çš„ç»Ÿç§°ï¼Œä¾‹å¦‚.ï¼šhttp_requests_total - the total number of HTTP requests receivedï¼Œå°±å¯ä»¥ç§°ä¸ºä¸€æ¡Metric\nåœ¨Prometheus ä¸­æ¯ä¸€ä¸ªæ—¶åºåºåˆ—(time-series)éƒ½æ˜¯ç”±äºMetric Name å’ŒLable{Key-Value}ç»„æˆçš„\nä¾‹å¦‚ï¼š\n1http_request_total{url=\u0026#34;/ping\u0026#34;,status=200} Metric Nameï¼š http_request_total åœ¨Prometheusä¸­Metric Nameåªèƒ½ç”±å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€å†’å·ç»„æˆï¼Œä¸”ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œå¯¹åº”æ­£åˆ™ä¸º[a-zA-Z_:][a-zA-Z0-9_:]*ã€‚å†’å·ä¿ç•™ï¼Œä¼šåœ¨å®šä¹‰è§„åˆ™çš„æ—¶å€™ä½¿ç”¨ã€‚\nLabel Name: host å’Œstatuséƒ½å±äºLabel. åœ¨Prometheusä¸­Label Nameåªèƒ½ç”±å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ç»„æˆï¼Œä¸”ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œå¯¹åº”çš„æ­£åˆ™ä¸º[a-zA-Z_][a-zA-Z0-9_]*ã€‚ä¸€èˆ¬_å¼€å¤´çš„Labelsä¿ç•™ä½ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨ã€‚\nNotation\nGiven a metric name and a set of labels, time series are frequently identified using this notion:\n1\u0026lt;Metric Name\u0026gt;{\u0026lt;Label Name\u0026gt;=\u0026lt;Label Value\u0026gt;,...} For example, a time series with the mertric name api_http_request_total and the label method=\u0026quot;POST\u0026quot; and handler=\u0026ldquo;message\u0026rdquo;` could be written like this. This is the same notation that OpenTSDB uses.\n1api_http_request_total{method=\u0026#34;POST\u0026#34;, handler=\u0026#34;/messages\u0026#34;} 2node_cpu_seconds_total{cpu=\u0026#34;2\u0026#34;,mode=\u0026#34;system\u0026#34;} 1\u0026lt;--- metric name------\u0026gt;\u0026lt;-----lable set------\u0026gt;\u0026lt;-timestamp -\u0026gt;\u0026lt;-value-\u0026gt; 2node_cpu_seconds_total{cpu=\u0026#34;2\u0026#34;,mode=\u0026#34;system\u0026#34;}@1434417560938 195721.31 3# timestamp æ˜¯æ¯«ç§’çº§æ—¶é—´æˆ³ 4# value æœ‰ä¸”åªæœ‰ä¸€ä¸ª float64 __ ä½œä¸ºå‰ç¼€æ ‡ç­¾ï¼Œåªèƒ½åœ¨ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨ã€‚ Promeåº•å±‚å®ç°æŒ‡æ ‡åç§°æ˜¯ä»¥__name__=\u0026lt;metric name\u0026gt;å½¢å¼å­˜å‚¨çš„ï¼Œä»¥ä¸‹ä¸¤ç§è¡¨è¾¾æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚\n1api_http_request_total{method=\u0026#34;POST\u0026#34;, handler=\u0026#34;/messages\u0026#34;} 2{__name_=api_http_request_total, method=\u0026#34;POST\u0026#34;, handler=\u0026#34;/messages\u0026#34;} Component æ‰€æœ‰åŸºç¡€ç»„ä»¶çš„å®‰è£…éƒ½åŸºäºDockerã€‚\nPrometheus 1docker pull prom/prometheus 2docker run -d -p 9090:9090 --name prometheus prom/prometheus å®‰è£…å®Œæˆåå¯ä»¥è®¿é—®9090ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°Prometheusç®¡ç†é¡µé¢ã€‚å¦‚ä¸‹å›¾ä¸ºæŸ¥è¯¢go_routinesçš„æƒ…å†µã€‚\næŸ¥è¯¢å½“å‰æ•°æ®ï¼š\n1GET http://devbox:9090/api/v1/query?query=go_goroutines\u0026amp;time=1610127237.659 æŸ¥è¯¢å†å²æ•°æ®ï¼š\n1GET http://devbox:9090/api/v1/query_range?query=go_goroutines\u0026amp;start=1610126024.257\u0026amp;end=1610126924.257\u0026amp;step=3 é…ç½®/etc/prometheus/prometheus.yaml\n1# my global config 2global: 3\t# æ‹‰å–targetçš„é»˜è®¤æ—¶é—´é—´éš” 4 scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute. 5 evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute. æ‰§è¡ŒRuleçš„æ—¶é—´é—´éš” 6 # scrape_timeout is set to the global default (10s). æ‹‰å–è¶…æ—¶æ—¶é—´ 7 8# Alertmanager configuration 9alerting: 10 alertmanagers: 11 - static_configs: 12 - targets: 13 # AlertManager ip:port å¯ä»¥é…ç½®å¤šä¸ª 14 # - alertmanager:9093 15 16# Load rules once and periodically evaluate them according to the global \u0026#39;evaluation_interval\u0026#39;. 17rule_files: 18 # - \u0026#34;first_rules.yml\u0026#34; # è§„åˆ™é…ç½®æ–‡ä»¶ 19 # - \u0026#34;second_rules.yml\u0026#34; 20 21# A scrape configuration containing exactly one endpoint to scrape: 22# Here it\u0026#39;s Prometheus itself. 23scrape_configs: 24 # The job name is added as a label `job=\u0026lt;job_name\u0026gt;` to any timeseries scraped from this config. 25 - job_name: \u0026#39;prometheus\u0026#39; 26 # metrics_path defaults to \u0026#39;/metrics\u0026#39; 27 # scheme defaults to \u0026#39;http\u0026#39;. 28 static_configs: 29 - targets: [\u0026#39;localhost:9090\u0026#39;] 30 - job_name: \u0026#39;pushgateway\u0026#39; 31 # metrics_path defaults to \u0026#39;/metrics\u0026#39; 32 # scheme defaults to \u0026#39;http\u0026#39;. 33 static_configs: 34 - targets: [\u0026#39;10.x.x.115:9091\u0026#39;] 35 - job_name: \u0026#39;alertmanager\u0026#39; 36 # metrics_path defaults to \u0026#39;/metrics\u0026#39; 37 # scheme defaults to \u0026#39;http\u0026#39;. 38 static_configs: 39 - targets: [\u0026#39;10.x.x.115:9093\u0026#39;] PushGateway 1docker pull prom/pushgateway 2docker run -d --restart=always --name pushgateway -p 9091:9091 prom/pushgateway AlertManager 1docker run -d --restart=always --name alertmanager -p 9093:9093 prom/alertmanager é…ç½®\nWebHook Test\n1import SimpleHTTPServer 2import SocketServer 3 4PORT = 5001 5 6class ServerHandler(SimpleHTTPServer.SimpleHTTPRequestHandler): 7 8 def do_POST(self): 9 content_len = int(self.headers.getheader(\u0026#39;content-length\u0026#39;, 0)) 10 post_body = self.rfile.read(content_len) 11 print post_body 12 self.send_response(200) 13 self.end_headers() 14 15Handler = ServerHandler 16 17httpd = SocketServer.TCPServer((\u0026#34;\u0026#34;, PORT), Handler) 18 19print \u0026#34;serving at port\u0026#34;, PORT 20httpd.serve_forever() Prometheus æ•°æ®ç±»å‹ Metric Type These are currently only differentiated in the client libraries and in the wire protocol. The prometheus server does not yet make user of the type information and flattens all data into untyped time series.\nCounter A counter is a cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart. For example, you can use a counter to represent the number of requests served, tasks completed, or errors.\nåªå¢ä¸å‡ï¼Œè®¡æ•°å™¨\nCounterç±»å‹çš„æŒ‡æ ‡ç›¸å½“äºä¸€ä¸ªè®¡æ•°å™¨ï¼Œåªå¢ä¸å‡ã€‚é™¤éPrometheus Clienté‡å¯ï¼Œå°†é‡æ–°è®¡æ•°ã€‚ä¾‹å¦‚ï¼šhttp_request_totalã€‚\nä¾‹å¦‚ï¼šnode_cpu_seconds_total{cpu=\u0026quot;0\u0026quot;,mode=\u0026quot;system\u0026quot;}\nåŸå§‹æŒ‡æ ‡\nrate()è·å–å¢é•¿ç‡\nrateå§‹ç»ˆå¤§äº0\ntopk() è·å–top kæ•°æ®\nGauge A gauge is a metric that represents a single numerical value that can arbitrarily go up and down.\nGauges are typically used for measured values like temperatures or current memory usage, but also \u0026ldquo;counts\u0026rdquo; that can go up and down, like the number of concurrent requests.\nGauge ç›¸å½“äºä¸€ä¸ªä»ªè¡¨ç›˜ï¼Œå¯å¢å¯å‡ï¼Œæ˜¯ä¸€ä¸ªç¬æ—¶å€¼ã€‚ ä¾‹å¦‚ï¼šnode_memory_MemFreeï¼ˆä¸»æœºå½“å‰ç©ºé—²çš„å†…å®¹å¤§å°ï¼‰ã€node_memory_MemAvailableï¼ˆå¯ç”¨å†…å­˜å¤§å°ï¼‰éƒ½æ˜¯Gaugeç±»å‹çš„ç›‘æ§æŒ‡æ ‡ã€‚\nåŸå§‹æŒ‡æ ‡\ndelta() åœ¨ä¸€å®šæ—¶é—´å†…çš„å·®å¼‚ æ¯ä¸ªç‚¹ä¸è¿‡å»2hçš„å·®å¼‚\nderiv()è®¡ç®—æ ·æœ¬çº¿æ€§å›å½’æ¨¡å‹\npredict_linear(node_memory_MemFree_bytes[10h], 4*3600) é¢„æµ‹æœªæ¥4hçš„æŒ‡æ ‡æƒ…å†µ\nHistogram A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets. It also provides a sum of all observed values.\næŸ±çŠ¶å›¾ï¼Œç”¨äºè§‚å¯Ÿç»“æœé‡‡æ ·ï¼Œåˆ†ç»„åŠç»Ÿè®¡ã€‚ä¾‹å¦‚ï¼š è¯·æ±‚æŒç»­æ—¶é—´ã€‚æ˜¯å¯¹ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®è¿›è¡Œé‡‡æ ·ï¼Œå¹¶èƒ½å¤Ÿå¯¹å…¶æŒ‡å®šåŒºé—´ä»¥åŠæ€»æ•°è¿›è¡Œç»Ÿè®¡ã€‚éœ€è¦æ ¹æ®åŒºé—´è®¡ç®—ã€‚\nHistogramæŒ‡æ ‡ç›´æ¥ååº”äº†åœ¨ä¸åŒåŒºé—´å†…æ ·æœ¬çš„ä¸ªæ•°ï¼ŒåŒºé—´é€šè¿‡æ ‡ç­¾leè¿›è¡Œå®šä¹‰ã€‚\nSummary Similar to a histogram, a summary samples observations (usually things like request durations and response sizes). While it also provides a total count of observations and a sum of all observed values, it calculates configurable quantiles over a sliding time window.\nç±»ä¼¼Histogram, ç”¨äºè¡¨ç¤ºä¸€æ®µæ—¶é—´å†…çš„æ•°æ®é‡‡æ ·ç»“æœï¼Œä¸æ˜¯ä¸´æ—¶ç®—å‡ºæ¥çš„ï¼Œç»“æœæ—©å·²å­˜å‚¨ã€‚\né•¿å°¾é—®é¢˜\nå¦‚æœå¤§å¤šæ•°APIè¯·æ±‚éƒ½ç»´æŒåœ¨100msçš„å“åº”æ—¶é—´èŒƒå›´å†…ï¼Œè€Œä¸ªåˆ«è¯·æ±‚çš„å“åº”æ—¶é—´éœ€è¦5sï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æŸäº›WEBé¡µé¢çš„å“åº”æ—¶é—´è½åˆ°ä¸­ä½æ•°çš„æƒ…å†µï¼Œè€Œè¿™ç§ç°è±¡è¢«ç§°ä¸ºé•¿å°¾é—®é¢˜ã€‚\nä¸ºäº†åŒºåˆ†æ˜¯å¹³å‡çš„æ…¢è¿˜æ˜¯é•¿å°¾çš„æ…¢ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æŒ‰ç…§è¯·æ±‚å»¶è¿Ÿçš„èŒƒå›´è¿›è¡Œåˆ†ç»„ã€‚ä¾‹å¦‚ï¼Œç»Ÿè®¡å»¶è¿Ÿåœ¨0~10msä¹‹é—´çš„è¯·æ±‚æ•°æœ‰å¤šå°‘è€Œ10~20msä¹‹é—´çš„è¯·æ±‚æ•°åˆæœ‰å¤šå°‘ã€‚é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å¿«é€Ÿåˆ†æç³»ç»Ÿæ…¢çš„åŸå› ã€‚Histogramå’ŒSummaryéƒ½æ˜¯ä¸ºäº†èƒ½å¤Ÿè§£å†³è¿™æ ·é—®é¢˜çš„å­˜åœ¨ï¼Œé€šè¿‡Histogramå’ŒSummaryç±»å‹çš„ç›‘æ§æŒ‡æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿäº†è§£ç›‘æ§æ ·æœ¬çš„åˆ†å¸ƒæƒ…å†µã€‚\næ•°æ®å­˜å…¥Prome å­˜å…¥Promçš„ç‚¹ä¼šè‡ªåŠ¨æ·»åŠ Instance\u0026amp;job ä¸¤ä¸ªtag\nå®é™…æ‰“ç‚¹ æ•°æ®å­˜å…¥Promåä¼šè‡ªåŠ¨åŠ ä¸Š instance \u0026amp; job ä¸¤ä¸ªtag\nPromQL PromQLæ˜¯Promçš„æ•°æ®æŸ¥è¯¢DSL(Domain Specified Language)è¯­è¨€ã€‚\nç»“æœç±»å‹ï¼š\nType Desc Demo ç¬æ—¶æ•°æ®ï¼ˆInstant Vectorï¼‰ åŒ…å«ä¸€ç»„TimeSeriesï¼Œæ¯ä¸ªæ—¶åºåªæœ‰ä¸€ä¸ªç‚¹ http_request_total åŒºé—´æ•°æ®ï¼ˆRange Vectorï¼‰ åŒ…å«ä¸€ç»„TimeSeries, æ¯ä¸ªæ—¶åºæœ‰å¤šä¸ªç‚¹ http_request_total[5m] çº¯é‡æ•°æ®ï¼ˆScalarï¼‰ åªæœ‰ä¸€ä¸ªæ•°æ®ï¼Œæ²¡æœ‰Time Series count(http_request_total) æŸ¥è¯¢æ–¹å¼\n1logback_events_total{level=\u0026#34;info\u0026#34;} æŸ¥è¯¢æ”¯æŒæ­£åˆ™åŒ¹é…\n1http_request_total{code!=\u0026#34;200\u0026#34;} # code != 200 2http_request_total{code=~\u0026#34;2..\u0026#34;} # code = 2xx 3http_request_total{code!~\u0026#34;2..\u0026#34;} # code != 2xx å…¶ä»–æŸ¥è¯¢\n1# å–æ•´ 2floor(avg(http_request_total{code=\u0026#34;200\u0026#34;})) 3ceil(avg(http_request_total{code=\u0026#34;200\u0026#34;})) 4# æŸ¥çœ‹æ¯ç§’æ•°æ® 5rate(http_request_total[5m]) 6 7#æ¨¡ç³ŠæŸ¥è¯¢ï¼š level=\u0026#34;inxx 8logback_events_total{level=~\u0026#34;in..\u0026#34;} 9logback_events_total{level=~\u0026#34;in.*\u0026#34;} èšåˆæŸ¥è¯¢ï¼š\n1# count 2count(logback_event_total) 3# sum 4sum(logback_event_total) 5# avg 6avg(logback_event_total) 7# topk 8topk(2, logback_events_total) 9 10# irate å¦‚æŸ¥è¯¢è¿‡å»5åˆ†é’Ÿçš„å¹³å‡å€¼ 11irate( logback_events_total[5m]) Reference https://www.jianshu.com/p/93c840025f01\nhttps://yunlzheng.gitbook.io/prometheus-book/parti-prometheus-ji-chu/promql/prometheus-promql-operators-v2\nhttps://prometheus.io/docs/concepts/data_model/#notation\n","date":"December 11, 2021","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/prometheus_intro/","summary":"Prometheus Intro Prometheus æ˜¯SoundCloudå¼€æºçš„ç³»ç»Ÿç›‘æ§å’ŒæŠ¥è­¦å·¥å…·é›†ã€‚é€šè¿‡Prometheuså¯ä»¥è¿›è¡Œæ—¶åºæ•°æ®çš„é‡‡é›†ã€ç›‘æ§å’ŒæŠ¥è­¦ã€‚\næ—¶åºæ•°æ®æ¨¡å‹ Time Series Data Model Metric æ˜¯ä¸€ä¸ªå¯¹æ—¶åºæŒ‡æ ‡çš„ç»Ÿç§°ï¼Œä¾‹å¦‚.ï¼šhttp_requests_total - the total number of HTTP requests receivedï¼Œå°±å¯ä»¥ç§°ä¸ºä¸€æ¡Metric\nåœ¨Prometheus ä¸­æ¯ä¸€ä¸ªæ—¶åºåºåˆ—(time-series)éƒ½æ˜¯ç”±äºMetric Name å’ŒLable{Key-Value}ç»„æˆçš„\nä¾‹å¦‚ï¼š\n1http_request_total{url=\u0026#34;/ping\u0026#34;,status=200} Metric Nameï¼š http_request_total åœ¨Prometheusä¸­Metric Nameåªèƒ½ç”±å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€å†’å·ç»„æˆï¼Œä¸”ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œå¯¹åº”æ­£åˆ™ä¸º[a-zA-Z_:][a-zA-Z0-9_:]*ã€‚å†’å·ä¿ç•™ï¼Œä¼šåœ¨å®šä¹‰è§„åˆ™çš„æ—¶å€™ä½¿ç”¨ã€‚\nLabel Name: host å’Œstatuséƒ½å±äºLabel. åœ¨Prometheusä¸­Label Nameåªèƒ½ç”±å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ç»„æˆï¼Œä¸”ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œå¯¹åº”çš„æ­£åˆ™ä¸º[a-zA-Z_][a-zA-Z0-9_]*ã€‚ä¸€èˆ¬_å¼€å¤´çš„Labelsä¿ç•™ä½ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨ã€‚\nNotation\nGiven a metric name and a set of labels, time series are frequently identified using this notion:\n1\u0026lt;Metric Name\u0026gt;{\u0026lt;Label Name\u0026gt;=\u0026lt;Label Value\u0026gt;,...} For example, a time series with the mertric name api_http_request_total and the label method=\u0026quot;POST\u0026quot; and handler=\u0026ldquo;message\u0026rdquo;` could be written like this.","tags":null,"title":"ã€ŒPromã€Prometheus å®‰è£…åŠä½¿ç”¨ç®€ä»‹"},{"categories":null,"contents":"12 123 https://raft.github.io/\nhttps://www.infoq.com/presentations/raft-consensus-algorithm/\nhttps://www.geeksforgeeks.org/raft-consensus-algorithm/\nhttps://www.hashicorp.com/resources/raft-consul-consensus-protocol-explained\n","date":"April 1, 2021","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/raft/","summary":"12 123 https://raft.github.io/\nhttps://www.infoq.com/presentations/raft-consensus-algorithm/\nhttps://www.geeksforgeeks.org/raft-consensus-algorithm/\nhttps://www.hashicorp.com/resources/raft-consul-consensus-protocol-explained","tags":["Raft"],"title":"ã€ŒRaftã€ The Raft Consensus Algorithm"},{"categories":null,"contents":"åŠ¨æ€è§„åˆ’ï¼š\nå­é—®é¢˜ çŠ¶æ€å®šä¹‰ DPæ–¹ç¨‹ ","date":"September 17, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/ds_dp/","summary":"åŠ¨æ€è§„åˆ’ï¼š\nå­é—®é¢˜ çŠ¶æ€å®šä¹‰ DPæ–¹ç¨‹ ","tags":[""],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•åŠ¨æ€è§„åˆ’"},{"categories":null,"contents":"https://www.cnblogs.com/-flq/p/9519276.html https://www.cnblogs.com/xuwujing/archive/2020/02/29/12385903.html\nhttps://www.elastic.co/guide/en/elasticsearch/client/go-api/current/index.html https://www.jianshu.com/p/6e28c967d872\n","date":"September 9, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/NoSQL/ElasticSearch/elasticsearch_aggregation/","summary":"https://www.cnblogs.com/-flq/p/9519276.html https://www.cnblogs.com/xuwujing/archive/2020/02/29/12385903.html\nhttps://www.elastic.co/guide/en/elasticsearch/client/go-api/current/index.html https://www.jianshu.com/p/6e28c967d872","tags":[""],"title":"post"},{"categories":null,"contents":"æŸ¥è¯¢è¯­å¥\nquery bool must exist \u0026ldquo;exists\u0026rdquo;: { \u0026ldquo;field\u0026rdquo;: \u0026ldquo;name\u0026rdquo; } åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨ must_not match \u0026ldquo;match\u0026rdquo;: { \u0026ldquo;tweet\u0026rdquo;: \u0026ldquo;elasticsearch\u0026rdquo; } åŒ¹é…å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å« should Filter ç®€å•æŸ¥è¯¢ æŸ¥è¯¢æŸä¸ªå­—æ®µæ˜¯å¦å­˜åœ¨æˆ–è€…æ˜¯å¦ä¸ºnull 1curl -H \u0026#39;Content-type: application/json\u0026#39; -XPOST \u0026#39;http://ip:9200/alert_group/_search\u0026#39; -d 1{ 2 \u0026#34;query\u0026#34;: { 3 \u0026#34;bool\u0026#34;: { 4 \u0026#34;must\u0026#34;: { // must_not 5 \u0026#34;exists\u0026#34;: { 6 \u0026#34;field\u0026#34;: \u0026#34;name\u0026#34; // å¿…é¡»å­˜åœ¨è¯¥å­—æ®µï¼Œä¸”è¯¥å­—æ®µä¸ä¸ºnull 7 } 8 } 9 } 10 } 11} ç©ºæŸ¥è¯¢ï¼ˆempty searchï¼‰ {}åœ¨åŠŸèƒ½ä¸Šç­‰ä»·äºä½¿ç”¨ match_all æŸ¥è¯¢ï¼Œ æ­£å¦‚å…¶åå­—ä¸€æ ·ï¼ŒåŒ¹é…æ‰€æœ‰æ–‡æ¡£ï¼š\n1curl -X GET \u0026#34;localhost:9200/_search?pretty\u0026#34; -H \u0026#39;Content-Type: application/json\u0026#39; -d\u0026#39; 2{ 3 \u0026#34;query\u0026#34;: { 4 \u0026#34;match_all\u0026#34;: {} 5 } 6} 7\u0026#39; Match 1GET /_search 2{ 3 \u0026#34;query\u0026#34;: { 4 \u0026#34;match\u0026#34;: { 5 \u0026#34;tweet\u0026#34;: \u0026#34;elasticsearch\u0026#34; 6 } 7 } 8} å¤åˆæŸ¥è¯¢ ç»„åˆå¤šæ¡ä»¶æŸ¥è¯¢ã€‚elasticsearchæä¾›boolæ¥å®ç°è¿™ç§éœ€æ±‚ï¼›\nä¸»è¦å‚æ•°ï¼š mustï¼šæ–‡æ¡£ å¿…é¡» åŒ¹é…è¿™äº›æ¡ä»¶æ‰èƒ½è¢«åŒ…å«è¿›æ¥ã€‚ must_notï¼šæ–‡æ¡£ å¿…é¡»ä¸ åŒ¹é…è¿™äº›æ¡ä»¶æ‰èƒ½è¢«åŒ…å«è¿›æ¥ã€‚ shouldï¼šå¦‚æœæ»¡è¶³è¿™äº›è¯­å¥ä¸­çš„ä»»æ„è¯­å¥ï¼Œæˆ–çš„å…³ç³»ï¼Œå°†å¢åŠ  _score ï¼Œå¦åˆ™ï¼Œæ— ä»»ä½•å½±å“ã€‚å®ƒä»¬ä¸»è¦ç”¨äºä¿®æ­£æ¯ä¸ªæ–‡æ¡£çš„ç›¸å…³æ€§å¾—åˆ†ã€‚ filterï¼šå¿…é¡» åŒ¹é…ï¼Œä½†å®ƒä»¥ä¸è¯„åˆ†ã€è¿‡æ»¤æ¨¡å¼æ¥è¿›è¡Œã€‚è¿™äº›è¯­å¥å¯¹è¯„åˆ†æ²¡æœ‰è´¡çŒ®ï¼Œåªæ˜¯æ ¹æ®è¿‡æ»¤æ ‡å‡†æ¥æ’é™¤æˆ–åŒ…å«æ–‡æ¡£ã€‚\nä¸€ä¸ª bool è¯­å¥ å…è®¸åœ¨ä½ éœ€è¦çš„æ—¶å€™ç»„åˆå…¶å®ƒè¯­å¥ï¼Œæ— è®ºæ˜¯ must åŒ¹é…ã€ must_not åŒ¹é…è¿˜æ˜¯ should åŒ¹é…ï¼ŒåŒæ—¶å®ƒå¯ä»¥åŒ…å«ä¸è¯„åˆ†çš„è¿‡æ»¤å™¨ï¼ˆfiltersï¼‰ï¼š\n1{ 2 \u0026#34;bool\u0026#34;: { 3 \u0026#34;must\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;tweet\u0026#34;: \u0026#34;elasticsearch\u0026#34; }}, 4 \u0026#34;must_not\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;mary\u0026#34; }}, 5 \u0026#34;should\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;tweet\u0026#34;: \u0026#34;full text\u0026#34; }}, 6 \u0026#34;filter\u0026#34;: { \u0026#34;range\u0026#34;: { \u0026#34;age\u0026#34; : { \u0026#34;gt\u0026#34; : 30 }} } 7 } 8} äº†æ‰¾å‡ºä¿¡ä»¶æ­£æ–‡åŒ…å« business opportunity çš„æ˜Ÿæ ‡é‚®ä»¶ï¼Œæˆ–è€…åœ¨æ”¶ä»¶ç®±æ­£æ–‡åŒ…å« business opportunity çš„éåƒåœ¾é‚®ä»¶ï¼š\nshouleåœ¨ä¸mustæˆ–è€…filteråŒçº§æ—¶ï¼Œé»˜è®¤æ˜¯ä¸éœ€è¦æ»¡è¶³shouldä¸­çš„ä»»ä½•æ¡ä»¶çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥åŠ ä¸Šminimum_should_match å‚æ•°ï¼Œæ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼Œå³ä¸Šè¿°ä»£ç æ”¹ä¸ºï¼š\n1{ 2 \u0026#34;bool\u0026#34;: { 3 \u0026#34;must\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;email\u0026#34;: \u0026#34;business opportunity\u0026#34; }}, 4 \u0026#34;should\u0026#34;: [ 5 { \u0026#34;match\u0026#34;: { \u0026#34;starred\u0026#34;: true }}, 6 { \u0026#34;bool\u0026#34;: { 7 \u0026#34;must\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;folder\u0026#34;: \u0026#34;inbox\u0026#34; }}, 8 \u0026#34;must_not\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;spam\u0026#34;: true }} 9 }} 10 ], 11 \u0026#34;minimum_should_match\u0026#34;: 1 12 } 13} Term ç²¾ç¡®æŸ¥è¯¢\n1GET /forum/article/_search 2{ 3 \u0026#34;query\u0026#34;: { 4 \u0026#34;constant_score\u0026#34;: { 5 \u0026#34;filter\u0026#34;: { 6 \u0026#34;bool\u0026#34;: { 7 \u0026#34;must\u0026#34; : [ 8 {\u0026#34;term\u0026#34; : {\u0026#34;tag_cnt\u0026#34; : 1}}, 9 {\u0026#34;terms\u0026#34; : {\u0026#34;tag\u0026#34; : [\u0026#34;java\u0026#34;]}} 10 ] 11 } 12 } 13 } 14 } 15} åµŒå¥—æŸ¥è¯¢ å¦‚æœdocä¸­æœ‰ä¸ªå­—æ®µæ˜¯Object Arrayï¼Œ é€šè¿‡å…¶ä¸­çš„ä¸€ä¸ªObject æŸ¥è¯¢\n1{ 2 \u0026#34;query\u0026#34;: { 3 \u0026#34;nested\u0026#34;: { 4 \u0026#34;path\u0026#34;: \u0026#34;tags\u0026#34;, // å­—æ®µå 5 \u0026#34;query\u0026#34;: { 6 \u0026#34;bool\u0026#34;: { 7 \u0026#34;must\u0026#34;: [ 8 { 9 \u0026#34;term\u0026#34;: { 10 \u0026#34;tags.key\u0026#34;: \u0026#34;k1\u0026#34; // æŸ¥æ‰¾tags ä¸­åŒ…å«object{key:k1,val:v1}çš„æ‰€æœ‰doc 11 } 12 }, 13 { 14 \u0026#34;term\u0026#34;: { 15 \u0026#34;tags.val\u0026#34;: \u0026#34;v1\u0026#34; 16 } 17 } 18 ] 19 } 20 } 21 } 22 } 23} 1{ 2 \u0026#34;query\u0026#34;: { 3 \u0026#34;nested\u0026#34;: { 4 \u0026#34;path\u0026#34;: \u0026#34;tags\u0026#34;, 5 \u0026#34;query\u0026#34;: { 6 \u0026#34;bool\u0026#34;: { 7 \u0026#34;must\u0026#34;: [ 8 { 9 \u0026#34;term\u0026#34;: { 10 \u0026#34;tags.key\u0026#34;: \u0026#34;$psm\u0026#34; 11 } 12 }, 13 { 14 \u0026#34;terms\u0026#34;: { 15 \u0026#34;tags.val\u0026#34;:[ \u0026#34;v1\u0026#34;,\u0026#34;v2\u0026#34;] // æŸ¥è¯¢å¤šä¸ªå€¼ 16 } 17 } 18 ] 19 } 20 } 21 } 22 }, 23 \u0026#34;sort\u0026#34;: [ 24 { 25 \u0026#34;created_at\u0026#34;: { 26 \u0026#34;order\u0026#34;: \u0026#34;desc\u0026#34; 27 } 28 } 29 ] 30} åœ¨æ’åºçš„è¿‡ç¨‹ä¸­ï¼Œåªèƒ½ä½¿ç”¨å¯æ’åºçš„å±æ€§è¿›è¡Œæ’åºã€‚é‚£ä¹ˆå¯ä»¥æ’åºçš„å±æ€§æœ‰å“ªäº›å‘¢ï¼Ÿ\næ•°å­— æ—¥æœŸ åµŒå¥—æŸ¥è¯¢çš„æ•ˆç‡ç›¸å¯¹æ˜¯æ¯”è¾ƒä½çš„ï¼Œå¦‚æœæ•°æ®é‡éå¸¸å¤§çš„æƒ…å†µä¸‹å°±ä¼šå‡ºç°æ…¢æŸ¥è¯¢çš„é—®é¢˜\n1//æŒ‰ç…§æ¡ä»¶æ–°å»ºä¸€ä¸ªindex ä½œä¸ºæµ‹è¯•æ•°æ®ä½¿ç”¨ 2POST _reindex 3{ 4 \u0026#34;source\u0026#34;: { 5 \u0026#34;index\u0026#34;: \u0026#34;usernested\u0026#34;, 6 \u0026#34;query\u0026#34;: { 7 \u0026#34;nested\u0026#34;: { 8 \u0026#34;path\u0026#34;: \u0026#34;tags\u0026#34;, 9 \u0026#34;query\u0026#34;: { 10 \u0026#34;bool\u0026#34;: { 11 \u0026#34;must\u0026#34;: [ 12 { 13 \u0026#34;term\u0026#34;: { 14 \u0026#34;tags.brand\u0026#34;: \u0026#34;c55fd643-1333-4647-b898-fb3e5e4e6d67\u0026#34; 15 } 16 }, 17 { 18 \u0026#34;term\u0026#34;: { 19 \u0026#34;tags.site\u0026#34;: \u0026#34;163\u0026#34; 20 } 21 } 22 ] 23 } 24 } 25 } 26 } 27 }, 28 \u0026#34;dest\u0026#34;: { 29 \u0026#34;index\u0026#34;: \u0026#34;new_usernested\u0026#34; 30 } 31} 1//æ ¹æ®æ¡ä»¶æ›´æ–°ä¸€ä¸ª nestedçš„æ–‡æ¡£ 2GET usernested/_update_by_query 3{ 4 \u0026#34;query\u0026#34;: { 5 \u0026#34;nested\u0026#34;: { 6 \u0026#34;path\u0026#34;: \u0026#34;tags\u0026#34;, 7 \u0026#34;query\u0026#34;: { 8 \u0026#34;bool\u0026#34;: { 9 \u0026#34;must\u0026#34;: [ 10 { 11 \u0026#34;term\u0026#34;: { 12 \u0026#34;tags.brand\u0026#34;: \u0026#34;c55fd643-1333-4647-b898-fb3e5e4e6d67\u0026#34; 13 } 14 }, 15 { 16 \u0026#34;term\u0026#34;: { 17 \u0026#34;tags.site\u0026#34;: \u0026#34;163\u0026#34; 18 } 19 } 20 ] 21 } 22 } 23 } 24 }, 25 \u0026#34;script\u0026#34;: { 26 \u0026#34;inline\u0026#34;: \u0026#34;for(e in ctx._source.tags){e.brand = \u0026#39;test2\u0026#39;;}\u0026#34; //æ›´æ–°nestedå­—æ®µ 27 //\u0026#34;inline\u0026#34;:\u0026#34;ctx._source.userid = \u0026#39;testid\u0026#39;\u0026#34; //æ›´æ–°æ™®é€šå­—æ®µ 28 } 29} é€šè¿‡_sourceå­—æ®µä¸­çš„includeå’Œexcludeæ¥æŒ‡å®šè¿”å›ç»“æœåŒ…å«å“ªäº›å­—æ®µï¼Œæ’é™¤å“ªäº›å­—æ®µ 1{ 2 \u0026#34;_source\u0026#34;:{ 3 \u0026#34;include\u0026#34;:[ 4 \u0026#34;policyNo\u0026#34;, 5 \u0026#34;policyRelationNo\u0026#34;, 6 \u0026#34;policyStatus\u0026#34; 7 ], 8 \u0026#34;exclude\u0026#34;:[ 9 \u0026#34;salesType\u0026#34; 10 ] 11 }, 12 \u0026#34;query\u0026#34;: { 13 \u0026#34;bool\u0026#34;: { 14 \u0026#34;must\u0026#34;: [ 15 { 16 \u0026#34;term\u0026#34;: { 17 \u0026#34;policyRelationNo\u0026#34;: \u0026#34;KR01435021\u0026#34; 18 } 19 } 20 ], 21 \u0026#34;should\u0026#34;: [], 22 \u0026#34;must_not\u0026#34;: [] 23 } 24 }, 25 \u0026#34;from\u0026#34;: 0, 26 \u0026#34;size\u0026#34;: 10 27} 1 2{ 3\t\u0026#34;_shards\u0026#34;: { 4\t\u0026#34;total\u0026#34;: 5, 5\t\u0026#34;successful\u0026#34;: 5, 6\t\u0026#34;failed\u0026#34;: 0 7\t}, 8\t\u0026#34;hits\u0026#34;: { 9\t\u0026#34;total\u0026#34;: 19, 10\t\u0026#34;max_score\u0026#34;: 11.391884, 11\t\u0026#34;hits\u0026#34;: [ 12\t{ 13\t\u0026#34;_index\u0026#34;: \u0026#34;search4policy-msad-dev3_20200520000000\u0026#34;, 14\t\u0026#34;_type\u0026#34;: \u0026#34;policy-msad-dev3\u0026#34;, 15\t\u0026#34;_id\u0026#34;: \u0026#34;4407038\u0026#34;, 16\t\u0026#34;_score\u0026#34;: 11.391884, 17\t\u0026#34;_source\u0026#34;: { 18\t\u0026#34;policyRelationNo\u0026#34;: \u0026#34;KR01435021\u0026#34;, 19\t\u0026#34;policyNo\u0026#34;: \u0026#34;B609120319\u0026#34;, 20\t\u0026#34;policyStatus\u0026#34;: 11 21\t} 22\t}, 23\t{ 24\t\u0026#34;_index\u0026#34;: \u0026#34;search4policy-msad-dev3_20200520000000\u0026#34;, 25\t\u0026#34;_type\u0026#34;: \u0026#34;policy-msad-dev3\u0026#34;, 26\t\u0026#34;_id\u0026#34;: \u0026#34;4407046\u0026#34;, 27\t\u0026#34;_score\u0026#34;: 10.713255, 28\t\u0026#34;_source\u0026#34;: { 29\t\u0026#34;policyRelationNo\u0026#34;: \u0026#34;KR01435021\u0026#34;, 30\t\u0026#34;policyNo\u0026#34;: \u0026#34;B609120323\u0026#34;, 31\t\u0026#34;policyStatus\u0026#34;: 11 32\t} 33\t} 34\t] 35\t}, 36\t\u0026#34;took\u0026#34;: 5, 37\t\u0026#34;timed_out\u0026#34;: false 38} å‚è€ƒèµ„æ–™ï¼š\nhttps://blog.csdn.net/weixin_33831196/article/details/85860371?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.add_param_isCf\u0026depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.add_param_isCf\nhttps://blog.csdn.net/u012934325/article/details/106971482/\nhttps://blog.csdn.net/qq_35393693/article/details/80143287\nhttps://segmentfault.com/a/1190000020245240\n*https://www.jianshu.com/p/c377477df7fc\nhttps://blog.csdn.net/qq_32165041/article/details/83715134\nhttps://www.jianshu.com/p/2abd2e344dcb\n","date":"September 7, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/NoSQL/ElasticSearch/elasticsearch_query/","summary":"æŸ¥è¯¢è¯­å¥\nquery bool must exist \u0026ldquo;exists\u0026rdquo;: { \u0026ldquo;field\u0026rdquo;: \u0026ldquo;name\u0026rdquo; } åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨ must_not match \u0026ldquo;match\u0026rdquo;: { \u0026ldquo;tweet\u0026rdquo;: \u0026ldquo;elasticsearch\u0026rdquo; } åŒ¹é…å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å« should Filter ç®€å•æŸ¥è¯¢ æŸ¥è¯¢æŸä¸ªå­—æ®µæ˜¯å¦å­˜åœ¨æˆ–è€…æ˜¯å¦ä¸ºnull 1curl -H \u0026#39;Content-type: application/json\u0026#39; -XPOST \u0026#39;http://ip:9200/alert_group/_search\u0026#39; -d 1{ 2 \u0026#34;query\u0026#34;: { 3 \u0026#34;bool\u0026#34;: { 4 \u0026#34;must\u0026#34;: { // must_not 5 \u0026#34;exists\u0026#34;: { 6 \u0026#34;field\u0026#34;: \u0026#34;name\u0026#34; // å¿…é¡»å­˜åœ¨è¯¥å­—æ®µï¼Œä¸”è¯¥å­—æ®µä¸ä¸ºnull 7 } 8 } 9 } 10 } 11} ç©ºæŸ¥è¯¢ï¼ˆempty searchï¼‰ {}åœ¨åŠŸèƒ½ä¸Šç­‰ä»·äºä½¿ç”¨ match_all æŸ¥è¯¢ï¼Œ æ­£å¦‚å…¶åå­—ä¸€æ ·ï¼ŒåŒ¹é…æ‰€æœ‰æ–‡æ¡£ï¼š\n1curl -X GET \u0026#34;localhost:9200/_search?pretty\u0026#34; -H \u0026#39;Content-Type: application/json\u0026#39; -d\u0026#39; 2{ 3 \u0026#34;query\u0026#34;: { 4 \u0026#34;match_all\u0026#34;: {} 5 } 6} 7\u0026#39; Match 1GET /_search 2{ 3 \u0026#34;query\u0026#34;: { 4 \u0026#34;match\u0026#34;: { 5 \u0026#34;tweet\u0026#34;: \u0026#34;elasticsearch\u0026#34; 6 } 7 } 8} å¤åˆæŸ¥è¯¢ ç»„åˆå¤šæ¡ä»¶æŸ¥è¯¢ã€‚elasticsearchæä¾›boolæ¥å®ç°è¿™ç§éœ€æ±‚ï¼›","tags":["ElasticSearch"],"title":"ã€ŒElasticSearchã€ ElasticSearch ç®€å•æŸ¥è¯¢"},{"categories":null,"contents":"Sliceçš„å‘ 1numList := make([]int, 10) 2// äº§ç”Ÿçš„numListä¼šå­˜å…¥10ä¸ª0ï¼Œ å¦‚æœç»§ç»­append æ•°æ®ä¼šå¯¼è‡´numListçš„æ•°æ®è¶…è¿‡10 Slice æ‰©å®¹\n1func TestSliceExtend(t *testing.T) { 2\tcapacity := 0 3\tlist := make([]int, 0) 4\tfor i := 0; i \u0026lt; 4096; i++ { 5\tlist = append(list, i) 6\tif capacity != cap(list) { 7\ttimes := float64(cap(list)) / float64(capacity) 8\tdiffer := cap(list) - capacity 9\tcapacity = cap(list) 10\tif times == 2.0 { 11\tfmt.Printf(\u0026#34;capacity is: %d \\t times: %.2f \\n\u0026#34;, capacity, times) 12\t} else { 13\tfmt.Printf(\u0026#34;capacity is: %d \\t times: %.2f \\t differ: %d \\n\u0026#34;, capacity, times, differ) 14\t} 15\t} 16\t} 17} ","date":"September 2, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/5.3_go_slice/","summary":"Sliceçš„å‘ 1numList := make([]int, 10) 2// äº§ç”Ÿçš„numListä¼šå­˜å…¥10ä¸ª0ï¼Œ å¦‚æœç»§ç»­append æ•°æ®ä¼šå¯¼è‡´numListçš„æ•°æ®è¶…è¿‡10 Slice æ‰©å®¹\n1func TestSliceExtend(t *testing.T) { 2\tcapacity := 0 3\tlist := make([]int, 0) 4\tfor i := 0; i \u0026lt; 4096; i++ { 5\tlist = append(list, i) 6\tif capacity != cap(list) { 7\ttimes := float64(cap(list)) / float64(capacity) 8\tdiffer := cap(list) - capacity 9\tcapacity = cap(list) 10\tif times == 2.0 { 11\tfmt.Printf(\u0026#34;capacity is: %d \\t times: %.","tags":[""],"title":"ã€ŒGoã€slice"},{"categories":null,"contents":"\rGit æ•°æ®å­˜å‚¨çš„åŸºæœ¬æ¦‚å¿µ WorkSpace: å·¥ä½œåŒºï¼Œç¼–è¾‘ä¿®æ”¹æ–‡ä»¶çš„åŒºåŸŸ\nIndex/Stage: æš‚å­˜åŒºï¼Œ æœªæäº¤ä¿®æ”¹\nRepositoryï¼š æœ¬åœ°ä»“åº“\nRemoteï¼š è¿œç¨‹ä»“åº“\næˆ‘ä»¬ä½¿ç”¨ç¼–è¾‘å™¨å†™ä»£ç çš„åŒºåŸŸå°±æ˜¯WorkSpace, æ‰§è¡Œgit add fileNameä¹‹åï¼Œå°±å°†ä¿®æ”¹çš„æ–‡ä»¶æäº¤åˆ°äº†æš‚å­˜åŒºï¼Œæ‰§è¡Œgit commmit -m \u0026quot;update fineName\u0026quot; ä¹‹åå°±å°†ä¿®æ”¹æäº¤åˆ°äº†æœ¬åœ°ç‰ˆæœ¬åº“ã€‚æœ€åä½¿ç”¨ git push å°†ä¿®æ”¹æäº¤åˆ°è¿œç¨‹ä»“åº“ã€‚\nGit å¸¸ç”¨æ“ä½œ é…ç½®ç”¨æˆ·åä»¥åŠé‚®ç®± è®¾ç½®\n1git config --global user.Name \u0026#34;name\u0026#34; 2git config --global user.email \u0026#34;xxx@outlook.com\u0026#34; æŸ¥çœ‹\n1git config user.name 2git config user.email åˆå§‹åŒ–Gitä»“åº“ git init 1git init fileName 2# or ä¸æŒ‡å®šè·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰è·¯å¾„ 3git init åˆå§‹åŒ–ä»“åº“åï¼Œä¼šç”Ÿæˆä¸€.gitçš„éšè—æ–‡ä»¶å¤¹\nå»ºç«‹è£¸ä»“åº“\n1git init --bare bare_repo å¯¹æ¯”æ­£å¸¸gitä»“åº“normal_repoä¸bare_repoçš„ç›®å½•ç»“æ„å‘ç°ï¼Œåœ¨normal_repo/.git æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ç›´æ¥å‡ºç°åœ¨äº†bare_repo ä¸­\nåˆ‡æ¢åˆ†æ”¯ã€‚\nåœ¨ä¸€ä¸ªè£¸ä»“åº“ä¸­æ‰§è¡Œgitå‘½ä»¤ä¼šæç¤ºthis operation must be run in a work treeã€‚å› ä¸ºè£¸ä»“åº“æ˜¯æ²¡æœ‰å·¥ä½œåŒºçš„ï¼Œåªä¼šè®°å½•gitæäº¤çš„å†å²ä¿¡æ¯ï¼Œgit logå¯ä»¥æŸ¥çœ‹æäº¤å†å²ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•è¿›è¡Œç‰ˆæœ¬å›é€€æˆ–è€…åˆ‡åˆ†åˆ†æ”¯çš„æ“ä½œã€‚\nä½†æ˜¯å¯ä»¥é€šè¿‡hookså»ºç«‹ä¸€ä¸ªå•ç‹¬å­˜æ”¾æºç çš„æ–‡ä»¶å¤¹ï¼Œå°†gitä»“åº“ä¸é¡¹ç›®æºç åˆ†ç¦»å­˜æ”¾ã€‚è¿œç¨‹ä»“åº“å¾€è¿™ä¸ªrepoçš„æ¨é€æ›´æ–°ä¼šæ›´æ–°æºç æ–‡ä»¶å¤¹çš„å†…å®¹ã€‚å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªæŠ€å·§åœ¨Hexoéƒ¨ç½²ä¸­çš„å®æˆ˜.\nåˆ‡æ¢branch åˆ‡æ¢æœ¬åœ°çš„branch\nåˆ‡æ¢åˆ°è¿œç¨‹branch åˆ°æœ¬åœ°\nåˆ‡æ¢commit å¤šæ¬¡commitåˆå¹¶ä¸ºä¸€ä¸ªcommit 1git rebase -i \u0026lt;commitId\u0026gt; commitIdæ˜¯ä¸éœ€è¦è¢«åˆå¹¶çš„ä¸€æ¬¡commitï¼Œ æ˜¯éœ€è¦åˆå¹¶çš„commitçš„ä¸Šä¸€ä¸ªcommitIdã€‚\nä¿®æ”¹commitä¿¡æ¯ ä¿®æ”¹å†å²commitä¿¡æ¯ï¼šåŒä¸Š\nä¿®æ”¹æœ€æ–°çš„ä¸€æ¬¡commitçš„ä¿¡æ¯\n1git commit --amend \u0026#34;message\u0026#34; rebaseå’Œmergeçš„åŒºåˆ« git rebase æ’¤é”€\ngit \u0026ndash;abort/\u0026ndash;continue\n1git reflog 2 3git reset --hard \u0026lt;commit id\u0026gt; git stash çš„ä½¿ç”¨ git stashç”¨äºä¸´æ—¶ä¿å­˜å’Œæ¢å¤ä¿®æ”¹, å¯ä»¥è·¨åˆ†æ”¯\nåœ¨æœªaddä¹‹å‰æ‰èƒ½æ‰§è¡Œgit stash\ngit stash [save] [message] ä¿å­˜ï¼Œsaveä¸ºå¯é€‰é¡¹ï¼Œmessageä¸ºæœ¬æ¬¡ä¿å­˜çš„æ³¨é‡Š\ngit stash list æ‰€æœ‰ä¿å­˜çš„è®°å½•åˆ—è¡¨\ngit stash pop stash@{num} æ¢å¤ï¼Œnumæ˜¯å¯é€‰é¡¹ï¼Œé€šè¿‡git stash listå¯æŸ¥çœ‹å…·ä½“å€¼ã€‚åªèƒ½æ¢å¤ä¸€æ¬¡\ngit stash apply stash@{num} æ¢å¤ï¼Œnumæ˜¯å¯é€‰é¡¹ï¼Œé€šè¿‡git stash listå¯æŸ¥çœ‹å…·ä½“å€¼ã€‚å¯å›å¤å¤šæ¬¡\ngit stash drop stash@{num} åˆ é™¤æŸä¸ªä¿å­˜ï¼Œnumæ˜¯å¯é€‰é¡¹ï¼Œé€šè¿‡git stash listå¯æŸ¥çœ‹å…·ä½“å€¼\ngit stash clear åˆ é™¤æ‰€æœ‰ä¿å­˜\n1git branch -a # æŸ¥çœ‹æ‰€æœ‰çš„åˆ†æ”¯ 2git branch # æŸ¥çœ‹å½“å‰ä½¿ç”¨åˆ†æ”¯(ç»“æœåˆ—è¡¨ä¸­å‰é¢æ ‡*å·çš„è¡¨ç¤ºå½“å‰ä½¿ç”¨åˆ†æ”¯) 3git checkout {$branchName} # åˆ‡æ¢åˆ†æ”¯ 1git config --global init.defaultBranch main éœ€è¦è§£å†³çš„é—®é¢˜\ngit stash æ˜¯ä¿å­˜åœ¨äº†å“ªé‡Œ git reset \u0026amp; git revert git rebase git init \u0026amp; git init -bareã€ è§£å†³å†²çª git commit \u0026ndash;amend https://www.jianshu.com/p/699ed86028c2\nhttps://www.liaoxuefeng.com/wiki/896043488029600/900004590234208\ngitignoreåªèƒ½å¿½ç•¥æœªtrackçš„æ–‡ä»¶\nGit çŸ¥è¯†ç§¯ç´¯\nhttps://zhuanlan.zhihu.com/p/147356242\nhttps://www.jianshu.com/p/e5b13480479b\nhttps://www.cnblogs.com/rainbowk/p/10932322.html\n","date":"August 26, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/git_stage_repo/","summary":"Git æ•°æ®å­˜å‚¨çš„åŸºæœ¬æ¦‚å¿µ WorkSpace: å·¥ä½œåŒºï¼Œç¼–è¾‘ä¿®æ”¹æ–‡ä»¶çš„åŒºåŸŸ\nIndex/Stage: æš‚å­˜åŒºï¼Œ æœªæäº¤ä¿®æ”¹\nRepositoryï¼š æœ¬åœ°ä»“åº“\nRemoteï¼š è¿œç¨‹ä»“åº“\næˆ‘ä»¬ä½¿ç”¨ç¼–è¾‘å™¨å†™ä»£ç çš„åŒºåŸŸå°±æ˜¯WorkSpace, æ‰§è¡Œgit add fileNameä¹‹åï¼Œå°±å°†ä¿®æ”¹çš„æ–‡ä»¶æäº¤åˆ°äº†æš‚å­˜åŒºï¼Œæ‰§è¡Œgit commmit -m \u0026quot;update fineName\u0026quot; ä¹‹åå°±å°†ä¿®æ”¹æäº¤åˆ°äº†æœ¬åœ°ç‰ˆæœ¬åº“ã€‚æœ€åä½¿ç”¨ git push å°†ä¿®æ”¹æäº¤åˆ°è¿œç¨‹ä»“åº“ã€‚\nGit å¸¸ç”¨æ“ä½œ é…ç½®ç”¨æˆ·åä»¥åŠé‚®ç®± è®¾ç½®\n1git config --global user.Name \u0026#34;name\u0026#34; 2git config --global user.email \u0026#34;xxx@outlook.com\u0026#34; æŸ¥çœ‹\n1git config user.name 2git config user.email åˆå§‹åŒ–Gitä»“åº“ git init 1git init fileName 2# or ä¸æŒ‡å®šè·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰è·¯å¾„ 3git init åˆå§‹åŒ–ä»“åº“åï¼Œä¼šç”Ÿæˆä¸€.gitçš„éšè—æ–‡ä»¶å¤¹\nå»ºç«‹è£¸ä»“åº“\n1git init --bare bare_repo å¯¹æ¯”æ­£å¸¸gitä»“åº“normal_repoä¸bare_repoçš„ç›®å½•ç»“æ„å‘ç°ï¼Œåœ¨normal_repo/.git æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ç›´æ¥å‡ºç°åœ¨äº†bare_repo ä¸­\nåˆ‡æ¢åˆ†æ”¯ã€‚\nåœ¨ä¸€ä¸ªè£¸ä»“åº“ä¸­æ‰§è¡Œgitå‘½ä»¤ä¼šæç¤ºthis operation must be run in a work treeã€‚å› ä¸ºè£¸ä»“åº“æ˜¯æ²¡æœ‰å·¥ä½œåŒºçš„ï¼Œåªä¼šè®°å½•gitæäº¤çš„å†å²ä¿¡æ¯ï¼Œgit logå¯ä»¥æŸ¥çœ‹æäº¤å†å²ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•è¿›è¡Œç‰ˆæœ¬å›é€€æˆ–è€…åˆ‡åˆ†åˆ†æ”¯çš„æ“ä½œã€‚","tags":[""],"title":"ã€ŒGitã€ Git å·¥ä½œåŒº\u0026æš‚å­˜åŒº\u0026æœ¬åœ°ä»“åº“\u0026è¿œç¨‹ä»“åº“ä»¥åŠåŸºæœ¬æ“ä½œ"},{"categories":null,"contents":"HTTPç®€ä»‹ HTTPåè®®ï¼ˆHyperText Transfer Protocolï¼Œ è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰ï¼Œæ˜¯ä¸€ä¸ªåŸºäºTCP/IPé€šä¿¡åè®®æ¥ä¼ è¾“æ•°æ®ã€‚æ˜¯ç”¨äºä»æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„åè®®ã€‚HTTPä½¿ç”¨åŒä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifiers, URLï¼‰æ¥ä¼ è¾“æ•°æ®å’Œå»ºç«‹è¿æ¥ã€‚\nHTTPåè®®å·¥ä½œäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯ï¼ˆC-Sï¼‰æ¶æ„ä¸Šã€‚æµè§ˆå™¨ä½œä¸ºHTTPå®¢æˆ·ç«¯é€šè¿‡URLå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œå¹¶è·å¾—è¿”å›æ•°æ®ã€‚\nHTTPç‰¹ç‚¹ï¼š\nHTTPæ˜¯æ— è¿æ¥çš„ï¼š æ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚\nHTTPæ˜¯æ— çŠ¶æ€çš„ï¼š HTTPæ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†ç­æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡ä¼ è¾“çš„æ•°æ®é‡å¢å¤§ã€‚\nHTTPæ˜¯åª’ä½“ç‹¬ç«‹çš„ï¼š ä»»ä½•æ•°æ®ç±»å‹éƒ½å¯ä»¥é€šè¿‡HTTPå‘é€ï¼Œå®¢æˆ·ç«¯ä»¥åŠæœåŠ¡å™¨è¦æŒ‡å®šç›¸åŒçš„MIME-typeç±»å‹ã€‚åª’ä½“ç±»å‹é€šå¸¸é€šè¿‡ HTTP åè®®ï¼Œç”± Web æœåŠ¡å™¨å‘ŠçŸ¥æµè§ˆå™¨çš„ï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯é€šè¿‡ Content-Type æ¥è¡¨ç¤ºçš„ã€‚ä¾‹å¦‚ï¼šContent-Typeï¼štext/HTMLã€‚é€šå¸¸åªæœ‰å¹¿æ³›åº”ç”¨çš„æ ¼å¼æ‰ä¼šè·å¾—ä¸€ä¸ª MIME Typeï¼Œå¦‚æœæ˜¯æŸä¸ªå®¢æˆ·ç«¯è‡ªå·±å®šä¹‰çš„æ ¼å¼ï¼Œä¸€èˆ¬åªèƒ½ä»¥ application/x- å¼€å¤´ã€‚\nWeb-Browser \u0026lt;===\u0026gt; HTTP Server \u0026lt;===\u0026gt; CGI(Common GateWay Interface) Program \u0026lt;==\u0026gt;Database\nå®¢æˆ·ç«¯è¯·æ±‚æ¶ˆæ¯ è¯·æ±‚æ¶ˆæ¯åŒ…æ‹¬ä»¥ä¸‹æ ¼å¼ï¼šè¯·æ±‚è¡Œï¼ˆrequest lineï¼‰ã€è¯·æ±‚å¤´éƒ¨ï¼ˆheaderï¼‰ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®å››ä¸ªéƒ¨åˆ†ç»„æˆ\næœåŠ¡å™¨å“åº”æ¶ˆæ¯ å“åº”ä¹Ÿç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šçŠ¶æ€è¡Œã€æ¶ˆæ¯æŠ¥å¤´ã€ç©ºè¡Œå’Œå“åº”æ­£æ–‡ã€‚\nä¸å¸¦Body çš„è¯·æ±‚ 1# è¯·æ±‚æ¶ˆæ¯ 2GET /health HTTP/1.1 3Host: 127.0.0.1:8080 4User-Agent: curl/7.65.3 5Accept: */* 6 7# è¿”å›æ¶ˆæ¯ 8HTTP/1.1 200 OK 9Content-Type: text/plain; charset=utf-8 10Date: Sat, 22 Aug 2020 17:56:22 GMT 11Content-Length: 2 12 13ok å¸¦Bodyçš„è¯·æ±‚ 1# è¯·æ±‚æ¶ˆæ¯ 2GET /health?val=123 HTTP/1.1 3Host: localhost:8080 4User-Agent: curl/7.65.3 5Accept: */* 6Content-Type: text/plain 7Content-Length: 9 8 9body test 10 11# è¿”å›æ¶ˆæ¯ 12HTTP/1.1 200 OK 13Content-Type: text/plain; charset=utf-8 14Date: Sat, 22 Aug 2020 18:17:14 GMT 15Content-Length: 7 16 17ok: 123 Http9ç§è¯·æ±‚ httpå®šä¹‰äº†9ä¸­è¯·æ±‚åŠ¨ä½œï¼Œæ¥è¡¨æ˜å¯¹Request-URIæŒ‡å®šçš„èµ„æºè¿›è¡Œä¸åŒçš„æ“ä½œæ–¹å¼ã€‚æ˜¯ä¸€ç§httpåè®®çš„ä½¿ç”¨è§„èŒƒã€‚\nHTTP1.0 å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼š GET, POST å’Œ HEADæ–¹æ³•ã€‚\nHTTP1.1 æ–°å¢äº†å…­ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONSã€PUTã€PATCHã€DELETEã€TRACE å’Œ CONNECT æ–¹æ³•ã€‚\nMethod Intro ä½¿ç”¨çº¦æŸ å¹‚ç­‰æ€§ GET å‘ç‰¹å®šèµ„æºå‘èµ·è¯·æ±‚ã€‚ åªæ˜¯è·å–æ•°æ®ï¼Œå¹¶ä¸ä¼šå¯¹æ•°æ®é€ æˆä¿®æ”¹ å¹‚ç­‰ POST å‘ç‰¹å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œè¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…åˆ›å»ºæ–‡ä»¶ï¼‰ï¼Œè¯·æ±‚æ•°æ®ç±»å‹ï¼š multipart/form-data**æˆ– application/x-www-form-urlencoded ä¸€èˆ¬æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä½“ï¼ˆä¾‹å¦‚æ–°å¢ä¸€ä¸ªå‘˜å·¥ä¿¡æ¯ï¼‰ PUT å‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ æœ€æ–°çš„å†…å®¹ ä¸€èˆ¬æ˜¯æ›´æ–°ä¸€ä¸ªå·²æœ‰å®ä½“ï¼ˆæ›´æ–°å‘˜å·¥ä¿¡æ¯ï¼‰ DELETE è¯·æ±‚åˆ é™¤Request-URIæ‰€æ ‡è¯†çš„èµ„æº åˆ é™¤èµ„æºï¼ˆåˆ é™¤æŸä¸ªå‘˜å·¥ä¿¡æ¯ï¼‰ PATCH å¯¹PUTçš„è¡¥å……ï¼Œé»˜è®¤æ˜¯ä»¥x-www-form-urlencodedçš„contentType ç”¨æ¥æ›´æ–°éƒ¨åˆ†èµ„æº HEAD å‘æœåŠ¡å™¨è¯·æ±‚ä¸GETä¸€è‡´çš„å“åº”ï¼Œå“åº”ä½“ä¸è¿”å›ï¼Œå“åº”å¤´è¿”å› å¹‚ç­‰ OPTIONS è¿”å›æœåŠ¡å…¶é’ˆå¯¹ç‰¹å®šèµ„æºæ‰€æ”¯æŒçš„HTTPè¯·æ±‚æ–¹æ³•ï¼Œå‘é€*æµ‹è¯•æœåŠ¡å™¨çš„åŠŸèƒ½æ€§ TRACE å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è€…è¯Šæ–­ æä¾›ä¸€ç§æ–¹æ³•æ¥æµ‹è¯•å½“ä¸€ä¸ªè¯·æ±‚å‘ç”Ÿçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨é€šè¿‡ç½‘ç»œæ”¶åˆ°çš„å†…å®¹ã€‚æ‰€ä»¥å®ƒä¼šè¿”å›ä½ å‘é€çš„å†…å®¹ã€‚ CONNECT HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ è™½ç„¶HTTPçš„è¯·æ±‚æ–¹å¼æœ‰9ç§ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­å¸¸ç”¨çš„ä¹Ÿå°±æ˜¯getå’Œpostï¼Œå…¶ä»–è¯·æ±‚æ–¹å¼ä¹Ÿéƒ½å¯ä»¥é€šè¿‡è¿™ä¸¤ç§æ–¹å¼é—´æ¥çš„æ¥å®ç°ã€‚\nGET å’Œ POSTçš„åŒºåˆ« GET POST å¹‚ç­‰æ€§ GETå’ŒHEADè¯·æ±‚æ˜¯å¹‚ç­‰çš„ ï¼Œè¢«ç§°ä¸ºå®‰å…¨æ–¹æ³•ã€‚ä¸ä¼šå¯¹æœåŠ¡ç«¯çš„ä¿¡æ¯äº§ç”Ÿä¿®æ”¹ éå¹‚ç­‰çš„ï¼Œå¯èƒ½ä¼šä¿®æ”¹æœåŠ¡å™¨çš„èµ„æº Url è¯·æ±‚æ•°æ®é™„åŠ åœ¨åœ¨URLä¸­ï¼Œä»¥\u0026quot;?\u0026ldquo;é“¾æ¥URLå’Œè¯·æ±‚æ•°æ®ï¼Œå¤šä¸ªå‚æ•°ä½¿ç”¨\u0026amp;è¿æ¥ã€‚URLç¼–ç é‡‡ç”¨ASCIIç¼–ç ï¼Œæ‰€æœ‰çš„éASCIIå­—ç¬¦éƒ½è¦åœ¨ç¼–ç åä¼ è¾“ã€‚å¯ä»¥ä¿å­˜ä¸ºæµè§ˆå™¨ä¹¦ç­¾ è¯·æ±‚æ•°æ®åœ¨Bodyä¸­ ä¼ è¾“æ•°æ®å¤§å° åœ¨HTTPè§„èŒƒä¸­å¯¹åœ°å€æ çš„é•¿åº¦å’Œä¼ è¾“æ•°æ®çš„å¤§å°æ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯ï¼Œç‰¹å®šçš„æµè§ˆå™¨å’ŒæœåŠ¡ç«¯å¯¹URLçš„é•¿åº¦æœ‰é™åˆ¶ã€‚ä½¿ç”¨GETè¯·æ±‚æ—¶å€™ï¼Œä¼ è¾“æ•°æ®ä¼šå—åˆ°URLé•¿åº¦çš„é™åˆ¶ã€‚ ä¼ è¾“æ•°æ®å¤§å°ç†è®ºä¸Šä¸å—é™åˆ¶ å®‰å…¨æ€§ GETè¯·æ±‚ä¼šæŠŠä¿¡æ¯æš´éœ²åœ¨åœ°å€æ ï¼Œå¯èƒ½ä¼šé€šè¿‡æµè§ˆå™¨ç¼“å­˜æˆ–è€…å†å²è®°å½•æš´éœ²ä¿¡æ¯ã€‚GETè¯·æ±‚æäº¤çš„æ•°æ®è¿˜å¯èƒ½é€ æˆCross-site request frogeryæ”»å‡»ï¼Œå³åˆ©ç”¨ç½‘ç«™å¯¹ç”¨æˆ·æ ‡è¯†çš„ä¿¡ä»»æ¬ºéª—ç”¨æˆ·çš„æµè§ˆå™¨å‘é€HTTPè¯·æ±‚ç»™ç›®æ ‡ç«™ç‚¹ ä¸å­˜åœ¨ä¸Šè¿°é—®é¢˜ HTTP å“åº”å¤´ä¿¡æ¯ åº”ç­”å¤´ è¯´æ˜ Allow æœåŠ¡å™¨æ”¯æŒå“ªäº›è¯·æ±‚æ–¹æ³•ï¼ˆå¦‚GETã€POSTç­‰ï¼‰ã€‚ Content-Encoding æ–‡æ¡£çš„ç¼–ç ï¼ˆEncodeï¼‰æ–¹æ³•ã€‚åªæœ‰åœ¨è§£ç ä¹‹åæ‰å¯ä»¥å¾—åˆ°Content-Typeå¤´æŒ‡å®šçš„å†…å®¹ç±»å‹ã€‚åˆ©ç”¨gzipå‹ç¼©æ–‡æ¡£èƒ½å¤Ÿæ˜¾è‘—åœ°å‡å°‘HTMLæ–‡æ¡£çš„ä¸‹è½½æ—¶é—´ã€‚Javaçš„GZIPOutputStreamå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œgzipå‹ç¼©ï¼Œä½†åªæœ‰Unixä¸Šçš„Netscapeå’ŒWindowsä¸Šçš„IE 4ã€IE 5æ‰æ”¯æŒå®ƒã€‚å› æ­¤ï¼ŒServletåº”è¯¥é€šè¿‡æŸ¥çœ‹Accept-Encodingå¤´ï¼ˆå³request.getHeader(\u0026quot;Accept-Encoding\u0026quot;)ï¼‰æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒgzipï¼Œä¸ºæ”¯æŒgzipçš„æµè§ˆå™¨è¿”å›ç»gzipå‹ç¼©çš„HTMLé¡µé¢ï¼Œä¸ºå…¶ä»–æµè§ˆå™¨è¿”å›æ™®é€šé¡µé¢ã€‚ Content-Length è¡¨ç¤ºå†…å®¹é•¿åº¦ã€‚åªæœ‰å½“æµè§ˆå™¨ä½¿ç”¨æŒä¹…HTTPè¿æ¥æ—¶æ‰éœ€è¦è¿™ä¸ªæ•°æ®ã€‚å¦‚æœä½ æƒ³è¦åˆ©ç”¨æŒä¹…è¿æ¥çš„ä¼˜åŠ¿ï¼Œå¯ä»¥æŠŠè¾“å‡ºæ–‡æ¡£å†™å…¥ ByteArrayOutputStreamï¼Œå®ŒæˆåæŸ¥çœ‹å…¶å¤§å°ï¼Œç„¶åæŠŠè¯¥å€¼æ”¾å…¥Content-Lengthå¤´ï¼Œæœ€åé€šè¿‡byteArrayStream.writeTo(response.getOutputStream()å‘é€å†…å®¹ã€‚ Content-Type è¡¨ç¤ºåé¢çš„æ–‡æ¡£å±äºä»€ä¹ˆMIMEç±»å‹ã€‚Servleté»˜è®¤ä¸ºtext/plainï¼Œä½†é€šå¸¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šä¸ºtext/htmlã€‚ç”±äºç»å¸¸è¦è®¾ç½®Content-Typeï¼Œå› æ­¤HttpServletResponseæä¾›äº†ä¸€ä¸ªä¸“ç”¨çš„æ–¹æ³•setContentTypeã€‚ Date å½“å‰çš„GMTæ—¶é—´ã€‚ä½ å¯ä»¥ç”¨setDateHeaderæ¥è®¾ç½®è¿™ä¸ªå¤´ä»¥é¿å…è½¬æ¢æ—¶é—´æ ¼å¼çš„éº»çƒ¦ã€‚ Expires åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™è®¤ä¸ºæ–‡æ¡£å·²ç»è¿‡æœŸï¼Œä»è€Œä¸å†ç¼“å­˜å®ƒ Last-Modified æ–‡æ¡£çš„æœ€åæ”¹åŠ¨æ—¶é—´ã€‚å®¢æˆ·å¯ä»¥é€šè¿‡If-Modified-Sinceè¯·æ±‚å¤´æä¾›ä¸€ä¸ªæ—¥æœŸï¼Œè¯¥è¯·æ±‚å°†è¢«è§†ä¸ºä¸€ä¸ªæ¡ä»¶GETï¼Œåªæœ‰æ”¹åŠ¨æ—¶é—´è¿ŸäºæŒ‡å®šæ—¶é—´çš„æ–‡æ¡£æ‰ä¼šè¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª304ï¼ˆNot Modifiedï¼‰çŠ¶æ€ã€‚Last-Modifiedä¹Ÿå¯ç”¨setDateHeaderæ–¹æ³•æ¥è®¾ç½®ã€‚ Location è¡¨ç¤ºå®¢æˆ·åº”å½“åˆ°å“ªé‡Œå»æå–æ–‡æ¡£ã€‚Locationé€šå¸¸ä¸æ˜¯ç›´æ¥è®¾ç½®çš„ï¼Œè€Œæ˜¯é€šè¿‡HttpServletResponseçš„sendRedirectæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åŒæ—¶è®¾ç½®çŠ¶æ€ä»£ç ä¸º302ã€‚ Refresh è¡¨ç¤ºæµè§ˆå™¨åº”è¯¥åœ¨å¤šå°‘æ—¶é—´ä¹‹ååˆ·æ–°æ–‡æ¡£ï¼Œä»¥ç§’è®¡ã€‚é™¤äº†åˆ·æ–°å½“å‰æ–‡æ¡£ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡setHeader(\u0026quot;Refresh\u0026quot;, \u0026quot;5; URL=http://host/path\u0026quot;)è®©æµè§ˆå™¨è¯»å–æŒ‡å®šçš„é¡µé¢ã€‚ æ³¨æ„è¿™ç§åŠŸèƒ½é€šå¸¸æ˜¯é€šè¿‡è®¾ç½®HTMLé¡µé¢HEADåŒºçš„ï¼œMETA HTTP-EQUIV=\u0026quot;Refresh\u0026quot; CONTENT=\u0026quot;5;URL=http://host/path\u0026quot;ï¼å®ç°ï¼Œè¿™æ˜¯å› ä¸ºï¼Œè‡ªåŠ¨åˆ·æ–°æˆ–é‡å®šå‘å¯¹äºé‚£äº›ä¸èƒ½ä½¿ç”¨CGIæˆ–Servletçš„HTMLç¼–å†™è€…ååˆ†é‡è¦ã€‚ä½†æ˜¯ï¼Œå¯¹äºServletæ¥è¯´ï¼Œç›´æ¥è®¾ç½®Refreshå¤´æ›´åŠ æ–¹ä¾¿ã€‚ æ³¨æ„Refreshçš„æ„ä¹‰æ˜¯\u0026quot;Nç§’ä¹‹ååˆ·æ–°æœ¬é¡µé¢æˆ–è®¿é—®æŒ‡å®šé¡µé¢\u0026rdquo;ï¼Œè€Œä¸æ˜¯\u0026quot;æ¯éš”Nç§’åˆ·æ–°æœ¬é¡µé¢æˆ–è®¿é—®æŒ‡å®šé¡µé¢\u0026quot;ã€‚å› æ­¤ï¼Œè¿ç»­åˆ·æ–°è¦æ±‚æ¯æ¬¡éƒ½å‘é€ä¸€ä¸ªRefreshå¤´ï¼Œè€Œå‘é€204çŠ¶æ€ä»£ç åˆ™å¯ä»¥é˜»æ­¢æµè§ˆå™¨ç»§ç»­åˆ·æ–°ï¼Œä¸ç®¡æ˜¯ä½¿ç”¨Refreshå¤´è¿˜æ˜¯ï¼œMETA HTTP-EQUIV=\u0026quot;Refresh\u0026quot; ...ï¼ã€‚ æ³¨æ„Refreshå¤´ä¸å±äºHTTP 1.1æ­£å¼è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ä¸€ä¸ªæ‰©å±•ï¼Œä½†Netscapeå’ŒIEéƒ½æ”¯æŒå®ƒã€‚ Server æœåŠ¡å™¨åå­—ã€‚Servletä¸€èˆ¬ä¸è®¾ç½®è¿™ä¸ªå€¼ï¼Œè€Œæ˜¯ç”±WebæœåŠ¡å™¨è‡ªå·±è®¾ç½®ã€‚ Set-Cookie è®¾ç½®å’Œé¡µé¢å…³è”çš„Cookieã€‚Servletä¸åº”ä½¿ç”¨response.setHeader(\u0026quot;Set-Cookie\u0026quot;, ...)ï¼Œè€Œæ˜¯åº”ä½¿ç”¨HttpServletResponseæä¾›çš„ä¸“ç”¨æ–¹æ³•addCookieã€‚å‚è§ä¸‹æ–‡æœ‰å…³Cookieè®¾ç½®çš„è®¨è®ºã€‚ WWW-Authenticate å®¢æˆ·åº”è¯¥åœ¨Authorizationå¤´ä¸­æä¾›ä»€ä¹ˆç±»å‹çš„æˆæƒä¿¡æ¯ï¼Ÿåœ¨åŒ…å«401ï¼ˆUnauthorizedï¼‰çŠ¶æ€è¡Œçš„åº”ç­”ä¸­è¿™ä¸ªå¤´æ˜¯å¿…éœ€çš„ã€‚ä¾‹å¦‚ï¼Œresponse.setHeader(\u0026quot;WWW-Authenticate\u0026quot;, \u0026quot;BASIC realm=ï¼¼\u0026quot;executivesï¼¼\u0026quot;\u0026quot;)ã€‚ æ³¨æ„Servletä¸€èˆ¬ä¸è¿›è¡Œè¿™æ–¹é¢çš„å¤„ç†ï¼Œè€Œæ˜¯è®©WebæœåŠ¡å™¨çš„ä¸“é—¨æœºåˆ¶æ¥æ§åˆ¶å—å¯†ç ä¿æŠ¤é¡µé¢çš„è®¿é—®ï¼ˆä¾‹å¦‚.htaccessï¼‰ã€‚ HTTP çŠ¶æ€ç  å½“æµè§ˆè€…è®¿é—®ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œæµè§ˆè€…çš„æµè§ˆå™¨ä¼šå‘ç½‘é¡µæ‰€åœ¨æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ã€‚å½“æµè§ˆå™¨æ¥æ”¶å¹¶æ˜¾ç¤ºç½‘é¡µå‰ï¼Œæ­¤ç½‘é¡µæ‰€åœ¨çš„æœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªåŒ…å«HTTPçŠ¶æ€ç çš„ä¿¡æ¯å¤´ï¼ˆserver headerï¼‰ç”¨ä»¥å“åº”æµè§ˆå™¨çš„è¯·æ±‚ã€‚\nHTTPçŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰\n200 - è¯·æ±‚æˆåŠŸ 301 - èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰è¢«æ°¸ä¹…è½¬ç§»åˆ°å…¶å®ƒURL 404 - è¯·æ±‚çš„èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰ä¸å­˜åœ¨ 500 - å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ HTTPçŠ¶æ€ç åˆ†ç±» HTTPçŠ¶æ€ç ç”±ä¸‰ä¸ªåè¿›åˆ¶æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªåè¿›åˆ¶æ•°å­—å®šä¹‰äº†çŠ¶æ€ç çš„ç±»å‹ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚HTTPçŠ¶æ€ç å…±åˆ†ä¸º5ç§ç±»å‹ï¼š\nåˆ†ç±» åˆ†ç±»æè¿° 1** ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ 2** æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç† 3** é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚ 4** å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚ 5** æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ HTTPçŠ¶æ€ç åˆ—è¡¨:\nçŠ¶æ€ç  çŠ¶æ€ç è‹±æ–‡åç§° ä¸­æ–‡æè¿° 100 Continue ç»§ç»­ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚ 101 Switching Protocols åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°HTTPçš„æ–°ç‰ˆæœ¬åè®® 200 OK è¯·æ±‚æˆåŠŸã€‚ä¸€èˆ¬ç”¨äºGETä¸POSTè¯·æ±‚ 201 Created å·²åˆ›å»ºã€‚æˆåŠŸè¯·æ±‚å¹¶åˆ›å»ºäº†æ–°çš„èµ„æº 202 Accepted å·²æ¥å—ã€‚å·²ç»æ¥å—è¯·æ±‚ï¼Œä½†æœªå¤„ç†å®Œæˆ 203 Non-Authoritative Information éæˆæƒä¿¡æ¯ã€‚è¯·æ±‚æˆåŠŸã€‚ä½†è¿”å›çš„metaä¿¡æ¯ä¸åœ¨åŸå§‹çš„æœåŠ¡å™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå‰¯æœ¬ 204 No Content æ— å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†ï¼Œä½†æœªè¿”å›å†…å®¹ã€‚åœ¨æœªæ›´æ–°ç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯ç¡®ä¿æµè§ˆå™¨ç»§ç»­æ˜¾ç¤ºå½“å‰æ–‡æ¡£ 205 Reset Content é‡ç½®å†…å®¹ã€‚æœåŠ¡å™¨å¤„ç†æˆåŠŸï¼Œç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰åº”é‡ç½®æ–‡æ¡£è§†å›¾ã€‚å¯é€šè¿‡æ­¤è¿”å›ç æ¸…é™¤æµè§ˆå™¨çš„è¡¨å•åŸŸ 206 Partial Content éƒ¨åˆ†å†…å®¹ã€‚æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†éƒ¨åˆ†GETè¯·æ±‚ 300 Multiple Choices å¤šç§é€‰æ‹©ã€‚è¯·æ±‚çš„èµ„æºå¯åŒ…æ‹¬å¤šä¸ªä½ç½®ï¼Œç›¸åº”å¯è¿”å›ä¸€ä¸ªèµ„æºç‰¹å¾ä¸åœ°å€çš„åˆ—è¡¨ç”¨äºç”¨æˆ·ç»ˆç«¯ï¼ˆä¾‹å¦‚ï¼šæµè§ˆå™¨ï¼‰é€‰æ‹© 301 Moved Permanently æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–°URIï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„URIï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–°URIã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„URIä»£æ›¿ 302 Found ä¸´æ—¶ç§»åŠ¨ã€‚ä¸301ç±»ä¼¼ã€‚ä½†èµ„æºåªæ˜¯ä¸´æ—¶è¢«ç§»åŠ¨ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­ä½¿ç”¨åŸæœ‰URI 303 See Other æŸ¥çœ‹å…¶å®ƒåœ°å€ã€‚ä¸301ç±»ä¼¼ã€‚ä½¿ç”¨GETå’ŒPOSTè¯·æ±‚æŸ¥çœ‹ 304 Not Modified æœªä¿®æ”¹ã€‚æ‰€è¯·æ±‚çš„èµ„æºæœªä¿®æ”¹ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤çŠ¶æ€ç æ—¶ï¼Œä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚å®¢æˆ·ç«¯é€šå¸¸ä¼šç¼“å­˜è®¿é—®è¿‡çš„èµ„æºï¼Œé€šè¿‡æä¾›ä¸€ä¸ªå¤´ä¿¡æ¯æŒ‡å‡ºå®¢æˆ·ç«¯å¸Œæœ›åªè¿”å›åœ¨æŒ‡å®šæ—¥æœŸä¹‹åä¿®æ”¹çš„èµ„æº 305 Use Proxy ä½¿ç”¨ä»£ç†ã€‚æ‰€è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡ä»£ç†è®¿é—® 306 Unused å·²ç»è¢«åºŸå¼ƒçš„HTTPçŠ¶æ€ç  307 Temporary Redirect ä¸´æ—¶é‡å®šå‘ã€‚ä¸302ç±»ä¼¼ã€‚ä½¿ç”¨GETè¯·æ±‚é‡å®šå‘ 400 Bad Request å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£ 401 Unauthorized è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯ 402 Payment Required ä¿ç•™ï¼Œå°†æ¥ä½¿ç”¨ 403 Forbidden æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚ 404 Not Found æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½®\u0026quot;æ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°\u0026quot;çš„ä¸ªæ€§é¡µé¢ 405 Method Not Allowed å®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„æ–¹æ³•è¢«ç¦æ­¢ï¼Œæœ¬æ¥åº”è¯¥ç”¨PUTï¼Œç»“æœç”¨POSTè¯·æ±‚å°±ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ã€‚ 406 Not Acceptable æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„å†…å®¹ç‰¹æ€§å®Œæˆè¯·æ±‚ 407 Proxy Authentication Required è¯·æ±‚è¦æ±‚ä»£ç†çš„èº«ä»½è®¤è¯ï¼Œä¸401ç±»ä¼¼ï¼Œä½†è¯·æ±‚è€…åº”å½“ä½¿ç”¨ä»£ç†è¿›è¡Œæˆæƒ 408 Request Time-out æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶ 409 Conflict æœåŠ¡å™¨å®Œæˆå®¢æˆ·ç«¯çš„ PUT è¯·æ±‚æ—¶å¯èƒ½è¿”å›æ­¤ä»£ç ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿäº†å†²çª 410 Gone å®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºå·²ç»ä¸å­˜åœ¨ã€‚410ä¸åŒäº404ï¼Œå¦‚æœèµ„æºä»¥å‰æœ‰ç°åœ¨è¢«æ°¸ä¹…åˆ é™¤äº†å¯ä½¿ç”¨410ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯é€šè¿‡301ä»£ç æŒ‡å®šèµ„æºçš„æ–°ä½ç½® 411 Length Required æœåŠ¡å™¨æ— æ³•å¤„ç†å®¢æˆ·ç«¯å‘é€çš„ä¸å¸¦Content-Lengthçš„è¯·æ±‚ä¿¡æ¯ 412 Precondition Failed å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯çš„å…ˆå†³æ¡ä»¶é”™è¯¯ 413 Request Entity Too Large ç”±äºè¯·æ±‚çš„å®ä½“è¿‡å¤§ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ï¼Œå› æ­¤æ‹’ç»è¯·æ±‚ã€‚ä¸ºé˜²æ­¢å®¢æˆ·ç«¯çš„è¿ç»­è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šå…³é—­è¿æ¥ã€‚å¦‚æœåªæ˜¯æœåŠ¡å™¨æš‚æ—¶æ— æ³•å¤„ç†ï¼Œåˆ™ä¼šåŒ…å«ä¸€ä¸ªRetry-Afterçš„å“åº”ä¿¡æ¯ 414 Request-URI Too Large è¯·æ±‚çš„URIè¿‡é•¿ï¼ˆURIé€šå¸¸ä¸ºç½‘å€ï¼‰ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç† 415 Unsupported Media Type æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚é™„å¸¦çš„åª’ä½“æ ¼å¼ 416 Requested range not satisfiable å®¢æˆ·ç«¯è¯·æ±‚çš„èŒƒå›´æ— æ•ˆ 417 Expectation Failed æœåŠ¡å™¨æ— æ³•æ»¡è¶³Expectçš„è¯·æ±‚å¤´ä¿¡æ¯ 500 Internal Server Error æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ 501 Not Implemented æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„åŠŸèƒ½ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ 502 Bad Gateway ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»è¿œç¨‹æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ä¸€ä¸ªæ— æ•ˆçš„å“åº” 503 Service Unavailable ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„Retry-Afterå¤´ä¿¡æ¯ä¸­ 504 Gateway Time-out å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚ 505 HTTP Version not supported æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚çš„HTTPåè®®çš„ç‰ˆæœ¬ï¼Œæ— æ³•å®Œæˆå¤„ç† content-type Content-Typeï¼ˆå†…å®¹ç±»å‹ï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„ Content-Typeï¼Œç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œå†³å®šæµè§ˆå™¨å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚\nContent-Type æ ‡å¤´å‘Šè¯‰å®¢æˆ·ç«¯å®é™…è¿”å›çš„å†…å®¹çš„å†…å®¹ç±»å‹ã€‚\nè¯­æ³•æ ¼å¼ï¼š\n1Content-Type: text/html; charset=utf-8 2Content-Type: multipart/form-data; boundary=something å®ä¾‹ï¼š\nå¸¸è§çš„åª’ä½“æ ¼å¼ç±»å‹å¦‚ä¸‹ï¼š\ntext/html ï¼š HTMLæ ¼å¼ text/plain ï¼šçº¯æ–‡æœ¬æ ¼å¼ text/xml ï¼š XMLæ ¼å¼ image/gif ï¼šgifå›¾ç‰‡æ ¼å¼ image/jpeg ï¼šjpgå›¾ç‰‡æ ¼å¼ image/pngï¼špngå›¾ç‰‡æ ¼å¼ ä»¥applicationå¼€å¤´çš„åª’ä½“æ ¼å¼ç±»å‹ï¼š\napplication/xhtml+xml ï¼šXHTMLæ ¼å¼ application/xmlï¼š XMLæ•°æ®æ ¼å¼ application/atom+xml ï¼šAtom XMLèšåˆæ ¼å¼ application/jsonï¼š JSONæ•°æ®æ ¼å¼ application/pdfï¼špdfæ ¼å¼ application/msword ï¼š Wordæ–‡æ¡£æ ¼å¼ application/octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰ application/x-www-form-urlencoded ï¼š ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey/valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰ å¦å¤–ä¸€ç§å¸¸è§çš„åª’ä½“æ ¼å¼æ˜¯ä¸Šä¼ æ–‡ä»¶ä¹‹æ—¶ä½¿ç”¨çš„ï¼š\nmultipart/form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼ HTTP content-type å¯¹ç…§è¡¨\n","date":"August 21, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/http_introducton/","summary":"HTTPç®€ä»‹ HTTPåè®®ï¼ˆHyperText Transfer Protocolï¼Œ è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰ï¼Œæ˜¯ä¸€ä¸ªåŸºäºTCP/IPé€šä¿¡åè®®æ¥ä¼ è¾“æ•°æ®ã€‚æ˜¯ç”¨äºä»æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„åè®®ã€‚HTTPä½¿ç”¨åŒä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifiers, URLï¼‰æ¥ä¼ è¾“æ•°æ®å’Œå»ºç«‹è¿æ¥ã€‚\nHTTPåè®®å·¥ä½œäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯ï¼ˆC-Sï¼‰æ¶æ„ä¸Šã€‚æµè§ˆå™¨ä½œä¸ºHTTPå®¢æˆ·ç«¯é€šè¿‡URLå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œå¹¶è·å¾—è¿”å›æ•°æ®ã€‚\nHTTPç‰¹ç‚¹ï¼š\nHTTPæ˜¯æ— è¿æ¥çš„ï¼š æ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚\nHTTPæ˜¯æ— çŠ¶æ€çš„ï¼š HTTPæ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†ç­æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡ä¼ è¾“çš„æ•°æ®é‡å¢å¤§ã€‚\nHTTPæ˜¯åª’ä½“ç‹¬ç«‹çš„ï¼š ä»»ä½•æ•°æ®ç±»å‹éƒ½å¯ä»¥é€šè¿‡HTTPå‘é€ï¼Œå®¢æˆ·ç«¯ä»¥åŠæœåŠ¡å™¨è¦æŒ‡å®šç›¸åŒçš„MIME-typeç±»å‹ã€‚åª’ä½“ç±»å‹é€šå¸¸é€šè¿‡ HTTP åè®®ï¼Œç”± Web æœåŠ¡å™¨å‘ŠçŸ¥æµè§ˆå™¨çš„ï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯é€šè¿‡ Content-Type æ¥è¡¨ç¤ºçš„ã€‚ä¾‹å¦‚ï¼šContent-Typeï¼štext/HTMLã€‚é€šå¸¸åªæœ‰å¹¿æ³›åº”ç”¨çš„æ ¼å¼æ‰ä¼šè·å¾—ä¸€ä¸ª MIME Typeï¼Œå¦‚æœæ˜¯æŸä¸ªå®¢æˆ·ç«¯è‡ªå·±å®šä¹‰çš„æ ¼å¼ï¼Œä¸€èˆ¬åªèƒ½ä»¥ application/x- å¼€å¤´ã€‚\nWeb-Browser \u0026lt;===\u0026gt; HTTP Server \u0026lt;===\u0026gt; CGI(Common GateWay Interface) Program \u0026lt;==\u0026gt;Database\nå®¢æˆ·ç«¯è¯·æ±‚æ¶ˆæ¯ è¯·æ±‚æ¶ˆæ¯åŒ…æ‹¬ä»¥ä¸‹æ ¼å¼ï¼šè¯·æ±‚è¡Œï¼ˆrequest lineï¼‰ã€è¯·æ±‚å¤´éƒ¨ï¼ˆheaderï¼‰ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®å››ä¸ªéƒ¨åˆ†ç»„æˆ\næœåŠ¡å™¨å“åº”æ¶ˆæ¯ å“åº”ä¹Ÿç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šçŠ¶æ€è¡Œã€æ¶ˆæ¯æŠ¥å¤´ã€ç©ºè¡Œå’Œå“åº”æ­£æ–‡ã€‚\nä¸å¸¦Body çš„è¯·æ±‚ 1# è¯·æ±‚æ¶ˆæ¯ 2GET /health HTTP/1.1 3Host: 127.0.0.1:8080 4User-Agent: curl/7.65.3 5Accept: */* 6 7# è¿”å›æ¶ˆæ¯ 8HTTP/1.1 200 OK 9Content-Type: text/plain; charset=utf-8 10Date: Sat, 22 Aug 2020 17:56:22 GMT 11Content-Length: 2 12 13ok å¸¦Bodyçš„è¯·æ±‚ 1# è¯·æ±‚æ¶ˆæ¯ 2GET /health?","tags":["Http"],"title":"ã€ŒHTTPã€HTTP 9 ç§è¯·æ±‚æ–¹å¼"},{"categories":null,"contents":" å­¦å¥½ä¸€ä¸ªæ¡†æ¶æˆ–è€…ä¸€é—¨è¯­è¨€ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯è¦å­¦ä¼šçœ‹å®˜æ–¹çš„Documentã€‚å‡ ä¹æ‰€æœ‰çš„åšå®¢åªæ˜¯æŠŠè‡ªå·±å¯¹å®˜æ–¹æ–‡æ¡£çš„ç†è§£é‡æ–°åŠ å·¥æ•´ç†å‡ºæ¥è€Œå·²ï¼Œå¢åŠ äº†è‡ªå·±çš„ä¸»ç®¡æƒ³æ³•ã€‚\nåˆšå…¥é—¨çš„æ—¶å€™é¢å¯¹è‹±æ–‡æ–‡æ¡£å¯èƒ½ä¸€å¤´é›¾æ°´ï¼Œä½†æ˜¯å½“ä½ åšæŒä¸‹æ¥ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™äº›å®˜æ–¹æ–‡æ¡£å†™çš„è¦æ¯”é‚£äº›åšå®¢å¥½çš„å¤šï¼Œè¡¨è¿°ç²¾ç¡®çš„å¤šã€‚\nä»¥åæˆ‘çš„æ–‡ç« ä¼šä¸»è¦å‚è€ƒå®˜æ–¹æ–‡æ¡£å±•å¼€ä»‹ç»ï¼Œé¡ºå¸¦åŠ ä¸€ç‚¹è‡ªå·±çš„ç†è§£\nGitHub\nOfficial Document\n1. Gin ç®€ä»‹ The fastest full-featured web freamwork for Go. Crystal clear.\nå¿« æ”¯æŒä¸­é—´ä»¶ Crashè¿˜åŸ JSONéªŒè¯ è·¯ç”±åˆ†ç»„ é”™è¯¯æ—¥å¿—æ”¶é›† æ¨¡æ¿æ¸²æŸ“ å¯æ‰©å±• 2. å¿«é€Ÿç”¨Ginæ­å»ºä¸€ä¸ªWebæœåŠ¡ 1go get -u github.com/gin-gonic/gin # install Gin 2 3mkdir gin_demo \u0026amp;\u0026amp; cd gin_demo 4 5vi main.go main.goçš„å†…å®¹å¦‚ä¸‹\n1package main 2 3import ( 4\t\u0026#34;net/http\u0026#34; 5\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 6 7) 8 9func main(){ 10\tr := gin.Default() 11 12\tr.GET(\u0026#34;/ping\u0026#34;, func(c *gin.Context){ 13\tc.JSON(200, gin.H{ 14\t\u0026#34;message\u0026#34;:\u0026#34;pong\u0026#34;, 15\t}) 16\t}) 17 18\tr.GET(\u0026#34;/health\u0026#34;, func(c *gin.Context){ 19\tc.String(http.StatusOK, \u0026#34;ok\u0026#34;) 20\t}) 21\tr.Run() 22} ç„¶ååˆå§‹åŒ–GoModule, è¿è¡Œé¡¹ç›®\n1go mod init xxx/xxx/gin_demo 2 3go run main.go å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸€ä¸ªç®€å•çš„webæœåŠ¡å°±æ­å»ºæˆåŠŸäº†\næµ‹è¯•ä¸€ä¸‹è®¿é—®æƒ…å†µ\næœåŠ¡ç«¯æ—¥å¿—\nç”±äºgin.Default() è¿”å›çš„gin.Engine (router)è‡ªå¸¦Loggerä¸­é—´ä»¶ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ—¥å¿—ä¸­çœ‹åˆ°å…·ä½“çš„è¯·æ±‚ä¸å“åº”æƒ…å†µã€‚çœ‹ä¸€çœ¼æºç \n1// Default returns an Engine instance with the Logger and Recovery middleware already attached. 2func Default() *Engine { 3\tdebugPrintWARNINGDefault() 4\tengine := New() 5\tengine.Use(Logger(), Recovery()) 6\treturn engine 7} Gin é¡¹ç›®ç›®å½• 1â”œâ”€ Project Name 2â”‚ â”œâ”€ config //é…ç½®æ–‡ä»¶ 3â”‚ â”œâ”€â”€ ... 4â”‚ â”œâ”€ controller //æ§åˆ¶å™¨å±‚ï¼ŒéªŒè¯æäº¤çš„æ•°æ®ï¼Œå°†éªŒè¯å®Œæˆçš„æ•°æ®æäº¤ç»™service 5â”‚ â”œâ”€â”€ ... 6â”‚ â”œâ”€ service //ä¸šåŠ¡å±‚ï¼Œ åªå®Œæˆä¸šåŠ¡é€»è¾‘å¾—å¼€å‘ï¼Œä¸è¿›è¡Œæ•°æ®åº“çš„æ“ä½œ 7â”‚ â”œâ”€â”€ ... 8â”‚ â”œâ”€ repository //æ•°æ®åº“æ“ä½œå±‚ dal/ dao; æ•°æ®åº“æ“ä½œå±‚ï¼Œå†™ï¼Œå¤šè¡¨æ’å…¥ï¼Œå¤šè¡¨æŸ¥è¯¢ï¼Œä¸å†™ä¸šåŠ¡ä»£ç  9â”‚ â”œâ”€â”€ ... 10â”‚ â”œâ”€ model //æ•°æ®åº“ORM 11â”‚ â”œâ”€â”€ ... 12â”‚ â”œâ”€ entity //å®ä½“ å†™è¿”å›æ•°æ®çš„ç»“æ„ä½“ã€‚å†™controllerå±‚æ–¹æ³•å‚æ•°éªŒè¯çš„ç»“æ„ä½“ 13â”‚ â”œâ”€â”€ ... 14â”‚ â”œâ”€ proto //protoæ–‡ä»¶ å†™ gRPC çš„ *.pb.go æ–‡ä»¶ã€‚ 15â”‚ â”œâ”€â”€ ... 16â”‚ â”œâ”€ router //è·¯ç”± 17â”‚ â”œâ”€â”€ middleware //è·¯ç”±ä¸­é—´ä»¶ ï¼ˆé‰´æƒï¼Œæ—¥å¿—ï¼Œå¼‚å¸¸æ•è·ï¼‰ 18â”‚ â”œâ”€â”€ ... 19â”‚ â”œâ”€â”€ ... 20â”‚ â”œâ”€ util //å·¥å…·ç±»ï¼Œé¡¹ç›®é€šç”¨çš„å·¥å…·åŒ… 21â”‚ â”œâ”€â”€ ... 22â”‚ â”œâ”€ vendor //æ‰©å±•åŒ… ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œé€šå¸¸ä½¿ç”¨go mod ç®¡ç† 23â”‚ â”œâ”€â”€ ... 24â”‚ â”œâ”€ main.go //å…¥å£æ–‡ä»¶ å‚è€ƒèµ„æ–™ï¼š\nhttps://cloud.tencent.com/developer/article/1490384\n","date":"August 21, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/gin_overview/","summary":"å­¦å¥½ä¸€ä¸ªæ¡†æ¶æˆ–è€…ä¸€é—¨è¯­è¨€ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯è¦å­¦ä¼šçœ‹å®˜æ–¹çš„Documentã€‚å‡ ä¹æ‰€æœ‰çš„åšå®¢åªæ˜¯æŠŠè‡ªå·±å¯¹å®˜æ–¹æ–‡æ¡£çš„ç†è§£é‡æ–°åŠ å·¥æ•´ç†å‡ºæ¥è€Œå·²ï¼Œå¢åŠ äº†è‡ªå·±çš„ä¸»ç®¡æƒ³æ³•ã€‚\nåˆšå…¥é—¨çš„æ—¶å€™é¢å¯¹è‹±æ–‡æ–‡æ¡£å¯èƒ½ä¸€å¤´é›¾æ°´ï¼Œä½†æ˜¯å½“ä½ åšæŒä¸‹æ¥ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™äº›å®˜æ–¹æ–‡æ¡£å†™çš„è¦æ¯”é‚£äº›åšå®¢å¥½çš„å¤šï¼Œè¡¨è¿°ç²¾ç¡®çš„å¤šã€‚\nä»¥åæˆ‘çš„æ–‡ç« ä¼šä¸»è¦å‚è€ƒå®˜æ–¹æ–‡æ¡£å±•å¼€ä»‹ç»ï¼Œé¡ºå¸¦åŠ ä¸€ç‚¹è‡ªå·±çš„ç†è§£\nGitHub\nOfficial Document\n1. Gin ç®€ä»‹ The fastest full-featured web freamwork for Go. Crystal clear.\nå¿« æ”¯æŒä¸­é—´ä»¶ Crashè¿˜åŸ JSONéªŒè¯ è·¯ç”±åˆ†ç»„ é”™è¯¯æ—¥å¿—æ”¶é›† æ¨¡æ¿æ¸²æŸ“ å¯æ‰©å±• 2. å¿«é€Ÿç”¨Ginæ­å»ºä¸€ä¸ªWebæœåŠ¡ 1go get -u github.com/gin-gonic/gin # install Gin 2 3mkdir gin_demo \u0026amp;\u0026amp; cd gin_demo 4 5vi main.go main.goçš„å†…å®¹å¦‚ä¸‹\n1package main 2 3import ( 4\t\u0026#34;net/http\u0026#34; 5\t\u0026#34;github.com/gin-gonic/gin\u0026#34; 6 7) 8 9func main(){ 10\tr := gin.Default() 11 12\tr.GET(\u0026#34;/ping\u0026#34;, func(c *gin.Context){ 13\tc.","tags":null,"title":"ã€ŒGinã€Ginå…¥é—¨"},{"categories":null,"contents":"https://docs.mongodb.com/manual/reference/bson-types/\nhttp://bsonspec.org/\nhttps://www.mongodb.com/json-and-bson\nhttps://www.educba.com/json-vs-bson/\\\nhttps://www.geeksforgeeks.org/difference-between-json-and-bson/\n","date":"August 20, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/DataBase/mongo/bson/","summary":"https://docs.mongodb.com/manual/reference/bson-types/\nhttp://bsonspec.org/\nhttps://www.mongodb.com/json-and-bson\nhttps://www.educba.com/json-vs-bson/\\\nhttps://www.geeksforgeeks.org/difference-between-json-and-bson/","tags":["Bson"],"title":"ã€ŒMongoã€Bson vs Json"},{"categories":null,"contents":"1. Goè¯­è¨€ä»‹ç» 1.1 Go è¯­è¨€ç‰¹ç‚¹ é™æ€ç±»å‹ã€ç¼–è¯‘å‹çš„å¼€æºè¯­è¨€\né™æ€ç±»å‹æ˜¯æŒ‡è¦æ˜ç¡®å˜é‡çš„ç±»å‹ï¼Œæˆ–è€…ç¼–è¯‘å™¨å¯ä»¥æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ã€‚è¦ä¹ˆåœ¨å˜é‡ç±»å‹æ—è¾¹æŒ‡å®šå˜é‡çš„é‚£ä¸ªç±»å‹ï¼Œè¦ä¹ˆæ˜¯å¯ä»¥æ¨å¯¼å‡ºå˜é‡ç±»å‹ã€‚\nç¼–è¯‘å‹æ˜¯æŒ‡è¦ç¼–è¯‘æˆæœºå™¨è¯­è¨€ã€‚\n1package main 2func main(){ 3 // Declare the type of the variable 4 var num1 int = 1; 5 // Deduce the type of the variable 6 num2 :=2 7} è„šæœ¬åŒ–çš„è¯­æ³•ï¼Œæ”¯æŒå¤šç§èŒƒå¼ç¼–ç¨‹\nå‡½æ•°å¼\u0026amp;é¢å‘å¯¹è±¡\nåŸç”Ÿã€ç»™åŠ›çš„å¹¶å‘ç¼–ç¨‹æ”¯æŒ\næ³¨æ„ï¼š åŸç”Ÿæ”¯æŒå’Œå‡½æ•°åº“æ”¯æŒçš„åŒºåˆ«\n1.2 Goè¯­è¨€çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ ä¼˜åŠ¿\nè„šæœ¬åŒ–çš„è¯­æ³• é™æ€ç±»å‹+ç¼–è¯‘å‹ï¼Œç¨‹åºè¿è¡Œé€Ÿåº¦æœ‰ä¿éšœ åŸç”Ÿçš„æ”¯æŒå¹¶å‘ç¼–ç¨‹ - é™ä½å¼€å‘ã€ç»´æŠ¤æˆæœ¬ï¼›ç¨‹åºå¯ä»¥æ›´å¥½çš„æ‰§è¡Œ åŠ£åŠ¿\nè¯­æ³•ç³–å¹¶æ²¡æœ‰Pythonå’ŒRubyé‚£ä¹ˆå¤š- 1æˆæ˜¯å¼€å‘æ—¶é—´ï¼Œ9æˆç»´æŠ¤æ—¶é—´ ç›®å‰çš„ç¨‹åºè¿è¡Œé€Ÿåº¦è¿˜ä¸åŠcï¼Œä½†æ˜¯ç›®å‰å·²ç»èµ¶è¶…äº†C++å’ŒJava ç¬¬ä¸‰æ–¹åº“å‡½æ•°æš‚æ—¶ä¸åƒç»å¯¹ä¸»æµçš„ç¼–ç¨‹è¯­è¨€é‚£æ ·å¤š 1.3 Goå¼€å‘ç¯å¢ƒ Linux ä¸‹çš„å®‰è£… FreeBSD Linux Windows 32bit - 64bit\nLinux ä¸‹çš„è®¾ç½®æ–¹æ³•\næœ‰å››ä¸ªç¯å¢ƒå˜é‡éœ€è¦è®¾ç½®ï¼š GOROOTã€GOPATHã€GOBINä»¥åŠPATH\néœ€è¦è®¾ç½®åˆ°æŸä¸€ä¸ªprofileæ–‡ä»¶ä¸­\nOS X-\u0026gt; ~/.bash_profile(å•ä¸€ç”¨æˆ·) æˆ–è€… /etc/profileï¼ˆæ‰€æœ‰ç”¨æˆ·ï¼‰\nMac å®‰è£…Golang æ‰€æœ‰å¼€å‘é»˜è®¤ä½¿ç”¨Macç¯å¢ƒï¼Œä½¿ç”¨brewå¯ä»¥å®‰è£…å¹¶ç®¡ç†goå¤šä¸ªç‰ˆæœ¬\n1brew install go # å®‰è£…goæœ€æ–°ç‰ˆæœ¬ 1go version # æŸ¥çœ‹goç‰ˆæœ¬ å®‰è£…è·¯å¾„\nBrew å¯ä»¥ç”¨æ¥ç®¡ç†å¤šç‰ˆæœ¬çš„Goï¼Œå®‰è£…æŒ‡å®šç‰ˆæœ¬1.14\n1brew install go@1.14 å®‰è£…è·¯å¾„\n1/usr/local/Cellar/go@1.14/1.14.9 åˆ‡æ¢goçš„ç‰ˆæœ¬åˆ°1.14, è¿™ä¸ªåœ°æ–¹å…·ä½“çš„æ“ä½œéœ€è¦æ ¹æ®homebrewçš„å…·ä½“ç‰ˆæœ¬è¿›è¡Œæ“ä½œ\n1brew unlink go 2brew link --overwrite go@1.14 1.4 å…³é”®ç¯å¢ƒå˜é‡ GOROOT è¯¥ç¯å¢ƒå˜é‡çš„å€¼åº”è¯¥ä¸ºGoè¯­è¨€çš„å½“å‰å®‰è£…ç›®å½•\nGOPATH è¯¥ç¯å¢ƒå˜é‡ä¸ºGoè¯­è¨€å·¥ä½œåŒºçš„é›†åˆ\ngo 1.12 ç‰ˆæœ¬ä¸­æ”¯æŒ go mod , ä¸å†å¼ºåˆ¶å°†é¡¹ç›®æºç æ”¾ç½®åˆ°Srcç›®å½•ä¸­ã€‚\nGOBIN æ˜¯ä½ æƒ³å­˜æ”¾Goç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•\n1export GOROOT=/usr/local/go # ä¸€èˆ¬ä¸éœ€è¦è®¾ç½® 2export GOPATH=~/go # é»˜è®¤ä¸º~/go 3export GOBIN=$GOPATH/bin # é»˜è®¤ä¸º~/go/bin PATH: ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨Goè¯­è¨€å‘½ä»¤å’ŒGoç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œéœ€è¦è¿½åŠ å…¶å€¼ï¼Œå¦‚\n1export PATH=$PATH:$GOBIN 2 3source profileName # ä½¿ä¿®æ”¹ç”Ÿæ•ˆ ä»»æ„ç›®å½• go version\nå¦‚æœä½¿ç”¨äº¤å‰ç¼–è¯‘(Cross compile)åˆ™éœ€è¦è®¾ç½®GOOSç¯å¢ƒå˜é‡\n2. åŸºæœ¬è§„åˆ™ 2.1 å·¥ä½œåŒºå’ŒGOPATH å·¥ä½œåŒºæ˜¯æ”¾ç½®Goæºç æ–‡ä»¶çš„ç›®å½•\nä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒGoæºç æ–‡ä»¶éƒ½éœ€è¦å­˜æ”¾åˆ°å·¥ä½œåŒºä¸­\nä½†å¯¹äºå‘½ä»¤æºç æ–‡ä»¶æ¥è¯´ï¼Œè¿™ä¸æ˜¯å¿…é¡»çš„\næ¯ä¸ªå·¥ä½œåŒºçš„ç»“æ„éƒ½ç±»ä¼¼ä¸‹å›¾æ‰€ç¤º\n1/home/username/golib: 2\tsrc/ # ç”¨äºå­˜æ”¾æºç æ–‡ä»¶ã€ä»¥ä»£ç åŒ…ä¸ºç»„ç»‡å½¢å¼ 3\tpkg/ # ç”¨äºå­˜æ”¾å½’æ¡£æ–‡ä»¶ï¼ˆåç§°ä»¥.aï¼‰ä¸ºåç¼€çš„æ–‡ä»¶ - æ‰€æœ‰å½’æ¡£æ–‡ä»¶éƒ½ä¼šè¢«å­˜æ”¾åˆ°è¯¥ç›®å½•ä¸‹çš„å¹³å°ç›¸å…³ç›®å½•ä¸­ï¼ŒåŒæ ·ä»¥ä»£ç åŒ…ä¸ºç»„ç»‡å½¢å¼ 4\tbin/ # ç”¨äºå­˜æ”¾å½“å‰å·¥ä½œåŒºä¸­Goç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶---GOBIN 5\t# 1. å½“ç¯å¢ƒå˜é‡GOBINå·²æœ‰æ•ˆè®¾ç½®æ—¶ï¼Œè¯¥ç›®å½•ä¼šå˜çš„æ— æ„ä¹‰ 6\t# 2. å½“GOPATHçš„å€¼ä¸­åŒ…å«å¤šä¸ªå·¥ä½œåŒºçš„è·¯å¾„æ—¶å€™ï¼Œå¿…é¡»è®¾ç½®GOBINï¼Œå¦åˆ™æ— æ³•æˆåŠŸå®‰è£…Goç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ å¹³å°ç›¸å…³ç›®å½• pkg/darwin_amd64\nä¸¤ä¸ªéšå«çš„Goè¯­è¨€ç¯å¢ƒå˜é‡ï¼š GOOSå’ŒGOARCH\nGOOSï¼šæ“ä½œç³»ç»Ÿ\nGOARCH:è®¡ç®—æ¶æ„\nå¹³å°ç›¸å…³ç›®å½•æ˜¯ä»¥$GOOS_$GOARCHä¸ºå‘½åæ–¹å¼ï¼Œå¦‚linux_amd64\n\u0026lt;å·¥ä½œåŒºç›®å½•\u0026gt;/pkg/\u0026lt;å¹³å°ç›¸å…³ç›®å½•\u0026gt;/\u0026lt;ä¸€çº§ä»£ç åŒ…\u0026gt;/\u0026lt;äºŒçº§ä»£ç åŒ…\u0026gt;/\u0026lt;æœ«çº§ä»£ç åŒ…\u0026gt;.aÂ 2.1 æºç æ–‡ä»¶çš„åˆ†ç±»å’Œå«ä¹‰ GOæºç æ–‡ä»¶ åç§°ä»¥.goä¸ºåç¼€ï¼Œå†…å®¹ä»¥Goè¯­è¨€ä»£ç ç»„ç»‡çš„æ–‡ä»¶ å¤šä¸ªGoæºç æ–‡ä»¶æ˜¯éœ€è¦ç”¨ä»£ç åŒ…ç»„ç»‡èµ·æ¥çš„\nåˆ†ä¸‰ç±»\nå‘½ä»¤æºç æ–‡ä»¶ã€åº“æºç æ–‡ä»¶ - goè¯­è¨€ç¨‹åº\næµ‹è¯•æºç æ–‡ä»¶- è¾…åŠ©æºç æ–‡ä»¶\nå‘½ä»¤æºç æ–‡ä»¶ å£°æ˜è‡ªå·±å±äºmainä»£ç åŒ… åŒ…å«æ— å‚æ•°å£°æ˜å’Œç»“æœå£°æ˜çš„mainå‡½æ•° è¢«å®‰è£…åï¼Œç›¸åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ä¼šè¢«å­˜æ”¾åˆ°GOBINæŒ‡å‘çš„ç›®å½•æˆ–è€…\u0026lt;å½“å‰å·¥ä½œåŒºç›®å½•\u0026gt;/binä¸‹\nå‘½ä»¤æºç æ–‡ä»¶æ˜¯Goç¨‹åºçš„å…¥å£ï¼Œä½†æ˜¯ä¸å»ºè®®æŠŠç¨‹åºéƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­\næ³¨æ„ï¼š åŒä¸€ä¸ªä»£ç åŒ…ä¸­å¼ºçƒˆä¸å»ºè®®ç›´æ¥åŒ…å«å¤šä¸ªå‘½ä»¤æºç æ–‡ä»¶\nåº“æºç æ–‡ä»¶ ä¸å…·å¤‡å‘½ä»¤æºç æ–‡ä»¶çš„ä¸¤ä¸ªç‰¹å¾çš„æºç æ–‡ä»¶\nè¢«å®‰è£…åï¼Œç›¸åº”çš„å½’æ¡£æ–‡ä»¶ä¼šè¢«å­˜æ”¾åˆ°\u0026lt;å½“å‰å·¥ä½œç›®å½•\u0026gt;/pkg/\u0026lt;å¹³å°ç›¸å…³ç›®å½•\u0026gt;ä¸‹\næµ‹è¯•æºç æ–‡ä»¶ ä¸å…·å¤‡å‘½ä»¤æºç æ–‡ä»¶é‚£ä¸¤ä¸ªç‰¹å¾çš„æºç æ–‡ä»¶\nåç§°ä»¥_test.goä¸ºåç¼€\nå…¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå‡½æ•°çš„åç§°ä»¥Testæˆ–Benchmarkä¸ºå‰ç¼€\nå¹¶ä¸”ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç±»å‹ä¸º*testing.Tæˆ–*testing.Bçš„å‚æ•°\n1// åŠŸèƒ½æµ‹è¯•å‡½æ•° 2func TestFind(t *testing.T){ 3 // çœç•¥è‹¥å¹²æ¡è¯­å¥ 4} 5 6// åŸºå‡†æµ‹è¯•å‡½æ•°æˆ–æ€§èƒ½æµ‹è¯•å‡½æ•° 7func BenchmarkFind(b *testing.B){ 8 // çœç•¥è‹¥å¹²æ¡è¯­å¥ 9} 2.3 ä»£ç åŒ…çš„ç›¸å…³çŸ¥è¯† ä»£ç åŒ…çš„ä½œç”¨ ç¼–è¯‘å’Œå½’æ¡£Goæˆè¯­çš„æœ€åŸºæœ¬å•ä½\nä»£ç åˆ’åˆ†ã€é›†ç»“å’Œä¾èµ–çš„æœ‰æ•ˆç»„ç»‡å½¢å¼ï¼Œä¹Ÿæ˜¯æƒé™æ§åˆ¶çš„è¾…åŠ©æ‰‹æ®µ\nä»£ç åŒ…çš„è§„åˆ™ ä¸€ä¸ªä»£ç åŒ…å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªç”±å¯¼å…¥è·¯å¾„ä»£è¡¨çš„ç›®å½•\nå¯¼å…¥è·¯å¾„å³\u0026lt;å·¥ä½œåŒºç›®å½•\u0026gt;/srcæˆ–\u0026lt;å·¥ä½œåŒºç›®å½•\u0026gt;/pkg/\u0026lt;å¹³å°ç›¸å…³ç›®å½•\u0026gt;ä¹‹ä¸‹çš„æŸæ®µå­è·¯å¾„\nä¾‹å¦‚ï¼šä»£ç åŒ…hypermind.cnå¯ä»¥å¯¹åº”äº\n/home/username/golib/src/hypermind.cn\n(å…¶ä¸­ï¼Œ/home/username/golib æ˜¯ä¸€ä¸ªå·¥ä½œåŒºç›®å½•)\nä»£ç åŒ…çš„å£°æ˜ æ¯ä¸ªæºç æ–‡ä»¶å¿…é¡»å£°æ˜å…¶æ‰€å±çš„ä»£ç åŒ…\nåŒä¸€ä¸ªä»£ç åŒ…ä¸­çš„æ‰€æœ‰æºç æ–‡ä»¶å£°æ˜çš„ä»£ç åŒ…åº”è¯¥æ˜¯ç›¸åŒçš„\nä»£ç åŒ…å£°æ˜ä¸ä»£ç åŒ…å¯¼å…¥è·¯å¾„çš„åŒºåˆ« ä»£ç åŒ…å£°æ˜è¯­å¥ä¸­çš„åŒ…åç§°åº”è¯¥æ˜¯è¯¥ä»£ç åŒ…çš„å¯¼å…¥è·¯å¾„çš„æœ€å³å­è·¯å¾„\nä¾‹å¦‚ hypermind.cn/pkgtool -\u0026gt; package pkgtool\nä»£ç åŒ…çš„å¯¼å…¥ ä»£ç åŒ…å¯¼å…¥è¯­å¥ä¸­ä½¿ç”¨çš„åŒ…åç§°åº”è¯¥ä¸å…¶å¯¼å…¥è·¯å¾„ä¸€è‡´ï¼Œä¾‹å¦‚\nflagã€fmtã€strings\n1import ( 2\t\u0026#34;flag\u0026#34; 3 \u0026#34;fmt\u0026#34; 4 \u0026#34;strings\u0026#34; 5) ä»£ç åŒ…çš„å¯¼å…¥æ–¹æ³• å¸¦åˆ«åçš„å¯¼å…¥ 1import str \u0026#34;strings\u0026#34; 2str.HasPrefix(\u0026#34;abc\u0026#34;,\u0026#34;a\u0026#34;) æœ¬åœ°åŒ–çš„å¯¼å…¥ 1import . \u0026#34;strings\u0026#34; 2HasPrefix(\u0026#34;abc\u0026#34;,\u0026#34;a\u0026#34;) ä»…ä»…åˆå§‹åŒ– 1import _ \u0026#34;strings\u0026#34; 2// ä»…ä»…æ‰§è¡Œä»£ç åŒ…ä¸­çš„åˆå§‹åŒ–å‡½æ•° ä»£ç åŒ…çš„åˆå§‹åŒ– ä»£ç åŒ…åˆå§‹åŒ–å‡½æ•°å³ï¼šæ— å‚æ•°å£°æ˜å’Œç»“æœå£°æ˜çš„initå‡½æ•° initå‡½æ•°å¯ä»¥è¢«å£°æ˜åœ¨ä»»ä½•æ–‡ä»¶ä¸­ï¼Œä¸”å¯ä»¥æœ‰å¤šä¸ª init å‡½æ•°çš„æ‰§è¡Œæ—¶æœº\u0026mdash;å•ä¸€ä»£ç åŒ…å†… å¯¹æ‰€æœ‰å…¨å±€å˜é‡è¿›è¡Œæ±‚å€¼\u0026mdash;-\u0026raquo;\u0026raquo;\u0026gt;æ‰§è¡Œæ‰€æœ‰initå‡½æ•°\nå•ä¸ªä»£ç åŒ…å†…å¤šä¸ªinitå‡½æ•°çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„\ninit å‡½æ•°çš„æ‰§è¡Œæ—¶æœº\u0026mdash;ä¸åŒä»£ç åŒ…ä¹‹é—´ æ‰§è¡Œè¢«å¯¼å…¥çš„ä»£ç åŒ…ä¸­initå‡½æ•°\u0026mdash;\u0026ndash;\u0026raquo;\u0026raquo; æ‰§è¡Œå¯¼å…¥å®ƒçš„é‚£ä¸ªä»£ç åŒ…çš„initå‡½æ•°\nå¯¼å…¥é¡ºåº A -\u0026gt; B -\u0026gt; C\ninit çš„æ‰§è¡Œé¡ºåº C B A\næ³¨æ„ï¼š æˆ‘ä»¬ä¸åº”è¯¥å¯¹åœ¨åŒä¸€ä¸ªä»£ç åŒ…ä¸­è¢«å¯¼å…¥çš„å¤šä¸ªä»£ç åŒ…çš„initå‡½æ•°çš„æ‰§è¡Œé¡ºåºä½œå‡ºå‡è®¾ï¼\ninitå‡½æ•°çš„æ‰§è¡Œæ—¶æœº\u0026mdash;-æ‰€æœ‰æ¶‰åŠåˆ°çš„ä»£ç åŒ… æ¯ä¸€ä¸ªinitå‡½æ•°åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡\n3. å‘½ä»¤åŸºç¡€ 1go run 2go build å’Œ go install 3go get 3.1 go run ç”¨äºè¿è¡Œå‘½ä»¤æºç æ–‡ä»¶ åªèƒ½æ¥å—ä¸€ä¸ªå‘½ä»¤æºç æ–‡ä»¶ä»¥åŠè‹¥å¹²ä¸ªåº“æºç æ–‡ä»¶ä½œä¸ºæ–‡ä»¶å‚æ•° å…¶å†…éƒ¨æ“ä½œæ­¥éª¤æ˜¯ï¼š å…ˆç¼–è¯‘æºç æ–‡ä»¶å†è¿è¡Œï¼› æºæ–‡ä»¶\u0026ndash;compile(æ”¾å…¥ä¸´æ—¶æ–‡ä»¶å¤¹)\u0026ndash;\u0026gt;1å¯æ‰§è¡Œæ–‡ä»¶2. å½’æ¡£æ–‡ä»¶ ç¤ºä¾‹\nhttps://github.com/hyper-carrot/goc2p\ndså‘½ä»¤å’Œpsdå‘½ä»¤\ndså‘½ä»¤çš„æºç æ–‡ä»¶goc2p/src/helper/ds/showds.go ç”¨äºæ˜¾ç¤ºæŒ‡å®šç›®å½•çš„ç›®å½•ç»“æ„\npdså‘½ä»¤çš„æºç æ–‡ä»¶goc2p/src/helper/ds/showpds.go ç”¨äºæ˜¾ç¤ºæŒ‡å®šä»£ç åŒ…çš„ä¾èµ–å…³ç³»\ngo run å¸¸ç”¨æ ‡è®°çš„ä½¿ç”¨\n1-a # å¼ºåˆ¶ç¼–è¯‘ç›¸å…³ä»£ç ï¼Œä¸è®ºä»–ä»¬çš„ç¼–è¯‘ç»“æœæ˜¯å¦å·²æ˜¯æœ€æ–°çš„ 2-n # æ‰“å°ç¼–è¯‘è¿‡ç¨‹ä¸­æ‰€éœ€è¿è¡Œçš„å‘½ä»¤ï¼Œä½†ä¸ä¼šçœŸæ­£æ‰§è¡Œä»–ä»¬ 3-p -n # å¹¶è¡Œç¼–è¯‘ï¼Œå…¶ä¸­nä¸ºå¹¶è¡Œçš„æ•°é‡ nä¸ºé€»è¾‘æ ¸çš„æ•°é‡ 4-v # åˆ—å‡ºè¢«ç¼–è¯‘ä»£ç åŒ…çš„åç§° 5-a -v # åˆ—å‡ºæ‰€æœ‰è¢«ç¼–è¯‘çš„ä»£ç åŒ…çš„åç§° 1.4 ç‰ˆæœ¬åä¸åŒ…å«Goè¯­è¨€è‡ªå¸¦çš„æ ‡å‡†åº“çš„ä»£ç åŒ… 6-work # æ˜¾ç¤ºç¼–è¯‘æ—¶åˆ›å»ºçš„ä¸´æ—¶å·¥ä½œç›®å½•çš„è·¯å¾„ï¼Œå¹¶ä¸”ä¸åˆ é™¤å®ƒ 7-x # æ‰“å°ç¼–è¯‘è¿‡ç¨‹ä¸­æ‰€éœ€çš„å‘½ä»¤ï¼Œå¹¶æ‰§è¡Œä»–ä»¬ æ³¨æ„ä¸-nçš„åŒºåˆ« 3.2 go build ç”¨äºç¼–è¯‘æºç æ–‡ä»¶æˆ–ä»£ç åŒ…\nç¼–è¯‘éå‘½ä»¤æºç æ–‡ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•æ‰§è¡Œç»“æœ(åªæ˜¯æ£€æŸ¥è¯­æ³•çš„æœ‰æ•ˆæ€§)\nç¼–è¯‘å‘½ä»¤æºç æ–‡ä»¶ä¼šåœ¨è¯¥å‘½ä»¤çš„æ‰§è¡Œç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶\næ‰§è¡Œè¯¥å‘½ä»¤ä¸”ä¸è¿½åŠ ä»»ä½•å‚æ•°æ—¶ï¼Œä»–ä¼šè¯•å›¾æŠŠå½“å‰ç›®å½•ä½œä¸ºä»£ç åŒ…å¹¶ç¼–è¯‘\næ‰§è¡Œè¯¥å‘½ä»¤ä¸”ä»¥ä»£ç åŒ…çš„å¯¼å…¥è·¯å¾„ä½œä¸ºå‚æ•°æ—¶ï¼Œæ”¹ä»£ç åŒ…åŠå…¶ä¾èµ–ä¼šè¢«ç¼–è¯‘\nï¼ˆ-a æ ‡è®°åæ‰€æœ‰æ¶‰åŠåˆ°çš„ä»£ç åŒ…éƒ½ä¼šè¢«é‡æ–°ç¼–è¯‘ ï¼‰\næ‰§è¡Œè¯¥å‘½ä»¤ä»¥è‹¥å¹²æºç æ–‡ä»¶ä½œä¸ºå‚æ•°æ—¶ï¼Œåªæœ‰è¿™äº›æ–‡ä»¶ä¼šè¢«ç¼–è¯‘ï¼ˆå¦‚æœç¼ºå°‘ä¾èµ–ä¼šç¼–è¯‘é”™è¯¯ï¼‰\nä¾‹å¦‚ï¼š /Users/airren/go/src/github.com/airren/day01/helloworld/main.go\nå¦‚æœå¯¹main.goè¿›è¡Œç¼–è¯‘ï¼Œ\nå¯ä»¥ç›´æ¥åœ¨hello wordè·¯å¾„ä¸‹æ‰§è¡Œgo build æˆ–è€…å†ä»»æ„è·¯å¾„æ‰§è¡Œgo build github.com/airren/day01/helloworldï¼Œ é¡¹ç›®çš„è·¯å¾„æ˜¯ä»$GOPATH/srcåå¼€å§‹å†™èµ· ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨æ‰§è¡Œgo buildçš„å½“å‰è·¯å¾„ä¸‹ã€‚\n1go build -o hello # æŒ‡å®šç¼–è¯‘åçš„æ–‡ä»¶å 3.3 go install å…ˆæ‰§è¡Œ go build åcopy\nç”¨äºç¼–è¯‘å¹¶å®‰è£…ä»£ç åŒ…æˆ–æºç æ–‡ä»¶ å®‰è£…ä»£ç åŒ…ä¼šåœ¨å½“å‰å·¥ä½œåŒºçš„ pkg/\u0026lt;å¹³å°ç›¸å…³ç›®å½•\u0026gt;ä¸‹ç”Ÿæˆå½’æ¡£æ–‡ä»¶ å®‰è£…å‘½ä»¤æºç æ–‡ä»¶ä¼šåœ¨å½“å‰å·¥ä½œåŒºçš„binç›®å½•æˆ–$GOBINç›®å½•ä¸‹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ æ‰§è¡Œè¯¥å‘½ä»¤ä¸”ä¸è¿½åŠ ä»»ä½•å‚æ•°æ—¶ï¼Œå®ƒä¼šè¯•å›¾æŠŠå½“å‰ç›®å½•ä½œä¸ºä»£ç åŒ…å¹¶å®‰è£… æ‰§è¡Œè¯¥å‘½ä»¤ä¸”ä»¥ä»£ç åŒ…çš„å¯¼å…¥è·¯å¾„ä½œä¸ºå‚æ•°æ—¶ï¼Œè¯¥ä»£ç åŒ…åŠå…¶ä¾èµ–ä¼šè¢«å®‰è£… æ‰§è¡Œæ”¹å‘½ä»¤ä¸”ä»¥å‘½ä»¤æºç æ–‡ä»¶ä»¥åŠç›¸å…³åº“æºç æ–‡ä»¶ä½œä¸ºå‚æ•°æ—¶ï¼Œåªæœ‰è¿™äº›æ–‡ä»¶ä¼šè¢«ç¼–è¯‘å¹¶å®‰è£… ä»£ç åŒ…å®‰è£…ä¹‹åï¼Œåœ¨pkgä¸­ä¼šæœ‰ .a æ–‡ä»¶, åœ¨å…¶ä»–çš„ä»£ç ä¸­å°±å¯ä»¥å¼•å…¥å·²ç»å®‰è£…çš„ä»£ç åŒ…\n3.4 go get ç”¨äºä»è¿œç¨‹ä»£ç ä»“åº“(github, gitlab,gogs)ä¸Šä¸‹è½½å¹¶å®‰è£…ä»£ç åŒ… å—æ”¯æŒçš„ä»£ç ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæœ‰: Git , Mercurial(hg)ï¼ŒSVN, Bazaar æŒ‡å®šçš„ä»£ç åŒ…ä¼šè¢«ä¸‹è½½åˆ°$GOPATHä¸­åŒ…å«çš„ç¬¬ä¸€ä¸ªå·¥ä½œåŒºçš„srcç›®å½•ä¸­ï¼Œç„¶åå†å®‰è£… 1go get -x github.com/go-errors/errors go getå¸¸ç”¨æ ‡è®°çš„ä½¿ç”¨\n1-d # åªæ‰§è¡Œä¸‹è½½åŠ¨ä½œï¼Œè€Œä¸æ‰§è¡Œå®‰è£…åŠ¨ä½œ 2-fix # åœ¨ä¸‹è½½ä»£ç åŒ…åå…ˆæ‰§è¡Œä¿®æ­£åŠ¨ä½œï¼Œè€Œåå†è¿›è¡Œç¼–è¯‘å’Œå®‰è£… 3-u # åˆ©ç”¨ç½‘ç»œæ¥æ›´æ–°å·²æœ‰çš„ä»£ç åŒ…åŠå…¶ä¾èµ–åŒ… 4-x # æ˜¾ç¤ºè¿‡ç¨‹ 3.5 godoc 1go get golang.org/x/tools/cmd/godoc 4. è·¨å¹³å°ç¼–è¯‘ äº¤å‰ç¼–è¯‘\né»˜è®¤æˆ‘ä»¬go buildçš„å¯æ‰§è¡Œæ–‡ä»¶éƒ½æ˜¯å½“å‰æ“ä½œç³»ç»Ÿå¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œå¦‚æœæˆ‘æƒ³åœ¨windowsä¸‹ç¼–è¯‘ä¸€ä¸ªlinuxä¸‹å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£éœ€è¦æ€ä¹ˆåšå‘¢ï¼Ÿ\nåªéœ€è¦æŒ‡å®šç›®æ ‡æ“ä½œç³»ç»Ÿçš„å¹³å°å’Œå¤„ç†å™¨æ¶æ„å³å¯ï¼š\n1SET CGO_ENABLED=0 // ç¦ç”¨CGO 2SET GOOS=linux // ç›®æ ‡å¹³å°æ˜¯linux 3SET GOARCH=amd64 // ç›®æ ‡å¤„ç†å™¨æ¶æ„æ˜¯amd64 ä½¿ç”¨äº†cgoçš„ä»£ç æ˜¯ä¸æ”¯æŒè·¨å¹³å°ç¼–è¯‘çš„\nç„¶åå†æ‰§è¡Œgo buildå‘½ä»¤ï¼Œå¾—åˆ°çš„å°±æ˜¯èƒ½å¤Ÿåœ¨Linuxå¹³å°è¿è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶äº†ã€‚\nMac ä¸‹ç¼–è¯‘ Linux å’Œ Windowså¹³å° 64ä½ å¯æ‰§è¡Œç¨‹åºï¼š\n1CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build 2CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build Linux ä¸‹ç¼–è¯‘ Mac å’Œ Windows å¹³å°64ä½å¯æ‰§è¡Œç¨‹åºï¼š\n1CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build 2CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build Windowsä¸‹ç¼–è¯‘Macå¹³å°64ä½å¯æ‰§è¡Œç¨‹åºï¼š\n1SET CGO_ENABLED=0 2SET GOOS=darwin 3SET GOARCH=amd64 4go build t\n","date":"August 20, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/1_go_basic_cmd/","summary":"1. Goè¯­è¨€ä»‹ç» 1.1 Go è¯­è¨€ç‰¹ç‚¹ é™æ€ç±»å‹ã€ç¼–è¯‘å‹çš„å¼€æºè¯­è¨€\né™æ€ç±»å‹æ˜¯æŒ‡è¦æ˜ç¡®å˜é‡çš„ç±»å‹ï¼Œæˆ–è€…ç¼–è¯‘å™¨å¯ä»¥æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ã€‚è¦ä¹ˆåœ¨å˜é‡ç±»å‹æ—è¾¹æŒ‡å®šå˜é‡çš„é‚£ä¸ªç±»å‹ï¼Œè¦ä¹ˆæ˜¯å¯ä»¥æ¨å¯¼å‡ºå˜é‡ç±»å‹ã€‚\nç¼–è¯‘å‹æ˜¯æŒ‡è¦ç¼–è¯‘æˆæœºå™¨è¯­è¨€ã€‚\n1package main 2func main(){ 3 // Declare the type of the variable 4 var num1 int = 1; 5 // Deduce the type of the variable 6 num2 :=2 7} è„šæœ¬åŒ–çš„è¯­æ³•ï¼Œæ”¯æŒå¤šç§èŒƒå¼ç¼–ç¨‹\nå‡½æ•°å¼\u0026amp;é¢å‘å¯¹è±¡\nåŸç”Ÿã€ç»™åŠ›çš„å¹¶å‘ç¼–ç¨‹æ”¯æŒ\næ³¨æ„ï¼š åŸç”Ÿæ”¯æŒå’Œå‡½æ•°åº“æ”¯æŒçš„åŒºåˆ«\n1.2 Goè¯­è¨€çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ ä¼˜åŠ¿\nè„šæœ¬åŒ–çš„è¯­æ³• é™æ€ç±»å‹+ç¼–è¯‘å‹ï¼Œç¨‹åºè¿è¡Œé€Ÿåº¦æœ‰ä¿éšœ åŸç”Ÿçš„æ”¯æŒå¹¶å‘ç¼–ç¨‹ - é™ä½å¼€å‘ã€ç»´æŠ¤æˆæœ¬ï¼›ç¨‹åºå¯ä»¥æ›´å¥½çš„æ‰§è¡Œ åŠ£åŠ¿\nè¯­æ³•ç³–å¹¶æ²¡æœ‰Pythonå’ŒRubyé‚£ä¹ˆå¤š- 1æˆæ˜¯å¼€å‘æ—¶é—´ï¼Œ9æˆç»´æŠ¤æ—¶é—´ ç›®å‰çš„ç¨‹åºè¿è¡Œé€Ÿåº¦è¿˜ä¸åŠcï¼Œä½†æ˜¯ç›®å‰å·²ç»èµ¶è¶…äº†C++å’ŒJava ç¬¬ä¸‰æ–¹åº“å‡½æ•°æš‚æ—¶ä¸åƒç»å¯¹ä¸»æµçš„ç¼–ç¨‹è¯­è¨€é‚£æ ·å¤š 1.3 Goå¼€å‘ç¯å¢ƒ Linux ä¸‹çš„å®‰è£… FreeBSD Linux Windows 32bit - 64bit\nLinux ä¸‹çš„è®¾ç½®æ–¹æ³•\næœ‰å››ä¸ªç¯å¢ƒå˜é‡éœ€è¦è®¾ç½®ï¼š GOROOTã€GOPATHã€GOBINä»¥åŠPATH","tags":["Go"],"title":"ã€ŒGoã€Goçš„å®‰è£…ä»¥åŠä»‹ç»"},{"categories":null,"contents":"1. Docker å®‰è£…ElasticSearch 1docker search elasticsearch 1docker pull elasticsearch # é»˜è®¤ä¼šæ‹‰å– latest ç‰ˆæœ¬ 2docker pull elasticsearch:6.8.11 # https://hub.docker.com/ ç‰ˆæœ¬æŸ¥æ‰¾ 3docker images # æŸ¥çœ‹æœ¬åœ°images 1 docker run -d --name elasticserarch_1 -p 9200:9200 -p 9300:9300 elasticsearch:6.8.11 1docker ps 1curl http://devbox:9200/ 2. docker å®‰è£…Cerebro 1docker search cerebro # test 1docker pull lmenezes/cerebro 1docker run -d -p 9002:9000 \\ 2--restart=unless-stopped \\ 3--name cerebro \\ 4-v /etc/localtime:/etc/localtime \\ 5-v cerebro:/opt/cerebro \\ 6-h cerebro \\ 7lmenezes/cerebro 86f036de7c87672903c88f6590d40d052e8c7b79767e410e35b1f2162c268b63f docker run å‚æ•°è¯´æ˜\nhttps://www.runoob.com/docker/docker-run-command.html?ivk_sa=1023345p\nè®¿é—®http://ip:9002 å¹¶é…ç½®é›†ç¾¤\né…ç½®å®Œæˆåç‚¹å‡» connect, ä¸‹å›¾ä¸­å·²ç»å»ºç«‹å¥½ä¸¤ä¸ªIndex\n1docker run -id https://www.runoob.com/docker/docker-run-command.html https://blog.csdn.net/qq_19381989/article/details/102781663\n1curl ","date":"August 18, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/NoSQL/ElasticSearch/elasticsearch_install/","summary":"1. Docker å®‰è£…ElasticSearch 1docker search elasticsearch 1docker pull elasticsearch # é»˜è®¤ä¼šæ‹‰å– latest ç‰ˆæœ¬ 2docker pull elasticsearch:6.8.11 # https://hub.docker.com/ ç‰ˆæœ¬æŸ¥æ‰¾ 3docker images # æŸ¥çœ‹æœ¬åœ°images 1 docker run -d --name elasticserarch_1 -p 9200:9200 -p 9300:9300 elasticsearch:6.8.11 1docker ps 1curl http://devbox:9200/ 2. docker å®‰è£…Cerebro 1docker search cerebro # test 1docker pull lmenezes/cerebro 1docker run -d -p 9002:9000 \\ 2--restart=unless-stopped \\ 3--name cerebro \\ 4-v /etc/localtime:/etc/localtime \\ 5-v cerebro:/opt/cerebro \\ 6-h cerebro \\ 7lmenezes/cerebro 86f036de7c87672903c88f6590d40d052e8c7b79767e410e35b1f2162c268b63f docker run å‚æ•°è¯´æ˜","tags":[""],"title":"ã€ŒElasticSearchã€ElasticSearchå®‰è£…"},{"categories":null,"contents":"","date":"August 17, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/MessageQueue/kafka_install/","summary":"","tags":["Mongo"],"title":"ã€ŒKafkaã€Kafkaå®‰è£…"},{"categories":null,"contents":"\r","date":"August 17, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/NoSQL/ElasticSearch/logstash_install/","summary":"\r","tags":["ElasticSearch"],"title":"ã€ŒLogStashã€LogStashå®‰è£…"},{"categories":null,"contents":"mongo åŸºæœ¬æ•°æ®ç±»å‹ Type bosun.E type E struct { Key string Value interface{} } E represents a BSON element for a D. It is usually used inside a D. bosun.D type D []E D is an ordered representation of a BSON document. This type should be used when the order of the elements matters, // such as MongoDB command documents. If the order of the elements does not matter, an M should be used instead. // // Example usage: // // bson.D{{\u0026ldquo;foo\u0026rdquo;, \u0026ldquo;bar\u0026rdquo;}, {\u0026ldquo;hello\u0026rdquo;, \u0026ldquo;world\u0026rdquo;}, {\u0026ldquo;pi\u0026rdquo;, 3.14159}} bosun.M type M map[string]interface{} // M is an unordered representation of a BSON document. This type should be used when the order of the elements does not // matter. This type is handled as a regular map[string]interface{} when encoding and decoding. Elements will be // serialized in an undefined, random order. If the order of the elements matters, a D should be used instead. // // Example usage: // // bson.M{\u0026ldquo;foo\u0026rdquo;: \u0026ldquo;bar\u0026rdquo;, \u0026ldquo;hello\u0026rdquo;: \u0026ldquo;world\u0026rdquo;, \u0026ldquo;pi\u0026rdquo;: 3.14159}. bosun.A type A []interface{} // An A is an ordered representation of a BSON array. // // Example usage: // // bson.A{\u0026ldquo;bar\u0026rdquo;, \u0026ldquo;world\u0026rdquo;, 3.14159, bson.D{{\u0026ldquo;qux\u0026rdquo;, 12345}}} è®¾ç½®æŸä¸ªå­—æ®µçš„å€¼\n1setValue := bson.E{Key: \u0026#34;$set\u0026#34;, Value: bson.D{{\u0026#34;end_at\u0026#34;, alert.CreatedAt}}}) 2 ? bson.E{Key: \u0026#34;$set\u0026#34;, Value: bson.D{{\u0026#34;end_at\u0026#34;, alert.CreatedAt}}}) 3\tupdate = append(update, bson.E{Key: \u0026#34;$inc\u0026#34;, Value: bson.D{bson.E{Key:\u0026#34;count\u0026#34;, Value: 1}}}) filter 1filter = make(bson.D, 0) 2filter = $or 1{\u0026#34;key1\u0026#34;:1,\u0026#34;$or\u0026#34;:[{\u0026#34;key2\u0026#34;:2},{\u0026#34;key3\u0026#34;:2}] 1filter:= bson.D{ 2 {\u0026#34;key1\u0026#34;,1}, 3 {\u0026#34;$or\u0026#34;:[]interface{ 4 bson.M{\u0026#34;key2\u0026#34;:2}, 5 bson.M{\u0026#34;key3\u0026#34;:2}, 6 }} 7} The query should be equivalent to the following in the mongo console\n1db.mycollection.find{{\u0026#34;key1\u0026#34;:1,\u0026#34;$or\u0026#34;:[{\u0026#34;key2\u0026#34;:2},{\u0026#34;key3\u0026#34;:2}]}} if you\u0026rsquo;d rather wish to use unordered maps, it would be like this\n1pipeline := bson.M{ 2 \u0026#34;key1\u0026#34;:1; 3 \u0026#34;$or\u0026#34;:[]interface{ 4 bson.M{\u0026#34;key2\u0026#34;:2}, 5 bson.M{\u0026#34;key3\u0026#34;:2}, 6 } 7} other example\n1findQuery := bson.M{ 2 \u0026#34;key1\u0026#34;:1, 3} 4 5orQuery:= []bson.M{} 6orQuery= append(orQuery, bson.M{\u0026#34;key2\u0026#34;:2}, bson.M{\u0026#34;key3\u0026#34;:2}) 7 8findquery[\u0026#34;$or\u0026#34;] = orQuery 9result := []interface{} 10err := mongo.DB.C(\u0026#34;collectionName\u0026#34;).find(findQuery).All(\u0026amp;result) ","date":"August 17, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/DataBase/mongo/mongo_go_sdk/","summary":"mongo åŸºæœ¬æ•°æ®ç±»å‹ Type bosun.E type E struct { Key string Value interface{} } E represents a BSON element for a D. It is usually used inside a D. bosun.D type D []E D is an ordered representation of a BSON document. This type should be used when the order of the elements matters, // such as MongoDB command documents. If the order of the elements does not matter, an M should be used instead.","tags":["Mongo"],"title":"ã€ŒMongoã€Mongo golang sdk"},{"categories":null,"contents":"RRD(Round Robin Database) RRD æ•°æ®åº“åœ¨åˆ›å»ºçš„æ—¶å€™å°±å·²ç»å®šä¹‰å¥½äº†å¤§å°ï¼Œå½“å­˜å‚¨ç©ºé—´æ»¡äº†ä¹‹åï¼Œåˆä»å¤´å¼€å§‹è¦†ç›–æ—§çš„æ•°æ®ï¼Œé€‚ç”¨äºå­˜å‚¨å’Œæ—¶é—´åºåˆ—ç›¸å…³çš„æ•°æ®ã€‚RRDçš„å¤§å°å¯æ§ï¼Œä¸”ä¸ç”¨ç»´æŠ¤ã€‚\nA specialized storage system known as a Round Robin Database allows one to store large amounts of series information such as temperatures, network bandwidth, and stock prices with a constant disk footprint. It does this by taking advantage of changing needs for precision. As we will see later, the \u0026ldquo;round-robin \u0026quot; part comes from the basic data structure used to store data points: circular lists.\nå‚è€ƒèµ„æ–™ï¼š\n[https://jawnsy.wordpress.com/2010/01/08/round-robin-databases/#:~:text=A%20specialized%20storage%20system%20known,of%20changing%20needs%20for%20precision.](https://jawnsy.wordpress.com/2010/01/08/round-robin-databases/#:~:text=A specialized storage system known,of changing needs for precision.)\nhttps://www.docs4dev.com/docs/zh/opentsdb/2.3/reference/api_http-query-index.html\n","date":"August 10, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/tsdb_argot/","summary":"RRD(Round Robin Database) RRD æ•°æ®åº“åœ¨åˆ›å»ºçš„æ—¶å€™å°±å·²ç»å®šä¹‰å¥½äº†å¤§å°ï¼Œå½“å­˜å‚¨ç©ºé—´æ»¡äº†ä¹‹åï¼Œåˆä»å¤´å¼€å§‹è¦†ç›–æ—§çš„æ•°æ®ï¼Œé€‚ç”¨äºå­˜å‚¨å’Œæ—¶é—´åºåˆ—ç›¸å…³çš„æ•°æ®ã€‚RRDçš„å¤§å°å¯æ§ï¼Œä¸”ä¸ç”¨ç»´æŠ¤ã€‚\nA specialized storage system known as a Round Robin Database allows one to store large amounts of series information such as temperatures, network bandwidth, and stock prices with a constant disk footprint. It does this by taking advantage of changing needs for precision. As we will see later, the \u0026ldquo;round-robin \u0026quot; part comes from the basic data structure used to store data points: circular lists.","tags":["TSDB"],"title":"ã€ŒTSDBã€æœ¯è¯­"},{"categories":null,"contents":"æ€æƒ³å’Œèº«ä½“è‡³å°‘æœ‰ä¸€ä¸ªåœ¨è·¯ä¸Š\nä¸è¦åšä¸€ä¸ªè¡Œå°¸èµ°è‚‰\nå¦‚æœä¸€ä»¶äº‹åšä¸åˆ°100åˆ†ï¼Œé‚£å’Œæ²¡åšæœ‰ä»€ä¹ˆåˆ†åˆ«\næŠ¬å¤´çœ‹è·¯ï¼Œä½å¤´åšäº‹\n","date":"August 9, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/nice_day/","summary":"æ€æƒ³å’Œèº«ä½“è‡³å°‘æœ‰ä¸€ä¸ªåœ¨è·¯ä¸Š\nä¸è¦åšä¸€ä¸ªè¡Œå°¸èµ°è‚‰\nå¦‚æœä¸€ä»¶äº‹åšä¸åˆ°100åˆ†ï¼Œé‚£å’Œæ²¡åšæœ‰ä»€ä¹ˆåˆ†åˆ«\næŠ¬å¤´çœ‹è·¯ï¼Œä½å¤´åšäº‹","tags":[""],"title":"ã€ŒåšæŒã€ åšå¥½æ¯ä¸€ä»¶äº‹"},{"categories":null,"contents":"ç”¨æˆ·å’Œç”¨æˆ·ç»„ groups 1groups \u0026lt;user1\u0026gt; \u0026lt;user2\u0026gt; \u0026lt;user3\u0026gt; # æŸ¥çœ‹å½“å‰ç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ ","date":"August 9, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/user/","summary":"ç”¨æˆ·å’Œç”¨æˆ·ç»„ groups 1groups \u0026lt;user1\u0026gt; \u0026lt;user2\u0026gt; \u0026lt;user3\u0026gt; # æŸ¥çœ‹å½“å‰ç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ ","tags":[""],"title":"ã€ŒLinuxã€ user"},{"categories":null,"contents":"Hexo å®‰è£… https://hexo.io/zh-cn/docs/\nå®‰è£…Node.js\nå®‰è£…Git\nå®‰è£…Hexo\n1sudo npm install -g hexo-cli å¦‚æœåœ¨macä¸­å®‰è£…æŠ¥/usr/lib/node_modules/çš„æ“ä½œæƒé™é—®é¢˜ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚\n1sudo chown -R `whoami` /usr/local/lib/node_modules åˆå§‹åŒ–é¡¹ç›®\n1hexo init blog åˆ›å»ºå®Œæˆåï¼Œå½“å‰ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ªxx_blogçš„æ–‡ä»¶å¤¹ï¼Œå…·ä½“çš„æ–‡ä»¶å¤¹æŸ¥è¯¢å®˜ç½‘hexo.io\nHexo éƒ¨ç½²åˆ°Nginx \u0026amp; Github.io å¼€å‘æœº åœ¨è‡ªå·±å†™Blogçš„Pcä¸Šå®‰è£…æ’ä»¶\n1yarn add hexo-deployer-git æœåŠ¡å™¨ åœ¨å³å°†éƒ¨ç½²çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹æ“ä½œ\n1yum install git 2 3useradd -m git # åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ 4 # æ–°å»ºgitç”¨æˆ·å¹¶éå¿…è¦ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨èµ·è§ï¼Œè¿˜æ˜¯ç”¨gitç”¨æˆ·å•ç‹¬æ¥è¿è¡ŒgitæœåŠ¡ 5 6passwd git è®¾ç½®PCåˆ°æœåŠ¡å™¨çš„gitç”¨æˆ·å…å¯†ç™»å½•\n1# ç”Ÿæˆsshå¯†é’¥ 2ssh-keygen 3# å°†å…¬é’¥æ·»åŠ åˆ°server 4ssh-copy-id git@serverIp åœ¨æœåŠ¡å™¨ä¸Šåˆå§‹åŒ–ä¸€ä¸ªGitä»“åº“\n1mkdir -p /var/repo 2ca /var/repo 3git init --bare blog.git # --bare åˆå§‹åŒ–ä¸€ä¸ªè£¸ä»“åº“ï¼Œè£¸ä»“åº“æ²¡æœ‰å·¥ä½œåŒºï¼Œåªä¸ºå…±äº«è€Œå­˜åœ¨ 4chown -R git:git blog.git â€‹ é…ç½®Git hooks\n1mkdir /var/repo/blog.git/hooks 2vi post-receive â€‹ å†™å…¥ä»¥ä¸‹å†…å®¹\n1#!/bin/sh 2git --work-tree=/var/www/blog --git-dir=/home/git/byte_gopher_blog.git checkout -f 3# /var/www/blog æ˜¯éƒ¨ç½²ç›®å½•ã€‚ æ¯æ¬¡pushå®Œæˆä¹‹å â€‹ å¢åŠ å¯æ‰§è¡Œæƒé™\n1chmod +x /var/repo/blog.git/hooks/post-receive ç¦ç”¨gitç”¨æˆ·çš„shellç™»å½•æƒé™\n1vi /etc/passwd 2# gitâŒ1001:1001:,,,:/home/git:/bin/bash 3 gitâŒ1001:1001:,,,:/home/git:/usr/bin/git-shell æœ€åå†ç¦ç”¨\néƒ¨ç½²nginx\nåˆ›å»ºéœ€è¦çš„ä»£ç†æ–‡ä»¶å¤¹\n1mkdir -p /home/www/hexo #åˆ›å»ºç›®å½• 2chown -R git:git /home/www/hexo # å¢åŠ gitç”¨æˆ·æƒé™ ä¿®æ”¹nginxé…ç½®/etc/nginx/nginx.conf\n1 server { 2 listen 80 default_server; 3 listen [::]:80 default_server; 4 server_name _; 5 root /home/www/hexo; 6 7 include /etc/nginx/default.d/*.conf; 8 9 location / { 10 } 11 12 error_page 404 /404.html; 13 location = /40x.html { 14 } 15 16 error_page 500 502 503 504 /50x.html; 17 location = /50x.html { 18 } 19 } é…ç½®hexo _config.yml\n1# URL 2## If your site is put in a subdirectory, set url as \u0026#39;http://yoursite.com/child\u0026#39; and root as \u0026#39;/child/\u0026#39; 3url: https://www.bytegopher.com # ä¸ºäº†é¿å…ä¸å¿…è¦çš„éº»çƒ¦æ­¤å¤„è®¾ç½®æ ¹åŸŸå \u0026amp; æ ¹ç›®å½• 4root: / 5 6# Deployment branch: gh-pages # branch name, whaterver\nå‘å¸ƒBlog\nå†™å®Œåšå®¢ä¹‹åç›´æ¥å‘å¸ƒå°±å¯ä»¥æ›´æ–°åˆ°NginxæœåŠ¡å™¨\u0026amp; Github.io\n1hexo clean \u0026amp; hexo d -g ?\nConfig md conf 1title: Hello Hexoï¼ 2layout: post 3subtitle: \u0026#34;hello word, welcome\u0026#34; 4date: 2020-07-26 01:09:53 5author: \u0026#34;Airren\u0026#34; 6catalog: true 7header-img: \u0026#34;post-bg-js-module.jpg\u0026#34; 8tags: 9 - Life _config.yml 1# Hexo Configuration 2## Docs: https://hexo.io/docs/configuration.html 3## Source: https://github.com/hexojs/hexo/ 4 5# Site 6title: ByteGopher 7subtitle: To Be A Lean Developer! 8author: Airren 9language: en 10timezone: Asia/Shanghai 11 12# URL 13## If your site is put in a subdirectory, set url as \u0026#39;http://yoursite.com/child\u0026#39; and root as \u0026#39;/child/\u0026#39; 14url: https://www.bytegopher.com 15root: / 16permalink: :year/:month/:day/:title/ 17permalink_defaults: 18 19#Custom Setting Start 20 21# Site settings 22SEOTitle: ByteGopher | Airren 23header-img: img/home-bg.jpg 24email: renqiqiang@outlook.com 25description: \u0026#34;ByteGopher\u0026#34; 26keyword: \u0026#34;ByteGopher, Airren\u0026#34; 27 28 29# SNS settings 30# RSS: false 31# weibo_username: Demonbane 32# zhihu_username: Demonbane 33github_username: Airren 34twitter_username: Airrenz 35facebook_username: Airrenz 36linkedin_username: å¼º-ä»»-b8a3b4103 37 38# Build settings 39anchorjs: true # if you want to customize anchor. check out line:181 of `post.html` 40 41 42# Disqus settings 43disqus_username: bytegopher 44 45# Duoshuo settings 46# duoshuo_username: kaijun 47# Share component is depend on Comment so we can NOT use share only. 48# duoshuo_share: true # set to false if you want to use Comment without Sharing 49 50 51# Analytics settings 52# Baidu Analytics 53ba_track_id: 4cc1f2d8f3067386cc5cdb626a202900 54# Google Analytics 55ga_track_id: \u0026#39;UA-49627206-1\u0026#39; # Format: UA-xxxxxx-xx 56ga_domain: bytegopher.com 57 58 59# Sidebar settings 60sidebar: true # whether or not using Sidebar. 61sidebar-about-description: \u0026#34;Hi, welcome!\u0026#34; 62sidebar-avatar: ./img/avatar.jpg # use absolute URL, seeing it\u0026#39;s used in both `/` and `/about/` 63 64 65# Featured Tags 66featured-tags: true # whether or not using Feature-Tags 67featured-condition-size: 1 # A tag will be featured if the size of it is more than this condition value 68 69 70# Friends 71friends: [ 72 { 73 title: \u0026#34;Kaijun\u0026#39;s Blog\u0026#34;, 74 href: \u0026#34;http://blog.kaijun.rocks\u0026#34; 75 },{ 76 title: \u0026#34;Hux Blog\u0026#34;, 77 href: \u0026#34;http://huangxuan.me\u0026#34; 78 }, 79] 80 81 82#Custom Setting End 83 84 85 86# Directory 87source_dir: source 88public_dir: public 89tag_dir: tags 90archive_dir: i_dont_wanna_use_default_archives 91category_dir: categories 92code_dir: downloads/code 93i18n_dir: :lang 94skip_render: 95 96# Writing 97new_post_name: :title.md # File name of new posts 98default_layout: post 99titlecase: false # Transform title into titlecase 100external_link: true # Open external links in new tab 101filename_case: 0 102render_drafts: false 103post_asset_folder: true 104relative_link: false 105future: true 106highlight: 107 enable: true 108 line_number: true 109 auto_detect: true 110 tab_replace: 111 112# Category \u0026amp; Tag 113default_category: uncategorized 114category_map: 115tag_map: 116 117# Date / Time format 118## Hexo uses Moment.js to parse and display date 119## You can customize the date format as defined in 120## http://momentjs.com/docs/#/displaying/format/ 121date_format: YYYY-MM-DD 122time_format: HH:mm:ss 123 124# Pagination 125## Set per_page to 0 to disable pagination 126per_page: 10 127pagination_dir: page 128 129# Extensions 130## Plugins: https://hexo.io/plugins/ 131## Themes: https://hexo.io/themes/ 132theme: huxblog 133 134# Deployment 135## Docs: https://hexo.io/docs/deployment.html 136deploy: 137 type: git 138 repo: 139 github: https://github.com/Airren/airren.github.io 140 alios: git@hongkong:/home/git/blog.git 141 branch: gh-pages 142 143index_generator: 144 per_page: 3 ##é¦–é é»˜è®¤10ç¯‡æ–‡ç« æ ‡é¢˜ å¦‚æœå€¼ä¸º0ä¸åˆ†é¡µ 145archive_generator: 146 per_page: 10 ##å½’æ¡£é¡µé¢é»˜è®¤10ç¯‡æ–‡ç« æ ‡é¢˜ 147 yearly: true ##ç”Ÿæˆå¹´è§†å›¾ 148 monthly: true ##ç”Ÿæˆæœˆè§†å›¾ 149tag_generator: 150 per_page: 10 ##æ ‡ç­¾åˆ†ç±»é¡µé¢é»˜è®¤10ç¯‡æ–‡ç«  151category_generator: 152 per_page: 10 ###åˆ†ç±»é¡µé¢é»˜è®¤10ç¯‡æ–‡ç«  Hexo Write Page 1hexo new page --path about/me \u0026#34;About me\u0026#34; 1INFO Created: ~/Desktop/ByteGopher/airren_blog/source/about/me.md Post 1hexo new post -p web/https_tips \u0026#34;HTTPS Tips\u0026#34; 1INFO Created: ~/Desktop/ByteGopher/airren_blog/source/_posts/web/https_tips.md referenceï¼š\nhttps://xdlrt.github.io/2016/02/18/2016-02-18/ https://www.lagou.com/lgeduarticle/40391.html https://juejin.im/post/5ab47e48f265da23805991dc https://blog.csdn.net/weixin_42646103/article/details/105181586?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param\u0026depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param https://zhuanlan.zhihu.com/p/158678677 https://oakland.github.io/2016/05/02/hexo-%E5%A6%82%E4%BD%95%E7%94%9F%E6%88%90%E4%B8%80%E7%AF%87%E6%96%B0%E7%9A%84post/ https://www.jianshu.com/p/e20deec143b1\nå‚è€ƒèµ„æ–™\nhttps://www.jianshu.com/p/e1ccd49b4e5d\n","date":"August 7, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/hexo_create/","summary":"Hexo å®‰è£… https://hexo.io/zh-cn/docs/\nå®‰è£…Node.js\nå®‰è£…Git\nå®‰è£…Hexo\n1sudo npm install -g hexo-cli å¦‚æœåœ¨macä¸­å®‰è£…æŠ¥/usr/lib/node_modules/çš„æ“ä½œæƒé™é—®é¢˜ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚\n1sudo chown -R `whoami` /usr/local/lib/node_modules åˆå§‹åŒ–é¡¹ç›®\n1hexo init blog åˆ›å»ºå®Œæˆåï¼Œå½“å‰ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ªxx_blogçš„æ–‡ä»¶å¤¹ï¼Œå…·ä½“çš„æ–‡ä»¶å¤¹æŸ¥è¯¢å®˜ç½‘hexo.io\nHexo éƒ¨ç½²åˆ°Nginx \u0026amp; Github.io å¼€å‘æœº åœ¨è‡ªå·±å†™Blogçš„Pcä¸Šå®‰è£…æ’ä»¶\n1yarn add hexo-deployer-git æœåŠ¡å™¨ åœ¨å³å°†éƒ¨ç½²çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹æ“ä½œ\n1yum install git 2 3useradd -m git # åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ 4 # æ–°å»ºgitç”¨æˆ·å¹¶éå¿…è¦ï¼Œä½†æ˜¯ä¸ºäº†å®‰å…¨èµ·è§ï¼Œè¿˜æ˜¯ç”¨gitç”¨æˆ·å•ç‹¬æ¥è¿è¡ŒgitæœåŠ¡ 5 6passwd git è®¾ç½®PCåˆ°æœåŠ¡å™¨çš„gitç”¨æˆ·å…å¯†ç™»å½•\n1# ç”Ÿæˆsshå¯†é’¥ 2ssh-keygen 3# å°†å…¬é’¥æ·»åŠ åˆ°server 4ssh-copy-id git@serverIp åœ¨æœåŠ¡å™¨ä¸Šåˆå§‹åŒ–ä¸€ä¸ªGitä»“åº“\n1mkdir -p /var/repo 2ca /var/repo 3git init --bare blog.git # --bare åˆå§‹åŒ–ä¸€ä¸ªè£¸ä»“åº“ï¼Œè£¸ä»“åº“æ²¡æœ‰å·¥ä½œåŒºï¼Œåªä¸ºå…±äº«è€Œå­˜åœ¨ 4chown -R git:git blog.","tags":["Hexo"],"title":"ã€ŒHexoã€ æ­å»ºéƒ¨ç½²"},{"categories":null,"contents":"HBase ç®€ä»‹ OpensTSDBæ”¯æŒå¤šç§åº•å±‚å­˜å‚¨ï¼Œä¾‹å¦‚HBaseã€Cassandraã€‚\nHBaseæ˜¯åˆ†å¸ƒå¼åˆ—å­˜å‚¨ç³»ç»Ÿï¼Œå…¶åº•å±‚ä¾èµ–HDFSåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚HBaseæ˜¯å‚è€ƒGoogle BigTableæ¨¡å‹å¼€å‘çš„ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå…¸å‹çš„KVå­˜å‚¨ï¼Œé€‚ç”¨äºæµ·é‡ç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨ã€‚\nHBaseçš„ä¼˜ç‚¹ï¼š\né›†ç¾¤éƒ¨ç½²ï¼Œæ¨ªå‘æ‰©å±•æ–¹ä¾¿ å®¹é”™æ€§é«˜ï¼Œç›¸åŒçš„æ•°æ®ä¼šå¤åˆ¶å¤šä»½ï¼Œæ”¾åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Š åŒç­‰ç¡¬ä»¶ï¼Œç›¸æ¯”ä¼ ç»Ÿæ•°æ®åº“æ”¯æŒçš„æ•°é‡çº§é«˜ ååèƒ½åŠ›å¼ºï¼Œå†™å…¥é‡é«˜ ä¸è¶³ï¼š\nåªæ”¯æŒå•è¡Œçš„äº‹åŠ¡ æŸ¥è¯¢æ–¹å¼ï¼š åªèƒ½é€šè¿‡RowKeyè¿›è¡ŒæŸ¥è¯¢æˆ–è€…æ‰«æ HBase å’ŒHDFSçš„å…³ç³»ï¼Ÿ å…¨é¢äº‹åŠ¡ ","date":"August 7, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/hbase_introduction/","summary":"HBase ç®€ä»‹ OpensTSDBæ”¯æŒå¤šç§åº•å±‚å­˜å‚¨ï¼Œä¾‹å¦‚HBaseã€Cassandraã€‚\nHBaseæ˜¯åˆ†å¸ƒå¼åˆ—å­˜å‚¨ç³»ç»Ÿï¼Œå…¶åº•å±‚ä¾èµ–HDFSåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚HBaseæ˜¯å‚è€ƒGoogle BigTableæ¨¡å‹å¼€å‘çš„ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå…¸å‹çš„KVå­˜å‚¨ï¼Œé€‚ç”¨äºæµ·é‡ç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨ã€‚\nHBaseçš„ä¼˜ç‚¹ï¼š\né›†ç¾¤éƒ¨ç½²ï¼Œæ¨ªå‘æ‰©å±•æ–¹ä¾¿ å®¹é”™æ€§é«˜ï¼Œç›¸åŒçš„æ•°æ®ä¼šå¤åˆ¶å¤šä»½ï¼Œæ”¾åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Š åŒç­‰ç¡¬ä»¶ï¼Œç›¸æ¯”ä¼ ç»Ÿæ•°æ®åº“æ”¯æŒçš„æ•°é‡çº§é«˜ ååèƒ½åŠ›å¼ºï¼Œå†™å…¥é‡é«˜ ä¸è¶³ï¼š\nåªæ”¯æŒå•è¡Œçš„äº‹åŠ¡ æŸ¥è¯¢æ–¹å¼ï¼š åªèƒ½é€šè¿‡RowKeyè¿›è¡ŒæŸ¥è¯¢æˆ–è€…æ‰«æ HBase å’ŒHDFSçš„å…³ç³»ï¼Ÿ å…¨é¢äº‹åŠ¡ ","tags":["Hbase"],"title":"ã€ŒHBaseã€ ç®€ä»‹"},{"categories":null,"contents":"Test Test 1go test --bench ./ 5s Code coverage 1go test -cover Profile å¼•å‘æ€§èƒ½é—®é¢˜çš„åŸå› ï¼Œ=æ‰§è¡Œæ—¶é—´è¿‡é•¿ã€å†…å­˜å ç”¨è¿‡å¤šï¼Œä»¥åŠæ„å¤–å µå¡ã€‚\nåœ¨æµ‹è¯•æ—¶ä¿å­˜å¹¶è¾“å‡ºç›¸å…³æ•°æ®ï¼Œè¿›è¡Œåˆæ¬¡è¯„ä¼° åœ¨è¿è¡Œé˜¶æ®µé€šè¿‡webæ¥å£è·å¾—å®æ—¶æ•°æ®ï¼Œåˆ†æä¸€æ®µæ—¶é—´å†…çš„å¥åº·çŠ¶å†µ 1go test -run NONE -bench . -memprofile mem.out -cpuprofile cpu.out net/http æœåŠ¡å¼€å¯debug ç«¯å£\n1go tool pprof http://10.152.50.69:9452/debug/pprof/profile\\?second\\=60 -alloc_space\npprof å¸¸ç”¨æŒ‡ä»¤\nWeb\n","date":"August 6, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/11_go_testprofile/","summary":"Test Test 1go test --bench ./ 5s Code coverage 1go test -cover Profile å¼•å‘æ€§èƒ½é—®é¢˜çš„åŸå› ï¼Œ=æ‰§è¡Œæ—¶é—´è¿‡é•¿ã€å†…å­˜å ç”¨è¿‡å¤šï¼Œä»¥åŠæ„å¤–å µå¡ã€‚\nåœ¨æµ‹è¯•æ—¶ä¿å­˜å¹¶è¾“å‡ºç›¸å…³æ•°æ®ï¼Œè¿›è¡Œåˆæ¬¡è¯„ä¼° åœ¨è¿è¡Œé˜¶æ®µé€šè¿‡webæ¥å£è·å¾—å®æ—¶æ•°æ®ï¼Œåˆ†æä¸€æ®µæ—¶é—´å†…çš„å¥åº·çŠ¶å†µ 1go test -run NONE -bench . -memprofile mem.out -cpuprofile cpu.out net/http æœåŠ¡å¼€å¯debug ç«¯å£\n1go tool pprof http://10.152.50.69:9452/debug/pprof/profile\\?second\\=60 -alloc_space\npprof å¸¸ç”¨æŒ‡ä»¤\nWeb","tags":null,"title":"ã€ŒGoã€pprof"},{"categories":null,"contents":"UNIX æ—¶é—´æˆ³ Unixæ—¶é—´æˆ³ï¼ˆè‹±æ–‡ä¸ºUnix epoch, Unix time, POSIX time æˆ– Unix timestampï¼‰æ˜¯æŒ‡æ ¼æ—å¨æ²»æ—¶é—´1970å¹´01æœˆ01æ—¥00æ—¶00åˆ†00ç§’(åŒ—äº¬æ—¶é—´1970å¹´01æœˆ01æ—¥08æ—¶00åˆ†00ç§’)èµ·è‡³ç°åœ¨çš„æ€»ç§’æ•°ã€‚\nç±»å‹ ä½æ•° Timestamp Time ç§’çº§ 10 1596646807 2020-08-06 01:00:07 æ¯«ç§’çº§ 13 1596646807000 2020-08-06 01:00:07 Unixæ—¶é—´æˆ³ï¼ˆè‹±æ–‡ä¸ºUnix epoch, Unix time, POSIX time æˆ– Unix timestampï¼‰\næ˜¯ä»1970å¹´1æœˆ1æ—¥ï¼ˆUTC/GMTçš„åˆå¤œï¼‰å¼€å§‹æ‰€ç»è¿‡çš„ç§’æ•°ï¼Œä¸è€ƒè™‘é—°ç§’ã€‚\n","date":"August 6, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/5.3go_time/","summary":"UNIX æ—¶é—´æˆ³ Unixæ—¶é—´æˆ³ï¼ˆè‹±æ–‡ä¸ºUnix epoch, Unix time, POSIX time æˆ– Unix timestampï¼‰æ˜¯æŒ‡æ ¼æ—å¨æ²»æ—¶é—´1970å¹´01æœˆ01æ—¥00æ—¶00åˆ†00ç§’(åŒ—äº¬æ—¶é—´1970å¹´01æœˆ01æ—¥08æ—¶00åˆ†00ç§’)èµ·è‡³ç°åœ¨çš„æ€»ç§’æ•°ã€‚\nç±»å‹ ä½æ•° Timestamp Time ç§’çº§ 10 1596646807 2020-08-06 01:00:07 æ¯«ç§’çº§ 13 1596646807000 2020-08-06 01:00:07 Unixæ—¶é—´æˆ³ï¼ˆè‹±æ–‡ä¸ºUnix epoch, Unix time, POSIX time æˆ– Unix timestampï¼‰\næ˜¯ä»1970å¹´1æœˆ1æ—¥ï¼ˆUTC/GMTçš„åˆå¤œï¼‰å¼€å§‹æ‰€ç»è¿‡çš„ç§’æ•°ï¼Œä¸è€ƒè™‘é—°ç§’ã€‚","tags":["Go"],"title":"ã€ŒGoã€æ—¶é—´"},{"categories":null,"contents":"ä»€ä¹ˆæ˜¯HTTPS ç”³è¯·å…è´¹SSL ä¸ƒç‰›äº‘å…è´¹SSLç”³è¯· Nginx éƒ¨ç½²è®¾ç½®https vi /etc/nginx/nginx.conf\n1 server { 2 listen 443 ssl http2 default_server; 3 listen [::]:443 ssl http2 default_server; 4 server_name www.bytegopher.com; # bind the domain name 5 root /var/www/hexo; 6 index index.html index.htm; 7 8 ssl_certificate /etc/nginx/bytegopher.com/bytegopher.com.crt; # absolute path of certificate 9 ssl_certificate_key /etc/nginx/bytegopher.com/bytegopher.com.key; # absolute path of certificate 10 ssl_session_timeout 5m; 11 ssl_protocols TLSv1.1 TLSv1.2; 12 ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE; 13 ssl_prefer_server_ciphers on; 14 15 # Load configuration files for the default server block. 16 include /etc/nginx/default.d/*.conf; 17 18 19 error_page 404 /404.html; 20 location = /40x.html { 21 } 22 23 error_page 500 502 503 504 /50x.html; 24 location = /50x.html { 25 } 26 } 27 28 # å¦‚æœæ˜¯httpè¯·æ±‚åˆ™è‡ªåŠ¨è½¬æ¢ä¸ºhttps 29 server { 30 listen 80; 31 server_name www.bytegopher.com; 32 rewrite ^(.*) https://$server_name$1 permanent; 33 } SSL çŠ¶æ€æ£€æµ‹ çŠ¶æ€æ£€æµ‹ å¦‚ä½•æŸ¥çœ‹ä¸€ä¸ªç½‘ç«™çš„éhttpsè¯·æ±‚ chrome è°ƒè¯•æ¨¡å¼çš„console ä¸­ä¼šè¾“å‡ºéhttpsè¯·æ±‚\n","date":"July 31, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/https_tips/","summary":"ä»€ä¹ˆæ˜¯HTTPS ç”³è¯·å…è´¹SSL ä¸ƒç‰›äº‘å…è´¹SSLç”³è¯· Nginx éƒ¨ç½²è®¾ç½®https vi /etc/nginx/nginx.conf\n1 server { 2 listen 443 ssl http2 default_server; 3 listen [::]:443 ssl http2 default_server; 4 server_name www.bytegopher.com; # bind the domain name 5 root /var/www/hexo; 6 index index.html index.htm; 7 8 ssl_certificate /etc/nginx/bytegopher.com/bytegopher.com.crt; # absolute path of certificate 9 ssl_certificate_key /etc/nginx/bytegopher.com/bytegopher.com.key; # absolute path of certificate 10 ssl_session_timeout 5m; 11 ssl_protocols TLSv1.1 TLSv1.2; 12 ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE; 13 ssl_prefer_server_ciphers on; 14 15 # Load configuration files for the default server block.","tags":["HTTPS"],"title":"ã€ŒHTTPSã€ Tips"},{"categories":null,"contents":"æ­å»ºé™æ€èµ„æºæœåŠ¡å™¨ é™æ€èµ„æºæ–‡ä»¶å¤¹\n1/root/file Nginx é…ç½®\nvi /etc/nginx/nginx.conf\n1location /file { # è¿™ä¸ªfile è·Ÿèµ„æºè·¯å¾„çš„åå­—æ²¡æœ‰åŠæ¯›é’±å…³ç³»ï¼Œå¯ä»¥ä¸åŒ 2\talias /root/file; # é™æ€èµ„æºçš„ç»å¯¹è·¯å¾„ 3\tautoindex on; # è‡ªåŠ¨åˆ›å»ºç›®å½• 4} ä¸ºäº†æé«˜æ–‡ä»¶çš„ä¼ è¾“æ•ˆç‡ï¼Œé™ä½å¸¦å®½æµªè´¹ï¼Œå¯ä»¥å¼€å¯gzipå‹ç¼©\n1gzip on; 2gzip_minPlength 1; # å°äº1å­—èŠ‚ä¸å‹ç¼©ï¼Œ 3gzip_comp_level 2; # å‹ç¼©çº§åˆ«ä¸º2 4gzip_types taxt/plain applicaton/x-javascripts txt/css application/xml image/jpeg image/gif image/png; # å‹ç¼©æ–‡ä»¶ç±»å‹ é‡å¯nginxæœåŠ¡\n1nginx -s reload 2# or 3systemctl restart nginx.service é€šè¿‡æµè§ˆå™¨è®¿é—®èµ„æº\næ­¤æ—¶è¿˜æœ‰å¾ˆå¤šå°ä¼™ä¼´å¤§æ¦‚ç‡ä¼šé‡åˆ°403 Forbiddenï¼Œ è¯•è¿‡å°†èµ„æºæ–‡ä»¶å¤¹è®¾ç½®ä¸º777 -R æƒé™æˆ–è€…chown -R nginx:nginx fileã€‚But, still doesn\u0026rsquo;r workã€‚\nç›®å‰çš„è§£å†³æ–¹æ³•æ˜¯å°†/etc/nginx/nginx.conf ä¸­çš„user è®¾ç½®ä¸ºroot ã€‚\n1# user nginx 2user root ","date":"July 31, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/nginx_tips/","summary":"æ­å»ºé™æ€èµ„æºæœåŠ¡å™¨ é™æ€èµ„æºæ–‡ä»¶å¤¹\n1/root/file Nginx é…ç½®\nvi /etc/nginx/nginx.conf\n1location /file { # è¿™ä¸ªfile è·Ÿèµ„æºè·¯å¾„çš„åå­—æ²¡æœ‰åŠæ¯›é’±å…³ç³»ï¼Œå¯ä»¥ä¸åŒ 2\talias /root/file; # é™æ€èµ„æºçš„ç»å¯¹è·¯å¾„ 3\tautoindex on; # è‡ªåŠ¨åˆ›å»ºç›®å½• 4} ä¸ºäº†æé«˜æ–‡ä»¶çš„ä¼ è¾“æ•ˆç‡ï¼Œé™ä½å¸¦å®½æµªè´¹ï¼Œå¯ä»¥å¼€å¯gzipå‹ç¼©\n1gzip on; 2gzip_minPlength 1; # å°äº1å­—èŠ‚ä¸å‹ç¼©ï¼Œ 3gzip_comp_level 2; # å‹ç¼©çº§åˆ«ä¸º2 4gzip_types taxt/plain applicaton/x-javascripts txt/css application/xml image/jpeg image/gif image/png; # å‹ç¼©æ–‡ä»¶ç±»å‹ é‡å¯nginxæœåŠ¡\n1nginx -s reload 2# or 3systemctl restart nginx.service é€šè¿‡æµè§ˆå™¨è®¿é—®èµ„æº\næ­¤æ—¶è¿˜æœ‰å¾ˆå¤šå°ä¼™ä¼´å¤§æ¦‚ç‡ä¼šé‡åˆ°403 Forbiddenï¼Œ è¯•è¿‡å°†èµ„æºæ–‡ä»¶å¤¹è®¾ç½®ä¸º777 -R æƒé™æˆ–è€…chown -R nginx:nginx fileã€‚But, still doesn\u0026rsquo;r workã€‚\nç›®å‰çš„è§£å†³æ–¹æ³•æ˜¯å°†/etc/nginx/nginx.conf ä¸­çš„user è®¾ç½®ä¸ºroot ã€‚","tags":["Nginx","Tips"],"title":"ã€ŒNginxã€ Tips"},{"categories":null,"contents":"å¸¸ç”¨é…ç½® vi ~/vimrc\n1set nu 2syntax on 3inoremap jj \u0026lt;ESC\u0026gt; # ues \u0026lt;jj\u0026gt; instead of \u0026lt;ESC\u0026gt; Vim ç›¸å…³é…ç½®ä»¥åŠå¿«æ·é”®è®¾ç½® .vimrc 1\u0026#34; Vim çš„é»˜è®¤å¯„å­˜å™¨å’Œç³»ç»Ÿå‰ªè´´æ¿å…±äº« 2set clipboard+=unnamed 3\u0026#34; selectæ¨¡å¼ä¸‹å¤åˆ¶ï¼Œæ–‡æœ¬é€‰ä¸­æ—¶ï¼ŒæŒ‰ä¸‹Ctrl+Cï¼Œå³å¯å¤åˆ¶ 4if has(\u0026#34;clipboard\u0026#34;) 5 vnoremap \u0026lt;C-C\u0026gt; \u0026#34;+y 6endif 7 8set nu 9 10syntax on 11inoremap jj \u0026lt;ESC\u0026gt; vimæ¨¡å¼ normal \u0026mdash;æŒ‰vè¿›å…¥\u0026mdash;\u0026gt; visual\nnormal \u0026ndash;\u0026gt; instert\ninsert\ncommand\nå¿«æ·é”® (normal) ç§»åŠ¨ å‘½ä»¤ åŠŸèƒ½ shift + 6 åˆ‡æ¢è¡Œé¦– shift + 4 åˆ‡æ¢åˆ°è¡Œå°¾ gg è·³è½¬åˆ°é¦–è¡Œè¡Œé¦– shift+g è·³è½¬åˆ°æœ«è¡Œè¡Œé¦– w ä¸‹ä¸€ä¸ªå•è¯ b ä¸Šä¸€ä¸ªå•è¯ e ç§»åŠ¨åˆ°è¯å°¾ åˆ é™¤ å‘½ä»¤ åŠŸèƒ½ x å‘ååˆ é™¤ä¸€ä¸ªå­—ç¬¦ X å‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦ nx è¿ç»­å‘ååˆ é™¤nä¸ªå­—ç¬¦ dd åˆ é™¤å½“å‰è¡Œ ndd åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„è¿ç»­å‘ä¸‹nè¡Œ d1G åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°ç¬¬ä¸€è¡Œæ‰€æœ‰çš„æ•°æ® dG åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°æœ€åä¸€è¡Œçš„æ‰€æœ‰æ•°æ® dw åˆ é™¤å…‰æ ‡ä¹‹åçš„å•è¯å‰©ä½™éƒ¨åˆ†ã€‚ d$ åˆ é™¤å…‰æ ‡ä¹‹åçš„è¯¥è¡Œå‰©ä½™éƒ¨åˆ†ã€‚ åˆ é™¤åŒ…å«ç‰¹å®šå­—ç¬¦çš„è¡Œ\n:g è¡¨ç¤º å…¨æ–‡æœç´¢å­—ç¬¦ä¸²ï¼Œç„¶ååœ¨åŒ¹é…çš„è¡Œä¸Šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤\n:%g/æœç´¢çš„æ­£åˆ™è¡¨è¾¾å¼/è¦æ‰§è¡Œçš„å‘½ä»¤\n1# åˆ é™¤åŒ…å«abcçš„è¡Œ 2:%g/abc/d 3 4# åˆ é™¤ä¸åŒ…å«abcçš„è¡Œ 5:%g!/abc/d 6# åˆ é™¤ä¸åŒ…å«abcçš„è¡Œï¼Œæœªæµ‹è¯• 7:v/abc/d å‰ªåˆ‡ é¦–å…ˆè¿›å…¥visualæ¨¡å¼ï¼Œå¯ä»¥ä½¿ç”¨ hjklè¿›è¡Œé€‰æ‹©ï¼Œ ç„¶åä½¿ç”¨ä»¥ä¸‹ å‘½ä»¤æ“ä½œ\nv -\u0026gt; è¿›å…¥æ™®é€š visual\nVï¼ˆshift+vï¼‰ -\u0026gt; è¿›å…¥visual Line\nCtrl+v \u0026mdash;-\u0026gt; visual blockï¼Œ shift+i å—æ¨¡å¼ä¸‹æ’å…¥\nå‘½ä»¤ åŠŸèƒ½ d å‰ªåˆ‡ y å¤åˆ¶ p é»è´´ ^ é€‰ä¸­å½“å‰è¡Œå½“è¡Œé¦– $ é€‰ä¸­å½“å‰è¡Œåˆ°è¡Œå°¾ å¤åˆ¶ å‘½ä»¤ åŠŸèƒ½ y visual æ¨¡å¼ä¸‹å¤åˆ¶ block yaw å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„å•è¯ yw å¤åˆ¶å…‰æ ‡æ‰€åœ¨ä½ç½®åˆ°å½“å‰å•è¯ç»“æŸ yy å¤åˆ¶å½“å‰è¡Œ nyy å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„è¿ç»­å‘ä¸‹nè¡Œ y^ å¤åˆ¶å½“å‰åˆ°è¡Œé¦– y$ å¤åˆ¶å½“å‰åˆ°è¡Œå°¾ yG å¤åˆ¶åˆ°æ–‡æ¡£ç»“å°¾ï¼ˆnyGï¼ŒynGï¼‰ï¼Ÿ ç²˜è´´ å‘½ä»¤ åŠŸèƒ½ p ç²˜è´´å…‰æ ‡å(æˆ–è€…å…‰æ ‡æ‰€åœ¨ä¸‹ä¸€è¡Œ) P ç²˜è´´åœ¨å…‰æ ‡å‰ï¼ˆæˆ–è€…å…‰æ ‡æ‰€åœ¨ä¸Šè¡Œï¼‰ ç¼–è¾‘ç±»æŒ‡ä»¤ å‘½ä»¤ åŠŸèƒ½ . é‡å¤å‰ä¸€ä¸ªåŠ¨ä½œ u æ’¤é”€å‰ä¸€ä¸ªåŠ¨ä½œ Undo Ctrl + r é‡åšå‰ä¸€ä¸ªåŠ¨ä½œ Redo æŸ¥æ‰¾ åœ¨normalæ¨¡å¼ä¸‹æŒ‰ä¸‹/å³å¯è¿›å…¥æŸ¥æ‰¾æ¨¡å¼ï¼Œè¾“å…¥è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²å¹¶æŒ‰ä¸‹å›è½¦ã€‚ Vimä¼šè·³è½¬åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ã€‚æŒ‰ä¸‹næŸ¥æ‰¾ä¸‹ä¸€ä¸ªï¼ŒæŒ‰ä¸‹NæŸ¥æ‰¾ä¸Šä¸€ä¸ªã€‚\nVimæŸ¥æ‰¾æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¾‹å¦‚/vim$åŒ¹é…è¡Œå°¾çš„\u0026quot;vim\u0026quot;ã€‚ éœ€è¦æŸ¥æ‰¾ç‰¹æ®Šå­—ç¬¦éœ€è¦è½¬ä¹‰ï¼Œä¾‹å¦‚/vim\\$åŒ¹é…\u0026quot;vim$\u0026quot;ã€‚\nå¤§å°å†™æ•æ„ŸæŸ¥æ‰¾\nåœ¨æŸ¥æ‰¾æ¨¡å¼ä¸­åŠ å…¥\\cè¡¨ç¤ºå¤§å°å†™ä¸æ•æ„ŸæŸ¥æ‰¾ï¼Œ\\Cè¡¨ç¤ºå¤§å°å†™æ•æ„ŸæŸ¥æ‰¾ã€‚ä¾‹å¦‚ï¼š\n1/foo\\c å°†ä¼šæŸ¥æ‰¾æ‰€æœ‰çš„\u0026quot;foo\u0026quot;,\u0026quot;FOO\u0026quot;,\u0026quot;Foo\u0026quot;ç­‰å­—ç¬¦ä¸²ã€‚\nå¤§å°å†™æ•æ„Ÿé…ç½®\nVim é»˜è®¤é‡‡ç”¨å¤§å°å†™æ•æ„Ÿçš„æŸ¥æ‰¾ï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å¸¸å¸¸å°†å…¶é…ç½®ä¸ºå¤§å°å†™ä¸æ•æ„Ÿï¼š\n1\u0026#34; è®¾ç½®é»˜è®¤è¿›è¡Œå¤§å°å†™ä¸æ•æ„ŸæŸ¥æ‰¾ 2set ignorecase 3\u0026#34; å¦‚æœæœ‰ä¸€ä¸ªå¤§å†™å­—æ¯ï¼Œåˆ™åˆ‡æ¢åˆ°å¤§å°å†™æ•æ„ŸæŸ¥æ‰¾ 4set smartcase å°†ä¸Šè¿°è®¾ç½®ç²˜è´´åˆ°ä½ çš„~/.vimrcï¼Œé‡æ–°æ‰“å¼€Vimå³å¯ç”Ÿæ•ˆ\næŸ¥æ‰¾å½“å‰å•è¯\nåœ¨normalæ¨¡å¼ä¸‹æŒ‰ä¸‹*å³å¯æŸ¥æ‰¾å…‰æ ‡æ‰€åœ¨å•è¯ï¼ˆwordï¼‰ï¼Œ è¦æ±‚æ¯æ¬¡å‡ºç°çš„å‰åä¸ºç©ºç™½å­—ç¬¦æˆ–æ ‡ç‚¹ç¬¦å·ã€‚ä¾‹å¦‚å½“å‰ä¸ºfooï¼Œ å¯ä»¥åŒ¹é…foo barä¸­çš„fooï¼Œä½†ä¸å¯åŒ¹é…foobarä¸­çš„fooã€‚ è¿™åœ¨æŸ¥æ‰¾å‡½æ•°åã€å˜é‡åæ—¶éå¸¸æœ‰ç”¨ã€‚\næŒ‰ä¸‹g*å³å¯æŸ¥æ‰¾å…‰æ ‡æ‰€åœ¨å•è¯çš„å­—ç¬¦åºåˆ—ï¼Œæ¯æ¬¡å‡ºç°å‰åå­—ç¬¦æ— è¦æ±‚ã€‚ å³foo barå’Œfoobarä¸­çš„fooå‡å¯è¢«åŒ¹é…åˆ°ã€‚\næŸ¥æ‰¾ä¸æ›¿æ¢ :sï¼ˆsubstituteï¼‰å‘½ä»¤ç”¨æ¥æŸ¥æ‰¾å’Œæ›¿æ¢å­—ç¬¦ä¸²ã€‚è¯­æ³•å¦‚ä¸‹ï¼š\n1:{ä½œç”¨èŒƒå›´}s/{ç›®æ ‡}/{æ›¿æ¢}/{æ›¿æ¢æ ‡å¿—} ä¾‹å¦‚:%s/foo/bar/gä¼šåœ¨å…¨å±€èŒƒå›´(%)æŸ¥æ‰¾fooå¹¶æ›¿æ¢ä¸ºbarï¼Œæ‰€æœ‰å‡ºç°éƒ½ä¼šè¢«æ›¿æ¢ï¼ˆgï¼‰\nä½œç”¨èŒƒå›´\nä½œç”¨èŒƒå›´åˆ†ä¸ºå½“å‰è¡Œã€å…¨æ–‡ã€é€‰åŒºç­‰ç­‰ã€‚\nå½“å‰è¡Œï¼š\n1:s/foo/bar/g å…¨æ–‡ï¼š\n1:%s/foo/bar/g é€‰åŒºï¼Œåœ¨Visualæ¨¡å¼ä¸‹é€‰æ‹©åŒºåŸŸåè¾“å…¥:ï¼ŒVimå³å¯è‡ªåŠ¨è¡¥å…¨ä¸º :'\u0026lt;,'\u0026gt;ã€‚\n1:\u0026#39;\u0026lt;,\u0026#39;\u0026gt;s/foo/bar/g 2-11è¡Œï¼š\n1:5,12s/foo/bar/g å½“å‰è¡Œ.ä¸æ¥ä¸‹æ¥ä¸¤è¡Œ+2ï¼š\n1:.,+2s/foo/bar/g æ›¿æ¢æ ‡å¿—\nä¸Šæ–‡ä¸­å‘½ä»¤ç»“å°¾çš„gå³æ˜¯æ›¿æ¢æ ‡å¿—ä¹‹ä¸€ï¼Œè¡¨ç¤ºå…¨å±€globalæ›¿æ¢ï¼ˆå³æ›¿æ¢ç›®æ ‡çš„æ‰€æœ‰å‡ºç°ï¼‰ã€‚ è¿˜æœ‰å¾ˆå¤šå…¶ä»–æœ‰ç”¨çš„æ›¿æ¢æ ‡å¿—ï¼š\nç©ºæ›¿æ¢æ ‡å¿—è¡¨ç¤ºåªæ›¿æ¢ä»å…‰æ ‡ä½ç½®å¼€å§‹ï¼Œç›®æ ‡çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼š\n1:%s/foo/bar iè¡¨ç¤ºå¤§å°å†™ä¸æ•æ„ŸæŸ¥æ‰¾ï¼ŒIè¡¨ç¤ºå¤§å°å†™æ•æ„Ÿï¼š\n1:%s/foo/bar/i 2# ç­‰æ•ˆäºæ¨¡å¼ä¸­çš„\\cï¼ˆä¸æ•æ„Ÿï¼‰æˆ–\\Cï¼ˆæ•æ„Ÿï¼‰ 3:%s/foo\\c/bar cè¡¨ç¤ºéœ€è¦ç¡®è®¤ï¼Œä¾‹å¦‚å…¨å±€æŸ¥æ‰¾\u0026quot;foo\u0026quot;æ›¿æ¢ä¸º\u0026quot;bar\u0026quot;å¹¶ä¸”éœ€è¦ç¡®è®¤ï¼š\n1:%s/foo/bar/gc å›è½¦åVimä¼šå°†å…‰æ ‡ç§»åŠ¨åˆ°æ¯ä¸€æ¬¡\u0026quot;foo\u0026quot;å‡ºç°çš„ä½ç½®ï¼Œå¹¶æç¤º\n1replace with bar (y/n/a/q/l/^E/^Y)? æŒ‰ä¸‹yè¡¨ç¤ºæ›¿æ¢ï¼Œnè¡¨ç¤ºä¸æ›¿æ¢ï¼Œaè¡¨ç¤ºæ›¿æ¢æ‰€æœ‰ï¼Œqè¡¨ç¤ºé€€å‡ºæŸ¥æ‰¾æ¨¡å¼ï¼Œ lè¡¨ç¤ºæ›¿æ¢å½“å‰ä½ç½®å¹¶é€€å‡ºã€‚^Eä¸^Yæ˜¯å…‰æ ‡ç§»åŠ¨å¿«æ·é”®\nç¿»é¡µ æ•´é¡µç¿»é¡µ ctrl-f ctrl-b få°±æ˜¯forword bå°±æ˜¯backward\nç¿»åŠé¡µ ctrl-d ctlr-u d=down u=up\næ»šä¸€è¡Œ ctrl-e ctrl-y\nzz è®©å…‰æ ‡æ‰€æ‚çš„è¡Œå±…å±å¹•ä¸­å¤® zt è®©å…‰æ ‡æ‰€æ‚çš„è¡Œå±…å±å¹•æœ€ä¸Šä¸€è¡Œ t=top zb è®©å…‰æ ‡æ‰€æ‚çš„è¡Œå±…å±å¹•æœ€ä¸‹ä¸€è¡Œ b=bottom\nå‚è€ƒé“¾æ¥\nhttps://www.cnblogs.com/huxinga/p/7942194.html\nhttps://harttle.land/2015/11/07/vim-cursor.html\n","date":"July 31, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/vim_tips/","summary":"å¸¸ç”¨é…ç½® vi ~/vimrc\n1set nu 2syntax on 3inoremap jj \u0026lt;ESC\u0026gt; # ues \u0026lt;jj\u0026gt; instead of \u0026lt;ESC\u0026gt; Vim ç›¸å…³é…ç½®ä»¥åŠå¿«æ·é”®è®¾ç½® .vimrc 1\u0026#34; Vim çš„é»˜è®¤å¯„å­˜å™¨å’Œç³»ç»Ÿå‰ªè´´æ¿å…±äº« 2set clipboard+=unnamed 3\u0026#34; selectæ¨¡å¼ä¸‹å¤åˆ¶ï¼Œæ–‡æœ¬é€‰ä¸­æ—¶ï¼ŒæŒ‰ä¸‹Ctrl+Cï¼Œå³å¯å¤åˆ¶ 4if has(\u0026#34;clipboard\u0026#34;) 5 vnoremap \u0026lt;C-C\u0026gt; \u0026#34;+y 6endif 7 8set nu 9 10syntax on 11inoremap jj \u0026lt;ESC\u0026gt; vimæ¨¡å¼ normal \u0026mdash;æŒ‰vè¿›å…¥\u0026mdash;\u0026gt; visual\nnormal \u0026ndash;\u0026gt; instert\ninsert\ncommand\nå¿«æ·é”® (normal) ç§»åŠ¨ å‘½ä»¤ åŠŸèƒ½ shift + 6 åˆ‡æ¢è¡Œé¦– shift + 4 åˆ‡æ¢åˆ°è¡Œå°¾ gg è·³è½¬åˆ°é¦–è¡Œè¡Œé¦– shift+g è·³è½¬åˆ°æœ«è¡Œè¡Œé¦– w ä¸‹ä¸€ä¸ªå•è¯ b ä¸Šä¸€ä¸ªå•è¯ e ç§»åŠ¨åˆ°è¯å°¾ åˆ é™¤ å‘½ä»¤ åŠŸèƒ½ x å‘ååˆ é™¤ä¸€ä¸ªå­—ç¬¦ X å‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦ nx è¿ç»­å‘ååˆ é™¤nä¸ªå­—ç¬¦ dd åˆ é™¤å½“å‰è¡Œ ndd åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„è¿ç»­å‘ä¸‹nè¡Œ d1G åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°ç¬¬ä¸€è¡Œæ‰€æœ‰çš„æ•°æ® dG åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°æœ€åä¸€è¡Œçš„æ‰€æœ‰æ•°æ® dw åˆ é™¤å…‰æ ‡ä¹‹åçš„å•è¯å‰©ä½™éƒ¨åˆ†ã€‚ d$ åˆ é™¤å…‰æ ‡ä¹‹åçš„è¯¥è¡Œå‰©ä½™éƒ¨åˆ†ã€‚ åˆ é™¤åŒ…å«ç‰¹å®šå­—ç¬¦çš„è¡Œ","tags":["Tips","Vim"],"title":"ã€ŒVimã€ Tips"},{"categories":null,"contents":"2020.06.21 ä¸Šæµ· - å…°å· æ—©ä¸Šä¸Šæµ·å‡ºå‘ï¼Œä¸‹åˆ16ç‚¹åˆ°è¾¾å…°å·ï¼Œç„¶ååˆ°ç¥å·ç§Ÿè½¦å–ä¸Šæˆ‘ä»¬çš„æˆ˜è½¦â€”â€”7åº§çš„ç§‘å¸•å¥‡ã€‚è™½ç„¶æ˜¯ä¸ƒåº§ï¼Œä½†æ˜¯æœ€åä¸€æ’çš„ç©ºé—´å°çš„å¯æ€œğŸ¤•ã€‚å…¶å®æœ¬æ¥æ˜¯æƒ³ç§Ÿä¸€ä¸ªéœ¸é“/è·¯è™ä¹‹ç±»çš„ï¼Œå¥ˆä½•ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¸€å—¨ç§Ÿè½¦ä¸è®©ç§Ÿé«˜ç«¯è½¦å‹ã€‚æˆ–è®¸å› ä¸ºæˆ‘ä»¬å‡ºæ¸¸çš„æ—¶é—´æ˜¯æ˜¯ä¸ªæ·¡å­£ï¼Œåˆæˆ–è®¸æ˜¯å› ä¸ºç–«æƒ…çš„å½±å“ï¼Œè¿™å‡ å¤©ç§Ÿè½¦ç‰¹åˆ«ä¾¿å®œã€‚ç§‘å¸•å¥‡åªæœ‰360å·¦å³æ¯å¤©ï¼ˆå«å…¨é™©ï¼‰ï¼Œç°åœ¨çœ‹äº†ä¸€çœ¼éƒ½600+æ¯å¤©äº†ã€‚åŒæœŸçš„éœ¸é“åªè¦600å·¦å³æ¯å¤©ï¼Œç°åœ¨1000+ï¼ˆæ²¡ç§Ÿä¸Šéœ¸é“æ„Ÿè§‰é”™è¿‡äº†ä¸€ä¸ªäº¿ï¼‰ã€‚\nå¼€ä¸Šæˆ˜è½¦ï¼Œå¯»äº†ä¸ªç¦»æœºåœºæœ€è¿‘çš„ç¾é£Ÿè¡—åƒä¸ªæ‹‰é¢ï¼Œå¿…é¡»æ˜¯åœ°é“çš„ç‰›è‚‰æ‹‰é¢ï¼Œä¾¿å¥”å‘æ›¹å®¶å ¡æœºåœºå»ä¸å°ä¼™ä¼´å›åˆã€‚200+ å…¬é‡Œä¼´éšç€æ™´é›¨è«æµ‹çš„å¤©æ°”å¼€äº†å¤§çº¦ä¸¤ä¸ªåŠå°æ—¶ã€‚\nå¤œå®¿è¥¿å®ï¼Œåƒè‚‰å»~\n2020.06.22 è¥¿å®-é’æµ·æ¹– é’æµ·æ¹–ï¼Œæœ€å¤§çš„ç›æ°´æ¹–ã€‚é—¨ç¥¨å¤ªè´µäº†ï¼Œæ²¡æœ‰è¿›æ™¯åŒºï¼Œå¥½åƒæ™¯åŒºå†…ä¹Ÿæ²¡å•¥å¯çœ‹çš„(æ»‘ç¨½)ã€‚åœ¨é™„è¿‘è½¬äº†è½¬ï¼Œé£æ™¯ä¹Ÿä¸é”™ï¼Œæ¹–è¾¹çš„æ¸¸å®¢ä¹Ÿå¾ˆå¤šï¼Œè¿˜å’Œç™½ç‰¦ç‰›æ‹äº†åˆç…§ã€‚\næœ‰ç‚¹é˜´å¤©ï¼Œäº‘ç‰¹åˆ«çš„ä½ï¼Œä½†ä¸åƒå—æ–¹çš„é˜´é›¨å¤©é‚£æ ·æ²‰é—·ã€‚ç©ºæ°”ä¸­å¤¹æ‚ç€å±±é¡¶èåŒ–çš„é›ªæ°´çš„æ°”æ¯ã€‚è‰åœ°ä¸Šç‚¹ç¼€ç€äº›è®¸çš„å°é»„èŠ±ã€‚\n2020.06.25 é—¨æº-è¾¾å‚å±± æ—¢å½“é‡‘å±±ä¹‹åç¬¬äºŒæ®µéš¾å¼€çš„å±±è·¯ï¼Œä¹æ›²åå…«å¼¯ã€‚\nè¾¾å‚å±±è§‚æ™¯å°ï¼Œæ”¶è´¹5å…ƒ/è½¦ã€‚å¯ä»¥å¬åœè½¦ä¼‘æ¯ä¸€ä¼šã€‚å±±é¡¶çš„é£ç”šæ˜¯å‡›å†½ã€‚\n","date":"July 28, 2020","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/graduated-travel/","summary":"2020.06.21 ä¸Šæµ· - å…°å· æ—©ä¸Šä¸Šæµ·å‡ºå‘ï¼Œä¸‹åˆ16ç‚¹åˆ°è¾¾å…°å·ï¼Œç„¶ååˆ°ç¥å·ç§Ÿè½¦å–ä¸Šæˆ‘ä»¬çš„æˆ˜è½¦â€”â€”7åº§çš„ç§‘å¸•å¥‡ã€‚è™½ç„¶æ˜¯ä¸ƒåº§ï¼Œä½†æ˜¯æœ€åä¸€æ’çš„ç©ºé—´å°çš„å¯æ€œğŸ¤•ã€‚å…¶å®æœ¬æ¥æ˜¯æƒ³ç§Ÿä¸€ä¸ªéœ¸é“/è·¯è™ä¹‹ç±»çš„ï¼Œå¥ˆä½•ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¸€å—¨ç§Ÿè½¦ä¸è®©ç§Ÿé«˜ç«¯è½¦å‹ã€‚æˆ–è®¸å› ä¸ºæˆ‘ä»¬å‡ºæ¸¸çš„æ—¶é—´æ˜¯æ˜¯ä¸ªæ·¡å­£ï¼Œåˆæˆ–è®¸æ˜¯å› ä¸ºç–«æƒ…çš„å½±å“ï¼Œè¿™å‡ å¤©ç§Ÿè½¦ç‰¹åˆ«ä¾¿å®œã€‚ç§‘å¸•å¥‡åªæœ‰360å·¦å³æ¯å¤©ï¼ˆå«å…¨é™©ï¼‰ï¼Œç°åœ¨çœ‹äº†ä¸€çœ¼éƒ½600+æ¯å¤©äº†ã€‚åŒæœŸçš„éœ¸é“åªè¦600å·¦å³æ¯å¤©ï¼Œç°åœ¨1000+ï¼ˆæ²¡ç§Ÿä¸Šéœ¸é“æ„Ÿè§‰é”™è¿‡äº†ä¸€ä¸ªäº¿ï¼‰ã€‚\nå¼€ä¸Šæˆ˜è½¦ï¼Œå¯»äº†ä¸ªç¦»æœºåœºæœ€è¿‘çš„ç¾é£Ÿè¡—åƒä¸ªæ‹‰é¢ï¼Œå¿…é¡»æ˜¯åœ°é“çš„ç‰›è‚‰æ‹‰é¢ï¼Œä¾¿å¥”å‘æ›¹å®¶å ¡æœºåœºå»ä¸å°ä¼™ä¼´å›åˆã€‚200+ å…¬é‡Œä¼´éšç€æ™´é›¨è«æµ‹çš„å¤©æ°”å¼€äº†å¤§çº¦ä¸¤ä¸ªåŠå°æ—¶ã€‚\nå¤œå®¿è¥¿å®ï¼Œåƒè‚‰å»~\n2020.06.22 è¥¿å®-é’æµ·æ¹– é’æµ·æ¹–ï¼Œæœ€å¤§çš„ç›æ°´æ¹–ã€‚é—¨ç¥¨å¤ªè´µäº†ï¼Œæ²¡æœ‰è¿›æ™¯åŒºï¼Œå¥½åƒæ™¯åŒºå†…ä¹Ÿæ²¡å•¥å¯çœ‹çš„(æ»‘ç¨½)ã€‚åœ¨é™„è¿‘è½¬äº†è½¬ï¼Œé£æ™¯ä¹Ÿä¸é”™ï¼Œæ¹–è¾¹çš„æ¸¸å®¢ä¹Ÿå¾ˆå¤šï¼Œè¿˜å’Œç™½ç‰¦ç‰›æ‹äº†åˆç…§ã€‚\næœ‰ç‚¹é˜´å¤©ï¼Œäº‘ç‰¹åˆ«çš„ä½ï¼Œä½†ä¸åƒå—æ–¹çš„é˜´é›¨å¤©é‚£æ ·æ²‰é—·ã€‚ç©ºæ°”ä¸­å¤¹æ‚ç€å±±é¡¶èåŒ–çš„é›ªæ°´çš„æ°”æ¯ã€‚è‰åœ°ä¸Šç‚¹ç¼€ç€äº›è®¸çš„å°é»„èŠ±ã€‚\n2020.06.25 é—¨æº-è¾¾å‚å±± æ—¢å½“é‡‘å±±ä¹‹åç¬¬äºŒæ®µéš¾å¼€çš„å±±è·¯ï¼Œä¹æ›²åå…«å¼¯ã€‚\nè¾¾å‚å±±è§‚æ™¯å°ï¼Œæ”¶è´¹5å…ƒ/è½¦ã€‚å¯ä»¥å¬åœè½¦ä¼‘æ¯ä¸€ä¼šã€‚å±±é¡¶çš„é£ç”šæ˜¯å‡›å†½ã€‚","tags":null,"title":"ã€Œæ¯•ä¸šæ—…è¡Œã€é’ç”˜è‡ªé©¾"},{"categories":null,"contents":"é‡è§ä½ æ˜¯æœ€ç¾å¥½çš„å¼€å§‹ æœªæ¥çš„æˆ‘ä»¬ä¼šè¿‡çš„æ›´å¥½ ä¸–é—´ç¾å¥½ ä¸ä½ æˆ‘ç¯ç¯ç›¸æ‰£ https://themify.me/themify-icons https://themes.gohugo.io/dot-hugo-documentation-theme/\n","date":"December 29, 2018","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/married/","summary":"é‡è§ä½ æ˜¯æœ€ç¾å¥½çš„å¼€å§‹ æœªæ¥çš„æˆ‘ä»¬ä¼šè¿‡çš„æ›´å¥½ ä¸–é—´ç¾å¥½ ä¸ä½ æˆ‘ç¯ç¯ç›¸æ‰£ https://themify.me/themify-icons https://themes.gohugo.io/dot-hugo-documentation-theme/","tags":null,"title":"ã€ŒLoveã€æˆ‘ä»¬ç»“å©šäº†"},{"categories":null,"contents":"CAPå®šå¾‹ CAP æŒ‰ç…§ç¾å›½è‘—åç§‘å­¦å®¶ Eric Brewer åœ¨ 2000 å¹´æå‡ºçš„ç†è®ºï¼Œå½“æŠ€æœ¯æ¶æ„ä»é›†ä¸­å¼æ¶æ„å‘åˆ†å¸ƒå¼æ¶æ„æ¼”è¿›ï¼Œä¼šé‡åˆ° â€œCAP å®šå¾‹â€çš„ç“¶é¢ˆã€‚ CAP è¯´æ˜ä¸€ä¸ªæ•°æ®å¤„ç†ç³»ç»Ÿä¸èƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªéœ€æ±‚ã€‚\nCAPæ°¸è¿œä¸å¯èƒ½åŒæ—¶æ»¡è¶³ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³ä¸¤ä¸ªï¼Œæé«˜å…¶ä¸­ä»»æ„ä¸¤è€…çš„åŒæ—¶ï¼Œå¿…ç„¶è¦ç‰ºç‰²ç¬¬ä¸‰è€…ã€‚ æ‰€ä»¥ï¼Œå¥½çš„ç³»ç»Ÿæ˜¯æ ¹æ®å…·ä½“åº”ç”¨ï¼Œæ¥å†³å®šå¦‚ä½•åœ¨ä¸‰è€…ä¹‹é—´è¿›è¡Œå–èˆã€‚\n####Consistency ä¸€è‡´æ€§â€”â€” è¯»æ“ä½œæ˜¯å¦æ€»èƒ½è¯»åˆ°å‰ä¸€ä¸ªå†™æ“ä½œçš„ç»“æœï¼Œå³æ˜¯è¯´åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå¤šç‚¹è¯»å‡ºçš„æ•°æ®å†…å®¹æ˜¯å¦ç›¸å®¹ã€‚ ####Partition Tolerance* åˆ†åŒºå®¹é”™æ€§â€”â€”æ•°æ®çš„åˆ†åŒºç‰¹æ€§ï¼Œå¯¹ç³»ç»Ÿæ€§èƒ½çš„å½±å“ç¨‹åº¦ ####Availiability å¯ç”¨æ€§â€”â€”è®¿é—®æ•°æ®çš„æ€§èƒ½\nhttps://www.cnblogs.com/frank2015/p/9554180.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/6.824/CAP%E5%AE%9A%E5%BE%8B/","summary":"CAPå®šå¾‹ CAP æŒ‰ç…§ç¾å›½è‘—åç§‘å­¦å®¶ Eric Brewer åœ¨ 2000 å¹´æå‡ºçš„ç†è®ºï¼Œå½“æŠ€æœ¯æ¶æ„ä»é›†ä¸­å¼æ¶æ„å‘åˆ†å¸ƒå¼æ¶æ„æ¼”è¿›ï¼Œä¼šé‡åˆ° â€œCAP å®šå¾‹â€çš„ç“¶é¢ˆã€‚ CAP è¯´æ˜ä¸€ä¸ªæ•°æ®å¤„ç†ç³»ç»Ÿä¸èƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªéœ€æ±‚ã€‚\nCAPæ°¸è¿œä¸å¯èƒ½åŒæ—¶æ»¡è¶³ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³ä¸¤ä¸ªï¼Œæé«˜å…¶ä¸­ä»»æ„ä¸¤è€…çš„åŒæ—¶ï¼Œå¿…ç„¶è¦ç‰ºç‰²ç¬¬ä¸‰è€…ã€‚ æ‰€ä»¥ï¼Œå¥½çš„ç³»ç»Ÿæ˜¯æ ¹æ®å…·ä½“åº”ç”¨ï¼Œæ¥å†³å®šå¦‚ä½•åœ¨ä¸‰è€…ä¹‹é—´è¿›è¡Œå–èˆã€‚\n####Consistency ä¸€è‡´æ€§â€”â€” è¯»æ“ä½œæ˜¯å¦æ€»èƒ½è¯»åˆ°å‰ä¸€ä¸ªå†™æ“ä½œçš„ç»“æœï¼Œå³æ˜¯è¯´åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå¤šç‚¹è¯»å‡ºçš„æ•°æ®å†…å®¹æ˜¯å¦ç›¸å®¹ã€‚ ####Partition Tolerance* åˆ†åŒºå®¹é”™æ€§â€”â€”æ•°æ®çš„åˆ†åŒºç‰¹æ€§ï¼Œå¯¹ç³»ç»Ÿæ€§èƒ½çš„å½±å“ç¨‹åº¦ ####Availiability å¯ç”¨æ€§â€”â€”è®¿é—®æ•°æ®çš„æ€§èƒ½\nhttps://www.cnblogs.com/frank2015/p/9554180.html","tags":null,"title":""},{"categories":null,"contents":"LXC Set proxy\n1sudo lxc config set core.proxy_https http://username:password@\u0026lt;IP\u0026gt;:\u0026lt;port\u0026gt;/ LXC\nhttps://www.linode.com/docs/guides/beginners-guide-to-lxd-reverse-proxy/\nhttps://www.digitalocean.com/community/tutorials/how-to-install-and-configure-lxd-on-ubuntu-20-04\nSDEWAN - direct connect Edge-1\n1# PREROUTTING 2sudo iptables -I PREROUTING -d 10.10.70.49/32 -p tcp -m tcp --dport 6443 -j DNAT --to-destination 10.96.0.1:443 -t nat Hub\n1# PREROUTTING 2 3sudo iptables -I PREROUTING --destination 10.95.62.68/32 -p esp -j DNAT --to-destination 10.233.108.10 -t nat 4sudo iptables -I PREROUTING --destination 10.95.62.68/32 -p udp --dport 4500 -j DNAT --to-destination 10.233.108.10:4500 -t nat 5sudo iptables -I PREROUTING --destination 10.95.62.68/32 -p udp --dport 500 -j DNAT --to-destination 10.233.108.10:500 -t nat 6 7 8 9 10 11sudo iptables -I PREROUTING --destination 10.95.62.119/32 -p esp -j DNAT --to-destination 10.233.65.140 -t nat 12sudo iptables -I PREROUTING --destination 10.95.62.119/32 -p udp --dport 4500 -j DNAT --to-destination 10.233.65.140:4500 -t nat 13sudo iptables -I PREROUTING --destination 10.95.62.119/32 -p ud --dport 500 -j DNAT --to-destination 10.233.65.140:500 -t nat 14 15sudo iptables -I PREROUTING --destination 10.95.62.119/32 -p tcp --dport 4500 -j DNAT --to-destination 10.233.65.140:4500 -t nat 16sudo iptables -I PREROUTING --destination 10.95.62.119/32 -p tcp --dport 500 -j DNAT --to-destination 10.233.65.140:500 -t nat 17 18 19 20 21sudo iptables -D POSTROUTING -d 10.154.142.12/32 -j SNAT --to-source 10.154.142.7 -t nat 22 23sudo iptables -I POSTROUTING -d 192.168.0.8/32 -j SNAT --to-source 10.20.0.118 -t nat 24 25sudo iptables -I POSTROUTING -d 10.20.0.118/32 -j SNAT --to-source 192.169.0.4 -t nat 26 27 28192.169.0.4/32 === 10.20.0.118/32 remove mark of the client\n1# modify config new nodus with sdewan -\u0026gt; test failed -\u0026gt; test host direct mode 4 1 2conn localtodevice1-Conndevice1 3 left=192.168.0.1 4 right=%any 5 leftsubnet=192.168.0.1/32 6 rightsourceip=192.168.0.5 7 rightsubnet=192.168.0.5/32 8 ikelifetime=3h 9 lifetime=1h 10 margintime=9m 11 keyingtries=%forever 12 dpdaction=restart 13 dpddelay=30s 14 leftauth=pubkey 15 rightauth=pubkey 16 leftcert=/etc/ipsec.d/certs/localtodevice1_public.pem 17 leftsendcert=yes 18 rightsendcert=yes 19 auto=start 20 leftid=\u0026#34;CN=sdewan-controller-base\u0026#34; 21 rightid=\u0026#34;CN=device-device-1-cert\u0026#34; 22 leftupdown=/etc/updown 23 keyexchange=ikev2 24 mark=30 25 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 26 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 27 type=tunnel 1conn localtodevice1-Conndevice1 2 left=%any 3 right=10.95.62.217 4 rightsubnet=192.168.0.1/32 5 # rightsubnet=10.233.108.12/32 6 leftsourceip=%config 7 ikelifetime=3h 8 lifetime=1h 9 margintime=9m 10 keyingtries=%forever 11 dpdaction=restart 12 dpddelay=30s 13 leftauth=pubkey 14 rightauth=pubkey 15 leftcert=/etc/ipsec.d/certs/localtodevice1_public.pem 16 leftsendcert=yes 17 rightsendcert=yes 18 auto=start 19 leftid=\u0026#34;CN=device-device-1-cert\u0026#34; 20 rightid=\u0026#34;CN=sdewan-controller-base\u0026#34; 21 leftupdown=/usr/lib/ipsec/_updown iptables 22 keyexchange=ikev2 23 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 24 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 25 type=tunnel ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/multipass_network/","summary":"LXC Set proxy\n1sudo lxc config set core.proxy_https http://username:password@\u0026lt;IP\u0026gt;:\u0026lt;port\u0026gt;/ LXC\nhttps://www.linode.com/docs/guides/beginners-guide-to-lxd-reverse-proxy/\nhttps://www.digitalocean.com/community/tutorials/how-to-install-and-configure-lxd-on-ubuntu-20-04\nSDEWAN - direct connect Edge-1\n1# PREROUTTING 2sudo iptables -I PREROUTING -d 10.10.70.49/32 -p tcp -m tcp --dport 6443 -j DNAT --to-destination 10.96.0.1:443 -t nat Hub\n1# PREROUTTING 2 3sudo iptables -I PREROUTING --destination 10.95.62.68/32 -p esp -j DNAT --to-destination 10.233.108.10 -t nat 4sudo iptables -I PREROUTING --destination 10.95.62.68/32 -p udp --dport 4500 -j DNAT --to-destination 10.233.108.10:4500 -t nat 5sudo iptables -I PREROUTING --destination 10.","tags":null,"title":""},{"categories":null,"contents":"Service Mesh æµ…æ\nIstioçš„è‡ªæˆ‘æ•‘èµ\nhttps://github.com/cloudnativebooks/cloud-native-istio/tree/master/chapter-files/security\näº‘åŸç”Ÿæ¶æ„çš„ä¸‰é©¾é©¬è½¦\nKubenetesï¼Œ Service Mesh , Serverless\nServcie Mesh è¶…æ—¶é‡è¯•\n16å¹´æ¦‚å¿µæå‡ºã€‚\næŠ€æœ¯é€‰å‹ï¼Ÿ\nServiceMesh çš„ç›¸å…³æ¦‚å¿µ\nService Meshçš„èµ·æº\nå¾®æœåŠ¡æ¶æ„çš„ç‰¹æ€§\nå›´ç»•ä¸šåŠ¡æ„å»ºå›¢é˜Ÿ åº·å¨å®šå¾‹-\u0026gt; å›¢é˜Ÿç»“æ„å†³å®šäº†äº§å“ç»“æ„\nå»ä¸­å¿ƒåŒ–çš„æ•°æ®ç®¡ç†\nå›¢é˜Ÿå±‚é¢ï¼š å†…èšï¼Œç‹¬ç«‹ä¸šåŠ¡å¼€å‘ï¼Œæ²¡æœ‰ä¾èµ–\näº§å“å±‚é¢ï¼š æœåŠ¡å½¼æ­¤ç‹¬ç«‹ï¼Œç‹¬ç«‹éƒ¨ç½²ï¼Œæ²¡æœ‰ä¾èµ–\nè®¿é—®é‡å†³å®šéƒ¨ç½²å®ä¾‹çš„æ•°é‡\né“¶å¼¹ç†è®º-\u0026gt; äººæœˆç¥è¯ æ²¡æœ‰ä»»ä½•ä¸€ç§æŠ€æœ¯å¯ä»¥å®Œç¾çš„è§£å†³è½¯ä»¶å¼€å‘ä¸­çš„é—®é¢˜ã€‚\nç©ºé—´æ¢æ—¶é—´ or æ—¶é—´æ¢ç©ºé—´\nå¾®æœåŠ¡æ¶æ„å¸¦æ¥çš„ç¼ºç‚¹\næœåŠ¡é—´ç½‘ç»œé€šä¿¡é—®é¢˜\nåˆ†å¸ƒå¼è®¡ç®—çš„8ä¸ªè°¬è®º\nç½‘ç»œæ˜¯å¯é çš„ ç½‘ç»œå»¶æ—¶æ˜¯0 å¾ˆéš¾ä¼šæŠŠç½‘ç»œç›¸å…³çš„éœ€æ±‚è€ƒè™‘åˆ°æˆ‘ä»¬çš„è®¾è®¡ä¸­ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç½‘ç»œé—®é¢˜æ˜¯ä¸€ä¸ªé‡è¦é—®é¢˜ã€‚\nå¦‚ä½•ç®¡ç†å’Œæ§åˆ¶ç½‘ç»œé€šä¿¡\nè¾…åŠ©æ³¨å†Œã€å‘ç°\nè·¯ç”±ï¼Œæµé‡è½¬ç§»\nå¼¹æ€§èƒ½åŠ› ç†”æ–­è¶…æ—¶é‡è¯•\nå®‰å…¨\nå¯è§‚æµ‹æ€§\nPattenï¼š Service Mesh\né˜¶æ®µä¸€ï¼š æ§åˆ¶é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘è€¦åˆ\né˜¶æ®µäºŒï¼š å…¬å…±åº“ï¼šæµæ§ï¼Œé‡è¯• ï¼ˆäººåŠ›ï¼Œæ—¶é—´å­¦ä¹ ï¼Œè¯­è¨€èšŒç»‘å®šï¼Œå¹³å°ç›¸å…³ï¼Œä»£ç ä¾µå…¥ï¼‰\né˜¶æ®µä¸‰ï¼šä»£ç†æ¨¡å¼ï¼Œ åŠŸèƒ½ç®€é™‹Nginx\né˜¶æ®µå››ï¼š Sidecar æ¨¡å¼ 2013-2105\né˜¶æ®µäº”ï¼š Service Mesh 2016-2017\nâ€‹ Service MeshV2 2018\nã€ŠWhat\u0026rsquo;s service mesh? And why do I need one?ã€‹\nData plane\nService Meshäº§ç”Ÿçš„åŸå› \nService Meshçš„æ ¸å¿ƒåŠŸèƒ½\nIstio\næµé‡æ§åˆ¶ è·¯ç”±ï¼Œç†”æ–­ï¼Œè¶…æ—¶é‡è¯•\nå®‰å…¨\nå¯è§‚æµ‹æ€§\nService Mesh çš„ä¸»è¦åŠŸèƒ½\næµé‡æ§åˆ¶ï¼š è·¯ç”±ï¼Œ æµé‡è½¬ç§»ï¼Œè¶…æ—¶é‡è¯•ï¼Œç†”æ–­ï¼Œ æ•…éšœæ³¨å…¥ï¼Œ æµé‡é•œåƒ\nç­–ç•¥ï¼š æµé‡é™åˆ¶ï¼Œ é»‘ç™½åå•\nç½‘ç»œå®‰å…¨ï¼šæˆæƒä»¥åŠèº«ä»½è®¤è¯\nå¯è§‚æµ‹æ€§ï¼š æŒ‡æ ‡æ‰‹æœºå’Œå±•ç¤ºï¼Œæ—¥å¿—æ”¶é›†ï¼Œ åˆ†å¸ƒå¼è¿½è¸ª\nKubernetesï¼š\nè§£å†³å®¹å™¨ç¼–æ’ä¸è°ƒåº¦é—®é¢˜ï¼Œ æœ¬è´¨ä¸Šæ˜¯ç®¡ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸï¼Œ è°ƒåº¦å™¨\nIngress ï¼Ÿk\nServcie Mesh:\nè§£å†³æœåŠ¡ç½‘ç»œé€šä¿¡é—®é¢˜ï¼Œæœ¬è´¨ä¸Šæ˜¯ç®¡ç†æœåŠ¡é€šä¿¡(ä»£ç†)\næ ‡å‡†\nUDPAï¼ˆUniversal Data Plane APIï¼‰ ç»Ÿä¸€çš„æ•°æ®å¹³é¢API\nenvoy\nCloud Native Computing Foundation\nåº”ç”¨å±‚-\u0026gt; SMI-\u0026gt; æ§åˆ¶å¹³é¢ -\u0026gt; UDPA-\u0026gt; æ•°æ®å¹³é¢\nSMI(Service Mesh Interface)\nenvoy xDS åè®®\nAWSï¼š app mesh\nIstio å…¥é—¨ Istio æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„æœåŠ¡ç½‘æ ¼ï¼Œ ä½œä¸ºé€æ˜çš„ä¸€æ€\næœåŠ¡ç½‘æ ¼äº§å“\nIstio å¸Œè…Šè¯­ï¼Œæ¨å¸†èµ·èˆª\nkubernetes å¸Œè…Šè¯­ï¼Œèˆµæ‰‹\næ•°æ®å¹³é¢ï¼Œæ§åˆ¶å¹³é¢\nlyft ï¼Ÿ\nè½»æ¾æ„å»ºæœåŠ¡ç½‘æ ¼ï¼Œ\nç°åº¦å‘å¸ƒ\nè“ç»¿éƒ¨ç½²\nABæµ‹è¯•\næµé‡ å®‰å…¨ ç­–ç•¥ å¯è§‚æµ‹æ€§\nMixer åºŸå¼ƒï¼Œè½¬ç§»åˆ°envoyä¸­\nGoogle ï¼š Istio, gRPCï¼ŒKubernetes\næ€§èƒ½é—®é¢˜åŠ é‡\næ˜“ç”¨æ€§\nè§£è€¦ è¦è®©æ­¥äº å–èˆ\nMVPç†è®º ã€Š ç²¾ç›Šåˆ›ä¸šã€‹\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Istio/1-Istio/","summary":"Service Mesh æµ…æ\nIstioçš„è‡ªæˆ‘æ•‘èµ\nhttps://github.com/cloudnativebooks/cloud-native-istio/tree/master/chapter-files/security\näº‘åŸç”Ÿæ¶æ„çš„ä¸‰é©¾é©¬è½¦\nKubenetesï¼Œ Service Mesh , Serverless\nServcie Mesh è¶…æ—¶é‡è¯•\n16å¹´æ¦‚å¿µæå‡ºã€‚\næŠ€æœ¯é€‰å‹ï¼Ÿ\nServiceMesh çš„ç›¸å…³æ¦‚å¿µ\nService Meshçš„èµ·æº\nå¾®æœåŠ¡æ¶æ„çš„ç‰¹æ€§\nå›´ç»•ä¸šåŠ¡æ„å»ºå›¢é˜Ÿ åº·å¨å®šå¾‹-\u0026gt; å›¢é˜Ÿç»“æ„å†³å®šäº†äº§å“ç»“æ„\nå»ä¸­å¿ƒåŒ–çš„æ•°æ®ç®¡ç†\nå›¢é˜Ÿå±‚é¢ï¼š å†…èšï¼Œç‹¬ç«‹ä¸šåŠ¡å¼€å‘ï¼Œæ²¡æœ‰ä¾èµ–\näº§å“å±‚é¢ï¼š æœåŠ¡å½¼æ­¤ç‹¬ç«‹ï¼Œç‹¬ç«‹éƒ¨ç½²ï¼Œæ²¡æœ‰ä¾èµ–\nè®¿é—®é‡å†³å®šéƒ¨ç½²å®ä¾‹çš„æ•°é‡\né“¶å¼¹ç†è®º-\u0026gt; äººæœˆç¥è¯ æ²¡æœ‰ä»»ä½•ä¸€ç§æŠ€æœ¯å¯ä»¥å®Œç¾çš„è§£å†³è½¯ä»¶å¼€å‘ä¸­çš„é—®é¢˜ã€‚\nç©ºé—´æ¢æ—¶é—´ or æ—¶é—´æ¢ç©ºé—´\nå¾®æœåŠ¡æ¶æ„å¸¦æ¥çš„ç¼ºç‚¹\næœåŠ¡é—´ç½‘ç»œé€šä¿¡é—®é¢˜\nåˆ†å¸ƒå¼è®¡ç®—çš„8ä¸ªè°¬è®º\nç½‘ç»œæ˜¯å¯é çš„ ç½‘ç»œå»¶æ—¶æ˜¯0 å¾ˆéš¾ä¼šæŠŠç½‘ç»œç›¸å…³çš„éœ€æ±‚è€ƒè™‘åˆ°æˆ‘ä»¬çš„è®¾è®¡ä¸­ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç½‘ç»œé—®é¢˜æ˜¯ä¸€ä¸ªé‡è¦é—®é¢˜ã€‚\nå¦‚ä½•ç®¡ç†å’Œæ§åˆ¶ç½‘ç»œé€šä¿¡\nè¾…åŠ©æ³¨å†Œã€å‘ç°\nè·¯ç”±ï¼Œæµé‡è½¬ç§»\nå¼¹æ€§èƒ½åŠ› ç†”æ–­è¶…æ—¶é‡è¯•\nå®‰å…¨\nå¯è§‚æµ‹æ€§\nPattenï¼š Service Mesh\né˜¶æ®µä¸€ï¼š æ§åˆ¶é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘è€¦åˆ\né˜¶æ®µäºŒï¼š å…¬å…±åº“ï¼šæµæ§ï¼Œé‡è¯• ï¼ˆäººåŠ›ï¼Œæ—¶é—´å­¦ä¹ ï¼Œè¯­è¨€èšŒç»‘å®šï¼Œå¹³å°ç›¸å…³ï¼Œä»£ç ä¾µå…¥ï¼‰\né˜¶æ®µä¸‰ï¼šä»£ç†æ¨¡å¼ï¼Œ åŠŸèƒ½ç®€é™‹Nginx\né˜¶æ®µå››ï¼š Sidecar æ¨¡å¼ 2013-2105\né˜¶æ®µäº”ï¼š Service Mesh 2016-2017\nâ€‹ Service MeshV2 2018","tags":null,"title":""},{"categories":null,"contents":"What is Service Mesh(æœåŠ¡ç½‘æ ¼) https://jimmysong.io/blog/why-do-you-need-istio-when-you-already-have-kubernetes/\nUPF\n2 æ¬¡é“¾æ¥\n1 æ§åˆ¶é¢ ip register step 1-4\nhub å…¬æœ‰ç½‘ç»œç›´è¿æ¥ï¼Œ ç»™edge podåˆ†é…å…¨å±€IPï¼Œcluster api server CRD controller ç›‘è§†CRs \u0026ndash;\u0026gt; kube cofig\n2 æ•°æ®é¢\nhub-device connection\nhub æ¡¥æ¥\nIPSec configuration -\u0026gt; 2 æ¬¡åˆ†å‘\nSNAT-\u0026gt; DNAT IP åœ°å€å¯èƒ½é‡åˆ\næµ‹è¯•ç¯å¢ƒéƒ¨ç½² 4 cluster\nç‰©ç†æœº 4 nuc\n10.239.241.255 \u0026ndash; hub\nswitch äº¤æ¢æœº\nkubectl get iphost\nkubectl describe iphost hubdevice1\nkubectl get\nspce:\npubkry\nconn_type\nproposal åŠ è§£å¯†\nmark route base VPN\nmode: start\nremote_sourceIP: è™šæ‹ŸIP\nç§é’¥ã€‚å…¬é’¥ï¼ŒCA\nremoteï¼š %any æ¥å—æ‰€æœ‰å¤–éƒ¨é“¾æ¥\ntype: VTI-based\nIPsec -\u0026gt; Interface + policy\nkubectl describe\ncnf pod : openwrt å¤§éƒ¨åˆ†ç½‘ç»œ default pod\nSNET\nIPsec tunnel -ã€‹ ç‚¹å¯¹ç‚¹ï¼Œ å®é™…ä¸Šåº”è¯¥æ˜¯ç‚¹å¯¹ åŸŸå\nè·¯ç”± hub è·¯ç”±æ­£å¸¸çš„main table\nIP routerã€rule ã€table\nè‡ªå·±é…ç½®ä¸€ä¸ªè¡¨å·ï¼Œ æŸäº›æƒ…æ™¯ä¸‹ä½¿ç”¨IP ruleã€‚\næ‰€æœ‰çš„CR ç±»å‹ï¼ŒIPsecï¼Œfirewallï¼Œ\ntcpdump\nscc -ã€‹ overlay controller\nsdewan- system or default\nrsync -\u0026gt; deploy resource\nscc -\u0026gt; use rsync to deploy the CRs , æ‰€æœ‰çš„call logï¼Œ204ï¼Œok\nmongo å­˜å‚¨æ³¨å†Œå†…å®¹ï¼Œ\ntest-scc\nIPtables\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/k8s-Istio-Envoy/","summary":"What is Service Mesh(æœåŠ¡ç½‘æ ¼) https://jimmysong.io/blog/why-do-you-need-istio-when-you-already-have-kubernetes/\nUPF\n2 æ¬¡é“¾æ¥\n1 æ§åˆ¶é¢ ip register step 1-4\nhub å…¬æœ‰ç½‘ç»œç›´è¿æ¥ï¼Œ ç»™edge podåˆ†é…å…¨å±€IPï¼Œcluster api server CRD controller ç›‘è§†CRs \u0026ndash;\u0026gt; kube cofig\n2 æ•°æ®é¢\nhub-device connection\nhub æ¡¥æ¥\nIPSec configuration -\u0026gt; 2 æ¬¡åˆ†å‘\nSNAT-\u0026gt; DNAT IP åœ°å€å¯èƒ½é‡åˆ\næµ‹è¯•ç¯å¢ƒéƒ¨ç½² 4 cluster\nç‰©ç†æœº 4 nuc\n10.239.241.255 \u0026ndash; hub\nswitch äº¤æ¢æœº\nkubectl get iphost\nkubectl describe iphost hubdevice1\nkubectl get\nspce:\npubkry\nconn_type\nproposal åŠ è§£å¯†\nmark route base VPN","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/curl/","summary":"","tags":null,"title":""},{"categories":null,"contents":"TCP çš„æœ‰é™çŠ¶æ€æœº\nCLOSED CLOSED\nSYN_SENT LISTENING\nâ€‹ SYN_RECEIVED\nESTABLISHED ESTABLISHED\nnetfilter: Frame\niptables: æ•°æ®æŠ¥æ–‡è¿‡æ»¤\né˜²ç«å¢™ï¼š ç¡¬ä»¶/è½¯ä»¶\nè§„åˆ™ï¼š åŒ¹é…æ ‡å‡†å’Œå¤„ç†åŠæ³•\né»˜è®¤è§„åˆ™ï¼š\nâ€‹ å…³é—­\nåŒ¹é…æ ‡å‡†ï¼š\nIP:æºIPï¼Œ ç›®æ ‡IP\nTCP: SPORT, DPORT SYN=1,FIN=0,RST=0,ACK=0\nUDP:SPORT, DPORT\nICMP: icmp-type\nè§„åˆ™åœ¨å†…æ ¸ç©ºé—´\nå†…æ ¸ç©ºé—´çš„TCPIPçš„åè®®æ ˆä¸Šï¼Œå¼€æ”¾ç»™ç”¨æˆ·ç©ºé—´ä¸­çš„iptables APIã€‚\nå†…æ ¸ç©ºé—´çš„å·¥ä½œæ¡†æ¶ï¼š\nç”¨æˆ·ç©ºé—´çš„ç®¡ç†å·¥å…·ï¼š system call\nå‚è€ƒ openBSD\nLinux 2.0ï¼šipfw/firewall\nLinux 2.2ï¼š ipchain/firewall Linux 2.4 ï¼š iptables/netfilter\n1ï¼š07\n1/proc/sys/net/ipv4/ip_forward è·¯ç”±å†³ç­–å‘ç”Ÿåœ¨æ•°æ®åŒ…åˆ°è¾¾ç½‘å¡ï¼Œ é€åˆ°TCPIPåè®®æ ˆä¸Šçš„é‚£ä¸€åˆ»ã€‚ ç„¶åå…ˆå‘ç”Ÿè·¯ç”±å†³ç­–\nnetfilter è¡¥å……åœ¨tcp ipåè®®ä¸Šçš„3ä¸ªhook functionã€‚\nå¤šä¸ªè§„åˆ™ï¼Œè‡ªä¸Šè€Œä¸‹ï¼Œé€ä¸ªæ£€æŸ¥ï¼Œ\nä¸åšæ‹’ç»æˆ–è€…æ”¾è¡Œç­–ç•¥\n4ï¼š åˆšåˆšè¿›å…¥æœ¬æœºç½‘å¡ï¼Œè¿˜æ²¡æœ‰åˆ°è¾¾è·¯ç”±è¡¨ã€‚ï¼ˆåœ°å€è½¬æ¢k\u0026rsquo;kï¼‰\n5ï¼š å³å°†ç¦»å¼€æœ¬æœºçš„æ—¶å€™ï¼Œè·¯ç”±å†³ç­–åšå‡ºä¹‹åã€‚\nè§„åˆ™é“¾\nPREROUTING\nINPUT\nFORWARD\nOUTPUT\nPOSTROUTING\nfilterï¼šè¿‡æ»¤ è¡¨\nINPUT/ OUTPUT/ FORWARD\nnat: åœ°å€è½¬æ¢ è¡¨\nPREROUTING/ POSTROUTING/OUTPUT\nredirect : æœ¬æœºé‡å®šå‘\nmangle ä¿®æ”¹æŠ¥æ–‡é¦–éƒ¨ æ‹†å¼€ä¿®æ”¹ï¼Œå°è£…\nPREROUTING\nINPUT\nFORWARD\nOUTPUT\nPOSTROUTING\nraw åŸå§‹æ ¼å¼\nPREROUTING/OUTPUT\nchainçš„ä¼˜å…ˆæ¬¡åº\n4è¡¨5é“¾k\n500æ¡è§„åˆ™\nè‡ªå®šä¹‰é“¾åªèƒ½è¢«é»˜è®¤é“¾è°ƒç”¨æ‰å¯ä»¥ç”Ÿæ•ˆï¼ˆreturn), å¦‚æœæ²¡æœ‰åˆ«ä»»ä½•ä¸€æ¡é˜Ÿåˆ™åŒ¹é…åˆ°åº”è¯¥æœ‰è¿”å›æœºåˆ¶ã€‚\nä¸èƒ½åˆ é™¤éç©ºé“¾ã€‚ ç”¨æˆ·å¯ä»¥åˆ é™¤è‡ªå®šä¹‰çš„ç©ºé“¾ï¼Œé»˜è®¤é“¾ä¸èƒ½è¢«åˆ é™¤ã€‚\næ¯ä¸€æ¡è§„åˆ™éƒ½æœ‰ä¸¤ä¸ªå†…ç½®çš„è®¡æ•°å™¨ï¼Œ\nä¸€ä¸ªç”¨æ¥è®°å½•è¢«åŒ¹é…åˆ°çš„æŠ¥æ–‡ä¸ªæ•°\nè¢«åŒ¹é…çš„æŠ¥æ–‡å¤§å°ä¹‹å’Œã€‚\nåŒ¹é…æ ‡å‡†å’Œå¤„ç†åŠ¨ä½œ\næ ‡å‡†ï¼š\n1iptables [-t TABLE] COMMAND CHAIN [num] åŒ¹é…æ ‡å‡† -j å¤„ç†åŠæ³• é€šç”¨åŒ¹é…\n1-s, --src æºIP 2-d, --dst , ç›®æ ‡åœ°å€ 3-p {tcp |udp | icmp} 4-i Interface, æŒ‡å®šæ•°æ®æŠ¥æ–‡æµå…¥æ¥å£ preroutingï¼Œinputï¼Œforward 5-o interfaceï¼Œ æŒ‡å®šæ•°æ®æŠ¥æ–‡æµå‡ºçš„æ¥å£ output, postrouting, forward 6 7 8-j jump 9ACCEPT 10DROP 11REJECT 12 13è¿æ¥çŠ¶æ€ æ‰©å±•åŒ¹é…ï¼š ä¾èµ–æ‰©å±•åŠŸèƒ½/user/lib/iptables\néšå«æ‰©å±•ï¼Œä¸ç”¨ç‰¹åˆ«æŒ‡æ˜ç”±å“ªä¸€ä¸ªæ¨¡å—è¿›è¡Œæ‰©å±•ï¼Œå› ä¸ºæ­¤æ—¶ä½¿ç”¨-p{tcp | udp |icmp}\næ˜¾ç¤ºæ‰©å±•ï¼Œå¿…é¡»æŒ‡æ˜ç”±å“ªä¸€ä¸ªæ¨¡å—è¿›è¡Œæ‰©å±•ï¼Œ ä½¿ç”¨-må®Œæˆæ­¤åŠŸèƒ½ï¼Œ\nç½‘ç»œè®¿é—®æ§åˆ¶\nDDOS\nnetfilterï¼Œ\nåœ¨ç”¨æˆ·å±‚é€šè¿‡iptables å¯¹netfilterè¿›è¡Œæ§åˆ¶ç®¡ç†ã€‚\nRedirect æ˜¯é’ˆå¯¹æœ¬æœºçš„ï¼Œ æœ¬æœºäº§ç”Ÿçš„æ•°æ®åŒ…è½¬åˆ° localhostçš„æŸä¸ªç«¯å£ï¼Œ é€‚åˆç”¨redirectï¼Œä¼šæ¯”DNATæ•ˆç‡é«˜ä¸€ç‚¹ï¼Œè€Œå¤–éƒ¨åœ°å€åªèƒ½ç”¨DNATäº†ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/iptables/","summary":"TCP çš„æœ‰é™çŠ¶æ€æœº\nCLOSED CLOSED\nSYN_SENT LISTENING\nâ€‹ SYN_RECEIVED\nESTABLISHED ESTABLISHED\nnetfilter: Frame\niptables: æ•°æ®æŠ¥æ–‡è¿‡æ»¤\né˜²ç«å¢™ï¼š ç¡¬ä»¶/è½¯ä»¶\nè§„åˆ™ï¼š åŒ¹é…æ ‡å‡†å’Œå¤„ç†åŠæ³•\né»˜è®¤è§„åˆ™ï¼š\nâ€‹ å…³é—­\nåŒ¹é…æ ‡å‡†ï¼š\nIP:æºIPï¼Œ ç›®æ ‡IP\nTCP: SPORT, DPORT SYN=1,FIN=0,RST=0,ACK=0\nUDP:SPORT, DPORT\nICMP: icmp-type\nè§„åˆ™åœ¨å†…æ ¸ç©ºé—´\nå†…æ ¸ç©ºé—´çš„TCPIPçš„åè®®æ ˆä¸Šï¼Œå¼€æ”¾ç»™ç”¨æˆ·ç©ºé—´ä¸­çš„iptables APIã€‚\nå†…æ ¸ç©ºé—´çš„å·¥ä½œæ¡†æ¶ï¼š\nç”¨æˆ·ç©ºé—´çš„ç®¡ç†å·¥å…·ï¼š system call\nå‚è€ƒ openBSD\nLinux 2.0ï¼šipfw/firewall\nLinux 2.2ï¼š ipchain/firewall Linux 2.4 ï¼š iptables/netfilter\n1ï¼š07\n1/proc/sys/net/ipv4/ip_forward è·¯ç”±å†³ç­–å‘ç”Ÿåœ¨æ•°æ®åŒ…åˆ°è¾¾ç½‘å¡ï¼Œ é€åˆ°TCPIPåè®®æ ˆä¸Šçš„é‚£ä¸€åˆ»ã€‚ ç„¶åå…ˆå‘ç”Ÿè·¯ç”±å†³ç­–\nnetfilter è¡¥å……åœ¨tcp ipåè®®ä¸Šçš„3ä¸ªhook functionã€‚\nå¤šä¸ªè§„åˆ™ï¼Œè‡ªä¸Šè€Œä¸‹ï¼Œé€ä¸ªæ£€æŸ¥ï¼Œ\nä¸åšæ‹’ç»æˆ–è€…æ”¾è¡Œç­–ç•¥\n4ï¼š åˆšåˆšè¿›å…¥æœ¬æœºç½‘å¡ï¼Œè¿˜æ²¡æœ‰åˆ°è¾¾è·¯ç”±è¡¨ã€‚ï¼ˆåœ°å€è½¬æ¢k\u0026rsquo;kï¼‰\n5ï¼š å³å°†ç¦»å¼€æœ¬æœºçš„æ—¶å€™ï¼Œè·¯ç”±å†³ç­–åšå‡ºä¹‹åã€‚\nè§„åˆ™é“¾\nPREROUTING\nINPUT\nFORWARD\nOUTPUT","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/jq/","summary":"","tags":null,"title":""},{"categories":null,"contents":"æŸ¥çœ‹ç«¯å£çš„å ç”¨æƒ…å†µ\n1netstat -atunlp 2 3# ç”¨æ¥æŸ¥çœ‹ç³»ç»Ÿå½“å‰ç½‘ç»œçŠ¶æ€ä¿¡æ¯ï¼Œ åŒ…æ‹¬ç«¯å£ã€è¿æ¥æƒ…å†µç­‰ 4# -t: TCPç«¯å£ 5# -u: UDPç«¯å£ 6# -l: ä»…æ˜¾ç¤ºç›‘å¬Socket LISTENçŠ¶æ€çš„Socket 7# -p: æ˜¾ç¤ºè¿›ç¨‹æ ‡è¯†ç¬¦å’Œç¨‹åºåç§°ï¼Œæ¯ä¸€ä¸ªsocketéƒ½å±äºä¸€ä¸ªç¨‹åº 8# -n: ä¸è¿›è¡ŒDNSè§£æ 9# -a: æ˜¾ç¤ºæ‰€æœ‰è¿æ¥çš„ç«¯å£ 10 11 12 13 14lsof 15# åˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶(list open files) 16# -i:[num] æŒ‡å®šç«¯å£ 1nslookup # åŸŸåè§£æ 2host 3dig ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/port/","summary":"æŸ¥çœ‹ç«¯å£çš„å ç”¨æƒ…å†µ\n1netstat -atunlp 2 3# ç”¨æ¥æŸ¥çœ‹ç³»ç»Ÿå½“å‰ç½‘ç»œçŠ¶æ€ä¿¡æ¯ï¼Œ åŒ…æ‹¬ç«¯å£ã€è¿æ¥æƒ…å†µç­‰ 4# -t: TCPç«¯å£ 5# -u: UDPç«¯å£ 6# -l: ä»…æ˜¾ç¤ºç›‘å¬Socket LISTENçŠ¶æ€çš„Socket 7# -p: æ˜¾ç¤ºè¿›ç¨‹æ ‡è¯†ç¬¦å’Œç¨‹åºåç§°ï¼Œæ¯ä¸€ä¸ªsocketéƒ½å±äºä¸€ä¸ªç¨‹åº 8# -n: ä¸è¿›è¡ŒDNSè§£æ 9# -a: æ˜¾ç¤ºæ‰€æœ‰è¿æ¥çš„ç«¯å£ 10 11 12 13 14lsof 15# åˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶(list open files) 16# -i:[num] æŒ‡å®šç«¯å£ 1nslookup # åŸŸåè§£æ 2host 3dig ","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/route/","summary":"","tags":null,"title":""},{"categories":null,"contents":"mwan3\nå•çº¿å¤šæ‹¨\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/wan3/","summary":"mwan3\nå•çº¿å¤šæ‹¨","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/%E8%BF%9B%E7%A8%8B%E6%97%A5%E5%BF%97/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/%E8%BF%9B%E7%A8%8B%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/","summary":"","tags":null,"title":""},{"categories":null,"contents":"1 docker run -d -p 27017:27017 --name mongo_4_4_2 mongo:4.4.2 mongosh å‘½ä»¤è¡Œclient https://docs.mongodb.com/mongodb-shell/install\n1If you need to have node@14 first in your PATH run: 2 echo \u0026#39;export PATH=\u0026#34;/usr/local/opt/node@14/bin:$PATH\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.zshrc 3 4For compilers to find node@14 you may need to set: 5 export LDFLAGS=\u0026#34;-L/usr/local/opt/node@14/lib\u0026#34; 6 export CPPFLAGS=\u0026#34;-I/usr/local/opt/node@14/include\u0026#34; mongo doc\nhttps://mongoing.com/docs/tutorial/query-documents.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/DataBase/mongo/mongo_install/","summary":"1 docker run -d -p 27017:27017 --name mongo_4_4_2 mongo:4.4.2 mongosh å‘½ä»¤è¡Œclient https://docs.mongodb.com/mongodb-shell/install\n1If you need to have node@14 first in your PATH run: 2 echo \u0026#39;export PATH=\u0026#34;/usr/local/opt/node@14/bin:$PATH\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.zshrc 3 4For compilers to find node@14 you may need to set: 5 export LDFLAGS=\u0026#34;-L/usr/local/opt/node@14/lib\u0026#34; 6 export CPPFLAGS=\u0026#34;-I/usr/local/opt/node@14/include\u0026#34; mongo doc\nhttps://mongoing.com/docs/tutorial/query-documents.html","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/02_complication/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/03_array_link_jump/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/04_stack_queue/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/05_ds_hash_map/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/ds_heap/","summary":"","tags":null,"title":""},{"categories":null,"contents":"13th May 2022 Hi, June, this class, I hope you could help me to correct the typo and grammar and make the sentence I have made much more like a native speaker. I would appreciate it if you could help me. The sentences here are the answer about the first class. The first phase is about my hometown, the second is about my name, the third is about my job, and last but not least is about my electronic devices.\nHi, I am Airren. I come from China in Shanghai City, the city is currently under lockdown due to the COVID-19.\nI am not a native inhabitant(citizen) of Shanghai. I went here to work right after I graduated from my master\u0026rsquo;s courses and got my master\u0026rsquo;s degree, I got my first job in Shanghai. Till now, I still work in Shanghai but changed my position.\nMy hometown is Shandong province, north of China, Jinan City. It is an average town surrounded by mountains and it\u0026rsquo;s abundant with spring water. The water comes out from the underground to the surface. It is like a machine(water pump) that brings the water to the ground, nonstop. What magic it is. The most famous spring water is named Baotu spring. And the spring pool is fed by underwater limestone water through three outlets. It\u0026rsquo;s beautiful and magical. Nature really does its magic.\nNext, I want to talk something about my name, Airren. My Chinese last name is Ren, so I combined the Air and Ren to Airren. Someday, I found it is a game\u0026rsquo;s character name, and the game is \u0026lsquo;All Start Tower Defense.\u0026rsquo; Airren is a 5-star summoner and ground-type unit based on Eren Yeager from the series Attack on Titan. He can only be obtained from the Hero Summon. Airren is not Airen, not a typo. Airen as a name for boys is a Hebrew name, and the name Airen means \u0026ldquo;mountain of strength.\u0026rdquo; I think Airren contains Airen, so Airren is better for me. That\u0026rsquo;s how I got my name.\nAnd then, Let\u0026rsquo;s talk something about my work. I am a software developer working in Intel now. Intel is a global processor vendor. My work focus on Cloud Native Network research. This is a fundamental function for most applications\u0026rsquo; backend. The application in our smart-Phone is the Frontend Part. The service has a lot of remote servers(computers) to run the backend application to make it work. I worked in Intel for about half a year. Before joining Intel, I worked in ByteDance for two years after graduation. The work I did in ByteDance focused on Time Series Data Management. From the name, you can know that Time Series Data is a kind of data combined with time. For example, the temperature of a day is different with the time changes. The specific time and the temperature of this time assembled a record. This record is time-series data. In ByteDance, the online users\u0026rsquo; number, the hot video playtimes, or advertisements playtimes, and all this record can be Time Series Data. They collect the time series data and analysis to predict the peak workloads and keep the application\u0026rsquo;s stability. So every time you open TikTok, it will feed some exciting videos. Sometimes the application will be crashed due to a random error, but it won\u0026rsquo;t suffer for a long time. It always gets normal quickly. We can create a Trending list through the Time-series Data to show the hot discussion.\nWhat\u0026rsquo;s more, maybe because I work with a computer every day to programming, I like to try a different kind of electric device. I am an Apple user. I have an iPhone, iPad, MacBook, and flex headphones. I have different types of computers, such as a Surface Laptop(portable computer) and several Intel NUCs(mini PC). And I have assembled a Desktop Computer by myself. I bought a motherboard, CPU, memory modules, disk, and a power supply on an online shop like amazon or Shopee(In China is Taobao or JD). I also have a Nintendo Switch. I\u0026rsquo;d like to play the game on the switch on the weekend, some like the Super Mario series. And then, I have a NAS dedicated for storage which is not a docking station. A docking station is an extended device for a computer. But NAS, like a low-power computer, runs 24 hours every day, and with ample storage disk, all my computers can access the NAS to read or write the data. NAS is a home data share center.\nThis is the first time I have taken this kind of class. Before this class, I rarely talked in English but always read some English content about computer science on tech websites, such as stack overflow, Github, and Linux foundation. I am taking this class want to speak more, and at the same time, I want to correct my pronunciation and accent. Most of the time, I don\u0026rsquo;t know how to express the thought in my brain, organize the sentence, and speak that out. I think with your help, I will learn to munch more words and speak fluently, and finally, I can think in English and speak out everything in my mind without getting stuck.\n15/16/17th May 2022 Talk about my self-introduction.\n18th May 2022\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/English-learning/2022-05-13/","summary":"13th May 2022 Hi, June, this class, I hope you could help me to correct the typo and grammar and make the sentence I have made much more like a native speaker. I would appreciate it if you could help me. The sentences here are the answer about the first class. The first phase is about my hometown, the second is about my name, the third is about my job, and last but not least is about my electronic devices.","tags":null,"title":""},{"categories":null,"contents":"Thanks, Anj. I love your class, you are full of passion and patience. You are an excellent and professional teacher. , I think you have magic in the class. When I take your class, you can take all of my attention. I think you are very popular on this platform, your class is very hard to reserve.\nI have worked from home since two months ago.\nengoo.com/en/materials\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/English-learning/2022-05-17/","summary":"Thanks, Anj. I love your class, you are full of passion and patience. You are an excellent and professional teacher. , I think you have magic in the class. When I take your class, you can take all of my attention. I think you are very popular on this platform, your class is very hard to reserve.\nI have worked from home since two months ago.\nengoo.com/en/materials","tags":null,"title":""},{"categories":null,"contents":"18th May 2022 Yesterday, I am sorry heard you External Solid State Drive is corrupted. Is name correct, or Mobile Solid State Storage, or external hard driver, which one is usual. SSD, the short name is often used in China, so do Philippine? I remember that you bought it from Shopee. It\u0026rsquo;s may be a China brand.\nThe electronic device in Chinese brand I only suggest HUAWEI, XIAOMI, VIVO, HONOR, and Lenovo. The electronic device with a famous brand will may more stable and have much better service after it sold. some extend deviceï¼Œa brand name UGREEN is better choice.\nFor a storage device, stability is much important the than the size. Larger size can storage much data, but if you device corrupted, you will lose all of you data.\nThrough the picture you shared with me yesterday, I found a similar device like that.\nThis is External SSD. It have a type-c interface with fast speed more than 100MB/s. It\u0026rsquo;s light and handy, but you should take a type-c cable with it, or else you can\u0026rsquo;t connect it with you computer or mobile phone. Cell phone or smart phone, which word you use usually or what is different between it, we can talk in next class.\nThere three kind of Type-c cable(at least on endpoint is type-C interface). First one is Type-C to Type-Cï¼Œsecond is Type-C to Type-A, Type-A is a very common usb interface in various kind of electronic device. The last one, is Type-C to a multifunction interface, it can be Type-A or Type-C, it depend on you use case.\nOk, turn back. If you device is similar to it, you can check on the end of you device, are there two screws on the top or on the bottom as is shown in the following picture.\nMake sure you device is out of warranty periodï¼Œand or the seller do not mind you tear down(disassemble) it. If you don\u0026rsquo;t care the warranty. You can follow me.\nIf you cannot see the screws, There maybe a plastic paper cover on the end, you can try to remove it. After you use screw tools to screw the screws out, and remove the bottom case, or the top case. You can get a electronic board like that.\nIn the red square there is the solid state disk with M.2 interface, the black on is M.2 Jack. In the right-top picture pane you can see the SSD.\nM.2 SSD have 4 kind of size. The common size is 2242 and 2280. You can check which one is you disk\u0026rsquo;s size.\nYou can remove you SSD from the type adaptor.\nNow you know you External SDD consist of two parts, one is the type-c adaptor(maybe named that), and another is the M.2 SSD.\nI don\u0026rsquo;t know what happened to you external SSD. It you have a computer with M.2 interface, this interface usually on the mother board, you can connect to M.2 SSD to you computer directly to check if it is normal.\nor else, you can only by a M.2 to type-C adaptor, and move you SSD to the new adaptor, If you are lucky, it will be work. It it works normally, it proves that you old type-C adaptor is broken.\nIf it doesn\u0026rsquo;t work, maybe you SSD is broken.\nM.2-To-Type-C adaptor is cheaper than a SSD. In China, a M.2 to Type-C adaptor is about 40 RMB, same to 308 PHP.\nI suggest to a computer repair shop to check if your SSD is still work normalï¼Œit the SSD is OK, you can only by a M.2-To-Type-C adaptor with a case. Yours is with aluminium alloy, it looks beautiful.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/English-learning/2022-05-18/","summary":"18th May 2022 Yesterday, I am sorry heard you External Solid State Drive is corrupted. Is name correct, or Mobile Solid State Storage, or external hard driver, which one is usual. SSD, the short name is often used in China, so do Philippine? I remember that you bought it from Shopee. It\u0026rsquo;s may be a China brand.\nThe electronic device in Chinese brand I only suggest HUAWEI, XIAOMI, VIVO, HONOR, and Lenovo.","tags":null,"title":""},{"categories":null,"contents":"Todayï¼ŒLet\u0026rsquo;s talk something about computer\nAll the computers that are developed are not the same, they have different designs and features. Some computers have a very high capacity as well as working speed; however, some are slow. Depending on the requirements, computers are being developed.\nDepending upon the internal structure, and applicability, the computer system is categorized as follows âˆ’\nMainframe Computer It is high capacity and costly computer. It is largely used by big organizations where many people can use it simultaneously.\nSuper Computer This category of computer is the fastest and also very expensive. A typical supercomputer can solve up to ten trillion individual calculations per second.\nWorkstation Computer The computer of this category is a high-end and expensive one. It is exclusively made for complex work purposes.\nPersonal Computer (PC) It is a low-capacity computer developed for single users.\nPersonal computers can be split into Desktop computers, laptops, mini PC, and tablets.\nLaptop computer (notebook) It is a handy computer that can be easily carried anywhere.\nTablet and Smartphone Modern technology has advanced further. It has helped develop computers that are pocket-friendly. Tablets and smartphones are the best examples of such computers.\nNext, we can talk something about the Operate System. Such as window, Linux(Ubuntu or CentsOS, or fedra, or Arch linux).\nWindows is very expensive, one of my compute is Windows 11. I bought the license from Taobao(like Shopee), it\u0026rsquo;s much cheaper than the official store. When I in university, that time, I didn\u0026rsquo;t have income. I use the hacked windows, it\u0026rsquo;s free.\nAnd, I am not a Windows office suit user, It\u0026rsquo;s expensive, In China, the company named JiaShan Software, the have a production similar to Office that is WPS. It has enough compatibility with Windows Office Document, Powerpoint, and Excel. It\u0026rsquo;s an all-in-one software. You can use WPS to edit the file with the suffix .doc , .ppt, exl, and so on,\nIn Ubuntu, there is also a free Version Office software, name Libra Office(I don\u0026rsquo;t know is it the spell correct). I rarely used the ubuntu with a desktop, I just use a command-line user.\ninsufficient preparation\n13th May 2022 Teacher June\nbacklog A number of people have been employed to deal with the backlog of work. trending Shortly after the semi-finals, she became a trending topic on Chinese social media and she became famous quickly around the world. Hot discussion R\u0026amp;D Research \u0026amp; development Trail class comment: He likes to talk with me, but unfortunately our conversations are very limited. He has some difficulty understanding some works but especially when talking a bit fast. I enjoy having Ren in my class.\nSelf-introduction/Job/hometown/electric device 14th May 2022 Teacher June\nInternet Addiction:\nWhatâ€˜s your opinion about Internet Addiction?\nHave you ever been addicted to the internet?\nHave you been scammed before?\nAre you a victim of fake news?\nWhat should we do to keep our personal data safe?\nIn my opinion, Internet online games are something that you can\u0026rsquo;t reject by yourself. Once you drop in, you can\u0026rsquo;t stop doing that.\nAnd TikTok, the feeding video platform, is another kind of Internet drug, while using the TikTok, I don\u0026rsquo;t know what about the next video, so I expect the next video, and wait to get funny with it. and my brain will produce a lot of dopamine to make me feel happy.\nAbout 4 years ago, when the TikTok became popular, I have been addicted to TikTok for a while(about 3 months). I can stop myself to swap to the next video. And I also played Tencent\u0026rsquo;s mobile games, such as mobile Legend and PUBG Mobile. But I haven\u0026rsquo;t lost in the game.\nThere\u0026rsquo;s a big risk to use an unsafe website. If you logged into an unsafe website, you might leak your private information. Others might steal your information.\nI know the fake news and actual news. I am not a victim of fake news.\nWe should not write our information on different sites and regularly change our passwords.\nMobile Legends: Bang Bang\nCHAT:\nIn pairs/groups, talk about these topics or words from the article. What does the article say about them? What can you say about these words and your life?\nInternet dangers\nFake news\nPersonal data\nplatform\ninformation\nopportunities\nstrategy\nsolution\nFree speech\nHave a chat about the topics you liked. Change the subject and partner frequently.\nGOOD:\nStudent A strongly believes the internet is a good thing; Student B strongly thinks the Internet is a bad thing. Change partners again and talk about your conversation.\nDANGERS:\nWhat are the dangers of the internet? How can we avoid them? Complete this table with your partner(s). Change partners often and share what you wrote.\nDangers How to avoid them Identity theft Phishing Cyber-bullying Fake news Personal data Addiction Problems\nRank this with your partner. Put the biggest problems with the Internet at the top. Change partners often and share your ranking.\nI will revise the material to make it a bit easy.\nComment: Today we had our 2nd class and we used computer-related material. He has difficulty distinguishing sounds in words when speaking. Ren remembers new words and reads very well. However, some words are a bit hard for him. In listening and comprehension exercises and activities, he usually does well. He follows the material easily. Ren is achieving good success with English.\n15th May 2022 Self-introduction\n16th May 2022 Comment: very persistent in learning. I love the learning attitude. Keep it up.\nSelf-introduction\n17th May 2022 Self-introduction\n18th May 2022 Teacher Anj\nI just pull my weight. You were very enthusiastic, just keep on working with your pronunciation vocabulary.\nThanks, Anj. I love your class, you are full of passion and patience. You are an excellent and professional teacher. I think you have magic in the class. When I take your class, you can take all of my attention. I think you are very popular on this platform, your class is very hard to reserve.\nI have worked from home since two months ago.\nTeacher June\nTalk something about Solid State Disk.\nRen asks pertinent questions about the material under discussion. He listens attentively and usually understands what I\u0026rsquo;m explaining to the class. Ren demonstrates his understanding of new materials by providing an answer to the teacher\u0026rsquo;s question. Ren\u0026rsquo;s understanding of the material is excellent.\n19th May 2022 Teacher June\nTalk something about computer\ncomplex/ complicated\nDistribution version\nLaggyï¼š old computer is laggy\nHe can correctly use basic verb tenses in short sentences but I would like him to start speaking in longer, more accurate sentences. He has some difficulty understanding people who speak with average speed. Ren demonstrates an excellent understanding of new material by always providing an answer to the teacher\u0026rsquo;s question. Airren is continuing to do very well in English.\n20st May 2022 Teacher Anj\nThe vocal concert is Live family obligation \u0026amp; reunion \u0026amp; the school\u0026rsquo;s annual reunion Participate It wears me out. Tradition To give a blessing.\nThank you for having me again. You have so many good ideas to share. You can expand your ideas very well. Thank you again for attending the class, take care. See you again.\nAsk about \u0026ldquo;It wears me out\u0026rdquo;\nTeacher Indi\nelaborate\nElaborate design/ an elaborate computer system/ elaborate meal\nFishing rod\nUntil the dark is coming\nI will find the word.\nI have been working from home for two months now.\nKids are much busier than adults.\nWhen I was a child\u0026hellip;\nMost of my friends are my classmates\nYou enjoyed sharing ideas and thoughts. You were a capable student, and you comprehended a great deal of the lessons taught. You were also a good listener, thus, you grasped everything in the class. Keep on exhibiting such an amazing/fantastic performance.\nTeacher June\nAllure overtake why didn\u0026rsquo;t you go for a 256GB iPhoneï¼Ÿ It was expensive.\n21st May 2022 Teacher Anj\nTalk about who is much busier\n23rd May 2022 I am very happy today because today we have 3 hours to go out of the housing estate. And one hour to go to the supermarket to buy necessities of life. But unfortunately, only one person is allowed to go out for one household, so that, my wife stay at home while I went out. These past two months, lockdown in the housing estate was like putting me into jail. I think the prisoner is much happier than me, they don\u0026rsquo;t need to cook by themselves.\nAnd the prisoners are allowed out of their cells for two hours a day, but in the past two months, we have even can\u0026rsquo;t allow going out of our apartment door.\nIf someone says thanks to you, how to turn back?\nDon\u0026rsquo;t mention it. It\u0026rsquo;s my pleasure. No worries. No problem. Any time. ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/English-learning/2022-05-19/","summary":"Todayï¼ŒLet\u0026rsquo;s talk something about computer\nAll the computers that are developed are not the same, they have different designs and features. Some computers have a very high capacity as well as working speed; however, some are slow. Depending on the requirements, computers are being developed.\nDepending upon the internal structure, and applicability, the computer system is categorized as follows âˆ’\nMainframe Computer It is high capacity and costly computer. It is largely used by big organizations where many people can use it simultaneously.","tags":null,"title":""},{"categories":null,"contents":"Q1 2022 Insight The SDEWAN E2E demo installs and verifies process is simplified, shortened to about 40 minutes, and improved efficiency by optimizing the automatic deployment and test scripts. Help the Smart Edge team integrate SDEWAN with DEK, prepare guides, answer questions, and do hands-on debugging.\nVerified the POC in Ubuntu that StrongsWAN integrates with CTK through PKCS#11, which put the private key in -the SGX enclave to protect it. And propose ubuntu-SGX container as a sidecar work with CNF to provide the security IPsec Tunnel connection.\nChallenge: While building SGX SDK, CTK, and strongsWAN in Ubuntu encountered some barriers with C project toolchains. Finally, remove most of them. But while building OpenWRT with SGX, most of the compile seems complicated to solve, so choose another way instead of making that.\nOne Intel:\nOne Intel: Qiang proactivity helps Smart Edge team to integrate SDEWAN with DEK, prepare guides, answer questions, do hands-on debugging and always solve issues in time.\nFearless: Qiang always keeps curiosity for the unknown region can complete the work with challenges. Qiang successfully complete the POC strongsWAN integrated with CTK in ubuntu overcoming a lot of difficulties.\nOKR for Q2 Object 1ï¼šIntergrate SGX with CNF to protect the private key. optimize the image size, strongsWAN-CTK image base on Ubuntu, limit to 200M. Complete web server(Golang) in Ubuntu container and Client(Lua) in OpenWRT container, to accomplish start/stop/restart strongsWAN service in Ubuntu. Test the sync cost time between two sides of the shared Volum. One side is in OpenWRT, and another is in Ubuntu. Expose RESTful API in Ubuntu-SGX to generate private keys in Enclave, and create the CSR for the private key in Enclave. Object 2: Refine SDEWAN auto-install script and complete the document Optimize auto-install script, make it suitable for VM deploy and physical deploy. Complete the SDEWAN documentation along with the version updated. Object 3: Deep dive into Kubernetes Network ,Custome Resource and Sapphire Rapids Read more about Virtual Network and CNI definition of Kubernetes veth pair, tun/tap, Linux bridge, VXLAN, Macvlan Calico, Flannel Write a Customer Controller Demo through Kubebuilder or Operator SDK. Read the Spec of Intel Feature AMX, and prepare a presention for IDF sharing in 3rd, May. Try to join a K8s SIG-Netwoking, watch the latest 10 SIG-Networking meeting videos. make gen-yaml IMG=\u0026ldquo;integratedcloudnative/sdewan-controller:devtest1\u0026rdquo;\nQ2 2022 Insight Insight For the SDEWAN project: Test several work modes of CNF, one is multiple interfaces that can use host-device mode or nodus direct mode to share the physical interface to CNF, and another is CNF work as a service export through NodePort mode. Support SGX HSM co-work with CNF as a sidecar and test SDEWAN pull mode through the script.\nHelp the SmartEdge team finish the SASE EK release, by upgrading the auto-deploy script with the latest components. And verified the possibility of using SDEWAN with Nodus in WAN on AWS.\nRelease a Sapphire rapids feature AMX presentation and verify the IDF proposal\u0026rsquo;s feasibility that uses the AVX or AMX to accelerate the query speed of Time-Series Data. And bring up an IDF proposal of Cloud Native HSM.\nChallenge: While working for the SDEWAN SGX support model, solved some tricky problems which are cross-compile the p11-kit tool for OpenWrt and changing the pkcs#11 token initialize arguments to fit CTK and squashing the HSM image with SGX to reach an ideal size.\nQuality: Help the Smart Edge team release SDEWAN with the latest stable component. Ensure the stability and reliability of the auto-deploy script.\nResult Driven: Even encountering many tricky problems while enabling SGX for CNF, Qiang solved the problem step by step and finally accomplish the component as the previous design architecture.\nOKR for Q2 OKR for Q3 OBJ1: Enable IA optimizations and innovations in open-source Edge Orchestration projects\nKR1: Integrate and ship Nodus and SDEWAN 22.09 with SmartEdge-O release\nKR2: Enhance SGX E2E flow with Cert Manager(Useing SGX as externel issuer) support SDEWAN 22.09 release.\nKR3: SDEWAN auto CICD process, optimize the version manager, and split the code repo\nOBJ2: Build Intel leadership in open-source Edge Orchestration projects with focus on individual career growth\nKR3: Deliver 1 technical submission on edge usages with SDEWAN (KubeCon China)\nKR4: v\npromiscuous\nQ3 Insight Works in Q3\nSupport Smart Edge Team design and verify service function chain in the HUB. Help verify SDEWAN with nodus work on a multi-node cluster and IPsec cross NAT.\nFinished SDEWAN release with SGX feature enhancement and test a new feature for SDL supported.\nNodus support. Ramp up, test and verify the patch for K8s latest version, and SFC for IPV6.\nPlan for Q4\nDeliver SDEWAN 22.12 releases. Features include: SGX e2e flow enhancement for SDL requirements.\nIntegrate SDEWAN with SmartEdge release.\nIntel Values\nOneIntel: Help Smart Edge team set up new features based on SDEWAN, design and verify the proposals. Such as, service function chains, nodus work in multi node and IPsec tunnel cross NAT.\nFearless: While working with nodus, facing the relatively unfamiliar fields of OVN and CNI, Qiang reads related materials, dives into this field, and gets involved with Nodus relevant job.\npoints for improvementï¼š\nLearning: Qiang should continuously learn Kubernetes related technologies and improve software design skill to deliver high quality product\nInnovation: Qiang should continuously learn intel platform features and innovate on how to prompt integration in edge computing domain.\nQ4 OKR OBJ1: Enable IA optimizations and innovations in open-source Edge Orchestration projects\nDeliver SDEWAN 22.12 releases. Features include: SGX e2e flow enhancement for SDL requirements.\nOBJ2: Build Intel leadership in open-source Edge Orchestration projects with focus on individual career growth\nSubmit 1 edge orchestration related IDF submission\nåšçš„å¥½çš„ï¼Œä»¥åŠéœ€è¦æ”¹è¿›çš„ï¼Œvalue 2-3 ä¸ª\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/Insight/","summary":"Q1 2022 Insight The SDEWAN E2E demo installs and verifies process is simplified, shortened to about 40 minutes, and improved efficiency by optimizing the automatic deployment and test scripts. Help the Smart Edge team integrate SDEWAN with DEK, prepare guides, answer questions, and do hands-on debugging.\nVerified the POC in Ubuntu that StrongsWAN integrates with CTK through PKCS#11, which put the private key in -the SGX enclave to protect it. And propose ubuntu-SGX container as a sidecar work with CNF to provide the security IPsec Tunnel connection.","tags":null,"title":""},{"categories":null,"contents":"package main\nimport \u0026ldquo;fmt\u0026rdquo;\nvar testMap = map[string]map[string]struct { Name string }{ \u0026ldquo;first\u0026rdquo;: {\u0026ldquo;second\u0026rdquo;: {Name: \u0026ldquo;12312\u0026rdquo;}}, \u0026ldquo;second\u0026rdquo;: {\u0026ldquo;second\u0026rdquo;: {\u0026ldquo;12312\u0026rdquo;}}, }\nfunc main() { d := testMap[\u0026ldquo;first\u0026rdquo;][\u0026ldquo;second\u0026rdquo;].Name fmt.Printf(\u0026quot;++-%v-++\\n\u0026quot;, d)\nc := testMap[\u0026quot;first22\u0026quot;][\u0026quot;second\u0026quot;].Name fmt.Printf(\u0026quot;++-%v-++\\n\u0026quot;, c) }title: 2021-04-21 Socket\nhttps://www.cnblogs.com/wmx-learn/p/5312259.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-04-21-/","summary":"package main\nimport \u0026ldquo;fmt\u0026rdquo;\nvar testMap = map[string]map[string]struct { Name string }{ \u0026ldquo;first\u0026rdquo;: {\u0026ldquo;second\u0026rdquo;: {Name: \u0026ldquo;12312\u0026rdquo;}}, \u0026ldquo;second\u0026rdquo;: {\u0026ldquo;second\u0026rdquo;: {\u0026ldquo;12312\u0026rdquo;}}, }\nfunc main() { d := testMap[\u0026ldquo;first\u0026rdquo;][\u0026ldquo;second\u0026rdquo;].Name fmt.Printf(\u0026quot;++-%v-++\\n\u0026quot;, d)\nc := testMap[\u0026quot;first22\u0026quot;][\u0026quot;second\u0026quot;].Name fmt.Printf(\u0026quot;++-%v-++\\n\u0026quot;, c) }title: 2021-04-21 Socket\nhttps://www.cnblogs.com/wmx-learn/p/5312259.html","tags":null,"title":""},{"categories":null,"contents":"é¡¹ç›®æ¶æ„ ES6 å’ŒTypeScript\nAnd Design Pro\nlog å¯ä»¥æ”¾åœ¨src/assets/images/klogo.svgã€‚ ç„¶ååœ¨é¡µé¢ä¸­é€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ç”¨\n1 2// @ è¡¨ç¤ºåœ¨src ç›®å½•ä¸‹é¢ 3import logo from \u0026#39;@/assets/images/logo.svg\u0026#39; 4 5\u0026lt;LoginForm 6\tlogo={\u0026lt;image alt=\u0026#34;logo\u0026#34; src={logo}\u0026gt;} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_antd%E6%95%99%E7%A8%8B/1st_%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/","summary":"é¡¹ç›®æ¶æ„ ES6 å’ŒTypeScript\nAnd Design Pro\nlog å¯ä»¥æ”¾åœ¨src/assets/images/klogo.svgã€‚ ç„¶ååœ¨é¡µé¢ä¸­é€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ç”¨\n1 2// @ è¡¨ç¤ºåœ¨src ç›®å½•ä¸‹é¢ 3import logo from \u0026#39;@/assets/images/logo.svg\u0026#39; 4 5\u0026lt;LoginForm 6\tlogo={\u0026lt;image alt=\u0026#34;logo\u0026#34; src={logo}\u0026gt;} ","tags":null,"title":""},{"categories":null,"contents":"2. Reactä»‹ç» 2.1 React åŸºæœ¬ä»‹ç» FaceBook å¼€æºçš„JavaScriptåº“\nReactç»“åˆç”Ÿæ€åº“æ„æˆä¸€ä¸ªMV*æ¡†æ¶\nReactç‰¹ç‚¹\nDeclarative å£°æ˜å¼ç¼–ç \nComponent-Based ç»„ä»¶åŒ–ç¼–ç \né«˜æ•ˆ-é«˜æ•ˆçš„DOM Diffç®—æ³•ï¼Œæœ€å°åŒ–é¡µé¢é‡ç»˜\nå•é¡¹æ•°æ®æµ\nMV*æ¡†æ¶ä»£è¡¨- åªå…³æ³¨è§†å›¾viewå±‚+æ•°æ®å±‚Model\nç”Ÿæ€ä»‹ç»\nVueç”Ÿæ€ï¼š Vue+Vue-Router+Vuex+Axios+Babel + Webpack Reactç”Ÿæ€ï¼š React+React-Router+Redux+Axios+Babel + WebPack ç¼–ç¨‹å¼å®ç°\néœ€è¦ä»¥å…·ä½“ä»£ç è¡¨è¾¾åœ¨å“ªé‡Œ(where)åšä»€ä¹ˆ(what)ï¼Œå¦‚ä½•å®ç°ï¼ˆhowï¼‰ å£°æ˜å¼å®ç°\nåªéœ€è¦å£°æ˜åœ¨å“ªé‡Œï¼ˆwhereï¼‰åšä»€ä¹ˆï¼ˆwhatï¼‰ï¼Œè€Œæ— éœ€å…³ç³»å¦‚ä½•å®ç°ï¼ˆhowï¼‰ 2.2 Reactè„šæ‰‹æ¶ã€yarn å¦‚ä½•å®‰è£…å’Œä½¿ç”¨Reactè„šæ‰‹æ¶ 1npm install -g create-react-app 2creat-react-app my-app 3 4cd my-app 5npm start ä»€ä¹ˆæ˜¯Yarn\nyarn æ˜¯æ–°ä¸€ä»£çš„åŒ…ç®¡ç†å·¥å…· ä¸ºä»€ä¹ˆä½¿ç”¨Yarn\né€Ÿåº¦å¿« å®‰è£…ç‰ˆæœ¬ç»Ÿä¸€ã€æ›´å®‰å…¨ æ›´ç®€æ´çš„è¾“å‡º æ›´å¥½çš„è¯­ä¹‰åŒ– å¦‚ä½•ä½¿ç”¨Yarn\n1yarn init 2yarn add # npm install 3yarn remove # npm uninstall 4yarn/yarn install # npm install æˆ–è€… npm i http:// reactjs.org/docs/add-react-to-a-new-app.html\né¡¹ç›®åˆå§‹åŒ– 1npm install -g create-react-app 2create-react-app imoocmanager # è·¯ç”±æ˜¯æ²¡æœ‰çš„ router reduxæ²¡æœ‰ ç›®å½•ç»“æ„\n1node_modules #ä¾èµ– 2public # é™æ€æ–‡ä»¶ 3src # æ ¸å¿ƒæ–‡ä»¶ 4 5App.js # æ ¹ç»„ä»¶ 6index.js # å…¥å£ yarn ä½¿ç”¨è¯´æ˜ https://yarn.bootcss.com/\nä»£ç é€šè¿‡ åŒ…ï¼ˆpackageï¼‰ (æˆ–è€…ç§°ä¸º æ¨¡å—ï¼ˆmoduleï¼‰) çš„æ–¹å¼æ¥å…±äº«ã€‚ ä¸€ä¸ªåŒ…é‡ŒåŒ…å«æ‰€æœ‰éœ€è¦å…±äº«çš„ä»£ç ï¼Œä»¥åŠæè¿°åŒ…ä¿¡æ¯çš„æ–‡ä»¶ï¼Œç§°ä¸º package.json ã€‚\nYarn ä½¿ç”¨ä»‹ç» åˆå§‹åŒ–ä¸€ä¸ªæ–°é¡¹ç›®\n1yarn init æ·»åŠ ä¾èµ–åŒ…\n1yarn add [package] 2yarn add [package]@[version] 3yarn add [package]@[tag] å°†ä¾èµ–é¡¹æ·»åŠ åˆ°ä¸åŒä¾èµ–é¡¹ç±»åˆ«ä¸­\nåˆ†åˆ«æ·»åŠ åˆ° devDependenciesã€peerDependencies å’Œ optionalDependencies ç±»åˆ«ä¸­ï¼š\n1yarn add [package] --dev 2yarn add [package] --peer 3yarn add [package] --optional å‡çº§ä¾èµ–åŒ…\n1yarn upgrade [package] 2yarn upgrade [package]@[version] 3yarn upgrade [package]@[tag] ç§»é™¤ä¾èµ–åŒ…\n1yarn remove [package] å®‰è£…é¡¹ç›®çš„å…¨éƒ¨ä¾èµ–\n1yarn æˆ–è€…\n1yarn install å¢åŠ è·¯ç”±ç®¡ç† 1yarn add react-router Webpack é…ç½®ï¼š ç¼–è¯‘æˆé™æ€æ–‡ä»¶\n2.3 Reactç”Ÿå‘½å‘¨æœŸä»‹ç» Reactç”Ÿå‘½å‘¨æœŸåŒ…å«å“ªäº› 10 ä¸ªAPI getDefaultProps\ngetInitialState\ncomponentWillMount\nRender\ncomponentDidMount\ncomponentWillReceiveProps\nshouldComponentUpdate\ncomponentWillupdate\ncomponentDidUpdate\ncomponentWillUnmount\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_antd%E6%95%99%E7%A8%8B/2nd_React%E4%BB%8B%E7%BB%8D/","summary":"2. Reactä»‹ç» 2.1 React åŸºæœ¬ä»‹ç» FaceBook å¼€æºçš„JavaScriptåº“\nReactç»“åˆç”Ÿæ€åº“æ„æˆä¸€ä¸ªMV*æ¡†æ¶\nReactç‰¹ç‚¹\nDeclarative å£°æ˜å¼ç¼–ç \nComponent-Based ç»„ä»¶åŒ–ç¼–ç \né«˜æ•ˆ-é«˜æ•ˆçš„DOM Diffç®—æ³•ï¼Œæœ€å°åŒ–é¡µé¢é‡ç»˜\nå•é¡¹æ•°æ®æµ\nMV*æ¡†æ¶ä»£è¡¨- åªå…³æ³¨è§†å›¾viewå±‚+æ•°æ®å±‚Model\nç”Ÿæ€ä»‹ç»\nVueç”Ÿæ€ï¼š Vue+Vue-Router+Vuex+Axios+Babel + Webpack Reactç”Ÿæ€ï¼š React+React-Router+Redux+Axios+Babel + WebPack ç¼–ç¨‹å¼å®ç°\néœ€è¦ä»¥å…·ä½“ä»£ç è¡¨è¾¾åœ¨å“ªé‡Œ(where)åšä»€ä¹ˆ(what)ï¼Œå¦‚ä½•å®ç°ï¼ˆhowï¼‰ å£°æ˜å¼å®ç°\nåªéœ€è¦å£°æ˜åœ¨å“ªé‡Œï¼ˆwhereï¼‰åšä»€ä¹ˆï¼ˆwhatï¼‰ï¼Œè€Œæ— éœ€å…³ç³»å¦‚ä½•å®ç°ï¼ˆhowï¼‰ 2.2 Reactè„šæ‰‹æ¶ã€yarn å¦‚ä½•å®‰è£…å’Œä½¿ç”¨Reactè„šæ‰‹æ¶ 1npm install -g create-react-app 2creat-react-app my-app 3 4cd my-app 5npm start ä»€ä¹ˆæ˜¯Yarn\nyarn æ˜¯æ–°ä¸€ä»£çš„åŒ…ç®¡ç†å·¥å…· ä¸ºä»€ä¹ˆä½¿ç”¨Yarn\né€Ÿåº¦å¿« å®‰è£…ç‰ˆæœ¬ç»Ÿä¸€ã€æ›´å®‰å…¨ æ›´ç®€æ´çš„è¾“å‡º æ›´å¥½çš„è¯­ä¹‰åŒ– å¦‚ä½•ä½¿ç”¨Yarn\n1yarn init 2yarn add # npm install 3yarn remove # npm uninstall 4yarn/yarn install # npm install æˆ–è€… npm i http:// reactjs.","tags":null,"title":""},{"categories":null,"contents":"3. ä¸»é¡µé¢æ¶æ„è®¾è®¡ è¯¾ç¨‹ç›®æ ‡ä»‹ç»\nç¬¬äºŒç«  é¡¹ç›®ä¸»é¡µå·¥ç¨‹æ­å»º\nåŸºç¡€æ’ä»¶å®‰è£…ï¼Œlessæ–‡ä»¶åŠ è½½é…ç½® é¡¹ç›®ä¸»é¡µç»“æ„å¼€å‘ èœå•ç»„ä»¶å¼€å‘ å¤´éƒ¨ç»„ä»¶å¼€å‘ åº•éƒ¨ç»„ä»¶å¼€å‘ 3-1 åŸºç¡€æ’ä»¶å®‰è£…ï¼ˆ1ï¼‰ åŸºç¡€æ’ä»¶å®‰è£…ï¼Œlessæ–‡ä»¶åŠ è½½é…ç½® å®‰è£…æ‰€éœ€çš„æ’ä»¶\nå®‰è£…React-Router, Axios å®‰è£…antDç•Œé¢æ¡†æ¶ æš´éœ²webpacké…ç½®æ–‡ä»¶ å®‰è£…less-loader ä¿®æ”¹less-loader 1 yarn add react-router-dom axios less-loader # 3.0å‡çº§åˆ° 4.0 AntD æ˜¯åŸºäºlesså¼€å‘çš„\næš´éœ²webpackæ–‡ä»¶ä½¿ç”¨less 1yarn eject create-react-appæ·»åŠ lessé…ç½®\nä¿®æ”¹å®Œæˆé…ç½®åéœ€è¦é‡å¯é¡¹ç›®ï¼Œä»åå‘å‰ä½¿ç”¨ï¼Œ lessçš„é…ç½®æ”¾åœ¨cssï¼Œscssä¹‹å\nå¯èƒ½éœ€è¦åˆ é™¤node_moduleæ–‡ä»¶å¤¹é‡æ–°yarn install\nyarn add less\néœ€è¦ä¿®æ”¹çš„æ–‡ä»¶config/webpack.config.js\n1// style files regexes 2const cssRegex = /\\.css$/; 3const cssModuleRegex = /\\.module\\.css$/; 4const lessRegex = /\\.less$/; 5const lessModuleRegex = /\\.module\\.less$/; 6const sassRegex = /\\.(scss|sass)$/; 7const sassModuleRegex = /\\.module\\.(scss|sass)$/; 1{ 2 test: lessRegex, 3 exclude: lessModuleRegex, 4 use: getStyleLoaders( 5 { 6 importLoaders: 2, 7 sourceMap: isEnvProduction 8 ? shouldUseSourceMap 9 : isEnvDevelopment, 10 }, 11 \u0026#39;less-loader\u0026#39; 12 ), 13 sideEffects: true, 14}, 15 16 { 17 test: lessModuleRegex, 18 use: getStyleLoaders( 19 { 20 importLoaders: 2, 21 sourceMap: isEnvProduction 22 ? shouldUseSourceMap 23 : isEnvDevelopment, 24 modules: true, 25 getLocalIdent: getCSSModuleLocalIdent, 26 }, 27 \u0026#39;less-loader\u0026#39; 28 ), 29 }, ä½¿ç”¨antdçš„ç»„ä»¶ 1yanr add antd 1import React from \u0026#39;react\u0026#39; 2import Child from \u0026#39;./Child\u0026#39; 3import \u0026#39;./index.less\u0026#39; 4import { Button } from \u0026#39;antd\u0026#39; 5import \u0026#39;antd/dist/antd.css\u0026#39; 6export default class Life extends React.Component { 7 8 // constructor(props) { 9 // super(props); 10 // this.state = { 11 // count: 0 12 // }; 13 // } 14 state = { 15 count: 0 16 } 17 18 // ES 6 å†™æ³• 19 handleAdd = () =\u0026gt; { 20 this.setState({ 21 count: this.state.count + 1 22 }) 23 } 24 25 handleClick() { 26 this.setState({ 27 count: this.state.count + 1 28 }) 29 } 30 31 32 render() { 33 // let style = { 34 // padding:200 35 // } 36 // return å¿…é¡»æœ‰æ ¹å…ƒç´ ï¼Œä¸èƒ½åŒæ—¶å‡ºç°ä¸¤ä¸ªdiv 37 // return \u0026lt;div style={style}\u0026gt; 38 return \u0026lt;div className=\u0026#34;content\u0026#34;\u0026gt; 39 \u0026lt;p\u0026gt;Reactå£°æ˜å‘¨æœŸä»‹ç»\u0026lt;/p\u0026gt; 40 \u0026lt;Button onClick={this.handleAdd}\u0026gt;AntDç‚¹å‡»ä¸€ä¸‹\u0026lt;/Button\u0026gt; 41 \u0026lt;button onClick={this.handleAdd}\u0026gt;ç‚¹å‡»ä¸€ä¸‹\u0026lt;/button\u0026gt; 42 \u0026lt;button onClick={this.handleClick.bind(this)}\u0026gt;ç‚¹å‡»ä¸€ä¸‹\u0026lt;/button\u0026gt; 43 \u0026lt;p\u0026gt;{this.state.count}\u0026lt;/p\u0026gt; 44 \u0026lt;Child name={this.state.count}\u0026gt;\u0026lt;/Child\u0026gt; 45 \u0026lt;/div\u0026gt; 46 } 47} ä½¿ç”¨ babel-plugin-import babel-plugin-import æ˜¯ä¸€ä¸ªç”¨äºæŒ‰éœ€åŠ è½½ç»„ä»¶ä»£ç å’Œæ ·å¼çš„ babel æ’ä»¶ï¼ˆåŸç†ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬å°è¯•å®‰è£…å®ƒå¹¶ä¿®æ”¹ config-overrides.js æ–‡ä»¶ã€‚\n1yarn add babel-plugin-import 1yarn add less@^2.7.3 # åˆ¶ä¿®è®¢ç‰ˆæœ¬å®‰è£… babel-plugin-importé…ç½®babelæŒ‰éœ€å¼•å…¥antdæ¨¡å—\nå°†lessç‰ˆæœ¬é™åˆ°3.0ä»¥ä¸‹ æ¯”å¦‚å®‰è£… 2.7.3ç‰ˆæœ¬ã€‚\néœ€è¦ä¿®æ”¹çš„æ–‡ä»¶config/webpack.config.js\n1{ 2 test: /\\.(js|mjs|jsx|ts|tsx)$/, 3 include: paths.appSrc, 4 loader: require.resolve(\u0026#39;babel-loader\u0026#39;), 5 options: { 6 customize: require.resolve( 7 \u0026#39;babel-preset-react-app/webpack-overrides\u0026#39; 8 ), 9 10 plugins: [ 11 [ 12 require.resolve(\u0026#39;babel-plugin-named-asset-import\u0026#39;), 13 { 14 loaderMap: { 15 svg: { 16 ReactComponent: \u0026#39;@svgr/webpack?-prettier,-svgo![path]\u0026#39;, 17 }, 18 }, 19 }, 20 ], 21 [\u0026#39;import\u0026#39;,{libraryName:\u0026#39;antd\u0026#39;,style:true}], 22 ], 23 // This is a feature of `babel-loader` for webpack (not Babel itself). 24 // It enables caching results in ./node_modules/.cache/babel-loader/ 25 // directory for faster rebuilds. 26 cacheDirectory: true, 27 // Don\u0026#39;t waste time on Gzipping the cache 28 cacheCompression: false, 29 }, 30 }, æ›´æ¢ä¸»é¢˜ 1options:{ 2 modules: false, 3 modifyVars: { 4 \u0026#34;@primary-color\u0026#34;: \u0026#34;#f9c700\u0026#34; // å…¨å±€ä¸»è‰² 5 } 6}, 3-3 é¡¹ç›®ä¸»é¡µç»“æ„å¼€å‘ ä¸»é¡µç»“æ„å®šä¹‰\né¡µé¢ç»“æ„å®šä¹‰ ç›®å½•ç»“æ„çš„å®šä¹‰ æ …æ ¼ç³»ç»Ÿä½¿ç”¨ calcè®¡ç®—æ–¹æ³•ä½¿ç”¨ calc åŠ¨æ€è®¡ç®—é•¿åº¦å€¼\n3-2 åŸºç¡€æ’ä»¶å®‰è£…ï¼ˆ2ï¼‰ 3-3 ï¼ˆå®‰è£…è¯¾ç¨‹ä¸­Webpackç‰ˆæœ¬çš„ç”¨æˆ·è¯·å¿½ç•¥è¿™ä¸€å°èŠ‚ï¼‰Webpack4.19.1ç‰ˆæœ¬æ–‡ä»¶åˆå¹¶åé…ç½®æŒ‰éœ€åŠ è½½ 3-4 é¡µé¢ç»“æ„å¼€å‘ï¼ˆ1ï¼‰ 3-5 é¡µé¢ç»“æ„å¼€å‘ï¼ˆ2ï¼‰ 3-6 èœå•ç»„ä»¶å¼€å‘ï¼ˆ1ï¼‰ 3-7 èœå•ç»„ä»¶å¼€å‘ï¼ˆ2ï¼‰ 3-8 å¤´éƒ¨ç»„ä»¶å®ç°ï¼ˆ1ï¼‰ 3-9 å¤´éƒ¨ç»„ä»¶å®ç°ï¼ˆ2ï¼‰ 3-10 åº•éƒ¨ç»„ä»¶åŠŸèƒ½å®ç°ï¼ˆ1ï¼‰ 3-11 åº•éƒ¨ç»„ä»¶åŠŸèƒ½å®ç°ï¼ˆ2ï¼‰\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_antd%E6%95%99%E7%A8%8B/3rd_%E4%B8%BB%E9%A1%B5%E9%9D%A2%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/","summary":"3. ä¸»é¡µé¢æ¶æ„è®¾è®¡ è¯¾ç¨‹ç›®æ ‡ä»‹ç»\nç¬¬äºŒç«  é¡¹ç›®ä¸»é¡µå·¥ç¨‹æ­å»º\nåŸºç¡€æ’ä»¶å®‰è£…ï¼Œlessæ–‡ä»¶åŠ è½½é…ç½® é¡¹ç›®ä¸»é¡µç»“æ„å¼€å‘ èœå•ç»„ä»¶å¼€å‘ å¤´éƒ¨ç»„ä»¶å¼€å‘ åº•éƒ¨ç»„ä»¶å¼€å‘ 3-1 åŸºç¡€æ’ä»¶å®‰è£…ï¼ˆ1ï¼‰ åŸºç¡€æ’ä»¶å®‰è£…ï¼Œlessæ–‡ä»¶åŠ è½½é…ç½® å®‰è£…æ‰€éœ€çš„æ’ä»¶\nå®‰è£…React-Router, Axios å®‰è£…antDç•Œé¢æ¡†æ¶ æš´éœ²webpacké…ç½®æ–‡ä»¶ å®‰è£…less-loader ä¿®æ”¹less-loader 1 yarn add react-router-dom axios less-loader # 3.0å‡çº§åˆ° 4.0 AntD æ˜¯åŸºäºlesså¼€å‘çš„\næš´éœ²webpackæ–‡ä»¶ä½¿ç”¨less 1yarn eject create-react-appæ·»åŠ lessé…ç½®\nä¿®æ”¹å®Œæˆé…ç½®åéœ€è¦é‡å¯é¡¹ç›®ï¼Œä»åå‘å‰ä½¿ç”¨ï¼Œ lessçš„é…ç½®æ”¾åœ¨cssï¼Œscssä¹‹å\nå¯èƒ½éœ€è¦åˆ é™¤node_moduleæ–‡ä»¶å¤¹é‡æ–°yarn install\nyarn add less\néœ€è¦ä¿®æ”¹çš„æ–‡ä»¶config/webpack.config.js\n1// style files regexes 2const cssRegex = /\\.css$/; 3const cssModuleRegex = /\\.module\\.css$/; 4const lessRegex = /\\.less$/; 5const lessModuleRegex = /\\.module\\.less$/; 6const sassRegex = /\\.(scss|sass)$/; 7const sassModuleRegex = /\\.","tags":null,"title":""},{"categories":null,"contents":" 2nd_æ“ä½œç³»ç»Ÿ\n3rd_ç½‘ç»œ\n4th_æ•°æ®åº“\n5th_ç¨‹åºè®¾è®¡åŸºç¡€\n6th_ç¼–ç æŠ€å·§\n7th_é¢å‘å¯¹è±¡\n8th_è®¾è®¡æ¨¡å¼\n9th_é«˜çº§çŸ¥è¯†ç‚¹\n10th_Googleç¬”è¯•é¢˜è§£\n11th_é¢è¯•æŠ€å·§å’Œæ€»ç»“\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/0_Category/","summary":"2nd_æ“ä½œç³»ç»Ÿ\n3rd_ç½‘ç»œ\n4th_æ•°æ®åº“\n5th_ç¨‹åºè®¾è®¡åŸºç¡€\n6th_ç¼–ç æŠ€å·§\n7th_é¢å‘å¯¹è±¡\n8th_è®¾è®¡æ¨¡å¼\n9th_é«˜çº§çŸ¥è¯†ç‚¹\n10th_Googleç¬”è¯•é¢˜è§£\n11th_é¢è¯•æŠ€å·§å’Œæ€»ç»“","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/10th_Google%E5%9C%A8%E7%BA%BF%E7%AC%94%E8%AF%95%E9%A2%98%E8%A7%A3/","summary":"","tags":null,"title":""},{"categories":null,"contents":"é¢è¯•è½¯æŠ€å·§å’Œæ€»ç»“ è§£å†³é—®é¢˜çš„èƒ½åŠ› é¢å¯¹é—®é¢˜çš„æ€åº¦ åˆ†æé—®é¢˜çš„æ–¹æ³• ç»“æ„åŒ–åˆ†æé—®é¢˜ å‰”é™¤å¹²æ‰°é¡¹ æé—®é¢è¯•å®˜ ä»‹ç»ä¸€ä¸‹æ‰€åœ¨çš„é¡¹ç›®ç»„ ä»‹ç»ä¸€ä¸‹æ‰€ç”¨çš„æŠ€æœ¯æ ˆ å¯¹æˆ‘çš„ä¸ªäººçš„æ„è§å’Œå»ºè®® åç»­å­¦ä¹  åŸºç¡€çŸ¥è¯†ï¼š å¹¿åº¦ä¼˜å…ˆï¼Œ åœ¨å…´è¶£ç‚¹æ·±å…¥ ç¼–ç èƒ½åŠ›ï¼š LeetCodeï¼Œ Googleåœ¨çº¿å¹³å° é¢å‘å¯¹è±¡å’Œè®¾è®¡æ¨¡å¼ï¼š å°è¯•é‡æ„è‡ªå·±å†™è¿‡çš„ä»£ç  ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/11th_%E9%9D%A2%E8%AF%95%E8%BD%AF%E6%8A%80%E5%B7%A7%E5%92%8C%E6%80%BB%E7%BB%93/","summary":"é¢è¯•è½¯æŠ€å·§å’Œæ€»ç»“ è§£å†³é—®é¢˜çš„èƒ½åŠ› é¢å¯¹é—®é¢˜çš„æ€åº¦ åˆ†æé—®é¢˜çš„æ–¹æ³• ç»“æ„åŒ–åˆ†æé—®é¢˜ å‰”é™¤å¹²æ‰°é¡¹ æé—®é¢è¯•å®˜ ä»‹ç»ä¸€ä¸‹æ‰€åœ¨çš„é¡¹ç›®ç»„ ä»‹ç»ä¸€ä¸‹æ‰€ç”¨çš„æŠ€æœ¯æ ˆ å¯¹æˆ‘çš„ä¸ªäººçš„æ„è§å’Œå»ºè®® åç»­å­¦ä¹  åŸºç¡€çŸ¥è¯†ï¼š å¹¿åº¦ä¼˜å…ˆï¼Œ åœ¨å…´è¶£ç‚¹æ·±å…¥ ç¼–ç èƒ½åŠ›ï¼š LeetCodeï¼Œ Googleåœ¨çº¿å¹³å° é¢å‘å¯¹è±¡å’Œè®¾è®¡æ¨¡å¼ï¼š å°è¯•é‡æ„è‡ªå·±å†™è¿‡çš„ä»£ç  ","tags":null,"title":""},{"categories":null,"contents":"æ“ä½œç³»ç»Ÿ è¿›ç¨‹å’Œçº¿ç¨‹ è¿›ç¨‹ï¼š è¿›ç¨‹ä¸­çš„å†…å­˜æ˜¯é€»è¾‘å†…å­˜ï¼Œ æ‰€æœ‰è¿›ç¨‹çš„é€»è¾‘å†…å­˜ä¹‹å’Œè¦è¿œè¿œå¤§äºç‰©ç†å†…å­˜ã€‚ æ–‡ä»¶/ç½‘ç»œå¥æŸ„æ˜¯å…±äº«çš„ çº¿ç¨‹ TLSï¼š Thread Local Storage ç¼“å†²åŒºæº¢å‡º åç¨‹ è¿›ç¨‹ä¹‹é—´ä¸å¯ä»¥å…±äº«å†…å­˜ï¼Œ çº¿ç¨‹ä¹‹é—´å¯ä»¥å…±äº«å†…å­˜ è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼š ç®¡é“ï¼ŒTCP/IP æ¯”è¾ƒä¼˜åŠ£ çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼š å…±äº«å†…å­˜ å­˜å‚¨å’Œå¯»å€ å­˜å‚¨ å¯»å€ç©ºé—´ æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„ç‹¬ç«‹å¯»å€ç©ºé—´ è¿›ç¨‹ç‹¬ç«‹\n32ä½ -\u0026gt; 4G 64ä½ -\u0026gt; ~10^19Bytes 1wPB 64ä½JVM -\u0026gt; å¯ä»¥ä½¿ç”¨æ›´å¤§çš„å†…å­˜ï¼Œ32 -\u0026gt; éœ€è¦é‡æ–°ç¼–è¯‘ å¯»å€ int n= *p; -\u0026gt; MOV EAX,[EBX] æŠŠEBXå¯„å­˜å™¨ä¸­çš„æ•°æ®è¯»å‡ºï¼Œæ”¾å…¥EAX å¯„å­˜å™¨ã€‚n -\u0026gt; EAX, p -\u0026gt; EBX.\né€»è¾‘å†…å­˜çš„å¤§å°ä¸ç‰©ç†å†…å­˜æ²¡æœ‰å…³ç³»ï¼Œåªæœ‰æ“ä½œç³»ç»Ÿæœ‰å…³ã€‚ æ“ä½œç³»ç»Ÿçš„ä½æ•°å†³å®šé€»è¾‘å†…å­˜çš„ä½æ•°ã€‚ é€»è¾‘å†…å­˜æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œæ•°æ®ä¸ä¸€å®šåœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨è™šæ‹Ÿå†…å­˜ä¸­ã€‚ å½“æ•°æ®åœ¨è™šæ‹Ÿå†…å­˜ä¸­æ—¶å€™ï¼Œä¸æ˜¯åªæŠŠé€»è¾‘å†…å­˜å¯¹åº”çš„æ•°æ®åŠ è½½åˆ°ç‰©ç†å†…å­˜ï¼Œè€Œæ˜¯æŠŠæ•°æ®æ‰€åœ¨çš„åˆ†é¡µåŠ è½½åˆ°ç‰©ç†å†…å­˜ã€‚å¦‚æœç‰©ç†å†…å­˜æ”¾ä¸ä¸‹ï¼Œå°±äº¤æ¢ä¸€éƒ¨åˆ†æ•°æ®åˆ°è™šæ‹Ÿå†…å­˜ã€‚ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/2nd_%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","summary":"æ“ä½œç³»ç»Ÿ è¿›ç¨‹å’Œçº¿ç¨‹ è¿›ç¨‹ï¼š è¿›ç¨‹ä¸­çš„å†…å­˜æ˜¯é€»è¾‘å†…å­˜ï¼Œ æ‰€æœ‰è¿›ç¨‹çš„é€»è¾‘å†…å­˜ä¹‹å’Œè¦è¿œè¿œå¤§äºç‰©ç†å†…å­˜ã€‚ æ–‡ä»¶/ç½‘ç»œå¥æŸ„æ˜¯å…±äº«çš„ çº¿ç¨‹ TLSï¼š Thread Local Storage ç¼“å†²åŒºæº¢å‡º åç¨‹ è¿›ç¨‹ä¹‹é—´ä¸å¯ä»¥å…±äº«å†…å­˜ï¼Œ çº¿ç¨‹ä¹‹é—´å¯ä»¥å…±äº«å†…å­˜ è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼š ç®¡é“ï¼ŒTCP/IP æ¯”è¾ƒä¼˜åŠ£ çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼š å…±äº«å†…å­˜ å­˜å‚¨å’Œå¯»å€ å­˜å‚¨ å¯»å€ç©ºé—´ æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„ç‹¬ç«‹å¯»å€ç©ºé—´ è¿›ç¨‹ç‹¬ç«‹\n32ä½ -\u0026gt; 4G 64ä½ -\u0026gt; ~10^19Bytes 1wPB 64ä½JVM -\u0026gt; å¯ä»¥ä½¿ç”¨æ›´å¤§çš„å†…å­˜ï¼Œ32 -\u0026gt; éœ€è¦é‡æ–°ç¼–è¯‘ å¯»å€ int n= *p; -\u0026gt; MOV EAX,[EBX] æŠŠEBXå¯„å­˜å™¨ä¸­çš„æ•°æ®è¯»å‡ºï¼Œæ”¾å…¥EAX å¯„å­˜å™¨ã€‚n -\u0026gt; EAX, p -\u0026gt; EBX.\né€»è¾‘å†…å­˜çš„å¤§å°ä¸ç‰©ç†å†…å­˜æ²¡æœ‰å…³ç³»ï¼Œåªæœ‰æ“ä½œç³»ç»Ÿæœ‰å…³ã€‚ æ“ä½œç³»ç»Ÿçš„ä½æ•°å†³å®šé€»è¾‘å†…å­˜çš„ä½æ•°ã€‚ é€»è¾‘å†…å­˜æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œæ•°æ®ä¸ä¸€å®šåœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨è™šæ‹Ÿå†…å­˜ä¸­ã€‚ å½“æ•°æ®åœ¨è™šæ‹Ÿå†…å­˜ä¸­æ—¶å€™ï¼Œä¸æ˜¯åªæŠŠé€»è¾‘å†…å­˜å¯¹åº”çš„æ•°æ®åŠ è½½åˆ°ç‰©ç†å†…å­˜ï¼Œè€Œæ˜¯æŠŠæ•°æ®æ‰€åœ¨çš„åˆ†é¡µåŠ è½½åˆ°ç‰©ç†å†…å­˜ã€‚å¦‚æœç‰©ç†å†…å­˜æ”¾ä¸ä¸‹ï¼Œå°±äº¤æ¢ä¸€éƒ¨åˆ†æ•°æ®åˆ°è™šæ‹Ÿå†…å­˜ã€‚ ","tags":null,"title":""},{"categories":null,"contents":"ç½‘ç»œ ç½‘ç»œåŸºç¡€ ä¸å¯é  ä¸¢åŒ…ï¼Œé‡å¤åŒ… å‡ºé”™ ä¹±åº ä¸å®‰å…¨ ä¸­é—´äººæ”»å‡» çªƒå– ç¯¡æ”¹ æ»‘åŠ¨çª—å£ TCPåè®®ä¸­ä½¿ç”¨\nç»´æŒå‘é€æ–¹/æ¥æ”¶æ–¹ç¼“å†²åŒº\næµé‡æ§åˆ¶+æ‹¥å¡æ§åˆ¶ åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šè°ƒæ•´çª—å£çš„å¤§å° çª—å£çš„å¤§å°ä¸º0æ˜¯åˆæ³•çš„ï¼Œï¼ˆå¦‚æœæ¶ˆæ¯æ¥ä¸åŠå¤„ç†å¯ä»¥è®¾ç½®ä¸º0ï¼‰ ä¸ä½¿ç”¨æ»‘åŠ¨çª—å£çš„è¯ååé‡ä¼šéå¸¸ä½\næ»‘åŠ¨çª—å£çš„Ackæ˜¯æœ‰åºçš„ å¦‚æœä¸¢ACk ä¼šå¯åŠ¨è¶…æ—¶é‡ä¼ æœºåˆ¶ WireShark æŠ“åŒ… wireShark æŠ“åŒ…\nç½‘ç»œä¾‹é¢˜ ä¸€ä¸ªæ¥å›çš„æ—¶é—´ï¼š1500km/(2*10^5km/s) *2 = 0.015s æ¥å›çš„æ¬¡æ•°è‡³å¤šï¼š100s/0.015 = 6666.67æ¬¡\næ¯æ¬¡ä¼ è¾“è‡³å°‘ï¼š 100GB/6666.67 = 15M\næ•°æ®é“¾è·¯å±‚ ç½‘ç»œå±‚ ä¼ è¾“å±‚ TCP/UDP åº”ç”¨å±‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/3rd_%E7%BD%91%E7%BB%9C/","summary":"ç½‘ç»œ ç½‘ç»œåŸºç¡€ ä¸å¯é  ä¸¢åŒ…ï¼Œé‡å¤åŒ… å‡ºé”™ ä¹±åº ä¸å®‰å…¨ ä¸­é—´äººæ”»å‡» çªƒå– ç¯¡æ”¹ æ»‘åŠ¨çª—å£ TCPåè®®ä¸­ä½¿ç”¨\nç»´æŒå‘é€æ–¹/æ¥æ”¶æ–¹ç¼“å†²åŒº\næµé‡æ§åˆ¶+æ‹¥å¡æ§åˆ¶ åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šè°ƒæ•´çª—å£çš„å¤§å° çª—å£çš„å¤§å°ä¸º0æ˜¯åˆæ³•çš„ï¼Œï¼ˆå¦‚æœæ¶ˆæ¯æ¥ä¸åŠå¤„ç†å¯ä»¥è®¾ç½®ä¸º0ï¼‰ ä¸ä½¿ç”¨æ»‘åŠ¨çª—å£çš„è¯ååé‡ä¼šéå¸¸ä½\næ»‘åŠ¨çª—å£çš„Ackæ˜¯æœ‰åºçš„ å¦‚æœä¸¢ACk ä¼šå¯åŠ¨è¶…æ—¶é‡ä¼ æœºåˆ¶ WireShark æŠ“åŒ… wireShark æŠ“åŒ…\nç½‘ç»œä¾‹é¢˜ ä¸€ä¸ªæ¥å›çš„æ—¶é—´ï¼š1500km/(2*10^5km/s) *2 = 0.015s æ¥å›çš„æ¬¡æ•°è‡³å¤šï¼š100s/0.015 = 6666.67æ¬¡\næ¯æ¬¡ä¼ è¾“è‡³å°‘ï¼š 100GB/6666.67 = 15M\næ•°æ®é“¾è·¯å±‚ ç½‘ç»œå±‚ ä¼ è¾“å±‚ TCP/UDP åº”ç”¨å±‚","tags":null,"title":""},{"categories":null,"contents":"æ•°æ®åº“ å…³ç³»å‹æ•°æ®åº“ åŸºäºå…³ç³»ä»£æ•°ç†è®º ç¼ºç‚¹ï¼š è¡¨ç»“æ„ä¸ç›´è§‚ï¼Œå®ç°å¤æ‚é€Ÿï¼Œé€Ÿåº¦æ…¢ ä¼˜ç‚¹ï¼š å¥å£®æ€§é«˜ï¼Œç¤¾åŒºåºå¤§ Product\nproduct_id product_name category_id price 4 toyota 2 100000 3 prosche 2 1000000 2 addidas 2 500 1 nike 600 category\ncategory_id category_name 2 automobile 1 shoes 1select * from product join category; -- ç»“æœä¸ºç¬›å¡å°”ç§¯ 8æ¡è®°å½• 2 3select * from product p join category c on p.category_id=c.category_id; -- æŒ‰ç…§idç›¸ç­‰å»è¿æ¥ï¼Œ å¿½ç•¥id ä¸ºç©ºçš„è®°å½• å†…è¿æ¥ nullçš„æ•°æ®ä¸ä¼šæ˜¾ç¤º 4 5 6select * from product p left join category c on p.category_id=c.category_id; -- å·¦å¤–è¿æ¥ï¼Œ å·¦è¾¹ä¸ºä¸»è¡¨ 7 8 9select p.category_id,category_name ,count(1) as total from product p left join category c on p.category_id=c.category_id group by p.category_id; -- count èšåˆå‡½æ•° 10 11select p.category_id,category_name ,MIN(price) as total from product p left join category c on p.category_id=c.category_id group by p.category_id; -- min èšåˆå‡½æ•° 12 13 14select * from product p left join ( 15 select p.category_id,category_name ,MIN(price) as min_price 16 from product p left join category c 17 on p.category_id=c.category_id group by p.category_id) as cat_min 18on p.category_id = cat_min.category_id 19where p.price = cat_min.min_price; 20/* 21 è·å–æŸä¸ªå“ç±»ä¸­ä»·æ ¼æœ€ä½çš„å•†å“ 22 */ äº‹åŠ¡ ACID\nAtomicity åŸå­æ€§ Consistency ä¸€è‡´æ€§ Isolation ç‹¬ç«‹æ€§ Durability æŒä¹…æ€§ äº‹åŠ¡çš„éš”ç¦»çº§åˆ«\nRead Uncommited Read Committed Repeatable Read Serializable For Update å¯¹æŸ¥è¯¢çš„æ•°åŠ é” ## æ‚²è§‚é” ä¹è§‚é” ä½¿ç”¨ç‰ˆæœ¬æ ¡éªŒçš„æ–¹æ³•ä¿è¯äº‹åŠ¡çš„ç‹¬ç«‹æ€§ Sqlçš„è¿”å›å€¼æ˜¯å½±å“äº†å¤šå°‘è¡Œ\nè¯»å–æ•°æ®ï¼Œè®°å½•timestamp ä¿®æ”¹æ•°æ® æ£€æŸ¥å’Œæäº¤æ•°æ® æ•°æ®åº“ä¾‹é¢˜ å¯ä»¥ç”¨æ¥ç¨‹åºè°ƒä¼˜\næ”¹å–„æ•°æ®è®¿é—®æ–¹å¼ä»¥æé«˜ç¼“å­˜å‘½ä¸­ç‡ ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æ›¿ä»£ç›´æ¥çš„æ•°æ®åº“è®¿é—® ä½¿ç”¨è¿­ä»£æ¥ä»£æ›¿é€’å½’ åˆå¹¶å¤šä¸ªè¿œç¨‹è°ƒç”¨æ‰¹é‡å‘é€ å…±äº«å†—ä½™æ•°æ®æé«˜è®¿é—®æ•ˆç‡ï¼ˆä¸å¯å˜å¯¹è±¡ï¼‰ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/4th_%E6%95%B0%E6%8D%AE%E5%BA%93/","summary":"æ•°æ®åº“ å…³ç³»å‹æ•°æ®åº“ åŸºäºå…³ç³»ä»£æ•°ç†è®º ç¼ºç‚¹ï¼š è¡¨ç»“æ„ä¸ç›´è§‚ï¼Œå®ç°å¤æ‚é€Ÿï¼Œé€Ÿåº¦æ…¢ ä¼˜ç‚¹ï¼š å¥å£®æ€§é«˜ï¼Œç¤¾åŒºåºå¤§ Product\nproduct_id product_name category_id price 4 toyota 2 100000 3 prosche 2 1000000 2 addidas 2 500 1 nike 600 category\ncategory_id category_name 2 automobile 1 shoes 1select * from product join category; -- ç»“æœä¸ºç¬›å¡å°”ç§¯ 8æ¡è®°å½• 2 3select * from product p join category c on p.category_id=c.category_id; -- æŒ‰ç…§idç›¸ç­‰å»è¿æ¥ï¼Œ å¿½ç•¥id ä¸ºç©ºçš„è®°å½• å†…è¿æ¥ nullçš„æ•°æ®ä¸ä¼šæ˜¾ç¤º 4 5 6select * from product p left join category c on p.","tags":null,"title":""},{"categories":null,"contents":"ç¨‹åºè®¾è®¡è¯­è¨€åŸºç¡€ ç¨‹åºè®¾è®¡è¯­è¨€ ç±»å‹æ£€æŸ¥\nç¼–è¯‘æ—¶ï¼šC, C++, Java, Go è¿è¡Œæ—¶ï¼š Python, Perl, JavaScript, Ruby è¿è¡Œ/ç¼–è¯‘\nç¼–è¯‘ä¸ºæœºå™¨ä»£ç è¿è¡Œï¼šC, C++ ç¼–è¯‘ä¸ºä¸­é—´ä»£ç ï¼Œåœ¨è™šæ‹Ÿæœºè¿è¡Œï¼š Java, C# è§£é‡Šæ‰§è¡Œï¼š Python, Perl, JavaScript ç¼–ç¨‹èŒƒå¼ Programming Paradigm\né¢å‘è¿‡ç¨‹: C, Visual Basic é¢å‘å¯¹è±¡: Java, C++, C#, Scala å‡½æ•°å¼: Haskell, Erlang æ•°æ®ç±»å‹å’Œè¡¥ç  æ•°æ®ç±»å‹\nboolean, byte, char short, int, long, float, double String, Enum, Array Object\u0026hellip; è¡¥ç \n32ä½int èŒƒå›´ -2^31 ~ 2^31 -1 11000...0 -2^32 21111...1 -1 30000...0 0 40111...1 2^31-1 5 6-1 + 1 = 0 æµ®ç‚¹æ•°ä¸å®šç‚¹æ•° æµ®ç‚¹æ•° (+/-)1.XXXXXX * 2^y\nç¬¦å·ä½| æŒ‡æ•°éƒ¨åˆ† | åŸºæ•°éƒ¨åˆ† 64 ä½double èŒƒå›´ï¼š +/- 10^308 64 ä½double ç²¾åº¦ï¼š 10^15 15ä½æœ‰æ•ˆå°æ•°ä½ æµ®ç‚¹æ•°æ¯”è¾ƒ\na == b? Math.abs(a-b) \u0026lt; eps ä½¿ç”¨BigDecimal ç®—é’± å®šç‚¹æ•° Java æ‹†ç®±ä¸è£…ç®± Primitive type vs Object\nprimitive type: int, long å€¼ç±»å‹ï¼Œ å¯ä»¥ç”¨a = b å»åˆ¤æ–­ Object: Integer, Long, Float, String å¼•ç”¨ç±»å‹ï¼Œ a == b åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€ä¸ªObjectï¼Œ ç”¨a.equals(b) æˆ–è€… Object.equals(a,b)][a å¯ä»¥ä¸º null]åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰ã€‚ Boxing and Unboxing Integer a = 2; // Boxing Integet b = new Integer(2); // Boxing int v = a.intValue(); 1new Integer(2) ==2; // true è‡ªåŠ¨æ‹†ç®± 2new Integer(2) == new Integer(2); // false 3Integer.value(2) == Integer.value(2); // true ç³»ç»Ÿåˆ†é…çš„ç®±å­ IntegerCache.low IntegerCache.high (-128 127) 4Integer.value(2).intvalue() == 2; // true 5new Integer(2).equals(new Integer(2)) // true ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/5th_%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%9F%BA%E7%A1%80/","summary":"ç¨‹åºè®¾è®¡è¯­è¨€åŸºç¡€ ç¨‹åºè®¾è®¡è¯­è¨€ ç±»å‹æ£€æŸ¥\nç¼–è¯‘æ—¶ï¼šC, C++, Java, Go è¿è¡Œæ—¶ï¼š Python, Perl, JavaScript, Ruby è¿è¡Œ/ç¼–è¯‘\nç¼–è¯‘ä¸ºæœºå™¨ä»£ç è¿è¡Œï¼šC, C++ ç¼–è¯‘ä¸ºä¸­é—´ä»£ç ï¼Œåœ¨è™šæ‹Ÿæœºè¿è¡Œï¼š Java, C# è§£é‡Šæ‰§è¡Œï¼š Python, Perl, JavaScript ç¼–ç¨‹èŒƒå¼ Programming Paradigm\né¢å‘è¿‡ç¨‹: C, Visual Basic é¢å‘å¯¹è±¡: Java, C++, C#, Scala å‡½æ•°å¼: Haskell, Erlang æ•°æ®ç±»å‹å’Œè¡¥ç  æ•°æ®ç±»å‹\nboolean, byte, char short, int, long, float, double String, Enum, Array Object\u0026hellip; è¡¥ç \n32ä½int èŒƒå›´ -2^31 ~ 2^31 -1 11000...0 -2^32 21111...1 -1 30000...0 0 40111...1 2^31-1 5 6-1 + 1 = 0 æµ®ç‚¹æ•°ä¸å®šç‚¹æ•° æµ®ç‚¹æ•° (+/-)1.","tags":null,"title":""},{"categories":null,"contents":"ç¼–ç æŠ€å·§ ç¼–ç æŠ€å·§æ¦‚è¿° é€’å½’æ§åˆ¶ å¾ªç¯æ§åˆ¶ è¾¹ç•Œæ§åˆ¶ æ•°æ®ç»“æ„ å¥½çš„ä»£ç ï¼Œ ä»£ç çŸ­ï¼Œæ€è·¯æ¸…æ™°\nç™½æ¿ä¸Šå†™ç¨‹åº å…ˆæ€è€ƒåå†™ï¼Œ ä¸è¦æƒ§æ€•ä¿®æ”¹å’Œé‡å†™\næ•°å­¦å½’çº³æ³• ç”¨äºè¯æ˜æ–­è¨€å¯¹æ‰€æœ‰çš„è‡ªç„¶æ•°æˆç«‹\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/6th_%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7/","summary":"ç¼–ç æŠ€å·§ ç¼–ç æŠ€å·§æ¦‚è¿° é€’å½’æ§åˆ¶ å¾ªç¯æ§åˆ¶ è¾¹ç•Œæ§åˆ¶ æ•°æ®ç»“æ„ å¥½çš„ä»£ç ï¼Œ ä»£ç çŸ­ï¼Œæ€è·¯æ¸…æ™°\nç™½æ¿ä¸Šå†™ç¨‹åº å…ˆæ€è€ƒåå†™ï¼Œ ä¸è¦æƒ§æ€•ä¿®æ”¹å’Œé‡å†™\næ•°å­¦å½’çº³æ³• ç”¨äºè¯æ˜æ–­è¨€å¯¹æ‰€æœ‰çš„è‡ªç„¶æ•°æˆç«‹","tags":null,"title":""},{"categories":null,"contents":"é¢å‘å¯¹è±¡ é¢å‘å¯¹è±¡æ€æƒ³ ç±»ä¸å¯¹è±¡ æ¥å£ä¸å®ç° ç»§æ‰¿ä¸å°è£… ä¸å¯å˜å¯¹è±¡ æ³›å‹ ä»ç”¨æˆ·(ç»ˆç«¯ç”¨æˆ·ï¼Œä½¿ç”¨ä½ ä»£ç çš„ç”¨æˆ·)çš„è§’åº¦æ€è€ƒé—®é¢˜ æ‘’å¼ƒå®Œå…¨åŸºäºé€»è¾‘çš„æ€ç»´ ç±»ä¸å¯¹è±¡ ç±»çš„æˆå‘˜å˜é‡ -\u0026gt; å¯¹è±¡çŠ¶æ€\nç±»çš„æˆå‘˜å‡½æ•° -\u0026gt; å¯¹è±¡è¡Œä¸º\nç±»çš„é™æ€å˜é‡\nç±»çš„é™æ€å‡½æ•°\né€»è¾‘ç»“æ„ 1class Employee{ 2 void getPaid(BankEndPont bank){ 3 bank.payment(name, salary); // this 4 } 5} ç±»çš„é™æ€å˜é‡å’Œé™æ€å‡½æ•°\næ²¡æœ‰thiså¼•ç”¨ï¼Œ é‡‘æ³°å˜é‡å…¨å±€å”¯ä¸€ä¸€ä»½ æ™®é€šå‡½æ•°å¼•ç”¨é™æ€å˜é‡å’Œé™æ€å‡½æ•°ï¼Ÿ OK å¯¹è±¡å¼•ç”¨é™æ€å˜é‡, å‡½æ•°ï¼Ÿ ç¼–è¯‘å™¨è­¦å‘Š é™æ€å‡½æ•°å¼•ç”¨æ™®é€šæˆå‘˜å˜é‡ã€ å‡½æ•° ï¼Ÿ ç¼–è¯‘é”™è¯¯ å¯¹è±¡çš„ç‰¹æ®Šå‡½æ•° æ„é€ å‡½æ•° equals Object çš„equalsæ–¹æ³•é»˜è®¤åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€ä¸ªå¯¹è±¡ hashCode a.hashCode() == b.hashCode() \u0026laquo;\u0026ndash; a.equals(b) toString æ¥å£ä¸æŠ½è±¡ç±» ä¸ºä»€ä¹ˆè¦æœ‰æ¥å£çš„æ¦‚å¿µ\nä»ç”¨æˆ·(ä½¿ç”¨å®ç°çš„ä»£ç )çš„è§’åº¦çœ‹çœ‹é—®é¢˜ ç”±ç¼–è¯‘å™¨å¼ºåˆ¶çš„ä¸€ä¸ªæ¨¡å—é—´åä½œçš„åˆçº¦(Contarct)ï¼Œ å¼ºåˆ¶åä½œåŒæ–¹æ— æ³•çŠ¯é”™ æ— æˆå‘˜å˜é‡ æˆå‘˜å‡½æ•°åªæœ‰å£°æ˜ä¸èƒ½æœ‰å®ç° æ¥å£çš„å£°æ˜ Java : interface C++: ä¸€ä¸ªå…¨éƒ¨æ˜¯çº¯è™šå‡½æ•°çš„ç±» Python/ å¤§éƒ¨åˆ†åŠ¨æ€è¯­è¨€ï¼š ä¾é æ³¨é‡Šç”³æ˜ æŠ½è±¡ç±» è‡³å°‘æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œ æŠ½è±¡æ–¹æ³•æ²¡æœ‰å®ç°ï¼›\nä»å®ç°è§’åº¦çœ‹ æŠ½è±¡ç±»å¯ä»¥æœ‰æˆå‘˜å˜é‡ æŠ½è±¡ç±»å¯ä»¥æœ‰éƒ¨åˆ†å®ç° æŠ½è±¡ç±»ä¸å¯ä»¥å¤šé‡ç»§æ‰¿ï¼Œ æ¥å£å¯ä»¥ å®ç°Iterableæ¥å£ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/7th_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/","summary":"é¢å‘å¯¹è±¡ é¢å‘å¯¹è±¡æ€æƒ³ ç±»ä¸å¯¹è±¡ æ¥å£ä¸å®ç° ç»§æ‰¿ä¸å°è£… ä¸å¯å˜å¯¹è±¡ æ³›å‹ ä»ç”¨æˆ·(ç»ˆç«¯ç”¨æˆ·ï¼Œä½¿ç”¨ä½ ä»£ç çš„ç”¨æˆ·)çš„è§’åº¦æ€è€ƒé—®é¢˜ æ‘’å¼ƒå®Œå…¨åŸºäºé€»è¾‘çš„æ€ç»´ ç±»ä¸å¯¹è±¡ ç±»çš„æˆå‘˜å˜é‡ -\u0026gt; å¯¹è±¡çŠ¶æ€\nç±»çš„æˆå‘˜å‡½æ•° -\u0026gt; å¯¹è±¡è¡Œä¸º\nç±»çš„é™æ€å˜é‡\nç±»çš„é™æ€å‡½æ•°\né€»è¾‘ç»“æ„ 1class Employee{ 2 void getPaid(BankEndPont bank){ 3 bank.payment(name, salary); // this 4 } 5} ç±»çš„é™æ€å˜é‡å’Œé™æ€å‡½æ•°\næ²¡æœ‰thiså¼•ç”¨ï¼Œ é‡‘æ³°å˜é‡å…¨å±€å”¯ä¸€ä¸€ä»½ æ™®é€šå‡½æ•°å¼•ç”¨é™æ€å˜é‡å’Œé™æ€å‡½æ•°ï¼Ÿ OK å¯¹è±¡å¼•ç”¨é™æ€å˜é‡, å‡½æ•°ï¼Ÿ ç¼–è¯‘å™¨è­¦å‘Š é™æ€å‡½æ•°å¼•ç”¨æ™®é€šæˆå‘˜å˜é‡ã€ å‡½æ•° ï¼Ÿ ç¼–è¯‘é”™è¯¯ å¯¹è±¡çš„ç‰¹æ®Šå‡½æ•° æ„é€ å‡½æ•° equals Object çš„equalsæ–¹æ³•é»˜è®¤åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€ä¸ªå¯¹è±¡ hashCode a.hashCode() == b.hashCode() \u0026laquo;\u0026ndash; a.equals(b) toString æ¥å£ä¸æŠ½è±¡ç±» ä¸ºä»€ä¹ˆè¦æœ‰æ¥å£çš„æ¦‚å¿µ\nä»ç”¨æˆ·(ä½¿ç”¨å®ç°çš„ä»£ç )çš„è§’åº¦çœ‹çœ‹é—®é¢˜ ç”±ç¼–è¯‘å™¨å¼ºåˆ¶çš„ä¸€ä¸ªæ¨¡å—é—´åä½œçš„åˆçº¦(Contarct)ï¼Œ å¼ºåˆ¶åä½œåŒæ–¹æ— æ³•çŠ¯é”™ æ— æˆå‘˜å˜é‡ æˆå‘˜å‡½æ•°åªæœ‰å£°æ˜ä¸èƒ½æœ‰å®ç° æ¥å£çš„å£°æ˜ Java : interface C++: ä¸€ä¸ªå…¨éƒ¨æ˜¯çº¯è™šå‡½æ•°çš„ç±» Python/ å¤§éƒ¨åˆ†åŠ¨æ€è¯­è¨€ï¼š ä¾é æ³¨é‡Šç”³æ˜ æŠ½è±¡ç±» è‡³å°‘æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œ æŠ½è±¡æ–¹æ³•æ²¡æœ‰å®ç°ï¼›","tags":null,"title":""},{"categories":null,"contents":"ç¬¬8è®² è®¾è®¡æ¨¡å¼ 1. å•ä¾‹æ¨¡å¼ Singleton è®¾è®¡æ¨¡å¼çš„æå‡ºï¼šåšå£«è®ºæ–‡ è®¾è®¡ vs è¯­è¨€é™åˆ¶ æ›´å¤šçš„æ¨¡å¼ï¼š å¹¶å‘æ¨¡å¼ã€æ¶æ„æ¨¡å¼ ä»æ¶æ„çš„æ€æƒ³ä¸Šçœ‹\nSingletonä¼˜ç¼ºç‚¹ ç¡®ä¿å…¨å±€è‡³å¤šåªæœ‰ä¸€ä¸ªå¯¹è±¡ ç”¨äºï¼š æ„é€ ç¼“æ…¢çš„å¯¹è±¡ï¼Œéœ€è¦ç»Ÿä¸€ç®¡ç†çš„èµ„æº ç¼ºç‚¹ï¼š å¾ˆå¤šå…¨å±€çŠ¶æ€ï¼Œ çº¿ç¨‹å®‰å…¨æ€§ Singletonçš„åˆ›å»ºï¼ˆåˆ›å»ºéå¸¸æ…¢çš„å¯¹è±¡ï¼‰ åŒé‡é”æ¨¡å¼ Double checked locking ä½œä¸ºJava ç±»çš„é™æ€å˜é‡ï¼ˆç¨‹åºåˆå§‹åŒ–çš„æ—¶å€™å°±è¦åˆ›å»ºå‡ºæ¥ï¼‰ ä½¿ç”¨æ¡†æ¶æä¾›çš„èƒ½åŠ› ä¾èµ–æ³¨å…¥çš„æ¡†æ¶ï¼ˆDIæ¡†æ¶ Spring, Google Juiceï¼‰\n2. State æ¨¡å¼ å˜ç»§æ‰¿å…³ç³»ä¸ºç»„åˆå…³ç³» ç»§æ‰¿å…³ç³» æè¿°is-aå…³ç³» å¤ç”¨ï¼Œå¢åŠ ä¿®æ”¹ ä¸ç”¨ç”¨ç»§æ‰¿å…³ç³»æ¥å®ç°å¤ç”¨ ä½¿ç”¨è®¾è®¡æ¨¡å¼å®ç°å¤ç”¨ å¦‚æœ Employee å‡çº§æˆäº† Manager ï¼Ÿ æ–°å»ºæˆä¸€ä¸ªManager, åŸå…ˆçš„å¼•ç”¨åº”è¯¥è¢«å›æ”¶ã€‚\næˆ–è€…ä½¿ç”¨stateæ¨¡å¼\n3. Decoratoræ¨¡å¼ è£…é¥°è€…æ¨¡å¼ 1interface Runable{ 2 void run(); 3} å¦‚ä½•å®ç°LoggingRunable, TransactionRunable, \u0026hellip;.\nå¼€å§‹è¿è¡Œï¼Œè¿è¡Œç»“æŸï¼Œè¿è¡ŒæŒç»­æ˜¯æ—¶é—´\ncommitï¼Œ roll back\n4. å¦‚ä½•åˆ›å»ºå¯¹è±¡ ç¼–è¯‘æ—¶å°±è¦ç¡®å®šæ˜¯åˆ›å»ºå“ªä¸€ä¸ªå¯¹è±¡ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/8th_%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","summary":"ç¬¬8è®² è®¾è®¡æ¨¡å¼ 1. å•ä¾‹æ¨¡å¼ Singleton è®¾è®¡æ¨¡å¼çš„æå‡ºï¼šåšå£«è®ºæ–‡ è®¾è®¡ vs è¯­è¨€é™åˆ¶ æ›´å¤šçš„æ¨¡å¼ï¼š å¹¶å‘æ¨¡å¼ã€æ¶æ„æ¨¡å¼ ä»æ¶æ„çš„æ€æƒ³ä¸Šçœ‹\nSingletonä¼˜ç¼ºç‚¹ ç¡®ä¿å…¨å±€è‡³å¤šåªæœ‰ä¸€ä¸ªå¯¹è±¡ ç”¨äºï¼š æ„é€ ç¼“æ…¢çš„å¯¹è±¡ï¼Œéœ€è¦ç»Ÿä¸€ç®¡ç†çš„èµ„æº ç¼ºç‚¹ï¼š å¾ˆå¤šå…¨å±€çŠ¶æ€ï¼Œ çº¿ç¨‹å®‰å…¨æ€§ Singletonçš„åˆ›å»ºï¼ˆåˆ›å»ºéå¸¸æ…¢çš„å¯¹è±¡ï¼‰ åŒé‡é”æ¨¡å¼ Double checked locking ä½œä¸ºJava ç±»çš„é™æ€å˜é‡ï¼ˆç¨‹åºåˆå§‹åŒ–çš„æ—¶å€™å°±è¦åˆ›å»ºå‡ºæ¥ï¼‰ ä½¿ç”¨æ¡†æ¶æä¾›çš„èƒ½åŠ› ä¾èµ–æ³¨å…¥çš„æ¡†æ¶ï¼ˆDIæ¡†æ¶ Spring, Google Juiceï¼‰\n2. State æ¨¡å¼ å˜ç»§æ‰¿å…³ç³»ä¸ºç»„åˆå…³ç³» ç»§æ‰¿å…³ç³» æè¿°is-aå…³ç³» å¤ç”¨ï¼Œå¢åŠ ä¿®æ”¹ ä¸ç”¨ç”¨ç»§æ‰¿å…³ç³»æ¥å®ç°å¤ç”¨ ä½¿ç”¨è®¾è®¡æ¨¡å¼å®ç°å¤ç”¨ å¦‚æœ Employee å‡çº§æˆäº† Manager ï¼Ÿ æ–°å»ºæˆä¸€ä¸ªManager, åŸå…ˆçš„å¼•ç”¨åº”è¯¥è¢«å›æ”¶ã€‚\næˆ–è€…ä½¿ç”¨stateæ¨¡å¼\n3. Decoratoræ¨¡å¼ è£…é¥°è€…æ¨¡å¼ 1interface Runable{ 2 void run(); 3} å¦‚ä½•å®ç°LoggingRunable, TransactionRunable, \u0026hellip;.\nå¼€å§‹è¿è¡Œï¼Œè¿è¡Œç»“æŸï¼Œè¿è¡ŒæŒç»­æ˜¯æ—¶é—´\ncommitï¼Œ roll back\n4. å¦‚ä½•åˆ›å»ºå¯¹è±¡ ç¼–è¯‘æ—¶å°±è¦ç¡®å®šæ˜¯åˆ›å»ºå“ªä¸€ä¸ªå¯¹è±¡ ","tags":null,"title":""},{"categories":null,"contents":"é«˜çº§çŸ¥è¯†ç‚¹ 1. å¹¶è¡Œè®¡ç®— å°†æ•°æ®æ‹†åˆ†åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸Š -\u0026gt; å¦‚ä½•æ‹†åˆ† æ¯ä¸ªèŠ‚ç‚¹å¹¶è¡Œçš„ç»™å‡ºè®¡ç®—ç»“æœ -\u0026gt; ä¸­é—´ç»“æœ å°†ç»“æœæ±‡æ€» -\u0026gt; å¦‚ä½•æ±‡æ€» 2. å¤–éƒ¨æ’åºåˆ†æ å¦‚ä½•æ’åº100Gä¸ªå…ƒç´ ï¼Ÿ\nåªèƒ½æœ‰ä¸€éƒ¨åˆ†æ•°æ®æ”¾åˆ°å†…å­˜\nå½’å¹¶æ’åº å°†æ•°æ®åˆ†ä¸ºå·¦å³ä¸¤åŠï¼Œåˆ†åˆ«å½’å¹¶æ’åºï¼Œå†æŠŠä¸¤ä¸ªæœ‰åºæ•°æ®å½’å¹¶ å¦‚ä½•å½’å¹¶ å½’å¹¶èŠ‚ç‚¹çš„æ’åº\u0026ndash; Kè·¯å½’å¹¶ ä½¿ç”¨å †å®ç° Priority Queue **ä½¿ç”¨Iterable æ¥å£ **\nä¸æ–­è·å–ä¸‹ä¸€ä¸ªå…ƒç´  å…ƒç´ å­˜å‚¨/è·å–æ–¹æ³•è¢«æŠ½è±¡, ä¸å½’å¹¶èŠ‚ç‚¹æ— å…³ Iterable merge(List\u0026lt; Iterable\u0026gt; sortData); 3. æ­»é”åˆ†æ å¤šçº¿ç¨‹ çº¿ç¨‹å®‰å…¨ åŠ é”ï¼Œ é”çš„ç²’åº¦ï¼Œæ€§èƒ½\næ­»é”åˆ†æ 1void transfer(Account form, Account to, int amount){ 2 synchronized(form){ 3 synchronized(to){ 4 from.setAmount(for.getAmount() - amount); 5 to.setAmount(to.getAmount() + amount) 6 } 7 } 8} synchronized(form) -\u0026gt; åˆ«çš„çº¿ç¨‹åœ¨ç­‰å¾…from\nsynchronized(to) -\u0026gt; åˆ«çš„çº¿ç¨‹å·²ç»é”ä½äº†to\nå¯èƒ½å‡ºç°æ­»é”ï¼štransfer(a,b,100) å’Œ transfer(b,a,100)åŒæ—¶è¿›è¡Œ\nåœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ï¼Œç”šè‡³åœ¨ä¸€å¥è¯­å¥ä¸­é—´ è¦å°½åŠ›è®¾æƒ³å¯¹è‡ªå·±æœ€ä¸åˆ©çš„æƒ…å†µ æ­»é”æ¡ä»¶ï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³ äº’æ–¥ç­‰å¾… æ²¡æœ‰é”çš„å¿…é¡»ç­‰é” hold and wait æ‹¿åˆ°ä¸€ä¸ªé”å»ç­‰å¾…å¦ä¸€ä¸ªé” å¾ªç¯ç­‰å¾… æ‹¿aç­‰b æ‹¿bç­‰a æ— æ³•å‰¥å¤ºçš„ç­‰å¾… æ­»é”é˜²æ­¢ ç ´é™¤äº’æ–¥ç­‰å¾… -\u0026gt; ä¸€èˆ¬æ— æ³•ç ´é™¤ ç ´é™¤ hold and wait -\u0026gt; ä¸€æ¬¡æ€§è·å–æ‰€æœ‰èµ„æºï¼Œå¤§å¤šæ•°è¯­è¨€ä¸æ”¯æŒ å¯ä»¥ä½¿ç”¨è¶…æ—¶é‡Šæ”¾ ç ´é™¤ å¾ªç¯ç­‰å¾… -\u0026gt; æŒ‰é¡ºåºè·å–èµ„æº ç ´é™¤ æ— æ³•å‰¥å¤ºçš„ç­‰å¾… -\u0026gt; ä¸å¾—å·²çš„åŠæ³•ï¼ŒåŠ å…¥è¶…æ—¶ 4. çº¿ç¨‹æ± ä»‹ç» çº¿ç¨‹æ±  åˆ›å»ºçº¿ç¨‹å¼€é”€å¤§ çº¿ç¨‹æ± ï¼š é¢„å…ˆå»ºç«‹å¥½çº¿ç¨‹ï¼Œç­‰å¾…ä»»åŠ¡çš„æ´¾å‘ å¦‚æœBlocking Queueçš„é˜Ÿåˆ—ä¸ºç©ºï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½ä¼šè¢«blockï¼› å¦‚æœæœ‰ä»»åŠ¡è¿›æ¥ï¼Œçº¿ç¨‹å°±ä¼šæŠ¢ä»»åŠ¡è¿›è¡Œå¤„ç†ï¼› å¦‚æœæ‰€æœ‰çš„çº¿ç¨‹éƒ½åœ¨å¤„ç†ä»»åŠ¡ï¼Œå¤šä½™çš„ä»»åŠ¡å°±ä¼šåœ¨Blocking Queueä¸­æ’é˜Ÿï¼› å¦‚æœBlocking Queueä¸­çš„ä¹Ÿæ»¡äº†ä¹‹åï¼Œåº”è¯¥é‡‡å–ä¸€å®šçš„æ‹’ç»ç­–ç•¥ï¼›\nçº¿ç¨‹æ± çš„å‚æ•° corePoolSize: çº¿ç¨‹æ± ä¸­åˆå§‹çº¿ç¨‹çš„æ•°é‡ï¼Œå¯èƒ½å¤„äºç­‰å¾…çŠ¶æ€ maximumPoolSize: çº¿ç¨‹æ± ä¸­æœ€å¤§å…è®¸çº¿ç¨‹æ•°é‡ keepAliveTime: è¶…å‡ºcorePoolSizeéƒ¨åˆ†çº¿ç¨‹å¦‚æœç­‰å¾…è¿™äº›æ—¶é—´å°†è¢«å›æ”¶\n5. çº¿ç¨‹æ±  Java executor FrameWork çº¿ç¨‹æ± çš„åˆ›å»º ä»»åŠ¡æ´¾å‘ åˆ©ç”¨Futureæ£€æŸ¥ä»»åŠ¡ç»“æœ çº¿ç¨‹æ•°ä¸º30æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªæ•°å­—\n1public class ExecutorTester { 2 3 public static void main(String[] args) 4 throws InterruptedException, ExecutionException { 5 ExecutorService executor = Executors.newFixedThreadPool(3); 6 7 List\u0026lt;Future\u0026lt;?\u0026gt;\u0026gt; taskResults = new LinkedList\u0026lt;\u0026gt;(); 8 for (int i = 0; i \u0026lt; 10; i++) { 9 taskResults.add(executor.submit(new CodingTask(i))); 10 } 11 System.out.println(\u0026#34;10 tasks dispatched successfully.\u0026#34;); 12 13 for (Future\u0026lt;?\u0026gt; taskResult : taskResults) { 14 taskResult.get(); 15 } 16 17 System.out.println(\u0026#34;All tasks finished.\u0026#34;); 18 executor.shutdown(); 19 } 20} 6. èµ„æºç®¡ç† Java åƒåœ¾å›æ”¶ ä¸è¢«å¼•ç”¨çš„å¯¹è±¡ä¼šè¢«å›æ”¶ ç¯å½¢å¼•ç”¨ä¹Ÿä¼šè¢«å›æ”¶æ‰ åƒåœ¾å›æ”¶åŒ…æ‹¬ Minor GC å’Œ Full GC åƒåœ¾å›æ”¶æ—¶æ‰€æœ‰è¿è¡Œæš‚åœ å†…å­˜æ³„éœ²ï¼Œ å¯¹è±¡åˆ›å»ºå¤ªå¤šå¤ªå¿«ä¹Ÿä¼šè§¦å‘GC\nJava èµ„æºç®¡ç† æ•°æ®åº“çš„è¿æ¥\nå†…å­˜ä¼šè¢«å›æ”¶ï¼Œ èµ„æºä¸ä¼šé‡Šæ”¾ databaseConnectionéœ€è¦databaseConnection.close()æ¥é‡Šæ”¾ æ—§å†™æ³•\n1try{ 2 Database databaseConnection = connect(...); 3 databaseConnection.beginTransaction(); 4 // do work 5}catch(Exception e){ 6 databaseConnection.rollBack(); 7}finally{ 8 databaseConnection.close(); // å…³é—­è¿æ¥æ—¶å€™ä¹Ÿæœ‰å¯èƒ½å‡ºç°å¼‚å¸¸ 9} æ–°å†™æ³• Java 1.7ä»¥å\n1try(Database databaseConnection = connect(...)){ 2 databaseConnection.beginTransaction(); 3 // do work 4}catch(Exception e){ 5 databaseConnection.rollBack(); 6} C++ èµ„æºç®¡ç† C++ æ²¡æœ‰finally, æ²¡æœ‰try with resource C++ æœ‰ææ„å‡½æ•° 1void dowork(){ 2 Database databaseConnection(); 3 try{ 4 databaseConnection.beginTransaction(); 5 // do work 6 }catch(Exception\u0026amp;e){ 7 databaseConnection.rollback(); 8 } 9} 10 11Database::~Database(){ 12 // close databaseConnection; 13} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_Google%E8%AE%B2Java/9th_%E9%AB%98%E7%BA%A7%E7%9F%A5%E8%AF%86%E7%82%B9/","summary":"é«˜çº§çŸ¥è¯†ç‚¹ 1. å¹¶è¡Œè®¡ç®— å°†æ•°æ®æ‹†åˆ†åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸Š -\u0026gt; å¦‚ä½•æ‹†åˆ† æ¯ä¸ªèŠ‚ç‚¹å¹¶è¡Œçš„ç»™å‡ºè®¡ç®—ç»“æœ -\u0026gt; ä¸­é—´ç»“æœ å°†ç»“æœæ±‡æ€» -\u0026gt; å¦‚ä½•æ±‡æ€» 2. å¤–éƒ¨æ’åºåˆ†æ å¦‚ä½•æ’åº100Gä¸ªå…ƒç´ ï¼Ÿ\nåªèƒ½æœ‰ä¸€éƒ¨åˆ†æ•°æ®æ”¾åˆ°å†…å­˜\nå½’å¹¶æ’åº å°†æ•°æ®åˆ†ä¸ºå·¦å³ä¸¤åŠï¼Œåˆ†åˆ«å½’å¹¶æ’åºï¼Œå†æŠŠä¸¤ä¸ªæœ‰åºæ•°æ®å½’å¹¶ å¦‚ä½•å½’å¹¶ å½’å¹¶èŠ‚ç‚¹çš„æ’åº\u0026ndash; Kè·¯å½’å¹¶ ä½¿ç”¨å †å®ç° Priority Queue **ä½¿ç”¨Iterable æ¥å£ **\nä¸æ–­è·å–ä¸‹ä¸€ä¸ªå…ƒç´  å…ƒç´ å­˜å‚¨/è·å–æ–¹æ³•è¢«æŠ½è±¡, ä¸å½’å¹¶èŠ‚ç‚¹æ— å…³ Iterable merge(List\u0026lt; Iterable\u0026gt; sortData); 3. æ­»é”åˆ†æ å¤šçº¿ç¨‹ çº¿ç¨‹å®‰å…¨ åŠ é”ï¼Œ é”çš„ç²’åº¦ï¼Œæ€§èƒ½\næ­»é”åˆ†æ 1void transfer(Account form, Account to, int amount){ 2 synchronized(form){ 3 synchronized(to){ 4 from.setAmount(for.getAmount() - amount); 5 to.setAmount(to.getAmount() + amount) 6 } 7 } 8} synchronized(form) -\u0026gt; åˆ«çš„çº¿ç¨‹åœ¨ç­‰å¾…from\nsynchronized(to) -\u0026gt; åˆ«çš„çº¿ç¨‹å·²ç»é”ä½äº†to","tags":null,"title":""},{"categories":null,"contents":"imooc_React16 å¿«é€Ÿä¸Šæ‰‹ å®ç°TodoList reactç®€ä»‹ä»¥åŠè¯­æ³•åŸºç¡€ react Fiber // React 16 ä¹‹åçš„ç‰ˆæœ¬å¯¹åº”çš„æ¡†æ¶\nredux\nreact ç¯å¢ƒæ­å»º\nReact è„šæ‰‹æ¶å·¥å…· create-react-app\n1npx create-react-app todolist # create-react-app 2cd todolist 3yarn start # npm run start ä»€ä¹ˆæ˜¯ç»„ä»¶ component\nç®€å•çš„jsxè¯­æ³• é¡¹ç›®ä»£ç  1â”œâ”€â”€ src 2â”‚ â”œâ”€â”€ TodoItem.js 3â”‚ â”œâ”€â”€ TodoList.js 4â”‚ â”œâ”€â”€ index.js 5â”‚ â”œâ”€â”€ serviceWorker.js 6â”‚ â””â”€â”€ style.css Index.js Index.js æ˜¯é¡¹ç›®çš„å…¥å£\n1import React from \u0026#39;react\u0026#39;; 2import ReactDOM from \u0026#39;react-dom\u0026#39;; 3import \u0026#39;./style.css\u0026#39;; 4// ç»„ä»¶ï¼Œå¤§å†™å­—æ¯å¼€å¤´ s 5import TodoList from \u0026#39;./TodoList\u0026#39;; 6 7 8ReactDOM.render(\u0026lt;TodoList /\u0026gt;, document.getElementById(\u0026#39;root\u0026#39;)); æ‰€æœ‰çš„ç»„ä»¶éƒ½æ˜¯å¤§å†™å­—æ¯å¼€å¤´çš„ï¼Œ å¼•å…¥Reactæ˜¯ä¸ºäº†è¯†åˆ«å¤§å†™å­—æ¯å¼€å¤´çš„ç»„ä»¶\nTodoList.js ç»„ä»¶, ES6è¯­æ³•è§„èŒƒä¸‹çš„ä¸€äº›æ–°çš„å†™æ³•\n1import React, {Component, Fragment}from \u0026#39;react\u0026#39;; 2import TodoItem from \u0026#39;./TodoItem\u0026#39;; 3 4// ç»„ä»¶éœ€è¦ç»§æ‰¿ React.Component, æ‰èƒ½å…·æœ‰ç»„ä»¶çš„æ–¹æ³•ä»¥åŠç”Ÿå‘½å‘¨æœŸ 5class TodoList extends Component { 6 7 // constructor(props){ 8 // super(props); 9 // this.state={ 10 // list:[ 11 // \u0026#39;learn react\u0026#39;, 12 // \u0026#39;learn english\u0026#39; 13 // ] 14 // } 15 //this.handleDelete=this.handleDelete.bind(this) 16 // } 17 18 state = { 19 list: [], 20 inputValue: \u0026#39;\u0026#39; 21 } 22 23 handleAdd=()=\u0026gt; { 24 // this.state.list.push(\u0026#34;hello world\u0026#34;) è¿™æ ·å†™æ˜¯ä¸å·¥ä½œçš„ 25 this.setState({ 26 list: [...this.state.list, this.state.inputValue], 27 inputValue: \u0026#39;\u0026#39; 28 }) 29 30 console.log(\u0026#34;add new item: \u0026#34; + this.state.list) 31 } 32 33 handleInputChange(e) { 34 this.setState({ 35 inputValue: e.target.value 36 }) 37 } 38 39 handleDelete(index) { 40 // å¦‚æœè¦å¯¹state ä¸­çš„æ•°æ®è¿›è¡Œæ“ä½œï¼Œæœ€å¥½é€šè¿‡å‰¯æœ¬å»æ“ä½œ 41 const list = [...this.state.list] 42 list.splice(index,1) 43 // this.setState({ 44 // list:list 45 // }) 46 this.setState({list}) 47 } 48 49 getItems(){ 50 return( 51 this.state.list.map((item, index) =\u0026gt; { 52 return \u0026lt;TodoItem key={index} 53 handleDelete={this.handleDelete.bind(this)} 54 content={item} 55 index={index}/\u0026gt; 56 }) 57 ) 58 } 59 60 render() { 61 // jsx è¯­æ³• 62 // çˆ¶ç»„ä»¶é€šè¿‡å±æ€§çš„æ–¹å¼å‘å­ç»„ä»¶ä¼ é€’å‚æ•° 63 // å­ç»„ä»¶é€šè¿‡propsçš„æ–¹å¼æ¥å—çˆ¶ç»„ä»¶ä¼ é€’çš„å‚æ•° 64 return ( 65 \u0026lt;Fragment\u0026gt; 66 \u0026lt;div\u0026gt; 67 \u0026lt;input value={this.state.inputValue} onChange={this.handleInputChange.bind(this)}\u0026gt;\u0026lt;/input\u0026gt; 68 {/* \u0026lt;button style={{background:\u0026#39;red\u0026#39;, color:\u0026#39;#fff\u0026#39;}} onClick={this.handleAdd.bind(this)} \u0026gt;add\u0026lt;/button\u0026gt; */} 69 \u0026lt;button className=\u0026#39;red-btn\u0026#39; onClick={this.handleAdd} \u0026gt;add\u0026lt;/button\u0026gt; 70 \u0026lt;/div\u0026gt; 71 \u0026lt;ul\u0026gt; 72 { 73 // this.state.list.map((item, index) =\u0026gt; { 74 // return \u0026lt;TodoItem key={index} 75 // handleDelete={this.handleDelete.bind(this)} 76 // content={item} 77 // index={index}/\u0026gt; 78 // // return \u0026lt;li onClick={this.handleDelete.bind(this, index)} key={index}\u0026gt;{item}\u0026lt;/li\u0026gt; 79 // }) 80 this.getItems() 81 } 82 \u0026lt;/ul\u0026gt; 83 \u0026lt;/Fragment\u0026gt; 84 ); 85 } 86} 87 88export default TodoList; TodoItem.js 1import React from \u0026#39;react\u0026#39; 2 3class TodoItem extends React.Component{ 4 // å­ç»„ä»¶å¦‚æœè¦å’Œçˆ¶ç»„ä»¶é€šä¿¡è¦è°ƒç”¨çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ–¹æ³•å®ç°ä¼ å€¼ 5 handleDelete(){ 6 // å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ å€¼ 7 this.props.handleDelete(this.props.index) 8 console.log(this.props.index) 9 } 10 11 render(){ 12 const {content} = this.props; 13 return( 14 \u0026lt;div onClick={this.handleDelete.bind(this)}\u0026gt; 15 {/* {this.props.content} */} 16 {content} 17 \u0026lt;/div\u0026gt; 18 ) 19 } 20} 21 22export default TodoItem; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/Imooc_react16.4%E5%8F%8A%E5%85%B6%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/","summary":"imooc_React16 å¿«é€Ÿä¸Šæ‰‹ å®ç°TodoList reactç®€ä»‹ä»¥åŠè¯­æ³•åŸºç¡€ react Fiber // React 16 ä¹‹åçš„ç‰ˆæœ¬å¯¹åº”çš„æ¡†æ¶\nredux\nreact ç¯å¢ƒæ­å»º\nReact è„šæ‰‹æ¶å·¥å…· create-react-app\n1npx create-react-app todolist # create-react-app 2cd todolist 3yarn start # npm run start ä»€ä¹ˆæ˜¯ç»„ä»¶ component\nç®€å•çš„jsxè¯­æ³• é¡¹ç›®ä»£ç  1â”œâ”€â”€ src 2â”‚ â”œâ”€â”€ TodoItem.js 3â”‚ â”œâ”€â”€ TodoList.js 4â”‚ â”œâ”€â”€ index.js 5â”‚ â”œâ”€â”€ serviceWorker.js 6â”‚ â””â”€â”€ style.css Index.js Index.js æ˜¯é¡¹ç›®çš„å…¥å£\n1import React from \u0026#39;react\u0026#39;; 2import ReactDOM from \u0026#39;react-dom\u0026#39;; 3import \u0026#39;./style.css\u0026#39;; 4// ç»„ä»¶ï¼Œå¤§å†™å­—æ¯å¼€å¤´ s 5import TodoList from \u0026#39;./TodoList\u0026#39;; 6 7 8ReactDOM.","tags":null,"title":""},{"categories":null,"contents":"3rd_æ•°æ®åº“æ¶æ„ 5th_Linux ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/0_Category/","summary":"3rd_æ•°æ®åº“æ¶æ„ 5th_Linux ","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/10th_Java%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E4%B8%8E%E6%8A%80%E5%B7%A7/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/11th_Java%E6%A1%86%E6%9E%B6Spring/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/12th_%E8%AF%BE%E7%A8%8B%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/1st_%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/","summary":"","tags":null,"title":""},{"categories":null,"contents":"è®¡ç®—æœºç½‘ç»œé¢è¯•æ ¸å¿ƒ 7. HTTP ç®€ä»‹ è¶…æ–‡æœ¬ä¼ è¾“åè®®çš„ä¸»è¦ç‰¹ç‚¹ æ˜¯åº”ç”¨å±‚çš„è¯·æ±‚å“åº”çš„æ— çŠ¶æ€åè®®\næ”¯æŒå®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼ ï¼š æµè§ˆå™¨é€šè¿‡urlå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œ æœåŠ¡ç«¯è¿”å›å“åº”ä¿¡æ¯ ç®€å•å¿«é€Ÿ ï¼š è¯·æ±‚æ–¹æ³• get post delete é€šè®¯é€Ÿåº¦å¿« çµæ´»ï¼š æ•°æ®æ ¼å¼çµæ´»ï¼Œå…è®¸ä»»æ„æ ¼å¼çš„æ•°æ®ç±»å‹ æ— è¿æ¥ï¼š æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œæ”¶åˆ°åº”ç­”ä¹‹åå°±æ–­å¼€è¿æ¥ ï¼Œ 1.1 ä¹‹åä½¿ç”¨äº†é•¿è¿æ¥ ä¸‹å±‚å®ç°å¯¹ä¸Šå±‚é€æ˜ï¼Œ keep alive æ— çŠ¶æ€ï¼š å¯¹äº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼Œç¼ºå°‘çŠ¶æ€ï¼Œ version 1.1 å¼•å…¥äº† keep alive æŒç»­è¿æ¥æœºåˆ¶ 2.0 å‡çº§æˆæœ¬å¤ªå¤§ HTTP è¯·æ±‚ç»“æ„ HTTPè¯·æ±‚æŠ¥æ–‡ç»“æ„\n1GET /baidu/com HTTP1.1 2 Host: www.baidu.com 3 Connection:keep-alive # close 1.1ä¹‹å‰ 4 User-Agentï¼š Mozilla/5.0 5 Accept-Encoding 6Cookie: XXX HTTPå“åº”ç»“æ„ 1HTTP 1.1 200 OK 2\tServer: 3\tAccept-Ranges: 4\tContent-Type: 5\tContent-Languge: 6\tContent-Length: 7\tDate: è¯·æ±‚/å“åº”æ­¥éª¤ å®¢æˆ·ç«¯è¿æ¥åˆ°WEBæœåŠ¡å™¨ å‘é€HTTPè¯·æ±‚ æœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶è¿”å›HTTPå“åº” é‡Šæ”¾TCPè¿æ¥ï¼š æœåŠ¡å™¨ä¸»åŠ¨å…³é—­TCPè¿æ¥ï¼Œæµè§ˆå™¨è¢«åŠ¨é‡Šæ”¾TCPè¿æ¥ å®¢æˆ·ç«¯æµè§ˆå™¨è§£æHTMLå†…å®¹ åœ¨æµè§ˆå™¨åœ°å€é”®å…¥http å¼€å¤´çš„urlï¼ŒæŒ‰ä¸‹å›è½¦ä¹‹åç»å†çš„æµç¨‹ DNSè§£æ ï¼šé€å±‚æŸ¥è¯¢è·¯ç”±å™¨ä¸­çš„DNSç¼“å­˜ï¼Œæµè§ˆå™¨-ç³»ç»Ÿ-è·¯ç”±å™¨-IPSæœåŠ¡å™¨-æ ¹åŸŸåæœåŠ¡å™¨ç¼“å­˜-é¡¶çº§åŸŸåæœåŠ¡å™¨ç¼“å­˜ï¼Œè¿”å›å¯¹åº”IP TCPè¿æ¥ï¼šIP+80ç«¯å£ ä¸‰æ¬¡æ¡æ‰‹ httpåè®®ç‰ˆæœ¬ å‘é€HTTPè¯·æ±‚ï¼š æœåŠ¡å™¨å¤„ç†å¹¶è¿”å›HTTPæŠ¥æ–‡ æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢ è¿æ¥ç»“æŸ HTTPçŠ¶æ€ç  1XXï¼šæŒ‡ç¤ºä¿¡æ¯â€”â€”è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç†\n2XXï¼šæˆåŠŸâ€”â€”è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ã€ç†è§£ã€æ¥å—\n3XXï¼šé‡å®šå‘â€”â€”è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œ\n4XXï¼šå®¢æˆ·ç«¯é”™è¯¯â€”â€”è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç°\n401 ï¼ˆæœªæˆæƒï¼‰ è¯·æ±‚è¦æ±‚èº«ä»½éªŒè¯ã€‚ å¯¹äºéœ€è¦ç™»å½•çš„ç½‘é¡µï¼ŒæœåŠ¡å™¨å¯èƒ½è¿”å›æ­¤å“åº”ã€‚ 403 ï¼ˆç¦æ­¢ï¼‰ æœåŠ¡å™¨æ‹’ç»è¯·æ±‚ã€‚5XXï¼šæœåŠ¡ç«¯é”™è¯¯â€”â€”æœåŠ¡ç«¯æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚\nhttps://www.cnblogs.com/gitnull/p/9532129.html\n8. HTTP ä»‹ç»2 å¸¸è§çŠ¶æ€ç  200 OKï¼š æ­£å¸¸è¿”å›ä¿¡æ¯ 400 Bad Requestï¼š å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨ç†è§£ 401 Unauthorizedï¼š è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨ 403 Forbiddenï¼š æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ 404 Not Foundï¼šè¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œegï¼Œè¾“å…¥äº†é”™è¯¯çš„url 500 Internal Server Errorï¼š æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯ 503 Server Unavailableï¼šæœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½å›å¤æ­£å¸¸ GETå’ŒPOSTçš„åŒºåˆ« HTTPæŠ¥æ–‡å±‚é¢ï¼šGETå°†è¯·æ±‚ä¿¡æ¯æ”¾åœ¨URLä¸­ï¼ŒPOSTæ”¾åœ¨æŠ¥æ–‡ä½“ä¸­ï¼Œ getçš„è¯·æ±‚ä¿¡æ¯é•¿åº¦æ˜¯æœ‰é™åˆ¶çš„ã€‚postæ˜¯æ²¡æœ‰é™åˆ¶çš„ æ•°æ®åº“å±‚é¢ï¼š GETç¬¦åˆå¹‚ç­‰æ€§å’Œå®‰å…¨æ€§ï¼ŒPOSTä¸ç¬¦åˆ å…¶ä»–å±‚é¢ï¼š GETè¯·æ±‚å¯ä»¥è¢«ç¼“å­˜ã€è¢«å­˜å‚¨ï¼Œè€ŒPOSTä¸è¡Œ Cookie å’ŒSessionçš„åŒºåˆ« Cookie ç®€ä»‹ æ˜¯æœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„ç‰¹æ®Šä¿¡æ¯ï¼Œä»¥æ–‡æœ¬çš„å½¢å¼å­˜æ”¾åœ¨å®¢æˆ·ç«¯ï¼Œ å­˜æ”¾åœ¨Response Headerä¸­ å®¢æˆ·ç«¯å†æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œä¼šæŠŠCookieå›å‘ æœåŠ¡å™¨æ¥æ”¶åˆ°åï¼Œä¼šè§£æCookieç”Ÿæˆä¸å®¢æˆ·ç«¯ç›¸å¯¹åº”çš„å†…å®¹ Cookieçš„è®¾ç½®ä»¥åŠå‘é€è¿‡ç¨‹ Sessionç®€ä»‹ æœåŠ¡å™¨ç«¯çš„æœºåˆ¶ï¼Œåœ¨æœåŠ¡å™¨ä¸Šä¿å­˜ä¿¡æ¯ è§£æå®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶æ“ä½œsession idï¼ŒæŒ‰éœ€ä¿å­˜çŠ¶æ€ä¿¡æ¯ Sessionçš„å®ç°æ–¹å¼ ä½¿ç”¨Cookieæ¥å®ç°ï¼š JSESSIONID\nä½¿ç”¨urlå›å†™æ¥å®ç°\nåŒºåˆ«\nCookieæ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Šï¼Œsessionæ•°æ®å­˜æ”¾åœ¨æœåŠ¡ç«¯ Sessionç›¸å¯¹äºCookieæ›´å®‰å…¨ è‹¥è€ƒè™‘å‡è½»æœåŠ¡å™¨è´Ÿæ‹…ï¼Œåº”å½“ä½¿ç”¨Cookie 9. HTTP å’ŒHTTPS çš„åŒºåˆ« SSL ï¼ˆSecurity Socket Layerï¼Œ å®‰å…¨å¥—æ¥å±‚ï¼‰ ä¸ºç½‘ç»œé€šä¿¡æä¾›å®‰å…¨åŠæ•°æ®å®Œæ•´æ€§çš„ä¸€ç§å®‰å…¨åè®® æ˜¯æ“ä½œç³»ç»Ÿå¯¹å¤–çš„APIï¼ŒSSL3.9åæ›´åä¸ºTSL é‡‡ç”¨èº«ä»½éªŒè¯å’Œæ•°æ®åŠ å¯†ä¿è¯ç½‘ç»œé€šä¿¡çš„å®‰å…¨å’Œæ•°æ®çš„å®Œæ•´æ€§ åŠ å¯†çš„æ–¹å¼ å¯¹ç§°åŠ å¯†ï¼š åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ éå¯¹ç§°åŠ å¯†ï¼š åŠ å¯†ä½¿ç”¨çš„å¯†é’¥å’Œè§£å¯†ä½¿ç”¨çš„å¯†é’¥æ˜¯ä¸ç›¸åŒçš„ å“ˆå¸Œç®—æ³•ï¼š å°†ä»»æ„é•¿åº¦çš„ä¿¡æ¯è½¬æ¢æˆ‘å›ºå®šé•¿åº¦çš„å€¼ï¼Œç®—æ³•ä¸å¯é€† MD5 æ•°å­—ç­¾åï¼š è¯æ˜æŸä¸ªæ¶ˆæ¯æˆ–è€…æ–‡ä»¶æ˜¯æŸäººå‘å‡º/è®¤åŒçš„ HTTPSæ•°æ®ä¼ è¾“æµç¨‹ æµè§ˆå™¨æ”¯æŒçš„åŠ å¯†ç®—æ³•ä¿¡æ¯å‘é€ç»™æœåŠ¡å™¨\næœåŠ¡å™¨é€‰æ‹©ä¸€å¥—æµè§ˆå™¨æ”¯æŒçš„åŠ å¯†ç®—æ³•ï¼Œä»¥è¯ä¹¦çš„å½¢å¼å›å‘æµè§ˆå™¨\næµè§ˆå™¨éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå¹¶ç»“åˆè¯ä¹¦å…¬é’¥åŠ å¯†ä¿¡æ¯å‘é€ç»™æœåŠ¡å™¨\næœåŠ¡å™¨ä½¿ç”¨ç§é’¥è§£å¯†ä¿¡æ¯ï¼ŒéªŒè¯å“ˆå¸Œï¼ŒåŠ å¯†å“åº”æ¶ˆæ¯å›å‘æµè§ˆå™¨\næµè§ˆå™¨è§£å¯†å“åº”æ¶ˆæ¯ï¼Œå¹¶å¯¹æ¶ˆæ¯è¿›è¡ŒéªŒçœŸï¼Œä¹‹åè¿›è¡ŒåŠ å¯†äº¤äº’æ•°æ®\nåŒºåˆ« HTTPS éœ€è¦åˆ°CAç”³è¯·è¯ä¹¦ï¼Œ HTTPä¸éœ€è¦\nHTTPSå¯†æ–‡ä¼ è¾“ï¼ŒHTTPæ˜æ–‡ä¼ è¾“\nè¿æ¥æ–¹å¼ä¸åŒï¼ŒHTTPSé»˜è®¤ä½¿ç”¨443ç«¯å£ï¼ŒHTTPä½¿ç”¨80ç«¯å£\nHTTPS = HTTP+åŠ å¯†+è®¤è¯+å®Œæ•´æ€§ä¿æŠ¤ï¼Œè¾ƒHTTPå®‰å…¨\nHTTPSçœŸçš„å¾ˆå®‰å…¨å—\né»˜è®¤æµè§ˆå™¨å¡«å……http://, è¯·æ±‚éœ€è¦è¿›è¡Œè·³è½¬ï¼Œæœ‰è¢«åŠ«æŒçš„é£é™© å¯ä»¥ä½¿ç”¨HSTS(HTTP Strict Transport Security)ä¼˜åŒ– 10. Socketç›¸å…³ è¿›ç¨‹é—´é€šä¿¡ pidå”¯ä¸€æ ‡è¯†æœ¬åœ°çš„è¿›ç¨‹ï¼Œæœ¬åœ°å”¯ä¸€\nSocketæ˜¯å¯¹TCP/IPåè®®çš„æŠ½è±¡ï¼Œæ˜¯æ“ä½œç³»ç»Ÿå¯¹å¤–å¼€æ”¾çš„æ¥å£\nSocketèµ·æºäºUnixï¼Œä¸€åˆ‡çš†æ˜¯æ–‡ä»¶\nSocketé€šä¿¡æµç¨‹ 11. ç½‘ç»œçŸ¥è¯†æ€»ç»“ OSIä¸ƒå±‚æ¶æ„ TCP/IP åè®®\nTCP\nä¸‰æ¬¡æ¡æ‰‹ SYN Flood æ”»å‡» TCPæŠ¥æ–‡å¤´ ä¸ºä»€ä¹ˆè¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ å››æ¬¡æŒ¥æ‰‹ TIME_WAIT CLOSE_WAIT ä¸ºä»€ä¹ˆè¦è¿›è¡Œå››æ¬¡æŒ¥æ‰‹ æ»‘åŠ¨çª—å£ TCPå’ŒUDPçš„åŒºåˆ« HTTP\nè¯·æ±‚ç»“æ„ å“åº”ç»“æ„ è¯·æ±‚å“åº”æ­¥éª¤ æµè§ˆå™¨é”®å…¥URLç»å†çš„æµç¨‹ çŠ¶æ€ç  GETå’ŒPOSTçš„åŒºåˆ« Cookieå’ŒSessionçš„åŒºåˆ« HTTPå’ŒHTTPSçš„åŒºåˆ« Socket\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/2nd_%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E8%AF%95%E6%A0%B8%E5%BF%83/","summary":"è®¡ç®—æœºç½‘ç»œé¢è¯•æ ¸å¿ƒ 7. HTTP ç®€ä»‹ è¶…æ–‡æœ¬ä¼ è¾“åè®®çš„ä¸»è¦ç‰¹ç‚¹ æ˜¯åº”ç”¨å±‚çš„è¯·æ±‚å“åº”çš„æ— çŠ¶æ€åè®®\næ”¯æŒå®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼ ï¼š æµè§ˆå™¨é€šè¿‡urlå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œ æœåŠ¡ç«¯è¿”å›å“åº”ä¿¡æ¯ ç®€å•å¿«é€Ÿ ï¼š è¯·æ±‚æ–¹æ³• get post delete é€šè®¯é€Ÿåº¦å¿« çµæ´»ï¼š æ•°æ®æ ¼å¼çµæ´»ï¼Œå…è®¸ä»»æ„æ ¼å¼çš„æ•°æ®ç±»å‹ æ— è¿æ¥ï¼š æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œæ”¶åˆ°åº”ç­”ä¹‹åå°±æ–­å¼€è¿æ¥ ï¼Œ 1.1 ä¹‹åä½¿ç”¨äº†é•¿è¿æ¥ ä¸‹å±‚å®ç°å¯¹ä¸Šå±‚é€æ˜ï¼Œ keep alive æ— çŠ¶æ€ï¼š å¯¹äº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼Œç¼ºå°‘çŠ¶æ€ï¼Œ version 1.1 å¼•å…¥äº† keep alive æŒç»­è¿æ¥æœºåˆ¶ 2.0 å‡çº§æˆæœ¬å¤ªå¤§ HTTP è¯·æ±‚ç»“æ„ HTTPè¯·æ±‚æŠ¥æ–‡ç»“æ„\n1GET /baidu/com HTTP1.1 2 Host: www.baidu.com 3 Connection:keep-alive # close 1.1ä¹‹å‰ 4 User-Agentï¼š Mozilla/5.0 5 Accept-Encoding 6Cookie: XXX HTTPå“åº”ç»“æ„ 1HTTP 1.1 200 OK 2\tServer: 3\tAccept-Ranges: 4\tContent-Type: 5\tContent-Languge: 6\tContent-Length: 7\tDate: è¯·æ±‚/å“åº”æ­¥éª¤ å®¢æˆ·ç«¯è¿æ¥åˆ°WEBæœåŠ¡å™¨ å‘é€HTTPè¯·æ±‚ æœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶è¿”å›HTTPå“åº” é‡Šæ”¾TCPè¿æ¥ï¼š æœåŠ¡å™¨ä¸»åŠ¨å…³é—­TCPè¿æ¥ï¼Œæµè§ˆå™¨è¢«åŠ¨é‡Šæ”¾TCPè¿æ¥ å®¢æˆ·ç«¯æµè§ˆå™¨è§£æHTMLå†…å®¹ åœ¨æµè§ˆå™¨åœ°å€é”®å…¥http å¼€å¤´çš„urlï¼ŒæŒ‰ä¸‹å›è½¦ä¹‹åç»å†çš„æµç¨‹ DNSè§£æ ï¼šé€å±‚æŸ¥è¯¢è·¯ç”±å™¨ä¸­çš„DNSç¼“å­˜ï¼Œæµè§ˆå™¨-ç³»ç»Ÿ-è·¯ç”±å™¨-IPSæœåŠ¡å™¨-æ ¹åŸŸåæœåŠ¡å™¨ç¼“å­˜-é¡¶çº§åŸŸåæœåŠ¡å™¨ç¼“å­˜ï¼Œè¿”å›å¯¹åº”IP TCPè¿æ¥ï¼šIP+80ç«¯å£ ä¸‰æ¬¡æ¡æ‰‹ httpåè®®ç‰ˆæœ¬ å‘é€HTTPè¯·æ±‚ï¼š æœåŠ¡å™¨å¤„ç†å¹¶è¿”å›HTTPæŠ¥æ–‡ æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢ è¿æ¥ç»“æŸ HTTPçŠ¶æ€ç  1XXï¼šæŒ‡ç¤ºä¿¡æ¯â€”â€”è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç†","tags":null,"title":""},{"categories":null,"contents":"æ•°æ®åº“ 1. æ•°æ®åº“æ¶æ„ å…³ç³»å‹æ•°æ®åº“çš„ä¸»è¦è€ƒç‚¹ï¼š æ¶æ„ã€ ç´¢å¼•ã€é”ã€è¯­æ³•ã€ç†è®ºèŒƒå¼\nèŒƒå¼ä¸€ï¼š åˆ—ä¸å¯å†åˆ† èŒƒå¼äºŒï¼š æ ‡å‡†é”® èŒƒå¼ä¸‰ï¼š å»é™¤ä¼ é€’ä¾èµ–\nå¦‚ä½•è®¾è®¡ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ RDMBS\nå­˜å‚¨ç®¡ç†ï¼šå°½å¯èƒ½çš„å‡å°‘IOï¼Œä½¿ç”¨å—æˆ–è€…é¡µå®ç° ç¼“å­˜æœºåˆ¶ï¼šä¸å®œè¿‡å¤§ï¼Œè¦æœ‰æ·˜æ±°æœºåˆ¶ LRU SQLè§£æï¼šSQLè§£æ æ—¥å¿—ç®¡ç†ï¼šè®°å½•æ“ä½œè®°å½• binlog æƒé™åˆ’åˆ†ï¼š å®¹ç¾æœºåˆ¶ï¼šå¤„ç†å¼‚å¸¸ ç´¢å¼•ç®¡ç†ï¼š é”ç®¡ç†ï¼š\n1. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç´¢å¼•ï¼Ÿ é¿å…å…¨è¡¨æ‰«æï¼Œå¿«é€ŸæŸ¥è¯¢æ•°æ®\nå…¨è¡¨æ‰«æ æ‰€æœ‰çš„æ•°æ®åˆ†æ‰¹æ¬¡åŠ è½½åˆ°å†…å­˜ ç´¢å¼• - å¯¹åº”å­—å…¸çš„åæ—éƒ¨é¦–ç­‰\n2. ä»€ä¹ˆæ ·çš„ä¿¡æ¯èƒ½å¤Ÿæˆä¸ºç´¢å¼• ä¸»é”®ã€å”¯ä¸€é”®ã€æ™®é€šé”®ç­‰\n3. ç´¢å¼•çš„æ•°æ®ç»“æ„ ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹äºŒå‰æŸ¥æ‰¾æ ‘ä»Šæ¬¡é‚£ä¸ªäºŒåˆ†æŸ¥æ‰¾ ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹B-Treeè¿›è¡ŒæŸ¥æ‰¾\nç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹B+Treeç»“æ„è¿›è¡ŒæŸ¥æ‰¾\nç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹Hashç»“æ„è¿›è¡ŒæŸ¥æ‰¾\n2. ä¼˜åŒ–ç´¢å¼•- äºŒå‰æŸ¥æ‰¾æ ‘ äºŒå‰æŸ¥æ‰¾æ ‘ äºŒå‰æŸ¥æ‰¾æ ‘ï¼šå·¦å­èŠ‚ç‚¹å°äº æ ¹èŠ‚ç‚¹ï¼Œ å³å­èŠ‚ç‚¹å¤§äºæ ¹èŠ‚ç‚¹ å¹³è¡¡äºŒå‰æ ‘ï¼š å·¦å³å­æ ‘æ·±åº¦çš„å·®å€¼ä¸è¶…è¿‡1\näºŒå‰æŸ¥æ‰¾æ ‘å®¹æ˜“å˜ä¸ºçº¿æ€§äºŒå‰æ ‘ å³ä½¿ä½¿ç”¨æ•°çš„æ—‹è½¬ä¹Ÿä¼šå‡ºç°æ•°çš„æ·±åº¦é€’å¢å¯¼è‡´IOçš„æ¬¡æ•°å¢åŠ  3. ä¼˜åŒ–ç´¢å¼•- B-Tree å¹³è¡¡å¤šè·¯æŸ¥æ‰¾æ ‘ æ¯ä¸ªèŠ‚ç‚¹æœ‰è‡³å¤šmä¸ªå­©å­ï¼Œ Mé˜¶Bæ ‘ å®šä¹‰ï¼š\næ ¹èŠ‚ç‚¹è‡³å°‘åŒ…æ‹¬ä¸¤ä¸ªå­©å­ æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå«æœ‰æœ‰Mä¸ªå­©å­(m\u0026gt;2) é™¤æ ¹èŠ‚ç‚¹å’Œå¶èŠ‚ç‚¹å¤–ï¼Œå…¶ä»–æ¯ä¸ªèŠ‚ç‚¹éƒ½è‡³å°‘æœ‰ceil(m/2)ä¸ªå­©å­ æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹éƒ½ä½äºåŒä¸€å±‚ å‡è®¾æ¯ä¸ªéç»ˆç«¯èŠ‚ç‚¹ä¸­åŒ…å«æœ‰nä¸ªå…³é”®å­—ä¿¡æ¯ï¼Œå…¶ä¸­ Ki(i=1,\u0026hellip;n) ä¸ºå…³é”®å­—ï¼Œä¸”å…³é”®å­—é¡ºåºæŒ‰å‡åºæ’åºKi-1\u0026lt; Ki å…³é”®å­—çš„ä¸ªæ•°nå¿…é¡»æ»¡è¶³ï¼š[ceil(m/2) -1]\u0026lt;= n \u0026lt;= m-1 éå¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼šP[1],P[2],\u0026hellip;P[M];å…¶ä¸­P[1]æŒ‡å‘å…³é”®å­—å°äºK[1]çš„å­æ ‘ï¼ŒP[M]æŒ‡å‘å…³é”®å­—å¤§äºK[M-1]çš„å­æ ‘ï¼Œå…¶ä»–P[i]æŒ‡å‘å…³é”®å­—å±äº(K[i-1]K[i])çš„å­æ ‘ã€‚ è®©æ¯ä¸€ä¸ªèŠ‚ç‚¹å°½å¯èƒ½å­˜å‚¨æ›´å¤šçš„ä¿¡æ¯ï¼Œå°½å¯èƒ½çš„å‡å°‘æ•°çš„æ·±åº¦ï¼Œä»è€Œå‡å°‘IOçš„æ¬¡æ•°\nB-Tree ä¼šè¿œæ¯”äºŒå‰æ ‘çŸ®çš„å¤š\n4. ä¼˜åŒ–ç´¢å¼• B+-Tree B+-Tree ä¸ B-Tree çš„åŒºåˆ«\nå…³é”®å­—çš„ä¸ªæ•°å’ŒæŒ‡é’ˆçš„ä¸ªæ•°ä¸€è‡´ B+-Tree æ˜¯B-Tree çš„å˜ä½“ï¼Œå…¶å®šä¹‰åŸºæœ¬ä¸B-Tree ç›¸åŒ é™¤äº†\néå¶å­èŠ‚ç‚¹çš„å­æ ‘æŒ‡é’ˆä¸å…³é”®å­—ä¸ªæ•°ç›¸åŒ éå¶å­èŠ‚ç‚¹çš„å­æ ‘æŒ‡é’ˆP[i],æŒ‡å‘å…³é”®å­—å€¼[K[i],K[i+1])çš„å­æ ‘ã€‚ï¼ˆå·¦é—­å³å¼€ï¼‰ éå¶å­èŠ‚ç‚¹ä»…ç”¨æ¥åšç´¢å¼•ï¼Œæ•°æ®ä¿å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸­ æ‰€æœ‰å¶å­èŠ‚ç‚¹å‡æœ‰ä¸€ä¸ªé“¾æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå¶å­èŠ‚ç‚¹ã€‚ï¼ˆæœ‰åˆ©äºåšèŒƒå›´ç»Ÿè®¡ï¼‰ B+-Tree æ›´é€‚åˆç”¨æ¥åšå­˜å‚¨ç´¢å¼• B+Tree çš„ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½ï¼Œå†…éƒ¨èŠ‚ç‚¹åªå­˜å‚¨ç´¢å¼• B+Tree çš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š O(logn) B+Tree æ›´æœ‰åˆ©äºå¯¹æ•°æ®åº“çš„æ‰«æ 5. ä¼˜åŒ–ç´¢å¼• - Hashä»¥åŠBitMap Hashç´¢å¼• ç¼ºç‚¹\nä»…èƒ½æ»¡è¶³\u0026quot;=\u0026quot;, \u0026ldquo;IN\u0026rdquo;,ä¸èƒ½ä½¿ç”¨èŒƒå›´æŸ¥è¯¢ æ— æ³•è¢«ç”¨æ¥é¿å…æ•°æ®çš„æ’åºæ“ä½œ ä¸èƒ½åˆ©ç”¨éƒ¨åˆ†ç´¢å¼•é”®æŸ¥è¯¢ ç»„åˆç´¢å¼•å»ºç«‹çš„hash å€¼ ä¸èƒ½é¿å…è¡¨æ‰«æ é‡åˆ°å¤§é‡Hashå€¼ç›¸ç­‰çš„æƒ…å†µåï¼Œæ€§èƒ½å¹¶ä¸ä¸€å®šä¼šæ¯”B+-Treeç´¢å¼•é«˜ BitMap ç´¢å¼• é”çš„ç²’åº¦éå¸¸çš„å¤§ï¼Œä¸é€‚åˆé«˜å¹¶å‘ï¼Œ OLAP\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/3rd_%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9E%B6%E6%9E%84/","summary":"æ•°æ®åº“ 1. æ•°æ®åº“æ¶æ„ å…³ç³»å‹æ•°æ®åº“çš„ä¸»è¦è€ƒç‚¹ï¼š æ¶æ„ã€ ç´¢å¼•ã€é”ã€è¯­æ³•ã€ç†è®ºèŒƒå¼\nèŒƒå¼ä¸€ï¼š åˆ—ä¸å¯å†åˆ† èŒƒå¼äºŒï¼š æ ‡å‡†é”® èŒƒå¼ä¸‰ï¼š å»é™¤ä¼ é€’ä¾èµ–\nå¦‚ä½•è®¾è®¡ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ RDMBS\nå­˜å‚¨ç®¡ç†ï¼šå°½å¯èƒ½çš„å‡å°‘IOï¼Œä½¿ç”¨å—æˆ–è€…é¡µå®ç° ç¼“å­˜æœºåˆ¶ï¼šä¸å®œè¿‡å¤§ï¼Œè¦æœ‰æ·˜æ±°æœºåˆ¶ LRU SQLè§£æï¼šSQLè§£æ æ—¥å¿—ç®¡ç†ï¼šè®°å½•æ“ä½œè®°å½• binlog æƒé™åˆ’åˆ†ï¼š å®¹ç¾æœºåˆ¶ï¼šå¤„ç†å¼‚å¸¸ ç´¢å¼•ç®¡ç†ï¼š é”ç®¡ç†ï¼š\n1. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç´¢å¼•ï¼Ÿ é¿å…å…¨è¡¨æ‰«æï¼Œå¿«é€ŸæŸ¥è¯¢æ•°æ®\nå…¨è¡¨æ‰«æ æ‰€æœ‰çš„æ•°æ®åˆ†æ‰¹æ¬¡åŠ è½½åˆ°å†…å­˜ ç´¢å¼• - å¯¹åº”å­—å…¸çš„åæ—éƒ¨é¦–ç­‰\n2. ä»€ä¹ˆæ ·çš„ä¿¡æ¯èƒ½å¤Ÿæˆä¸ºç´¢å¼• ä¸»é”®ã€å”¯ä¸€é”®ã€æ™®é€šé”®ç­‰\n3. ç´¢å¼•çš„æ•°æ®ç»“æ„ ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹äºŒå‰æŸ¥æ‰¾æ ‘ä»Šæ¬¡é‚£ä¸ªäºŒåˆ†æŸ¥æ‰¾ ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹B-Treeè¿›è¡ŒæŸ¥æ‰¾\nç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹B+Treeç»“æ„è¿›è¡ŒæŸ¥æ‰¾\nç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹Hashç»“æ„è¿›è¡ŒæŸ¥æ‰¾\n2. ä¼˜åŒ–ç´¢å¼•- äºŒå‰æŸ¥æ‰¾æ ‘ äºŒå‰æŸ¥æ‰¾æ ‘ äºŒå‰æŸ¥æ‰¾æ ‘ï¼šå·¦å­èŠ‚ç‚¹å°äº æ ¹èŠ‚ç‚¹ï¼Œ å³å­èŠ‚ç‚¹å¤§äºæ ¹èŠ‚ç‚¹ å¹³è¡¡äºŒå‰æ ‘ï¼š å·¦å³å­æ ‘æ·±åº¦çš„å·®å€¼ä¸è¶…è¿‡1\näºŒå‰æŸ¥æ‰¾æ ‘å®¹æ˜“å˜ä¸ºçº¿æ€§äºŒå‰æ ‘ å³ä½¿ä½¿ç”¨æ•°çš„æ—‹è½¬ä¹Ÿä¼šå‡ºç°æ•°çš„æ·±åº¦é€’å¢å¯¼è‡´IOçš„æ¬¡æ•°å¢åŠ  3. ä¼˜åŒ–ç´¢å¼•- B-Tree å¹³è¡¡å¤šè·¯æŸ¥æ‰¾æ ‘ æ¯ä¸ªèŠ‚ç‚¹æœ‰è‡³å¤šmä¸ªå­©å­ï¼Œ Mé˜¶Bæ ‘ å®šä¹‰ï¼š\næ ¹èŠ‚ç‚¹è‡³å°‘åŒ…æ‹¬ä¸¤ä¸ªå­©å­ æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå«æœ‰æœ‰Mä¸ªå­©å­(m\u0026gt;2) é™¤æ ¹èŠ‚ç‚¹å’Œå¶èŠ‚ç‚¹å¤–ï¼Œå…¶ä»–æ¯ä¸ªèŠ‚ç‚¹éƒ½è‡³å°‘æœ‰ceil(m/2)ä¸ªå­©å­ æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹éƒ½ä½äºåŒä¸€å±‚ å‡è®¾æ¯ä¸ªéç»ˆç«¯èŠ‚ç‚¹ä¸­åŒ…å«æœ‰nä¸ªå…³é”®å­—ä¿¡æ¯ï¼Œå…¶ä¸­ Ki(i=1,\u0026hellip;n) ä¸ºå…³é”®å­—ï¼Œä¸”å…³é”®å­—é¡ºåºæŒ‰å‡åºæ’åºKi-1\u0026lt; Ki å…³é”®å­—çš„ä¸ªæ•°nå¿…é¡»æ»¡è¶³ï¼š[ceil(m/2) -1]\u0026lt;= n \u0026lt;= m-1 éå¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼šP[1],P[2],\u0026hellip;P[M];å…¶ä¸­P[1]æŒ‡å‘å…³é”®å­—å°äºK[1]çš„å­æ ‘ï¼ŒP[M]æŒ‡å‘å…³é”®å­—å¤§äºK[M-1]çš„å­æ ‘ï¼Œå…¶ä»–P[i]æŒ‡å‘å…³é”®å­—å±äº(K[i-1]K[i])çš„å­æ ‘ã€‚ è®©æ¯ä¸€ä¸ªèŠ‚ç‚¹å°½å¯èƒ½å­˜å‚¨æ›´å¤šçš„ä¿¡æ¯ï¼Œå°½å¯èƒ½çš„å‡å°‘æ•°çš„æ·±åº¦ï¼Œä»è€Œå‡å°‘IOçš„æ¬¡æ•°","tags":null,"title":""},{"categories":null,"contents":"Redis ç¼“å­˜çŸ¥è¯†è€ƒç‚¹ ç†”æ–­æœºåˆ¶ï¼š æ•°æ®åº“downæ‰ï¼Œå¯ä»¥ç¼“å­˜é¡¶ä¸Š\nç¼“å­˜ä¸­é—´ä»¶-Memcache å’Œ Redis çš„åŒºåˆ« Memcache: ä»£ç å±‚æ¬¡ç±»ä¼¼Hash\næ”¯æŒç®€å•æ•°æ®ç±»å‹ ä¸æ”¯æŒæ•°æ®æŒä¹…åŒ– ä¸æ”¯æŒä¸»ä» ä¸æ”¯æŒåˆ†ç‰‡ shard Redis æ•°æ®ç±»å‹ä¸°å¯Œ æ”¯æŒæ•°æ®ç£ç›˜æŒä¹…åŒ–å­˜å‚¨ æ”¯æŒä¸»ä» æ”¯æŒåˆ†ç‰‡ ä¸ºä»€ä¹ˆRedisèƒ½è¿™ä¹ˆå¿« 100000+ QPS(QPS-\u0026gt; query per second, æ¯ç§’æŸ¥è¯¢æ¬¡æ•°)\nå®Œå…¨åŸºäºå†…å­˜ï¼Œ ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼Œ æ‰§è¡Œæ•ˆç‡é«˜ æ•°æ®ç»“æ„ç®€å•ï¼Œ å¯¹æ•°æ®çš„æ“ä½œç®€å• é‡‡ç”¨å•çº¿ç¨‹ï¼Œå•çº¿ç¨‹ä¹Ÿèƒ½å¤„ç†é«˜å¹¶å‘è¯·æ±‚ï¼Œæƒ³å¤šæ ¸ä¹Ÿå¯ä»¥å¯åŠ¨å¤šå®ä¾‹ ä½¿ç”¨å¤šè·¯I/Oå¤ç”¨æ¨¡å‹ï¼Œéé˜»å¡I/O å¤šè·¯I/O å¤ç”¨æ¨¡å‹ FDï¼š File Descriptor , æ–‡ä»¶æè¿°ç¬¦ ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶é€šè¿‡å”¯ä¸€çš„æè¿°ç¬¦è¿›è¡Œå¼•ç”¨ï¼Œ è¯¥æè¿°ç¬¦æ˜¯æ‰“å¼€æ–‡ä»¶çš„å…ƒæ•°æ®åˆ°æ–‡ä»¶æœ¬èº«çš„æ˜ å°„ã€‚\nä¼ ç»Ÿçš„é˜»å¡IOæ¨¡å‹ å¤šè·¯IOå¤ç”¨æ¨¡å‹ select ç³»ç»Ÿè°ƒç”¨ Redisé‡‡ç”¨çš„IOå¤šè·¯å¤ç”¨å‡½æ•°ï¼š epollã€ã€‘/kqueue/evport/select \u0026hellip;\nå› åœ°åˆ¶å®œ ä¼˜å…ˆé€‰ç”¨æ—¶é—´å¤æ‚åº¦ä¸ºO(1)çš„IOå¤šè·¯å¤ç”¨å‡½æ•°ä½œä¸ºåº•å±‚å®ç° ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/4th_Redis/","summary":"Redis ç¼“å­˜çŸ¥è¯†è€ƒç‚¹ ç†”æ–­æœºåˆ¶ï¼š æ•°æ®åº“downæ‰ï¼Œå¯ä»¥ç¼“å­˜é¡¶ä¸Š\nç¼“å­˜ä¸­é—´ä»¶-Memcache å’Œ Redis çš„åŒºåˆ« Memcache: ä»£ç å±‚æ¬¡ç±»ä¼¼Hash\næ”¯æŒç®€å•æ•°æ®ç±»å‹ ä¸æ”¯æŒæ•°æ®æŒä¹…åŒ– ä¸æ”¯æŒä¸»ä» ä¸æ”¯æŒåˆ†ç‰‡ shard Redis æ•°æ®ç±»å‹ä¸°å¯Œ æ”¯æŒæ•°æ®ç£ç›˜æŒä¹…åŒ–å­˜å‚¨ æ”¯æŒä¸»ä» æ”¯æŒåˆ†ç‰‡ ä¸ºä»€ä¹ˆRedisèƒ½è¿™ä¹ˆå¿« 100000+ QPS(QPS-\u0026gt; query per second, æ¯ç§’æŸ¥è¯¢æ¬¡æ•°)\nå®Œå…¨åŸºäºå†…å­˜ï¼Œ ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼Œ æ‰§è¡Œæ•ˆç‡é«˜ æ•°æ®ç»“æ„ç®€å•ï¼Œ å¯¹æ•°æ®çš„æ“ä½œç®€å• é‡‡ç”¨å•çº¿ç¨‹ï¼Œå•çº¿ç¨‹ä¹Ÿèƒ½å¤„ç†é«˜å¹¶å‘è¯·æ±‚ï¼Œæƒ³å¤šæ ¸ä¹Ÿå¯ä»¥å¯åŠ¨å¤šå®ä¾‹ ä½¿ç”¨å¤šè·¯I/Oå¤ç”¨æ¨¡å‹ï¼Œéé˜»å¡I/O å¤šè·¯I/O å¤ç”¨æ¨¡å‹ FDï¼š File Descriptor , æ–‡ä»¶æè¿°ç¬¦ ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶é€šè¿‡å”¯ä¸€çš„æè¿°ç¬¦è¿›è¡Œå¼•ç”¨ï¼Œ è¯¥æè¿°ç¬¦æ˜¯æ‰“å¼€æ–‡ä»¶çš„å…ƒæ•°æ®åˆ°æ–‡ä»¶æœ¬èº«çš„æ˜ å°„ã€‚\nä¼ ç»Ÿçš„é˜»å¡IOæ¨¡å‹ å¤šè·¯IOå¤ç”¨æ¨¡å‹ select ç³»ç»Ÿè°ƒç”¨ Redisé‡‡ç”¨çš„IOå¤šè·¯å¤ç”¨å‡½æ•°ï¼š epollã€ã€‘/kqueue/evport/select \u0026hellip;\nå› åœ°åˆ¶å®œ ä¼˜å…ˆé€‰ç”¨æ—¶é—´å¤æ‚åº¦ä¸ºO(1)çš„IOå¤šè·¯å¤ç”¨å‡½æ•°ä½œä¸ºåº•å±‚å®ç° ","tags":null,"title":""},{"categories":null,"contents":"Linux Linux çš„ä½“ç³»ç»“æ„ ä½“ç³»ç»“æ„ä¸»è¦åˆ†ä¸º ç”¨æˆ·æ€(ç”¨æˆ·ä¸Šå±‚æ´»åŠ¨)å’Œå†…æ ¸æ€ å†…æ ¸ï¼š æœ¬è´¨æ˜¯ä¸€æ®µç®¡ç†è®¡ç®—æœºç¡¬ä»¶è®¾å¤‡çš„ç¨‹åº ç³»ç»Ÿè°ƒç”¨ï¼šå†…æ ¸çš„è®¿é—®æ¥å£ï¼Œæ˜¯ä¸€ç§ä¸èƒ½å†ç®€åŒ–çš„æ“ä½œã€‚ åŸå­æ€§çš„æ“ä½œã€‚ å…¬ç”¨å‡½æ•°åº“ï¼š ç³»ç»Ÿè°ƒç”¨çš„ç»„åˆæ‹³ Shell:å‘½ä»¤è§£é‡Šå™¨ï¼Œ å¯ç¼–ç¨‹ windows - cigwin\næŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨ Linux - man 2 syscalls less / more / cat /tail\nåˆ‡æ¢é»˜è®¤shell\næŸ¥æ‰¾ç‰¹å®šçš„æ–‡ä»¶ find\nè¯­æ³•ï¼š find path [options] params ä½œç”¨ï¼š åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶ 1find ./ -name \u0026#34;fileName\u0026#34; # ç²¾ç¡®æŸ¥æ‰¾ 2find ~ -name \u0026#34;target*\u0026#34; # æ¨¡ç³ŠæŸ¥æ‰¾æ–‡ä»¶ 3find ~ -iname \u0026#34;target*\u0026#34; # å¿½ç•¥å¤§å°å†™çš„æŸ¥æ‰¾ 4man find # æŸ¥çœ‹findçš„ä½¿ç”¨è¯´æ˜ æ£€ç´¢æ–‡ä»¶å†…å®¹ grep\nè¯­æ³•ï¼š grep [options] pattern file å…¨ç§° Global Regular Expression Print ä½œç”¨ï¼š ç”¨äºæŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸², æ™ºæ…§ç­›é€‰å‡ºç›®æ ‡å­—ç¬¦ä¸²æ‰€åœ¨çš„è¡Œ 1grep \u0026#34;moo\u0026#34; target* # æŸ¥æ‰¾ target* å¼€å¤´çš„æ–‡ä»¶ä¸­åŒ…å« \u0026#34;moo\u0026#34; çš„è¡Œ ç®¡é“æ“ä½œç¬¦ | å¯ä»¥å°†æŒ‡ä»¤è¿æ¥èµ·æ¥ï¼Œå‰ä¸€ä¸ªæŒ‡ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªæŒ‡ä»¤çš„è¾“å…¥ åªå¤„ç†å‰ä¸€ä¸ªå‘½ä»¤çš„æ­£ç¡®è¾“å‡ºï¼Œ ä¸å¤„ç†é”™è¯¯è¾“å‡º å³è¾¹å‘½ä»¤å¿…é¡»æ¥æ”¶æ ‡å‡†è¾“å…¥æµï¼Œå¦åˆ™ä¼ é€’è¿‡ç¨‹ä¸­æ•°æ®ä¼šè¢«æŠ›å¼ƒ sed, awk, grep, cut, head, top, less, more, wc, join, sort, split ç­‰ 1grep \u0026#39;partial\\[true\\]\u0026#39; test.log | grep -o \u0026#39;engine\\[[0-9 a-z]*\\]\u0026#39; # ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ 2 3ps -ef|grep tomcat| grep -v \u0026#34;grep\u0026#34; # è¿‡æ»¤æ‰ä¸éœ€è¦çš„å†…å®¹ å¯¹æ–‡ä»¶å†…å®¹åšç»Ÿè®¡ awk\nè¯­æ³•ï¼š awk [options] 'cmd' file ä¸€æ¬¡è¯»å–ä¸€è¡Œæ–‡æœ¬ï¼Œ æŒ‰ç…§è¾“å…¥åˆ†éš”ç¬¦è¿›è¡Œåˆ‡ç‰‡ï¼Œåˆ‡æˆå¤šä¸ªç»„æˆéƒ¨åˆ† å°†åˆ‡ç‰‡ç›´æ¥ä¿å­˜åœ¨å†…å»ºçš„å˜é‡ä¸­ï¼Œ$1, $2\u0026hellip;.($0 è¡¨ç¤ºè¡Œçš„å…¨éƒ¨) æ”¯æŒå¯¹å•ä¸ªåˆ‡ç‰‡çš„åˆ¤æ–­ï¼Œæ”¯æŒå¾ªç¯åˆ¤æ–­ï¼Œé»˜è®¤åˆ†éš”ç¬¦ä¸ºç©ºæ ¼ 1awk \u0026#39;{print $1,$4}\u0026#39; fileName.txt # è·å–æ–‡ä»¶çš„ç¬¬1ï¼Œ 4 åˆ— 2 3awk \u0026#39;$1==\u0026#34;tcp\u0026#34; \u0026amp;\u0026amp; $2==1{print $0}\u0026#39; fileName.txt #æŒ‰æ¡ä»¶æŸ¥è¯¢è·å–å¯¹åº”çš„è¡Œ 4 5awk \u0026#39;($1==\u0026#34;tcp\u0026#34; \u0026amp;\u0026amp; $2==1) || NR==1 {print $0}\u0026#39; fileName.txt # æŒ‰æ¡ä»¶æŸ¥è¯¢ï¼ŒåŒæ—¶è·å–ç¬¬1è¡Œ 6 7awk -F \u0026#34;,\u0026#34; \u0026#39;{print $2}\u0026#39; fileName.txt # åˆ†éš”ç¬¦å·ä¸º \u0026#34;,\u0026#34; 8 9XXXXXX | awk \u0026#39;{enginearr[$1]++}END{for(i in enginearr)print i \u0026#34;\\t\u0026#34; enginearr[i]}\u0026#39; # ç»Ÿè®¡ ç¬¬1åˆ— å‡ºç°çš„æ¬¡æ•° æ‰¹é‡æ›¿æ¢æ‰æ–‡æœ¬ä¸­çš„å†…å®¹ sed\nè¯­æ³•: sed [option] 'sed command' fileName\nå…¨å stream editorï¼Œ æµç¼–è¾‘å™¨ é€‚åˆå¯¹æ–‡æœ¬å†…å®¹è¿›è¡Œå¤„ç† 1sed \u0026#39;s/^Str/String/\u0026#39; fileName.txt # æ›¿æ¢å†…å®¹åè¾“å‡º ^ è¡¨ç¤ºä»¥Str å¼€å¤´çš„ 2 3sed -i \u0026#39;s/^Str/String/\u0026#39; fileName.txt # æ›¿æ¢æºæ–‡ä»¶çš„å†…å®¹ï¼Œ æ— è¾“å‡º 4 5sed -i \u0026#39;s/\\.$/\\;/\u0026#39; fileName.txt # $ ä»£è¡¨ä»¥...ç»“æŸ 6 7sed -i \u0026#39;s/Jack/me/g\u0026#39; fileName.txt # g è¡¨ç¤ºå…¨æ–‡æ›¿æ¢ï¼Œå¦‚æœæ²¡æœ‰gåªä¼šæ›¿æ¢ç¬¬ä¸€ä¸ª 8 9sed -i \u0026#39;/^ *$/d\u0026#39; fileName.txt # åˆ é™¤ç©º 10 11sed -i \u0026#39;/Integer/d\u0026#39; fileName.txt # åˆ é™¤åŒ…å«Integer çš„è¡Œ è·³æ§½è¿‡ç¨‹ä¸­å®¹æ˜“è¢«å¿½ç•¥çš„ç»†èŠ‚ é¢è¯•è¦å·å·æ‘¸æ‘¸è¿›è¡Œ é¢è¯•æ—¶é—´ä¸è¦ä¸€å‘³çš„å°†å°±å¯¹æ–¹ æç¦»èŒè¦è°¨æ…ï¼Œ æ‹¿åˆ°offerå†ç¦»èŒ å¥½èšå¥½æ•£ è·³æ§½æ—¶é—´è¡”æ¥ï¼š ä¸€èˆ¬15å·ä¹‹åç¦»èŒï¼Œ ä¸‹ä¸ªæœˆ15å·å‰å…¥èŒç¤¾ä¿ä¸ä¼šæ–­ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/5th_Linux/","summary":"Linux Linux çš„ä½“ç³»ç»“æ„ ä½“ç³»ç»“æ„ä¸»è¦åˆ†ä¸º ç”¨æˆ·æ€(ç”¨æˆ·ä¸Šå±‚æ´»åŠ¨)å’Œå†…æ ¸æ€ å†…æ ¸ï¼š æœ¬è´¨æ˜¯ä¸€æ®µç®¡ç†è®¡ç®—æœºç¡¬ä»¶è®¾å¤‡çš„ç¨‹åº ç³»ç»Ÿè°ƒç”¨ï¼šå†…æ ¸çš„è®¿é—®æ¥å£ï¼Œæ˜¯ä¸€ç§ä¸èƒ½å†ç®€åŒ–çš„æ“ä½œã€‚ åŸå­æ€§çš„æ“ä½œã€‚ å…¬ç”¨å‡½æ•°åº“ï¼š ç³»ç»Ÿè°ƒç”¨çš„ç»„åˆæ‹³ Shell:å‘½ä»¤è§£é‡Šå™¨ï¼Œ å¯ç¼–ç¨‹ windows - cigwin\næŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨ Linux - man 2 syscalls less / more / cat /tail\nåˆ‡æ¢é»˜è®¤shell\næŸ¥æ‰¾ç‰¹å®šçš„æ–‡ä»¶ find\nè¯­æ³•ï¼š find path [options] params ä½œç”¨ï¼š åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶ 1find ./ -name \u0026#34;fileName\u0026#34; # ç²¾ç¡®æŸ¥æ‰¾ 2find ~ -name \u0026#34;target*\u0026#34; # æ¨¡ç³ŠæŸ¥æ‰¾æ–‡ä»¶ 3find ~ -iname \u0026#34;target*\u0026#34; # å¿½ç•¥å¤§å°å†™çš„æŸ¥æ‰¾ 4man find # æŸ¥çœ‹findçš„ä½¿ç”¨è¯´æ˜ æ£€ç´¢æ–‡ä»¶å†…å®¹ grep\nè¯­æ³•ï¼š grep [options] pattern file å…¨ç§° Global Regular Expression Print ä½œç”¨ï¼š ç”¨äºæŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸², æ™ºæ…§ç­›é€‰å‡ºç›®æ ‡å­—ç¬¦ä¸²æ‰€åœ¨çš„è¡Œ 1grep \u0026#34;moo\u0026#34; target* # æŸ¥æ‰¾ target* å¼€å¤´çš„æ–‡ä»¶ä¸­åŒ…å« \u0026#34;moo\u0026#34; çš„è¡Œ ç®¡é“æ“ä½œç¬¦ | å¯ä»¥å°†æŒ‡ä»¤è¿æ¥èµ·æ¥ï¼Œå‰ä¸€ä¸ªæŒ‡ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªæŒ‡ä»¤çš„è¾“å…¥ åªå¤„ç†å‰ä¸€ä¸ªå‘½ä»¤çš„æ­£ç¡®è¾“å‡ºï¼Œ ä¸å¤„ç†é”™è¯¯è¾“å‡º å³è¾¹å‘½ä»¤å¿…é¡»æ¥æ”¶æ ‡å‡†è¾“å…¥æµï¼Œå¦åˆ™ä¼ é€’è¿‡ç¨‹ä¸­æ•°æ®ä¼šè¢«æŠ›å¼ƒ sed, awk, grep, cut, head, top, less, more, wc, join, sort, split ç­‰ 1grep \u0026#39;partial\\[true\\]\u0026#39; test.","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/6th_JVM/","summary":"","tags":null,"title":""},{"categories":null,"contents":"1. åƒåœ¾å›æ”¶ä¹‹æ ‡è®°ç®—æ³• GC\nå¯¹è±¡è¢«åˆ¤å®šä¸ºåƒåœ¾çš„æ ‡å‡† æ²¡æœ‰è¢«å…¶ä»–å¯¹è±¡å¼•ç”¨ åˆ¤å®šå¯¹è±¡æ˜¯å¦ä¸ºåƒåœ¾çš„ç®—æ³• å¼•ç”¨è®¡æ•°æ³• é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨æ•°é‡å†³å®šå¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶ æ¯ä¸ªå¯¹è±¡å®ä¾‹éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œè¢«å¼•ç”¨åˆ™+1ï¼Œ å®Œæˆå¼•ç”¨åˆ™-1 ä»»ä½•å¼•ç”¨è®¡æ•°ä¸º0çš„å®ä¾‹ å¯ä»¥å½“åšåƒåœ¾è¢«å›æ”¶ ä¼˜ç‚¹ï¼š æ‰§è¡Œæ•ˆç‡é«˜ï¼Œ ç¨‹åºå—å½±å“æ¯”è¾ƒå° ç¼ºç‚¹ï¼š æ— æ³•æ£€æµ‹å‡ºå¾ªç¯å¼•ç”¨çš„æƒ…å†µï¼Œå¯¼è‡´å†…å­˜æ³„éœ²\nå¯è¾¾æ€§åˆ†æç®—æ³• é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨é“¾æ˜¯å¦å¯è¾¾åˆ°ï¼Œæ¥å†³å®šå¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶\nå¯ä»¥ä½œä¸ºGC Rootçš„å¯¹è±¡ï¼š\nè™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ æ–¹æ³•åŒºä¸­çš„å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNI(Native æ–¹æ³•) çš„å¼•ç”¨å¯¹è±¡ æ´»è·ƒçº¿ç¨‹çš„å¼•ç”¨å¯¹è±¡ 2. è°ˆè°ˆä½ äº†è§£çš„åƒåœ¾å›æ”¶ç®—æ³• æ ‡è®°-æ¸…é™¤æ³• Mark and Sweep æ ‡è®°ï¼š ä»æ ¹é›†åˆè¿›è¡Œæ‰«æï¼Œå¯¹å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ ‡è®° æ¸…é™¤ï¼š å¯¹å †å†…å­˜ä»å¤´åˆ°å°¾è¿›è¡Œçº¿æ€§éå†ï¼Œå›æ”¶ä¸å¯è¾¾å¯¹è±¡å†…å­˜\nMark é˜¶æ®µ -\u0026gt; Sweep é˜¶æ®µ\nå­˜åœ¨é—®é¢˜ï¼š ç¢ç‰‡åŒ–ä¸¥é‡ï¼Œå¤§å¯¹è±¡æ— æ³•æ‰¾åˆ°è¿ç»­çš„å†…å­˜ï¼Œå®¹æ˜“è§¦å‘ä¸‹æ¬¡åƒåœ¾å›æ”¶ï¼Œoutofmemery\nå¤åˆ¶ç®—æ³• Coping - å¹´è½»ä»£ é€‚ç”¨äºå¯¹è±¡å­˜æ´»æ—¶é—´æ¯”è¾ƒä½çš„æƒ…å†µ\nåˆ†ä¸ºå¯¹è±¡é¢å’Œç©ºé—²é¢ å¯¹è±¡åœ¨å¯¹è±¡é¢ä¸Šåˆ›å»º å­˜æ´»å¯¹è±¡ä»å¯¹è±¡é¢å¤åˆ¶åˆ°ç©ºé—²é¢ å°†å¯¹è±¡é¢æ‰€æœ‰å¯¹è±¡å†…å­˜æ¸…é™¤ æœ‰ç‚¹ï¼š è§£å†³äº†ç¢ç‰‡åŒ–é—®é¢˜ï¼Œ é¡ºåºåˆ†é…å†…å­˜ï¼Œç®€å•é«˜æ•ˆï¼Œé€‚ç”¨äºå¯¹è±¡å­˜æ´»ç‡ä½çš„åœºæ™¯\u0026ndash;å¹´è½»ä»£\næ ‡è®°æ•´ç†æ³• - è€å¹´ä»£ æ•´ç†ï¼š ç§»åŠ¨æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ï¼Œä¸”æŒ‰å†…å­˜åœ°å€æ¬¡åºä¾æ¬¡æ’åˆ—ï¼Œç„¶åå°†æœ«ç«¯å†…å­˜åœ°å€ä»¥åçš„å†…å­˜å…¨éƒ¨å›æ”¶ã€‚\nä¼˜ç‚¹ï¼š é¿å…äº†å†…å­˜ä¸è¿ç»­ï¼Œä¸ç”¨è®¾ç½®ä¸¤å—å†…å­˜äº’æ¢ï¼Œé€‚ç”¨äºå­˜æ´»ç‡é«˜çš„åœºæ™¯\nåˆ†ä»£æ”¶é›†ç®—æ³• åƒåœ¾å›æ”¶ç®—æ³•çš„ç»„åˆæ‹³\næŒ‰ç…§ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒåˆ’åˆ†åŒºåŸŸï¼Œ ä»¥é‡‡ç”¨ä¸åŒçš„åƒåœ¾å›æ”¶ç®—æ³• æé«˜äº†JVMçš„åƒåœ¾å›æ”¶æ•ˆç‡ Survivor Partitiion å¹´è½»ä»£ å¤åˆ¶ç®—æ³•\n|Eden Space|From Space| To Space|\nOld Generation è€å¹´ä»£ - æ ‡è®°æ¸…é™¤ç®—æ³• æ ‡è®°æ•´ç†ç®—æ³•\nTenured Space\nPermanen Generation æŒä¹…ä»£ -\nPermanent Space\nGC çš„åˆ†ç±» Minor GC\næ–°ç”Ÿä»£ï¼š å°½å¯èƒ½çš„å°½å¿«æ”¶é›†æ‰é‚£äº›ç”Ÿå‘½å‘¨çŸ­çš„å¯¹è±¡\nFull GC\nä¸»è¦å›æ”¶è€å¹´ä»£\nFull GCæ¯”Minor GC æ…¢, ä½†æ˜¯æ‰§è¡Œé¢‘ç‡ä½\næ–°ç”Ÿä»£ 1/3 å †ç©ºé—´ Eden 8/10 | from 1/10 | to 1/10\nè€å¹´ä»£ 2/3 å †ç©ºé—´\nå¹´è½»ä»£åƒåœ¾å›æ”¶è¿‡ç¨‹\nEden åŒºåŸŸæ»¡ä¼šå‡ºå‘ä¸€æ¬¡Minor GC Eden å’Œ From åŒºåŸŸä¸­çš„å¯¹è±¡ä¼šå…¨éƒ¨ç§»åŠ¨åˆ° to åŒºåŸŸï¼Œ å¯¹è±¡çš„age++ï¼ŒåŒæ—¶æ¸…ç©ºEdenå’ŒFromåŒºåŸŸ\nå¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£ æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡è¾¾åˆ°ä¸€å®šçš„å¹´é¾„åä¼šç§»åŠ¨åˆ°è€å¹´ä»£ 15å²é»˜è®¤ æ–°ç”Ÿä»£åŒºåŸŸEdenå’Œ Suivivorè£…ä¸ä¸‹çš„å¤§å¯¹è±¡ä¼šç›´æ¥ç§»åŠ¨åˆ°è€å¹´ä»£ è¿™å—åŒºåŸŸé‡‡ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼Œ é€šå¤šç§»åŠ¨å †é¡¶æŒ‡é’ˆå®ç°åƒåœ¾å›æ”¶\nå¯¹è±¡å¦‚ä½•æ™‹å‡åˆ°è€å¹´ä»£ ç»å†ä¸€å®šçš„minor æ¬¡æ•°åä¾ç„¶å­˜æ´»çš„å¯¹è±¡\nSurvivor åŒºåŸŸå­˜æ”¾ä¸ä¸‹çš„å¯¹è±¡\næ–°ç”Ÿçš„å¤§å¯¹è±¡-XX: +PretenureSizeThreshold\nå¸¸ç”¨çš„è°ƒä¼˜å‚æ•° -XX: SurvivorRatio Eden å’Œ Survivor çš„æ¯”å€¼ï¼Œ é»˜è®¤ä¸º8:1 -XX: NewRatio è€å¹´ä»£å’Œå¹´è½»ä»£å†…å­˜å¤§å°çš„æ¯”ä¾‹ -XX: MaxTenuringThreshold å¯¹è±¡ä»å¹´è½»ä»£æ™‹å‡åˆ°è€å¹´ä»£ç»è¿‡GCæ¬¡æ•°çš„æœ€å¤§é˜ˆå€¼\nè€å¹´ä»£ï¼š å­˜æ”¾ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡ æ ‡è®°æ¸…é™¤æ³• æ ‡è®°æ•´ç†æ³•\nè§¦å‘Full GCçš„æ¡ä»¶ è€å¹´ä»£ç©ºé—´ä¸è¶³ æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³(Before Java7)Java8 ä»¥åæ²¡æœ‰æ°¸ä¹…ä»£ï¼Œä½¿ç”¨å…ƒç©ºé—´ä»£æ›¿ Minor GCæ—¶æ™‹å‡åˆ°è€å¹´ä»£çš„å¹³å‡å¤§å°å¤§äºè€å¹´ä»£çš„å‰©ä½™ç©ºé—´ è°ƒç”¨System.gc()æ—¶ CMG GCæ—¶å‡ºç°promotion failedï¼Œ concurrent mode failed ä½¿ç”¨RMIæ¥è¿›è¡ŒRPCæˆ–ç®¡ç†çš„JDKåº”ç”¨æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡Full GC ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/7th_GC%E7%9B%B8%E5%85%B3/","summary":"1. åƒåœ¾å›æ”¶ä¹‹æ ‡è®°ç®—æ³• GC\nå¯¹è±¡è¢«åˆ¤å®šä¸ºåƒåœ¾çš„æ ‡å‡† æ²¡æœ‰è¢«å…¶ä»–å¯¹è±¡å¼•ç”¨ åˆ¤å®šå¯¹è±¡æ˜¯å¦ä¸ºåƒåœ¾çš„ç®—æ³• å¼•ç”¨è®¡æ•°æ³• é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨æ•°é‡å†³å®šå¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶ æ¯ä¸ªå¯¹è±¡å®ä¾‹éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œè¢«å¼•ç”¨åˆ™+1ï¼Œ å®Œæˆå¼•ç”¨åˆ™-1 ä»»ä½•å¼•ç”¨è®¡æ•°ä¸º0çš„å®ä¾‹ å¯ä»¥å½“åšåƒåœ¾è¢«å›æ”¶ ä¼˜ç‚¹ï¼š æ‰§è¡Œæ•ˆç‡é«˜ï¼Œ ç¨‹åºå—å½±å“æ¯”è¾ƒå° ç¼ºç‚¹ï¼š æ— æ³•æ£€æµ‹å‡ºå¾ªç¯å¼•ç”¨çš„æƒ…å†µï¼Œå¯¼è‡´å†…å­˜æ³„éœ²\nå¯è¾¾æ€§åˆ†æç®—æ³• é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨é“¾æ˜¯å¦å¯è¾¾åˆ°ï¼Œæ¥å†³å®šå¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶\nå¯ä»¥ä½œä¸ºGC Rootçš„å¯¹è±¡ï¼š\nè™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ æ–¹æ³•åŒºä¸­çš„å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNI(Native æ–¹æ³•) çš„å¼•ç”¨å¯¹è±¡ æ´»è·ƒçº¿ç¨‹çš„å¼•ç”¨å¯¹è±¡ 2. è°ˆè°ˆä½ äº†è§£çš„åƒåœ¾å›æ”¶ç®—æ³• æ ‡è®°-æ¸…é™¤æ³• Mark and Sweep æ ‡è®°ï¼š ä»æ ¹é›†åˆè¿›è¡Œæ‰«æï¼Œå¯¹å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ ‡è®° æ¸…é™¤ï¼š å¯¹å †å†…å­˜ä»å¤´åˆ°å°¾è¿›è¡Œçº¿æ€§éå†ï¼Œå›æ”¶ä¸å¯è¾¾å¯¹è±¡å†…å­˜\nMark é˜¶æ®µ -\u0026gt; Sweep é˜¶æ®µ\nå­˜åœ¨é—®é¢˜ï¼š ç¢ç‰‡åŒ–ä¸¥é‡ï¼Œå¤§å¯¹è±¡æ— æ³•æ‰¾åˆ°è¿ç»­çš„å†…å­˜ï¼Œå®¹æ˜“è§¦å‘ä¸‹æ¬¡åƒåœ¾å›æ”¶ï¼Œoutofmemery\nå¤åˆ¶ç®—æ³• Coping - å¹´è½»ä»£ é€‚ç”¨äºå¯¹è±¡å­˜æ´»æ—¶é—´æ¯”è¾ƒä½çš„æƒ…å†µ\nåˆ†ä¸ºå¯¹è±¡é¢å’Œç©ºé—²é¢ å¯¹è±¡åœ¨å¯¹è±¡é¢ä¸Šåˆ›å»º å­˜æ´»å¯¹è±¡ä»å¯¹è±¡é¢å¤åˆ¶åˆ°ç©ºé—²é¢ å°†å¯¹è±¡é¢æ‰€æœ‰å¯¹è±¡å†…å­˜æ¸…é™¤ æœ‰ç‚¹ï¼š è§£å†³äº†ç¢ç‰‡åŒ–é—®é¢˜ï¼Œ é¡ºåºåˆ†é…å†…å­˜ï¼Œç®€å•é«˜æ•ˆï¼Œé€‚ç”¨äºå¯¹è±¡å­˜æ´»ç‡ä½çš„åœºæ™¯\u0026ndash;å¹´è½»ä»£\næ ‡è®°æ•´ç†æ³• - è€å¹´ä»£ æ•´ç†ï¼š ç§»åŠ¨æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ï¼Œä¸”æŒ‰å†…å­˜åœ°å€æ¬¡åºä¾æ¬¡æ’åˆ—ï¼Œç„¶åå°†æœ«ç«¯å†…å­˜åœ°å€ä»¥åçš„å†…å­˜å…¨éƒ¨å›æ”¶ã€‚\nä¼˜ç‚¹ï¼š é¿å…äº†å†…å­˜ä¸è¿ç»­ï¼Œä¸ç”¨è®¾ç½®ä¸¤å—å†…å­˜äº’æ¢ï¼Œé€‚ç”¨äºå­˜æ´»ç‡é«˜çš„åœºæ™¯\nåˆ†ä»£æ”¶é›†ç®—æ³• åƒåœ¾å›æ”¶ç®—æ³•çš„ç»„åˆæ‹³\næŒ‰ç…§ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒåˆ’åˆ†åŒºåŸŸï¼Œ ä»¥é‡‡ç”¨ä¸åŒçš„åƒåœ¾å›æ”¶ç®—æ³• æé«˜äº†JVMçš„åƒåœ¾å›æ”¶æ•ˆç‡ Survivor Partitiion å¹´è½»ä»£ å¤åˆ¶ç®—æ³•","tags":null,"title":""},{"categories":null,"contents":"Java å¤šçº¿ç¨‹ä¸å¹¶å‘ 1. è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ« å…³äºjdkç‰ˆæœ¬çš„é€‰æ‹© JDK8,JDK11:Oracle é•¿æœŸæ”¯æŒ\nJavaçº¿ç¨‹çŸ¥è¯†è€ƒç‚¹ è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„è½¬æ¢\nè¿›ç¨‹å’Œçº¿ç¨‹çš„ç”±æ¥ ä¸²è¡Œ åˆæœŸçš„è®¡ç®—æœºåªèƒ½æ‰§è¡Œä¸²è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå¹¶ä¸”éœ€è¦é•¿æ—¶é—´ç­‰å¾…ç”¨æˆ·è¾“å…¥\næ‰¹å¤„ç† é¢„å…ˆå°†ç”¨æˆ·æŒ‡ä»¤é›†ä¸­æˆæ¸…å•ï¼Œæ‰¹é‡ä¸²è¡Œå¤„ç†ç”¨æˆ·æŒ‡ä»¤ï¼Œä»ç„¶æ— æ³•å¹¶å‘æ‰§è¡Œ\nè¿›ç¨‹ è¿›ç¨‹ç‹¬å å†…å­˜ç©ºé—´ï¼Œä¿å­˜å„è‡ªè¿è¡ŒçŠ¶æ€ï¼Œç›¸äº’é—´ä¸å¹²æ‰°ä¸”å¯ä»¥äº’ç›¸åˆ‡æ¢ï¼Œä¸ºå¹¶å‘å¤„ç†ä»»åŠ¡æä¾›äº†å¯èƒ½\nçº¿ç¨‹ å…±äº«è¿›ç¨‹çš„å†…å­˜èµ„æºï¼Œç›¸äº’é—´åˆ‡æ¢æ›´å¿«æ·ï¼Œæ”¯æŒæ›´ç»†ç²’åº¦çš„ä»»åŠ¡æ§åˆ¶ï¼Œä½¿è¿›ç¨‹å†…çš„å­ä»»åŠ¡å¾—ä»¥å¹¶å‘æ‰§è¡Œ\nè¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½\næ‰€æœ‰ä¸è¿›ç¨‹ç›¸å…³çš„èµ„æºï¼Œéƒ½è¢«è®°å½•åœ¨PCBä¸­\nè¿›ç¨‹æ˜¯æŠ¢å å¤„ç†æœºçš„è°ƒåº¦å•ä½ï¼›çº¿ç¨‹å±äºæŸä¸ªè¿›ç¨‹ï¼Œå…±äº«å…¶èµ„æº\nçº¿ç¨‹åªç”±å †æ ˆå¯„å­˜å™¨ã€ç¨‹åºè®¡æ•°å™¨å’ŒTCBç»„æˆ\næ€»ç»“\nçº¿ç¨‹ä¸èƒ½çœ‹åšç‹¬ç«‹åº”ç”¨ï¼Œè€Œè¿›ç¨‹å¯ä»¥çœ‹åšç‹¬ç«‹åº”ç”¨ çº¿ç¨‹æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œ ç›¸äº’ä¸å½±å“ï¼Œçº¿ç¨‹åªæ˜¯è¿›ç¨‹çš„ä¸åŒæ‰§è¡Œè·¯å¾„ çº¿ç¨‹æ²¡æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œå¤šè¿›ç¨‹çš„ç¨‹åºæ¯”å¤šçº¿ç¨‹ç¨‹åºå¥å£® è¿›ç¨‹çš„åˆ‡æ¢æ¯”çº¿ç¨‹çš„åˆ‡æ¢å¼€é”€å¤§ Javaè¿›ç¨‹å’Œçº¿ç¨‹çš„å…³ç³» - Javaå¯¹æ“ä½œç³»ç»Ÿæä¾›çš„åŠŸèƒ½è¿›è¡Œå°è£…ï¼ŒåŒ…æ‹¬è¿›ç¨‹å’Œçº¿ç¨‹ - è¿è¡Œä¸€ä¸ªç¨‹åºä¼šäº§ç”Ÿä¸€ä¸ªè¿›ç¨‹ï¼Œè¿›ç¨‹åŒ…å«è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ - æ¯ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªJVMå®ä¾‹ï¼Œå¤šä¸ªçº¿ç¨‹å…±äº«JVMé‡Œçš„å † - Javaé‡‡ç”¨å•çº¿ç¨‹ç¼–ç¨‹æ¨¡å‹ï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ›å»ºä¸»çº¿ç¨‹ - ä¸»çº¿ç¨‹å¯ä»¥åˆ›å»ºå­çº¿ç¨‹ï¼ŒåŸåˆ™ä¸Šè¦åäºå­çº¿ç¨‹å®Œæˆæ‰§è¡Œ 2. Thread ä¸­startå’Œrunæ–¹æ³•çš„åŒºåˆ« start native æ–¹æ³• openjdk.java.net\nè°ƒç”¨start() æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­çº¿ç¨‹å¹¶å¯åŠ¨ run()æ–¹æ³•åªæ˜¯ä¸€ä¸ªThreadçš„ä¸€ä¸ªæ™®é€šæ–¹æ³•çš„è°ƒç”¨ 3. Thread å’ŒRunnable çš„åŒºåˆ« Thread å®ç°äº†Runnableæ¥å£çš„ç±»ï¼Œä½¿å¾—runæ”¯æŒå¤šçº¿ç¨‹ Runnable åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•run å› ä¸ºå•ä¸€ç»§æ‰¿çš„åŸåˆ™ï¼Œæ¨èå¤šä½¿ç”¨Runnableç»“æ„ 4. å¦‚ä½•ç»™run()æ–¹æ³•ä¼ å‚ å®ç°æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§\næ„é€ å‡½æ•°ä¼ å‚ æˆå‘˜å˜é‡ä¼ å‚ å›è°ƒå‡½æ•°ä¼ å‚ å¦‚ä½•å®ç°å¤„ç†çº¿ç¨‹çš„è¿”å›å€¼ å®ç°æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§\nä¸»çº¿ç¨‹ç­‰å¾…æ³•ï¼ˆæœ‰å¤šä¸ªå˜é‡çš„æ—¶å€™æ¯”è¾ƒéš¾å¤„ç†ï¼Œå¾ªç¯ç­‰å¾…çš„æ—¶é—´æ˜¯ä¸ç²¾ç¡®çš„ï¼‰ ä½¿ç”¨Threadçš„join()æ–¹æ³•é˜»å¡å½“å‰çº¿ç¨‹ä»¥ç­‰å¾…å­çº¿ç¨‹å¤„ç†å®Œæ¯•(ç²’åº¦ä¸å¤Ÿç»†) é€šè¿‡Callableæ¥å£æ˜¯å®ç°ï¼š é€šè¿‡FutureTask æˆ–è€… çº¿ç¨‹æ± è·å– 5.çº¿ç¨‹çš„çŠ¶æ€ Thread æºç ä¸­æœ‰enum state å…­ä¸ªçŠ¶æ€ï¼š\næ–°å»º NEW: åˆ›å»ºåå°šæœªå¯åŠ¨çš„çº¿ç¨‹çŠ¶æ€ è¿è¡Œ RUNNABLEï¼šåŒ…å«Running å’Œ Ready(ç­‰å¾…æ—¶é—´ç‰‡è½®è½¬) æ— é™æœŸç­‰å¾… WAITINGï¼šä¸ä¼šåˆ†é…CPUæ‰§è¡Œæ—¶é—´ï¼Œéœ€è¦è¢«æ˜¾å¼çš„å”¤é†’ æ²¡æœ‰è®¾ç½®Timeoutå‚æ•°çš„Object.wait() æ–¹æ³• æ²¡æœ‰è®¾ç½®Timeoutå‚æ•°çš„Thread.join() æ–¹æ³• LockSupport.park()æ–¹æ³• é™æœŸç­‰å¾… Time Waiting åœ¨ä¸€å®šæ—¶é—´åä¼šç”±ç³»ç»Ÿè‡ªåŠ¨å”¤é†’ Thread.sleep()æ–¹æ³• è®¾ç½®äº†Timeoutå‚æ•°çš„Object.wait()æ–¹æ³•ã€‚ è®¾ç½®äº†Timeoutå‚æ•°çš„Thread.join()æ–¹æ³•ã€‚ LockSupport.parkNanos()æ–¹æ³•ã€‚ LockSupport.patkUtil()æ–¹æ³•ã€‚ é˜»å¡ Blocked ç­‰å¾…è·å–æ’å®ƒé” synchronized å…³é”®å­— ç»“æŸ Terminated : å·²ç»ˆæ­¢çº¿ç¨‹çš„çŠ¶æ€ï¼Œçº¿ç¨‹å·²ç»ç»“æŸæ‰§è¡Œã€‚ï¼ˆå·²ç»ç»ˆæ­¢çš„çº¿ç¨‹ä¸å¯ä»¥å†æ¬¡æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ›å‡ºIlleagleThreadStateExceptionï¼‰ 6 sleepå’Œwaitçš„åŒºåˆ« åŸºæœ¬çš„å·®åˆ«ï¼š\nsleep() æ˜¯Threadç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œ waitæ˜¯Objectç±»ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚ sleep()æ–¹æ³•å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ wait()æ–¹æ³•åªèƒ½åœ¨synchronizedæ–¹æ³•æˆ–synchronizedå—ä¸­ä½¿ç”¨ æœ€ä¸»è¦çš„æœ¬è´¨åŒºåˆ« Thread.sleep()åªä¼šè®©å‡ºCPUï¼Œ ä¸ä¼šå¯¼è‡´é”è¡Œä¸ºçš„æ”¹å˜ Object.wait() ä¸ä»…ä¼šè®©å‡ºCPUï¼Œè¿˜ä¼šé‡Šæ”¾å·²ç»å æœ‰çš„åŒæ­¥èµ„æºé” 7.notify å’Œnotifyallçš„åŒºåˆ« å”¤é†’ wait\nä¸¤ä¸ªæ¦‚å¿µ é”æ±  EntryList ç­‰å¾…æ±  WaitSet é”æ±  å‡è®¾çº¿ç¨‹Aå·²ç»æ‹¥æœ‰äº†æŸä¸ªå¯¹è±¡(ä¸æ˜¯ç±»)çš„é”ï¼Œè€Œå…¶ä»–çº¿ç¨‹B/Cæƒ³è¦è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æŸä¸ªsynchronizeæ–¹æ³•(æˆ–è€…å—)ï¼Œç”±äºB/Cçº¿ç¨‹åœ¨è¿›å…¥å¯¹è±¡çš„synchronizedæ–¹æ³•(æˆ–è€…å—)ä¹‹å‰å¿…é¡»è·å¾—è¯¥å¯¹è±¡é”çš„æ‹¥æœ‰æƒï¼Œ è€Œæ°å·§è¯¥å¯¹è±¡çš„é”ç›®å‰æ­£åœ¨çº¿ç¨‹Aæ‰€å ç”¨ï¼Œ æ­¤æ—¶B/Cçº¿ç¨‹å°±ä¼šè¢«é˜»å¡ï¼Œ è¿›å…¥ä¸€ä¸ªåœ°æ–¹å»ç­‰å¾…é”çš„é‡Šæ”¾ï¼Œ è¿™ä¸ªåœ°æ–¹ä¾¿æ˜¯è¯¥å¯¹è±¡çš„é”æ± ã€‚ ç­‰å¾…æ±  å‡è®¾çº¿ç¨‹Aè°ƒç”¨äº†æŸä¸ªå¯¹è±¡çš„wait()æ–¹æ³•ï¼Œ çº¿ç¨‹Aå°±ä¼šé‡Šæ”¾è¯¥å¯¹è±¡çš„é”ï¼Œ åŒæ—¶çº¿ç¨‹Aå°±è¿›å…¥äº†è¯¥å¯¹è±¡çš„ç­‰å¾…æ± ä¸­ï¼Œè¿›å…¥åˆ°ç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ä¸ä¼šå»ç«äº‰è¯¥å¯¹è±¡çš„èµ„æºé”ã€‚\nnotifyå’Œnotifyallçš„åŒºåˆ« notifyAll ä¼šè®©æ‰€æœ‰å¤„äºç­‰å¾…æ± ä¸­çš„çº¿ç¨‹å…¨éƒ¨è¿›å…¥é”æ± å»ç«äº‰è·å–é”çš„æœºä¼š notify åªä¼šéšæœºé€‰å–ä¸€ä¸ªå¤„äºç­‰å¾…æ± ä¸­çš„çº¿ç¨‹è¿›å…¥é”æ± å»ç«äº‰è·å–é”çš„æœºä¼š volatile ä¿®é¥°çš„å˜é‡ï¼Œä¸€æ—¦çº¿ç¨‹Aå¯¹å…¶è¿›è¡Œæ”¹åŠ¨ï¼Œ çº¿ç¨‹ B/C/Dèƒ½å¤Ÿç«‹é©¬çœ‹çº¿ç¨‹Aå¯¹å…¶çš„æ”¹åŠ¨\n8 yieldå‡½æ•° æ¦‚å¿µ å½“è°ƒç”¨Thread.yield()å‡½æ•°æ—¶ï¼Œ ä¼šç»™å½“å‰çº¿ç¨‹è°ƒåº¦å™¨ä¸€ä¸ªå½“å‰çº¿ç¨‹æ„¿æ„è®©å‡ºCPUçš„æš—ç¤ºï¼Œä½†æ˜¯çº¿ç¨‹è°ƒåº¦å™¨å¯èƒ½ä¼šå¿½ç•¥è¿™ä¸ªæš—ç¤ºã€‚ yieldå¹¶ä¸ä¼šè®©å½“å‰çº¿ç¨‹é‡Šæ”¾å·²ç»è·å¾—çš„é”\n9. å¦‚ä½•ä¸­æ–­çº¿ç¨‹ å·²ç»è¢«æŠ›å¼ƒçš„æ–¹æ³•ï¼š\né€šè¿‡è°ƒç”¨stop()æ–¹æ³•åœæ­¢çº¿ç¨‹ å¤ªè¿‡äºæš´åŠ›ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•°æ®ä¸åŒæ­¥ é€šè¿‡è°ƒç”¨suspend() å’Œ resume() æ–¹æ³• ç›®å‰ä½¿ç”¨çš„æ–¹æ³• è°ƒç”¨interrupt()ï¼Œé€šçŸ¥çº¿ç¨‹åº”è¯¥ä¸­æ–­äº† å¦‚æœçº¿ç¨‹å¤„äºè¢«é˜»å¡çŠ¶æ€ï¼Œé‚£ä¹ˆçº¿ç¨‹å°†ç«‹å³é€€å‡ºè¢«é˜»å¡çŠ¶æ€ï¼Œå¹¶ä¸”æŠ›å‡ºä¸€ä¸ªInterruptedExceptionå¼‚å¸¸ã€‚ å¦‚æœçº¿ç¨‹å¤„äºæ­£å¸¸æ´»åŠ¨çŠ¶æ€ï¼Œé‚£ä¹ˆä¼šå°†è¯¥çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—è®¾ç½®ä¸ºtrueã€‚è¢«è®¾ç½®ä¸­æ–­æ ‡å¿—çš„çº¿ç¨‹å°†ä¼šç»§ç»­æ­£å¸¸è¿è¡Œï¼Œä¸å—å½±å“ã€‚ éœ€è¦è¢«è°ƒç”¨çš„çº¿ç¨‹é…åˆä¸­æ–­ åœ¨æ­£å¸¸è¿è¡Œä»»åŠ¡æ—¶ï¼Œç»å¸¸æ£€æŸ¥æœ¬çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½ï¼Œå¦‚æœè®¾ç½®çš„äº†ä¸­æ–­æ ‡å¿—ä½å°±è‡ªè¡Œåœæ­¢çº¿ç¨‹ã€‚ å¦‚æœçº¿ç¨‹å¤„äºæ­£å¸¸æ´»è·ƒçŠ¶æ€ï¼Œé‚£ä¹ˆä¼šå°†è¯¥çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—è®¾ç½®ä¸ºtrueã€‚ è¢«è®¾ç½®ä¸­æ–­æ ‡å¿—çš„çº¿ç¨‹å°†ç»§ç»­æ­£å¸¸è¿è¡Œï¼Œä¸å—å½±å“ã€‚ 10. å‰è¿°æ–¹æ³•ä»¥åŠçº¿ç¨‹çŠ¶æ€æ€»ç»“ çŠ¶æ€è½¬æ¢å›¾\nå½©è›‹ å¦‚ä½•æœ‰æ•ˆè°ˆè–ªèµ„ å¢åŠ è‡ªå·±çš„ç­¹ç \nå°½é‡æ‰“å¬å…¬å¸å²—ä½èŒä½çš„è–ªé…¬å¹…åº¦ é˜¿é‡Œp6 ç™¾åº¦ p4 p5 æ„ŸçŸ¥ç›®æ ‡å…¬å¸çš„ç¼ºäººç¨‹åº¦ï¼Œ å·¥ä½œçš„ç´§æ€¥ç¨‹åº¦ å…¥èŒæ—¶é—´ æœ€æœ‰æ•ˆçš„æ–¹å¼æ˜¯å·²ç»å…·å¤‡äº†æœ‰ç«äº‰åŠ›çš„offer ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/8th_java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%B9%B6%E5%8F%91/","summary":"Java å¤šçº¿ç¨‹ä¸å¹¶å‘ 1. è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ« å…³äºjdkç‰ˆæœ¬çš„é€‰æ‹© JDK8,JDK11:Oracle é•¿æœŸæ”¯æŒ\nJavaçº¿ç¨‹çŸ¥è¯†è€ƒç‚¹ è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„è½¬æ¢\nè¿›ç¨‹å’Œçº¿ç¨‹çš„ç”±æ¥ ä¸²è¡Œ åˆæœŸçš„è®¡ç®—æœºåªèƒ½æ‰§è¡Œä¸²è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå¹¶ä¸”éœ€è¦é•¿æ—¶é—´ç­‰å¾…ç”¨æˆ·è¾“å…¥\næ‰¹å¤„ç† é¢„å…ˆå°†ç”¨æˆ·æŒ‡ä»¤é›†ä¸­æˆæ¸…å•ï¼Œæ‰¹é‡ä¸²è¡Œå¤„ç†ç”¨æˆ·æŒ‡ä»¤ï¼Œä»ç„¶æ— æ³•å¹¶å‘æ‰§è¡Œ\nè¿›ç¨‹ è¿›ç¨‹ç‹¬å å†…å­˜ç©ºé—´ï¼Œä¿å­˜å„è‡ªè¿è¡ŒçŠ¶æ€ï¼Œç›¸äº’é—´ä¸å¹²æ‰°ä¸”å¯ä»¥äº’ç›¸åˆ‡æ¢ï¼Œä¸ºå¹¶å‘å¤„ç†ä»»åŠ¡æä¾›äº†å¯èƒ½\nçº¿ç¨‹ å…±äº«è¿›ç¨‹çš„å†…å­˜èµ„æºï¼Œç›¸äº’é—´åˆ‡æ¢æ›´å¿«æ·ï¼Œæ”¯æŒæ›´ç»†ç²’åº¦çš„ä»»åŠ¡æ§åˆ¶ï¼Œä½¿è¿›ç¨‹å†…çš„å­ä»»åŠ¡å¾—ä»¥å¹¶å‘æ‰§è¡Œ\nè¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½\næ‰€æœ‰ä¸è¿›ç¨‹ç›¸å…³çš„èµ„æºï¼Œéƒ½è¢«è®°å½•åœ¨PCBä¸­\nè¿›ç¨‹æ˜¯æŠ¢å å¤„ç†æœºçš„è°ƒåº¦å•ä½ï¼›çº¿ç¨‹å±äºæŸä¸ªè¿›ç¨‹ï¼Œå…±äº«å…¶èµ„æº\nçº¿ç¨‹åªç”±å †æ ˆå¯„å­˜å™¨ã€ç¨‹åºè®¡æ•°å™¨å’ŒTCBç»„æˆ\næ€»ç»“\nçº¿ç¨‹ä¸èƒ½çœ‹åšç‹¬ç«‹åº”ç”¨ï¼Œè€Œè¿›ç¨‹å¯ä»¥çœ‹åšç‹¬ç«‹åº”ç”¨ çº¿ç¨‹æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œ ç›¸äº’ä¸å½±å“ï¼Œçº¿ç¨‹åªæ˜¯è¿›ç¨‹çš„ä¸åŒæ‰§è¡Œè·¯å¾„ çº¿ç¨‹æ²¡æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œå¤šè¿›ç¨‹çš„ç¨‹åºæ¯”å¤šçº¿ç¨‹ç¨‹åºå¥å£® è¿›ç¨‹çš„åˆ‡æ¢æ¯”çº¿ç¨‹çš„åˆ‡æ¢å¼€é”€å¤§ Javaè¿›ç¨‹å’Œçº¿ç¨‹çš„å…³ç³» - Javaå¯¹æ“ä½œç³»ç»Ÿæä¾›çš„åŠŸèƒ½è¿›è¡Œå°è£…ï¼ŒåŒ…æ‹¬è¿›ç¨‹å’Œçº¿ç¨‹ - è¿è¡Œä¸€ä¸ªç¨‹åºä¼šäº§ç”Ÿä¸€ä¸ªè¿›ç¨‹ï¼Œè¿›ç¨‹åŒ…å«è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ - æ¯ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªJVMå®ä¾‹ï¼Œå¤šä¸ªçº¿ç¨‹å…±äº«JVMé‡Œçš„å † - Javaé‡‡ç”¨å•çº¿ç¨‹ç¼–ç¨‹æ¨¡å‹ï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ›å»ºä¸»çº¿ç¨‹ - ä¸»çº¿ç¨‹å¯ä»¥åˆ›å»ºå­çº¿ç¨‹ï¼ŒåŸåˆ™ä¸Šè¦åäºå­çº¿ç¨‹å®Œæˆæ‰§è¡Œ 2. Thread ä¸­startå’Œrunæ–¹æ³•çš„åŒºåˆ« start native æ–¹æ³• openjdk.java.net\nè°ƒç”¨start() æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­çº¿ç¨‹å¹¶å¯åŠ¨ run()æ–¹æ³•åªæ˜¯ä¸€ä¸ªThreadçš„ä¸€ä¸ªæ™®é€šæ–¹æ³•çš„è°ƒç”¨ 3. Thread å’ŒRunnable çš„åŒºåˆ« Thread å®ç°äº†Runnableæ¥å£çš„ç±»ï¼Œä½¿å¾—runæ”¯æŒå¤šçº¿ç¨‹ Runnable åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•run å› ä¸ºå•ä¸€ç»§æ‰¿çš„åŸåˆ™ï¼Œæ¨èå¤šä½¿ç”¨Runnableç»“æ„ 4. å¦‚ä½•ç»™run()æ–¹æ³•ä¼ å‚ å®ç°æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§\næ„é€ å‡½æ•°ä¼ å‚ æˆå‘˜å˜é‡ä¼ å‚ å›è°ƒå‡½æ•°ä¼ å‚ å¦‚ä½•å®ç°å¤„ç†çº¿ç¨‹çš„è¿”å›å€¼ å®ç°æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§\nä¸»çº¿ç¨‹ç­‰å¾…æ³•ï¼ˆæœ‰å¤šä¸ªå˜é‡çš„æ—¶å€™æ¯”è¾ƒéš¾å¤„ç†ï¼Œå¾ªç¯ç­‰å¾…çš„æ—¶é—´æ˜¯ä¸ç²¾ç¡®çš„ï¼‰ ä½¿ç”¨Threadçš„join()æ–¹æ³•é˜»å¡å½“å‰çº¿ç¨‹ä»¥ç­‰å¾…å­çº¿ç¨‹å¤„ç†å®Œæ¯•(ç²’åº¦ä¸å¤Ÿç»†) é€šè¿‡Callableæ¥å£æ˜¯å®ç°ï¼š é€šè¿‡FutureTask æˆ–è€… çº¿ç¨‹æ± è·å– 5.","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/9th_Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%B9%B6%E5%8F%91%E5%8E%9F%E7%90%86/","summary":"","tags":null,"title":""},{"categories":null,"contents":"javabasic è¯¾ç¨‹æ¶‰åŠåˆ°çš„Javaä»£ç ï¼ŒæŒç»­æ›´æ–°ä¸­\u0026hellip;\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E5%89%91%E6%8C%87offer/javabasic/README/","summary":"javabasic è¯¾ç¨‹æ¶‰åŠåˆ°çš„Javaä»£ç ï¼ŒæŒç»­æ›´æ–°ä¸­\u0026hellip;","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%8E%A9%E8%BD%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/8th_%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97%E5%92%8C%E5%A0%86/","summary":"","tags":null,"title":""},{"categories":null,"contents":"ç®—æ³•é¢è¯•åˆ°åº•æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ 1-1 ç®—æ³•é¢è¯•ä¸ä»…ä»…æ˜¯æ­£ç¡®çš„å›ç­”é—®é¢˜ ç®—æ³•é¢è¯•çš„ç›®çš„ å±•ç°æ€è€ƒé—®é¢˜çš„æ–¹å¼ ç®—æ³•é¢è¯•è¿‡ç¨‹ çœ‹åšæ˜¯å’Œé¢è¯•å®˜ä¸€èµ·æ¢è®¨ä¸€ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚å¯¹äºé—®é¢˜çš„ç»†èŠ‚å’Œåº”ç”¨ç¯å¢ƒï¼Œå¯ä»¥å’Œé¢è¯•å®˜æ²Ÿé€šã€‚ è¿™ç§æ²Ÿé€šæœ¬èº«å¾ˆé‡è¦ï¼Œå®ƒæš—ç¤ºç€ä½ æ€è€ƒé—®é¢˜çš„æ–¹å¼ã€‚\næˆ‘ä»¬éœ€è¦å¯¹ä¸€ç»„æ•°æ®è¿›è¡Œæ’åºã€‚ å¿«é€Ÿæ’åºç®—æ³• O(nlogn)\næ­£ç¡®+æ›´ä¼˜ è¿™ç»„æ•°æ®æœ‰ä»€ä¹ˆæ ·çš„ç‰¹å¾ï¼Ÿ æœ‰æ²¡æœ‰å¯èƒ½åŒ…å«æœ‰å¤§é‡çš„é‡å¤å…ƒç´ ï¼Ÿ å¦‚æœæœ‰è¿™ç§å¯èƒ½çš„è¯ï¼Œä¸‰è·¯å¿«æ’æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ Java é»˜è®¤æ˜¯ä¸‰è·¯å¿«æ’ã€‚\nè¿™ç»„æ•°æ®æœ‰ä»€ä¹ˆæ ·çš„ç‰¹å¾ï¼Ÿ æ˜¯å¦å¤§éƒ¨åˆ†æ•°æ®è·ç¦»å®ƒçš„æ­£ç¡®ä½ç½®å¾ˆè¿‘ï¼Ÿæ˜¯å¦è¿‘ä¹æœ‰åºï¼Ÿ å¦‚æœæ˜¯è¿™æ ·çš„è¯æ’å…¥æ’åºæ›´ä¼˜\næ˜¯å¦æ•°æ®çš„å–å€¼èŒƒå›´éå¸¸æœ‰é™ï¼Ÿæ¯”å¦‚å­¦ç”Ÿæˆç»©æ’åºã€‚ è®¡æ•°æ’åºæ›´ä¼˜\nå¯¹æ’åºæœ‰ä»€ä¹ˆé¢å¤–çš„è¦æ±‚ æ˜¯å¦éœ€è¦ç¨³å®šæ’åº å½’å¹¶æ’åºæ›´ä¼˜\næ•°æ®çš„å­˜å‚¨çŠ¶å†µæ˜¯æ€æ ·çš„ å¦‚æœä½¿ç”¨é“¾è¡¨å­˜å‚¨ï¼Œå½’å¹¶æ’åºæ›´ä¼˜\næ•°æ®çš„å¤§å°æ˜¯å¦å¯ä»¥è£…åœ¨å†…å­˜é‡Œï¼Œ å¤–éƒ¨æ’åº\nä»€ä¹ˆæ˜¯æ­£ç¡®çš„å›ç­”ä¸€ä¸ªç®—æ³•é—®é¢˜\næ­£ç¡®è¿˜åŒ…å«å¯¹é—®é¢˜çš„ç‹¬åˆ°è§è§£ï¼Œå®¹é”™æ€§ï¼Œ\n1-2 ç®—æ³•é¢è¯•åªæ˜¯é¢è¯•çš„ä¸€éƒ¨åˆ† ç®—æ³•é¢è¯•ä¼˜ç§€ä¸æ„å‘³ç€æŠ€æœ¯é¢è¯•ä¼˜ç§€\nç®—æ³•é¢è¯•åªæ˜¯æŠ€æœ¯é¢è¯•çš„ä¸€éƒ¨åˆ†\né¡¹ç›®ç»å†å’Œé¡¹ç›®ä¸­é‡åˆ°çš„å®é™…é—®é¢˜\nä½ é‡åˆ°å°è±¡æœ€æ·±çš„bugæ˜¯ä»€ä¹ˆï¼Ÿ\né¢å‘å¯¹è±¡\nè®¾è®¡æ¨¡å¼\nç½‘ç»œç›¸å…³ï¼šå®‰å…¨ç›¸å…³ï¼Œå†…å­˜ç›¸å…³ï¼Œå¹¶å‘ç›¸å…³\nç³»ç»Ÿè®¾è®¡ï¼š scalability\né¢è¯•ä¸ä»…ä»…æ˜¯è€ƒå¯ŸæŠ€æœ¯æ°´å¹³ï¼Œä»¥åŠå¯¹è¿‡å»é¡¹ç›®çš„æ€è€ƒ\né¡¹ç›®ç»å†\né€šè¿‡è¿‡å»äº†è§£ä½ çš„æ€è€ƒè¡Œä¸ºæ–¹å¼\né‡åˆ°çš„æœ€å¤§çš„æŒ‘æˆ˜\nçŠ¯è¿‡çš„é”™è¯¯\né‡åˆ°çš„å¤±è´¥\næœ€äº«å—çš„å·¥ä½œå†…å®¹\né‡åˆ°å†²çªçš„å¤„ç†æ–¹å¼\nåšçš„æœ€ä¸ä¼—ä¸åŒçš„äº‹å„¿\nå‡†å¤‡å¥½åˆé€‚çš„é—®é¢˜é—®é¢è¯•å®˜\n1-3 å¦‚ä½•å‡†å¤‡ç®—æ³•é¢è¯• é¿å…å®Œç¾å­¦ä¹ \nä½¿ç”¨æ—¶é—´ç‰‡å­¦ä¹ \nè¿œè¿œä¸éœ€è¦è¾¾åˆ°ç«èµ›çš„æ°´å¹³\nä¸è¦è½»è§†åŸºç¡€ç®—æ³•å’Œæ•°æ®ç»“æ„ï¼Œè€Œåªå…³æ³¨æœ‰æ„æ€çš„é¢˜ç›®\nå„ç§æ’åºç®—æ³• æŠ€æœ¯æ•°æ®ç»“æ„å’Œç®—æ³•çš„å®ç°ï¼š å¦‚å †ï¼ŒäºŒå‰æ ‘ï¼Œå›¾ åŸºç¡€æ•°æ®ç»“æ„çš„ä½¿ç”¨ï¼š å¦‚é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ã€å“ˆå¸Œè¡¨ã€å›¾ã€Tireã€å¹¶æŸ¥é›† åŸºç¡€ç®—æ³•ï¼š æ·±åº¦ä¼˜å…ˆã€å¹¿åº¦ä¼˜å…ˆã€äºŒåˆ†æŸ¥æ‰¾ã€é€’å½’ åŸºæœ¬ç®—æ³•æ€æƒ³ï¼šé€’å½’ã€åˆ†æ²»ã€å›æº¯æœç´¢ã€è´ªå¿ƒã€åŠ¨æ€è§„åˆ’ é€‰æ‹©åˆé€‚çš„OJ online judge\nleetcodeï¼š online portal for interview\nhackRank: Revolutionizing Tech recruiting\nacmcode\nç«èµ›ç±»oj\ncodeforces\ntopcoder\ncodechef\n1-4 å¦‚ä½•å›ç­”ç®—æ³•é¢è¯•é—®é¢˜ è§£å†³ç®—æ³•é¢è¯•é—®é¢˜çš„æ•´ä½“æ€è·¯\næ³¨æ„é¢˜ç›®ä¸­çš„æ¡ä»¶ï¼Œ\nç»™å®šä¸€ä¸ªæœ‰åºæ•°ç»„\næœ‰ä¸€äº›é¢˜ç›®ä¸­çš„æ¡ä»¶æœ¬è´¨æ˜¯æš—ç¤º\nè®¾è®¡ä¸€ä¸ªO(nlogn)çš„ç®—æ³• åˆ†æ²» æ— éœ€è€ƒè™‘é¢å¤–çš„ç©ºé—´ æ•°æ®è§„æ¨¡å¤§æ¦‚æ˜¯10000 nlogn ç™¾ä¸‡çº§æˆ–è€…åƒä¸‡çº§åˆ«\næ²¡æœ‰æ€è·¯çš„æ—¶å€™ç»™è‡ªå·±å‡ ä¸ªç®€å•çš„ç”¨ä¾‹\næš´åŠ›è§£æ³•æ˜¯æ€è€ƒçš„èµ·ç‚¹\n3ï¼šLongest Substring without Repeating characters åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å¯»æ‰¾æ²¡æœ‰é‡å¤å­—æ¯çš„æœ€é•¿å­ä¸²\nä¼˜åŒ–ç®—æ³•\néå†å¸¸è§çš„ç®—æ³•æ€è·¯\néå†å¸¸è§çš„æ•°æ®ç»“æ„\nç©ºé—´å’Œæ—¶é—´çš„äº¤æ¢ å“ˆå¸Œè¡¨\né¢„å¤„ç†ä¿¡æ¯ æ’åº\nåœ¨ç“¶é¢ˆå¤„å¯»æ‰¾ç­”æ¡ˆï¼š\nå®é™…ç¼–å†™é—®é¢˜\næç«¯æ¡ä»¶çš„åˆ¤æ–­\næ•°ç»„ä¸ºç©ºï¼Œå­—ç¬¦ä¸²ä¸ºç©ºï¼Œ\nå˜é‡å\næ¨¡å—åŒ–å’Œå¤ç”¨æ€§\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95_leetcode%E7%89%88%E6%9C%AC/1st_md/","summary":"ç®—æ³•é¢è¯•åˆ°åº•æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ 1-1 ç®—æ³•é¢è¯•ä¸ä»…ä»…æ˜¯æ­£ç¡®çš„å›ç­”é—®é¢˜ ç®—æ³•é¢è¯•çš„ç›®çš„ å±•ç°æ€è€ƒé—®é¢˜çš„æ–¹å¼ ç®—æ³•é¢è¯•è¿‡ç¨‹ çœ‹åšæ˜¯å’Œé¢è¯•å®˜ä¸€èµ·æ¢è®¨ä¸€ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚å¯¹äºé—®é¢˜çš„ç»†èŠ‚å’Œåº”ç”¨ç¯å¢ƒï¼Œå¯ä»¥å’Œé¢è¯•å®˜æ²Ÿé€šã€‚ è¿™ç§æ²Ÿé€šæœ¬èº«å¾ˆé‡è¦ï¼Œå®ƒæš—ç¤ºç€ä½ æ€è€ƒé—®é¢˜çš„æ–¹å¼ã€‚\næˆ‘ä»¬éœ€è¦å¯¹ä¸€ç»„æ•°æ®è¿›è¡Œæ’åºã€‚ å¿«é€Ÿæ’åºç®—æ³• O(nlogn)\næ­£ç¡®+æ›´ä¼˜ è¿™ç»„æ•°æ®æœ‰ä»€ä¹ˆæ ·çš„ç‰¹å¾ï¼Ÿ æœ‰æ²¡æœ‰å¯èƒ½åŒ…å«æœ‰å¤§é‡çš„é‡å¤å…ƒç´ ï¼Ÿ å¦‚æœæœ‰è¿™ç§å¯èƒ½çš„è¯ï¼Œä¸‰è·¯å¿«æ’æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ Java é»˜è®¤æ˜¯ä¸‰è·¯å¿«æ’ã€‚\nè¿™ç»„æ•°æ®æœ‰ä»€ä¹ˆæ ·çš„ç‰¹å¾ï¼Ÿ æ˜¯å¦å¤§éƒ¨åˆ†æ•°æ®è·ç¦»å®ƒçš„æ­£ç¡®ä½ç½®å¾ˆè¿‘ï¼Ÿæ˜¯å¦è¿‘ä¹æœ‰åºï¼Ÿ å¦‚æœæ˜¯è¿™æ ·çš„è¯æ’å…¥æ’åºæ›´ä¼˜\næ˜¯å¦æ•°æ®çš„å–å€¼èŒƒå›´éå¸¸æœ‰é™ï¼Ÿæ¯”å¦‚å­¦ç”Ÿæˆç»©æ’åºã€‚ è®¡æ•°æ’åºæ›´ä¼˜\nå¯¹æ’åºæœ‰ä»€ä¹ˆé¢å¤–çš„è¦æ±‚ æ˜¯å¦éœ€è¦ç¨³å®šæ’åº å½’å¹¶æ’åºæ›´ä¼˜\næ•°æ®çš„å­˜å‚¨çŠ¶å†µæ˜¯æ€æ ·çš„ å¦‚æœä½¿ç”¨é“¾è¡¨å­˜å‚¨ï¼Œå½’å¹¶æ’åºæ›´ä¼˜\næ•°æ®çš„å¤§å°æ˜¯å¦å¯ä»¥è£…åœ¨å†…å­˜é‡Œï¼Œ å¤–éƒ¨æ’åº\nä»€ä¹ˆæ˜¯æ­£ç¡®çš„å›ç­”ä¸€ä¸ªç®—æ³•é—®é¢˜\næ­£ç¡®è¿˜åŒ…å«å¯¹é—®é¢˜çš„ç‹¬åˆ°è§è§£ï¼Œå®¹é”™æ€§ï¼Œ\n1-2 ç®—æ³•é¢è¯•åªæ˜¯é¢è¯•çš„ä¸€éƒ¨åˆ† ç®—æ³•é¢è¯•ä¼˜ç§€ä¸æ„å‘³ç€æŠ€æœ¯é¢è¯•ä¼˜ç§€\nç®—æ³•é¢è¯•åªæ˜¯æŠ€æœ¯é¢è¯•çš„ä¸€éƒ¨åˆ†\né¡¹ç›®ç»å†å’Œé¡¹ç›®ä¸­é‡åˆ°çš„å®é™…é—®é¢˜\nä½ é‡åˆ°å°è±¡æœ€æ·±çš„bugæ˜¯ä»€ä¹ˆï¼Ÿ\né¢å‘å¯¹è±¡\nè®¾è®¡æ¨¡å¼\nç½‘ç»œç›¸å…³ï¼šå®‰å…¨ç›¸å…³ï¼Œå†…å­˜ç›¸å…³ï¼Œå¹¶å‘ç›¸å…³\nç³»ç»Ÿè®¾è®¡ï¼š scalability\né¢è¯•ä¸ä»…ä»…æ˜¯è€ƒå¯ŸæŠ€æœ¯æ°´å¹³ï¼Œä»¥åŠå¯¹è¿‡å»é¡¹ç›®çš„æ€è€ƒ\né¡¹ç›®ç»å†\né€šè¿‡è¿‡å»äº†è§£ä½ çš„æ€è€ƒè¡Œä¸ºæ–¹å¼\né‡åˆ°çš„æœ€å¤§çš„æŒ‘æˆ˜\nçŠ¯è¿‡çš„é”™è¯¯\né‡åˆ°çš„å¤±è´¥\næœ€äº«å—çš„å·¥ä½œå†…å®¹\né‡åˆ°å†²çªçš„å¤„ç†æ–¹å¼\nåšçš„æœ€ä¸ä¼—ä¸åŒçš„äº‹å„¿\nå‡†å¤‡å¥½åˆé€‚çš„é—®é¢˜é—®é¢è¯•å®˜\n1-3 å¦‚ä½•å‡†å¤‡ç®—æ³•é¢è¯• é¿å…å®Œç¾å­¦ä¹ \nä½¿ç”¨æ—¶é—´ç‰‡å­¦ä¹ \nè¿œè¿œä¸éœ€è¦è¾¾åˆ°ç«èµ›çš„æ°´å¹³\nä¸è¦è½»è§†åŸºç¡€ç®—æ³•å’Œæ•°æ®ç»“æ„ï¼Œè€Œåªå…³æ³¨æœ‰æ„æ€çš„é¢˜ç›®\nå„ç§æ’åºç®—æ³• æŠ€æœ¯æ•°æ®ç»“æ„å’Œç®—æ³•çš„å®ç°ï¼š å¦‚å †ï¼ŒäºŒå‰æ ‘ï¼Œå›¾ åŸºç¡€æ•°æ®ç»“æ„çš„ä½¿ç”¨ï¼š å¦‚é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ã€å“ˆå¸Œè¡¨ã€å›¾ã€Tireã€å¹¶æŸ¥é›† åŸºç¡€ç®—æ³•ï¼š æ·±åº¦ä¼˜å…ˆã€å¹¿åº¦ä¼˜å…ˆã€äºŒåˆ†æŸ¥æ‰¾ã€é€’å½’ åŸºæœ¬ç®—æ³•æ€æƒ³ï¼šé€’å½’ã€åˆ†æ²»ã€å›æº¯æœç´¢ã€è´ªå¿ƒã€åŠ¨æ€è§„åˆ’ é€‰æ‹©åˆé€‚çš„OJ online judge\nleetcodeï¼š online portal for interview","tags":null,"title":""},{"categories":null,"contents":"äºŒå‰æ ‘å’Œé€’å½’ äºŒå‰æ ‘å¤©ç„¶çš„é€’å½’ç»“æ„ æ»¡äºŒå‰æ ‘\näºŒå‰æ ‘çš„å‰åºéå† é€’å½’å®ç° 1void preOrder(TreeNode node){ 2 if(node==null){ 3 return; // é€’å½’ç»ˆæ­¢æ¡ä»¶ 4 } 5 System.out.print(node.val); 6 preOrder(node.left); // é€’å½’è¿‡ç¨‹ 7 preOrder(node.right); 8} äºŒå‰æ ‘çš„å®šä¹‰ï¼šç©ºæ˜¯ä¸€æ£µäºŒå‰æ ‘\näºŒå‰æ ‘æ€»æ˜¯å¦åŒ…å«æŸä¸ªkey 1boolean contain(TreeNode node, Key key){ 2 if(node == null){ 3 return false; 4 } 5 if(key == node.key){ 6 return true; 7 } 8 if(contain(node.left,key)|| contain(node.right, key)){ 9 return true; 10 } 11 return false; 12} 1// c++ é‡Šæ”¾äºŒå‰æ ‘çš„å†…å­˜ 2void destory(TreeNode node){ 3 if(node == null){ 4 return; 5 } 6 destory(node.left); 7 destory(node.right); 8 delete node; 9 count-- 10} LeetCode 104ï¼š Maximum Depth of Binary Tree æ±‚ä¸€æ£µäºŒå‰æ ‘çš„æœ€é«˜æ·±åº¦ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„é•¿åº¦\né€’å½’å®ç° 1public static int maxDepth(TreeNode root){ 2 if(root == NULL){ 3 return 0; 4 } 5 return Math.max(maxDepth(root.left), maxDepth(root.right))+1; 6} éé€’å½’å®ç° 1class Solution { 2 public int maxDepth(TreeNode root) { 3 Queue\u0026lt;Pair\u0026lt;TreeNode, Integer\u0026gt;\u0026gt; stack = new LinkedList\u0026lt;\u0026gt;(); 4 if (root != null) { 5 stack.add(new Pair(root, 1)); 6 } 7 8 int depth = 0; 9 while (!stack.isEmpty()) { 10 Pair\u0026lt;TreeNode, Integer\u0026gt; current = stack.poll(); 11 root = current.getKey(); 12 int current_depth = current.getValue(); 13 if (root != null) { 14 depth = Math.max(depth, current_depth); 15 stack.add(new Pair(root.left, current_depth + 1)); 16 stack.add(new Pair(root.right, current_depth + 1)); 17 } 18 } 19 return depth; 20 } 21}; å¤ä¹ äºŒå‰æ ‘ç›¸å…³çš„æ‰€æœ‰æ“ä½œ\nLeetCode 111ï¼šMinimum Depth of Binary Tree æ±‚ä¸€æ£µäºŒå‰æ ‘çš„æœ€ä½æ·±åº¦ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦\n1class Solution { 2 public int minDepth(TreeNode root) { 3 if (root == null) { 4 return 0; 5 } 6 7 if ((root.left == null) \u0026amp;\u0026amp; (root.right == null)) { 8 return 1; 9 } 10 11 int min_depth = Integer.MAX_VALUE; 12 if (root.left != null) { 13 min_depth = Math.min(minDepth(root.left), min_depth); 14 } 15 if (root.right != null) { 16 min_depth = Math.min(minDepth(root.right), min_depth); 17 } 18 19 return min_depth + 1; 20 } 21} ä¸€ä¸ªç®€å•çš„äºŒå‰æ ‘é—®é¢˜å¼•å‘çš„è¡€æ¡ˆ 226ï¼š Invert Binary Tree åè½¬ä¸€æ£µäºŒå‰æ ‘\nMax Howell å› ä¸ºä¸ä¼šåšè¿™é“é¢˜ç›®è€Œè¢«Googleæ‹’ç»\nGoogleï¼š90%of our engineer use the software you wrote(Homebrew), but you can\u0026rsquo;t invert a binary tree on a whiteboard so fuck off.\n1public TreeNode invertTree(TreeNode root) { 2 if (root == null) { 3 return null; 4 } 5 TreeNode right = invertTree(root.right); 6 TreeNode left = invertTree(root.left); 7 root.left = right; 8 root.right = left; 9 return root; 10} 100: Same Tree ç»™å‡ºä¸¤æ£µäºŒå‰æ ‘ï¼Œåˆ¤æ–­è¿™ä¸¤æ£µäºŒå‰æ ‘æ˜¯å¦å®Œå…¨ä¸€æ ·\n1 public boolean isSameTree(TreeNode p, TreeNode q) { 2 // p and q are both null 3 if (p == null \u0026amp;\u0026amp; q == null) return true; 4 // one of p and q is null 5 if (q == null || p == null) return false; 6 if (p.val != q.val) return false; 7 return isSameTree(p.right, q.right) \u0026amp;\u0026amp; 8 isSameTree(p.left, q.left); 9 } 101: Sysmmetric Tree ç»™å‡ºä¸€æ£µäºŒå‰æ ‘ï¼Œåˆ¤æ–­å…¶æ˜¯å¦æ˜¯å·¦å³å¯¹ç§°çš„\n1public boolean isSymmetric(TreeNode root) { 2 return isMirror(root, root); 3} 4 5public boolean isMirror(TreeNode t1, TreeNode t2) { 6 if (t1 == null \u0026amp;\u0026amp; t2 == null) return true; 7 if (t1 == null || t2 == null) return false; 8 return (t1.val == t2.val) 9 \u0026amp;\u0026amp; isMirror(t1.right, t2.left) 10 \u0026amp;\u0026amp; isMirror(t1.left, t2.right); 11} 222: Count Complete Tree Node ç»™å®šä¸€ä¸ªæ£µå®Œå…¨äºŒå‰æ ‘ï¼Œæ±‚å®Œå…¨äºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°\nå®Œå…¨äºŒå‰æ ‘: é™¤äº†æœ€åä¸€å±‚ï¼Œæ‰€æœ‰å±‚çš„èŠ‚ç‚¹æ•°è¾¾åˆ°æœ€å¤§ï¼Œä¸æ­¤åŒæ—¶ï¼Œæœ€åä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨æœ€å·¦ä¾§ã€‚ å †ä½¿ç”¨å®Œå…¨äºŒå‰æ ‘ã€‚\næ»¡äºŒå‰æ ‘ï¼š æ‰€æœ‰å±‚çš„èŠ‚ç‚¹æ•°è¾¾åˆ°æœ€å¤§ã€‚\n1 public int countNodes(TreeNode root) { 2 if(root == null){ 3 return 0; 4 } 5 int left = countLevel(root.left); 6 int right = countLevel(root.right); 7 if(left == right){ 8 return countNodes(root.right) + (1\u0026lt;\u0026lt;left); 9 }else{ 10 return countNodes(root.left) + (1\u0026lt;\u0026lt;right); 11 } 12 } 13 private int countLevel(TreeNode root){ 14 int level = 0; 15 while(root != null){ 16 level++; 17 root = root.left; 18 } 19 return level; 20 } 110 : Balanced Binary Tree åˆ¤æ–­ä¸€æ£µæ ‘æ˜¯å¦ä¸ºå¹³è¡¡äºŒå‰æ ‘\nå¹³è¡¡äºŒå‰æ ‘ï¼š æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦å·®ä¸è¶…è¿‡1\n1public boolean isBalanced(TreeNode root) { 2 //å®ƒæ˜¯ä¸€æ£µç©ºæ ‘ 3 if (root == null) { 4 return true; 5 } 6 //å®ƒçš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1 7 int leftDepth = getTreeDepth(root.left); 8 int rightDepth = getTreeDepth(root.right); 9 if (Math.abs(leftDepth - rightDepth) \u0026gt; 1) { 10 return false; 11 } 12 //å·¦å³ä¸¤ä¸ªå­æ ‘éƒ½æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ 13 return isBalanced(root.left) \u0026amp;\u0026amp; isBalanced(root.right); 14 15} 16 17private int getTreeDepth(TreeNode root) { 18 if (root == null) { 19 return 0; 20 } 21 int leftDepth = getTreeDepth(root.left); 22 int rightDepth = getTreeDepth(root.right); 23 return Math.max(leftDepth, rightDepth) + 1; 24} æ³¨æ„é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ 112ï¼š Path sum ç»™å‡ºä¸€æ£µäºŒå‰æ ‘ä»¥åŠä¸€ä¸ªæ•°å­—sum, åˆ¤æ–­è¿™æ£µäºŒå‰æ ‘ä¸Šæ˜¯å¦å­˜åœ¨ä¸€æ¡ä»æ ¹åˆ°å¶å­çš„è·¯å¾„ã€‚å…¶è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹å’Œä¸ºsumã€‚\næ˜“é”™æƒ…å†µ\n1public static boolean hasPathSum(TreeNode root, int sum){ 2 if( root == null){ // é€’å½’ç»ˆæ­¢æ¡ä»¶æœ‰é—®é¢˜ 3\treturn sum == 0; 4 } 5 if(hasPathSum(root.left, sum -root.val)){ 6 return true; 7 } 8 if(hasPathSum(root.right, sum -root.val)){ 9 return true; 10 } 11 return false; 12} 1public static boolean hasPathSum(TreeNode root, int sum){ 2 if(root == null){ 3 return false; 4 } 5 if( root.left == null \u0026amp;\u0026amp; root.right = null){ // é€’å½’ç»ˆæ­¢æ¡ä»¶æœ‰é—®é¢˜ 6\treturn sum == root.val; 7 } 8 if(hasPathSum(root.left, sum -root.val)){ 9 return true; 10 } 11 if(hasPathSum(root.right, sum -root.val)){ 12 return true; 13 } 14 return false; 15 // return hasPathSum(root.left, sum -root.val)||hasPathSum(root.right, sum -root.val); 16} 404ï¼šSum of Left Leaves æ±‚å‡ºä¸€æ£µäºŒå‰æ ‘æ‰€æœ‰å·¦å¶å­çš„å’Œ\n1public int sumOfLeftLeaves(TreeNode root) { 2 if (root == null) return 0; 3 if (root.left == null) return sumOfLeftLeaves(root.right); //å¦‚æœå·¦å­æ ‘ä¸ºç©ºï¼Œé‚£ä¹ˆåªéœ€è¿”å›å³å­æ ‘çš„å·¦å¶å­å’Œ 4 if (root.left.left == null \u0026amp;\u0026amp; root.left.right == null) // å¦‚æœå·¦å­æ ‘ä¸ºå¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆéœ€è¿”å›å³å­æ ‘çš„å·¦å¶å­å’Œ + å·¦å­©å­çš„å€¼ 5 return sumOfLeftLeaves(root.right) + root.left.val; 6 return sumOfLeftLeaves(root.left) + sumOfLeftLeaves(root.right); // å…¶ä»–æƒ…å†µéœ€è¿”å›å·¦å³å­æ ‘çš„å·¦å¶å­å’Œä¹‹å’Œ 7} 257: Binary Tree Path\nç»™å®šä¸€æ£µäºŒå‰æ ‘ï¼Œè¿”å›æ‰€æœ‰è¡¨ç¤ºä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹è·¯å¾„çš„å­—ç¬¦ä¸²\n1 public List\u0026lt;String\u0026gt; binaryTreePaths(TreeNode root) { 2 List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); 3 if(root == null){ 4 return list; 5 } 6 if(root.left == null \u0026amp;\u0026amp; root.right == null){ 7 list.add(\u0026#34;\u0026#34;+root.val); 8 } 9 List\u0026lt;String\u0026gt; left = binaryTreePaths(root.left); 10 for(String str: left){ 11 list.add(\u0026#34;\u0026#34;+root.val+\u0026#34;-\u0026gt;\u0026#34;+str); 12 } 13 List\u0026lt;String\u0026gt; right = binaryTreePaths(root.right); 14 for(String str: right){ 15 list.add(\u0026#34;\u0026#34;+root.val+\u0026#34;-\u0026gt;\u0026#34;+str); 16 } 17 return list; 18 } 113ï¼šPath Sum II\nç»™å®šä¸€æ£µäºŒå‰æ ‘ï¼Œè¿”å›æ‰€æœ‰ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„è·¯å¾„ï¼Œå…¶å’Œä¸ºsum\nå¯¹äºå³ä¾§äºŒå‰æ ‘ï¼Œsum = 22ï¼Œç»“æœä¸º[[5,4,11,2],[5,4,8,5]]\n129ï¼šSum root to Leaf Numbers\nç»™å®šä¸€æ£µäºŒå‰æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªåŒ…å«æ•°å­—0-9ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æ¯æ¡è·¯å¾„å¯ä»¥è¡¨ç¤ºæˆä¸€ä¸ªæ•°ï¼Œæ±‚è¿™äº›æ•°çš„å’Œã€‚\næ›´å¤æ‚çš„é€’å½’é€»è¾‘ 437ï¼š Path Sum II\nç»™å‡ºä¸€æ£µäºŒå‰æ ‘ä»¥åŠä¸€ä¸ªæ•°å­—sumï¼Œåˆ¤æ–­åœ¨è¿™æ£µäºŒå‰æ ‘ä¸Šå­˜åœ¨å¤šå°‘æ¡è·¯å¾„ï¼Œå…¶è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹å’Œä¸ºsumã€‚\nå…¶ä¸­è·¯å¾„ä¸ä¸€å®šå“Ÿå•Šèµ·å§‹äºæ ¹èŠ‚ç‚¹ï¼›ç»ˆæ­¢äºå¶å­èŠ‚ç‚¹ è·¯å¾„å¯ä»¥ä»ä»»æ„èŠ‚ç‚¹å¼€å§‹ï¼Œä½†æ˜¯åªèƒ½æ˜¯å‘ä¸‹èµ°çš„ã€‚ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95_leetcode%E7%89%88%E6%9C%AC/7th_%E4%BA%8C%E5%8F%89%E6%A0%91%E5%92%8C%E9%80%92%E5%BD%92/","summary":"äºŒå‰æ ‘å’Œé€’å½’ äºŒå‰æ ‘å¤©ç„¶çš„é€’å½’ç»“æ„ æ»¡äºŒå‰æ ‘\näºŒå‰æ ‘çš„å‰åºéå† é€’å½’å®ç° 1void preOrder(TreeNode node){ 2 if(node==null){ 3 return; // é€’å½’ç»ˆæ­¢æ¡ä»¶ 4 } 5 System.out.print(node.val); 6 preOrder(node.left); // é€’å½’è¿‡ç¨‹ 7 preOrder(node.right); 8} äºŒå‰æ ‘çš„å®šä¹‰ï¼šç©ºæ˜¯ä¸€æ£µäºŒå‰æ ‘\näºŒå‰æ ‘æ€»æ˜¯å¦åŒ…å«æŸä¸ªkey 1boolean contain(TreeNode node, Key key){ 2 if(node == null){ 3 return false; 4 } 5 if(key == node.key){ 6 return true; 7 } 8 if(contain(node.left,key)|| contain(node.right, key)){ 9 return true; 10 } 11 return false; 12} 1// c++ é‡Šæ”¾äºŒå‰æ ‘çš„å†…å­˜ 2void destory(TreeNode node){ 3 if(node == null){ 4 return; 5 } 6 destory(node.","tags":null,"title":""},{"categories":null,"contents":"åŠ¨æ€è§„åˆ’åŸºç¡€ ä»€ä¹ˆæ˜¯åŠ¨æ€è§„åˆ’ æ–æ³¢é‚£å¥‘æ•°åˆ— Fibonacci Sequence 1//æ—¶é—´å¤æ‚åº¦ åº”è¯¥æ˜¯æŒ‡æ•°çº§ 2int fib(){ 3 if(n==0){ 4 return 0; 5 } 6 if(n==1){ 7 return 1; 8 } 9 return fib(n-1)+fib(n-2); 10} é€’å½’ä¼šæœ‰å¾ˆå¤šçš„é‡å¤è®¡ç®—ï¼Œé‡å¤çš„è®¡ç®—é‡ä¼šéå¸¸å¤§ã€‚\næ‰€ä»¥æƒ³åŠæ³•å¯¹é‡å¤çš„è®¡ç®— åªè®¡ç®—ä¸€æ¬¡\nè®°å¿†åŒ–æœç´¢-è‡ªä¸Šè€Œä¸‹çš„è§£å†³é—®é¢˜ æ”¹è¿›çš„Fibonacci\n1// è®°å¿†åŒ–æœç´¢ æ—¶é—´å¤æ‚åº¦O(n) 2int memo[]; 3int fib(){ 4 if(n==0){ 5 return 0; 6 } 7 if(n==1){ 8 return 1; 9 } 10 if(memo[n]==-1){ 11 memo[n]=fib(n-1)+fib(n-2); 12 } 13 return memo[n]; 14} åŠ¨æ€è§„åˆ’-è‡ªä¸‹è€Œä¸Šçš„è§£å†³é—®é¢˜ 1// åŠ¨æ€è§„åˆ’ 2int fib(int n){ 3 vector\u0026lt;int\u0026gt; memo(n+1, -1); 4 memo[0] = 0; 5 memo[1] = 1; 6 for(int i=2; i\u0026lt;n;i++){ 7 memo[i] = memo[i-1]+memo[i-2]; 8 } 9 return memo[n]; 10} åŠ¨æ€è§„åˆ’ï¼š\nå°†åŸé—®é¢˜æ‹†è§£æˆè‹¥å¹²å­é—®é¢˜ï¼ŒåŒæ—¶ä¿å­˜å­é—®é¢˜çš„ç­”æ¡ˆï¼Œä½¿å¾—æ¯ä¸ªå­é—®é¢˜å€¼æ±‚è§£ä¸€æ¬¡ï¼Œæœ€ç»ˆè·å¾—åŸé—®é¢˜çš„ç­”æ¡ˆã€‚ é€’å½’é—®é¢˜-\u0026gt; é‡å å­é—®é¢˜\nçˆ¬æ¥¼æ¢¯é—®é¢˜ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95_leetcode%E7%89%88%E6%9C%AC/9th_%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","summary":"åŠ¨æ€è§„åˆ’åŸºç¡€ ä»€ä¹ˆæ˜¯åŠ¨æ€è§„åˆ’ æ–æ³¢é‚£å¥‘æ•°åˆ— Fibonacci Sequence 1//æ—¶é—´å¤æ‚åº¦ åº”è¯¥æ˜¯æŒ‡æ•°çº§ 2int fib(){ 3 if(n==0){ 4 return 0; 5 } 6 if(n==1){ 7 return 1; 8 } 9 return fib(n-1)+fib(n-2); 10} é€’å½’ä¼šæœ‰å¾ˆå¤šçš„é‡å¤è®¡ç®—ï¼Œé‡å¤çš„è®¡ç®—é‡ä¼šéå¸¸å¤§ã€‚\næ‰€ä»¥æƒ³åŠæ³•å¯¹é‡å¤çš„è®¡ç®— åªè®¡ç®—ä¸€æ¬¡\nè®°å¿†åŒ–æœç´¢-è‡ªä¸Šè€Œä¸‹çš„è§£å†³é—®é¢˜ æ”¹è¿›çš„Fibonacci\n1// è®°å¿†åŒ–æœç´¢ æ—¶é—´å¤æ‚åº¦O(n) 2int memo[]; 3int fib(){ 4 if(n==0){ 5 return 0; 6 } 7 if(n==1){ 8 return 1; 9 } 10 if(memo[n]==-1){ 11 memo[n]=fib(n-1)+fib(n-2); 12 } 13 return memo[n]; 14} åŠ¨æ€è§„åˆ’-è‡ªä¸‹è€Œä¸Šçš„è§£å†³é—®é¢˜ 1// åŠ¨æ€è§„åˆ’ 2int fib(int n){ 3 vector\u0026lt;int\u0026gt; memo(n+1, -1); 4 memo[0] = 0; 5 memo[1] = 1; 6 for(int i=2; i\u0026lt;n;i++){ 7 memo[i] = memo[i-1]+memo[i-2]; 8 } 9 return memo[n]; 10} åŠ¨æ€è§„åˆ’ï¼š","tags":null,"title":""},{"categories":null,"contents":"å›¾ å›¾çš„è¡¨ç¤º é‚»æ¥çŸ©é˜µï¼ˆAdjacent Matrixï¼‰ é‚»æ¥è¡¨ï¼ˆAdjacent Matrixï¼‰ é‚»æ¥è¡¨é€‚åˆè¡¨ç¤ºç¨€ç–å›¾ï¼ˆSparse Graphï¼‰\né‚»æ¥çŸ©é˜µé€‚åˆè¡¨ç¤ºç¨ å¯†å›¾ï¼ˆDense Graphï¼‰\nç¨€ç–å›¾ ç¨ å¯†å›¾å’Œå®Œå…¨å›¾ å¯»è·¯ è·å¾—ä¸¤ç‚¹ä¹‹é—´çš„ä¸€æ¡è·¯å¾„\nå›¾çš„æ·±åº¦ä¼˜å…ˆéå†-æ—¶é—´å¤æ‚åº¦\nç¨€ç–å›¾ï¼ˆé‚»æ¥è¡¨ï¼‰ï¼šO(V+E)\nç¨ å¯†å›¾ï¼ˆé‚»æ¥çŸ©é˜µï¼‰ï¼šO(v^2^)\næ·±åº¦ä¼˜å…ˆéå†ç®—æ³•-æœ‰å‘å›¾\ndfs æŸ¥çœ‹æ˜¯å¦æœ‰ç¯- æœ‰å‘å›¾ å¹¿åº¦ä¼˜å…ˆéå†å’Œæœ€çŸ­è·¯å¾„ å€ŸåŠ©é˜Ÿåˆ—å®ç°\nå¹¿åº¦ä¼˜å…ˆéå†æ±‚å‡ºäº†æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„\nå›¾çš„å¹¿åº¦ä¼˜å…ˆéå†-æ—¶é—´å¤æ‚åº¦\nç¨€ç–å›¾ï¼ˆé‚»æ¥è¡¨ï¼‰ï¼šO(V+E)\nç¨ å¯†å›¾ï¼ˆé‚»æ¥çŸ©é˜µï¼‰ï¼šO(v^2^)\næ— æƒå›¾çš„åº”ç”¨- è¿·å®«ç”Ÿæˆï¼ŒPSæŠ å›¾ flood fill é­”æ£’æŠ å›¾ è¿é€šåˆ†é‡\næ‰«é›· èµ°è¿·å®«ã€ è¿·å®«ç”Ÿæˆ è¿·å®«çš„æœ¬è´¨æ˜¯ä¸€æ£µæ ‘ æœ¬è´¨æ˜¯ä¸€ä¸ªç”Ÿæˆæ ‘çš„è¿‡ç¨‹\nä¸èƒ½åªç”¨ä¸€ç§æ–¹å¼éå†ï¼Œ éšæœºé˜Ÿåˆ—éå†\næ¬§æ‹‰è·¯å¾„ å“ˆå¯†å°”é¡¿è·¯å¾„ äºŒåˆ†å›¾ åŒå­¦é€‰è¯¾\nåœ°å›¾ç€è‰² \u0001\u0001\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%BC%E5%90%88%E6%8F%90%E5%8D%87%E7%AF%87/7th_%E5%9B%BE%E7%9A%84%E5%9F%BA%E7%A1%80/","summary":"å›¾ å›¾çš„è¡¨ç¤º é‚»æ¥çŸ©é˜µï¼ˆAdjacent Matrixï¼‰ é‚»æ¥è¡¨ï¼ˆAdjacent Matrixï¼‰ é‚»æ¥è¡¨é€‚åˆè¡¨ç¤ºç¨€ç–å›¾ï¼ˆSparse Graphï¼‰\né‚»æ¥çŸ©é˜µé€‚åˆè¡¨ç¤ºç¨ å¯†å›¾ï¼ˆDense Graphï¼‰\nç¨€ç–å›¾ ç¨ å¯†å›¾å’Œå®Œå…¨å›¾ å¯»è·¯ è·å¾—ä¸¤ç‚¹ä¹‹é—´çš„ä¸€æ¡è·¯å¾„\nå›¾çš„æ·±åº¦ä¼˜å…ˆéå†-æ—¶é—´å¤æ‚åº¦\nç¨€ç–å›¾ï¼ˆé‚»æ¥è¡¨ï¼‰ï¼šO(V+E)\nç¨ å¯†å›¾ï¼ˆé‚»æ¥çŸ©é˜µï¼‰ï¼šO(v^2^)\næ·±åº¦ä¼˜å…ˆéå†ç®—æ³•-æœ‰å‘å›¾\ndfs æŸ¥çœ‹æ˜¯å¦æœ‰ç¯- æœ‰å‘å›¾ å¹¿åº¦ä¼˜å…ˆéå†å’Œæœ€çŸ­è·¯å¾„ å€ŸåŠ©é˜Ÿåˆ—å®ç°\nå¹¿åº¦ä¼˜å…ˆéå†æ±‚å‡ºäº†æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„\nå›¾çš„å¹¿åº¦ä¼˜å…ˆéå†-æ—¶é—´å¤æ‚åº¦\nç¨€ç–å›¾ï¼ˆé‚»æ¥è¡¨ï¼‰ï¼šO(V+E)\nç¨ å¯†å›¾ï¼ˆé‚»æ¥çŸ©é˜µï¼‰ï¼šO(v^2^)\næ— æƒå›¾çš„åº”ç”¨- è¿·å®«ç”Ÿæˆï¼ŒPSæŠ å›¾ flood fill é­”æ£’æŠ å›¾ è¿é€šåˆ†é‡\næ‰«é›· èµ°è¿·å®«ã€ è¿·å®«ç”Ÿæˆ è¿·å®«çš„æœ¬è´¨æ˜¯ä¸€æ£µæ ‘ æœ¬è´¨æ˜¯ä¸€ä¸ªç”Ÿæˆæ ‘çš„è¿‡ç¨‹\nä¸èƒ½åªç”¨ä¸€ç§æ–¹å¼éå†ï¼Œ éšæœºé˜Ÿåˆ—éå†\næ¬§æ‹‰è·¯å¾„ å“ˆå¯†å°”é¡¿è·¯å¾„ äºŒåˆ†å›¾ åŒå­¦é€‰è¯¾\nåœ°å›¾ç€è‰² \u0001\u0001","tags":null,"title":""},{"categories":null,"contents":"æœ€å°ç”Ÿæˆæ ‘ Minimum Span Tree æœ‰æƒå›¾ Weight Graph é‚»æ¥çŸ©é˜µ Adjacent Matrix é‚»æ¥è¡¨ ä½¿ç”¨Edge è¡¨ç¤ºæ¯ä¸€æ¡è¿æ¥è¾¹\næœ€å°ç”Ÿæˆæ ‘é—®é¢˜å’Œåˆ‡åˆ†å®šç† å¸¦æƒæ— å‘å›¾ã€è¿é€šå›¾\næ‰¾V-1æ¡è¾¹\nåˆ‡åˆ†å®šç† Cut Property æŠŠå›¾ä¸­çš„èŠ‚ç‚¹åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæˆä¸ºä¸€ä¸ªåˆ‡åˆ†(Cut)\nå¦‚æœä¸€ä¸ªè¾¹çš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œå±äºåˆ‡åˆ†ä¸åŒçš„ä¸¤è¾¹ï¼Œè¿™ä¸ªè¾¹æˆä¸ºæ¨ªåˆ‡è¾¹(Crossing Edge);\nåˆ‡åˆ†å®šç†ï¼š\nç»™å®šä»»æ„åˆ‡åˆ†ï¼Œæ¨ªåˆ‡è¾¹ä¸­æƒå€¼æœ€å°çš„è¾¹å¿…ç„¶å±äºæœ€å°ç”Ÿæˆæ ‘\nPrimç®—æ³• Lazy Prim Lazy Prim æœ€å°å †ä¸­ä¾ç„¶æœ‰ä¸ä¼šæ˜¯æ¨ªåˆ‡è¾¹çš„è¾¹ã€‚\nLazy Prim çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(ElogE)\nPrim ç®—æ³•ä¼˜åŒ– æ—¶é—´å¤æ‚åº¦O(ElogV)\nIndexMinHeap\nKruskalç®—æ³• ä½¿ç”¨å¹¶æŸ¥é›†\nä½¿ç”¨Union Find å¿«é€Ÿåˆ¤æ–­ç¯\næœ€å°ç”Ÿæˆæ ‘é—®é¢˜ æœ€å°ç”Ÿæˆæ ‘é—®é¢˜æ€è€ƒ\nLazy Prim O(ElogE)\nPrim O(ElogV)\nKruskal O(ElogE)\nå¦‚æœæ¨ªåˆ‡è¾¹æœ‰ç›¸ç­‰çš„è¾¹\næ ¹æ®å…·ä½“çš„ç®—æ³•å®ç°ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªè¾¹\næ­¤æ—¶ï¼Œå›¾å­˜åœ¨å¤šä¸ªæœ€å°ç”Ÿæˆæ ‘\nVyssotskyâ€™s Algorithm\nå°†è¾¹é€æ¸æ·»åŠ åˆ°ç”Ÿæˆæ ‘ä¸­\nä¸€æ—¦å½¢æˆç¯ï¼Œåˆ é™¤ç¯ä¸­æƒå€¼æœ€å¤§çš„è¾¹\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%BC%E5%90%88%E6%8F%90%E5%8D%87%E7%AF%87/8th_%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/","summary":"æœ€å°ç”Ÿæˆæ ‘ Minimum Span Tree æœ‰æƒå›¾ Weight Graph é‚»æ¥çŸ©é˜µ Adjacent Matrix é‚»æ¥è¡¨ ä½¿ç”¨Edge è¡¨ç¤ºæ¯ä¸€æ¡è¿æ¥è¾¹\næœ€å°ç”Ÿæˆæ ‘é—®é¢˜å’Œåˆ‡åˆ†å®šç† å¸¦æƒæ— å‘å›¾ã€è¿é€šå›¾\næ‰¾V-1æ¡è¾¹\nåˆ‡åˆ†å®šç† Cut Property æŠŠå›¾ä¸­çš„èŠ‚ç‚¹åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæˆä¸ºä¸€ä¸ªåˆ‡åˆ†(Cut)\nå¦‚æœä¸€ä¸ªè¾¹çš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œå±äºåˆ‡åˆ†ä¸åŒçš„ä¸¤è¾¹ï¼Œè¿™ä¸ªè¾¹æˆä¸ºæ¨ªåˆ‡è¾¹(Crossing Edge);\nåˆ‡åˆ†å®šç†ï¼š\nç»™å®šä»»æ„åˆ‡åˆ†ï¼Œæ¨ªåˆ‡è¾¹ä¸­æƒå€¼æœ€å°çš„è¾¹å¿…ç„¶å±äºæœ€å°ç”Ÿæˆæ ‘\nPrimç®—æ³• Lazy Prim Lazy Prim æœ€å°å †ä¸­ä¾ç„¶æœ‰ä¸ä¼šæ˜¯æ¨ªåˆ‡è¾¹çš„è¾¹ã€‚\nLazy Prim çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(ElogE)\nPrim ç®—æ³•ä¼˜åŒ– æ—¶é—´å¤æ‚åº¦O(ElogV)\nIndexMinHeap\nKruskalç®—æ³• ä½¿ç”¨å¹¶æŸ¥é›†\nä½¿ç”¨Union Find å¿«é€Ÿåˆ¤æ–­ç¯\næœ€å°ç”Ÿæˆæ ‘é—®é¢˜ æœ€å°ç”Ÿæˆæ ‘é—®é¢˜æ€è€ƒ\nLazy Prim O(ElogE)\nPrim O(ElogV)\nKruskal O(ElogE)\nå¦‚æœæ¨ªåˆ‡è¾¹æœ‰ç›¸ç­‰çš„è¾¹\næ ¹æ®å…·ä½“çš„ç®—æ³•å®ç°ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªè¾¹\næ­¤æ—¶ï¼Œå›¾å­˜åœ¨å¤šä¸ªæœ€å°ç”Ÿæˆæ ‘\nVyssotskyâ€™s Algorithm\nå°†è¾¹é€æ¸æ·»åŠ åˆ°ç”Ÿæˆæ ‘ä¸­\nä¸€æ—¦å½¢æˆç¯ï¼Œåˆ é™¤ç¯ä¸­æƒå€¼æœ€å¤§çš„è¾¹","tags":null,"title":""},{"categories":null,"contents":"æœ€çŸ­è·¯å¾„ è·¯å¾„æœ€çŸ­é—®é¢˜å’Œæ¾å¼›æ“ä½œï¼ˆRelaxationï¼‰ æœ€çŸ­è·¯å¾„é—®é¢˜ Shortest Path è·¯å¾„è§„åˆ’ åŸå¸‚ï¼Œè·¯ç”±\nå·¥ä½œä»»åŠ¡è§„åˆ’\nå¹¿åº¦ä¼˜å…ˆéå† -\u0026gt; æœ€çŸ­è·¯å¾„æ ‘ Shortest Path Tree\nå•æºæœ€çŸ­è·¯å¾„ Single Source Shortest Path\næ— æƒå›¾çš„æœ€çŸ­è·¯å¾„\næ¾å¼›æ“ä½œæ˜¯æ±‚æœ€çŸ­è·¯å¾„çš„æ ¸å¿ƒ\nDijkstra ç®—æ³•çš„æ€æƒ³ dijkstra å•æºæœ€çŸ­è·¯å¾„ç®—æ³• å‰æï¼š å›¾ä¸­ä¸èƒ½æœ‰è´Ÿæƒè¾¹\nå¤æ‚åº¦ O(ElogV)\nè´Ÿæƒè¾¹å’ŒBellman-Fordç®—æ³• æ‹¥æœ‰è´Ÿæƒç¯çš„å›¾ï¼Œæ²¡æœ‰æœ€çŸ­è·¯å¾„\nBellman-Ford å•æºæœ€çŸ­è·¯å¾„ç®—æ³• å‰æï¼šå›¾ä¸­ä¸èƒ½æœ‰è´Ÿæƒç¯\nBellman-Ford åˆ¤æ–­å›¾ä¸­æ˜¯å¦æœ‰è´Ÿæƒç¯\nå¤æ‚åº¦O(EV)\nå¦‚æœä¸€ä¸ªå›¾æ²¡æœ‰è´Ÿæƒç¯ï¼Œä»ä¸€ä¸ªç‚¹åˆ°å¦ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œæœ€å¤šç»è¿‡æ‰€æœ‰çš„Vä¸ªé¡¶çº¿ï¼Œæœ‰V-1æ¡è¾¹ã€‚å¦åˆ™å­˜åœ¨å®šç‚¹ç»è¿‡äº†ä¸¤æ¬¡ï¼Œå³å­˜åœ¨è´Ÿæƒç¯ã€‚\nå¯¹ä¸€ä¸ªç‚¹çš„ä¸€æ¬¡æ¾å¼›æ“ä½œï¼Œå°±æ˜¯æ‰¾åˆ°ç»è¿‡è¿™ä¸ªç‚¹çš„å¦å¤–ä¸€æ¡è·¯å¾„ï¼Œå¤šä¸€æ¡è¾¹ï¼Œæƒå€¼æ›´å°ã€‚\nå¦‚æœä¸€ä¸ªå›¾æ²¡æœ‰è´Ÿæƒç¯ï¼Œä»ä¸€ä¸ªç‚¹åˆ°å¦å¤–ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œæœ€å¤šç»è¿‡æ‰€æœ‰çš„Vä¸ªé¡¶çº¿ï¼Œæœ‰V-1æ¡è¾¹ã€‚\nå¯¹æ‰€æœ‰çš„ç‚¹è¿›è¡ŒV-1æ¬¡æ¾å¼›æ“ä½œã€‚\nå¯¹æ‰€æœ‰çš„ç‚¹è¿›ç¨‹V-1æ¬¡æ¾å¼›æ“ä½œï¼Œç†è®ºä¸Šå°±æ‰¾åˆ°äº†ä»æºç‚¹åˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚\nå¦‚æœè¿˜å¯ä»¥ç»§ç»­æ¾å¼›ï¼Œå°±è¯´æ˜åŸå›¾ä¸­æœ‰è´Ÿæƒç¯\n##æ›´å¤šå’Œæœ€çŸ­è·¯å¾„ç›¸å…³çš„æ€è€ƒ\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%BC%E5%90%88%E6%8F%90%E5%8D%87%E7%AF%87/9th_%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/","summary":"æœ€çŸ­è·¯å¾„ è·¯å¾„æœ€çŸ­é—®é¢˜å’Œæ¾å¼›æ“ä½œï¼ˆRelaxationï¼‰ æœ€çŸ­è·¯å¾„é—®é¢˜ Shortest Path è·¯å¾„è§„åˆ’ åŸå¸‚ï¼Œè·¯ç”±\nå·¥ä½œä»»åŠ¡è§„åˆ’\nå¹¿åº¦ä¼˜å…ˆéå† -\u0026gt; æœ€çŸ­è·¯å¾„æ ‘ Shortest Path Tree\nå•æºæœ€çŸ­è·¯å¾„ Single Source Shortest Path\næ— æƒå›¾çš„æœ€çŸ­è·¯å¾„\næ¾å¼›æ“ä½œæ˜¯æ±‚æœ€çŸ­è·¯å¾„çš„æ ¸å¿ƒ\nDijkstra ç®—æ³•çš„æ€æƒ³ dijkstra å•æºæœ€çŸ­è·¯å¾„ç®—æ³• å‰æï¼š å›¾ä¸­ä¸èƒ½æœ‰è´Ÿæƒè¾¹\nå¤æ‚åº¦ O(ElogV)\nè´Ÿæƒè¾¹å’ŒBellman-Fordç®—æ³• æ‹¥æœ‰è´Ÿæƒç¯çš„å›¾ï¼Œæ²¡æœ‰æœ€çŸ­è·¯å¾„\nBellman-Ford å•æºæœ€çŸ­è·¯å¾„ç®—æ³• å‰æï¼šå›¾ä¸­ä¸èƒ½æœ‰è´Ÿæƒç¯\nBellman-Ford åˆ¤æ–­å›¾ä¸­æ˜¯å¦æœ‰è´Ÿæƒç¯\nå¤æ‚åº¦O(EV)\nå¦‚æœä¸€ä¸ªå›¾æ²¡æœ‰è´Ÿæƒç¯ï¼Œä»ä¸€ä¸ªç‚¹åˆ°å¦ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œæœ€å¤šç»è¿‡æ‰€æœ‰çš„Vä¸ªé¡¶çº¿ï¼Œæœ‰V-1æ¡è¾¹ã€‚å¦åˆ™å­˜åœ¨å®šç‚¹ç»è¿‡äº†ä¸¤æ¬¡ï¼Œå³å­˜åœ¨è´Ÿæƒç¯ã€‚\nå¯¹ä¸€ä¸ªç‚¹çš„ä¸€æ¬¡æ¾å¼›æ“ä½œï¼Œå°±æ˜¯æ‰¾åˆ°ç»è¿‡è¿™ä¸ªç‚¹çš„å¦å¤–ä¸€æ¡è·¯å¾„ï¼Œå¤šä¸€æ¡è¾¹ï¼Œæƒå€¼æ›´å°ã€‚\nå¦‚æœä¸€ä¸ªå›¾æ²¡æœ‰è´Ÿæƒç¯ï¼Œä»ä¸€ä¸ªç‚¹åˆ°å¦å¤–ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œæœ€å¤šç»è¿‡æ‰€æœ‰çš„Vä¸ªé¡¶çº¿ï¼Œæœ‰V-1æ¡è¾¹ã€‚\nå¯¹æ‰€æœ‰çš„ç‚¹è¿›è¡ŒV-1æ¬¡æ¾å¼›æ“ä½œã€‚\nå¯¹æ‰€æœ‰çš„ç‚¹è¿›ç¨‹V-1æ¬¡æ¾å¼›æ“ä½œï¼Œç†è®ºä¸Šå°±æ‰¾åˆ°äº†ä»æºç‚¹åˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚\nå¦‚æœè¿˜å¯ä»¥ç»§ç»­æ¾å¼›ï¼Œå°±è¯´æ˜åŸå›¾ä¸­æœ‰è´Ÿæƒç¯\n##æ›´å¤šå’Œæœ€çŸ­è·¯å¾„ç›¸å…³çš„æ€è€ƒ","tags":null,"title":""},{"categories":null,"contents":"imooc_ç®—æ³•ä¸æ•°æ®ç»“æ„ç»¼åˆæå‡ç¯‡ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/imooc_%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%BC%E5%90%88%E6%8F%90%E5%8D%87%E7%AF%87/category/","summary":"imooc_ç®—æ³•ä¸æ•°æ®ç»“æ„ç»¼åˆæå‡ç¯‡ ","tags":null,"title":""},{"categories":null,"contents":"äºŒå‰æ ‘çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ– äºŒå‰æ ‘-\u0026gt; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/imooc/%E7%89%9B%E5%AE%A2%E7%BD%91%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/1_%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E4%BA%8C%E5%8F%89%E6%A0%91%E9%97%AE%E9%A2%98/","summary":"äºŒå‰æ ‘çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ– äºŒå‰æ ‘-\u0026gt; ","tags":null,"title":""},{"categories":null,"contents":"CAS å’Œ ABA é—®é¢˜ åœ¨å¤šå¹¶å‘ç¨‹åºè®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹å¹¶å‘ã€äº’æ–¥ã€ç«äº‰ã€æ­»é”ã€èµ„æºæŠ¢å ç­‰é—®é¢˜ï¼Œå½’æ ¹ç»“åº•å°±æ˜¯è¯»å†™çš„é—®é¢˜ï¼Œæœ‰äº†è¯»å†™æ‰æœ‰å¢åˆ æ”¹æŸ¥ï¼Œæ‰æœ‰ä¸€åˆ‡ã€‚åŒæ ·ä¹Ÿæœ‰äº†è°è¯»è°å†™ã€è¿™æ ·çš„é¡ºåºå’Œä¸»æ¬¡é—®é¢˜ï¼Œäºæ˜¯å°±æœ‰äº†ä¸Šé”ï¼Œä¹è§‚é”å’Œæ‚²è§‚é”ã€åŒæ­¥å’Œå¼‚æ­¥ã€ç¡çœ å’Œæ¢å…¥æ¢å‡ºç­‰é—®é¢˜ï¼Œå½’æ ¹ç»“åº•å°±æ˜¯æ¨¡æ‹Ÿäº†ç¤¾ä¼šçš„åˆ†å·¥åä½œä¸èµ„æºå…±äº«çš„æŠ¢å ï¼Œè¦ç†è§£å¥½è¿™äº›ç°è±¡çš„æœ¬è´¨ï¼Œæˆ‘ä»¬éœ€è¦æ›´åŠ æ·±åˆ»çš„è¿›è¡Œç±»æ¯”å’Œè¾¨æã€‚è¦çŸ¥é“è¿™äº›å†…å®¹çš„æœ¬è´¨å°±æ˜¯å†…å­˜å’ŒCPUä¹‹é—´çš„æ•…äº‹ï¼Œæœ‰æ—¶å€™è¿˜ä¼šæœ‰ä¸€äº›å¤–å­˜å’Œå…¶ä»–ç¼“å­˜ã€‚\nhttps://www.cnblogs.com/zyrblog/p/9864932.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/CAS/","summary":"CAS å’Œ ABA é—®é¢˜ åœ¨å¤šå¹¶å‘ç¨‹åºè®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹å¹¶å‘ã€äº’æ–¥ã€ç«äº‰ã€æ­»é”ã€èµ„æºæŠ¢å ç­‰é—®é¢˜ï¼Œå½’æ ¹ç»“åº•å°±æ˜¯è¯»å†™çš„é—®é¢˜ï¼Œæœ‰äº†è¯»å†™æ‰æœ‰å¢åˆ æ”¹æŸ¥ï¼Œæ‰æœ‰ä¸€åˆ‡ã€‚åŒæ ·ä¹Ÿæœ‰äº†è°è¯»è°å†™ã€è¿™æ ·çš„é¡ºåºå’Œä¸»æ¬¡é—®é¢˜ï¼Œäºæ˜¯å°±æœ‰äº†ä¸Šé”ï¼Œä¹è§‚é”å’Œæ‚²è§‚é”ã€åŒæ­¥å’Œå¼‚æ­¥ã€ç¡çœ å’Œæ¢å…¥æ¢å‡ºç­‰é—®é¢˜ï¼Œå½’æ ¹ç»“åº•å°±æ˜¯æ¨¡æ‹Ÿäº†ç¤¾ä¼šçš„åˆ†å·¥åä½œä¸èµ„æºå…±äº«çš„æŠ¢å ï¼Œè¦ç†è§£å¥½è¿™äº›ç°è±¡çš„æœ¬è´¨ï¼Œæˆ‘ä»¬éœ€è¦æ›´åŠ æ·±åˆ»çš„è¿›è¡Œç±»æ¯”å’Œè¾¨æã€‚è¦çŸ¥é“è¿™äº›å†…å®¹çš„æœ¬è´¨å°±æ˜¯å†…å­˜å’ŒCPUä¹‹é—´çš„æ•…äº‹ï¼Œæœ‰æ—¶å€™è¿˜ä¼šæœ‰ä¸€äº›å¤–å­˜å’Œå…¶ä»–ç¼“å­˜ã€‚\nhttps://www.cnblogs.com/zyrblog/p/9864932.html","tags":null,"title":""},{"categories":null,"contents":"RandomAccessFile ä¸åŒäºFileInputStreamå’ŒFileOutputStream,ä¸æ˜¯ä»–ä»¬çš„å­ç±» å½“æˆ‘ä»¬æƒ³å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œçš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ªæŒ‡å‘è¯¥æ–‡ä»¶çš„RandomAccessFileæµå°±å¯ä»¥äº† ï¼› ä½†æ˜¯å¯¹äºOutputStreamå’ŒDataOutputStreamï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™éƒ½æ˜¯é€šè¿‡ä»–ä»¬çš„æ„é€ æ–¹æ³•æ¥é™„åŠ æˆ–æ›´æ–°æ–‡ä»¶ï¼Œå³åœ¨æ„é€ æ–¹æ³•ä¸­new FileOutputStreamï¼›\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/IO%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99/","summary":"RandomAccessFile ä¸åŒäºFileInputStreamå’ŒFileOutputStream,ä¸æ˜¯ä»–ä»¬çš„å­ç±» å½“æˆ‘ä»¬æƒ³å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œçš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ªæŒ‡å‘è¯¥æ–‡ä»¶çš„RandomAccessFileæµå°±å¯ä»¥äº† ï¼› ä½†æ˜¯å¯¹äºOutputStreamå’ŒDataOutputStreamï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™éƒ½æ˜¯é€šè¿‡ä»–ä»¬çš„æ„é€ æ–¹æ³•æ¥é™„åŠ æˆ–æ›´æ–°æ–‡ä»¶ï¼Œå³åœ¨æ„é€ æ–¹æ³•ä¸­new FileOutputStreamï¼›","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/Java-%E5%BC%82%E5%B8%B8/","summary":"","tags":null,"title":""},{"categories":null,"contents":"Java8 æ–°ç‰¹æ€§ Java8 é€Ÿåº¦æ›´å¿«ï¼Œä»£ç æ›´å°‘ï¼Œå¼ºå¤§çš„Stream APIï¼Œä¾¿äºå¹¶è¡Œ æœ€å¤§åŒ–å‡å°‘ç©ºæŒ‡é’ˆå¼‚å¸¸ optional\nLambdaè¡¨è¾¾å¼ Lambda æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠLambda è¡¨è¾¾å¼ç†è§£ä¸ºæ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç ï¼ˆå°†ä»£ç åƒæ•°æ®ä¸€æ ·è¿›è¡Œä¼ é€’ï¼‰ã€‚å¯ä»¥å†™å‡ºæ›´ç®€æ´ã€æ›´çµæ´»çš„ä»£ç ã€‚ä½œä¸ºä¸€ç§æ›´ç´§å‡‘çš„ä»£ç é£æ ¼ï¼Œä½¿ Javaçš„è¯­è¨€è¡¨è¾¾èƒ½åŠ›å¾—åˆ°äº†æå‡ã€‚\nä»åŒ¿åç±»åˆ°Lambda çš„è½¬æ¢ 1// åŒ¿åå†…éƒ¨ç±» 2Runnable r1 = new Runnable(){ 3 @Override 4 public void run(){ 5 System.out.println(\u0026#34;Hello world\u0026#34;); 6 } 7} 8 9//Lambda è¡¨è¾¾å¼ 10Runnable r1 = () -\u0026gt; System.out.println(); 11 12//åŸæ¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ä½œä¸ºå‚æ•°ä¼ é€’ 13TreeSet\u0026lt;String\u0026gt; ts = new TreeSet\u0026lt;\u0026gt;(new Comparator\u0026lt;String\u0026gt;(){ 14 @Override 15 public int compare(String o1, String o2){ 16 return Integer.compare(o1.length(), o2.length()); 17 } 18}); 19 20//Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ä¼ é€’ 21TreeSet\u0026lt;String\u0026gt; ts2 = new TreeSet\u0026lt;\u0026gt;( 22\t(o1, o2) -\u0026gt; Integer.compare(o1.length, o2.length)); 23 Lambdaè¡¨è¾¾å¼è¯­æ³• Lambdaè¡¨è¾¾å¼åœ¨Javaè¯­è¨€ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„è¯­æ³•å…ƒç´ å’Œæ“ä½œç¬¦ã€‚è¿™ä¸ªæ“ä½œç¬¦ä¸ºâ€œ-\u0026gt;â€ï¼Œè¿™ä¸ªæ“ä½œç¬¦è¢«ç§°ä¸ºLambdaæ“ä½œç¬¦æˆ–ç®­å¤´æ“ä½œç¬¦ã€‚å®ƒå°†Lambdaåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š\nå·¦ä¾§ï¼šæŒ‡å®šäº†Lambda è¡¨è¾¾å¼éœ€è¦çš„æ‰€æœ‰å‚æ•°\nå³ä¾§ï¼šæŒ‡å®šäº†Lambdaä½“ï¼Œå³Lambdaè¡¨è¾¾å¼è¦æ‰§è¡Œçš„åŠŸèƒ½\nè¯­æ³•æ ¼å¼ æ— å‚ï¼Œæ— è¿”å›å€¼ï¼ŒLambda ä½“åªéœ€ä¸€æ¡è¯­å¥ 1Runnable r1= ()-\u0026gt;System.out.println(\u0026#34;Hello World\u0026#34;); Lambda éœ€è¦ä¸€ä¸ªå‚æ•°\n1Consumer\u0026lt;String\u0026gt; fun = (args)-\u0026gt; System.out.println(args); Lambda åªéœ€ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå‚æ•°çš„å°æ‹¬å·å¯ä»¥çœç•¥\n1Consumer\u0026lt;String\u0026gt; fun = args -\u0026gt; System.out.printlna(args); Lambda éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼\n1BinaryOperator\u0026lt;Long\u0026gt; bo = (x,y) -\u0026gt; { 2 System.out.println(\u0026#34;å®ç°å‡½æ•°æ¥å£æ–¹æ³•ï¼\u0026#34;); 3 return x+y; 4} å½“Lambdaä½“åªæœ‰ä¸€æ¡è¯­å¥æ—¶ï¼Œreturnä¸å¤§æ‹¬å·å¯ä»¥çœç•¥\n1BinaryOperator\u0026lt;Long\u0026gt; bo = (x,y)-\u0026gt; x+y; å‚æ•°çš„æ•°æ®ç±»å‹å¯ä»¥çœç•¥ï¼Œå› ä¸ºå¯ä»¥ç”±ç¼–è¯‘å™¨æ¨æ–­å¾—å‡ºï¼Œç§°ä¸ºâ€œç±»å‹åˆ¤æ–­â€\n1BinaryOperator\u0026lt;Long\u0026gt; bo = (Long x, Long y) -\u0026gt; { 2 System.out.println(\u0026#34;å®ç°å‡½æ•°æ¥å£æ–¹æ³•ï¼\u0026#34;); 3 return x+y; 4} ç±»å‹æ¨æ–­ ä¸Šè¿° Lambda è¡¨è¾¾å¼ä¸­çš„å‚æ•°ç±»å‹éƒ½æ˜¯ç”±ç¼–è¯‘å™¨æ¨æ–­å¾—å‡ºçš„ã€‚Lambda è¡¨è¾¾å¼ä¸­æ— éœ€æŒ‡å®šç±»å‹ï¼Œç¨‹åºä¾ç„¶å¯ä»¥ç¼–è¯‘ï¼Œè¿™æ˜¯å› ä¸º javac æ ¹æ®ç¨‹åºçš„ä¸Šä¸‹æ–‡ï¼Œåœ¨åå°æ¨æ–­å‡ºäº†å‚æ•°çš„ç±»å‹ã€‚Lambda è¡¨è¾¾å¼çš„ç±»å‹ä¾èµ–äºä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œæ˜¯ç”±ç¼–è¯‘å™¨æ¨æ–­å‡ºæ¥çš„ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ â€œç±»å‹æ¨æ–­â€\nå‡½æ•°å¼æ¥å£ ä»€ä¹ˆæ˜¯æ˜¯å‡½æ•°å¼æ¥å£ åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œç§°ä¸ºå‡½æ•°å¼æ¥å£ã€‚ ä½ å¯ä»¥é€šè¿‡ Lambda è¡¨è¾¾å¼æ¥åˆ›å»ºè¯¥æ¥å£çš„å¯¹è±¡ã€‚ï¼ˆè‹¥ Lambda è¡¨è¾¾å¼æŠ›å‡ºä¸€ä¸ªå—æ£€å¼‚å¸¸ï¼Œé‚£ä¹ˆè¯¥å¼‚å¸¸éœ€è¦åœ¨ç›®æ ‡æ¥å£çš„æŠ½è±¡æ–¹æ³•ä¸Šè¿›è¡Œå£°æ˜ï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„å‡½æ•°å¼æ¥å£ä¸Šä½¿ç”¨ @FunctionalInterface æ³¨è§£ï¼Œ è¿™æ ·åšå¯ä»¥æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼ŒåŒæ—¶ javadoc ä¹Ÿä¼šåŒ…å«ä¸€æ¡å£°æ˜ï¼Œè¯´æ˜è¿™ä¸ªæ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚ è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£ 1@FunctionalInterface 2public interface MyNumber{ 3 public double getValue(); 4} å‡½æ•°å¼æ¥å£ä¸­ä½¿ç”¨æ³›å‹\n1@FunctionalInterface 2public interface MyFunc\u0026lt;T\u0026gt;{ 3 public T getValue(T t); 4} å‡½æ•°å¼æ¥å£ä½œä¸ºå‚æ•°ä¼ é€’ç»™Lambdaè¡¨è¾¾å¼\n1public String toUpperString(Myfunc\u0026lt;String\u0026gt; mf, String str){ 2 return mf.getValue(str); 3} 4 5// ä½œä¸ºå‚æ•°ä¼ é€’Lambda è¡¨è¾¾å¼ 6String newStr = toUpperString( 7\t(str) -\u0026gt; str.toUpperCase, \u0026#34;abcdef\u0026#34;; 8); 9Systen.out.println(newStr); ä½œä¸ºå‚æ•°ä¼ é€’ Lambda è¡¨è¾¾å¼ï¼šä¸ºäº†å°† Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œæ¥æ”¶Lambda è¡¨è¾¾å¼çš„å‚æ•°ç±»å‹å¿…é¡»æ˜¯ä¸è¯¥ Lambda è¡¨è¾¾å¼å…¼å®¹çš„å‡½æ•°å¼æ¥å£ çš„ç±»å‹ã€‚\næ–¹æ³•å¼•ç”¨ä¸æ„é€ å™¨å¼•ç”¨ Stream API æ¥å£ä¸­é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³• jie\næ–°æ—¥æœŸæ—¶é—´ API å…¶ä»–æ–°ç‰¹æ€§ Optionalç±» Optional ç±»(java.util.Optional) æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ï¼Œä»£è¡¨ä¸€ä¸ªå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨ï¼Œ åŸæ¥ç”¨ null è¡¨ç¤ºä¸€ä¸ªå€¼ä¸å­˜åœ¨ï¼Œç°åœ¨ Optional å¯ä»¥æ›´å¥½çš„è¡¨è¾¾è¿™ä¸ªæ¦‚å¿µã€‚å¹¶ä¸”å¯ä»¥é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\nå¸¸ç”¨æ–¹æ³•ï¼š\nOptional.of(T t) : åˆ›å»ºä¸€ä¸ª Optional å®ä¾‹\nOptional.empty( : åˆ›å»ºä¸€ä¸ªç©ºçš„ Optional å®ä¾‹\nOptional.ofNullable(T t):è‹¥ t ä¸ä¸º null,åˆ›å»º Optional å®ä¾‹,å¦åˆ™åˆ›å»ºç©ºå®ä¾‹\nisPresent() : åˆ¤æ–­æ˜¯å¦åŒ…å«å€¼\norElse(T t) : å¦‚æœè°ƒç”¨å¯¹è±¡åŒ…å«å€¼ï¼Œè¿”å›è¯¥å€¼ï¼Œå¦åˆ™è¿”å›t\norElseGet(Supplier s) :å¦‚æœè°ƒç”¨å¯¹è±¡åŒ…å«å€¼ï¼Œè¿”å›è¯¥å€¼ï¼Œå¦åˆ™è¿”å› s è·å–çš„å€¼\nmap(Function f): å¦‚æœæœ‰å€¼å¯¹å…¶å¤„ç†ï¼Œå¹¶è¿”å›å¤„ç†åçš„Optionalï¼Œå¦åˆ™è¿”å› Optional.empty() flatMap(Function mapper)ä¸ map ç±»ä¼¼ï¼Œè¦æ±‚è¿”å›å€¼å¿…é¡»æ˜¯Optional\né‡å¤æ³¨è§£ä¸ç±»å‹æ³¨è§£ ä¸¤ç‚¹æ”¹è¿›ï¼š å¯é‡å¤çš„æ³¨è§£åŠå¯ç”¨äºç±»å‹çš„æ³¨è§£\n1@Target({TYPE, FIELD, METHOD, PARAMETER, CON}) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/Java8%E6%96%B0%E7%89%B9%E6%80%A7/","summary":"Java8 æ–°ç‰¹æ€§ Java8 é€Ÿåº¦æ›´å¿«ï¼Œä»£ç æ›´å°‘ï¼Œå¼ºå¤§çš„Stream APIï¼Œä¾¿äºå¹¶è¡Œ æœ€å¤§åŒ–å‡å°‘ç©ºæŒ‡é’ˆå¼‚å¸¸ optional\nLambdaè¡¨è¾¾å¼ Lambda æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠLambda è¡¨è¾¾å¼ç†è§£ä¸ºæ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç ï¼ˆå°†ä»£ç åƒæ•°æ®ä¸€æ ·è¿›è¡Œä¼ é€’ï¼‰ã€‚å¯ä»¥å†™å‡ºæ›´ç®€æ´ã€æ›´çµæ´»çš„ä»£ç ã€‚ä½œä¸ºä¸€ç§æ›´ç´§å‡‘çš„ä»£ç é£æ ¼ï¼Œä½¿ Javaçš„è¯­è¨€è¡¨è¾¾èƒ½åŠ›å¾—åˆ°äº†æå‡ã€‚\nä»åŒ¿åç±»åˆ°Lambda çš„è½¬æ¢ 1// åŒ¿åå†…éƒ¨ç±» 2Runnable r1 = new Runnable(){ 3 @Override 4 public void run(){ 5 System.out.println(\u0026#34;Hello world\u0026#34;); 6 } 7} 8 9//Lambda è¡¨è¾¾å¼ 10Runnable r1 = () -\u0026gt; System.out.println(); 11 12//åŸæ¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ä½œä¸ºå‚æ•°ä¼ é€’ 13TreeSet\u0026lt;String\u0026gt; ts = new TreeSet\u0026lt;\u0026gt;(new Comparator\u0026lt;String\u0026gt;(){ 14 @Override 15 public int compare(String o1, String o2){ 16 return Integer.compare(o1.length(), o2.length()); 17 } 18}); 19 20//Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ä¼ é€’ 21TreeSet\u0026lt;String\u0026gt; ts2 = new TreeSet\u0026lt;\u0026gt;( 22\t(o1, o2) -\u0026gt; Integer.","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/JavaIO/","summary":"","tags":null,"title":""},{"categories":null,"contents":"Java è™šæ‹Ÿæœº è™šæ‹Ÿæœºè°ƒä¼˜ Java è™šæ‹Ÿæœºè°ƒä¼˜å‚æ•° -Xms èµ·å§‹å†…å­˜ JVMå †å†…å­˜ -Xmx æœ€å¤§å†…å­˜ JVMå †å†…å­˜ -Xmn æ–°ç”Ÿä»£å†…å­˜ -Xss æ ˆå¤§å°ã€‚ å°±æ˜¯åˆ›å»ºçº¿ç¨‹åï¼Œåˆ†é…ç»™æ¯ä¸€ä¸ªçº¿ç¨‹çš„å¤§å° -XX:NewRatio è®¾ç½®å¹´è½»ä»£å’Œè€å¹´ä»£çš„æ¯”å€¼ã€‚é»˜è®¤ä¸º2:1ã€‚å¦‚æœä¸º3ï¼Œè¡¨ç¤ºå¹´è½»ä»£ä¸è€å¹´ä»£çš„æ¯”å€¼ä¸º1:3ï¼Œå¹´è½»ä»£å æ•´ä¸ªå¹´è½»ä»£å’Œè€å¹´ä»£çš„1/4ã€‚ -XX:SurvivorRatioå¹´è½»ä»£ä¸­EdenåŒºå’Œä¸¤ä¸ªSurvivoråŒºçš„æ¯”å€¼ã€‚å¦‚æœä¸º3ï¼Œè¡¨ç¤ºEden:Survivor = 3:2, å› ä¸ºæœ‰ä¸¤ä¸ªSurvivoråŒºåŸŸï¼Œæ‰€ä»¥ä¸€ä¸ªSurvivoråŒºå æ•´ä¸ªå¹´è½»ä»£çš„1/5. -XX:MaxPermSizeè®¾ç½®æŒä¹…ä»£çš„å¤§å°ã€‚ æ”¶é›†å™¨çš„è®¾ç½®\n-XX:+UseSerialGCè®¾ç½®ä¸²è¡Œæ”¶é›†å™¨ -XX:+UseParallelGCè®¾ç½®å¹¶è¡Œæ”¶é›†å™¨ -XX:+UseParallelOldè®¾ç½®å¹¶è¡Œè€å¹´ä»£æ”¶é›†å™¨ -XX:+UseConcMarkSweepGCè®¾ç½®å¹¶å‘æ”¶é›†å™¨ åƒåœ¾å›æ”¶ç»Ÿè®¡ä¿¡æ¯\n-XX:PrintGC -XX:PrintGCDetails -XX:PrintGCTimeStamps -Xloggc:filename å¹¶è¡Œæ”¶é›†å™¨è®¾ç½®\n-XX:ParallelGCThreads=nè®¾ç½®å¹¶è¡Œæ”¶é›†å™¨æ”¶é›†æ—¶ä½¿ç”¨çš„CPUæ•°ã€‚å¹¶è¡Œæ”¶é›†çº¿ç¨‹æ•°ã€‚ -XX:MaxGCPauseMillis=nè®¾ç½®å¹¶è¡Œæ”¶é›†æœ€å¤§æš‚åœæ—¶é—´ -XX:GCTimeRatio=nè®¾ç½®åƒåœ¾å›æ”¶æ—¶é—´å ç¨‹åºè¿è¡Œæ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚å…¬å¼ä¸º1/(1+n) å¹¶å‘æ”¶é›†å™¨è®¾ç½®\nXX:+CMSIncrementalModeè®¾ç½®ä¸ºå¢é‡æ¨¡å¼ã€‚é€‚ç”¨äºå•CPUæƒ…å†µã€‚ XX:ParallelGCThreads=nè®¾ç½®å¹¶å‘æ”¶é›†å™¨å¹´è½»ä»£æ”¶é›†æ–¹å¼ä¸ºå¹¶è¡Œæ”¶é›†æ—¶ï¼Œä½¿ç”¨çš„CPUæ•°ã€‚å¹¶è¡Œæ”¶é›†çº¿ç¨‹æ•°ã€‚ -Xms1G -Xmx2G -Xmn500M -XX:MaxPermSize=64M -XX:+UseConcMarkSweepGC -XX:SurvivorRatio=3\n-Xms1G JVMåˆå§‹å†…å­˜1G è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸æ˜¯åº”è¯¥æ˜¯å †å†…å­˜ -Xmx2G JVMæœ€å¤§å†…å­˜ 2G -Xmn500M æ–°ç”Ÿä»£å†…å­˜ 500M -XX:MaxPermSize æŒä¹…ä»£å†…å­˜ 64M -XX:SurvivorRatio=3 æ–°ç”Ÿä»£ä¸­Eden:Servivor = 3:2 JVM è°ƒä¼˜ -Xms2G -Xmx2G å°†JVMæœ€å¤§å†…å­˜ä¸åˆå§‹å†…å­˜è®¾ç½®ç›¸ç­‰ï¼Œé¿å…JVMåƒåœ¾å›æ”¶åé‡æ–°åˆ†é…å†…å­˜ã€‚ -Xmn1G å¹´è½»ä»£å†…å­˜Sunå®˜æ–¹æ¨èé…ç½®ä¸ºæ•´ä¸ªå †çš„3/8,é€šå¸¸è®¾ç½®ä¸º1/3æˆ–1/4ã€‚ -Xss256Kå‡å°æ¯æ¡çº¿ç¨‹æ ˆçš„å¤§å°ï¼Œèƒ½ç”Ÿæˆæ›´å¤šçš„çº¿ç¨‹ -XX:NewRatio=4 è°ƒæ•´å¹´è½»ä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ å¹´è½»ä»£:è€å¹´ä»£=1:4 -XX:MaxTenuringThreshold=0 è®¾ç½®æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡çš„å¹´é¾„ã€‚ å¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™å¹´è½»ä»£å¯¹è±¡ä¸ç»è¿‡SurvivoråŒºï¼Œç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚å¦‚æœè®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„å€¼ï¼Œåˆ™å¹´è½»ä»£å¯¹è±¡ä¼šåœ¨SurvivoråŒºè¿›è¡Œå¤šæ¬¡å¤åˆ¶ã€‚ -XX:+UseConcMarkSweepGC JVMåœ¨serveræ¨¡å¼ä¸‹é»˜è®¤ä½¿ç”¨PararrelScavengeï¼‹SerialOldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¸æ”¯æŒä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œã€‚å¯ä½¿ç”¨ParNew+CMS+SerialOldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ï¼ˆSerialOldæ”¶é›†å™¨åšä¸ºCMSæ”¶é›†å™¨å‡ºç°ConcurrentModeFailureå¤±è´¥åçš„åå¤‡æ”¶é›†å™¨ä½¿ç”¨ï¼‰ï¼Œå‡å°‘stop-the-worldæ—¶é—´ã€‚ -XX:CMSFullGCsBeforeCompaction ä½¿ç”¨CMSæ—¶ï¼Œè®¾ç½®CMSæ”¶é›†å™¨åœ¨è¿›è¡Œè‹¥å¹²æ¬¡åƒåœ¾æ”¶é›†åå†å¯åŠ¨ä¸€æ¬¡å†…å­˜ç¢ç‰‡ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/","summary":"Java è™šæ‹Ÿæœº è™šæ‹Ÿæœºè°ƒä¼˜ Java è™šæ‹Ÿæœºè°ƒä¼˜å‚æ•° -Xms èµ·å§‹å†…å­˜ JVMå †å†…å­˜ -Xmx æœ€å¤§å†…å­˜ JVMå †å†…å­˜ -Xmn æ–°ç”Ÿä»£å†…å­˜ -Xss æ ˆå¤§å°ã€‚ å°±æ˜¯åˆ›å»ºçº¿ç¨‹åï¼Œåˆ†é…ç»™æ¯ä¸€ä¸ªçº¿ç¨‹çš„å¤§å° -XX:NewRatio è®¾ç½®å¹´è½»ä»£å’Œè€å¹´ä»£çš„æ¯”å€¼ã€‚é»˜è®¤ä¸º2:1ã€‚å¦‚æœä¸º3ï¼Œè¡¨ç¤ºå¹´è½»ä»£ä¸è€å¹´ä»£çš„æ¯”å€¼ä¸º1:3ï¼Œå¹´è½»ä»£å æ•´ä¸ªå¹´è½»ä»£å’Œè€å¹´ä»£çš„1/4ã€‚ -XX:SurvivorRatioå¹´è½»ä»£ä¸­EdenåŒºå’Œä¸¤ä¸ªSurvivoråŒºçš„æ¯”å€¼ã€‚å¦‚æœä¸º3ï¼Œè¡¨ç¤ºEden:Survivor = 3:2, å› ä¸ºæœ‰ä¸¤ä¸ªSurvivoråŒºåŸŸï¼Œæ‰€ä»¥ä¸€ä¸ªSurvivoråŒºå æ•´ä¸ªå¹´è½»ä»£çš„1/5. -XX:MaxPermSizeè®¾ç½®æŒä¹…ä»£çš„å¤§å°ã€‚ æ”¶é›†å™¨çš„è®¾ç½®\n-XX:+UseSerialGCè®¾ç½®ä¸²è¡Œæ”¶é›†å™¨ -XX:+UseParallelGCè®¾ç½®å¹¶è¡Œæ”¶é›†å™¨ -XX:+UseParallelOldè®¾ç½®å¹¶è¡Œè€å¹´ä»£æ”¶é›†å™¨ -XX:+UseConcMarkSweepGCè®¾ç½®å¹¶å‘æ”¶é›†å™¨ åƒåœ¾å›æ”¶ç»Ÿè®¡ä¿¡æ¯\n-XX:PrintGC -XX:PrintGCDetails -XX:PrintGCTimeStamps -Xloggc:filename å¹¶è¡Œæ”¶é›†å™¨è®¾ç½®\n-XX:ParallelGCThreads=nè®¾ç½®å¹¶è¡Œæ”¶é›†å™¨æ”¶é›†æ—¶ä½¿ç”¨çš„CPUæ•°ã€‚å¹¶è¡Œæ”¶é›†çº¿ç¨‹æ•°ã€‚ -XX:MaxGCPauseMillis=nè®¾ç½®å¹¶è¡Œæ”¶é›†æœ€å¤§æš‚åœæ—¶é—´ -XX:GCTimeRatio=nè®¾ç½®åƒåœ¾å›æ”¶æ—¶é—´å ç¨‹åºè¿è¡Œæ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚å…¬å¼ä¸º1/(1+n) å¹¶å‘æ”¶é›†å™¨è®¾ç½®\nXX:+CMSIncrementalModeè®¾ç½®ä¸ºå¢é‡æ¨¡å¼ã€‚é€‚ç”¨äºå•CPUæƒ…å†µã€‚ XX:ParallelGCThreads=nè®¾ç½®å¹¶å‘æ”¶é›†å™¨å¹´è½»ä»£æ”¶é›†æ–¹å¼ä¸ºå¹¶è¡Œæ”¶é›†æ—¶ï¼Œä½¿ç”¨çš„CPUæ•°ã€‚å¹¶è¡Œæ”¶é›†çº¿ç¨‹æ•°ã€‚ -Xms1G -Xmx2G -Xmn500M -XX:MaxPermSize=64M -XX:+UseConcMarkSweepGC -XX:SurvivorRatio=3\n-Xms1G JVMåˆå§‹å†…å­˜1G è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸æ˜¯åº”è¯¥æ˜¯å †å†…å­˜ -Xmx2G JVMæœ€å¤§å†…å­˜ 2G -Xmn500M æ–°ç”Ÿä»£å†…å­˜ 500M -XX:MaxPermSize æŒä¹…ä»£å†…å­˜ 64M -XX:SurvivorRatio=3 æ–°ç”Ÿä»£ä¸­Eden:Servivor = 3:2 JVM è°ƒä¼˜ -Xms2G -Xmx2G å°†JVMæœ€å¤§å†…å­˜ä¸åˆå§‹å†…å­˜è®¾ç½®ç›¸ç­‰ï¼Œé¿å…JVMåƒåœ¾å›æ”¶åé‡æ–°åˆ†é…å†…å­˜ã€‚ -Xmn1G å¹´è½»ä»£å†…å­˜Sunå®˜æ–¹æ¨èé…ç½®ä¸ºæ•´ä¸ªå †çš„3/8,é€šå¸¸è®¾ç½®ä¸º1/3æˆ–1/4ã€‚ -Xss256Kå‡å°æ¯æ¡çº¿ç¨‹æ ˆçš„å¤§å°ï¼Œèƒ½ç”Ÿæˆæ›´å¤šçš„çº¿ç¨‹ -XX:NewRatio=4 è°ƒæ•´å¹´è½»ä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ å¹´è½»ä»£:è€å¹´ä»£=1:4 -XX:MaxTenuringThreshold=0 è®¾ç½®æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡çš„å¹´é¾„ã€‚ å¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™å¹´è½»ä»£å¯¹è±¡ä¸ç»è¿‡SurvivoråŒºï¼Œç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚å¦‚æœè®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„å€¼ï¼Œåˆ™å¹´è½»ä»£å¯¹è±¡ä¼šåœ¨SurvivoråŒºè¿›è¡Œå¤šæ¬¡å¤åˆ¶ã€‚ -XX:+UseConcMarkSweepGC JVMåœ¨serveræ¨¡å¼ä¸‹é»˜è®¤ä½¿ç”¨PararrelScavengeï¼‹SerialOldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¸æ”¯æŒä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œã€‚å¯ä½¿ç”¨ParNew+CMS+SerialOldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ï¼ˆSerialOldæ”¶é›†å™¨åšä¸ºCMSæ”¶é›†å™¨å‡ºç°ConcurrentModeFailureå¤±è´¥åçš„åå¤‡æ”¶é›†å™¨ä½¿ç”¨ï¼‰ï¼Œå‡å°‘stop-the-worldæ—¶é—´ã€‚ -XX:CMSFullGCsBeforeCompaction ä½¿ç”¨CMSæ—¶ï¼Œè®¾ç½®CMSæ”¶é›†å™¨åœ¨è¿›è¡Œè‹¥å¹²æ¬¡åƒåœ¾æ”¶é›†åå†å¯åŠ¨ä¸€æ¬¡å†…å­˜ç¢ç‰‡ ","tags":null,"title":""},{"categories":null,"contents":"Java é›†åˆç±» çº¿ç¨‹å®‰å…¨ä¸çº¿ç¨‹ä¸å®‰å…¨ å‚è€ƒé“¾æ¥ https://www.cnblogs.com/williamjie/p/9099141.html\nhttps://www.cnblogs.com/heyonggang/p/9112731.html\nhttps://blog.csdn.net/andy_budd/article/details/81413464\nhttps://blog.csdn.net/wufaliang003/article/details/80219296\nhttps://blog.csdn.net/VIP_WangSai/article/details/70182933\nhttps://blog.csdn.net/qq_41216743/article/details/101311040\nhttps://blog.csdn.net/cn12306com/article/details/81318871\nç›¸å…³é¢è¯•é¢˜ 1. ä¸¾ä¾‹è¯´æ˜List ã€Setã€HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ List â€‹ æˆ‘ä»¬çŸ¥é“ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¯·ç¼–å†™ä¸€ä¸ªä¸å®‰å…¨çš„æ¡ˆä¾‹å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Ÿå¯¹äºListæˆ‘ä»¬ä½¿ç”¨çš„å¤§å¤šæ•°åœºæ™¯æ˜¯åœ¨å•çº¿ç¨‹ä¸‹ï¼Œå¦‚æœåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œä¾¿ä¼šå‡ºç°ä¸€äº›çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜\n1public class ContainerNotSafeDemo { 2 public static void main(String[] args) throws InterruptedException { 3 List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); 4 5// 3ç§è§£å†³æ–¹æ¡ˆ 6// List\u0026lt;String\u0026gt; list = new Vector\u0026lt;\u0026gt;(); 7// List list = Collections.synchronizedList(new ArrayList\u0026lt;\u0026gt;()); 8// List list = new CopyOnWriteArrayList(); 9 10 for (int i = 0; i \u0026lt; 30; i++) { // 30 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å¯¹listçš„å†™ä¸è¯»æ“ä½œ 11 new Thread(() -\u0026gt; { 12 list.add(String.valueOf(new Random().nextInt(100))); 13// System.out.println(list); // å¦‚æœæ²¡æœ‰è¿™ä¸€è¡Œå°±ä¸ä¼šæŠ›å¼‚å¸¸,ä½†æ˜¯listä¸­çš„æ•°æ®ä¹Ÿä¸æ˜¯30ä¸ª 14 }, String.valueOf(i)).start(); 15 } 16 17 18 Thread.sleep(3000); 19 System.out.println(list+\u0026#34;\u0026#34;+list.size()); 20 } 21} 22 23/*1.æ•…éšœç°è±¡ 24* æŠ¥é”™java.util.ConcurrentModificationException 25* 2.å¯¼è‡´åŸå›  26* å¹¶å‘äº‰æŠ¢ä¿®æ”¹å¯¼è‡´ 27* 3.è§£å†³æ–¹æ¡ˆ 28* new Vector(); 29* Collections.synchronizedList(new ArrayList\u0026lt;\u0026gt;()); 30* new CopyOnWriteArrayList\u0026lt;\u0026gt;(); 31* 4.ä¼˜åŒ–å»ºè®® 32* åœ¨è¯»å¤šå†™å°‘çš„æ—¶å€™æ¨èä½¿ç”¨ CopeOnWriteArrayList è¿™ä¸ªç±» 33*/ CopyOnWriteArrayListè¯´æ˜ï¼š CopyOnWriteå®¹å™¨å³å†™æ—¶å¤åˆ¶å®¹å™¨ã€‚å¾€ä¸€ä¸ªå®¹å™¨æ·»åŠ å…ƒç´ æ—¶ï¼Œä¸ç›´æ¥å¾€å½“å‰å®¹å™¨Object[] è¿›è¡ŒCopy,å¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„å®¹å™¨Object[] newElements, ç„¶åæ–°çš„å®¹å™¨setArray(newElements); è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥å¯¹CopyOnWriteå®¹å™¨è¿›è¡Œå¹¶å‘çš„è¯»ï¼Œè€Œä¸éœ€è¦åŠ é”ï¼Œå› ä¸ºå½“å‰å®¹å™¨ä¸ä¼šæ·»åŠ ä»»ä½•å…ƒç´ ï¼Œæ‰€ä»¥CopyOnWriteå®¹å™¨ä¹Ÿæ˜¯ä¸€ç›´è¯»å†™åˆ†ç¦»çš„æ€æƒ³ï¼Œè¯»å’Œå†™æ˜¯ä¸åŒçš„å®¹å™¨ã€‚\nCopyOnWriteArrayList ä¸‹çš„Addæ–¹æ³•ï¼š\n1 public boolean add(E e) { 2 final ReentrantLock lock = this.lock; 3 lock.lock(); 4 try { 5 Object[] elements = getArray(); 6 int len = elements.length; 7 Object[] newElements = Arrays.copyOf(elements, len + 1); 8 newElements[len] = e; 9 setArray(newElements); 10 return true; 11 } finally { 12 lock.unlock(); 13 } 14 } Set Set æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¯·ç¼–å†™ä¸€ä¸ªä¸å®‰å…¨çš„æ¡ˆä¾‹å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Ÿ\n1 public static void main(String[] args) { 2 Set\u0026lt;String\u0026gt; set = new HashSet\u0026lt;\u0026gt;(); //å¯¼è‡´çº¿ç¨‹ä¸å®‰å…¨ 3// 2ç§è§£å†³æ–¹æ¡ˆ 4// Set\u0026lt;String\u0026gt; set = Collections.synchronizedSet(new HashSet\u0026lt;\u0026gt;()); 5// Set\u0026lt;String\u0026gt; set = new CopyOnWriteArraySet\u0026lt;\u0026gt;(); 6 for (int i = 1; i \u0026lt;= 30; i++) { 7 new Thread(()-\u0026gt;{ 8 set.add(UUID.randomUUID().toString().substring(0,8)); 9 System.out.println(set); 10 },String.valueOf(i)).start(); 11 } 12 //HashSet åº•å±‚æ˜¯HashMap 13 } HashMap HashMap æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¯·ç¼–å†™ä¸€ä¸ªä¸å®‰å…¨çš„æ¡ˆä¾‹å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Ÿ\n1 public static void main(String[] args) { 2 Map\u0026lt;String,String\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); //å¯¼è‡´çº¿ç¨‹ä¸å®‰å…¨ 3// 2ç§è§£å†³æ–¹æ¡ˆ 4// Map\u0026lt;String,String\u0026gt; map = Collections.synchronizedMap(new HashMap\u0026lt;\u0026gt;()); 5// Map\u0026lt;String,String\u0026gt; map = new ConcurrentHashMap\u0026lt;\u0026gt;(); 6 for (int i = 0; i \u0026lt;= 30; i++) { 7 new Thread(()-\u0026gt;{ 8 map.put(Thread.currentThread().getName(), UUID.randomUUID().toString().substring(0,8)); 9 System.out.println(map); 10 },String.valueOf(i)).start(); 11 } 12 } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/Java%E9%9B%86%E5%90%88%E7%B1%BB/","summary":"Java é›†åˆç±» çº¿ç¨‹å®‰å…¨ä¸çº¿ç¨‹ä¸å®‰å…¨ å‚è€ƒé“¾æ¥ https://www.cnblogs.com/williamjie/p/9099141.html\nhttps://www.cnblogs.com/heyonggang/p/9112731.html\nhttps://blog.csdn.net/andy_budd/article/details/81413464\nhttps://blog.csdn.net/wufaliang003/article/details/80219296\nhttps://blog.csdn.net/VIP_WangSai/article/details/70182933\nhttps://blog.csdn.net/qq_41216743/article/details/101311040\nhttps://blog.csdn.net/cn12306com/article/details/81318871\nç›¸å…³é¢è¯•é¢˜ 1. ä¸¾ä¾‹è¯´æ˜List ã€Setã€HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ List â€‹ æˆ‘ä»¬çŸ¥é“ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¯·ç¼–å†™ä¸€ä¸ªä¸å®‰å…¨çš„æ¡ˆä¾‹å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Ÿå¯¹äºListæˆ‘ä»¬ä½¿ç”¨çš„å¤§å¤šæ•°åœºæ™¯æ˜¯åœ¨å•çº¿ç¨‹ä¸‹ï¼Œå¦‚æœåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œä¾¿ä¼šå‡ºç°ä¸€äº›çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜\n1public class ContainerNotSafeDemo { 2 public static void main(String[] args) throws InterruptedException { 3 List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); 4 5// 3ç§è§£å†³æ–¹æ¡ˆ 6// List\u0026lt;String\u0026gt; list = new Vector\u0026lt;\u0026gt;(); 7// List list = Collections.synchronizedList(new ArrayList\u0026lt;\u0026gt;()); 8// List list = new CopyOnWriteArrayList(); 9 10 for (int i = 0; i \u0026lt; 30; i++) { // 30 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å¯¹listçš„å†™ä¸è¯»æ“ä½œ 11 new Thread(() -\u0026gt; { 12 list.","tags":null,"title":""},{"categories":null,"contents":"å¤šçº¿ç¨‹ â€‹\nå®ˆæŠ¤çº¿ç¨‹ Javaçš„mainæ˜¯æ™®é€šçº¿ç¨‹ï¼Œå¹¶ä¸æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œ\nå®ˆæŠ¤çº¿ç¨‹ä¼šç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹æ‰§è¡Œç»“æŸåå†ç»“æŸ\nçº¿ç¨‹åŒæ­¥ https://www.jianshu.com/p/2394317257ec\nhttps://www.jianshu.com/p/988bfceadb62\nhttps://www.jianshu.com/p/6f98f03430eb\nhttps://www.cnblogs.com/williamjie/p/9099141.html\nJava ä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯• Java ä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å†æ‰§è¡Œã€‚\nç”¨sleep() è®©ä¸»çº¿ç¨‹ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯è¿™ä¸ªç¡çœ æ—¶é—´æ˜¯ä¸»è§‚è®¾ç½®çš„ï¼Œæ˜¯æœ‰æˆ‘ä»¬è‡ªå·±ä¸»è§‚è®¾å®šçš„ï¼Œæ‰€ä»¥ä¸æ¨èä½¿ç”¨ã€‚\n1public static void main(String[] args) throws InterrupteException{ 2 for(int i=0; i\u0026lt;5;i++){ 3 new Thread( 4 new Runnable(){ 5 public void run(){ 6 try{ 7 Thread.sleep(1000); 8 }catch(InterruptException e){ 9 e.preintStrackTrace(); 10 } 11 System.out.println(\u0026#34;å­çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 12 } 13 } 14 ).start(); 15 } 16 Thread.sleep(5000); 17 System.out.println(\u0026#34;ä¸»çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 18} ä½¿ç”¨Threadçš„jion()ç­‰å¾…æ‰€æœ‰çš„å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œä¸»çº¿ç¨‹å†æ‰§è¡Œï¼Œthread.jion()æŠŠæŒ‡å®šçº¿ç¨‹åŠ å…¥åˆ°å½“å‰çº¿ç¨‹ï¼Œå¯ä»¥å°†ä¸¤ä¸ªäº¤æ›¿æ‰§è¡Œçš„çº¿ç¨‹åˆå¹¶ä¸ºé¡ºåºæ‰§è¡Œçš„çº¿ç¨‹ã€‚æ¯”å¦‚åœ¨Bä¸­è°ƒç”¨äº†çº¿ç¨‹Açš„jion()æ–¹æ³•ï¼Œç›´åˆ°çº¿ç¨‹Aæ‰§è¡Œå®Œæ¯•åï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œçº¿ç¨‹Bã€‚\n1public static void main(String[] args) throws InterrupteException{ 2 Vector\u0026lt;Thread\u0026gt; threadVector = new Vector\u0026lt;\u0026gt;(); 3 for(int i=0; i\u0026lt;5;i++){ 4 Thread childThread = new Thread( 5 new Runnable(){ 6 public void run(){ 7 try{ 8 Thread.sleep(1000); 9 }catch(InterruptException e){ 10 e.preintStrackTrace(); 11 } 12 System.out.println(\u0026#34;å­çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 13 } 14 } 15 ); 16 threadVector.add(childThread); 17 childThread.start(); 18 } 19 for(Thread thread: threadVector){ 20 thread.jion(); 21 } 22 System.out.println(\u0026#34;ä¸»çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 23} ç­‰å¾…å¤šçº¿ç¨‹å®Œæˆçš„CountDownLatch\n1public static void main(String[] args) throws InterruptedException{ 2 final CountDownLatch latch = new CountDownLatch(5); 3 for(int i =0; i\u0026lt;5; i++){ 4 new Thread(new Runnable(){ 5 public void run(){ 6 try{ 7 Thread.sleep(1000); 8 }catch(InterruptException e){ 9 e.printStackTrace; 10 } 11 System.out.println(\u0026#34;å­çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 12 latch.countDown(); // è®©Latch ä¸­çš„æ•°å€¼å‡1 13 } 14 }).start; 15 latch.await(); // é˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°latchä¸­çš„å€¼ä¸º0 16 System.out.println(\u0026#34;ä¸»çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 17 } 18} åœ¨è¿™é‡Œè¯´æ˜ä¸€ç‚¹ï¼ŒcountDownLatchä¸å¯èƒ½é‡æ–°åˆå§‹åŒ–æˆ–è€…ä¿®æ”¹CountDownLatchå¯¹è±¡å†…éƒ¨è®¡æ•°å™¨çš„å€¼ï¼Œä¸€ä¸ªçº¿ç¨‹è°ƒç”¨countdownæ–¹æ³•happen-beforeå¦å¤–ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨awaitæ–¹æ³•\nåŒæ­¥å±éšœCyclicBarrier\n1public static void main(String[] args) throws InterruptedException{ 2 final CyclicBarrier barrier = new CyclicBarrier(5); 3 for(int i =0; i\u0026lt;5; i++){ 4 new Thread(new Runnable(){ 5 public void run(){ 6 try{ 7 Thread.sleep(1000); 8 }catch(InterruptException e){ 9 e.printStackTrace; 10 } 11 System.out.println(\u0026#34;å­çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 12 try{ 13 barrier.awiat(); // åˆ°è¾¾å±éšœ 14 }catch(Exception e){ 15 e.printStrackTrace(); 16 } 17 18 } 19 }).start; 20 barrier.await(); 21 System.out.println(\u0026#34;ä¸»çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 22 } 23} countDownLatchåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œè€ŒCyclicBarrieræ–¹æ³•å¯ä»¥ä½¿ç”¨reset()æ–¹æ³•é‡ç½®ï¼Œæ‰€ä»¥CyclicBarrieræ–¹æ³•å¯ä»¥èƒ½å¤„ç†æ›´ä¸ºå¤æ‚çš„ä¸šåŠ¡åœºæ™¯ã€‚\næˆ‘æ›¾ç»åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªå…³äºcountDownLatchå’ŒcyclicBarrierçš„å½¢è±¡æ¯”å–»ï¼Œå°±æ˜¯åœ¨ç™¾ç±³èµ›è·‘çš„æ¯”èµ›ä¸­è‹¥ä½¿ç”¨ countDownLatchçš„è¯å†²è¿‡ç»ˆç‚¹çº¿ä¸€ä¸ªäººå°±ç»™è¯„å§”å‘é€ä¸€ä¸ªäººçš„æˆç»©ï¼Œ10ä¸ªäººæ¯”èµ›å‘é€10æ¬¡ï¼Œå¦‚æœç”¨CyclicBarrierï¼Œåˆ™åªåœ¨æœ€åä¸€ä¸ªäººå†²è¿‡ç»ˆç‚¹çº¿çš„æ—¶å€™å‘é€æ‰€æœ‰äººçš„æ•°æ®ï¼Œä»…ä»…å‘é€ä¸€æ¬¡ï¼Œè¿™å°±æ˜¯åŒºåˆ«ã€‚\nå‚è€ƒé“¾æ¥ https://blog.csdn.net/HaHa_Sir/article/details/79521028\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/%E5%A4%9A%E7%BA%BF%E7%A8%8B/","summary":"å¤šçº¿ç¨‹ â€‹\nå®ˆæŠ¤çº¿ç¨‹ Javaçš„mainæ˜¯æ™®é€šçº¿ç¨‹ï¼Œå¹¶ä¸æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œ\nå®ˆæŠ¤çº¿ç¨‹ä¼šç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹æ‰§è¡Œç»“æŸåå†ç»“æŸ\nçº¿ç¨‹åŒæ­¥ https://www.jianshu.com/p/2394317257ec\nhttps://www.jianshu.com/p/988bfceadb62\nhttps://www.jianshu.com/p/6f98f03430eb\nhttps://www.cnblogs.com/williamjie/p/9099141.html\nJava ä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯• Java ä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å†æ‰§è¡Œã€‚\nç”¨sleep() è®©ä¸»çº¿ç¨‹ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯è¿™ä¸ªç¡çœ æ—¶é—´æ˜¯ä¸»è§‚è®¾ç½®çš„ï¼Œæ˜¯æœ‰æˆ‘ä»¬è‡ªå·±ä¸»è§‚è®¾å®šçš„ï¼Œæ‰€ä»¥ä¸æ¨èä½¿ç”¨ã€‚\n1public static void main(String[] args) throws InterrupteException{ 2 for(int i=0; i\u0026lt;5;i++){ 3 new Thread( 4 new Runnable(){ 5 public void run(){ 6 try{ 7 Thread.sleep(1000); 8 }catch(InterruptException e){ 9 e.preintStrackTrace(); 10 } 11 System.out.println(\u0026#34;å­çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 12 } 13 } 14 ).start(); 15 } 16 Thread.sleep(5000); 17 System.out.println(\u0026#34;ä¸»çº¿ç¨‹æ‰§è¡Œï¼\u0026#34;); 18} ä½¿ç”¨Threadçš„jion()ç­‰å¾…æ‰€æœ‰çš„å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œä¸»çº¿ç¨‹å†æ‰§è¡Œï¼Œthread.jion()æŠŠæŒ‡å®šçº¿ç¨‹åŠ å…¥åˆ°å½“å‰çº¿ç¨‹ï¼Œå¯ä»¥å°†ä¸¤ä¸ªäº¤æ›¿æ‰§è¡Œçš„çº¿ç¨‹åˆå¹¶ä¸ºé¡ºåºæ‰§è¡Œçš„çº¿ç¨‹ã€‚æ¯”å¦‚åœ¨Bä¸­è°ƒç”¨äº†çº¿ç¨‹Açš„jion()æ–¹æ³•ï¼Œç›´åˆ°çº¿ç¨‹Aæ‰§è¡Œå®Œæ¯•åï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œçº¿ç¨‹Bã€‚\n1public static void main(String[] args) throws InterrupteException{ 2 Vector\u0026lt;Thread\u0026gt; threadVector = new Vector\u0026lt;\u0026gt;(); 3 for(int i=0; i\u0026lt;5;i++){ 4 Thread childThread = new Thread( 5 new Runnable(){ 6 public void run(){ 7 try{ 8 Thread.","tags":null,"title":""},{"categories":null,"contents":"è®¾è®¡æ¨¡å¼ å•ä¾‹æ¨¡å¼ ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼ŒæŸä¸ªç±»çš„å®ä¾‹å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œä½ æ²¡æœ‰åŠæ³•å»newï¼Œå› ä¸ºæ„é€ å™¨æ˜¯è¢«privateä¿®é¥°çš„ï¼Œä¸€èˆ¬é€šè¿‡getInstance()çš„æ–¹æ³•æ¥è·å–å®ƒä»¬çš„å®ä¾‹ã€‚\ngetInstance()çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚\nåŒé‡æ ¡éªŒé” 1public class Singleton{ 2 private volatile static Singleton singleton; 3 private Singleton(){} 4 public static Singleton getSingleton(){ 5 if(singleton == null){ 6 synchronized(Singleton.class){ 7 if(singleton==null){ 8 singleton = new singleton; 9 } 10 } 11 } 12 } 13} è§‚å¯Ÿè€…æ¨¡å¼ å¯¹è±¡é—´ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚\nhttps://mp.weixin.qq.com/s/sdj9DcnZZNRiWssgygiTTw\nè£…é¥°è€…æ¨¡å¼ å¯¹å·²æœ‰çš„ä¸šåŠ¡é€»è¾‘è¿›ä¸€æ­¥çš„å°è£…ï¼Œä½¿å…¶å¢åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚Javaä¸­çš„IOæµå°±ä½¿ç”¨äº†è£…é¥°è€…æ¨¡å¼ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä»»æ„ç»„è£…ï¼Œè¾¾åˆ°è‡ªå·±æƒ³è¦çš„æ•ˆæœã€‚\né€‚é…å™¨æ¨¡å¼ å·¥å‚æ¨¡å¼ ##ä»£ç†æ¨¡å¼\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","summary":"è®¾è®¡æ¨¡å¼ å•ä¾‹æ¨¡å¼ ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼ŒæŸä¸ªç±»çš„å®ä¾‹å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œä½ æ²¡æœ‰åŠæ³•å»newï¼Œå› ä¸ºæ„é€ å™¨æ˜¯è¢«privateä¿®é¥°çš„ï¼Œä¸€èˆ¬é€šè¿‡getInstance()çš„æ–¹æ³•æ¥è·å–å®ƒä»¬çš„å®ä¾‹ã€‚\ngetInstance()çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚\nåŒé‡æ ¡éªŒé” 1public class Singleton{ 2 private volatile static Singleton singleton; 3 private Singleton(){} 4 public static Singleton getSingleton(){ 5 if(singleton == null){ 6 synchronized(Singleton.class){ 7 if(singleton==null){ 8 singleton = new singleton; 9 } 10 } 11 } 12 } 13} è§‚å¯Ÿè€…æ¨¡å¼ å¯¹è±¡é—´ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚\nhttps://mp.weixin.qq.com/s/sdj9DcnZZNRiWssgygiTTw\nè£…é¥°è€…æ¨¡å¼ å¯¹å·²æœ‰çš„ä¸šåŠ¡é€»è¾‘è¿›ä¸€æ­¥çš„å°è£…ï¼Œä½¿å…¶å¢åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚Javaä¸­çš„IOæµå°±ä½¿ç”¨äº†è£…é¥°è€…æ¨¡å¼ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä»»æ„ç»„è£…ï¼Œè¾¾åˆ°è‡ªå·±æƒ³è¦çš„æ•ˆæœã€‚\né€‚é…å™¨æ¨¡å¼ å·¥å‚æ¨¡å¼ ##ä»£ç†æ¨¡å¼","tags":null,"title":""},{"categories":null,"contents":"å­—èŠ‚è·³åŠ¨é¢è¯•é¢˜æ€»ç»“ 1. è¿›ç¨‹åˆ›å»ºçš„è¿‡ç¨‹ è¿›ç¨‹çš„åˆ›å»ºè¿‡ç¨‹å¯åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š ï¼ˆ1ï¼‰ç”³è¯·ç©ºç™½çš„PCBã€‚ è¿›ç¨‹æ§åˆ¶å— æè¿°ä¿¡æ¯ï¼Œæ§åˆ¶ä¿¡æ¯ï¼Œèµ„æºä¿¡æ¯ï¼ŒCPUç°åœº ï¼ˆ2ï¼‰ä¸ºæ–°è¿›ç¨‹åˆ†é…èµ„æºã€‚ ï¼ˆ3ï¼‰åˆå§‹åŒ–PCBã€‚ ï¼ˆ4ï¼‰å°†è¿›ç¨‹æ’å…¥å°±ç»ªé˜Ÿåˆ—ã€‚\n2. linux æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ inode(å‘éŸ³ï¼šeye-node)è¯‘æˆä¸­æ–‡å°±æ˜¯ç´¢å¼•èŠ‚ç‚¹ï¼Œå®ƒç”¨æ¥å­˜æ”¾æ¡£æ¡ˆåŠç›®å½•çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…å«æ—¶é—´ã€æ¡£åã€ä½¿ç”¨è€…åŠç¾¤ç»„ç­‰ã€‚\nnode inode\ninodeï¼ˆå³index nodeï¼Œç´¢å¼•èŠ‚ç‚¹ï¼‰æ˜¯ç±»Unix OSä¸­ä¿å­˜æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¯¹è±¡å…ƒæ•°æ®çš„æ•°æ®ç»“æ„ã€‚\nhttps://www.jianshu.com/p/d60a2b44e78e\n3.æ•°æ®åº“äº‹åŠ¡ æ•°æ®åº“äº‹åŠ¡\néš”ç¦»çº§åˆ«\nè„è¯»\nä¸å¯é‡å¤è¯»\nå¹»è¯»\nä¸¢å¤±ä¿®æ”¹\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8%E9%9D%A2%E8%AF%95/","summary":"å­—èŠ‚è·³åŠ¨é¢è¯•é¢˜æ€»ç»“ 1. è¿›ç¨‹åˆ›å»ºçš„è¿‡ç¨‹ è¿›ç¨‹çš„åˆ›å»ºè¿‡ç¨‹å¯åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š ï¼ˆ1ï¼‰ç”³è¯·ç©ºç™½çš„PCBã€‚ è¿›ç¨‹æ§åˆ¶å— æè¿°ä¿¡æ¯ï¼Œæ§åˆ¶ä¿¡æ¯ï¼Œèµ„æºä¿¡æ¯ï¼ŒCPUç°åœº ï¼ˆ2ï¼‰ä¸ºæ–°è¿›ç¨‹åˆ†é…èµ„æºã€‚ ï¼ˆ3ï¼‰åˆå§‹åŒ–PCBã€‚ ï¼ˆ4ï¼‰å°†è¿›ç¨‹æ’å…¥å°±ç»ªé˜Ÿåˆ—ã€‚\n2. linux æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ inode(å‘éŸ³ï¼šeye-node)è¯‘æˆä¸­æ–‡å°±æ˜¯ç´¢å¼•èŠ‚ç‚¹ï¼Œå®ƒç”¨æ¥å­˜æ”¾æ¡£æ¡ˆåŠç›®å½•çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…å«æ—¶é—´ã€æ¡£åã€ä½¿ç”¨è€…åŠç¾¤ç»„ç­‰ã€‚\nnode inode\ninodeï¼ˆå³index nodeï¼Œç´¢å¼•èŠ‚ç‚¹ï¼‰æ˜¯ç±»Unix OSä¸­ä¿å­˜æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¯¹è±¡å…ƒæ•°æ®çš„æ•°æ®ç»“æ„ã€‚\nhttps://www.jianshu.com/p/d60a2b44e78e\n3.æ•°æ®åº“äº‹åŠ¡ æ•°æ®åº“äº‹åŠ¡\néš”ç¦»çº§åˆ«\nè„è¯»\nä¸å¯é‡å¤è¯»\nå¹»è¯»\nä¸¢å¤±ä¿®æ”¹","tags":null,"title":""},{"categories":null,"contents":"å°çº¢ä¹¦é¢è¯• å¦‚ä½•åˆ¤æ–­å•é“¾è¡¨æœ‰ç¯\n1public boolean IsLoop(Node head){ 2 Node fast = head; 3 Node slow = head; 4 if(head = null){ 5 return false; 6 } 7 8 while(fast != null\u0026amp;\u0026amp; slow ï¼= null){ 9 fast = fast.next.next; 10 slow = slow.next; 11 if(fast = slow){ 12 return true; 13 } 14 } 15 16 return false; 17} ä¸‰æ¬¡æ¡æ‰‹ï¼Œ ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡\nA -\u0026gt; B SYN=1, seq = x;\nA \u0026lt;- B SYN = 1, ACK=1, seq = y, ack = x+1;\nA-\u0026gt; B SYN = 1, ACK =1, seq = x+1, ack = y+1;\nå®ç°ä¿¡æ¯å¯¹ç­‰ï¼ŒåŒæ–¹çš„æ”¶å‘æŠ¥æ–‡èƒ½åŠ› é˜²æ­¢è„è¿æ¥ TCP/UDP\nTCP æ˜¯é¢å‘è¿æ¥çš„å¯é ä¼ è¾“ï¼Œå…·æœ‰æµé‡æ§åˆ¶å’Œæ‹¥å¡é¿å…\nUDP æ˜¯ä¸å¯é çš„ï¼Œ\nçº¿ç¨‹å’Œè¿›ç¨‹\nè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•å…ƒ\nçº¿ç¨‹æ˜¯è°ƒåº¦çš„æœ€å°å•å…ƒ\näºŒå‰æ ‘å…ˆåºéå†ï¼Œé€’å½’å’Œéé€’å½’\n1// é€’å½’å…ˆåºéå† 2public void preOrder(TreeNode node){ 3 if(node == null ){ 4 return; 5 } 6 System.out.print(node.val); 7 preOrder(node.left); 8 preOrder(node.right); 9} 1public void preOrder(TreeNode root){ 2 if(root==null){ 3 return; 4 } 5 6 Stack\u0026lt;TreeNode\u0026gt; stack = new Stack\u0026lt;\u0026gt;(); 7 stack.push(root); 8 9 while(!stack.isEmpty()){ 10 TreeNode node = stack.pop(); 11 System.out.print(node.val); 12 if(node.left != null){ 13 stack.push(node.left); 14 } 15 if(node.right !=null){ 16 stack.push(node.right) 17 } 18 } 19} map çš„æ‰©å®¹ï¼ŒHashMap\nHashMapçš„å®¹é‡ä¸º 2^n^, æ‰€ä»¥æ¯æ¬¡æ‰©å®¹éƒ½ä¸º2å€ï¼Œ åœ¨é‡æ–°åˆ†é…å…ƒç´ çš„æ—¶å€™ä¼šæ¯”è¾ƒå¿«\nç´¢å¼•çš„å®ç°\nB+Tree å¹³è¡¡æœç´¢æ ‘\nå‰ç¼€æ ‘\n1class TireNode{ 2 private TireNode[] links; 3 private final int R = 26; 4 private boolean isEnd; 5 public TireNode(){ 6 links = new TireNode[R]; 7 } 8 9 public boolean containsKey(char ch){ 10 return links[ch - \u0026#39;a\u0026#39;] != null; 11 } 12 public TireNode get(char ch){ 13 return links[ch -\u0026#39;a\u0026#39;]; 14 } 15 public void put(){ 16 17 } 18} redis çš„å¥½å¤„\nå­˜å–é€Ÿåº¦å¿«ï¼Œ å¯ä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§\nä¸€ä¸ªä»1åŠ åˆ°nä¸ç”¨å¾ªç¯æ±‚å’Œ é€’å½’å•Š 1public static int sum(int n){ 2\tif (n==1) { 3\treturn 1; 4\t}else { 5\treturn n+sum(n-1);//åŠ æ³• 6\t// return n*sum(n-1); //ä¹˜æ³• 7\t} 8} ä¸€ä¸ªå­—ç¬¦ä¸²æ•°å­—ç»“åˆé‡åˆ°æ•°å­—é‡å¤å‰é¢å­—ç¬¦ï¼Œæ±‚ç¬¬nä¸ªå­—ç¬¦\nHashmapåº•å±‚å®ç°ï¼‹å¦‚ä½•æ‰©å®¹\n13.äºŒå‰æ ‘çš„å‡ ç§æœç´¢æ–¹å¼ NLR LNR LRN å‰ä¸­å å±‚æ¬¡éå†\n14.ä¸¤ç§äºŒå‰æ ‘æ·±æœæ–¹å¼çš„å·®åˆ« æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•çš„å®ç°è¿ç”¨çš„ä¸»è¦æ˜¯å›æº¯æ³•ï¼Œç±»ä¼¼äºæ ‘çš„å…ˆåºéå†ç®—æ³•ã€‚ å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•å€ŸåŠ©é˜Ÿåˆ—çš„å…ˆè¿›å…ˆå‡ºçš„ç‰¹ç‚¹ï¼Œç±»ä¼¼äºæ ‘çš„å±‚æ¬¡éå† https://blog.csdn.net/liupeifeng3514/article/details/83819583\n1é¢\n1.ç¼–ç¨‹é¢˜ï¼šç»™ä½ ä¸€ä¸ªå¯ä»¥ç”Ÿæˆ0-6éšæœºæ•°çš„å‡½æ•°ï¼Œè®¾è®¡ä¸€ä¸ªå¯ä»¥ç”Ÿæˆ0-9éšæœºæ•°çš„å‡½æ•°\né¢è¯•å®˜æç¤ºçš„æ€è·¯æ˜¯ï¼šå…ˆç”Ÿæˆä¸¤ä½0-6çš„éšæœºæ•°ï¼Œç„¶å7è¿›åˆ¶è½¬10æœºåˆ¶ï¼Œå¦‚æœè½¬åŒ–ç»“æœ\u0026lt;=39ï¼Œå°±ç”¨ç»“æœå¯¹10æ±‚ä½™ï¼Œå› ä¸ºç”Ÿæˆ0-39çš„æ¦‚ç‡æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥è·å¾—0-9çš„æ¦‚ç‡ä¹Ÿç›¸ç­‰\n2.ç¼–ç¨‹é¢˜ï¼šç»™ä½ ä¸¤ä¸ªæ•°ç»„ï¼Œæ±‚å¹¶é›†\n3.æ“ä½œç³»ç»Ÿï¼šå¸¸ç”¨çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æœ‰å“ªå‡ ç§ï¼Ÿ\næœ‰å…ˆæ¥å…ˆæœåŠ¡ï¼Œæœ€çŸ­ä½œä¸šä¼˜å…ˆï¼ŒåŸºäºä¼˜å…ˆæƒçš„è°ƒåº¦ç®—æ³•ï¼Œæ—¶é—´ç‰‡è½®è½¬ç­‰\n4.æ“ä½œç³»ç»Ÿï¼šçº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«ï¼Ÿ\n5.æ“ä½œç³»ç»Ÿï¼šçº¿ç¨‹åŒæ­¥æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ\nçº¿ç¨‹åŒæ­¥çš„æ–¹å¼ä¸»è¦æœ‰: ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ã€äº’æ–¥é‡ï¼ˆMutexï¼‰ã€ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ã€äº‹ä»¶ï¼ˆEventï¼‰ã€‚\nä»–ä»¬çš„ä¸»è¦åŒºåˆ«å’Œç‰¹ç‚¹å¦‚ä¸‹ï¼š\n**1ï¼‰ä¸´ç•ŒåŒºï¼š**é€šè¿‡å¯¹å¤šçº¿ç¨‹çš„ä¸²è¡ŒåŒ–æ¥è®¿é—®å…¬å…±èµ„æºæˆ–ä¸€æ®µä»£ç ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆæ§åˆ¶æ•°æ®è®¿é—®ã€‚åœ¨ä»»æ„æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè¿›è¡Œè®¿é—®ï¼Œ\nâ€‹ å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹è¯•å›¾è®¿é—®å…¬å…±èµ„æºï¼Œé‚£ä¹ˆåœ¨æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åï¼Œå…¶ä»–è¯•å›¾è®¿é—®å…¬å…±èµ„æºçš„çº¿ç¨‹å°†è¢«æŒ‚èµ·ï¼Œå¹¶ä¸€ç›´ç­‰åˆ°è¿›å…¥ä¸´ç•ŒåŒºçš„çº¿ç¨‹ç¦»å¼€ï¼Œä¸´ç•ŒåŒºåœ¨è¢«é‡Šæ”¾åï¼Œå…¶ä»–çº¿ç¨‹æ‰å¯ä»¥æŠ¢å ã€‚\n**2ï¼‰äº’æ–¥é‡ï¼š**é‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ã€‚ åªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ï¼Œå› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥èƒ½ä¿è¯å…¬å…±èµ„æºä¸ä¼šåŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ã€‚\nâ€‹ äº’æ–¥ä¸ä»…èƒ½å®ç°åŒä¸€åº”ç”¨ç¨‹åºçš„å…¬å…±èµ„æºå®‰å…¨å…±äº«ï¼Œè¿˜èƒ½å®ç°ä¸åŒåº”ç”¨ç¨‹åºçš„å…¬å…±èµ„æºå®‰å…¨å…±äº«ã€‚\n**3ï¼‰ä¿¡å·é‡ï¼š**å®ƒå…è®¸å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦é™åˆ¶åœ¨åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°ç›®ã€‚\n4ï¼‰äº‹ ä»¶ï¼š é€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒçº¿ç¨‹çš„åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿å®ç°å¯¹å¤šä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒçš„æ“ä½œã€‚\n2é¢ 1.C++ï¼šæœ‰å“ªå‡ ç§æ™ºèƒ½æŒ‡é’ˆï¼Ÿ\n2.C++ï¼šç®€è¿°æ¨¡æ¿ä»¥åŠä¸ºä»€ä¹ˆä½¿ç”¨æ¨¡æ¿çš„æ—¶å€™#include\u0026lt;***.hpp\u0026gt;ï¼Ÿ\n3.ç¼–ç¨‹é¢˜ï¼šç”¨é€’å½’å’Œè¿­ä»£ä¸¤ç§æ–¹å¼å†™åè½¬äºŒå‰æ ‘\n4.ç¼–ç¨‹é¢˜ï¼šæ¯kä¸ªä¸€ç»„åè½¬é“¾è¡¨\n5.æ•°æ®åº“ï¼šrediså’Œå…¶ä»–æ•°æ®åº“çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ—¶å€™é€‰æ‹©redisï¼Ÿ\n5.è®¾è®¡æ¨¡å¼ï¼šå†™ä¸€ä¸ªå•ä¾‹æ¨¡å¼\n3é¢ 1.è®¡ç®—æœºç½‘ç»œï¼šTCP/IP4å±‚æ¨¡å‹æœ‰å“ª4å±‚ï¼Ÿ\n2.è®¡ç®—æœºç½‘ç»œï¼šmacå±‚å¯»å€è¿‡ç¨‹\n3.ç¼–ç¨‹é¢˜ï¼šä»æ–‡æœ¬ä¸­æŸ¥æ‰¾æ•æ„Ÿè¯\né¢è¯•å®˜å¸Œæœ›ä½¿ç”¨å‰ç¼€æ ‘æ¥åšè¿™é“é¢˜\n4.ç¼–ç¨‹é¢˜ï¼šç»™ä½ ä¸€ä¸ªå«æœ‰()å’Œ[]çš„å­—ç¬¦ä¸²ï¼Œè¾“å‡ºæ‹¬å·æ¯å¯¹æ‹¬å·çš„ä½ç½®ä¸‹æ ‡å¦‚ï¼ˆ1,2ï¼‰ï¼Œå¦‚æœæœ‰ä¸åˆæ³•æ‹¬å·è¿”å›ç©º\n5.æ“ä½œç³»ç»Ÿï¼šæœ‰å“ªå‡ ç§IOæ¨¡å‹ï¼Ÿé˜»å¡IOåœ¨åº•å±‚é˜»å¡åœ¨äº†å“ªé‡Œï¼Ÿ\næ‹“å±• å¬åˆ°çš„ä¸€äº›åˆ«äººçš„é—®é¢˜\n1.ç¼–ç¨‹é¢˜ï¼šç¬¬kå¤§çš„æ•°\n2.ç¼–ç¨‹é¢˜ï¼šåˆ¤æ–­ä¸€ä¸ªäºŒå‰æ ‘æ˜¯ä¸æ˜¯å®Œå…¨äºŒå‰æ ‘\n3.ç¼–ç¨‹é¢˜ï¼šåè½¬é“¾è¡¨\n4.ç¼–ç¨‹é¢˜ï¼šç”¨æ ˆå®ç°é˜Ÿåˆ—\n5.ç¼–ç¨‹é¢˜ï¼šå…¨æ’åˆ—\n6.ç¼–ç¨‹é¢˜ï¼šä»äºŒç»´æ•°ç»„ä¸­æŸ¥æ‰¾æ•°ï¼ˆæ¯åˆ—é€’å¢ï¼Œæ¯è¡Œé€’å¢ï¼‰\n7.å¤§æ•°é—®é¢˜ï¼šæ‰¾åˆ°1äº¿ä¸ªæ•°é‡Œå‡ºç°æ¬¡æ•°å‰kå¤§çš„æ•°ï¼Œå†…å­˜æœ‰é™åˆ¶ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œdjqueenã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/u013536232/article/details/100586988\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E5%B0%8F%E7%BA%A2%E4%B9%A6%E9%9D%A2%E8%AF%95/","summary":"å°çº¢ä¹¦é¢è¯• å¦‚ä½•åˆ¤æ–­å•é“¾è¡¨æœ‰ç¯\n1public boolean IsLoop(Node head){ 2 Node fast = head; 3 Node slow = head; 4 if(head = null){ 5 return false; 6 } 7 8 while(fast != null\u0026amp;\u0026amp; slow ï¼= null){ 9 fast = fast.next.next; 10 slow = slow.next; 11 if(fast = slow){ 12 return true; 13 } 14 } 15 16 return false; 17} ä¸‰æ¬¡æ¡æ‰‹ï¼Œ ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡\nA -\u0026gt; B SYN=1, seq = x;\nA \u0026lt;- B SYN = 1, ACK=1, seq = y, ack = x+1;","tags":null,"title":""},{"categories":null,"contents":"10 æ¯æ—¥ä¸€é¢ java ä¸­ throws Exceptionå’Œ catch Exceptionçš„åŒºåˆ« ABè½¬è´¦é—®é¢˜ï¼Œä¿æŒæ•°æ®ä¸€è‡´æ€§ TreeMapå¦‚ä½•ä¿è¯æœ‰åº ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/10th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"10 æ¯æ—¥ä¸€é¢ java ä¸­ throws Exceptionå’Œ catch Exceptionçš„åŒºåˆ« ABè½¬è´¦é—®é¢˜ï¼Œä¿æŒæ•°æ®ä¸€è‡´æ€§ TreeMapå¦‚ä½•ä¿è¯æœ‰åº ","tags":null,"title":""},{"categories":null,"contents":"11 æ¯æ—¥ä¸€é¢ Ucloud\nrpc\nsqlä¼˜åŒ–ï¼Œå¦‚ä½•è§£å†³é«˜å¹¶å‘\nexplain æ…¢æŸ¥è¯¢ï¼Œå»ºç´¢å¼•\nä»€ä¹ˆæ–¹å¼å®ç°ç¼“å­˜ï¼Œä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°token,tokenå¤±æ•ˆæ€ä¹ˆåŠç­‰\nä¸»ä»å¤åˆ¶\næ•°æ®åº“å››ç§éš”ç¦»çº§åˆ«ï¼Œåˆ†åˆ«ä¸¾ä¾‹å­ï¼Œæ¯ç§åœ¨ä¸Šä¸€ç§çš„åŸºç¡€ä¸ŠåŠ äº†ä»€ä¹ˆé”(å¾ˆç®€å•ä¸è¯´äº†)\nTcpï¼ŒåšæŒè®¡æ—¶å™¨ã€‚keepaliveè®¡æ—¶å™¨ã€‚\nå†™äº†ä¸€ä¸ªshellå‘½ä»¤ï¼Œåˆ—å‡ºé‡å¤æ•°æ®ã€‚awk+unique+sortå¾ˆç®€å•ä¹Ÿä¸è¯´äº†ã€‚\nç½‘ç»œåè®® è®¡ç®—æœºç½‘ç»œäº”å±‚åè®®ï¼šç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚\nè®¡ç®—æœºç½‘ç»œçš„ä¸ƒå±‚OSIåè®®ï¼š ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚ã€åº”ç”¨å±‚\nè·¯ç”±å™¨å±äºç½‘ç»œå±‚\nç½‘å¡ä¸äº¤æ¢æœºæ•°æ®æ•°æ®é“¾è·¯å±‚\nTCPå’ŒUDP TCP æ˜¯é¢å‘è¿æ¥çš„å­—èŠ‚æµæœåŠ¡ï¼Œå¯¹ç³»ç»Ÿèµ„æºè¦æ±‚æ¯”è¾ƒå¤šã€‚ç¨‹åºç»“æ„å¤æ‚ï¼Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§å’Œé¡ºåºæ€§ã€‚\nUDPæ˜¯æ— è¿æ¥çš„ï¼Œé¢å‘æ•°æ®æŠ¥ï¼Œå¯¹ç³»ç»Ÿçš„èµ„æºè¦æ±‚æ¯”è¾ƒå°‘ï¼Œç¨‹åºç»“æ„ç®€å•ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§å’Œé¡ºåºæ€§\nç½‘ç«™å®‰å…¨ä¸é˜²æŠ¤\nsql æ³¨å…¥\nä½¿ç”¨ä¾‹å¦‚PDOçš„é¢„å¤„ç†ï¼Œä½¿ç”¨æˆ–è€…ç¼–å†™ç±»ä¼¼mysql_real_escape_stringçš„æ–¹æ³•å¯¹sqlçš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰\n**XSSï¼ˆcross site scriptï¼‰**è·¨ç«™è„šæœ¬æ”»å‡»\nå°†å¤–éƒ¨è„šæœ¬æ¤å…¥åˆ°é¡µé¢ä¸­\n**CSRF(cross-site request forgey)**è·¨ç«™è¯·æ±‚ä¼ªé€ \nä¼ªé€ å—ä¿¡ä»»çš„ç”¨æˆ·ä¿¡æ¯æ¥è¯·æ±‚ç½‘ç«™\nç®—æ³•ç›¸å…³\nå†’æ³¡æ’åº\né€‰æ‹©æ’åº\nâ€‹\tå¿«é€Ÿæ’åº\nå¿«é€Ÿæ’åºæ€æƒ³ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†åºåˆ—åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ‰€æœ‰æ•°æ®æ¯”å¦ä¸€éƒ¨åˆ†æ‰€æœ‰æ•°æ®å°ï¼Œç„¶ååœ¨è¿™ä¸¤ä¸ªåºåˆ—çš„å†…éƒ¨å†åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºæ“ä½œï¼Œç›´åˆ°æœ€åå½¢æˆä¸€ä¸ªæœ‰åºåºåˆ—\näºŒåˆ†æ’å…¥æ’åºæ€æƒ³(ä¹‹å‰çš„åºåˆ—ä¸ºæœ‰åº)ï¼šæ’å…¥ç¬¬iä¸ªå…ƒç´ æ—¶ï¼Œå¯¹å‰é¢çš„0~i-1è¿›è¡ŒæŠ˜åŠï¼Œå½“å‰å…ƒç´ ä¸ä¸­é—´å…ƒç´ æ¯”è¾ƒï¼Œå¦‚æœå°ï¼Œå‰åŠéƒ¨åˆ†å†æ¬¡æŠ˜åŠï¼Œå¦‚æœå¤§ï¼ŒååŠéƒ¨åˆ†è¿›è¡ŒæŠ˜åŠï¼Œç›´åˆ°æœ€åleft\u0026gt;right,ç„¶åæŠŠç›®æ ‡ä½ç½®åˆ°i-1çš„æ‰€æœ‰å…ƒç´ æ•´ä½“åç§»ï¼ŒæŠŠå½“å‰å…ƒç´ æ”¾è¿›å»\nåŸºæœ¬æŸ¥æ‰¾ç®—æ³•ï¼š\né¡ºåºæŸ¥æ‰¾\näºŒåˆ†æ³•æŸ¥æ‰¾(æŠ˜åŠæŸ¥æ‰¾)ï¼šå°†åºåˆ—åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œæ‰¾åˆ°åºåˆ—çš„ä¸­é—´å€¼ï¼Œå¦‚æœæŸ¥æ‰¾å€¼å¤§äºä¸­é—´å€¼ï¼Œç»§ç»­å¯¹å³åŠéƒ¨åˆ†è¿›è¡ŒæŠ˜åŠï¼Œå¦‚æœæŸ¥æ‰¾å€¼å°äºä¸­é—´å€¼ï¼Œå¯¹å·¦åŠéƒ¨åˆ†è¿›è¡ŒæŠ˜åŠï¼Œç›´åˆ°æ‰¾åˆ°æˆ–front\u0026gt;endç»“æŸï¼Œæ—¶é—´å¤æ‚åº¦O(log2n)ä»¥2ä¸ºåº•nçš„å¯¹æ•°\nè®¾è®¡æ¨¡å¼\nMVCæ˜¯ä¸€ç§è®¾è®¡æ¡†æ¶ï¼Œè€Œä¸æ˜¯è®¾è®¡æ¨¡å¼ï¼Œæ¡†æ¶æ˜¯æ¯”æ¨¡å¼æ›´é«˜çš„æ¦‚å¿µ\nmodelè´Ÿè´£æ•°æ®é€»è¾‘\ncontrollerè´Ÿè´£ç”¨æˆ·äº¤äº’\nviewè´Ÿè´£æ•°æ®æ˜¾ç¤ºæµç¨‹ï¼š\nç”¨æˆ·å¯¹æ§åˆ¶å™¨çš„æŸä¸ªæ–¹æ³•å‘å‡ºè¯·æ±‚ï¼Œæ§åˆ¶å™¨è°ƒç”¨ç›¸åº”çš„æ¨¡å‹è¿”å›æ•°æ®ï¼Œç„¶åå°†æ•°æ®æ¸²æŸ“åˆ°è§†å›¾ä¸­è¿”å›ç»™ç”¨æˆ·\nå•ä¾‹æ¨¡å¼i. ç§æœ‰åŒ–æ„é€ æ–¹æ³•å’Œ__cloneæ–¹æ³•ii. æä¾›å…¬æœ‰çš„é™æ€çš„æ–¹æ³•è¿”å›å®ä¾‹iii. æä¾›ç§æœ‰çš„é™æ€å±æ€§ä¿å­˜å®ä¾‹\nç®€å•å·¥å‚æ¨¡å¼(é‡ç‚¹åœ¨åˆ›å»ºä¸åŒå¯¹è±¡ï¼Œä½œç”¨å°±æ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„) - ä¾‹å¦‚ä¸€ä¸ªè®¡ç®—å™¨çš„åŠ å‡ä¹˜é™¤æ±‚ä½™å–æ•´i. å®šä¹‰æŠ½è±¡åŸºç±»è®©å­ç±»åˆ†åˆ«ç»§æ‰¿å¹¶å®ç°ç›¸åº”æ–¹æ³•ii. å®šä¹‰Factoryå·¥å‚ç±»é‡Œé¢æä¾›é™æ€æ–¹æ³•ç”¨äºæ ¹æ®ä¸åŒçš„å‚æ•°å®ä¾‹åŒ–ç›¸åº”çš„å­ç±»å¯¹è±¡\nç­–ç•¥æ¨¡å¼(é‡ç‚¹åœ¨äºå®ä¾‹åŒ–ä¸åŒç±»çš„è§£å†³ç­–ç•¥ä¸åŒï¼Œä½œç”¨æ˜¯æ ¹æ®ä¸åŒçš„æƒ…å†µè°ƒç”¨ç›¸åº”çš„ç­–ç•¥æˆ–ç®—æ³•) - ä¾‹å¦‚qqæ™®é€šç”¨æˆ· vip svipè´­ä¹°çš®è‚¤çš„ä¼˜æƒ ç­–ç•¥i. å®šä¹‰æŠ½è±¡åŸºç±»è®©å­ç±»åˆ†åˆ«ç»§æ‰¿å¹¶å®ç°ç›¸åº”çš„æ–¹æ³•ii. æ ¹æ®ä¸åŒçš„åœºæ™¯å®ä¾‹åŒ–ç›¸åº”çš„ç±»ï¼Œç„¶åè°ƒç”¨å…¶ä¸­çš„æ–¹æ³•è·å–ç»“æœ\nè§‚å¯Ÿè€…æ¨¡å¼\ni. éœ€è¦æœ‰ä¸€ä¸ªæŠ½è±¡çš„ä¸»é¢˜æ¥å£å’Œä¸€ä¸ªæŠ½è±¡çš„è§‚å¯Ÿè€…æ¥å£\nii. å®ç°ä¸€ä¸ªä¸»é¢˜ï¼Œå®ç°å¤šä¸ªè§‚å¯Ÿè€…\niii. å®ä¾‹åŒ–ä¸»é¢˜ï¼Œç„¶åè°ƒç”¨ä¸»é¢˜çš„æ–¹æ³•å¹¶å°†ä¸åŒçš„è§‚å¯Ÿè€…å¯¹è±¡å®ä¾‹åŒ–ä¼ å…¥ï¼Œåœ¨ä¸»é¢˜çš„æ–¹æ³•ä¸­ä¿å­˜ä¼ å…¥çš„è§‚å¯Ÿè€…å¯¹è±¡åˆ°ä¸€ä¸ªå±æ€§ï¼Œåœ¨ä¸»é¢˜ä¸­å®šä¹‰å¦å¤–çš„æ–¹æ³•é€šè¿‡ä¿å­˜è§‚å¯Ÿè€…å¯¹è±¡è°ƒç”¨è§‚å¯Ÿè€…çš„æ–¹æ³•\nå¤§æµé‡å’Œé«˜å¹¶å‘ç½‘ç«™è§£å†³æ€è·¯\napacheæˆ–è€…nginxè¿›è¡Œç›¸å…³é…ç½®\nCDNåŠ é€Ÿ\nå‡å°‘httpè¯·æ±‚ï¼Œæ·»åŠ å¼‚æ­¥è¯·æ±‚\nå¯ç”¨æµè§ˆå™¨ç¼“å­˜ ä»£ç å‹ç¼©(å»é™¤ç©ºç™½ç¬¦) é¡µé¢é™æ€åŒ–ï¼š\nä¿¡æ¯å˜æ›´ä¸æ˜¯å¾ˆé¢‘ç¹çš„é¡µé¢è¿›è¡Œé™æ€åŒ–å¤„ç†ï¼Œç”Ÿæˆhtmlæ–‡ä»¶\næ•°æ®ç¼“å­˜(æ•°æ®åº“ç¼“å­˜redis,æ–‡ä»¶ç¼“å­˜)\nä½¿ç”¨Nginxï¼Œè´Ÿè½½å‡è¡¡\nmysqlæ•°æ®åº“ä¼˜åŒ– å­—æ®µæ•°æ®ç±»å‹ä¼˜åŒ– ç´¢å¼•ä¼˜åŒ– SQLè¯­å¥ä¼˜åŒ– å­˜å‚¨å¼•æ“ä¼˜åŒ– è¡¨ç»“æ„è®¾è®¡ä¼˜åŒ– åˆ†è¡¨åˆ†åº“åˆ†åŒº ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»\nCOOKIE å’Œ SESSION\nCookieå’ŒSession\nsessionä¸cookieéƒ½æ˜¯ä¼šè¯æŠ€æœ¯ï¼Œé»˜è®¤æƒ…å†µä¸‹sessionåœ¨å®¢æˆ·ç«¯ä¾èµ–äºcookie\ncookieä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¿å­˜çš„æ˜¯å­—ç¬¦ä¸²ï¼Œsessionä¿å­˜åœ¨æœåŠ¡ç«¯ï¼Œä¿å­˜çš„æ˜¯å¯¹è±¡\ncookieå®‰å…¨æ€§ä½ï¼Œå¯è¢«æ‹¦æˆªæˆ–ä»æœ¬åœ°åˆ†æå¾—åˆ°ï¼Œsessionå®‰å…¨æ€§é«˜\nsessionä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼Œä¼šå ç”¨æœåŠ¡å™¨çš„èµ„æºï¼Œç†è®ºä¸Šå¤§å°æ²¡æœ‰é™åˆ¶ï¼Œå’ŒæœåŠ¡å™¨å†…å­˜æœ‰å…³\nå•ä¸ªcookieä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡4K,å¾ˆå¤šæµè§ˆå™¨éƒ½é™åˆ¶ä¸€ä¸ªç«™ç‚¹æœ€å¤š20ä¸ªcookie\nç™»å½•ä¿¡æ¯ç­‰é‡è¦ä¿¡æ¯å­˜æ”¾ä¸ºsessionï¼Œå…¶ä»–ä¿¡æ¯å¦‚éœ€ä¿ç•™ï¼Œå¯ä»¥å­˜åœ¨cookieä¸­\nMyISAM å’Œ InnoDB\nMyISAM æ˜¯è¡¨çº§é”ï¼Œä¸æ”¯æŒäº‹åŠ¡å’Œå¤–é”®æ“ä½œ\nInnoDBæ˜¯è¡Œçº§é”ï¼Œæ”¯æŒäº‹åŠ¡å¤„ç†å’Œå¤–é”®\næ‰§è¡Œå¤§é‡çš„select MyISAMæ›´å¥½ï¼Œæ‰§è¡Œå¤§é‡çš„insert å’Œupdate ç”¨InnoDBæ›´å¥½\nGET å’ŒPOST\nGET POST å‚æ•°åœ¨urlåé¢ï¼Œé•¿åº¦æœ‰é™åˆ¶ å‚æ•°åœ¨RequestBodyä¸­ï¼Œé•¿åº¦æ— é™åˆ¶ å¯ä»¥ä¿å­˜ä¸ºæµè§ˆå™¨ç¼“å­˜ ä¸å¯ä»¥ä¿å­˜ä¸ºä¹¦ç­¾ï¼Œä¸å¯ä»¥ç¼“å­˜ ä¿æŒå¹‚ç­‰æ€§ æ•°æ®ä¼šè¢«ä¿®æ”¹ HTTPåŠ¨è¯ï¼Œè§„çº¦ ä¸€æ¬¡å®Œæˆçš„HTTPè¯·æ±‚è¿‡ç¨‹\nåŸŸåè§£æDNSï¼š æµè§ˆå™¨è§£æåŸŸåï¼ˆä¸»æœºåï¼‰ä¸ºç›¸åº”çš„IPåœ°å€\nå»ºç«‹TCPè¿æ¥ ä¸‰æ¬¡æ¡æ‰‹\næµè§ˆå™¨æƒ³æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚\næœåŠ¡å™¨å“åº”httpè¯·æ±‚ï¼Œè¿”å›htmlæ•°æ®\næµè§ˆå™¨è§£æhtmlä»£ç å¹¶è¯·æ±‚htmlä¸­çš„èµ„æº\næµè§ˆå™¨å¯¹é¡µé¢è¿›è¡Œæ¸²æŸ“ç„¶åå±•ç¤ºç»™ç”¨æˆ·\nå…³é—­TCPè¿æ¥\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/11th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"11 æ¯æ—¥ä¸€é¢ Ucloud\nrpc\nsqlä¼˜åŒ–ï¼Œå¦‚ä½•è§£å†³é«˜å¹¶å‘\nexplain æ…¢æŸ¥è¯¢ï¼Œå»ºç´¢å¼•\nä»€ä¹ˆæ–¹å¼å®ç°ç¼“å­˜ï¼Œä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨åˆ°token,tokenå¤±æ•ˆæ€ä¹ˆåŠç­‰\nä¸»ä»å¤åˆ¶\næ•°æ®åº“å››ç§éš”ç¦»çº§åˆ«ï¼Œåˆ†åˆ«ä¸¾ä¾‹å­ï¼Œæ¯ç§åœ¨ä¸Šä¸€ç§çš„åŸºç¡€ä¸ŠåŠ äº†ä»€ä¹ˆé”(å¾ˆç®€å•ä¸è¯´äº†)\nTcpï¼ŒåšæŒè®¡æ—¶å™¨ã€‚keepaliveè®¡æ—¶å™¨ã€‚\nå†™äº†ä¸€ä¸ªshellå‘½ä»¤ï¼Œåˆ—å‡ºé‡å¤æ•°æ®ã€‚awk+unique+sortå¾ˆç®€å•ä¹Ÿä¸è¯´äº†ã€‚\nç½‘ç»œåè®® è®¡ç®—æœºç½‘ç»œäº”å±‚åè®®ï¼šç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚\nè®¡ç®—æœºç½‘ç»œçš„ä¸ƒå±‚OSIåè®®ï¼š ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚ã€åº”ç”¨å±‚\nè·¯ç”±å™¨å±äºç½‘ç»œå±‚\nç½‘å¡ä¸äº¤æ¢æœºæ•°æ®æ•°æ®é“¾è·¯å±‚\nTCPå’ŒUDP TCP æ˜¯é¢å‘è¿æ¥çš„å­—èŠ‚æµæœåŠ¡ï¼Œå¯¹ç³»ç»Ÿèµ„æºè¦æ±‚æ¯”è¾ƒå¤šã€‚ç¨‹åºç»“æ„å¤æ‚ï¼Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§å’Œé¡ºåºæ€§ã€‚\nUDPæ˜¯æ— è¿æ¥çš„ï¼Œé¢å‘æ•°æ®æŠ¥ï¼Œå¯¹ç³»ç»Ÿçš„èµ„æºè¦æ±‚æ¯”è¾ƒå°‘ï¼Œç¨‹åºç»“æ„ç®€å•ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§å’Œé¡ºåºæ€§\nç½‘ç«™å®‰å…¨ä¸é˜²æŠ¤\nsql æ³¨å…¥\nä½¿ç”¨ä¾‹å¦‚PDOçš„é¢„å¤„ç†ï¼Œä½¿ç”¨æˆ–è€…ç¼–å†™ç±»ä¼¼mysql_real_escape_stringçš„æ–¹æ³•å¯¹sqlçš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰\n**XSSï¼ˆcross site scriptï¼‰**è·¨ç«™è„šæœ¬æ”»å‡»\nå°†å¤–éƒ¨è„šæœ¬æ¤å…¥åˆ°é¡µé¢ä¸­\n**CSRF(cross-site request forgey)**è·¨ç«™è¯·æ±‚ä¼ªé€ \nä¼ªé€ å—ä¿¡ä»»çš„ç”¨æˆ·ä¿¡æ¯æ¥è¯·æ±‚ç½‘ç«™\nç®—æ³•ç›¸å…³\nå†’æ³¡æ’åº\né€‰æ‹©æ’åº\nâ€‹\tå¿«é€Ÿæ’åº\nå¿«é€Ÿæ’åºæ€æƒ³ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†åºåˆ—åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ‰€æœ‰æ•°æ®æ¯”å¦ä¸€éƒ¨åˆ†æ‰€æœ‰æ•°æ®å°ï¼Œç„¶ååœ¨è¿™ä¸¤ä¸ªåºåˆ—çš„å†…éƒ¨å†åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºæ“ä½œï¼Œç›´åˆ°æœ€åå½¢æˆä¸€ä¸ªæœ‰åºåºåˆ—\näºŒåˆ†æ’å…¥æ’åºæ€æƒ³(ä¹‹å‰çš„åºåˆ—ä¸ºæœ‰åº)ï¼šæ’å…¥ç¬¬iä¸ªå…ƒç´ æ—¶ï¼Œå¯¹å‰é¢çš„0~i-1è¿›è¡ŒæŠ˜åŠï¼Œå½“å‰å…ƒç´ ä¸ä¸­é—´å…ƒç´ æ¯”è¾ƒï¼Œå¦‚æœå°ï¼Œå‰åŠéƒ¨åˆ†å†æ¬¡æŠ˜åŠï¼Œå¦‚æœå¤§ï¼ŒååŠéƒ¨åˆ†è¿›è¡ŒæŠ˜åŠï¼Œç›´åˆ°æœ€åleft\u0026gt;right,ç„¶åæŠŠç›®æ ‡ä½ç½®åˆ°i-1çš„æ‰€æœ‰å…ƒç´ æ•´ä½“åç§»ï¼ŒæŠŠå½“å‰å…ƒç´ æ”¾è¿›å»\nåŸºæœ¬æŸ¥æ‰¾ç®—æ³•ï¼š\né¡ºåºæŸ¥æ‰¾\näºŒåˆ†æ³•æŸ¥æ‰¾(æŠ˜åŠæŸ¥æ‰¾)ï¼šå°†åºåˆ—åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œæ‰¾åˆ°åºåˆ—çš„ä¸­é—´å€¼ï¼Œå¦‚æœæŸ¥æ‰¾å€¼å¤§äºä¸­é—´å€¼ï¼Œç»§ç»­å¯¹å³åŠéƒ¨åˆ†è¿›è¡ŒæŠ˜åŠï¼Œå¦‚æœæŸ¥æ‰¾å€¼å°äºä¸­é—´å€¼ï¼Œå¯¹å·¦åŠéƒ¨åˆ†è¿›è¡ŒæŠ˜åŠï¼Œç›´åˆ°æ‰¾åˆ°æˆ–front\u0026gt;endç»“æŸï¼Œæ—¶é—´å¤æ‚åº¦O(log2n)ä»¥2ä¸ºåº•nçš„å¯¹æ•°\nè®¾è®¡æ¨¡å¼\nMVCæ˜¯ä¸€ç§è®¾è®¡æ¡†æ¶ï¼Œè€Œä¸æ˜¯è®¾è®¡æ¨¡å¼ï¼Œæ¡†æ¶æ˜¯æ¯”æ¨¡å¼æ›´é«˜çš„æ¦‚å¿µ\nmodelè´Ÿè´£æ•°æ®é€»è¾‘\ncontrollerè´Ÿè´£ç”¨æˆ·äº¤äº’\nviewè´Ÿè´£æ•°æ®æ˜¾ç¤ºæµç¨‹ï¼š\nç”¨æˆ·å¯¹æ§åˆ¶å™¨çš„æŸä¸ªæ–¹æ³•å‘å‡ºè¯·æ±‚ï¼Œæ§åˆ¶å™¨è°ƒç”¨ç›¸åº”çš„æ¨¡å‹è¿”å›æ•°æ®ï¼Œç„¶åå°†æ•°æ®æ¸²æŸ“åˆ°è§†å›¾ä¸­è¿”å›ç»™ç”¨æˆ·\nå•ä¾‹æ¨¡å¼i. ç§æœ‰åŒ–æ„é€ æ–¹æ³•å’Œ__cloneæ–¹æ³•ii. æä¾›å…¬æœ‰çš„é™æ€çš„æ–¹æ³•è¿”å›å®ä¾‹iii. æä¾›ç§æœ‰çš„é™æ€å±æ€§ä¿å­˜å®ä¾‹\nç®€å•å·¥å‚æ¨¡å¼(é‡ç‚¹åœ¨åˆ›å»ºä¸åŒå¯¹è±¡ï¼Œä½œç”¨å°±æ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„) - ä¾‹å¦‚ä¸€ä¸ªè®¡ç®—å™¨çš„åŠ å‡ä¹˜é™¤æ±‚ä½™å–æ•´i. å®šä¹‰æŠ½è±¡åŸºç±»è®©å­ç±»åˆ†åˆ«ç»§æ‰¿å¹¶å®ç°ç›¸åº”æ–¹æ³•ii. å®šä¹‰Factoryå·¥å‚ç±»é‡Œé¢æä¾›é™æ€æ–¹æ³•ç”¨äºæ ¹æ®ä¸åŒçš„å‚æ•°å®ä¾‹åŒ–ç›¸åº”çš„å­ç±»å¯¹è±¡\nç­–ç•¥æ¨¡å¼(é‡ç‚¹åœ¨äºå®ä¾‹åŒ–ä¸åŒç±»çš„è§£å†³ç­–ç•¥ä¸åŒï¼Œä½œç”¨æ˜¯æ ¹æ®ä¸åŒçš„æƒ…å†µè°ƒç”¨ç›¸åº”çš„ç­–ç•¥æˆ–ç®—æ³•) - ä¾‹å¦‚qqæ™®é€šç”¨æˆ· vip svipè´­ä¹°çš®è‚¤çš„ä¼˜æƒ ç­–ç•¥i. å®šä¹‰æŠ½è±¡åŸºç±»è®©å­ç±»åˆ†åˆ«ç»§æ‰¿å¹¶å®ç°ç›¸åº”çš„æ–¹æ³•ii. æ ¹æ®ä¸åŒçš„åœºæ™¯å®ä¾‹åŒ–ç›¸åº”çš„ç±»ï¼Œç„¶åè°ƒç”¨å…¶ä¸­çš„æ–¹æ³•è·å–ç»“æœ\nè§‚å¯Ÿè€…æ¨¡å¼\ni. éœ€è¦æœ‰ä¸€ä¸ªæŠ½è±¡çš„ä¸»é¢˜æ¥å£å’Œä¸€ä¸ªæŠ½è±¡çš„è§‚å¯Ÿè€…æ¥å£\nii. å®ç°ä¸€ä¸ªä¸»é¢˜ï¼Œå®ç°å¤šä¸ªè§‚å¯Ÿè€…","tags":null,"title":""},{"categories":null,"contents":"1. æ¯æ—¥ä¸€é¢ èš‚èšé‡‘æœä¸€é¢\nJava å®¹å™¨æœ‰å“ªäº›ï¼Œå“ªäº›æ˜¯åŒæ­¥å®¹å™¨ï¼Œå“ªäº›æ˜¯å¹¶å‘å®¹å™¨ ArrayList å’ŒLinkedList çš„æ’å…¥å’Œè®¿é—®çš„æ—¶é—´å¤æ‚åº¦ javaåå°„åŸç†ï¼Œ æ³¨è§£åŸç† æ–°ç”Ÿä»£åˆ†ä¸ºå‡ ä¸ªåŒºï¼Ÿä½¿ç”¨ä»€ä¹ˆç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨è¿™ä¸ªç®—æ³•ï¼Ÿ HashMapåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å›æ‰©å®¹ï¼Œæˆ–è€…æœ‰å“ªäº›æ“ä½œä¼šå¯¼è‡´æ‰©å®¹ï¼Ÿ HashMap putæ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ HashMapæ£€æµ‹åˆ°hashå†²çªåï¼Œå°†å…ƒç´ æ’å…¥åœ¨é“¾è¡¨çš„æœ«å°¾è¿˜æ˜¯å¼€å¤´ï¼Ÿ 1.8 è¿˜é‡‡ç”¨äº†çº¢é»‘æ ‘ï¼Œè®²è®²çº¢é»‘æ ‘çš„ç‰¹æ€§ï¼Œä¸ºä»€ä¹ˆäººå®¶ä¸€å®šè¦ç”¨çº¢é»‘æ˜¯è€Œä¸æ˜¯AVLï¼ŒBæ ‘ä¹‹ç±»çš„ï¼› https å’Œhttp çš„åŒºåˆ«ï¼Œæœ‰æ²¡æœ‰ç”¨è¿‡å…¶ä»–å®‰å…¨ä¼ è¾“æ‰‹æ®µï¼Ÿ çº¿ç¨‹æ± çš„å·¥ä½œåŸç†ï¼Œå‡ ä¸ªé‡è¦å‚æ•°ï¼Œç„¶åç»™äº†å…·ä½“å‡ ä¸ªå‚æ•°åˆ†æçº¿ç¨‹æ± ä¼šæ€ä¹ˆåšï¼Œæœ€åé—®é˜»å¡é˜Ÿåˆ—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ Linuxæ€ä¹ˆæŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½æƒ…å†µï¼Ÿ è¯·è¯¦ç»†æè¿°SpringMVNå¤„ç†è¯·æ±‚å…¨æµç¨‹ Spring ä¸€ä¸ªBean çš„è£…é…è¿‡ç¨‹ è®²ä¸€è®²AutomicInteger ä¸ºä»€ä¹ˆè¦ç”¨CASè€Œä¸æ˜¯synchronizedï¼Ÿ çº¿ç¨‹ä¼šå•ç‹¬æ‹·è´ä¸€ä»½æ•°æ®åˆ°è‡ªå·±çš„å·¥ä½œç©ºé—´ï¼Œåªæœ‰syncä»£ç å—è¢«æ‰§è¡Œå®Œæ‰ä¼šå°†æ•°æ®ä»å·¥ä½œå†…å­˜åˆ·åˆ°ä¸»å†…å­˜ï¼Œæ‰€ä»¥ï¼ŒæŒ‡ä»¤é‡æ’ä¸ºä»€ä¹ˆä¼šå¯¼è‡´å¤šçº¿ç¨‹æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œåº”è¯¥æ˜¯volatileçš„å†…å­˜å¯è§æ€§æ˜¯è§£å†³æ•°æ®ä¸ä¸€è‡´é—®é¢˜çš„åŸå› \n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/1st_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"1. æ¯æ—¥ä¸€é¢ èš‚èšé‡‘æœä¸€é¢\nJava å®¹å™¨æœ‰å“ªäº›ï¼Œå“ªäº›æ˜¯åŒæ­¥å®¹å™¨ï¼Œå“ªäº›æ˜¯å¹¶å‘å®¹å™¨ ArrayList å’ŒLinkedList çš„æ’å…¥å’Œè®¿é—®çš„æ—¶é—´å¤æ‚åº¦ javaåå°„åŸç†ï¼Œ æ³¨è§£åŸç† æ–°ç”Ÿä»£åˆ†ä¸ºå‡ ä¸ªåŒºï¼Ÿä½¿ç”¨ä»€ä¹ˆç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨è¿™ä¸ªç®—æ³•ï¼Ÿ HashMapåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å›æ‰©å®¹ï¼Œæˆ–è€…æœ‰å“ªäº›æ“ä½œä¼šå¯¼è‡´æ‰©å®¹ï¼Ÿ HashMap putæ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ HashMapæ£€æµ‹åˆ°hashå†²çªåï¼Œå°†å…ƒç´ æ’å…¥åœ¨é“¾è¡¨çš„æœ«å°¾è¿˜æ˜¯å¼€å¤´ï¼Ÿ 1.8 è¿˜é‡‡ç”¨äº†çº¢é»‘æ ‘ï¼Œè®²è®²çº¢é»‘æ ‘çš„ç‰¹æ€§ï¼Œä¸ºä»€ä¹ˆäººå®¶ä¸€å®šè¦ç”¨çº¢é»‘æ˜¯è€Œä¸æ˜¯AVLï¼ŒBæ ‘ä¹‹ç±»çš„ï¼› https å’Œhttp çš„åŒºåˆ«ï¼Œæœ‰æ²¡æœ‰ç”¨è¿‡å…¶ä»–å®‰å…¨ä¼ è¾“æ‰‹æ®µï¼Ÿ çº¿ç¨‹æ± çš„å·¥ä½œåŸç†ï¼Œå‡ ä¸ªé‡è¦å‚æ•°ï¼Œç„¶åç»™äº†å…·ä½“å‡ ä¸ªå‚æ•°åˆ†æçº¿ç¨‹æ± ä¼šæ€ä¹ˆåšï¼Œæœ€åé—®é˜»å¡é˜Ÿåˆ—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ Linuxæ€ä¹ˆæŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½æƒ…å†µï¼Ÿ è¯·è¯¦ç»†æè¿°SpringMVNå¤„ç†è¯·æ±‚å…¨æµç¨‹ Spring ä¸€ä¸ªBean çš„è£…é…è¿‡ç¨‹ è®²ä¸€è®²AutomicInteger ä¸ºä»€ä¹ˆè¦ç”¨CASè€Œä¸æ˜¯synchronizedï¼Ÿ çº¿ç¨‹ä¼šå•ç‹¬æ‹·è´ä¸€ä»½æ•°æ®åˆ°è‡ªå·±çš„å·¥ä½œç©ºé—´ï¼Œåªæœ‰syncä»£ç å—è¢«æ‰§è¡Œå®Œæ‰ä¼šå°†æ•°æ®ä»å·¥ä½œå†…å­˜åˆ·åˆ°ä¸»å†…å­˜ï¼Œæ‰€ä»¥ï¼ŒæŒ‡ä»¤é‡æ’ä¸ºä»€ä¹ˆä¼šå¯¼è‡´å¤šçº¿ç¨‹æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œåº”è¯¥æ˜¯volatileçš„å†…å­˜å¯è§æ€§æ˜¯è§£å†³æ•°æ®ä¸ä¸€è‡´é—®é¢˜çš„åŸå› ","tags":null,"title":""},{"categories":null,"contents":"2 æ¯æ—¥ä¸€é¢ ç¾å›¢ä¸€é¢\næœ€è¿‘åšçš„æ¯”è¾ƒç†Ÿæ‚‰çš„é¡¹ç›®æ˜¯å“ªä¸€ä¸ªï¼Œç”»ä¸€ä¸‹é¡¹ç›®æŠ€æœ¯æ¶æ„å›¾ JVMè€å¹´ä»£å’Œæ–°ç”Ÿä»£çš„æ¯”ä¾‹ YGCå’ŒFGCå‘ç”Ÿçš„å…·ä½“åœºæ™¯ jstackï¼Œjmapï¼Œjutilåˆ†åˆ«çš„æ„ä¹‰ï¼Ÿ å¦‚ä½•çº¿ä¸Šæ’æŸ¥JVMçš„ç›¸å…³é—®é¢˜ çº¿ç¨‹æ± çš„æ„é€ ç±»çš„æ–¹æ³•çš„5ä¸ªå‚æ•°çš„å…·ä½“æ„ä¹‰ï¼Ÿ å•æœºä¸Šä¸€ä¸ªçº¿ç¨‹æ± æ­£åœ¨å¤„ç†æœåŠ¡å¦‚æœçªç„¶æ–­ç”µæ€ä¹ˆåŠï¼ˆæ­£åœ¨å¤„ç†å’Œé˜»å¡åœ¨é˜Ÿåˆ—é‡Œçš„è¯·æ±‚æ€ä¹ˆå¤„ç†ï¼‰ï¼Ÿ ä½¿ç”¨æ— ç•Œé˜»å¡é˜Ÿåˆ—ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ æ¥å£å¦‚ä½•å¤„ç†é‡å¤è¯·æ±‚ï¼Ÿ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/2nd_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"2 æ¯æ—¥ä¸€é¢ ç¾å›¢ä¸€é¢\næœ€è¿‘åšçš„æ¯”è¾ƒç†Ÿæ‚‰çš„é¡¹ç›®æ˜¯å“ªä¸€ä¸ªï¼Œç”»ä¸€ä¸‹é¡¹ç›®æŠ€æœ¯æ¶æ„å›¾ JVMè€å¹´ä»£å’Œæ–°ç”Ÿä»£çš„æ¯”ä¾‹ YGCå’ŒFGCå‘ç”Ÿçš„å…·ä½“åœºæ™¯ jstackï¼Œjmapï¼Œjutilåˆ†åˆ«çš„æ„ä¹‰ï¼Ÿ å¦‚ä½•çº¿ä¸Šæ’æŸ¥JVMçš„ç›¸å…³é—®é¢˜ çº¿ç¨‹æ± çš„æ„é€ ç±»çš„æ–¹æ³•çš„5ä¸ªå‚æ•°çš„å…·ä½“æ„ä¹‰ï¼Ÿ å•æœºä¸Šä¸€ä¸ªçº¿ç¨‹æ± æ­£åœ¨å¤„ç†æœåŠ¡å¦‚æœçªç„¶æ–­ç”µæ€ä¹ˆåŠï¼ˆæ­£åœ¨å¤„ç†å’Œé˜»å¡åœ¨é˜Ÿåˆ—é‡Œçš„è¯·æ±‚æ€ä¹ˆå¤„ç†ï¼‰ï¼Ÿ ä½¿ç”¨æ— ç•Œé˜»å¡é˜Ÿåˆ—ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ æ¥å£å¦‚ä½•å¤„ç†é‡å¤è¯·æ±‚ï¼Ÿ ","tags":null,"title":""},{"categories":null,"contents":"3 æ¯æ—¥ä¸€é¢ ç™¾åº¦ä¸€é¢\nä»‹ç»ä¸€ä¸‹é›†åˆæ¡†æ¶ HashMap å’Œhashtable åº•å±‚å®ç°ä»€ä¹ˆåŒºåˆ«ï¼Ÿ HashTable å’ŒConcurrentHashTable åŒºåˆ«ï¼Ÿ HashMap å’ŒTreeMap ä»€ä¹ˆåŒºåˆ«ï¼Ÿåº•å±‚æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ Synchronized å’Œ Lock ä»€ä¹ˆåŒºåˆ«ï¼Ÿsynchronized ä»€ä¹ˆæƒ…å†µæ˜¯å¯¹è±¡é”ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯å…¨å±€é” ThreadLocal æ˜¯ä»€ä¹ˆï¼Ÿåº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå†™ä¸€ä¸ªä¾‹å­ volitileçš„å·¥ä½œåŸç† cas å¦‚ä½•å®ç°çš„ è‡³å°‘ç”¨å››ç§æ–¹æ³•å®ç°ä¸€ä¸ªå•ä¾‹æ¨¡å¼ è¯·ä»‹ç»ä¸€ä¸ªJVMçš„å†…å­˜æ¨¡å‹ï¼Ÿç”¨ä»€ä¹ˆæ ·çš„åƒåœ¾å›æ”¶å™¨ çº¿ä¸Šå‘é€é¢‘ç¹full GCå¦‚ä½•å¤„ç†ï¼ŸCPUä½¿ç”¨ç‡è¿‡é«˜æ€ä¹ˆåŠ å¦‚ä½•å®šä½é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Œè¯´ä¸€ä¸‹è§£å†³æ€è·¯å’Œå¤„ç†æ–¹æ³• çŸ¥é“å­—èŠ‚ç å—ï¼Ÿå­—èŠ‚ç éƒ½æœ‰å“ªäº›ï¼ŸInteger x=5ï¼›int y=5ï¼›æ¯”è¾ƒx=yéƒ½ç»è¿‡å“ªäº›æ­¥éª¤ï¼Ÿ è®²è®²ç±»åŠ è½½æœºåˆ¶ï¼Ÿæœ‰å“ªäº›ç±»åŠ è½½å™¨ï¼Œè¿™äº›ç±»åŠ è½½å™¨åŠ è½½å“ªäº›æ–‡ä»¶ï¼Ÿ æ‰‹å†™ç±»åŠ è½½Demo çŸ¥é“osgiå—ï¼Ÿä»–æ˜¯å¦‚ä½•å®ç°çš„ è¯·é—®ä½ åšè¿‡å“ªäº›JVMä¼˜åŒ–ï¼Ÿä½¿ç”¨ä»€ä¹ˆæ–¹æ³•è¾¾åˆ°ä»€ä¹ˆæ•ˆæœï¼Ÿ Class.forName(\u0026ldquo;java.lang.String\u0026rdquo;) å’ŒString.classGetClassLoader() LoadClass(\u0026ldquo;java.lang.String\u0026rdquo;) ä»€ä¹ˆåŒºåˆ« å››ç§åƒåœ¾å›æ”¶ç®—æ³•\nä¸ƒç§åƒåœ¾å›æ”¶å™¨\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/3rd_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"3 æ¯æ—¥ä¸€é¢ ç™¾åº¦ä¸€é¢\nä»‹ç»ä¸€ä¸‹é›†åˆæ¡†æ¶ HashMap å’Œhashtable åº•å±‚å®ç°ä»€ä¹ˆåŒºåˆ«ï¼Ÿ HashTable å’ŒConcurrentHashTable åŒºåˆ«ï¼Ÿ HashMap å’ŒTreeMap ä»€ä¹ˆåŒºåˆ«ï¼Ÿåº•å±‚æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ Synchronized å’Œ Lock ä»€ä¹ˆåŒºåˆ«ï¼Ÿsynchronized ä»€ä¹ˆæƒ…å†µæ˜¯å¯¹è±¡é”ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯å…¨å±€é” ThreadLocal æ˜¯ä»€ä¹ˆï¼Ÿåº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå†™ä¸€ä¸ªä¾‹å­ volitileçš„å·¥ä½œåŸç† cas å¦‚ä½•å®ç°çš„ è‡³å°‘ç”¨å››ç§æ–¹æ³•å®ç°ä¸€ä¸ªå•ä¾‹æ¨¡å¼ è¯·ä»‹ç»ä¸€ä¸ªJVMçš„å†…å­˜æ¨¡å‹ï¼Ÿç”¨ä»€ä¹ˆæ ·çš„åƒåœ¾å›æ”¶å™¨ çº¿ä¸Šå‘é€é¢‘ç¹full GCå¦‚ä½•å¤„ç†ï¼ŸCPUä½¿ç”¨ç‡è¿‡é«˜æ€ä¹ˆåŠ å¦‚ä½•å®šä½é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Œè¯´ä¸€ä¸‹è§£å†³æ€è·¯å’Œå¤„ç†æ–¹æ³• çŸ¥é“å­—èŠ‚ç å—ï¼Ÿå­—èŠ‚ç éƒ½æœ‰å“ªäº›ï¼ŸInteger x=5ï¼›int y=5ï¼›æ¯”è¾ƒx=yéƒ½ç»è¿‡å“ªäº›æ­¥éª¤ï¼Ÿ è®²è®²ç±»åŠ è½½æœºåˆ¶ï¼Ÿæœ‰å“ªäº›ç±»åŠ è½½å™¨ï¼Œè¿™äº›ç±»åŠ è½½å™¨åŠ è½½å“ªäº›æ–‡ä»¶ï¼Ÿ æ‰‹å†™ç±»åŠ è½½Demo çŸ¥é“osgiå—ï¼Ÿä»–æ˜¯å¦‚ä½•å®ç°çš„ è¯·é—®ä½ åšè¿‡å“ªäº›JVMä¼˜åŒ–ï¼Ÿä½¿ç”¨ä»€ä¹ˆæ–¹æ³•è¾¾åˆ°ä»€ä¹ˆæ•ˆæœï¼Ÿ Class.forName(\u0026ldquo;java.lang.String\u0026rdquo;) å’ŒString.classGetClassLoader() LoadClass(\u0026ldquo;java.lang.String\u0026rdquo;) ä»€ä¹ˆåŒºåˆ« å››ç§åƒåœ¾å›æ”¶ç®—æ³•\nä¸ƒç§åƒåœ¾å›æ”¶å™¨","tags":null,"title":""},{"categories":null,"contents":"4.æ¯æ—¥ä¸€é¢ æºç¨‹é¢è¯•\né—®é¡¹ç›®ï¼Œ æ³¨æ„é¡¹ç›®ç»†èŠ‚\nNetty\nBIO åŒæ­¥é˜»å¡IOï¼Œä¸€ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªè¿æ¥\nNIO åŒæ­¥éé˜»å¡IO ï¼Œä¸€ä¸ªçº¿ç¨‹æœ‰å¤šä¸ªè¿æ¥ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸­æœ‰å¾ˆå¤šChannelï¼Œé€šè¿‡selector é€‰æ‹©çº¿ç¨‹\nAIO å¼‚æ­¥éé˜»å¡IO\nåŒé‡æ£€éªŒå•ä¾‹\n1public class Singleton{ 2 private volatile static Singleton singleton; 3 private Singleton(){ 4 5 } 6 public Singleton getSingleton(){ 7 if(singleton == null){ 8 synchronized(Singleton.class){ 9 if(singleton == null){ 10 singleton = new Singleton(); 11 } 12 } 13 } 14 return singleton; 15 } 16} http1.1 é•¿è¿æ¥ï¼Œ å¿ƒè·³åŒ…ï¼Œ http2 http3\nHTTP 1.1 æ”¯æŒé•¿è¿æ¥(PersistentConnection)å’Œè¯·æ±‚çš„æµæ°´çº¿(Pipelining)å¤„ç†,åœ¨ä¸€ä¸ªTCPè¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ªHTTPè¯·æ±‚ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿã€‚åœ¨HTTP1.1ä¸­é»˜è®¤å¼€å¯Connectionï¼škeep-aliveï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†HTTP 1.0 æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚\nåœ¨header ä¸­è®¾ç½®connection = keep-aliveï¼Œkeep-aliveï¼štimeout = 60ï¼›\nHTTP 2.0 å¤šè·¯å¤ç”¨ å¤šä¸ªè¯·æ±‚å¯ä»¥åœ¨åŒä¸€ä¸ªè¿æ¥ä¸Šå¹¶è¡Œæ‰§è¡Œã€‚\nçº¿ç¨‹æ± ï¼Œå‚æ•°åˆ—è¡¨ï¼Œé˜»å¡é˜Ÿåˆ—çš„é»˜è®¤å€¼\nåƒåœ¾å›æ”¶ G1ï¼Œå®é™…é¡¹ç›®ä¸­æ€ä¹ˆä¼˜åŒ–\nhttps://www.cnblogs.com/diegodu/p/9849611.html\nå¹´è½»ä»£å¤§å°é€‰æ‹©\nå“åº”æ—¶é—´ä¼˜å…ˆçš„åº”ç”¨ï¼šå°½å¯èƒ½è®¾å¤§ï¼Œç›´åˆ°æ¥è¿‘ç³»ç»Ÿçš„æœ€ä½å“åº”æ—¶é—´é™åˆ¶ï¼ˆæ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ï¼‰ã€‚åœ¨æ­¤ç§æƒ…å†µä¸‹ï¼Œå¹´è½»ä»£æ”¶é›†å‘ç”Ÿçš„é¢‘ç‡ä¹Ÿæ˜¯æœ€å°çš„ã€‚åŒæ—¶ï¼Œå‡å°‘åˆ°è¾¾å¹´è€ä»£çš„å¯¹è±¡ã€‚ ååé‡ä¼˜å…ˆçš„åº”ç”¨ï¼šå°½å¯èƒ½çš„è®¾ç½®å¤§ï¼Œå¯èƒ½åˆ°è¾¾Gbitçš„ç¨‹åº¦ã€‚å› ä¸ºå¯¹å“åº”æ—¶é—´æ²¡æœ‰è¦æ±‚ï¼Œåƒåœ¾æ”¶é›†å¯ä»¥å¹¶è¡Œè¿›è¡Œï¼Œä¸€èˆ¬é€‚åˆ8CPUä»¥ä¸Šçš„åº”ç”¨ã€‚ 1000ä¸‡æ¡æ•°æ®ä¸­é€‰å–æœ€å°çš„100ä¸ªï¼Œåˆ†ææ¯ä¸€æ­¥çš„æ—¶é—´å¤æ‚åº¦ï¼Œé™¤äº†å †è¿˜æœ‰ä»€ä¹ˆæ–¹æ³•\nè®¾è®¡ç´¢å¼•\nå¤šçº¿ç¨‹é™æµ\nè®¾è®¡æ¨¡å¼åœ¨å·¥ä½œä¸­çš„ä½¿ç”¨ï¼ŸredisåŸç†ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶åŸç†ï¼Œjvmè°ƒä¼˜ï¼Œç±»åŠ è½½æœºåˆ¶ï¼Œspringï¼ŒmybatisåŸç†ï¼Œé’ˆå¯¹é¢è¯•å®˜é—®çš„è¿™äº›å†…å®¹ï¼Œè¿™åç½‘å‹è®¤ä¸ºè¿™äº›é—®é¢˜ä¸å¤ªå®ç”¨ï¼Œå·¥ä½œä¸­éƒ½æ˜¯æ‰¾è½®å­è°ƒapiï¼Œå†™ä¸šåŠ¡é€»è¾‘ä»£ç \n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/4th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"4.æ¯æ—¥ä¸€é¢ æºç¨‹é¢è¯•\né—®é¡¹ç›®ï¼Œ æ³¨æ„é¡¹ç›®ç»†èŠ‚\nNetty\nBIO åŒæ­¥é˜»å¡IOï¼Œä¸€ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªè¿æ¥\nNIO åŒæ­¥éé˜»å¡IO ï¼Œä¸€ä¸ªçº¿ç¨‹æœ‰å¤šä¸ªè¿æ¥ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸­æœ‰å¾ˆå¤šChannelï¼Œé€šè¿‡selector é€‰æ‹©çº¿ç¨‹\nAIO å¼‚æ­¥éé˜»å¡IO\nåŒé‡æ£€éªŒå•ä¾‹\n1public class Singleton{ 2 private volatile static Singleton singleton; 3 private Singleton(){ 4 5 } 6 public Singleton getSingleton(){ 7 if(singleton == null){ 8 synchronized(Singleton.class){ 9 if(singleton == null){ 10 singleton = new Singleton(); 11 } 12 } 13 } 14 return singleton; 15 } 16} http1.1 é•¿è¿æ¥ï¼Œ å¿ƒè·³åŒ…ï¼Œ http2 http3\nHTTP 1.1 æ”¯æŒé•¿è¿æ¥(PersistentConnection)å’Œè¯·æ±‚çš„æµæ°´çº¿(Pipelining)å¤„ç†,åœ¨ä¸€ä¸ªTCPè¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ªHTTPè¯·æ±‚ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿã€‚åœ¨HTTP1.1ä¸­é»˜è®¤å¼€å¯Connectionï¼škeep-aliveï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†HTTP 1.0 æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚","tags":null,"title":""},{"categories":null,"contents":"5 æ¯æ—¥ä¸€é¢ ä»Šæ—¥å¤´æ¡\nHashMapå¦‚æœä¸€ç›´putå…ƒç´ ä¼šæ€ä¹ˆæ ·ï¼ŸhashCodeå…¨éƒ½ç›¸åŒå¦‚ä½•ï¼Ÿ é‡å†™equalsæ—¶å€™ä¸ºä»€ä¹ˆè¦é‡å†™hashæ–¹æ³• ApplicationContext çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Ÿåˆå§‹åŒ–è¿‡ç¨‹å‘ç°å¾ªç¯ä¾èµ–Spring æ˜¯å¦‚ä½•å¤„ç† GCç”¨ä»€ä¹ˆæ”¶é›†å™¨ï¼Ÿæ”¶é›†è¿‡ç¨‹å¦‚ä½•ï¼Ÿå“ªäº›éƒ¨åˆ†å¯ä»¥ä½œä¸ºGC Rootï¼Ÿ Volatileå…³é”®å­—ï¼ŒæŒ‡ä»¤é‡æ’åºæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿsynchronizeæ€ä¹ˆç”¨ï¼Ÿ å¹¶å‘åŒ…é‡Œçš„åŸå­ç±»æœ‰å“ªäº›ï¼Œæ€ä¹ˆå®ç°ï¼Ÿcasåœ¨cpuçº§åˆ«æ˜¯æ€ä¹ˆå®ç°çš„ Redisæ•°æ®ç»“æ„æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å®ç°Sorted setï¼Ÿè¿™ç§æ•°æ®ç»“æ„åœ¨æç«¯æƒ…å†µä¸‹ ç³»ç»Ÿè®¾è®¡é¢˜ï¼šä¸€ä¸ªæ¨é€åœºæ™¯ã€‚50æ¡å†…å®¹ï¼Œå®šæ—¶æ¨é€ï¼Œå…ˆæ¨5%ç”¨æˆ·ï¼Œâ€¦â€¦è®¾è®¡ç›¸å…³åº“è¡¨ï¼Œç³»ç»Ÿæ¨¡å— MySQLç´¢å¼•æ˜¯ä»€ä¹ˆæ•°æ®ç»“æ„ï¼ŸB-Treeæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿæœ‰ç‚¹æ˜¯ä»€ä¹ˆ æ…¢æŸ¥è¯¢æ€ä¹ˆä¼˜åŒ– é¡¹ç›® cache å„éƒ¨åˆ†èŒè´£ï¼Œæœ‰å“ªäº›ä¼˜ç‚¹ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/5th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"5 æ¯æ—¥ä¸€é¢ ä»Šæ—¥å¤´æ¡\nHashMapå¦‚æœä¸€ç›´putå…ƒç´ ä¼šæ€ä¹ˆæ ·ï¼ŸhashCodeå…¨éƒ½ç›¸åŒå¦‚ä½•ï¼Ÿ é‡å†™equalsæ—¶å€™ä¸ºä»€ä¹ˆè¦é‡å†™hashæ–¹æ³• ApplicationContext çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Ÿåˆå§‹åŒ–è¿‡ç¨‹å‘ç°å¾ªç¯ä¾èµ–Spring æ˜¯å¦‚ä½•å¤„ç† GCç”¨ä»€ä¹ˆæ”¶é›†å™¨ï¼Ÿæ”¶é›†è¿‡ç¨‹å¦‚ä½•ï¼Ÿå“ªäº›éƒ¨åˆ†å¯ä»¥ä½œä¸ºGC Rootï¼Ÿ Volatileå…³é”®å­—ï¼ŒæŒ‡ä»¤é‡æ’åºæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿsynchronizeæ€ä¹ˆç”¨ï¼Ÿ å¹¶å‘åŒ…é‡Œçš„åŸå­ç±»æœ‰å“ªäº›ï¼Œæ€ä¹ˆå®ç°ï¼Ÿcasåœ¨cpuçº§åˆ«æ˜¯æ€ä¹ˆå®ç°çš„ Redisæ•°æ®ç»“æ„æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å®ç°Sorted setï¼Ÿè¿™ç§æ•°æ®ç»“æ„åœ¨æç«¯æƒ…å†µä¸‹ ç³»ç»Ÿè®¾è®¡é¢˜ï¼šä¸€ä¸ªæ¨é€åœºæ™¯ã€‚50æ¡å†…å®¹ï¼Œå®šæ—¶æ¨é€ï¼Œå…ˆæ¨5%ç”¨æˆ·ï¼Œâ€¦â€¦è®¾è®¡ç›¸å…³åº“è¡¨ï¼Œç³»ç»Ÿæ¨¡å— MySQLç´¢å¼•æ˜¯ä»€ä¹ˆæ•°æ®ç»“æ„ï¼ŸB-Treeæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿæœ‰ç‚¹æ˜¯ä»€ä¹ˆ æ…¢æŸ¥è¯¢æ€ä¹ˆä¼˜åŒ– é¡¹ç›® cache å„éƒ¨åˆ†èŒè´£ï¼Œæœ‰å“ªäº›ä¼˜ç‚¹ ","tags":null,"title":""},{"categories":null,"contents":"6 æ¯æ—¥ä¸€é¢ Dubboè¶…æ—¶é‡è¯•ï¼ŸDubboè¶…æ—¶æ—¶é—´è®¾ç½® å¦‚ä½•ä¿éšœè¯·æ±‚é¡ºåºæ‰§è¡Œ åˆ†å¸ƒå¼äº‹åŠ¡ä¸åˆ†å¸ƒå¼é”ï¼ˆæ‰£æ¬¾ä¸è¦å‡ºç°è´Ÿæ•°ï¼‰ åˆ†å¸ƒå¼sessionè®¾ç½® æ‰§è¡ŒæŸæ“ä½œï¼Œå‰50æ¬¡æˆåŠŸï¼Œç¬¬51æ¬¡å¤±è´¥ï¼Œaå…¨éƒ¨å›æ»šï¼Œbå‰50æ¬¡æäº¤ç¬¬51æ¬¡æŠ›å¼‚å¸¸ï¼Œa båœºæ™¯åˆ†åˆ«å¦‚ä½•è®¾ç½®Springï¼Ÿï¼ˆä¼ æ’­ç‰¹æ€§ï¼‰ Zookeeperæœ‰å“ªäº›ä½œç”¨ JVMå†…å­˜æ¨¡å‹ æ•°æ®åº“å‚ç›´å’Œæ°´å¹³æ‹†åˆ† MyBatiså¦‚ä½•åˆ†é¡µï¼›å¦‚ä½•è®¾ç½®ç¼“å­˜;MySqlåˆ†é¡µ ç†Ÿæ‚‰IOå—ï¼Ÿä¸NIOçš„åŒºåˆ«ï¼Œé˜»å¡å’Œéé˜»å¡ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/6th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"6 æ¯æ—¥ä¸€é¢ Dubboè¶…æ—¶é‡è¯•ï¼ŸDubboè¶…æ—¶æ—¶é—´è®¾ç½® å¦‚ä½•ä¿éšœè¯·æ±‚é¡ºåºæ‰§è¡Œ åˆ†å¸ƒå¼äº‹åŠ¡ä¸åˆ†å¸ƒå¼é”ï¼ˆæ‰£æ¬¾ä¸è¦å‡ºç°è´Ÿæ•°ï¼‰ åˆ†å¸ƒå¼sessionè®¾ç½® æ‰§è¡ŒæŸæ“ä½œï¼Œå‰50æ¬¡æˆåŠŸï¼Œç¬¬51æ¬¡å¤±è´¥ï¼Œaå…¨éƒ¨å›æ»šï¼Œbå‰50æ¬¡æäº¤ç¬¬51æ¬¡æŠ›å¼‚å¸¸ï¼Œa båœºæ™¯åˆ†åˆ«å¦‚ä½•è®¾ç½®Springï¼Ÿï¼ˆä¼ æ’­ç‰¹æ€§ï¼‰ Zookeeperæœ‰å“ªäº›ä½œç”¨ JVMå†…å­˜æ¨¡å‹ æ•°æ®åº“å‚ç›´å’Œæ°´å¹³æ‹†åˆ† MyBatiså¦‚ä½•åˆ†é¡µï¼›å¦‚ä½•è®¾ç½®ç¼“å­˜;MySqlåˆ†é¡µ ç†Ÿæ‚‰IOå—ï¼Ÿä¸NIOçš„åŒºåˆ«ï¼Œé˜»å¡å’Œéé˜»å¡ ","tags":null,"title":""},{"categories":null,"contents":"7 æ¯æ—¥ä¸€é¢ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/7th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"7 æ¯æ—¥ä¸€é¢ ","tags":null,"title":""},{"categories":null,"contents":"8 æ¯æ—¥ä¸€é¢ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/8th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"8 æ¯æ—¥ä¸€é¢ ","tags":null,"title":""},{"categories":null,"contents":"9 æ¯ä¸€æ—¥é¢ å­—èŠ‚è·³åŠ¨\nå¾ˆè£å¹¸å­—èŠ‚è·³åŠ¨ä¸€è·¯èµ°åˆ°äº†å››é¢ï¼Œä¸ç®¡æ˜¯è¿æ°”è¿˜æ˜¯å®åŠ›ï¼Œéƒ½å¥½å¥½å‡†å¤‡æ¥ä¸‹æ¥çš„é¢è¯•å§ï¼ŒåŠ æ²¹\nç¼–ç¨‹ åˆ¤æ–­å­—ç¬¦ä¸²Bæ˜¯å¦æ˜¯å­—ç¬¦ä¸²Açš„å­ä¸² æ•°æ®ç»“æ„ä¸­çš„æ¡¶æ’åºã€å¹³è¡¡äºŒå‰æ ‘ .æ‰‹æ’•ä»£ç ï¼šæœºå™¨äººè·³è·ƒ(ç‰›å®¢åŸé¢˜ï¼‰ æ‰‹æ’•ä»£ç ï¼šé€†æ—¶é’ˆæ‰“å°çŸ©é˜µï¼ˆå‰‘æŒ‡offeræ”¹ï¼‰ åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼Œç©ºé—´å¤æ‚åº¦O(1)ï¼› DPæœ€é•¿å›æ–‡ä¸²ï¼› ç»™ä¸¤ä¸ª1Tçš„æ–‡ä»¶åœ¨2g ramçš„å†…å­˜ä¸­æ‰¾å‡ºç›¸åŒé¡¹ã€‚ ç»™ä¸€ä¸ªæœ‰å‘å›¾ï¼Œåˆ¤æ–­æœ‰å‘å›¾ä¸­æ˜¯å¦æœ‰ç¯ï¼Œå¦‚æœæœ‰ç¯ï¼Œç¯çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ ç»™ä¸€ä¸ªå¤§å°ä¸ºnçš„æ•°ç»„ï¼Œå¯»æ‰¾æ¯”kå°çš„æœ€å¤§æ•°çš„ä½ç½®ã€‚ 1.æœ€é•¿å›æ–‡å­ä¸² åœ°å›¾ä¸Šæœ‰è‹¥å¹²ä¸ªç‚¹ï¼Œæ€æ ·å¾—åˆ°æŸä¸ªç‚¹åˆ°è¾¾æŸä¸ªç‚¹çš„æ‰€æœ‰çš„æ¢ä¹˜è·¯çº¿ ï¼Ÿ æ˜¯å¦æ˜¯è”é€šï¼Œå¦‚æœä¸è¿é€šæ€ä¹ˆå¤„ç† ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å½“ä¸­æ˜¯ä¸€æ®µcè¯­è¨€çš„ä»£ç å’Œæ³¨é‡Šï¼Œæ³¨é‡Šåªæœ‰/** /è¿™æ ·çš„å¯ä»¥åµŒå¥—ï¼Œä¸åŒ…å«// è¯·è¿”å›å»é™¤æ‰€æœ‰æ³¨é‡Šçš„ä»£ç  å¦‚æœä»£ç å½“ä¸­çš„/*å’Œ/*å¯ä»¥ä¸å®Œå…¨åŒ¹é…å¦‚ä½•å‘ŠçŸ¥å‡ºç°é”™è¯¯ å†™äº†ä¸€ä¸ªç¨‹åºï¼Œæœ‰ä¸ªå°çƒï¼Œçƒä» 100 ç±³é«˜åº¦è‡ªç”±è½ä¸‹ï¼Œæ¯æ¬¡è½åœ°ååè·³å›åŸé«˜åº¦çš„ä¸€åŠï¼›å†è½ä¸‹ï¼Œæ±‚å®ƒåœ¨ç¬¬10 æ¬¡è½åœ°æ—¶ï¼Œå…±ç»è¿‡å¤šå°‘ç±³ï¼Ÿç¬¬ 10 æ¬¡åå¼¹å¤šé«˜ï¼Ÿ å†™ä»£ç ï¼šç«è½¦å”®ç¥¨ç³»ç»Ÿæ˜¯æ—©7ç‚¹-æ™š23ç‚¹è¿›è¡Œç½‘ä¸Šå”®ç¥¨ï¼Œå†™ä¸€ä¸ªç¨‹åºåˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›è¡Œç½‘ä¸Šä¹°ç¥¨ è®²ä¸€ä¸‹äºŒå‰æœç´¢æ ‘ï¼Œå†™èŠ‚ç‚¹çš„åˆ é™¤ä»£ç  æœ€å¤§è¿ç»­å­åºåˆ—å’Œ ä»£ç ï¼šå®ç°lruï¼Œä¸ä¼šå“¦ä¸´æ—¶æƒ³äº†ä¸€ç§lgnçš„å®ç°ï¼Œé¢è¯•å®˜ä¸æ»¡æ„ å†™ä¸€ä¸ªæœ€å°å †å»ºå †ï¼Œåˆ†æå¤æ‚åº¦ å¤šä¸ªä¸²ï¼Œå°†å«æœ‰ç›¸åŒå­—æ¯çš„ä¸²æ”¾åˆ°åŒä¸€ä¸ªé›†åˆï¼Œè¿”å›é›†åˆå‘é‡ è®²æ€è·¯ ç¼–ç¨‹ï¼š36è¿›åˆ¶åŠ æ³•ï¼ˆå¿˜è®°å¤„ç†æœ€é«˜ä½çš„è¿›ä½ï¼Œé¢è¯•å®˜æé†’äº†ä¸€ä¸‹ï¼‰ åœ¨ä¸€äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºæœ€å¤§çš„10ä¸ªæ•°ï¼Œåœ¨ä¸€äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºä¸­é—´çš„10ä¸ªæ•° ç¼–ç¨‹ï¼šå°†0-nçš„æ•´æ•°æ”¾åˆ°ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ä¸­ï¼Œæ‰¾å‡ºç¼ºå¤±çš„é‚£ä¸ªæ•° ç¼–ç¨‹ï¼š36è¿›åˆ¶åŠ æ³•ï¼ˆåˆæ¥ï¼Ÿï¼‰ é¢˜ç›®ï¼šnæ¡ç›´çº¿å¯ä»¥å°†ç©ºé—´åˆ’åˆ†ä¸ºå¤šå°‘ä¸ªåŒºåŸŸ é¢è¯•é¢˜ TCP å’ŒUDP\nè¿›ç¨‹å’Œçº¿ç¨‹\nè®¾è®¡æ¨¡å¼\nMySQLç´¢å¼•çš„æ•°æ®ç»“æ„\nè¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\nè®¾è®¡ä¸€ä¸ªå­˜å‚¨æµ·é‡è¯„è®ºçš„ç»“æ„ï¼Œè¦æ±‚å¤§é‡æ•°æ®çš„å†™å…¥ï¼Œå¯ä»¥éšæ„ç¿»é¡µï¼Ÿ\nç†Ÿæ‚‰è®¡ç®—æœºå’Œç½‘ç»œåŸç†ï¼Œç†Ÿæ‚‰æ“ä½œç³»ç»ŸåŸç†ï¼Œå¯¹å­˜å‚¨ã€é˜Ÿåˆ—ã€è®¡ç®—ã€é›†ç¾¤ç®¡ç†ä¸­çš„ä¸€é¡¹æˆ–å¤šé¡¹æœ‰æ·±å…¥çš„ç†è§£å’Œè®¤è¯†ï¼›\nå¸¸ç”¨çš„æ’åºç®—æ³•çš„å¤æ‚åº¦ï¼Œå†™å¿«æ’ï¼›\nJavaçš„JVMçš„å†…å­˜å¸ƒå±€ï¼Œåƒåœ¾å›æ”¶çš„å®ç°ï¼Œå›æ”¶å™¨åˆ†å‡ éƒ¨åˆ†ï¼Œéƒ½æœ‰ä»€ä¹ˆä½œç”¨ï¼›\né¡¹ç›®å¤§ä½“é˜è¿°ä¸‹ï¼Œç”¨äº†å“ªäº›æŠ€æœ¯ã€è®¾è®¡æ¨¡å¼ï¼Œæœ€å¤§çš„æ„Ÿå—æ˜¯ä»€ä¹ˆï¼›ååˆ†é’Ÿå®ç°ç”¨è¿‡çš„è§‚å¯Ÿè€…æ¨¡å¼ã€å·¥å‚æ¨¡å¼ï¼›\nTCPå››æ¬¡æŒ¥æ‰‹è®²ä¸‹ï¼Ÿä¸ºä»€ä¹ˆæœ‰TIME_WAITï¼Ÿ TCPæ¯”UDPå¤šæ¶ˆè€—å“ªäº›ç³»ç»Ÿèµ„æºï¼Ÿ\nA(FIN_WAIT_1) -\u0026gt; B(CLOSE_WAIT) FIN=1,seq = u\nA(FIN_WAIT_2)\u0026lt;-B ACK=1, seq=v,ack=u+1;\nA \u0026lt;-B(LAST_ACK) FIN=1,seq = w,ack=u+1;\nA(TIME_WAIT) ACK=1 ,seq=u+1,ack=w+1;\nTIME_WAIT é˜¶æ®µ\nè¦ç¡®å®šä¸»åŠ¨æ–­å¼€è¿æ¥çš„ä¸€ç«¯çš„ACKä¿¡æ¯æˆåŠŸå‘é€åˆ°å¯¹æ–¹\nå¦‚æœæœ‰å¾ˆå¤šçš„CLOSE_WAIT æ˜¯å› ä¸ºä»€ä¹ˆåŸå› \nè¢«åŠ¨è¦æ±‚å…³é—­çš„æœºå™¨æ”¶åˆ°å¯¹æ–¹å…³é—­è¿æ¥çš„FINæŠ¥æ–‡ï¼Œåœ¨ç¬¬ä¸€æ¬¡ACKåº”ç­”åé©¬ä¸Šè¿›å…¥CLOSE_WAITçŠ¶æ€ã€‚ è¿™ç§çŠ¶æ€å…¶å®æ˜¯åœ¨ç­‰å¾…å…³é—­ï¼Œå¹¶ä¸”é€šçŸ¥åº”ç”¨ç¨‹åºå‘é€å‰©ä½™æ•°æ®ï¼Œå¤„ç†ç°åœºä¿¡æ¯ï¼Œå…³é—­ç›¸å…³èµ„æºã€‚ å¤šè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢è®²ä¸‹ï¼Ÿ\nè®²ä¸€ä¸‹åŒæ­¥ï¼Œå¼‚æ­¥ï¼Œé˜»å¡ï¼Œéé˜»å¡ï¼Œå¤šè·¯IOå¤ç”¨ï¼Ÿ\nè®²ä¸‹epollå’Œselectçš„åŒºåˆ«ï¼Ÿ\nepollè·Ÿselectéƒ½èƒ½æä¾›å¤šè·¯I/Oå¤ç”¨çš„è§£å†³æ–¹æ¡ˆ\nepollçš„è§¦å‘æ–¹å¼ æ°´å¹³è§¦å‘å’Œè¾¹æ²¿è§¦å‘è¯´ä¸€è¯´\nhttpå¤ç”¨è¿æ¥ å¦‚ä½•åŒºåˆ†è¯·æ±‚ï¼Ÿ\ntcpçš„é‡æ’åºçš„ç»†èŠ‚æ˜¯ä»€ä¹ˆ å¦‚æœä¼ è¾“çš„æ•°æ®å¾ˆå¤§æ˜¯å¦‚ä½•é‡æ’åºçš„\n.tcpæ˜¯å¦‚ä½•ä¿è¯ç¨³å®šä¼ è¾“çš„\nç»™ä½ ä¸€ä¸ª2Gçš„ç”µè„‘ 10Gçš„æ–‡æœ¬ æ–‡æœ¬æœ‰1kè¡Œçš„å­—ç¬¦ä¸²ï¼Œè¦æ±‚è¾“å‡ºæ‰€æœ‰äº’ä¸ºé€†åºçš„å­—ç¬¦ä¸²çš„ç»„åˆ\u0026ndash;å“ˆå¸Œ\nä¸Šä¸‹æ–‡åˆ‡æ¢çš„å…¨è¿‡ç¨‹è®²äº†ååˆ†é’Ÿ mysqlå¼•æ“ï¼Œäº‹åŠ¡ï¼Œéš”ç¦»çº§åˆ«ï¼Œç´¢å¼•çš„å®ç°ï¼Œä¸åŒå¼•æ“ç´¢å¼•çš„åŒºåˆ«ï¼Œå‰©ä¸‹çš„æ•°æ®åº“é—®é¢˜çš„åè¯æ²¡å¬è¯´è¿‡ï¼Œä¸ä¼šå“¦\ni++æ˜¯å¦åŸå­æ“ä½œï¼Œé”çš„åº•å±‚å®ç°è®²äº†ååˆ†é’Ÿ\niocæ˜¯æ€æ ·å®ç°çš„\naopå®ç°æ—¥å¿—ä¹‹ç±»çš„åŠŸèƒ½åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ ·çš„æŠ€æœ¯ï¼ˆæˆ‘æ²¡å¤ªæ˜ç™½ï¼Œç†è§£ä¸ºè®¾è®¡æ¨¡å¼ï¼‰\næ€ä¹ˆå®ç°ThreadLocal\nCASï¼Œæ˜¯åŸå­æ“ä½œå—ï¼Œé—®æˆ‘å¦‚æœæ¯”è¾ƒä¹‹åç›¸ç­‰ï¼Œå‡†å¤‡å†™çš„æ—¶å€™è¢«æ”¹äº†æ€ä¹ˆåŠï¼ˆæˆ‘è¯´å¥½åƒç¡®å®å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œåæ¥æŸ¥äº†ä¸€ä¸‹åº•å±‚å¯ä»¥ä¿è¯åŸå­æ€§ï¼‰\né€»è¾‘åœ°å€\u0026mdash;ï¼ˆåˆ†æ®µç¡¬ä»¶ï¼‰\u0026raquo;\u0026gt; çº¿å‹åœ°å€ \u0026mdash; ï¼ˆåˆ†é¡µç¡¬ä»¶)\u0026raquo;\u0026gt; ç‰©ç†åœ°å€ çš„è¿‡ç¨‹ï¼Œè™šæ‹Ÿå†…å­˜çš„å®ç°\nTIME_WAITçŠ¶æ€\njavaä¸­çš„åƒåœ¾å›æ”¶ç­–ç•¥\næ€ä¹ˆè§£å†³å†…å­˜ç¢ç‰‡é—®é¢˜\nä¸ºä»€ä¹ˆä»¥4å¼€å¤´çš„httpçŠ¶æ€ç æ˜¯å®¢æˆ·ç«¯çš„é—®é¢˜ï¼Œä»¥5å¼€å¤´çš„æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ\nLeetCode 76.\nä½œè€…ï¼šDerekDeng https://www.nowcoder.com/discuss/217361æ¥æºï¼šç‰›å®¢ç½‘\nç³»ç»Ÿæ”¶åˆ°ç½‘ç»œæ•°æ®äº¤ä»˜ç»™åº”ç”¨ç¨‹åºçš„æ•´ä¸ªè¿‡ç¨‹ï¼ˆä»ç½‘å¡è¯´èµ·ï¼Œé¢è¯•å®˜è¯´æˆ‘å¯¹åº•å±‚äº†è§£çš„æŒºæ·±ï¼‰\nUDPå‘é€100ä¸ªå­—èŠ‚ï¼Œå¯¹æ–¹çš„åº”ç”¨ç¨‹åºåªrecväº†90ä¸ªå­—èŠ‚ï¼Œå‰©ä¸‹çš„10ä¸ªå­—èŠ‚æ€ä¹ˆå¤„ç†ï¼ˆæ²¡å¤ªæ˜ç™½æ­£å¸¸æƒ…å†µä¸‹ä¸ºä»€ä¹ˆä¼šå‰©10ä¸ªå­—èŠ‚ï¼Œè·Ÿé¢è¯•å®˜è®¨è®ºäº†åŠå¤©ï¼Œä»–è¯´è¿™ä¸ªé—®é¢˜å¤ªåˆé’»å°±è¿‡äº†ï¼‰\nTCPçš„ä¼ è¾“é€Ÿç‡å—ä»€ä¹ˆå½±å“ï¼ˆå…ˆæ‰¯äº†ç¡¬ä»¶ï¼Œå†æ‰¯äº†Nagleç®—æ³•ï¼Œé¢è¯•å®˜è¯´çŸ¥é“è¿™ä¸ªä¸é”™ï¼Œæœ€åæ‰¯æ•°æ®åˆ†ç‰‡ï¼Œé¢è¯•å®˜è¯´è¿™ä¸ªæ²¡å…³ç³»å°±è¿‡äº†ï¼‰\nTCPå‘é€æ¶ˆæ¯å¦‚æœå¯¹æ–¹ä¸æ¥æ”¶ï¼Œæˆ‘ä»¬è¿™è¾¹ä¼šæœ‰ä»€ä¹ˆæƒ…å†µå‘ç”Ÿï¼ˆæ‰¯äº†åº”ç”¨å±‚ç›¸å…³çš„ï¼Œå…¶å®é¢è¯•å®˜åªæ˜¯ä¸ºäº†å¼•å¯¼æˆ‘å›ç­”TCPçš„ä¼ è¾“é€Ÿç‡ä¸æ¥æ”¶çª—å£æœ‰å…³ï¼‰\nTCPçš„æ‹¥å¡æ§åˆ¶\nTCPçš„æ»‘åŠ¨çª—å£\nTCPçš„è¶…æ—¶æ—¶é—´è®¡ç®—\næ‰‹æ’•è·³å°é˜¶ï¼ˆå‰‘æŒ‡offeråŸé¢˜\u0026hellip;\u0026hellip;ï¼‰\næ‰‹æ’•Nä¸ªâ€œ(â€å’ŒNä¸ªâ€œ)â€çš„æ’åˆ—ç»„åˆï¼ˆå°±æ˜¯æœ‰é‡å¤æ•°æ®çš„å…¨æ’åˆ—ï¼Œä¸éœ€è¦æ‹¬å·åŒ¹é…ï¼‰\næé—® è¯¥éƒ¨é—¨çš„ä¸»è¦ä¸šåŠ¡å’Œä¸»è¦æŠ€æœ¯æ ˆ\nå¯¹åº”å±Šç”Ÿçš„è¦æ±‚ï¼Ÿ\nå‚åŠ åˆ›ä¸šç±»æ´»åŠ¨æ‰€è·å¾—çš„çš„å¥–åŠ±ï¼Œå’Œå…¶ä»–çš„ä¸€äº›ä¸“ä¸šçš„å…´è¶£çˆ±å¥½æ˜¯å¦ä¼šæˆä¸ºæ‚¨é€‰æ‹©äººæ‰çš„åŠ åˆ†é¡¹\nHRé¢è¯• é¢ç»æ±‡æ€»ï¼šhttps://www.nowcoder.com/discuss/240413?type=post\u0026amp;order=time\u0026amp;pos=\u0026amp;page=0\nhttps://www.cnblogs.com/zkfopen/p/11215315.html\nhttps://www.nowcoder.com/discuss/153849?type=post\u0026order=time\u0026pos=\u0026page=3\nhttps://blog.csdn.net/ELI_CJ/article/details/51793477\nhttps://www.nowcoder.com/discuss/153849\nhttps://www.nowcoder.com/discuss/217361\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/9th_%E6%AF%8F%E6%97%A5%E4%B8%80%E9%9D%A2/","summary":"9 æ¯ä¸€æ—¥é¢ å­—èŠ‚è·³åŠ¨\nå¾ˆè£å¹¸å­—èŠ‚è·³åŠ¨ä¸€è·¯èµ°åˆ°äº†å››é¢ï¼Œä¸ç®¡æ˜¯è¿æ°”è¿˜æ˜¯å®åŠ›ï¼Œéƒ½å¥½å¥½å‡†å¤‡æ¥ä¸‹æ¥çš„é¢è¯•å§ï¼ŒåŠ æ²¹\nç¼–ç¨‹ åˆ¤æ–­å­—ç¬¦ä¸²Bæ˜¯å¦æ˜¯å­—ç¬¦ä¸²Açš„å­ä¸² æ•°æ®ç»“æ„ä¸­çš„æ¡¶æ’åºã€å¹³è¡¡äºŒå‰æ ‘ .æ‰‹æ’•ä»£ç ï¼šæœºå™¨äººè·³è·ƒ(ç‰›å®¢åŸé¢˜ï¼‰ æ‰‹æ’•ä»£ç ï¼šé€†æ—¶é’ˆæ‰“å°çŸ©é˜µï¼ˆå‰‘æŒ‡offeræ”¹ï¼‰ åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼Œç©ºé—´å¤æ‚åº¦O(1)ï¼› DPæœ€é•¿å›æ–‡ä¸²ï¼› ç»™ä¸¤ä¸ª1Tçš„æ–‡ä»¶åœ¨2g ramçš„å†…å­˜ä¸­æ‰¾å‡ºç›¸åŒé¡¹ã€‚ ç»™ä¸€ä¸ªæœ‰å‘å›¾ï¼Œåˆ¤æ–­æœ‰å‘å›¾ä¸­æ˜¯å¦æœ‰ç¯ï¼Œå¦‚æœæœ‰ç¯ï¼Œç¯çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ ç»™ä¸€ä¸ªå¤§å°ä¸ºnçš„æ•°ç»„ï¼Œå¯»æ‰¾æ¯”kå°çš„æœ€å¤§æ•°çš„ä½ç½®ã€‚ 1.æœ€é•¿å›æ–‡å­ä¸² åœ°å›¾ä¸Šæœ‰è‹¥å¹²ä¸ªç‚¹ï¼Œæ€æ ·å¾—åˆ°æŸä¸ªç‚¹åˆ°è¾¾æŸä¸ªç‚¹çš„æ‰€æœ‰çš„æ¢ä¹˜è·¯çº¿ ï¼Ÿ æ˜¯å¦æ˜¯è”é€šï¼Œå¦‚æœä¸è¿é€šæ€ä¹ˆå¤„ç† ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å½“ä¸­æ˜¯ä¸€æ®µcè¯­è¨€çš„ä»£ç å’Œæ³¨é‡Šï¼Œæ³¨é‡Šåªæœ‰/** /è¿™æ ·çš„å¯ä»¥åµŒå¥—ï¼Œä¸åŒ…å«// è¯·è¿”å›å»é™¤æ‰€æœ‰æ³¨é‡Šçš„ä»£ç  å¦‚æœä»£ç å½“ä¸­çš„/*å’Œ/*å¯ä»¥ä¸å®Œå…¨åŒ¹é…å¦‚ä½•å‘ŠçŸ¥å‡ºç°é”™è¯¯ å†™äº†ä¸€ä¸ªç¨‹åºï¼Œæœ‰ä¸ªå°çƒï¼Œçƒä» 100 ç±³é«˜åº¦è‡ªç”±è½ä¸‹ï¼Œæ¯æ¬¡è½åœ°ååè·³å›åŸé«˜åº¦çš„ä¸€åŠï¼›å†è½ä¸‹ï¼Œæ±‚å®ƒåœ¨ç¬¬10 æ¬¡è½åœ°æ—¶ï¼Œå…±ç»è¿‡å¤šå°‘ç±³ï¼Ÿç¬¬ 10 æ¬¡åå¼¹å¤šé«˜ï¼Ÿ å†™ä»£ç ï¼šç«è½¦å”®ç¥¨ç³»ç»Ÿæ˜¯æ—©7ç‚¹-æ™š23ç‚¹è¿›è¡Œç½‘ä¸Šå”®ç¥¨ï¼Œå†™ä¸€ä¸ªç¨‹åºåˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›è¡Œç½‘ä¸Šä¹°ç¥¨ è®²ä¸€ä¸‹äºŒå‰æœç´¢æ ‘ï¼Œå†™èŠ‚ç‚¹çš„åˆ é™¤ä»£ç  æœ€å¤§è¿ç»­å­åºåˆ—å’Œ ä»£ç ï¼šå®ç°lruï¼Œä¸ä¼šå“¦ä¸´æ—¶æƒ³äº†ä¸€ç§lgnçš„å®ç°ï¼Œé¢è¯•å®˜ä¸æ»¡æ„ å†™ä¸€ä¸ªæœ€å°å †å»ºå †ï¼Œåˆ†æå¤æ‚åº¦ å¤šä¸ªä¸²ï¼Œå°†å«æœ‰ç›¸åŒå­—æ¯çš„ä¸²æ”¾åˆ°åŒä¸€ä¸ªé›†åˆï¼Œè¿”å›é›†åˆå‘é‡ è®²æ€è·¯ ç¼–ç¨‹ï¼š36è¿›åˆ¶åŠ æ³•ï¼ˆå¿˜è®°å¤„ç†æœ€é«˜ä½çš„è¿›ä½ï¼Œé¢è¯•å®˜æé†’äº†ä¸€ä¸‹ï¼‰ åœ¨ä¸€äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºæœ€å¤§çš„10ä¸ªæ•°ï¼Œåœ¨ä¸€äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºä¸­é—´çš„10ä¸ªæ•° ç¼–ç¨‹ï¼šå°†0-nçš„æ•´æ•°æ”¾åˆ°ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ä¸­ï¼Œæ‰¾å‡ºç¼ºå¤±çš„é‚£ä¸ªæ•° ç¼–ç¨‹ï¼š36è¿›åˆ¶åŠ æ³•ï¼ˆåˆæ¥ï¼Ÿï¼‰ é¢˜ç›®ï¼šnæ¡ç›´çº¿å¯ä»¥å°†ç©ºé—´åˆ’åˆ†ä¸ºå¤šå°‘ä¸ªåŒºåŸŸ é¢è¯•é¢˜ TCP å’ŒUDP\nè¿›ç¨‹å’Œçº¿ç¨‹\nè®¾è®¡æ¨¡å¼\nMySQLç´¢å¼•çš„æ•°æ®ç»“æ„\nè¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼\nè®¾è®¡ä¸€ä¸ªå­˜å‚¨æµ·é‡è¯„è®ºçš„ç»“æ„ï¼Œè¦æ±‚å¤§é‡æ•°æ®çš„å†™å…¥ï¼Œå¯ä»¥éšæ„ç¿»é¡µï¼Ÿ\nç†Ÿæ‚‰è®¡ç®—æœºå’Œç½‘ç»œåŸç†ï¼Œç†Ÿæ‚‰æ“ä½œç³»ç»ŸåŸç†ï¼Œå¯¹å­˜å‚¨ã€é˜Ÿåˆ—ã€è®¡ç®—ã€é›†ç¾¤ç®¡ç†ä¸­çš„ä¸€é¡¹æˆ–å¤šé¡¹æœ‰æ·±å…¥çš„ç†è§£å’Œè®¤è¯†ï¼›\nå¸¸ç”¨çš„æ’åºç®—æ³•çš„å¤æ‚åº¦ï¼Œå†™å¿«æ’ï¼›\nJavaçš„JVMçš„å†…å­˜å¸ƒå±€ï¼Œåƒåœ¾å›æ”¶çš„å®ç°ï¼Œå›æ”¶å™¨åˆ†å‡ éƒ¨åˆ†ï¼Œéƒ½æœ‰ä»€ä¹ˆä½œç”¨ï¼›\né¡¹ç›®å¤§ä½“é˜è¿°ä¸‹ï¼Œç”¨äº†å“ªäº›æŠ€æœ¯ã€è®¾è®¡æ¨¡å¼ï¼Œæœ€å¤§çš„æ„Ÿå—æ˜¯ä»€ä¹ˆï¼›ååˆ†é’Ÿå®ç°ç”¨è¿‡çš„è§‚å¯Ÿè€…æ¨¡å¼ã€å·¥å‚æ¨¡å¼ï¼›\nTCPå››æ¬¡æŒ¥æ‰‹è®²ä¸‹ï¼Ÿä¸ºä»€ä¹ˆæœ‰TIME_WAITï¼Ÿ TCPæ¯”UDPå¤šæ¶ˆè€—å“ªäº›ç³»ç»Ÿèµ„æºï¼Ÿ\nA(FIN_WAIT_1) -\u0026gt; B(CLOSE_WAIT) FIN=1,seq = u\nA(FIN_WAIT_2)\u0026lt;-B ACK=1, seq=v,ack=u+1;\nA \u0026lt;-B(LAST_ACK) FIN=1,seq = w,ack=u+1;\nA(TIME_WAIT) ACK=1 ,seq=u+1,ack=w+1;","tags":null,"title":""},{"categories":null,"contents":"#è®¡ç®—æœºæ“ä½œç³»ç»Ÿ\nåŸºæœ¬ç‰¹å¾ å¹¶å‘ å¹¶å‘æ˜¯æŒ‡å®è§‚ä¸Šåœ¨ä¸€æ®µæ—¶é—´å†…èƒ½åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºï¼Œè€Œå¹¶è¡Œåˆ™æŒ‡åŒä¸€æ—¶åˆ»èƒ½è¿è¡Œå¤šä¸ªæŒ‡ä»¤ã€‚\nå¹¶è¡Œéœ€è¦ç¡¬ä»¶æ”¯æŒï¼Œå¦‚å¤šæµæ°´çº¿ã€å¤šæ ¸å¤„ç†å™¨æˆ–è€…åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿã€‚\næ“ä½œç³»ç»Ÿé€šè¿‡å¼•å…¥è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œä½¿å¾—ç¨‹åºèƒ½å¤Ÿå¹¶å‘è¿è¡Œã€‚\nå…±äº« å…±äº«æ˜¯æŒ‡ç³»ç»Ÿä¸­çš„èµ„æºå¯ä»¥è¢«å¤šä¸ªå¹¶å‘è¿›ç¨‹å…±åŒä½¿ç”¨ã€‚\næœ‰ä¸¤ç§å…±äº«æ–¹å¼ï¼šäº’æ–¥å…±äº«å’ŒåŒæ—¶å…±äº«ã€‚\näº’æ–¥å…±äº«çš„èµ„æºç§°ä¸ºä¸´ç•Œèµ„æºï¼Œä¾‹å¦‚æ‰“å°æœºç­‰ï¼Œåœ¨åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®ï¼Œéœ€è¦ç”¨åŒæ­¥æœºåˆ¶æ¥å®ç°äº’æ–¥è®¿é—®ã€‚\nè™šæ‹Ÿ è™šæ‹ŸæŠ€æœ¯æŠŠä¸€ä¸ªç‰©ç†å®ä½“è½¬æ¢ä¸ºå¤šä¸ªé€»è¾‘å®ä½“ã€‚\nä¸»è¦æœ‰ä¸¤ç§è™šæ‹ŸæŠ€æœ¯ï¼šæ—¶ï¼ˆæ—¶é—´ï¼‰åˆ†å¤ç”¨æŠ€æœ¯å’Œç©ºï¼ˆç©ºé—´ï¼‰åˆ†å¤ç”¨æŠ€æœ¯ã€‚\nå¤šä¸ªè¿›ç¨‹èƒ½åœ¨åŒä¸€ä¸ªå¤„ç†å™¨ä¸Šå¹¶å‘æ‰§è¡Œä½¿ç”¨äº†æ—¶åˆ†å¤ç”¨æŠ€æœ¯ï¼Œè®©æ¯ä¸ªè¿›ç¨‹è½®æµå ç”¨å¤„ç†å™¨ï¼Œæ¯æ¬¡åªæ‰§è¡Œä¸€å°ä¸ªæ—¶é—´ç‰‡å¹¶å¿«é€Ÿåˆ‡æ¢ã€‚\nè™šæ‹Ÿå†…å­˜ä½¿ç”¨äº†ç©ºåˆ†å¤ç”¨æŠ€æœ¯ï¼Œå®ƒå°†ç‰©ç†å†…å­˜æŠ½è±¡ä¸ºåœ°å€ç©ºé—´ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å„è‡ªçš„åœ°å€ç©ºé—´ã€‚åœ°å€ç©ºé—´çš„é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œåœ°å€ç©ºé—´çš„é¡µå¹¶ä¸éœ€è¦å…¨éƒ¨åœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œå½“ä½¿ç”¨åˆ°ä¸€ä¸ªæ²¡æœ‰åœ¨ç‰©ç†å†…å­˜çš„é¡µæ—¶ï¼Œæ‰§è¡Œé¡µé¢ç½®æ¢ç®—æ³•ï¼Œå°†è¯¥é¡µç½®æ¢åˆ°å†…å­˜ä¸­ã€‚\nå¼‚æ­¥ å¼‚æ­¥æŒ‡è¿›ç¨‹ä¸æ˜¯ä¸€æ¬¡æ€§æ‰§è¡Œå®Œæ¯•ï¼Œè€Œæ˜¯èµ°èµ°åœåœï¼Œä»¥ä¸å¯çŸ¥çš„é€Ÿåº¦å‘å‰æ¨è¿›ã€‚\nåŸºæœ¬åŠŸèƒ½ è¿›ç¨‹ç®¡ç† è¿›ç¨‹æ§åˆ¶ã€è¿›ç¨‹åŒæ­¥ã€è¿›ç¨‹é€šä¿¡ã€æ­»é”å¤„ç†ã€å¤„ç†æœºè°ƒåº¦ç­‰ã€‚\nå†…å­˜ç®¡ç† å†…å­˜åˆ†é…ã€åœ°å€æ˜ å°„ã€å†…å­˜ä¿æŠ¤ä¸å…±äº«ã€è™šæ‹Ÿå†…å­˜ç­‰ã€‚\næ–‡ä»¶ç®¡ç† æ–‡ä»¶å­˜å‚¨ç©ºé—´çš„ç®¡ç†ã€ç›®å½•ç®¡ç†ã€æ–‡ä»¶è¯»å†™ç®¡ç†å’Œä¿æŠ¤ç­‰ã€‚\nè®¾å¤‡ç®¡ç† å®Œæˆç”¨æˆ·çš„ I/O è¯·æ±‚ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨å„ç§è®¾å¤‡ï¼Œå¹¶æé«˜è®¾å¤‡çš„åˆ©ç”¨ç‡ã€‚\nä¸»è¦åŒ…æ‹¬ç¼“å†²ç®¡ç†ã€è®¾å¤‡åˆ†é…ã€è®¾å¤‡å¤„ç†ã€è™›æ‹Ÿè®¾å¤‡ç­‰ã€‚\nç³»ç»Ÿè°ƒç”¨ å¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨ç”¨æˆ·æ€éœ€è¦ä½¿ç”¨å†…æ ¸æ€çš„åŠŸèƒ½ï¼Œå°±è¿›è¡Œç³»ç»Ÿè°ƒç”¨ä»è€Œé™·å…¥å†…æ ¸ï¼Œç”±æ“ä½œç³»ç»Ÿä»£ä¸ºå®Œæˆã€‚\nLinux çš„ç³»ç»Ÿè°ƒç”¨ä¸»è¦æœ‰ä»¥ä¸‹è¿™äº›ï¼š\nTask Commands è¿›ç¨‹æ§åˆ¶ fork(); exit(); wait(); è¿›ç¨‹é€šä¿¡ pipe(); shmget(); mmap(); æ–‡ä»¶æ“ä½œ open(); read(); write(); è®¾å¤‡æ“ä½œ ioctl(); read(); write(); ä¿¡æ¯ç»´æŠ¤ getpid(); alarm(); sleep(); å®‰å…¨ chmod(); umask(); chown(); å¤§å†…æ ¸å’Œå¾®å†…æ ¸ å¤§å†…æ ¸ å¤§å†…æ ¸æ˜¯å°†æ“ä½œç³»ç»ŸåŠŸèƒ½ä½œä¸ºä¸€ä¸ªç´§å¯†ç»“åˆçš„æ•´ä½“æ”¾åˆ°å†…æ ¸ã€‚\nç”±äºå„æ¨¡å—å…±äº«ä¿¡æ¯ï¼Œå› æ­¤æœ‰å¾ˆé«˜çš„æ€§èƒ½ã€‚\nå¾®å†…æ ¸ ç”±äºæ“ä½œç³»ç»Ÿä¸æ–­å¤æ‚ï¼Œå› æ­¤å°†ä¸€éƒ¨åˆ†æ“ä½œç³»ç»ŸåŠŸèƒ½ç§»å‡ºå†…æ ¸ï¼Œä»è€Œé™ä½å†…æ ¸çš„å¤æ‚æ€§ã€‚ç§»å‡ºçš„éƒ¨åˆ†æ ¹æ®åˆ†å±‚çš„åŸåˆ™åˆ’åˆ†æˆè‹¥å¹²æœåŠ¡ï¼Œç›¸äº’ç‹¬ç«‹ã€‚\nåœ¨å¾®å†…æ ¸ç»“æ„ä¸‹ï¼Œæ“ä½œç³»ç»Ÿè¢«åˆ’åˆ†æˆå°çš„ã€å®šä¹‰è‰¯å¥½çš„æ¨¡å—ï¼Œåªæœ‰å¾®å†…æ ¸è¿™ä¸€ä¸ªæ¨¡å—è¿è¡Œåœ¨å†…æ ¸æ€ï¼Œå…¶ä½™æ¨¡å—è¿è¡Œåœ¨ç”¨æˆ·æ€ã€‚\nå› ä¸ºéœ€è¦é¢‘ç¹åœ°åœ¨ç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€å®šçš„æ€§èƒ½æŸå¤±ã€‚\nä¸­æ–­åˆ†ç±» å¤–ä¸­æ–­ ç”± CPU æ‰§è¡ŒæŒ‡ä»¤ä»¥å¤–çš„äº‹ä»¶å¼•èµ·ï¼Œå¦‚ I/O å®Œæˆä¸­æ–­ï¼Œè¡¨ç¤ºè®¾å¤‡è¾“å…¥/è¾“å‡ºå¤„ç†å·²ç»å®Œæˆï¼Œå¤„ç†å™¨èƒ½å¤Ÿå‘é€ä¸‹ä¸€ä¸ªè¾“å…¥/è¾“å‡ºè¯·æ±‚ã€‚æ­¤å¤–è¿˜æœ‰æ—¶é’Ÿä¸­æ–­ã€æ§åˆ¶å°ä¸­æ–­ç­‰ã€‚\nå¼‚å¸¸ ç”± CPU æ‰§è¡ŒæŒ‡ä»¤çš„å†…éƒ¨äº‹ä»¶å¼•èµ·ï¼Œå¦‚éæ³•æ“ä½œç ã€åœ°å€è¶Šç•Œã€ç®—æœ¯æº¢å‡ºç­‰ã€‚\né™·å…¥ åœ¨ç”¨æˆ·ç¨‹åºä¸­ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","summary":"#è®¡ç®—æœºæ“ä½œç³»ç»Ÿ\nåŸºæœ¬ç‰¹å¾ å¹¶å‘ å¹¶å‘æ˜¯æŒ‡å®è§‚ä¸Šåœ¨ä¸€æ®µæ—¶é—´å†…èƒ½åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºï¼Œè€Œå¹¶è¡Œåˆ™æŒ‡åŒä¸€æ—¶åˆ»èƒ½è¿è¡Œå¤šä¸ªæŒ‡ä»¤ã€‚\nå¹¶è¡Œéœ€è¦ç¡¬ä»¶æ”¯æŒï¼Œå¦‚å¤šæµæ°´çº¿ã€å¤šæ ¸å¤„ç†å™¨æˆ–è€…åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿã€‚\næ“ä½œç³»ç»Ÿé€šè¿‡å¼•å…¥è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œä½¿å¾—ç¨‹åºèƒ½å¤Ÿå¹¶å‘è¿è¡Œã€‚\nå…±äº« å…±äº«æ˜¯æŒ‡ç³»ç»Ÿä¸­çš„èµ„æºå¯ä»¥è¢«å¤šä¸ªå¹¶å‘è¿›ç¨‹å…±åŒä½¿ç”¨ã€‚\næœ‰ä¸¤ç§å…±äº«æ–¹å¼ï¼šäº’æ–¥å…±äº«å’ŒåŒæ—¶å…±äº«ã€‚\näº’æ–¥å…±äº«çš„èµ„æºç§°ä¸ºä¸´ç•Œèµ„æºï¼Œä¾‹å¦‚æ‰“å°æœºç­‰ï¼Œåœ¨åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®ï¼Œéœ€è¦ç”¨åŒæ­¥æœºåˆ¶æ¥å®ç°äº’æ–¥è®¿é—®ã€‚\nè™šæ‹Ÿ è™šæ‹ŸæŠ€æœ¯æŠŠä¸€ä¸ªç‰©ç†å®ä½“è½¬æ¢ä¸ºå¤šä¸ªé€»è¾‘å®ä½“ã€‚\nä¸»è¦æœ‰ä¸¤ç§è™šæ‹ŸæŠ€æœ¯ï¼šæ—¶ï¼ˆæ—¶é—´ï¼‰åˆ†å¤ç”¨æŠ€æœ¯å’Œç©ºï¼ˆç©ºé—´ï¼‰åˆ†å¤ç”¨æŠ€æœ¯ã€‚\nå¤šä¸ªè¿›ç¨‹èƒ½åœ¨åŒä¸€ä¸ªå¤„ç†å™¨ä¸Šå¹¶å‘æ‰§è¡Œä½¿ç”¨äº†æ—¶åˆ†å¤ç”¨æŠ€æœ¯ï¼Œè®©æ¯ä¸ªè¿›ç¨‹è½®æµå ç”¨å¤„ç†å™¨ï¼Œæ¯æ¬¡åªæ‰§è¡Œä¸€å°ä¸ªæ—¶é—´ç‰‡å¹¶å¿«é€Ÿåˆ‡æ¢ã€‚\nè™šæ‹Ÿå†…å­˜ä½¿ç”¨äº†ç©ºåˆ†å¤ç”¨æŠ€æœ¯ï¼Œå®ƒå°†ç‰©ç†å†…å­˜æŠ½è±¡ä¸ºåœ°å€ç©ºé—´ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å„è‡ªçš„åœ°å€ç©ºé—´ã€‚åœ°å€ç©ºé—´çš„é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œåœ°å€ç©ºé—´çš„é¡µå¹¶ä¸éœ€è¦å…¨éƒ¨åœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œå½“ä½¿ç”¨åˆ°ä¸€ä¸ªæ²¡æœ‰åœ¨ç‰©ç†å†…å­˜çš„é¡µæ—¶ï¼Œæ‰§è¡Œé¡µé¢ç½®æ¢ç®—æ³•ï¼Œå°†è¯¥é¡µç½®æ¢åˆ°å†…å­˜ä¸­ã€‚\nå¼‚æ­¥ å¼‚æ­¥æŒ‡è¿›ç¨‹ä¸æ˜¯ä¸€æ¬¡æ€§æ‰§è¡Œå®Œæ¯•ï¼Œè€Œæ˜¯èµ°èµ°åœåœï¼Œä»¥ä¸å¯çŸ¥çš„é€Ÿåº¦å‘å‰æ¨è¿›ã€‚\nåŸºæœ¬åŠŸèƒ½ è¿›ç¨‹ç®¡ç† è¿›ç¨‹æ§åˆ¶ã€è¿›ç¨‹åŒæ­¥ã€è¿›ç¨‹é€šä¿¡ã€æ­»é”å¤„ç†ã€å¤„ç†æœºè°ƒåº¦ç­‰ã€‚\nå†…å­˜ç®¡ç† å†…å­˜åˆ†é…ã€åœ°å€æ˜ å°„ã€å†…å­˜ä¿æŠ¤ä¸å…±äº«ã€è™šæ‹Ÿå†…å­˜ç­‰ã€‚\næ–‡ä»¶ç®¡ç† æ–‡ä»¶å­˜å‚¨ç©ºé—´çš„ç®¡ç†ã€ç›®å½•ç®¡ç†ã€æ–‡ä»¶è¯»å†™ç®¡ç†å’Œä¿æŠ¤ç­‰ã€‚\nè®¾å¤‡ç®¡ç† å®Œæˆç”¨æˆ·çš„ I/O è¯·æ±‚ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨å„ç§è®¾å¤‡ï¼Œå¹¶æé«˜è®¾å¤‡çš„åˆ©ç”¨ç‡ã€‚\nä¸»è¦åŒ…æ‹¬ç¼“å†²ç®¡ç†ã€è®¾å¤‡åˆ†é…ã€è®¾å¤‡å¤„ç†ã€è™›æ‹Ÿè®¾å¤‡ç­‰ã€‚\nç³»ç»Ÿè°ƒç”¨ å¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨ç”¨æˆ·æ€éœ€è¦ä½¿ç”¨å†…æ ¸æ€çš„åŠŸèƒ½ï¼Œå°±è¿›è¡Œç³»ç»Ÿè°ƒç”¨ä»è€Œé™·å…¥å†…æ ¸ï¼Œç”±æ“ä½œç³»ç»Ÿä»£ä¸ºå®Œæˆã€‚\nLinux çš„ç³»ç»Ÿè°ƒç”¨ä¸»è¦æœ‰ä»¥ä¸‹è¿™äº›ï¼š\nTask Commands è¿›ç¨‹æ§åˆ¶ fork(); exit(); wait(); è¿›ç¨‹é€šä¿¡ pipe(); shmget(); mmap(); æ–‡ä»¶æ“ä½œ open(); read(); write(); è®¾å¤‡æ“ä½œ ioctl(); read(); write(); ä¿¡æ¯ç»´æŠ¤ getpid(); alarm(); sleep(); å®‰å…¨ chmod(); umask(); chown(); å¤§å†…æ ¸å’Œå¾®å†…æ ¸ å¤§å†…æ ¸ å¤§å†…æ ¸æ˜¯å°†æ“ä½œç³»ç»ŸåŠŸèƒ½ä½œä¸ºä¸€ä¸ªç´§å¯†ç»“åˆçš„æ•´ä½“æ”¾åˆ°å†…æ ¸ã€‚\nç”±äºå„æ¨¡å—å…±äº«ä¿¡æ¯ï¼Œå› æ­¤æœ‰å¾ˆé«˜çš„æ€§èƒ½ã€‚\nå¾®å†…æ ¸ ç”±äºæ“ä½œç³»ç»Ÿä¸æ–­å¤æ‚ï¼Œå› æ­¤å°†ä¸€éƒ¨åˆ†æ“ä½œç³»ç»ŸåŠŸèƒ½ç§»å‡ºå†…æ ¸ï¼Œä»è€Œé™ä½å†…æ ¸çš„å¤æ‚æ€§ã€‚ç§»å‡ºçš„éƒ¨åˆ†æ ¹æ®åˆ†å±‚çš„åŸåˆ™åˆ’åˆ†æˆè‹¥å¹²æœåŠ¡ï¼Œç›¸äº’ç‹¬ç«‹ã€‚\nåœ¨å¾®å†…æ ¸ç»“æ„ä¸‹ï¼Œæ“ä½œç³»ç»Ÿè¢«åˆ’åˆ†æˆå°çš„ã€å®šä¹‰è‰¯å¥½çš„æ¨¡å—ï¼Œåªæœ‰å¾®å†…æ ¸è¿™ä¸€ä¸ªæ¨¡å—è¿è¡Œåœ¨å†…æ ¸æ€ï¼Œå…¶ä½™æ¨¡å—è¿è¡Œåœ¨ç”¨æˆ·æ€ã€‚\nå› ä¸ºéœ€è¦é¢‘ç¹åœ°åœ¨ç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€å®šçš„æ€§èƒ½æŸå¤±ã€‚\nä¸­æ–­åˆ†ç±» å¤–ä¸­æ–­ ç”± CPU æ‰§è¡ŒæŒ‡ä»¤ä»¥å¤–çš„äº‹ä»¶å¼•èµ·ï¼Œå¦‚ I/O å®Œæˆä¸­æ–­ï¼Œè¡¨ç¤ºè®¾å¤‡è¾“å…¥/è¾“å‡ºå¤„ç†å·²ç»å®Œæˆï¼Œå¤„ç†å™¨èƒ½å¤Ÿå‘é€ä¸‹ä¸€ä¸ªè¾“å…¥/è¾“å‡ºè¯·æ±‚ã€‚æ­¤å¤–è¿˜æœ‰æ—¶é’Ÿä¸­æ–­ã€æ§åˆ¶å°ä¸­æ–­ç­‰ã€‚","tags":null,"title":""},{"categories":null,"contents":"çº¿ç¨‹åŒæ­¥ çº¿ç¨‹åŒæ­¥çš„æ¦‚å¿µ çº¿ç¨‹åŒæ­¥ï¼šå³å½“æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å¯¹å†…å­˜è¿›è¡Œæ“ä½œæ—¶ï¼Œå…¶ä»–çº¿ç¨‹éƒ½ä¸å¯ä»¥å¯¹è¿™ä¸ªå†…å­˜åœ°å€è¿›è¡Œæ“ä½œï¼Œç›´åˆ°è¯¥çº¿ç¨‹å®Œæˆæ“ä½œï¼Œ å…¶ä»–çº¿ç¨‹æ‰èƒ½å¯¹è¯¥å†…å­˜åœ°å€è¿›è¡Œæ“ä½œï¼Œè€Œå…¶ä»–çº¿ç¨‹åˆå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¸´ç•ŒåŒºå¯¹è±¡å°±æ˜¯å…¶ä¸­ä¸€ç§ã€‚\nåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹é‡Œé¢ï¼Œä¸€äº›æ•æ„Ÿæ•°æ®ä¸å…è®¸è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œæ­¤æ—¶å°±ä½¿ç”¨åŒæ­¥è®¿é—®æŠ€æœ¯ï¼Œä¿è¯æ•°æ®åœ¨ä»»ä½•æ—¶åˆ»ï¼Œæœ€å¤šæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œä»¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚\nçº¿ç¨‹æœ‰å¯èƒ½å’Œå…¶ä»–çº¿ç¨‹å…±äº«ä¸€äº›èµ„æºï¼Œæ¯”å¦‚ï¼Œå†…å­˜ï¼Œæ–‡ä»¶ï¼Œæ•°æ®åº“ç­‰ã€‚\nå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™åŒä¸€ä»½å…±äº«èµ„æºçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¼•èµ·å†²çªã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥çº¿ç¨‹â€œåŒæ­¥â€æœºåˆ¶ï¼Œå³å„ä½çº¿ç¨‹ä¹‹é—´è¦æœ‰ä¸ªå…ˆæ¥ååˆ°ï¼Œä¸èƒ½ä¸€çªèœ‚æŒ¤ä¸Šå»æŠ¢ä½œä¸€å›¢ã€‚\nçº¿ç¨‹åŒæ­¥çš„çœŸå®æ„æ€å’Œå­—é¢æ„æ€æ°å¥½ç›¸åã€‚çº¿ç¨‹åŒæ­¥çš„çœŸå®æ„æ€ï¼Œå…¶å®æ˜¯â€œæ’é˜Ÿâ€ï¼šå‡ ä¸ªçº¿ç¨‹ä¹‹é—´è¦æ’é˜Ÿï¼Œä¸€ä¸ªä¸€ä¸ªå¯¹å…±äº«èµ„æºè¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯åŒæ—¶è¿›è¡Œæ“ä½œã€‚\nçº¿ç¨‹åŒæ­¥çš„æ–¹å¼å’Œæœºåˆ¶ ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ã€äº’æ–¥å¯¹è±¡ï¼ˆMutexï¼‰ï¼šä¸»è¦ç”¨äºäº’æ–¥æ§åˆ¶ï¼›éƒ½å…·æœ‰æ‹¥æœ‰æƒçš„æ§åˆ¶æ–¹æ³•ï¼Œåªæœ‰æ‹¥æœ‰è¯¥å¯¹è±¡çš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œä»»åŠ¡ï¼Œæ‰€ä»¥æ‹¥æœ‰ï¼Œæ‰§è¡Œå®Œä»»åŠ¡åä¸€å®šè¦é‡Šæ”¾è¯¥å¯¹è±¡ã€‚\nä¿¡å·é‡ï¼ˆSemaphoreï¼‰ã€äº‹ä»¶å¯¹è±¡ï¼ˆEventï¼‰ï¼šäº‹ä»¶å¯¹è±¡æ˜¯ä»¥é€šçŸ¥çš„æ–¹å¼è¿›è¡Œæ§åˆ¶ï¼Œä¸»è¦ç”¨äºåŒæ­¥æ§åˆ¶ã€‚\nä¸´ç•ŒåŒº é€šè¿‡å¯¹å¤šçº¿ç¨‹çš„ä¸²è¡ŒåŒ–æ¥è®¿é—®å…¬å…±èµ„æºæˆ–ä¸€æ®µä»£ç ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆæ§åˆ¶æ•°æ®è®¿é—®ã€‚åœ¨ä»»æ„æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè¿›è¡Œè®¿é—®ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹è¯•å›¾è®¿é—®å…¬å…±èµ„æºï¼Œé‚£ä¹ˆåœ¨æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åï¼Œå…¶ä»–è¯•å›¾è®¿é—®å…¬å…±èµ„æºçš„çº¿ç¨‹å°†è¢«æŒ‚èµ·ï¼Œå¹¶ä¸€ç›´ç­‰åˆ°è¿›å…¥ä¸´ç•ŒåŒºçš„çº¿ç¨‹ç¦»å¼€ï¼Œä¸´ç•ŒåŒºåœ¨è¢«é‡Šæ”¾åï¼Œå…¶ä»–çº¿ç¨‹æ‰å¯ä»¥æŠ¢å ã€‚å®ƒå¹¶ä¸æ˜¯æ ¸å¿ƒå¯¹è±¡ï¼Œä¸æ˜¯å±äºæ“ä½œç³»ç»Ÿç»´æŠ¤çš„ï¼Œè€Œæ˜¯å±äºè¿›ç¨‹ç»´æŠ¤çš„ã€‚\n1ï¼‰å…³é”®æ®µå…±æœ‰åˆå§‹åŒ–ã€é”€æ¯ã€è¿›å…¥å’Œç¦»å¼€å…³é”®åŒºåŸŸå››ä¸ªå‡½æ•°ã€‚\n2ï¼‰å…³é”®æ®µå¯ä»¥è§£å†³çº¿ç¨‹çš„äº’æ–¥é—®é¢˜ï¼Œä½†å› ä¸ºå…·æœ‰â€œçº¿ç¨‹æ‰€æœ‰æƒâ€ï¼Œæ‰€ä»¥æ— æ³•è§£å†³åŒæ­¥é—®é¢˜ã€‚\n3ï¼‰æ¨èå…³é”®æ®µä¸æ—‹è½¬é”é…åˆä½¿ç”¨ã€‚\näº’æ–¥é‡ äº’æ–¥å¯¹è±¡å’Œä¸´ç•ŒåŒºå¾ˆåƒï¼Œé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥èƒ½ä¿è¯å…¬å…±èµ„æºä¸ä¼šåŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ã€‚å½“å‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹å¤„ç†å®Œä»»åŠ¡åå¿…é¡»å°†çº¿ç¨‹äº¤å‡ºï¼Œä»¥ä¾¿å…¶ä»–çº¿ç¨‹è®¿é—®è¯¥èµ„æºã€‚\n1ï¼‰äº’æ–¥é‡æ˜¯å†…æ ¸å¯¹è±¡ï¼Œå®ƒä¸å…³é”®æ®µéƒ½æœ‰â€œçº¿ç¨‹æ‰€æœ‰æƒâ€æ‰€ä»¥ä¸èƒ½ç”¨äºçº¿ç¨‹çš„åŒæ­¥ã€‚\n2ï¼‰äº’æ–¥é‡èƒ½å¤Ÿç”¨äºå¤šä¸ªè¿›ç¨‹ä¹‹é—´çº¿ç¨‹äº’æ–¥é—®é¢˜ï¼Œå¹¶ä¸”èƒ½è§£å†³æŸè¿›ç¨‹æ„å¤–ç»ˆæ­¢æ‰€é€ æˆçš„â€œé—å¼ƒâ€é—®é¢˜ã€‚ 3ã€ä¿¡å·é‡ï¼šä¿¡å·é‡ä¹Ÿæ˜¯å†…æ ¸å¯¹è±¡ã€‚å®ƒå…è®¸å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦é™åˆ¶åœ¨åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°ç›®\nä¿¡å·é‡ åœ¨ç”¨CreateSemaphore()åˆ›å»ºä¿¡å·é‡æ—¶å³è¦åŒæ—¶æŒ‡å‡ºå…è®¸çš„æœ€å¤§èµ„æºè®¡æ•°å’Œå½“å‰å¯ç”¨èµ„æºè®¡æ•°ã€‚ä¸€èˆ¬æ˜¯å°†å½“å‰å¯ç”¨èµ„æºè®¡æ•°è®¾ç½®ä¸ºæœ€ å¤§èµ„æºè®¡æ•°ï¼Œæ¯å¢åŠ ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ï¼Œå½“å‰å¯ç”¨èµ„æºè®¡æ•°å°±ä¼šå‡1 ï¼Œåªè¦å½“å‰å¯ç”¨èµ„æºè®¡æ•°æ˜¯å¤§äº0 çš„ï¼Œå°±å¯ä»¥å‘å‡ºä¿¡å·é‡ä¿¡å·ã€‚ä½†æ˜¯å½“å‰å¯ç”¨è®¡æ•°å‡å° åˆ°0 æ—¶åˆ™è¯´æ˜å½“å‰å ç”¨èµ„æºçš„çº¿ç¨‹æ•°å·²ç»è¾¾åˆ°äº†æ‰€å…è®¸çš„æœ€å¤§æ•°ç›®ï¼Œä¸èƒ½åœ¨å…è®¸å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ï¼Œæ­¤æ—¶çš„ä¿¡å·é‡ä¿¡å·å°†æ— æ³•å‘å‡ºã€‚çº¿ç¨‹åœ¨å¤„ç†å®Œå…±äº«èµ„æºåï¼Œåº”åœ¨ç¦» å¼€çš„åŒæ—¶é€šè¿‡ReleaseSemaphore ï¼ˆï¼‰å‡½æ•°å°†å½“å‰å¯ç”¨èµ„æºè®¡æ•°åŠ 1 ã€‚åœ¨ä»»ä½•æ—¶å€™å½“å‰å¯ç”¨èµ„æºè®¡æ•°å†³ä¸å¯èƒ½å¤§äºæœ€å¤§èµ„æºè®¡æ•°ã€‚\näº‹ä»¶å¯¹è±¡ é€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒçº¿ç¨‹çš„åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿å®ç°å¯¹å¤šä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒçš„æ“ä½œ\n1ï¼‰äº‹ä»¶æ˜¯å†…æ ¸å¯¹è±¡ï¼Œäº‹ä»¶åˆ†ä¸ºæ‰‹åŠ¨ç½®ä½äº‹ä»¶å’Œè‡ªåŠ¨ç½®ä½äº‹ä»¶ã€‚äº‹ä»¶Eventå†…éƒ¨å®ƒåŒ…å«ä¸€ä¸ªä½¿ç”¨è®¡æ•°ï¼ˆæ‰€æœ‰å†…æ ¸å¯¹è±¡éƒ½æœ‰ï¼‰ï¼Œä¸€ä¸ªå¸ƒå°”å€¼è¡¨ç¤ºæ˜¯æ‰‹åŠ¨ç½®ä½äº‹ä»¶è¿˜æ˜¯è‡ªåŠ¨ç½®ä½äº‹ä»¶ï¼Œå¦ä¸€ä¸ªå¸ƒå°”å€¼ç”¨æ¥è¡¨ç¤ºäº‹ä»¶æœ‰æ— è§¦å‘ã€‚\n2ï¼‰äº‹ä»¶å¯ä»¥ç”±SetEvent()æ¥è§¦å‘ï¼Œç”±ResetEvent()æ¥è®¾æˆæœªè§¦å‘ã€‚è¿˜å¯ä»¥ç”±PulseEvent()æ¥å‘å‡ºä¸€ä¸ªäº‹ä»¶è„‰å†²ã€‚\n3ï¼‰äº‹ä»¶å¯ä»¥è§£å†³çº¿ç¨‹é—´åŒæ­¥é—®é¢˜ï¼Œå› æ­¤ä¹Ÿèƒ½è§£å†³äº’æ–¥é—®é¢˜ã€‚\nçº¿ç¨‹åŒæ­¥çš„æ–¹æ³• (1)wait():ä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„lockã€‚\n(2)sleep():ä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•è¦æ•æ‰ InterruptedExceptionå¼‚å¸¸ã€‚\n(3)notify():å”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„çš„æ˜¯åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„ å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”±JVMç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸æ˜¯æŒ‰ä¼˜å…ˆçº§ã€‚\n(4)notityAll ():å”¤é†’æ‰€æœ‰å¤„å…¥ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„å¹¶ä¸æ˜¯ç»™æ‰€æœ‰å”¤é†’çº¿ç¨‹ä¸€ä¸ªå¯¹è±¡çš„é”ï¼Œ è€Œæ˜¯è®©å®ƒä»¬ç«äº‰ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/","summary":"çº¿ç¨‹åŒæ­¥ çº¿ç¨‹åŒæ­¥çš„æ¦‚å¿µ çº¿ç¨‹åŒæ­¥ï¼šå³å½“æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å¯¹å†…å­˜è¿›è¡Œæ“ä½œæ—¶ï¼Œå…¶ä»–çº¿ç¨‹éƒ½ä¸å¯ä»¥å¯¹è¿™ä¸ªå†…å­˜åœ°å€è¿›è¡Œæ“ä½œï¼Œç›´åˆ°è¯¥çº¿ç¨‹å®Œæˆæ“ä½œï¼Œ å…¶ä»–çº¿ç¨‹æ‰èƒ½å¯¹è¯¥å†…å­˜åœ°å€è¿›è¡Œæ“ä½œï¼Œè€Œå…¶ä»–çº¿ç¨‹åˆå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå®ç°çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¸´ç•ŒåŒºå¯¹è±¡å°±æ˜¯å…¶ä¸­ä¸€ç§ã€‚\nåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹é‡Œé¢ï¼Œä¸€äº›æ•æ„Ÿæ•°æ®ä¸å…è®¸è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œæ­¤æ—¶å°±ä½¿ç”¨åŒæ­¥è®¿é—®æŠ€æœ¯ï¼Œä¿è¯æ•°æ®åœ¨ä»»ä½•æ—¶åˆ»ï¼Œæœ€å¤šæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œä»¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚\nçº¿ç¨‹æœ‰å¯èƒ½å’Œå…¶ä»–çº¿ç¨‹å…±äº«ä¸€äº›èµ„æºï¼Œæ¯”å¦‚ï¼Œå†…å­˜ï¼Œæ–‡ä»¶ï¼Œæ•°æ®åº“ç­‰ã€‚\nå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™åŒä¸€ä»½å…±äº«èµ„æºçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¼•èµ·å†²çªã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥çº¿ç¨‹â€œåŒæ­¥â€æœºåˆ¶ï¼Œå³å„ä½çº¿ç¨‹ä¹‹é—´è¦æœ‰ä¸ªå…ˆæ¥ååˆ°ï¼Œä¸èƒ½ä¸€çªèœ‚æŒ¤ä¸Šå»æŠ¢ä½œä¸€å›¢ã€‚\nçº¿ç¨‹åŒæ­¥çš„çœŸå®æ„æ€å’Œå­—é¢æ„æ€æ°å¥½ç›¸åã€‚çº¿ç¨‹åŒæ­¥çš„çœŸå®æ„æ€ï¼Œå…¶å®æ˜¯â€œæ’é˜Ÿâ€ï¼šå‡ ä¸ªçº¿ç¨‹ä¹‹é—´è¦æ’é˜Ÿï¼Œä¸€ä¸ªä¸€ä¸ªå¯¹å…±äº«èµ„æºè¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯åŒæ—¶è¿›è¡Œæ“ä½œã€‚\nçº¿ç¨‹åŒæ­¥çš„æ–¹å¼å’Œæœºåˆ¶ ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ã€äº’æ–¥å¯¹è±¡ï¼ˆMutexï¼‰ï¼šä¸»è¦ç”¨äºäº’æ–¥æ§åˆ¶ï¼›éƒ½å…·æœ‰æ‹¥æœ‰æƒçš„æ§åˆ¶æ–¹æ³•ï¼Œåªæœ‰æ‹¥æœ‰è¯¥å¯¹è±¡çš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œä»»åŠ¡ï¼Œæ‰€ä»¥æ‹¥æœ‰ï¼Œæ‰§è¡Œå®Œä»»åŠ¡åä¸€å®šè¦é‡Šæ”¾è¯¥å¯¹è±¡ã€‚\nä¿¡å·é‡ï¼ˆSemaphoreï¼‰ã€äº‹ä»¶å¯¹è±¡ï¼ˆEventï¼‰ï¼šäº‹ä»¶å¯¹è±¡æ˜¯ä»¥é€šçŸ¥çš„æ–¹å¼è¿›è¡Œæ§åˆ¶ï¼Œä¸»è¦ç”¨äºåŒæ­¥æ§åˆ¶ã€‚\nä¸´ç•ŒåŒº é€šè¿‡å¯¹å¤šçº¿ç¨‹çš„ä¸²è¡ŒåŒ–æ¥è®¿é—®å…¬å…±èµ„æºæˆ–ä¸€æ®µä»£ç ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆæ§åˆ¶æ•°æ®è®¿é—®ã€‚åœ¨ä»»æ„æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè¿›è¡Œè®¿é—®ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹è¯•å›¾è®¿é—®å…¬å…±èµ„æºï¼Œé‚£ä¹ˆåœ¨æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åï¼Œå…¶ä»–è¯•å›¾è®¿é—®å…¬å…±èµ„æºçš„çº¿ç¨‹å°†è¢«æŒ‚èµ·ï¼Œå¹¶ä¸€ç›´ç­‰åˆ°è¿›å…¥ä¸´ç•ŒåŒºçš„çº¿ç¨‹ç¦»å¼€ï¼Œä¸´ç•ŒåŒºåœ¨è¢«é‡Šæ”¾åï¼Œå…¶ä»–çº¿ç¨‹æ‰å¯ä»¥æŠ¢å ã€‚å®ƒå¹¶ä¸æ˜¯æ ¸å¿ƒå¯¹è±¡ï¼Œä¸æ˜¯å±äºæ“ä½œç³»ç»Ÿç»´æŠ¤çš„ï¼Œè€Œæ˜¯å±äºè¿›ç¨‹ç»´æŠ¤çš„ã€‚\n1ï¼‰å…³é”®æ®µå…±æœ‰åˆå§‹åŒ–ã€é”€æ¯ã€è¿›å…¥å’Œç¦»å¼€å…³é”®åŒºåŸŸå››ä¸ªå‡½æ•°ã€‚\n2ï¼‰å…³é”®æ®µå¯ä»¥è§£å†³çº¿ç¨‹çš„äº’æ–¥é—®é¢˜ï¼Œä½†å› ä¸ºå…·æœ‰â€œçº¿ç¨‹æ‰€æœ‰æƒâ€ï¼Œæ‰€ä»¥æ— æ³•è§£å†³åŒæ­¥é—®é¢˜ã€‚\n3ï¼‰æ¨èå…³é”®æ®µä¸æ—‹è½¬é”é…åˆä½¿ç”¨ã€‚\näº’æ–¥é‡ äº’æ–¥å¯¹è±¡å’Œä¸´ç•ŒåŒºå¾ˆåƒï¼Œé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥èƒ½ä¿è¯å…¬å…±èµ„æºä¸ä¼šåŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ã€‚å½“å‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹å¤„ç†å®Œä»»åŠ¡åå¿…é¡»å°†çº¿ç¨‹äº¤å‡ºï¼Œä»¥ä¾¿å…¶ä»–çº¿ç¨‹è®¿é—®è¯¥èµ„æºã€‚\n1ï¼‰äº’æ–¥é‡æ˜¯å†…æ ¸å¯¹è±¡ï¼Œå®ƒä¸å…³é”®æ®µéƒ½æœ‰â€œçº¿ç¨‹æ‰€æœ‰æƒâ€æ‰€ä»¥ä¸èƒ½ç”¨äºçº¿ç¨‹çš„åŒæ­¥ã€‚\n2ï¼‰äº’æ–¥é‡èƒ½å¤Ÿç”¨äºå¤šä¸ªè¿›ç¨‹ä¹‹é—´çº¿ç¨‹äº’æ–¥é—®é¢˜ï¼Œå¹¶ä¸”èƒ½è§£å†³æŸè¿›ç¨‹æ„å¤–ç»ˆæ­¢æ‰€é€ æˆçš„â€œé—å¼ƒâ€é—®é¢˜ã€‚ 3ã€ä¿¡å·é‡ï¼šä¿¡å·é‡ä¹Ÿæ˜¯å†…æ ¸å¯¹è±¡ã€‚å®ƒå…è®¸å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦é™åˆ¶åœ¨åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°ç›®\nä¿¡å·é‡ åœ¨ç”¨CreateSemaphore()åˆ›å»ºä¿¡å·é‡æ—¶å³è¦åŒæ—¶æŒ‡å‡ºå…è®¸çš„æœ€å¤§èµ„æºè®¡æ•°å’Œå½“å‰å¯ç”¨èµ„æºè®¡æ•°ã€‚ä¸€èˆ¬æ˜¯å°†å½“å‰å¯ç”¨èµ„æºè®¡æ•°è®¾ç½®ä¸ºæœ€ å¤§èµ„æºè®¡æ•°ï¼Œæ¯å¢åŠ ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ï¼Œå½“å‰å¯ç”¨èµ„æºè®¡æ•°å°±ä¼šå‡1 ï¼Œåªè¦å½“å‰å¯ç”¨èµ„æºè®¡æ•°æ˜¯å¤§äº0 çš„ï¼Œå°±å¯ä»¥å‘å‡ºä¿¡å·é‡ä¿¡å·ã€‚ä½†æ˜¯å½“å‰å¯ç”¨è®¡æ•°å‡å° åˆ°0 æ—¶åˆ™è¯´æ˜å½“å‰å ç”¨èµ„æºçš„çº¿ç¨‹æ•°å·²ç»è¾¾åˆ°äº†æ‰€å…è®¸çš„æœ€å¤§æ•°ç›®ï¼Œä¸èƒ½åœ¨å…è®¸å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ï¼Œæ­¤æ—¶çš„ä¿¡å·é‡ä¿¡å·å°†æ— æ³•å‘å‡ºã€‚çº¿ç¨‹åœ¨å¤„ç†å®Œå…±äº«èµ„æºåï¼Œåº”åœ¨ç¦» å¼€çš„åŒæ—¶é€šè¿‡ReleaseSemaphore ï¼ˆï¼‰å‡½æ•°å°†å½“å‰å¯ç”¨èµ„æºè®¡æ•°åŠ 1 ã€‚åœ¨ä»»ä½•æ—¶å€™å½“å‰å¯ç”¨èµ„æºè®¡æ•°å†³ä¸å¯èƒ½å¤§äºæœ€å¤§èµ„æºè®¡æ•°ã€‚\näº‹ä»¶å¯¹è±¡ é€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒçº¿ç¨‹çš„åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿å®ç°å¯¹å¤šä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒçš„æ“ä½œ\n1ï¼‰äº‹ä»¶æ˜¯å†…æ ¸å¯¹è±¡ï¼Œäº‹ä»¶åˆ†ä¸ºæ‰‹åŠ¨ç½®ä½äº‹ä»¶å’Œè‡ªåŠ¨ç½®ä½äº‹ä»¶ã€‚äº‹ä»¶Eventå†…éƒ¨å®ƒåŒ…å«ä¸€ä¸ªä½¿ç”¨è®¡æ•°ï¼ˆæ‰€æœ‰å†…æ ¸å¯¹è±¡éƒ½æœ‰ï¼‰ï¼Œä¸€ä¸ªå¸ƒå°”å€¼è¡¨ç¤ºæ˜¯æ‰‹åŠ¨ç½®ä½äº‹ä»¶è¿˜æ˜¯è‡ªåŠ¨ç½®ä½äº‹ä»¶ï¼Œå¦ä¸€ä¸ªå¸ƒå°”å€¼ç”¨æ¥è¡¨ç¤ºäº‹ä»¶æœ‰æ— è§¦å‘ã€‚\n2ï¼‰äº‹ä»¶å¯ä»¥ç”±SetEvent()æ¥è§¦å‘ï¼Œç”±ResetEvent()æ¥è®¾æˆæœªè§¦å‘ã€‚è¿˜å¯ä»¥ç”±PulseEvent()æ¥å‘å‡ºä¸€ä¸ªäº‹ä»¶è„‰å†²ã€‚\n3ï¼‰äº‹ä»¶å¯ä»¥è§£å†³çº¿ç¨‹é—´åŒæ­¥é—®é¢˜ï¼Œå› æ­¤ä¹Ÿèƒ½è§£å†³äº’æ–¥é—®é¢˜ã€‚\nçº¿ç¨‹åŒæ­¥çš„æ–¹æ³• (1)wait():ä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„lockã€‚\n(2)sleep():ä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•è¦æ•æ‰ InterruptedExceptionå¼‚å¸¸ã€‚\n(3)notify():å”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„çš„æ˜¯åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„ å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”±JVMç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸æ˜¯æŒ‰ä¼˜å…ˆçº§ã€‚\n(4)notityAll ():å”¤é†’æ‰€æœ‰å¤„å…¥ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„å¹¶ä¸æ˜¯ç»™æ‰€æœ‰å”¤é†’çº¿ç¨‹ä¸€ä¸ªå¯¹è±¡çš„é”ï¼Œ è€Œæ˜¯è®©å®ƒä»¬ç«äº‰ã€‚","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C/","summary":"","tags":null,"title":""},{"categories":null,"contents":"ä»åº•å±‚æŠ€æœ¯è§’åº¦çœ‹ï¼ŒPodå†…ä¸åŒå®¹å™¨ä¹‹é—´å…±äº«å­˜å‚¨å’Œä¸€äº›namespaceã€‚\nPID namespace: Podä¸­ä¸åŒåº”ç”¨ç¨‹åºçœ‹æ‹¿åˆ°çš„å…¶ä»–è¿›ç¨‹çš„IDã€‚Sidecar æ¨¡å¼ä¸‹åªèƒ½çœ‹åˆ°ä¸€ä¸ªè¿›ç¨‹ï¼Ÿ\nNetwork Namespace: Pod ä¸­çš„å¤šä¸ªå®¹å™¨å…·æœ‰ç›¸åŒçš„ç½‘ç»œé…ç½®ï¼Œå…±äº«ä¸€ä¸ªç«¯å£èŒƒå›´ã€‚\nIPC Namespaceï¼š Podä¸­çš„å¤šä¸ªå®¹å™¨èƒ½å¤Ÿä½¿ç”¨SystemV IPC æˆ– POSIXæ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ã€‚\nUTS Namespace: Podä¸­çš„å¤šä¸ªå®¹å™¨å…±äº«ä¸€ä¸ªä¸»æœºåã€‚\nåœ¨Kubernetesçš„ç½‘ç»œæ¨¡å‹ä¸­ï¼Œæ¯å°æœåŠ¡å™¨ä¸Šçš„å®¹å™¨æœ‰è‡ªå·±ç‹¬ç«‹çš„IPæ®µã€‚\nä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œé‡ç‚¹è§£å†³ä¸€ä¸‹ä¸¤ç‚¹ï¼š\nå„å°æœåŠ¡å™¨ä¸Šçš„å®¹å™¨IPæ®µä¸èƒ½é‡å ï¼Œæ‰€ä»¥éœ€è¦æŸç§IPæ®µåˆ†é…æœºåˆ¶ï¼Œä¸ºå„å°æœºå™¨åˆ†é…ç‹¬ç«‹çš„IPæ®µã€‚ ä»æŸä¸ªPodå‘å‡ºçš„æµé‡åˆ°è¾¾æ‰€åœ¨çš„æœºå™¨çš„Hostä¸Šæ—¶ï¼Œæœºå™¨ç½‘ç»œå±‚åº”å½“æ ¹æ®ç›®æ ‡IPåœ°å€ï¼Œå°†æµé‡è½¬å‘åˆ°ç›®æ ‡æœºå™¨çš„èƒ½åŠ›ã€‚ ç»¼ä¸Šï¼Œä¸¤ä¸ªèƒ½åŠ›ï¼š IPåœ°å€åˆ†é…å’ŒRoute.\nå®¹å™¨ä¹‹é—´ç›´æ¥é€šä¿¡ï¼Œä¸éœ€è¦é¢å¤–çš„NATã€‚\nPod to Pod æ‰€æœ‰çš„Podä¹‹é—´è¦ä¿è¯3å±‚ç½‘ç»œçš„è”é€šæ€§\nPod to Service Servcie æ€»å…±æœ‰4ç§ç±»å‹ï¼Œå…¶ä¸­ç»„å¸¸ç”¨çš„å°±æ˜¯Cluster IP. è¿™ç§ç±»å‹çš„Serviceä¼šåˆ†é…ä¸€ä¸ªä»…é›†ç¾¤å†…å¯ä»¥è®¿é—®çš„è™šæ‹ŸIPã€‚\nKubernetesé€šè¿‡kube-proxyç»„ä»¶å®ç°Service Cluster IPçš„åŠŸèƒ½ã€‚kube-proxy æ˜¯ä¸€ä¸ªdaemonsetï¼Œé€šè¿‡å¤æ‚çš„iptables/IPVS è§„åˆ™åœ¨Podå’ŒServiceä¹‹é—´è¿›è¡Œå„ç§è¿‡æ»¤å’ŒNAT.\nPodåˆ°é›†ç¾¤å¤– ä»Podå†…éƒ¨åˆ°é›†ç¾¤å¤–çš„æµé‡ï¼ŒKubernetesä¼šé€šè¿‡SNATæ¥å¤„ç†ã€‚\nKubernets é»˜è®¤çš„ç»„ç½‘æ–¹æ¡ˆæ˜¯bridgeï¼ŒCNIä¸»è¦æ˜¯ç”¨æ¥è§£å†³å®¹å™¨çš„è·¨æœºé€šä¿¡ã€‚å…¸å‹çš„è·¨æœºé€šä¿¡æ–¹æ¡ˆæœ‰bridgeå’Œoverlayã€‚\nåˆ›å»ºPodæ—¶å€™ï¼Œé¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ªpauseå®¹å™¨ã€‚å ç”¨ä¸€ä¸ª linuxçš„network namespaceã€‚Podå†…çš„å…¶ä»–å®¹å™¨å…±äº«è¿™ä¸ªnetwork namespaceã€‚æ­¤æ—¶ï¼Œåªæœ‰ä¸€ä¸ªloè®¾å¤‡ã€‚ CNIè´Ÿè´£åˆå§‹åŒ–pause container ä¸­çš„ç½‘ç»œè®¾å¤‡ã€‚\nkubernetesä¸»æœºå†…ç»„ç½‘\u0026amp;è·¨èŠ‚ç‚¹ç»„ç½‘ kubernetes ç»å…¸çš„ä¸»æœºå†…ç»„ç½‘æ¨¡å‹æ˜¯veth pair+bridgeã€‚\nè·¨æœºé€šä¿¡ä¸€èˆ¬æ˜¯bridge + overlayã€‚ vxlan\ndownward API é€šè¿‡HostAliasä¿®æ”¹podä¸­çš„/etc/host(Podåœ¨host networkä¸‹ä¸æ”¯æŒ)\nPodçš„éš”ç¦»ä¸­ network namspce æ˜¯æœ€å…ˆåˆ›å»ºçš„ï¼Œå¦‚æœnsä½¿ç”¨äº†hostæ¨¡å¼ï¼Œåˆ™utsä¹Ÿä¼šä½¿ç”¨hostæ¨¡å¼ã€‚\nPauseæ‰®æ¼”PID 1çš„è§’è‰²ï¼Œå¹¶åœ¨å­è¿›ç¨‹æˆä¸ºâ€œå­¤å„¿è¿›ç¨‹â€æ—¶ï¼Œé€šè¿‡wait() æ”¶å‰²è¿™äº›åƒµå°¸å­è¿›ç¨‹ã€‚\nUnixçš„initè¿›ç¨‹çš„ä½œç”¨æ˜¯å½“æŸä¸ªå­è¿›ç¨‹ç”±äºçˆ¶è¿›ç¨‹çš„é”™è¯¯é€€å‡ºè€Œå˜æˆäº†â€œå­¤å„¿è¿›ç¨‹â€ï¼Œä¾¿ä¼šè¢«initè¿›ç¨‹â€œæ”¶å…»â€å¹¶åœ¨é€€å‡ºè¯¥è¿›ç¨‹æ—¶å›æ”¶èµ„æºã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_ops_pod/","summary":"ä»åº•å±‚æŠ€æœ¯è§’åº¦çœ‹ï¼ŒPodå†…ä¸åŒå®¹å™¨ä¹‹é—´å…±äº«å­˜å‚¨å’Œä¸€äº›namespaceã€‚\nPID namespace: Podä¸­ä¸åŒåº”ç”¨ç¨‹åºçœ‹æ‹¿åˆ°çš„å…¶ä»–è¿›ç¨‹çš„IDã€‚Sidecar æ¨¡å¼ä¸‹åªèƒ½çœ‹åˆ°ä¸€ä¸ªè¿›ç¨‹ï¼Ÿ\nNetwork Namespace: Pod ä¸­çš„å¤šä¸ªå®¹å™¨å…·æœ‰ç›¸åŒçš„ç½‘ç»œé…ç½®ï¼Œå…±äº«ä¸€ä¸ªç«¯å£èŒƒå›´ã€‚\nIPC Namespaceï¼š Podä¸­çš„å¤šä¸ªå®¹å™¨èƒ½å¤Ÿä½¿ç”¨SystemV IPC æˆ– POSIXæ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ã€‚\nUTS Namespace: Podä¸­çš„å¤šä¸ªå®¹å™¨å…±äº«ä¸€ä¸ªä¸»æœºåã€‚\nåœ¨Kubernetesçš„ç½‘ç»œæ¨¡å‹ä¸­ï¼Œæ¯å°æœåŠ¡å™¨ä¸Šçš„å®¹å™¨æœ‰è‡ªå·±ç‹¬ç«‹çš„IPæ®µã€‚\nä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œé‡ç‚¹è§£å†³ä¸€ä¸‹ä¸¤ç‚¹ï¼š\nå„å°æœåŠ¡å™¨ä¸Šçš„å®¹å™¨IPæ®µä¸èƒ½é‡å ï¼Œæ‰€ä»¥éœ€è¦æŸç§IPæ®µåˆ†é…æœºåˆ¶ï¼Œä¸ºå„å°æœºå™¨åˆ†é…ç‹¬ç«‹çš„IPæ®µã€‚ ä»æŸä¸ªPodå‘å‡ºçš„æµé‡åˆ°è¾¾æ‰€åœ¨çš„æœºå™¨çš„Hostä¸Šæ—¶ï¼Œæœºå™¨ç½‘ç»œå±‚åº”å½“æ ¹æ®ç›®æ ‡IPåœ°å€ï¼Œå°†æµé‡è½¬å‘åˆ°ç›®æ ‡æœºå™¨çš„èƒ½åŠ›ã€‚ ç»¼ä¸Šï¼Œä¸¤ä¸ªèƒ½åŠ›ï¼š IPåœ°å€åˆ†é…å’ŒRoute.\nå®¹å™¨ä¹‹é—´ç›´æ¥é€šä¿¡ï¼Œä¸éœ€è¦é¢å¤–çš„NATã€‚\nPod to Pod æ‰€æœ‰çš„Podä¹‹é—´è¦ä¿è¯3å±‚ç½‘ç»œçš„è”é€šæ€§\nPod to Service Servcie æ€»å…±æœ‰4ç§ç±»å‹ï¼Œå…¶ä¸­ç»„å¸¸ç”¨çš„å°±æ˜¯Cluster IP. è¿™ç§ç±»å‹çš„Serviceä¼šåˆ†é…ä¸€ä¸ªä»…é›†ç¾¤å†…å¯ä»¥è®¿é—®çš„è™šæ‹ŸIPã€‚\nKubernetesé€šè¿‡kube-proxyç»„ä»¶å®ç°Service Cluster IPçš„åŠŸèƒ½ã€‚kube-proxy æ˜¯ä¸€ä¸ªdaemonsetï¼Œé€šè¿‡å¤æ‚çš„iptables/IPVS è§„åˆ™åœ¨Podå’ŒServiceä¹‹é—´è¿›è¡Œå„ç§è¿‡æ»¤å’ŒNAT.\nPodåˆ°é›†ç¾¤å¤– ä»Podå†…éƒ¨åˆ°é›†ç¾¤å¤–çš„æµé‡ï¼ŒKubernetesä¼šé€šè¿‡SNATæ¥å¤„ç†ã€‚\nKubernets é»˜è®¤çš„ç»„ç½‘æ–¹æ¡ˆæ˜¯bridgeï¼ŒCNIä¸»è¦æ˜¯ç”¨æ¥è§£å†³å®¹å™¨çš„è·¨æœºé€šä¿¡ã€‚å…¸å‹çš„è·¨æœºé€šä¿¡æ–¹æ¡ˆæœ‰bridgeå’Œoverlayã€‚\nåˆ›å»ºPodæ—¶å€™ï¼Œé¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ªpauseå®¹å™¨ã€‚å ç”¨ä¸€ä¸ª linuxçš„network namespaceã€‚Podå†…çš„å…¶ä»–å®¹å™¨å…±äº«è¿™ä¸ªnetwork namespaceã€‚æ­¤æ—¶ï¼Œåªæœ‰ä¸€ä¸ªloè®¾å¤‡ã€‚ CNIè´Ÿè´£åˆå§‹åŒ–pause container ä¸­çš„ç½‘ç»œè®¾å¤‡ã€‚\nkubernetesä¸»æœºå†…ç»„ç½‘\u0026amp;è·¨èŠ‚ç‚¹ç»„ç½‘ kubernetes ç»å…¸çš„ä¸»æœºå†…ç»„ç½‘æ¨¡å‹æ˜¯veth pair+bridgeã€‚\nè·¨æœºé€šä¿¡ä¸€èˆ¬æ˜¯bridge + overlayã€‚ vxlan\ndownward API é€šè¿‡HostAliasä¿®æ”¹podä¸­çš„/etc/host(Podåœ¨host networkä¸‹ä¸æ”¯æŒ)\nPodçš„éš”ç¦»ä¸­ network namspce æ˜¯æœ€å…ˆåˆ›å»ºçš„ï¼Œå¦‚æœnsä½¿ç”¨äº†hostæ¨¡å¼ï¼Œåˆ™utsä¹Ÿä¼šä½¿ç”¨hostæ¨¡å¼ã€‚\nPauseæ‰®æ¼”PID 1çš„è§’è‰²ï¼Œå¹¶åœ¨å­è¿›ç¨‹æˆä¸ºâ€œå­¤å„¿è¿›ç¨‹â€æ—¶ï¼Œé€šè¿‡wait() æ”¶å‰²è¿™äº›åƒµå°¸å­è¿›ç¨‹ã€‚","tags":null,"title":""},{"categories":null,"contents":"æ–‡ä»¶æƒé™ æ–‡ä»¶æƒé™è¡¨ç¤º 1drwxrwxrwx 3 root wheel 96 Oct 13 20:30 opt 2drwxr-xr-x 6 root wheel 192 Oct 8 18:57 private 3drwxr-xr-x@ 64 root wheel 2048 Oct 8 18:55 sbin ã€æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‘ã€owneræƒé™ã€‘ã€groupæƒé™ã€‘ã€othersæƒé™ã€‘ã€ æ–‡ä»¶æ•°é‡ã€‘ ã€æ–‡ä»¶æ‰€æœ‰è€…ã€‘ã€æ–‡ä»¶æ‰€åœ¨ç»„ã€‘ã€æ–‡ä»¶å¤¹æœ€åæ“ä½œæ—¥æœŸå’Œæ—¶é—´ã€‘\nd è¡¨ç¤ºæ–‡ä»¶ç±»å‹ä¸º æ–‡ä»¶å¤¹ ï¼Œ - è¡¨ç¤ºæ–‡ä»¶ç±»å‹ä¸º æ–‡æœ¬æ–‡ä»¶ï¼Œ l è¡¨ç¤ºé“¾æ¥æ–‡ä»¶ r è¯»æƒé™read 4, w å†™æƒé™write 2, x æ“ä½œæƒé™execute 1 : rwx æŒ‰äºŒè¿›åˆ¶ä½ç½® 111ï¼Œ æ‰€ä»¥å¯¹åº” 421 ä¿®æ”¹æ–‡ä»¶æƒé™ 1chmod æƒé™æ•°å­— æ–‡ä»¶å 2chmod -R 744 /mnt/fileA # è¡¨ç¤ºå°†æ•´ä¸ª/mnt/fileAç›®å½•ä¸å…¶ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•çš„æƒé™éƒ½è®¾ç½®ä¸º744 3chmod o w xxx.xxx #è¡¨ç¤ºç»™å…¶ä»–äººæˆäºˆå†™xxx.xxxè¿™ä¸ªæ–‡ä»¶çš„æƒé™ 4chmod go-rw xxx.xxx #è¡¨ç¤ºåˆ é™¤xxx.xxxä¸­ç»„ç¾¤å’Œå…¶ä»–äººçš„è¯»å’Œå†™çš„æƒé™ 5 6# u ä»£è¡¨æ‰€æœ‰è€…ï¼ˆuserï¼‰ 7# g ä»£è¡¨æ‰€æœ‰è€…æ‰€åœ¨çš„ç»„ç¾¤ï¼ˆgroupï¼‰ 8# o ä»£è¡¨å…¶ä»–äººï¼Œä½†ä¸æ˜¯uå’Œg ï¼ˆotherï¼‰ 9# a ä»£è¡¨å…¨éƒ¨çš„äººï¼Œä¹Ÿå°±æ˜¯åŒ…æ‹¬uï¼Œgå’Œo 10# r è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«è¯»ï¼ˆreadï¼‰ 4 11# w è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«å†™ï¼ˆwriteï¼‰2 12# x è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«æ‰§è¡Œï¼ˆå¦‚æœå®ƒæ˜¯ç¨‹åºçš„è¯ï¼‰1 13# - è¡¨ç¤ºæ²¡æœ‰ä»»ä½•æƒé™ 0 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/chmod/","summary":"æ–‡ä»¶æƒé™ æ–‡ä»¶æƒé™è¡¨ç¤º 1drwxrwxrwx 3 root wheel 96 Oct 13 20:30 opt 2drwxr-xr-x 6 root wheel 192 Oct 8 18:57 private 3drwxr-xr-x@ 64 root wheel 2048 Oct 8 18:55 sbin ã€æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‘ã€owneræƒé™ã€‘ã€groupæƒé™ã€‘ã€othersæƒé™ã€‘ã€ æ–‡ä»¶æ•°é‡ã€‘ ã€æ–‡ä»¶æ‰€æœ‰è€…ã€‘ã€æ–‡ä»¶æ‰€åœ¨ç»„ã€‘ã€æ–‡ä»¶å¤¹æœ€åæ“ä½œæ—¥æœŸå’Œæ—¶é—´ã€‘\nd è¡¨ç¤ºæ–‡ä»¶ç±»å‹ä¸º æ–‡ä»¶å¤¹ ï¼Œ - è¡¨ç¤ºæ–‡ä»¶ç±»å‹ä¸º æ–‡æœ¬æ–‡ä»¶ï¼Œ l è¡¨ç¤ºé“¾æ¥æ–‡ä»¶ r è¯»æƒé™read 4, w å†™æƒé™write 2, x æ“ä½œæƒé™execute 1 : rwx æŒ‰äºŒè¿›åˆ¶ä½ç½® 111ï¼Œ æ‰€ä»¥å¯¹åº” 421 ä¿®æ”¹æ–‡ä»¶æƒé™ 1chmod æƒé™æ•°å­— æ–‡ä»¶å 2chmod -R 744 /mnt/fileA # è¡¨ç¤ºå°†æ•´ä¸ª/mnt/fileAç›®å½•ä¸å…¶ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•çš„æƒé™éƒ½è®¾ç½®ä¸º744 3chmod o w xxx.xxx #è¡¨ç¤ºç»™å…¶ä»–äººæˆäºˆå†™xxx.","tags":null,"title":""},{"categories":null,"contents":"https://www.jianshu.com/p/a6c6f47a5ef7\nhttps://blog.csdn.net/weixin_42096901/article/details/103017044\nhttps://blog.csdn.net/weixin_39406430/article/details/123715072\nhttp://t.zoukankan.com/yangyongjie-p-14576216.html\nhttps://zhuanlan.zhihu.com/p/430848775\nhttps://blog.csdn.net/weixin_42340926/article/details/126211173\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/linux_zero_copy/","summary":"https://www.jianshu.com/p/a6c6f47a5ef7\nhttps://blog.csdn.net/weixin_42096901/article/details/103017044\nhttps://blog.csdn.net/weixin_39406430/article/details/123715072\nhttp://t.zoukankan.com/yangyongjie-p-14576216.html\nhttps://zhuanlan.zhihu.com/p/430848775\nhttps://blog.csdn.net/weixin_42340926/article/details/126211173","tags":null,"title":""},{"categories":null,"contents":"1title: Linux Network Virtualization Network Namespace In order to provide the isolation, Linux has 6 namespaces to split the different resources, shown as follows:\nNamespace Description Mount Namespace File system mount point CLONE_NEWNET UTS Namespace Hostname CLONE_NETUTS IPC Namespace POSIX process messaging queue CLONE_NEWIPC PID Namespace Process PID number namespace CLONE_NEWPID Network Namespace IP address/Port/Router/IPtables CLONE_NEWNS User Namespace User isolation CLONE_NEWUSER For the process, if they want to use the resources of the Namespace, they should enter the namespace first. And the resources don\u0026rsquo;t share between different namespaces.\nNetwork Namespace Overview You can use ip netns to manage the Network Namespace, or you can write C code to operate the Network Namespace through the system call. We can use clone()(a extend for fork()) to create a usual Namespace, and specify the parameter CLONE_NEWNET to create a Network Namespace.\n1ip netns add netns1 After you created the namespace, you can use ip netns show or ip netns list to check the result. At the same time, a file named netns1 is created at /var/run/netns/netns1, this is the Mount Point. On the one hand, this file is for managing the namespace, on the other hand, even if no process running in the namespace, the namespace still exists.\nOnce the Network Namespace is created, you can use ip netns exec \u0026lt;namespace\u0026gt; \u0026lt;command\u0026gt; to enter it to do some configuration.\nFor example,\n1# run bash in network namespace \u0026lt;netns1\u0026gt; 2ip netns exec netns1 bash 3 4# get the network interface of the network namespace \u0026lt;netns1\u0026gt; 5ip net exec netns1 ip link list After you create a Network Namespace, it contains a Loopback Interface at least.\nIf you want to delete the Network Namespace, try\n1ip netns delete netns1 Noted, actually, the above command does not totally delete the Network Namespace, this only removed the Mount Point. If there is any process still running, the Network Namespace will still exist.\nConfiguration When we talk about the network communication of the processes in the Network Namespace, the Virtual/Actual Network Device is required.\nThe new Network Namespace only contains a Loopback Interface, and the status of this interface is DOWN. After setting the loup, you can ping 127.0.0.1 and get the response.\nBut, if we want to contact the outside, we need to create a couple of virtual ether network cards, it\u0026rsquo;s the veth pair. Veth pair always presents in couples. It was like a two-way pipe, the datagram went into one side, and came out from another side.\nLet\u0026rsquo;s create a veth pair, and put one side into the netns1.\n1# create a veth pair veth0-veth1 2ip link add veth0 type veth peer name veth1 3# mv veth1 to netns1 network namespace 4ip link set veth1 netns netns1 After that, we created 2 veth interface. But these are in DOWNstatus. Next, we set them up and bind an IP to the interface.\n1ip netns exec netns1 ifconfig veth1 10.1.1.1/24 up 2ifconfig veth0 10.1.1.2/up Now, you can ping 10.1.1.1 on the host.\nThe route table and IPtables are different between different Network Namespace.\nWhen we enter the netns1 Network Namespace, the route table and IPtables are empty. So, when you are in the netns1 you can\u0026rsquo;t connect to the Internet. There are several ways to solve that:\nCreate a Linux bridge on the host, and bind one side of the veth pair to the bridge\nAdd NAT rule on the host and enable Linux IP forward.\n1# enable or disable IP forwarding status 2sysctl -w net.ipv4.ip_forward=0 3# OR 4sysctl -w net.ipv4.ip_forward=1 5 6# check the IP forwarding status 7cat /proc/sys/net/ipv4/ip_forward 80 Note\nUsers can put the physical/virtual network device to any network namespace, and one device only can be put into one Network Namespace.\nThe process can enter the Network Namespace through the Linux System Call clone()/unshare()/setns(). No-root process in a specific Network Namespace only can assess and config the local Network Namespace.\nThe root process can create a network device in the Network Namespace. And, root process can put the local Network Namespace\u0026rsquo;s device in another namespace.\n1# move interface form netns1 to PID=1 2ip net exec netns1 ip link set veth1 netns 1 The above command moves the veth1 interface from netns1 to host default Network namespace.\nFor the root user of the network namespace, they can move the network device to any Network Namespace, even the host network namespace. So, there will be a potential risk. If users want to avoid the risk, they need to combine the PID Namespace and Mount Namespace to make the Network Namespace totally isolated.\nHow do combine the PID Namespace and Mount Namespace to make the Network Namespace totally isolated?\nNetwork Namespace API The API is related with Linux System Call: clone() unshare() setns() and file in /proc. This chapter will introduce the usage of the network namespace API through several examples.\nclone() unshare() setns() use the const variable CLONE_NEW* to represent different namespace:\nNamespace Description Mount Namespace File system mount point CLONE_NEWNS UTS Namespace Hostname CLONE_NEWUTS IPC Namespace POSIX process messaging queue CLONE_NEWIPC PID Namespace Process PID number namespace CLONE_NEWPID Network Namespace IP address/Port/Router/IPtables CLONE_NEWNET User Namespace User isolation CLONE_NEWUSER Create namespace through clone() 1int clone(int (*child_func)(void *), void *child_stack, int flags, void *arg); clone() is an extension of fork(), we can control the function through the flags parameter. clone()has more than 20 CLONE_* flag to control the processes\u0026rsquo; actions.\nIf set a flag CLONE_NEW, the system will create a corresponding type namespace and a new process and put the process into the new Namespace. Through | we can specify multiple CLONE_NEW flags.\nThe parameters\u0026rsquo; meaning, from left to right\nFunction point child_func, specify a new function for the new process. When the function returned, the child process ended. This function returns an integer value to represent the exit code. Point child_stack is put into the child process\u0026rsquo;s stack, another word, put user-mode stack point to child process\u0026rsquo;s esp register. The process that calls clone() needs to allocate a new stack to the child process. Int flags represent the CLONE_* flag, which can be multiply connected with |. args is the user-defined parameter. Finally, you should pay attention to the authorization and safety, most of the Namespace creates need the system capability, which not should be total root permission, but need CAP_SYS_ADMIN to execute the essential System Call.\nLinux çš„ç‰¹æƒæ˜¯å°†rootçš„æƒé™åˆ†ä¸ºå„ä¸ªå°éƒ¨åˆ†ï¼Œä½¿å¾—ä¸€ä¸ªè¿›ç¨‹åªéœ€è¦è¢«æˆäºˆåˆšåˆšå¥½çš„æƒé™æ¥æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ã€‚å¦‚æœè¿™äº›ç‰¹æƒè¶³å¤Ÿå°ï¼Œä¸”é€‰æ‹©çš„æ°åˆ°å¥½å¤„ï¼Œé‚£ä¹ˆå³ä½¿ä¸€ä¸ªè¿›ç¨‹å—æŸï¼ˆæ¯”å¦‚ç¼“å†²åŒºæº¢å‡ºï¼‰ï¼Œå®ƒæ‰€é€ æˆçš„å±å®³ä¹Ÿä¼šå—é™äºå®ƒæ‰€æ‹¥æœ‰çš„çš„ç‰¹æƒã€‚ ä¾‹å¦‚ï¼ŒCAP_KILL å…è®¸å‘ä»»æ„çš„è¿›ç¨‹å‘é€ä¿¡å·ï¼Œ è€ŒCAP_SYS_TIMEå…è®¸è¿›ç¨‹è®¾ç½®ç³»ç»Ÿçš„æ—¶é’Ÿã€‚\nKeep namespace existing Every process has its own /proc/PID/ns, and every file in this path represents a type of namespace.\nBefore Linux Kernel v3.8, the file in this path is a hard link, and only has IPC, nets, and uts. After v3.8, every file is a special symbolic link file and these files provide a way to operate the namespace related to the process.\n1ls -l /proc/$$/ns # $$ is the PID of bash One of the symbolic link file\u0026rsquo;s usage is to show if two processes use the same namespace. If two processes are in the same namespace, the inode number on the symbolic link file should be the same. (You can through stat()to get the inode number in st_ino )\n1#define _GNU_SOURCE 2#define NULL 0x0 3#include \u0026lt;sys/types.h\u0026gt; 4#include \u0026lt;sys/wait.h\u0026gt; 5#include \u0026lt;sys/mount.h\u0026gt; 6#include \u0026lt;stdio.h\u0026gt; 7#include \u0026lt;sched.h\u0026gt; 8#include \u0026lt;signal.h\u0026gt; 9#include \u0026lt;unistd.h\u0026gt; 10#include \u0026lt;stdlib.h\u0026gt; 11 12#define STACK_SIZE (1024 * 1024) 13 14// sync primitive 15int checkpoint[2]; 16 17static char child_stack[STACK_SIZE]; 18char *const child_args[] = { 19 \u0026#34;/bin/bash\u0026#34;, 20 NULL}; 21 22int child_main(void *arg) 23{ 24 char c; 25 26 // init sync primitive 27 printf(\u0026#34;\u0026gt;\u0026gt; wait for signal\u0026#34;); 28 close(checkpoint[1]); 29 printf(\u0026#34;\u0026gt;\u0026gt; receive signal\u0026#34;); 30 31 // setup hostname 32 printf(\u0026#34;- [%5d] World !\\n\u0026#34;, getpid()); 33 sethostname(\u0026#34;In Namespace\u0026#34;, 12); 34 35 // remount \u0026#34;/proc\u0026#34; to get accurate \u0026#34;top\u0026#34; \u0026amp;\u0026amp; \u0026#34;ps\u0026#34; output 36 mount(\u0026#34;proc\u0026#34;, \u0026#34;/proc\u0026#34;, \u0026#34;proc\u0026#34;, 0, NULL); 37 38 // wait for network setup in parent 39 read(checkpoint[0], \u0026amp;c, 1); 40 41 // setup network 42 system(\u0026#34;ip link set lo up\u0026#34;); 43 system(\u0026#34;ip link set veth1 up\u0026#34;); 44 system(\u0026#34;ip addr add 192.168.0.2/24 dev veth1\u0026#34;); 45 execv(child_args[0], child_args); 46 printf(\u0026#34;Oops \\n\u0026#34;); 47 return 1; 48} 49 50int main() 51{ 52 // init sync primitive 53 pipe(checkpoint); 54 55 printf(\u0026#34;- [%5d] Hello ?\\n\u0026#34;, getpid()); 56 57 int child_pid = clone(child_main, child_stack + STACK_SIZE, 58 CLONE_NEWUTS | CLONE_NEWIPC | CLONE_NEWPID | CLONE_NEWNS | CLONE_NEWNET | SIGCHLD, NULL); 59 60 // further init; create a veth pair 61 char *cmd; 62 asprintf(\u0026amp;cmd, \u0026#34;ip link set veth1 netns %d\u0026#34;, child_pid); 63 system(\u0026#34;ip link add veth0 type veth peer name veth1\u0026#34;); 64 system(cmd); 65 system(\u0026#34;ip link set veth0 up\u0026#34;); 66 system(\u0026#34;ip addr add 192.168.0.1/24 dev veth0\u0026#34;); 67 free(cmd); 68 69 // single \u0026#34;done\u0026#34; 70 close(checkpoint[1]); 71 printf(\u0026#34;\u0026gt;\u0026gt;\u0026gt; signal done\u0026#34;); 72 73 waitpid(child_pid, NULL, 0); 74 return 0; 75} NC command\nuse for network test\nC primitive\nVeth Pair The principle of Veth Pair is that put data into one side of the veth pair, and get out from another side.\nThe kernel code if veth pair Relationship between container and veth pair The typical model of the container network is veth pair + bridge. The interface in the container eth0 is a peer of the host veth interface. So, how to find which is the peer interface?\nMethod 1:\nFirst, in the target container find that,\n1cat /sys/class/net/eth0/iflink And then check all the files on the host /sys/class/net/,check the ifindex value which is the same as the iflink. The interface with the same value is another side of the veth pair.\nMethod 2\nLinux Bridge What is Linux Bridge Create and Manage the Linux Bridge\n1ip link add name br0 type bridge 2ip link set br0 up Besides the ip command, we can use the brctl tool in the bridge-utils package to create a bridge.\n1brctl addr br0 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_virtualization/","summary":"1title: Linux Network Virtualization Network Namespace In order to provide the isolation, Linux has 6 namespaces to split the different resources, shown as follows:\nNamespace Description Mount Namespace File system mount point CLONE_NEWNET UTS Namespace Hostname CLONE_NETUTS IPC Namespace POSIX process messaging queue CLONE_NEWIPC PID Namespace Process PID number namespace CLONE_NEWPID Network Namespace IP address/Port/Router/IPtables CLONE_NEWNS User Namespace User isolation CLONE_NEWUSER For the process, if they want to use the resources of the Namespace, they should enter the namespace first.","tags":null,"title":""},{"categories":null,"contents":"Hi, Kural,\nAbout the IPV6 SFC, the following is my debug process.\nNow, the func CalculateRoutes() can genarate the create route to the pod, but can\u0026rsquo;t add to the corresponding pod.\nThe calculated result for the sfc-head pod:\nBut for the agent pod, while adding routes to the container through func ContainerAddRoute() failed. Because in this function, it will get the host network configuration to find the default gateway, to add an extra route to the host network through the default gateway on the host. If the host is without an IPV6 default gateway will cause the failure.\nSo, I think this path will work normally with the host in an ipv6 environment.\nSo, shall we still work to fix it? make it suitable for the host not to run in an IPV6 environment, Or just test this patch in an IPv6 fully support host machine.\nOr, Could this work transfer to the NEX team colleagues, I can help the finish the test in IPV6 env or host to fix it and make it suitable for Dual-Stacks.\nThe attachment is the log of operator and agent.\nipv4 and ipv6 are not isolated in the code, somewhere use hard code to disparate that, and this could be a potential risk.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/nodus/ipv6-debug/","summary":"Hi, Kural,\nAbout the IPV6 SFC, the following is my debug process.\nNow, the func CalculateRoutes() can genarate the create route to the pod, but can\u0026rsquo;t add to the corresponding pod.\nThe calculated result for the sfc-head pod:\nBut for the agent pod, while adding routes to the container through func ContainerAddRoute() failed. Because in this function, it will get the host network configuration to find the default gateway, to add an extra route to the host network through the default gateway on the host.","tags":null,"title":""},{"categories":null,"contents":"for containerd\nfor crio\nfor docker\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/nodus/k8s-install-script/","summary":"for containerd\nfor crio\nfor docker","tags":null,"title":""},{"categories":null,"contents":"fork create process\nfork è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå¯ä»¥è¿”å›ä¸¤æ¬¡ã€‚\nåœ¨è°ƒç”¨forkä¹‹åçš„ä»£ç ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨çˆ¶è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œè¿”å›çš„æ˜¯åˆ›å»ºæˆåŠŸçš„å­è¿›ç¨‹çš„Idï¼Œä¸€æ¬¡æ˜¯åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œè¿”å›çš„æ˜¯0ï¼›å¦‚æœå‡ºç°é”™è¯¯ï¼Œforkè¿”å›çš„æ˜¯è´Ÿå€¼ã€‚\n1/*linuxä¸‹ï¼š*/ 2 3#include \u0026lt;stdio.h\u0026gt; 4#include \u0026lt;unistd.h\u0026gt; 5 6int main() { 7 pid_t pid; 8 pid = fork(); 9 if(pid == 0) //è¿”å›å­è¿›ç¨‹ 10 { 11 printf(\u0026#34;child pid: %d\\n\u0026#34;, getpid()); 12 } else { 13 printf(\u0026#34;pid: %d\\n\u0026#34;, pid);//çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„pid 14 printf(\u0026#34;father pid: %d\\n\u0026#34;, getpid()); 15 } 16} 1pid: 2876921 2father pid: 2876920 3child pid: 2876921 forkçš„ä¸¤ç§ç”¨æ³•\nçˆ¶è¿›ç¨‹å¸Œæœ›å¤åˆ¶è‡ªå·±ï¼Œä½¿çˆ¶å­è¿›ç¨‹åŒæ—¶æ‰§è¡Œä¸åŒçš„ä»£ç æ®µã€‚\næ¯”å¦‚åœ¨ç½‘ç»œæœåŠ¡ç¨‹åºä¸­ï¼Œçˆ¶è¿›ç¨‹ç­‰å¾…å®¢æˆ·ç«¯çš„æœåŠ¡è¯·æ±‚ã€‚å½“è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨fork()ä½¿å­è¿›ç¨‹å¤„ç†æ­¤è¯·æ±‚ï¼›è€Œçˆ¶è¿›ç¨‹ç»§ç»­ç­‰å¾…ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚\nä¸€ä¸ªè¿›ç¨‹è¦æ‰§è¡Œä¸åŒçš„ç¨‹åº\nè¿™ä¸ªåœ¨shellä¸‹æ¯”è¾ƒå¸¸è§ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œ fork()ä¹‹åä¸€èˆ¬ç«‹å³æ¥execå‡½æ•°ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_c/c_process/","summary":"fork create process\nfork è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå¯ä»¥è¿”å›ä¸¤æ¬¡ã€‚\nåœ¨è°ƒç”¨forkä¹‹åçš„ä»£ç ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨çˆ¶è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œè¿”å›çš„æ˜¯åˆ›å»ºæˆåŠŸçš„å­è¿›ç¨‹çš„Idï¼Œä¸€æ¬¡æ˜¯åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œè¿”å›çš„æ˜¯0ï¼›å¦‚æœå‡ºç°é”™è¯¯ï¼Œforkè¿”å›çš„æ˜¯è´Ÿå€¼ã€‚\n1/*linuxä¸‹ï¼š*/ 2 3#include \u0026lt;stdio.h\u0026gt; 4#include \u0026lt;unistd.h\u0026gt; 5 6int main() { 7 pid_t pid; 8 pid = fork(); 9 if(pid == 0) //è¿”å›å­è¿›ç¨‹ 10 { 11 printf(\u0026#34;child pid: %d\\n\u0026#34;, getpid()); 12 } else { 13 printf(\u0026#34;pid: %d\\n\u0026#34;, pid);//çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„pid 14 printf(\u0026#34;father pid: %d\\n\u0026#34;, getpid()); 15 } 16} 1pid: 2876921 2father pid: 2876920 3child pid: 2876921 forkçš„ä¸¤ç§ç”¨æ³•\nçˆ¶è¿›ç¨‹å¸Œæœ›å¤åˆ¶è‡ªå·±ï¼Œä½¿çˆ¶å­è¿›ç¨‹åŒæ—¶æ‰§è¡Œä¸åŒçš„ä»£ç æ®µã€‚\næ¯”å¦‚åœ¨ç½‘ç»œæœåŠ¡ç¨‹åºä¸­ï¼Œçˆ¶è¿›ç¨‹ç­‰å¾…å®¢æˆ·ç«¯çš„æœåŠ¡è¯·æ±‚ã€‚å½“è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨fork()ä½¿å­è¿›ç¨‹å¤„ç†æ­¤è¯·æ±‚ï¼›è€Œçˆ¶è¿›ç¨‹ç»§ç»­ç­‰å¾…ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚\nä¸€ä¸ªè¿›ç¨‹è¦æ‰§è¡Œä¸åŒçš„ç¨‹åº\nè¿™ä¸ªåœ¨shellä¸‹æ¯”è¾ƒå¸¸è§ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œ fork()ä¹‹åä¸€èˆ¬ç«‹å³æ¥execå‡½æ•°ã€‚","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_c/unix_socket/","summary":"","tags":null,"title":""},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/1st--/","summary":"","tags":null,"title":""},{"categories":null,"contents":"ç±»å‹ 2.1 å˜é‡ æ ‡è¯†ç¬¦ä¸å…³é”®å­— æ ‡è¯†ç¬¦ åœ¨ç¼–ç¨‹è¯­è¨€ä¸­æ ‡è¯†ç¬¦å°±æ˜¯ç¨‹åºå‘˜å®šä¹‰çš„å…·æœ‰ç‰¹æ®Šæ„ä¹‰çš„è¯ï¼Œæ¯”å¦‚å˜é‡åã€å¸¸é‡åã€å‡½æ•°åç­‰ç­‰ã€‚ Goè¯­è¨€ä¸­æ ‡è¯†ç¬¦ç”±å­—æ¯æ•°å­—å’Œ_(ä¸‹åˆ’çº¿ï¼‰ç»„æˆï¼Œå¹¶ä¸”åªèƒ½ä»¥å­—æ¯å’Œ_å¼€å¤´ã€‚ ä¸¾å‡ ä¸ªä¾‹å­ï¼šabc, _, _123, a123ã€‚\nå…³é”®å­— å…³é”®å­—æ˜¯æŒ‡ç¼–ç¨‹è¯­è¨€ä¸­é¢„å…ˆå®šä¹‰å¥½çš„å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„æ ‡è¯†ç¬¦ã€‚ å…³é”®å­—å’Œä¿ç•™å­—éƒ½ä¸å»ºè®®ç”¨ä½œå˜é‡åã€‚\nGoè¯­è¨€ä¸­æœ‰25ä¸ªå…³é”®å­—ï¼š\n1 break default func interface select 2 case defer go map struct 3 chan else goto package switch 4 const fallthrough if range type 5 continue for import return var æ­¤å¤–ï¼ŒGoè¯­è¨€ä¸­è¿˜æœ‰37ä¸ªä¿ç•™å­—ã€‚\n1 Constants: true false iota nil 2 3 Types: int int8 int16 int32 int64 4 uint uint8 uint16 uint32 uint64 uintptr 5 float32 float64 complex128 complex64 6 bool byte rune string error 7 8 Functions: make len cap new append copy close delete 9 complex real imag 10 panic recover go è¯­è¨€ä¸­çš„å˜é‡å¿…é¡»å…ˆå£°æ˜å†ä½¿ç”¨ã€‚\n1package main 2 3// å¯¼å…¥è¯­å¥ 4import \u0026#34;fmt\u0026#34; 5 6// å‡½æ•°å¤–åªèƒ½æ”¾ç½®æ ‡è¯†ç¬¦(å¸¸é‡/å˜é‡/å‡½æ•°/ç±»å‹)ï¼Œä¸èƒ½æ”¾ç½®è¯­å¥ 7// fmt.Println(\u0026#34;hello world\u0026#34;) // éæ³•è¯­å¥ 8 9// ç¨‹åºå…¥å£å‡½æ•° 10func main() { 11\tvar s string 12\t// s = \u0026#34;hello\u0026#34; 13\tfmt.Println(s) 14\tfmt.Println(\u0026#34;hello\u0026#34;) 15\tfmt.Printf(\u0026#34;name: %s\u0026#34;, s) 16} è¿è¡Œæ—¶å†…å­˜åˆ†é…æ“ä½œä¼šç¡®ä¿å˜é‡è‡ªåŠ¨åŒ–åˆå§‹ä¸ºäºŒè¿›åˆ¶é›¶å€¼(zero value), é¿å…å‡ºç°ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚\n1var x int // è‡ªåŠ¨åŒ–åˆå§‹ä¸º0 2var y = false // è‡ªåŠ¨æ¨æ–­ä¸ºboolç±»å‹ 3 4var x,y int // ç›¸åŒç±»å‹å¤šä¸ªå˜é‡ 5 6// å»ºè®®ä»¥ç»„çš„æ–¹å¼æ•´ç†å¤šè¡Œå˜é‡å®šä¹‰ 7var{ 8 x,y int 9 a,s = 100,\u0026#34;abc\u0026#34; 10} ç®€çŸ­æ¨¡å¼ short variable declaration å®šä¹‰å˜é‡åŒæ—¶æ˜¾å¼åˆå§‹åŒ– ä¸èƒ½æä¾›æ•°æ®ç±»å‹ åªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ 1 2 3func main(){ 4 x := 100 5 a,s := 1, \u0026#34;adc\u0026#34; 6} ç®€çŸ­æ¨¡å¼å¹¶ä¸æ€»æ˜¯é‡æ–°å®šä¹‰å˜é‡ï¼Œä¹Ÿå¯èƒ½æ˜¯éƒ¨åˆ†é€€åŒ–çš„èµ‹å€¼æ“ä½œ\n1func main(){ 2 x := 100 3 print(\u0026amp;x) 4 5 x, y := 200,\u0026#34;abc\u0026#34; 6 println(\u0026amp;x, x) 7 println(y) 8} é€€åŒ–èµ‹å€¼çš„æ¡ä»¶æ˜¯ï¼šæœ€å°‘æœ‰ä¸€ä¸ªæ–°çš„å˜é‡è¢«å®šä¹‰ï¼Œä¸”å¿…é¡»æ˜¯åŒä¸€ä½œç”¨åŸŸ\nåœ¨å¤„ç†å‡½æ•°é”™è¯¯è¿”å›å€¼æ—¶ï¼Œé€€åŒ–èµ‹å€¼å…è®¸æˆ‘ä»¬é‡å¤ä½¿ç”¨errå˜é‡\nå¤šå˜é‡èµ‹å€¼ åœ¨è¿›è¡Œå¤šå˜é‡èµ‹å€¼æ—¶ï¼Œé¦–å…ˆè®¡ç®—å‡ºæ‰€æœ‰çš„å³å€¼ï¼Œç„¶åå†ä¾æ¬¡å®Œæˆèµ‹å€¼æ“ä½œ\ngo tool objdump -s \u0026quot;main/.main\u0026quot; test\næœªä½¿ç”¨é”™è¯¯ ç¼–è¯‘å™¨å°†æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡å½“åšé”™è¯¯ã€‚\nå…¨å±€å˜é‡æ²¡é—®é¢˜\n2.2 å‘½å å‘½åå»ºè®® å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿å¼€å§‹ åŒºåˆ†å¤§å°å†™ ä½¿ç”¨é©¼å³°æ ¼å¼ å±€éƒ¨å˜é‡ä¼˜å…ˆä½¿ç”¨çŸ­åå­— ä¸“æœ‰åè¯å¤§å†™ Go æ”¯æŒç”¨æ±‰å­—ç­‰Unicodeå­—ç¬¦å‘½å\n1func main(){ 2\tvar c int 3 for i :=0; i\u0026lt;10;i++{ 4 c++ 5 } 6} ç¬¦å·åå­— é¦–å­—æ¯å¤§å°å†™å†³å®šäº†å…¶ä½œç”¨åŸŸ\né¦–å­—æ¯å¤§å†™çš„ä¸ºå¯¼å‡ºæˆå‘˜ï¼Œå¯ä»¥è¢«åŒ…å¤–å¼•ç”¨ï¼Œè€Œå°å†™ä»…èƒ½åœ¨åŒ…å†…ä½¿ç”¨ã€‚\nç©ºè¡¨ç¤ºç¬¦ \u0026ldquo;_\u0026rdquo; blank identifierã€‚ é€šå¸¸ä½œä¸ºå¿½ç•¥å ä½ç¬¦ä½¿ç”¨ï¼Œå¯åšè¡¨è¾¾å¼å·¦å€¼ï¼Œæ— æ³•è¯»å–å†…å®¹\n1import \u0026#34;strconv\u0026#34; 2func main(){ 3 x,_:=strcow.Atoi(\u0026#34;12\u0026#34;) 4 println(x) 5} ç©ºæ ‡è¯†ç¬¦å¯ä»¥ç”¨æ¥ä¸´æ—¶è§„é¿ç¼–è¯‘å™¨å¯¹æœªä½¿ç”¨å˜é‡å’Œå¯¼å…¥åŒ…çš„é”™è¯¯æ£€æŸ¥ã€‚æ˜¯é¢„ç½®æˆå‘˜ï¼Œä¸èƒ½é‡æ–°å®šä¹‰ã€‚\nåŒ¿åå˜é‡ ä¸å ç”¨å‘½åç©ºé—´ï¼Œä¸ä¼šåˆ†é…å†…å­˜ï¼Œæ‰€ä»¥åŒ¿åå˜é‡å­˜åœ¨é‡å¤å£°æ˜\nå‡½æ•°å¤–çš„æ¯ä¸ªè¯­å¥é€—å¿…é¡»ä»¥å…³é”®å­—å¼€å§‹const var func\nç±»å‹æ¨å¯¼ 1package main 2 3func main(){ 4 var a = 101 // aæ˜¯ int 5 b := int8(12) // b æ˜¯ int8 6 7 f := 1.2345 // é»˜è®¤Goè¯­è¨€ä¸­çš„å°æ•°éƒ½æ˜¯64ä½ 8 // float32 è½¬float32 è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä¸èƒ½ç›´æ¥èµ‹å€¼ 9 a := \u0026#39;å•¥\u0026#39; 10\tfmt.Printf(\u0026#34;%v\\n\u0026#34;,a) 11\tfmt.Printf(\u0026#34;%T\\n\u0026#34;,a) 12\tfmt.Printf(\u0026#34;%c\\n\u0026#34;,a) // å­—ç¬¦é»˜è®¤ç«Ÿç„¶æ˜¯ int32 13} 2.3 å¸¸é‡ å®šä¹‰å¸¸é‡ä¹‹åï¼Œåœ¨è¿è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜\nConst å¯ä»¥æ”¾åœ¨å…¨å±€çš„ä¹Ÿå¯ä»¥æ”¾åœ¨å±€éƒ¨çš„\n1const x,y int = 123, 0x22 2const s = \u0026#34;hello\u0026#34; å¯ä»¥åœ¨å‡½æ•°ä»£ç ä¸­å®šä¹‰å¸¸é‡ï¼Œä¸æ›¾ä½¿ç”¨çš„å¸¸é‡ä¸ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯\nå¸¸é‡å€¼å¯ä»¥ä½¿æŸäº›ç¼–è¯‘å™¨èƒ½è®¡ç®—å‡ºç»“æœçš„è¡¨è¾¾å¼\n1import \u0026#34;unsafe\u0026#34; 2const{ 3 ptrSize = unsafe.Sizeof(uintptr(0)) 4 strSize = len(\u0026#34;hello, world\u0026#34;) 5} æ‰¹é‡å£°æ˜\n1const( 2\ta = 1 3\tb 4\tc 5) 6// a,b,c å‡ä¸º100 iota iotaæ˜¯goè¯­è¨€çš„å¸¸é‡è®¡æ•°å™¨ï¼Œåªèƒ½åœ¨å¸¸é‡çš„è¡¨è¾¾å¼ä¸­ä½¿ç”¨ã€‚\niotaåœ¨constå…³é”®å­—å‡ºç°æ—¶å°†è¢«é‡ç½®ä¸º0ã€‚constä¸­æ¯æ–°å¢ä¸€è¡Œå¸¸é‡å£°æ˜å°†ä½¿iotaè®¡æ•°ä¸€æ¬¡(iotaå¯ç†è§£ä¸ºconstè¯­å¥å—ä¸­çš„è¡Œç´¢å¼•)ã€‚ ä½¿ç”¨iotaèƒ½ç®€åŒ–å®šä¹‰ï¼Œåœ¨å®šä¹‰æšä¸¾æ—¶å¾ˆæœ‰ç”¨ã€‚\nä¸¾ä¸ªä¾‹å­ï¼š\n1const ( 2\tn1 = iota //0 3\tn2 //1 4\tn3 //2 5\tn4 //3 6\t) å‡ ä¸ªå¸¸è§çš„iotaç¤ºä¾‹:\nä½¿ç”¨_è·³è¿‡æŸäº›å€¼\n1const ( 2\tn1 = iota //0 3\tn2 //1 4\t_ 5\tn4 //3 6\t) iotaå£°æ˜ä¸­é—´æ’é˜Ÿ\n1const ( 2\tn1 = iota //0 3\tn2 = 100 //100 4\tn3 = iota //2 5\tn4 //3 6\t) 7\tconst n5 = iota //0 å®šä¹‰æ•°é‡çº§ ï¼ˆè¿™é‡Œçš„\u0026lt;\u0026lt;è¡¨ç¤ºå·¦ç§»æ“ä½œï¼Œ1\u0026lt;\u0026lt;10è¡¨ç¤ºå°†1çš„äºŒè¿›åˆ¶è¡¨ç¤ºå‘å·¦ç§»10ä½ï¼Œä¹Ÿå°±æ˜¯ç”±1å˜æˆäº†10000000000ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„1024ã€‚åŒç†2\u0026lt;\u0026lt;2è¡¨ç¤ºå°†2çš„äºŒè¿›åˆ¶è¡¨ç¤ºå‘å·¦ç§»2ä½ï¼Œä¹Ÿå°±æ˜¯ç”±10å˜æˆäº†1000ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„8ã€‚ï¼‰\n1const ( 2\t_ = iota 3\tKB = 1 \u0026lt;\u0026lt; (10 * iota) 4\tMB = 1 \u0026lt;\u0026lt; (10 * iota) 5\tGB = 1 \u0026lt;\u0026lt; (10 * iota) 6\tTB = 1 \u0026lt;\u0026lt; (10 * iota) 7\tPB = 1 \u0026lt;\u0026lt; (10 * iota) 8\t) å¤šä¸ªiotaå®šä¹‰åœ¨ä¸€è¡Œ\n1const ( 2\ta, b = iota + 1, iota + 2 //1,2 3\tc, d //2,3 4\te, f //3,4 5\t) 5 æ¡è¯„è®º\næšä¸¾ 1const ( 2\tx = iota // 0 3 y 4 z 5) å±•å¼€ 1var x = 0x100 2const y = 0x200 3func main(){ 4 print(\u0026amp;x,x) 5 pront(\u0026amp;y, y ) // cannot take the address of y 6} ä¸åŒäºå˜é‡åœ¨è¿è¡ŒæœŸåˆ†é…å­˜å‚¨å†…å­˜(éä¼˜åŒ–çŠ¶æ€)ï¼Œ å¸¸é‡é€šå¸¸ä¼šè¢«ç¼–è¯‘å™¨åœ¨é¢„å¤„ç†é˜¶æ®µç›´æ¥å±•å¼€ï¼Œä½œä¸ºæŒ‡ä»¤æ•°æ®ä½¿ç”¨ã€‚\n1const y = 0x200 2 3func main(){ 4 print(y) 5} 1go build \u0026amp;\u0026amp; go tool objdump -s \u0026#34;main./main\u0026#34; test æ•°å­—å¸¸é‡ä¸ä¼šåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œ æ— é¡»åƒå˜é‡é‚£æ ·é€šè¿‡å†…å­˜å¯»å€æ¥å–å€¼ï¼Œå› æ­¤æ— æ³•è·å–åœ°å€ã€‚\né‰´äºGoå½“å‰å¯¹åŠ¨æ€åº“çš„æ”¯æŒè¿˜ä¸å®Œå–„ï¼Œæ˜¯å¦å­˜åœ¨\u0026quot;å¸¸é‡é™·é˜±\u0026quot;çš„é—®é¢˜è¿˜æœ‰å¾…è§‚å¯Ÿ\n2.4 åŸºæœ¬ç±»å‹ å ä½ç¬¦ ç±»å‹ %s å­—ç¬¦ä¸² %b äºŒè¿›åˆ¶ %o å…«è¿›åˆ¶ %d åè¿›åˆ¶ %x åå…­è¿›åˆ¶ %T æ•°æ®çš„ç±»å‹ %.2f æµ®ç‚¹å‹æ•°æ® %v value 1package main 2 3import \u0026#34;fmt\u0026#34; 4 5// fmtå ä½ç¬¦ 6func main() { 7\tvar n = 100 8\t// æŸ¥çœ‹ç±»å‹ 9\tfmt.Printf(\u0026#34;%T\\n\u0026#34;, n) 10\tfmt.Printf(\u0026#34;%v\\n\u0026#34;, n) 11\tfmt.Printf(\u0026#34;%b\\n\u0026#34;, n) 12\tfmt.Printf(\u0026#34;%d\\n\u0026#34;, n) 13\tfmt.Printf(\u0026#34;%o\\n\u0026#34;, n) 14\tfmt.Printf(\u0026#34;%x\\n\u0026#34;, n) 15\tvar s = \u0026#34;Hello æ²™æ²³ï¼\u0026#34; 16\tfmt.Printf(\u0026#34;å­—ç¬¦ä¸²ï¼š%s\\n\u0026#34;, s) 17\tfmt.Printf(\u0026#34;å­—ç¬¦ä¸²ï¼š%v\\n\u0026#34;, s) 18\tfmt.Printf(\u0026#34;å­—ç¬¦ä¸²ï¼š%#v\\n\u0026#34;, s) 19} å…«è¿›åˆ¶\u0026amp; åå…­è¿›åˆ¶ Goè¯­è¨€ä¸­æ— æ³•ç›´æ¥å®šä¹‰äºŒè¿›åˆ¶æ•°\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;math\u0026#34; 6) 7 8func main() { 9\ta, b, c := 100, 0144, 0x64 10\tprintln(a, b, c) 11\tfmt.Println(a, b, c) 12\tfmt.Printf(\u0026#34;0b%b, %#o, %#x\\n\u0026#34;, a, b, c) 13 14\tfmt.Println(math.MinInt8, math.MaxInt8) 15} strconv\n1package main 2 3import \u0026#34;strconv\u0026#34; 4 5func main() { 6\ta, _ := strconv.ParseInt(\u0026#34;1100100\u0026#34;, 2, 32) 7\tb, _ := strconv.ParseInt(\u0026#34;0144\u0026#34;, 8, 32) 8\tc, _ := strconv.ParseInt(\u0026#34;64\u0026#34;, 16, 32) 9 10\tprintln(a, b, c) 11 12\tprintln(\u0026#34;0b\u0026#34; + strconv.FormatInt(a, 2)) 13\tprintln(\u0026#34;0\u0026#34; + strconv.FormatInt(b, 8)) 14\tprintln(\u0026#34;0x\u0026#34; + strconv.FormatInt(c, 16)) 15 16} æµ®ç‚¹å‹ Goè¯­è¨€æ”¯æŒä¸¤ç§æµ®ç‚¹å‹æ•°ï¼šfloat32å’Œfloat64ã€‚è¿™ä¸¤ç§æµ®ç‚¹å‹æ•°æ®æ ¼å¼éµå¾ªIEEE 754æ ‡å‡†ï¼š float32 çš„æµ®ç‚¹æ•°çš„æœ€å¤§èŒƒå›´çº¦ä¸º 3.4e38ï¼Œå¯ä»¥ä½¿ç”¨å¸¸é‡å®šä¹‰ï¼šmath.MaxFloat32ã€‚ float64 çš„æµ®ç‚¹æ•°çš„æœ€å¤§èŒƒå›´çº¦ä¸º 1.8e308ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¸¸é‡å®šä¹‰ï¼šmath.MaxFloat64ã€‚\næ‰“å°æµ®ç‚¹æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨fmtåŒ…é…åˆåŠ¨è¯%fï¼Œä»£ç å¦‚ä¸‹ï¼š\n1package main 2import ( 3 \u0026#34;fmt\u0026#34; 4 \u0026#34;math\u0026#34; 5) 6func main() { 7 fmt.Printf(\u0026#34;%f\\n\u0026#34;, math.Pi) 8 fmt.Printf(\u0026#34;%.2f\\n\u0026#34;, math.Pi) 9} å¤æ•° complex64å’Œcomplex128\n1var c1 complex64 2c1 = 1 + 2i 3var c2 complex128 4c2 = 2 + 3i 5fmt.Println(c1) 6fmt.Println(c2) å¤æ•°æœ‰å®éƒ¨å’Œè™šéƒ¨ï¼Œcomplex64çš„å®éƒ¨å’Œè™šéƒ¨ä¸º32ä½ï¼Œcomplex128çš„å®éƒ¨å’Œè™šéƒ¨ä¸º64ä½ã€‚\nå¸ƒå°”å€¼ Goè¯­è¨€ä¸­ä»¥boolç±»å‹è¿›è¡Œå£°æ˜å¸ƒå°”å‹æ•°æ®ï¼Œå¸ƒå°”å‹æ•°æ®åªæœ‰trueï¼ˆçœŸï¼‰å’Œfalseï¼ˆå‡ï¼‰ä¸¤ä¸ªå€¼ã€‚\næ³¨æ„ï¼š\nå¸ƒå°”ç±»å‹å˜é‡çš„é»˜è®¤å€¼ä¸ºfalseã€‚ Go è¯­è¨€ä¸­ä¸å…è®¸å°†æ•´å‹å¼ºåˆ¶è½¬æ¢ä¸ºå¸ƒå°”å‹. å¸ƒå°”å‹æ— æ³•å‚ä¸æ•°å€¼è¿ç®—ï¼Œä¹Ÿæ— æ³•ä¸å…¶ä»–ç±»å‹è¿›è¡Œè½¬æ¢ã€‚ å­—ç¬¦ä¸² Goè¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ä»¥åŸç”Ÿæ•°æ®ç±»å‹å‡ºç°ï¼Œä½¿ç”¨å­—ç¬¦ä¸²å°±åƒä½¿ç”¨å…¶ä»–åŸç”Ÿæ•°æ®ç±»å‹ï¼ˆintã€boolã€float32ã€float64 ç­‰ï¼‰ä¸€æ ·ã€‚ Go è¯­è¨€é‡Œçš„å­—ç¬¦ä¸²çš„å†…éƒ¨å®ç°ä½¿ç”¨UTF-8ç¼–ç ã€‚ å­—ç¬¦ä¸²çš„å€¼ä¸ºåŒå¼•å·(\u0026quot;)ä¸­çš„å†…å®¹ï¼Œå¯ä»¥åœ¨Goè¯­è¨€çš„æºç ä¸­ç›´æ¥æ·»åŠ éASCIIç å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š\n1s1 := \u0026#34;hello\u0026#34; 2s2 := \u0026#34;ä½ å¥½\u0026#34; å­—ç¬¦ä¸²è½¬ä¹‰ç¬¦ Go è¯­è¨€çš„å­—ç¬¦ä¸²å¸¸è§è½¬ä¹‰ç¬¦åŒ…å«å›è½¦ã€æ¢è¡Œã€å•åŒå¼•å·ã€åˆ¶è¡¨ç¬¦ç­‰ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚\nè½¬ä¹‰ç¬¦ å«ä¹‰ \\r å›è½¦ç¬¦ï¼ˆè¿”å›è¡Œé¦–ï¼‰ \\n æ¢è¡Œç¬¦ï¼ˆç›´æ¥è·³åˆ°ä¸‹ä¸€è¡Œçš„åŒåˆ—ä½ç½®ï¼‰ \\t åˆ¶è¡¨ç¬¦ \\' å•å¼•å· \\\u0026quot; åŒå¼•å· \\\\ åæ–œæ  ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¦æ‰“å°ä¸€ä¸ªWindowså¹³å°ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼š\n1package main 2import ( 3 \u0026#34;fmt\u0026#34; 4) 5func main() { 6 fmt.Println(\u0026#34;str := \\\u0026#34;c:\\\\Code\\\\lesson1\\\\go.exe\\\u0026#34;\u0026#34;) 7} å¤šè¡Œå­—ç¬¦ä¸² Goè¯­è¨€ä¸­è¦å®šä¹‰ä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²æ—¶ï¼Œå°±å¿…é¡»ä½¿ç”¨åå¼•å·å­—ç¬¦ï¼š\n1s1 := `ç¬¬ä¸€è¡Œ 2ç¬¬äºŒè¡Œ 3ç¬¬ä¸‰è¡Œ 4` 5fmt.Println(s1) åå¼•å·é—´æ¢è¡Œå°†è¢«ä½œä¸ºå­—ç¬¦ä¸²ä¸­çš„æ¢è¡Œï¼Œä½†æ˜¯æ‰€æœ‰çš„è½¬ä¹‰å­—ç¬¦å‡æ— æ•ˆï¼Œæ–‡æœ¬å°†ä¼šåŸæ ·è¾“å‡ºã€‚\nå­—ç¬¦ä¸²çš„å¸¸ç”¨æ“ä½œ æ–¹æ³• ä»‹ç» len(str) æ±‚é•¿åº¦ +æˆ–fmt.Sprintf æ‹¼æ¥å­—ç¬¦ä¸² strings.Split åˆ†å‰² strings.contains åˆ¤æ–­æ˜¯å¦åŒ…å« strings.HasPrefix,strings.HasSuffix å‰ç¼€/åç¼€åˆ¤æ–­ strings.Index(),strings.LastIndex() å­ä¸²å‡ºç°çš„ä½ç½® strings.Join(a[]string, sep string) joinæ“ä½œ 1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;strings\u0026#34; 6) 7 8// å­—ç¬¦ä¸² 9 10func main() { 11\t// \\ æœ¬æ¥æ˜¯å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„ï¼Œæˆ‘åº”è¯¥å‘Šè¯‰ç¨‹åºæˆ‘å†™çš„\\å°±æ˜¯ä¸€ä¸ªå•çº¯çš„\\ 12\tpath := \u0026#34;\u0026#39;D:\\\\Go\\\\src\\\\code.oldboyedu.com\\\\studygo\\\\day01\u0026#39;\u0026#34; 13\tfmt.Println(path) 14 15\ts := \u0026#34;I\u0026#39;m ok\u0026#34; 16\tfmt.Println(s) 17\t// å¤šè¡Œçš„å­—ç¬¦ä¸² 18\ts2 := ` 19ä¸–æƒ…è–„ 20\täººæƒ…æ¶ 21\té›¨é€é»„æ˜èŠ±æ˜“è½ 22\t` 23\tfmt.Println(s2) 24\ts3 := `D:\\Go\\src\\code.oldboyedu.com\\studygo\\day01` 25\tfmt.Println(s3) 26 27\t// å­—ç¬¦ä¸²ç›¸å…³æ“ä½œ 28\tfmt.Println(len(s3)) // ? 29 30\t// å­—ç¬¦ä¸²æ‹¼æ¥ 31\tname := \u0026#34;ç†æƒ³\u0026#34; 32\tworld := \u0026#34;å¤§å¸…æ¯”\u0026#34; 33 34\tss := name + world 35\tfmt.Println(ss) 36\tss1 := fmt.Sprintf(\u0026#34;%s%s\u0026#34;, name, world) 37\t// fmt.Printf(\u0026#34;%s%s\u0026#34;, name, world) 38\tfmt.Println(ss1) 39\t// åˆ†éš” 40\tret := strings.Split(s3, \u0026#34;\\\\\u0026#34;) 41\tfmt.Println(ret) 42\t// åŒ…å« 43\tfmt.Println(strings.Contains(ss, \u0026#34;ç†æ€§\u0026#34;)) 44\tfmt.Println(strings.Contains(ss, \u0026#34;ç†æƒ³\u0026#34;)) 45\t// å‰ç¼€ 46\tfmt.Println(strings.HasPrefix(ss, \u0026#34;ç†æƒ³\u0026#34;)) 47\t// åç¼€ 48\tfmt.Println(strings.HasSuffix(ss, \u0026#34;ç†æƒ³\u0026#34;)) 49 50\ts4 := \u0026#34;abcdeb\u0026#34; 51\tfmt.Println(strings.Index(s4, \u0026#34;c\u0026#34;)) 52\tfmt.Println(strings.LastIndex(s4, \u0026#34;b\u0026#34;)) 53\t// æ‹¼æ¥ 54\tfmt.Println(strings.Join(ret, \u0026#34;+\u0026#34;)) 55} 56 57/* 58\u0026#39;D:\\Go\\src\\code.oldboyedu.com\\studygo\\day01\u0026#39; 59I\u0026#39;m ok 60 61ä¸–æƒ…è–„ 62 äººæƒ…æ¶ 63 é›¨é€é»„æ˜èŠ±æ˜“è½ 64 65D:\\Go\\src\\code.oldboyedu.com\\studygo\\day01 6642 67ç†æƒ³å¤§å¸…æ¯” 68ç†æƒ³å¤§å¸…æ¯” 69[D: Go src code.oldboyedu.com studygo day01] 70false 71true 72true 73false 742 755 76D:+Go+src+code.oldboyedu.com+studygo+day01 77*/ åˆ«å åœ¨å®˜æ–¹è¯­è¨€è§„èŒƒä¸­ä¸“é—¨æåˆ°ä¸¤ä¸ªåˆ«å\n1byte alias for unit8 2rune alias for int32 1package main 2 3import \u0026#34;fmt\u0026#34; 4 5// byteå’Œruneç±»å‹ 6 7// Goè¯­è¨€ä¸­ä¸ºäº†å¤„ç†éASCIIç ç±»å‹çš„å­—ç¬¦ å®šä¹‰äº†æ–°çš„runeç±»å‹ 8 9func main() { 10\ts := \u0026#34;Helloæ²™æ²³ì‚¬ìƒ¤\u0026#34; 11\t// len()æ±‚å¾—æ˜¯byteå­—èŠ‚çš„æ•°é‡ 12\tn := len(s) // æ±‚å­—ç¬¦ä¸²sçš„é•¿åº¦,æŠŠé•¿åº¦ä¿å­˜åˆ°å˜é‡nä¸­ 13\tfmt.Println(n) 14 15\t// for i := 0; i \u0026lt; len(s); i++ { 16\t// // fmt.Println(s[i]) 17\t// fmt.Printf(\u0026#34;%c\\n\u0026#34;, s[i]) // %c:å­—ç¬¦ 18\t// } 19 20\tfor _, c := range s { // ä»å­—ç¬¦ä¸²ä¸­æ‹¿å‡ºå…·ä½“çš„å­—ç¬¦ 21\tfmt.Printf(\u0026#34;%c\\n\u0026#34;, c) // %c:å­—ç¬¦ 22\t} 23 24\t// \u0026#34;Hello\u0026#34; =\u0026gt; \u0026#39;H\u0026#39; \u0026#39;e\u0026#39; \u0026#39;l\u0026#39; \u0026#39;l\u0026#39; \u0026#39;o\u0026#39; 25\t// å­—ç¬¦ä¸²ä¿®æ”¹ 26\ts2 := \u0026#34;ç™½èåœ\u0026#34; // =\u0026gt; \u0026#39;ç™½\u0026#39; \u0026#39;è\u0026#39; \u0026#39;åœ\u0026#39; 27\ts3 := []rune(s2) // æŠŠå­—ç¬¦ä¸²å¼ºåˆ¶è½¬æ¢æˆäº†ä¸€ä¸ªruneåˆ‡ç‰‡ 28\ts3[0] = \u0026#39;çº¢\u0026#39; 29\tfmt.Println(string(s3)) // æŠŠruneåˆ‡ç‰‡å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸² 30 31\tc1 := \u0026#34;çº¢\u0026#34; 32\tc2 := \u0026#39;çº¢\u0026#39; // rune(int32) 33\tfmt.Printf(\u0026#34;c1:%T c2:%T\\n\u0026#34;, c1, c2) 34\tc3 := \u0026#34;H\u0026#34; // string 35\tc4 := byte(\u0026#39;H\u0026#39;) // byte(uint8) 36\tfmt.Printf(\u0026#34;c3:%T c4:%T\\n\u0026#34;, c3, c4) 37\tfmt.Printf(\u0026#34;%d\\n\u0026#34;, c4) 38 39\t// ç±»å‹è½¬æ¢ 40\tn1 := 10 // int 41\tvar f float64 42\tf = float64(n1) 43\tfmt.Println(f) 44\tfmt.Printf(\u0026#34;%T\\n\u0026#34;, f) 45} ä¿®æ”¹å­—ç¬¦ä¸² è¦ä¿®æ”¹å­—ç¬¦ä¸²ï¼Œéœ€è¦å…ˆå°†å…¶è½¬æ¢æˆ[]runeæˆ–[]byteï¼Œå®Œæˆåå†è½¬æ¢ä¸ºstringã€‚æ— è®ºå“ªç§è½¬æ¢ï¼Œéƒ½ä¼šé‡æ–°åˆ†é…å†…å­˜ï¼Œå¹¶å¤åˆ¶å­—èŠ‚æ•°ç»„ã€‚\n1func changeString() { 2\ts1 := \u0026#34;big\u0026#34; 3\t// å¼ºåˆ¶ç±»å‹è½¬æ¢ 4\tbyteS1 := []byte(s1) 5\tbyteS1[0] = \u0026#39;p\u0026#39; 6\tfmt.Println(string(byteS1)) 7 8\ts2 := \u0026#34;ç™½èåœ\u0026#34; 9\truneS2 := []rune(s2) 10\truneS2[0] = \u0026#39;çº¢\u0026#39; 11\tfmt.Println(string(runeS2)) 12} ç±»å‹è½¬æ¢ Goè¯­è¨€ä¸­åªæœ‰å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œæ²¡æœ‰éšå¼ç±»å‹è½¬æ¢ã€‚è¯¥è¯­æ³•åªèƒ½åœ¨ä¸¤ä¸ªç±»å‹ä¹‹é—´æ”¯æŒç›¸äº’è½¬æ¢çš„æ—¶å€™ä½¿ç”¨ã€‚\nå¼ºåˆ¶ç±»å‹è½¬æ¢çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š\n1T(è¡¨è¾¾å¼) å…¶ä¸­ï¼ŒTè¡¨ç¤ºè¦è½¬æ¢çš„ç±»å‹ã€‚è¡¨è¾¾å¼åŒ…æ‹¬å˜é‡ã€å¤æ‚ç®—å­å’Œå‡½æ•°è¿”å›å€¼ç­‰.\næ¯”å¦‚è®¡ç®—ç›´è§’ä¸‰è§’å½¢çš„æ–œè¾¹é•¿æ—¶ä½¿ç”¨mathåŒ…çš„Sqrt()å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶çš„æ˜¯float64ç±»å‹çš„å‚æ•°ï¼Œè€Œå˜é‡aå’Œbéƒ½æ˜¯intç±»å‹çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å°†aå’Œbå¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ºfloat64ç±»å‹ã€‚\n1func sqrtDemo() { 2\tvar a, b = 3, 4 3\tvar c int 4\t// math.Sqrt()æ¥æ”¶çš„å‚æ•°æ˜¯float64ç±»å‹ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ 5\tc = int(math.Sqrt(float64(a*a + b*b))) 6\tfmt.Println(c) 7} 2.5 å¼•ç”¨ç±»å‹ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/2_%E7%B1%BB%E5%9E%8B/","summary":"ç±»å‹ 2.1 å˜é‡ æ ‡è¯†ç¬¦ä¸å…³é”®å­— æ ‡è¯†ç¬¦ åœ¨ç¼–ç¨‹è¯­è¨€ä¸­æ ‡è¯†ç¬¦å°±æ˜¯ç¨‹åºå‘˜å®šä¹‰çš„å…·æœ‰ç‰¹æ®Šæ„ä¹‰çš„è¯ï¼Œæ¯”å¦‚å˜é‡åã€å¸¸é‡åã€å‡½æ•°åç­‰ç­‰ã€‚ Goè¯­è¨€ä¸­æ ‡è¯†ç¬¦ç”±å­—æ¯æ•°å­—å’Œ_(ä¸‹åˆ’çº¿ï¼‰ç»„æˆï¼Œå¹¶ä¸”åªèƒ½ä»¥å­—æ¯å’Œ_å¼€å¤´ã€‚ ä¸¾å‡ ä¸ªä¾‹å­ï¼šabc, _, _123, a123ã€‚\nå…³é”®å­— å…³é”®å­—æ˜¯æŒ‡ç¼–ç¨‹è¯­è¨€ä¸­é¢„å…ˆå®šä¹‰å¥½çš„å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„æ ‡è¯†ç¬¦ã€‚ å…³é”®å­—å’Œä¿ç•™å­—éƒ½ä¸å»ºè®®ç”¨ä½œå˜é‡åã€‚\nGoè¯­è¨€ä¸­æœ‰25ä¸ªå…³é”®å­—ï¼š\n1 break default func interface select 2 case defer go map struct 3 chan else goto package switch 4 const fallthrough if range type 5 continue for import return var æ­¤å¤–ï¼ŒGoè¯­è¨€ä¸­è¿˜æœ‰37ä¸ªä¿ç•™å­—ã€‚\n1 Constants: true false iota nil 2 3 Types: int int8 int16 int32 int64 4 uint uint8 uint16 uint32 uint64 uintptr 5 float32 float64 complex128 complex64 6 bool byte rune string error 7 8 Functions: make len cap new append copy close delete 9 complex real imag 10 panic recover go è¯­è¨€ä¸­çš„å˜é‡å¿…é¡»å…ˆå£°æ˜å†ä½¿ç”¨ã€‚","tags":null,"title":""},{"categories":null,"contents":"æµç¨‹æ§åˆ¶ if\u0026hellip;else 1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6 var number int = 5 7\tif number += 4; 10 \u0026gt; number { 8\tnumber :=0 9\tnumber += 3 10\tfmt.Print(number) 11\t} else if 10 \u0026lt; number { 12\tnumber -= 2 13\tfmt.Print(number) 14\t} 15\tfmt.Println(number) 16} 17 18// 39 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/3_%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/","summary":"æµç¨‹æ§åˆ¶ if\u0026hellip;else 1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6 var number int = 5 7\tif number += 4; 10 \u0026gt; number { 8\tnumber :=0 9\tnumber += 3 10\tfmt.Print(number) 11\t} else if 10 \u0026lt; number { 12\tnumber -= 2 13\tfmt.Print(number) 14\t} 15\tfmt.Println(number) 16} 17 18// 39 ","tags":null,"title":""},{"categories":null,"contents":"å‡½æ•° ç°ä»£è®¡ç®—æœºçš„è¿›ç¨‹æ‰§è¡Œæ¨¡å‹å¤§éƒ¨åˆ†æ˜¯åŸºäºâ€œå †æ ˆâ€çš„ï¼Œç¼–è¯‘å™¨ä¸éœ€è¦å¯¹å‡½æ•°åšè¿‡å¤šçš„è½¬æ¢å°±èƒ½è®©å…¶åœ¨æ ˆä¸Šè¿è¡Œ\n2.1 åŸºæœ¬æ¦‚å¿µ 2.1.1 å‡½æ•°å®šä¹‰ ä¸€ä¸ªå‡½æ•°çš„å®šä¹‰åŒ…å«å¦‚ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š å‡½æ•°å£°æ˜å…³é”®å­—funcã€å‡½æ•°åã€å‚æ•°åˆ—è¡¨ã€è¿”å›åˆ—è¡¨å’Œå‡½æ•°ä½“ã€‚\né¦–å­—æ¯çš„å¤§å°å†™å†³å®šè¯¥å‡½æ•°åœ¨å…¶ä»–åŒ…çš„å¯è§ï¼šå¤§å†™æ—¶å…¶ä»–åŒ…å¯è§ï¼Œå°å†™æ—¶åªæœ‰ç›¸åŒçš„åŒ…å¯ä»¥è®¿é—®ã€‚\nå‡½æ•°å¯ä»¥æ²¡æœ‰è¾“å…¥å‚æ•°ã€ä¹Ÿå¯ä»¥æ²¡æœ‰è¿”å›å€¼ï¼ˆé»˜è®¤è¿”å›0ï¼‰\n1func A(){ 2} 3 4func B() int{ 5 return 1 6} å¤šä¸ªç›¸åŒç±»å‹çš„å‚æ•°å¯ä»¥ä½¿ç”¨ç®€å†™æ¨¡å¼\n1func add(a,b int) int{ // a int, b int ç®€å†™ä¸º a,b int 2 return a+b 3} æ”¯æŒæœ‰åçš„è¿”å›å€¼ï¼Œå‚æ•°åç›¸å½“äºå‡½æ•°ä½“æœ€å¤–å±‚çš„å±€éƒ¨å˜é‡ï¼Œå‘½åè¿”å›å€¼å˜é‡ä¼šè¢«åˆå§‹åŒ–ä¸ºç±»å‹é›¶å€¼æœ€åçš„returnå¯ä»¥ä¸å¸¦å‚æ•°åç›´æ¥è¿”å›ã€‚\n1func add(a,b int) (sum int){ // sum ç›¸å½“äºå‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œè¢«åˆå§‹åŒ–ä¸º0 2 sum = a+b 3 return // return sum çš„ç®€å†™æ¨¡å¼ 4 5 // sum := a+b 6 // return sum // éœ€è¦æ˜¾å¼çš„è°ƒç”¨return sum 7} ä¸æ”¯æŒé»˜è®¤å€¼å‚æ•°ï¼Ÿï¼Ÿ\nä¸æ”¯æŒå‡½æ•°é‡è½½\nä¸æ”¯æŒå‡½æ•°åµŒå¥—ï¼Œä¸¥æ ¼çš„è¯´ä¸æ”¯æŒå‘½åå‡½æ•°çš„åµŒå¥—å®šä¹‰ï¼Œä½†æ”¯æŒåŒ¿åå‡½æ•°\n1func add(a, b int) (sum int){ 2 anonymous := func(x,y int) int{ 3\treturn x+y 4 } 5 6 return anonymous(a,b) 7} 2.1.2 å¤šå€¼è¿”å› å®šä¹‰å¤šå€¼è¿”å›çš„è¿”å›å‚æ•°åˆ—è¡¨æ—¶å€™è¦ä½¿ç”¨â€œ()â€ï¼Œæ”¯æŒå‘½åå‚æ•°çš„è¿”å›\n1func swap(a,b int) (int, int){ 2 return b,a 3} ä¹ æƒ¯ç”¨æ³•ï¼š\nå¦‚æœå¤šå€¼è¿”å›æœ‰é”™è¯¯ç±»å‹ï¼Œåˆ™ä¸€èˆ¬å°†é”™è¯¯ç±»å‹ä½œä¸ºæœ€åä¸€ä¸ªè¿”å›å€¼\n2.1.2 å®å‚åˆ°å½¢å‚çš„ä¼ é€’ Go å‡½æ•°å®å‚åˆ°å½¢å‚çš„ä¼ é€’æ°¸è¿œæ˜¯å€¼æ‹·è´ï¼Œæœ‰æ—¶å€™å‡½æ•°è°ƒç”¨åï¼Œå®å‚æŒ‡å‘çš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£æ˜¯å› ä¸ºå‚æ•°ä¼ é€’çš„æ˜¯æŒ‡é’ˆå€¼çš„æ‹·è´ï¼Œå®å‚æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œä¼ é€’ç»™å½¢å‚çš„æ˜¯è¿™ä¸ªæŒ‡é’ˆå˜é‡çš„å‰¯æœ¬ï¼ŒäºŒè€…æŒ‡å‘åŒä¸€ä¸ªåœ°å€ï¼Œæœ¬è´¨ä¸Šå‚æ•°ä¼ é€’ä»ç„¶æ˜¯å€¼æ‹·è´ã€‚\n1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func chvalue(a int) int { // å®å‚ä¼ é€’ç»™å½¢å‚çš„æ˜¯å€¼æ‹·è´ 6\ta = a + 1 7\treturn a 8} 9 10func chpointer(a *int) { // å®å‚ä¼ é€’ç»™å½¢å‚çš„ä»ç„¶æ˜¯åªæ‹·è´ï¼Œåªä¸è¿‡å¤åˆ¶çš„æ˜¯açš„åœ°å€ 11\t*a = *a + 1 12\treturn 13} 14func main() { 15\ta := 10 16 17\tchvalue(a) 18\tfmt.Println(a) 19 20\tchpointer(\u0026amp;a) 21\tfmt.Println(a) 22} 2.1.4 ä¸å®šå‚æ•° Go å‡½æ•°æ”¯æŒä¸å®šæ•°ç›®çš„å½¢å¼å‚æ•°ï¼Œä¸å®šå‚æ•°å£°æ˜ä½¿ç”¨param \u0026hellip;typeçš„è¯­æ³•æ ¼å¼\næ‰€æœ‰çš„ä¸å®šå‚æ•°ç±»å‹å¿…é¡»æ˜¯ç›¸åŒçš„\nä¸å®šå‚æ•°å¿…é¡»æ˜¯å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°\nä¸å®šå‚æ•°ååœ¨å‡½æ•°ä½“é‡ç›¸å½“äºåˆ‡ç‰‡ï¼Œå¯¹åˆ‡ç‰‡çš„æ“ä½œåŒæ ·é€‚åˆä¸å®šå‚æ•°çš„æ“ä½œ\n1func sum(arr ...int)(sum int){ 2 for _,v := range arr{ // æ­¤æ—¶arr å°±ç›¸å½“äºåˆ‡ç‰‡ï¼Œå¯ä»¥ä½¿ç”¨rangeè®¿é—® 3 sum +=v 4 } 5 return 6} åˆ‡ç‰‡å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸å®šå‚æ•°ï¼Œåˆ‡ç‰‡ååé¢è¦åŠ ä¸Šâ€œ\u0026hellip;â€\n1func sum(arr ...int) (sum int){ 2 for _,v := range arr{ 3 sum += v 4 } 5 return 6} 7 8func main(){ 9 slice :=[]{1,2,3,4} 10 array := [...]{1,2,3,4} 11 // æ•°ç»„ä¸å¯ä»¥ä½œä¸ºå®å‚ä¼ é€’ç»™ä¸å®šå‚æ•°çš„å‡½æ•° 12 sum(slice...) 13} æ³¨æ„ slice å’Œ arrayå®šä¹‰çš„åŒºåˆ«\nå½¢å‚ä¸ºä¸å®šå‚æ•°çš„å‡½æ•°å’Œä¸ºåˆ‡ç‰‡çš„å‡½æ•°ç±»å‹ä¸ç›¸åŒ\n1func suma(arr ...int)(sum int){ 2\tfor _,v := range arr{ 3\tsum +=v 4\t} 5\treturn 6} 7 8func sumb(arr [4]int) (sum int) { 9\tfor _,v := range arr{ 10\tsum +=v 11\t} 12\treturn 13} 14 15func main() { 16\tslice := []int{2,3,4,5} 17\tarray := [4]int{2,3,4,5} 18 19\tprintln(suma(slice...)) 20\tprintln(sumb(array)) 21} 22 23// suma å’Œsumb ä¸ä¸€æ · 2.2 å‡½æ•°ç­¾åå’ŒåŒ¿åå‡½æ•° 2.2.1 å‡½æ•°ç­¾å å‡½æ•°ç±»å‹åˆå«åšå‡½æ•°ç­¾åï¼Œä¸€ä¸ªå‡½æ•°çš„ç±»å‹å°±æ˜¯å‡½æ•°å®šä¹‰é¦–è¡Œå»æ‰å‡½æ•°åï¼Œå‚æ•°åå’Œ{ï¼Œå¯ä»¥ä½¿ç”¨fmt.Printfçš„%Tæ ¼å¼åŒ–å‚æ•°æ‰“å°å‡½æ•°çš„ç±»å‹\n1func add(a,b int )(sum int){ 2\tsum = a +b 3\treturn sum 4} 5 6func main() { 7\tfmt.Printf(\u0026#34; func type isï¼š%T\u0026#34;,add ) // func type isï¼šfunc(int, int) int 8} ä¸¤ä¸ªå‡½æ•°ç±»å‹ç›¸åŒçš„æ¡ä»¶æ˜¯ï¼š æ‹¥æœ‰ç›¸åŒçš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼åˆ—è¡¨ï¼ˆåˆ—è¡¨å…ƒç´ çš„æ¬¡åºï¼Œä¸ªæ•°å’Œç±»å‹éƒ½ç›¸åŒï¼‰ï¼Œå½¢å‚åå¯ä»¥ä¸åŒã€‚ä¸€ä¸‹ä¸¤ä¸ªå‡½æ•°ç±»å‹æ˜¯å®Œå…¨ä¸€æ ·çš„\n1func add(a,b int) int{ return a+b} 2func sub(x int, y int)(z int){z = x-y; return z} å¯ä»¥ä½¿ç”¨typeå®šä¹‰å‡½æ•°ç±»å‹ï¼Œå‡½æ•°ç±»å‹å˜é‡å¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°æˆ–è¿”å›å€¼ã€‚\n1package main 2 3import \u0026#34;fmt\u0026#34; 4 5 6func add(a,b int )(sum int){ 7\tsum = a +b 8\treturn sum 9} 10 11func sub(a,b int) int { 12\treturn b-a 13} 14 15type Op func(int, int) int // å®šä¹‰ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œè¾“å…¥æ˜¯ä¸¤ä¸ªintï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªintç±»å‹ 16 17 18func do(f Op, a,b int) int{ // å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°ç±»å‹Op 19\treturn f(a,b) // å‡½æ•°ç±»å‹å˜é‡å¯ä»¥ç›´æ¥ç”¨æ¥è¿›è¡Œå‡½æ•°è°ƒç”¨ 20} 21 22 23func main() { 24\ta := do(add, 1,2) 25\tfmt.Println(a) // 3 26 27\ts := do(sub, 1,2) // 1 28\tfmt.Println(s) 29} å‡½æ•°ç±»å‹å’Œmapã€sliceã€chanä¸€æ ·ï¼Œå®é™…å‡½æ•°ç±»å‹å˜é‡å’Œå‡½æ•°åéƒ½å¯ä»¥å½“åšæŒ‡é’ˆå˜é‡ï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å‡½æ•°ä»£ç çš„å¼€å§‹ä½ç½®ã€‚é€šå¸¸è¯´å‡½æ•°å˜é‡ç±»å‹æ˜¯ä¸€ç§å¼•ç”¨ç±»å‹ï¼Œæœªåˆå§‹åŒ–çš„å‡½æ•°ç±»å‹çš„å˜é‡é»˜è®¤æ˜¯nilã€‚\nGo ä¸­å‡½æ•°æ˜¯â€œç¬¬ä¸€å…¬æ°‘ï¼ˆfirst classï¼‰â€ã€‚æœ‰åå‡½æ•°çš„å‡½æ•°åå¯ä»¥çœ‹ä½œå‡½æ•°ç±»å‹çš„å¸¸é‡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å‡½æ•°åè°ƒç”¨å‡½æ•°ã€‚ä¹Ÿå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å‡½æ•°ç±»å‹å˜é‡ï¼Œåç»­é€šè¿‡è¯¥å˜é‡æ¥è°ƒç”¨è¯¥å‡½æ•°ã€‚\n1func sum(a,b int) int{ 2 return a+b 3} 4func main(){ 5 sum(3,4) // ç›´æ¥è°ƒç”¨ 6 f := sum // æœ‰åå‡½æ•°å¯ä»¥ç›´æ¥èµ‹å€¼ç»™å˜é‡ 7 f(1,2) 8} 2.2.2 åŒ¿åå‡½æ•° https://zhuanlan.zhihu.com/p/71829933\nhttps://eddycjy.com/posts/go/go1.16-3/\nhttps://segmentfault.com/a/1190000037679588\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/4_%E5%87%BD%E6%95%B0/","summary":"å‡½æ•° ç°ä»£è®¡ç®—æœºçš„è¿›ç¨‹æ‰§è¡Œæ¨¡å‹å¤§éƒ¨åˆ†æ˜¯åŸºäºâ€œå †æ ˆâ€çš„ï¼Œç¼–è¯‘å™¨ä¸éœ€è¦å¯¹å‡½æ•°åšè¿‡å¤šçš„è½¬æ¢å°±èƒ½è®©å…¶åœ¨æ ˆä¸Šè¿è¡Œ\n2.1 åŸºæœ¬æ¦‚å¿µ 2.1.1 å‡½æ•°å®šä¹‰ ä¸€ä¸ªå‡½æ•°çš„å®šä¹‰åŒ…å«å¦‚ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š å‡½æ•°å£°æ˜å…³é”®å­—funcã€å‡½æ•°åã€å‚æ•°åˆ—è¡¨ã€è¿”å›åˆ—è¡¨å’Œå‡½æ•°ä½“ã€‚\né¦–å­—æ¯çš„å¤§å°å†™å†³å®šè¯¥å‡½æ•°åœ¨å…¶ä»–åŒ…çš„å¯è§ï¼šå¤§å†™æ—¶å…¶ä»–åŒ…å¯è§ï¼Œå°å†™æ—¶åªæœ‰ç›¸åŒçš„åŒ…å¯ä»¥è®¿é—®ã€‚\nå‡½æ•°å¯ä»¥æ²¡æœ‰è¾“å…¥å‚æ•°ã€ä¹Ÿå¯ä»¥æ²¡æœ‰è¿”å›å€¼ï¼ˆé»˜è®¤è¿”å›0ï¼‰\n1func A(){ 2} 3 4func B() int{ 5 return 1 6} å¤šä¸ªç›¸åŒç±»å‹çš„å‚æ•°å¯ä»¥ä½¿ç”¨ç®€å†™æ¨¡å¼\n1func add(a,b int) int{ // a int, b int ç®€å†™ä¸º a,b int 2 return a+b 3} æ”¯æŒæœ‰åçš„è¿”å›å€¼ï¼Œå‚æ•°åç›¸å½“äºå‡½æ•°ä½“æœ€å¤–å±‚çš„å±€éƒ¨å˜é‡ï¼Œå‘½åè¿”å›å€¼å˜é‡ä¼šè¢«åˆå§‹åŒ–ä¸ºç±»å‹é›¶å€¼æœ€åçš„returnå¯ä»¥ä¸å¸¦å‚æ•°åç›´æ¥è¿”å›ã€‚\n1func add(a,b int) (sum int){ // sum ç›¸å½“äºå‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œè¢«åˆå§‹åŒ–ä¸º0 2 sum = a+b 3 return // return sum çš„ç®€å†™æ¨¡å¼ 4 5 // sum := a+b 6 // return sum // éœ€è¦æ˜¾å¼çš„è°ƒç”¨return sum 7} ä¸æ”¯æŒé»˜è®¤å€¼å‚æ•°ï¼Ÿï¼Ÿ","tags":null,"title":""},{"categories":null,"contents":"Goå¹¶å‘ç¼–ç¨‹æ¡ˆä¾‹è§£æ nginx\ninfluxdb æ—¶åºæ•°æ®åº“ Prometheus\nGrafana\nå®ä¾‹ä»£ç \nhttps://github.com/itsmikej/imooc_logprocess\nå¸¸è§çš„å¹¶å‘æ¨¡å‹ è¿›ç¨‹\u0026amp;çº¿ç¨‹ Apache C10K æœåŠ¡å™¨è¦åŒæ—¶æ”¯æŒ10Kçš„å¹¶å‘è¿æ¥ å¼‚æ­¥éé˜»å¡ ï¼ˆNginxï¼ŒLibeventï¼Œ NodeJsï¼‰epoll å¤æ‚åº¦é«˜ åç¨‹ GoLangï¼Œ Erlangï¼Œ Lua Golangå¹¶å‘å®ç° ç¨‹åºå¹¶å‘æ‰§è¡Œ goroutine å¤šä¸ªgoroutineé—´çš„æ•°æ®åŒæ­¥é€šä¿¡channels å¤šä¸ªchannelé€‰æ‹©æ•°æ®è¯»å–æˆ–è€…å†™å…¥select Goroutines Goroutines ç¨‹åºå¹¶å‘æ‰§è¡Œ\n1foo() // æ‰§è¡Œå‡½æ•°foo, ç¨‹åºç­‰å¾…å‡½æ•°fooè¿”å› 2go foo() // æ‰§è¡Œå‡½æ•°foo 3barï¼ˆï¼‰ // ä¸ç”¨ç­‰å¾…fooè¿”å› Channels Channelså¤šä¸ªgoroutineé—´çš„æ•°æ®é€šä¿¡ä¸åŒæ­¥\n1c := make(chan string) // åˆ›å»ºä¸€ä¸ªchannel 2go func(){ 3 time.Sleep(1*time.Second) 4 c \u0026lt;- \u0026#34;message from closure\u0026#34; // å‘é€æ•°æ®åˆ°channel ä¸­ 5}() 6 7msg:=\u0026lt;- c // é˜»å¡ç›´åˆ°æ¥æ”¶åˆ°æ•°æ® Select Select ä»å¤šä¸ªChannel ä¸­è¯»å–æˆ–å†™å…¥æ•°æ®\n1select{ 2 case v:= \u0026lt;-c1: 3 fmt.Println(\u0026#34;channel 1 sends\u0026#34;,v) 4 case v:=\u0026lt;- c2: 5 fmt.Println(\u0026#34;channel 2 sends\u0026#34;) 6 default: // å¯é€‰ 7 fmt.Println(\u0026#34;neither channel was ready\u0026#34;) 8} å¹¶å‘ä¸å¹¶è¡Œ Rob Pike Concurrency is not Parallelism\nå¹¶å‘ï¼š æŒ‡åŒä¸€æ—¶åˆ»ï¼Œç³»ç»Ÿé€šè¿‡è°ƒåº¦ï¼Œæ¥å›åˆ‡æ¢äº¤æ›¿è¿è¡Œçš„å¤šä¸ªä»»åŠ¡ï¼Œâ€œçœ‹èµ·æ¥â€æ˜¯åŒæ—¶è¿è¡Œ å¹¶è¡Œï¼š æ‰§è¡Œç»Ÿä¸€æ—¶åˆ»ï¼Œä¸¤ä¸ªä»»åŠ¡â€œçœŸæ­£çš„â€åŒæ—¶è¿è¡Œ Concurrencyï¼š å•æ ¸CPUï¼Œé€»è¾‘ä¸ŠåŒæ—¶æ‰§è¡Œ\nParallelismï¼š å¤šæ ¸CPUï¼Œç‰©ç†ä¸ŠåŒæ—¶æ‰§è¡Œ\n![image-20191121193911320](/Users/airren/Library/Application Support/typora-user-images/image-20191121193911320.png)\nå¤šä¸ªgoroutine å¹¶å‘æ‰§è¡Œ\nå°†å¤æ‚çš„ä»»åŠ¡æ‹†åˆ†ï¼Œé€šè¿‡goroutine å»å¹¶å‘æ‰§è¡Œ\né€šè¿‡channelåšæ•°æ®é€šä¿¡\nGolang ä¸­çš„é¢å‘å¯¹è±¡ struct ç±»å‹ inteface ç»§æ‰¿ã€å°è£…ã€å¤šæ€ å°è£… 1type Foo struct{ 2 baz string 3} 4 5func (f *Foo) echo(){ // æ¥å—è€… æˆå‘˜å‡½æ•° 6 fmt.Println(f.baz) 7} 8 9func main(){ 10 f := Foo{baz: \u0026#34;hello, struct\u0026#34;} 11 f.echo() 12} ç»§æ‰¿ 1type Foo struct{ 2 baz string 3} 4 5type Bar struct{ 6 Foo 7} 8 9func (f *Foo) echo(){ // æ¥å—è€… æˆå‘˜å‡½æ•° 10 fmt.Println(f.baz) 11} 12 13func main(){ 14 b := Bar{Foo{baz: \u0026#34;hello, struct\u0026#34;}} 15 b.echo() 16} å¤šæ€ éä¾µå…¥å¼çš„æ¥å£ duck æ¥å£\n1type Foo interface{ 2 qux() 3} 4 5type Bar struct{} 6type Baz struct{} 7\t8func (b *Bar) qux(){} 9func (b *Baz) qux(){} 10 11func main(){ 12\tvar f Foo 13 f = Bar{} 14 f = Baz{} 15 fmt.Println(f) 16} 2. æ—¥å¿—ç›‘æ§ç¨‹åºçš„å®ç° LogProcess è¯»å–æ¨¡å—å®ç° æ‰“å¼€æ–‡ä»¶ ä»æ–‡ä»¶æœ«å°¾å¼€å§‹é€è¡Œè¯»å– å†™å…¥read channel è§£ææ¨¡å—çš„å®ç° æå–æ•°æ®ä¸­æœ‰ä»·å€¼çš„ä¿¡æ¯\nä»Read Channel ä¸­è¯»å–æ¯è¡Œæ—¥å¿—æ•°æ® æ­£åˆ™æå–æ‰€éœ€çš„ç›‘æ§æ•°æ®(path, status, method ç­‰) å†™å…¥Write channel å†™å…¥æ¨¡å—çš„å®ç° åˆå§‹åŒ–influxDB client ä»write channelä¸­è¯»å–ç›‘æ§æ•°æ® æ„é€ æ•°æ®å¹¶å†™å…¥influxDB InfluxDB ç®€ä»‹ï¼š\ninfluxdbæ˜¯ä¸€ä¸ªå¼€æºçš„æ—¶åºå‹çš„æ•°æ®åº“ï¼Œä½¿ç”¨Goè¯­è¨€ç¼–å†™ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå­˜å‚¨ç³»ç»Ÿçš„ç›‘æ§æ•°æ®ï¼ŒIoTè¡Œä¸šçš„è¯•è¯•æ•°æ®ç­‰åœºæ™¯ã€‚æœ‰ä»¥ä¸‹ç‰¹æ€§ã€‚\néƒ¨ç½²ç®€å•ï¼Œæ— å¤–éƒ¨ä¾èµ– å†…ç½®httpæ”¯æŒï¼Œä½¿ç”¨httpè¯»å†™ ç±»sqlçš„çµæ´»æŸ¥è¯¢(max, min, sum ç­‰) Influx dbå…³é”®æ¦‚å¿µ\ndatabase ï¼š æ•°æ®åº“ measurementï¼šæ•°æ®åº“ä¸­çš„è¡¨ pointsï¼š è¡¨é‡Œé¢çš„ä¸€è¡Œæ•°æ® tags å„ç§æœ‰ç´¢å¼•çš„å±æ€§ fields å„ç§è®°å½•çš„å€¼ time æ•°æ®è®°å½•çš„æ—¶é—´æˆ³ï¼Œ ä¹Ÿæ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ä¸»ç´¢å¼• åˆ†æç›‘æ§éœ€æ±‚ æŸä¸ªåè®®ä¸‹çš„æŸä¸ªè¯·æ±‚åœ¨æŸä¸ªè¯·æ±‚æ–¹æ³•çš„ QPS\u0026amp; å“åº”æ—¶é—´\u0026amp; æµé‡\n**Tagsï¼š**Path ã€Methodã€Schemeã€Status Fieldsï¼š UpstreamTimeï¼Œ RequestTimeï¼ŒByteSent TImeï¼š TimeLocal\nâ€‹\n5. ç»˜åˆ¶ç›‘æ§å›¾ 6. ç›‘æ§æ¨¡å—çš„å®ç° æ€»å¤„ç†æ—¥å¿—çš„è¡Œæ•° ç³»ç»Ÿååé‡ read channel é•¿åº¦ write channel é•¿åº¦ è¿è¡Œæ€»æ—¶é—´ é”™è¯¯æ•°é‡ å¹¶å‘çš„åŸºç¡€çŸ¥è¯†\nå¹¶è¡Œå’Œå¹¶å‘çš„åŒºåˆ«\nGolang é¢å‘å¯¹è±¡\nå¹¶å‘ç¼–ç¨‹çš„æ€è·¯\næ¨¡å—åŒ–ç¼–ç¨‹\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/99_Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90/","summary":"Goå¹¶å‘ç¼–ç¨‹æ¡ˆä¾‹è§£æ nginx\ninfluxdb æ—¶åºæ•°æ®åº“ Prometheus\nGrafana\nå®ä¾‹ä»£ç \nhttps://github.com/itsmikej/imooc_logprocess\nå¸¸è§çš„å¹¶å‘æ¨¡å‹ è¿›ç¨‹\u0026amp;çº¿ç¨‹ Apache C10K æœåŠ¡å™¨è¦åŒæ—¶æ”¯æŒ10Kçš„å¹¶å‘è¿æ¥ å¼‚æ­¥éé˜»å¡ ï¼ˆNginxï¼ŒLibeventï¼Œ NodeJsï¼‰epoll å¤æ‚åº¦é«˜ åç¨‹ GoLangï¼Œ Erlangï¼Œ Lua Golangå¹¶å‘å®ç° ç¨‹åºå¹¶å‘æ‰§è¡Œ goroutine å¤šä¸ªgoroutineé—´çš„æ•°æ®åŒæ­¥é€šä¿¡channels å¤šä¸ªchannelé€‰æ‹©æ•°æ®è¯»å–æˆ–è€…å†™å…¥select Goroutines Goroutines ç¨‹åºå¹¶å‘æ‰§è¡Œ\n1foo() // æ‰§è¡Œå‡½æ•°foo, ç¨‹åºç­‰å¾…å‡½æ•°fooè¿”å› 2go foo() // æ‰§è¡Œå‡½æ•°foo 3barï¼ˆï¼‰ // ä¸ç”¨ç­‰å¾…fooè¿”å› Channels Channelså¤šä¸ªgoroutineé—´çš„æ•°æ®é€šä¿¡ä¸åŒæ­¥\n1c := make(chan string) // åˆ›å»ºä¸€ä¸ªchannel 2go func(){ 3 time.Sleep(1*time.Second) 4 c \u0026lt;- \u0026#34;message from closure\u0026#34; // å‘é€æ•°æ®åˆ°channel ä¸­ 5}() 6 7msg:=\u0026lt;- c // é˜»å¡ç›´åˆ°æ¥æ”¶åˆ°æ•°æ® Select Select ä»å¤šä¸ªChannel ä¸­è¯»å–æˆ–å†™å…¥æ•°æ®","tags":null,"title":""},{"categories":null,"contents":"è½¯ä»¶å¼€å‘çš„æ–°æŒ‘æˆ˜\nå¤šæ ¸ç¡¬ä»¶æ¶æ„\nè¶…å¤§è§„æ¨¡åˆ†å¸ƒå¼è®¡ç®—é›†ç¾¤\nwebæ¨¡å¼ä¸‹å¯¼è‡´çš„å‰æ‰€æœªæœ‰çš„è§„æ¨¡å’Œæ›´æ–°é€Ÿåº¦\nåŒºå—é“¾å¼€å‘è¯­è¨€ï¼Œ\nKubernetes\nDocker\nåªæœ‰25ä¸ªå…³é”®å­—\næœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥ç›´æ¥ä½¿ç”¨æŒ‡é’ˆè®¿é—®å†…å­˜\nCSPå¹¶å‘æœºåˆ¶\nå…³é”®å­—\nc 37\nc++ 11 84\ngo 25\ngo åƒåœ¾å›æ”¶ï¼Œä½¿ç”¨æŒ‡é’ˆç›´æ¥å†…å­˜è®¿é—®.\nå¤åˆå’Œç»§æ‰¿\ndocker kubernetes\ngo é»˜è®¤ä½¿ç”¨é™æ€è¿æ¥ï¼Œç¼–è¯‘å®Œæˆæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶\n1package main // package name 2 3import \u0026#34;fmt\u0026#34; // dependence 4 5// functionality 6func main() { 7\tfmt.Print(\u0026#34;hello world \\n\u0026#34;) 8} åº”ç”¨ç¨‹åºå…¥å£ï¼Œ\nå¿…é¡»æ˜¯mainåŒ… package main å¿…é¡»æ˜¯mainæ–¹æ³• func main() æ–‡ä»¶åä¸ä¸€å®šæ˜¯main.go package çš„åå­—ä¸éœ€è¦ä¸ç›®å½•ä¿æŒä¸€è‡´\né€€å‡ºè¿”å›å€¼\nä¸å…¶ä»–ä¸»è¦ç¼–ç¨‹è¯­è¨€çš„å·®å¼‚\nGo mainå‡½æ•°ä¸æ”¯æŒä»»ä½•è¿”å›å€¼ é€šè¿‡os.Exit æ¥è¿”å›çŠ¶æ€ 1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;os\u0026#34; 6) 7 8func main() { 9\tfmt.Print(\u0026#34;hello world \\n\u0026#34;) 10\tos.Exit(-1) 11} è·å–å‘½ä»¤è¡Œå‚æ•°\nmainå‡½æ•°ä¸æ”¯æŒä¼ å…¥å‚æ•°\nfunc main(arg []string)\nåœ¨ç¨‹åºä¸­ç›´æ¥é€šè¿‡os.Args è·å–å‘½ä»¤è¡Œå‚æ•°\nè·å–çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶æ‰§è¡Œçš„ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶å\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;os\u0026#34; 6) 7 8func main() { 9\tif len(os.Args) \u0026gt; 1 { 10\tfmt.Println(\u0026#34;hello world\u0026#34;,os.Args[1]) 11\t} 12\tos.Exit(1) 13} The master has failed more time than the beginner has tried.\nç¼–å†™æµ‹è¯•ç¨‹åº\næºç æ–‡ä»¶ä»¥_test ç»“å°¾ï¼Œxxx_test.go\næµ‹è¯•æ–¹æ³•åä»¥ Test å¼€å¤´, func TestXXX( t *testing.T){\u0026hellip;}\n1package test 2 3import \u0026#34;testing\u0026#34; 4 5func TestFirstTry(t *testing.T ){ 6\tt.Log(\u0026#34;hello test\u0026#34;) 7} å˜é‡èµ‹å€¼\nèµ‹å€¼å¯ä»¥è‡ªåŠ¨ç±»å‹æ¨æ–­ åœ¨ä¸€ä¸ªèµ‹å€¼è¯­å¥ä¸­ï¼Œå¯ä»¥å¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼ 1var a int = 1 2var b int = 2 3var ( 4\tc int = 1 5 // go ç±»å‹æ¨æ–­ 6 d = 2 7 e := 3 8) å¸¸é‡å®šä¹‰ï¼Œå¿«é€Ÿçš„è¿ç»­å€¼çš„è®¾ç½®\næ•°æ®ç±»å‹\n1bool 2string 3int int8 int16 int32 int64 4uint unit8 uint16 uint32 uint64 5byte # alias for uint8 6rune # alias for int32,represents a Unicode code point 7float32 float64 8complex64 complex128 ç±»å‹è½¬åŒ–\nä¸å…è®¸éšå¼ç±»å‹è½¬æ¢ åˆ«åå’ŒåŸæœ‰ç±»å‹ä¹Ÿä¸èƒ½è¿›è¡Œéšå¼ç±»å‹è½¬æ¢ ç±»å‹çš„é¢„å®šä¹‰å€¼\nmath.MaxInt64\nmath.MaxFloat64\nmath.MaxUint32\næŒ‡é’ˆç±»å‹\nä¸æ”¯æŒæŒ‡é’ˆè¿ç®— string æ˜¯å€¼ç±»å‹ï¼Œå…¶é»˜è®¤åˆå§‹åŒ–å€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯nil ç®—æœ¯è¿ç®—ç¬¦\n1+ - * / % 2++ 3-- 4# æ²¡æœ‰å‰ç½®çš„ ++ -- // ++a æ¯”è¾ƒè¿ç®—ç¬¦\n1== 2!= 3\u0026gt; \u0026lt; 4\u0026gt;= \u0026lt;= ç”¨ == æ¯”è¾ƒæ•°ç»„\nç›¸åŒç»´æ•°ï¼Œä¸”å«æœ‰ç›¸åŒä¸ªæ•°å…ƒç´ çš„æ•°ç»„æ‰å¯ä»¥æ¯”è¾ƒ æ¯ä¸ªå…ƒç´ éƒ½ç›¸åŒæ—¶æ‰ç›¸ç­‰ï¼ˆé¡ºåºï¼‰ é•¿åº¦ä¸åŒçš„æ•°ç»„æ¯”è¾ƒä¼šæœ‰ä¸€ä¸ªç¼–è¯‘é”™è¯¯\né€»è¾‘è¿ç®—ç¬¦\n1\u0026amp;\u0026amp; || ! ä½è¿ç®—ç¬¦\n1\u0026amp; ! ^ 2\u0026lt;\u0026lt; \u0026gt;\u0026gt; 3 4\u0026amp;^ æŒ‰ä½ç½®0 5 61 \u0026amp;^ 0 -- 1 # å³è¾¹çš„æ“ä½œä¹¦ä¸º0ï¼Œå·¦è¾¹ä¸å˜ 71 \u0026amp;^ 1 -- 0 # å³è¾¹çš„æ“ä½œæ•°ä¸º1ï¼Œå·¦è¾¹åˆ™ä¸º0 80 \u0026amp;^ 1 -- 0 90 \u0026amp;^ 0 -- 0 å¾ªç¯\nä»…æ”¯æŒå¾ªç¯å…³é”®å­— for\n1for j:=7;j\u0026lt;n ;j++{ 2 3} 4 5for n\u0026lt; 5{ 6 n++ 7} 8 9for { 10 11} æ¡ä»¶\ncondition è¡¨è¾¾å¼ç»“æœå¿…é¡»ä¸ºboolå€¼\næ”¯æŒå˜é‡èµ‹å€¼\n1if var declaration; condition{ 2 3} 1if condition{ 2 3}else{ 4 5} 6 7if condition-1{ 8 9}else if condition-2{ 10 11}else{ 12 13} switch æ¡ä»¶\næ¡ä»¶ä¸é™åˆ¶ä¸ºå¸¸é‡æˆ–è€…æ•´æ•° å•ä¸ªcaseä¸­å¯ä»¥å‡ºç°å¤šä¸ªç»“æœé€‰é¡¹ï¼Œä½¿ç”¨é€—å·åˆ†éš” ä¸éœ€è¦ç”¨breakç”¨æ¥æ¨å‡ºå½“å‰case å¯ä»¥ä¸è®¾ç½®switchä¹‹åçš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œswitchç»“æ„ä¸å¤šä¸ªif\u0026hellip;else çš„é€»è¾‘ä½œç”¨ç›¸åŒã€‚ 1switch os := runtime.GOOS; os{ 2 case \u0026#34;darwin\u0026#34;: 3 fmt.Println(\u0026#34;Mac OS\u0026#34;) 4 // break 5 case \u0026#34;linux\u0026#34;: 6 fmt.Println(\u0026#34;Linux\u0026#34;) 7 defaultï¼š 8 // freebsd, openbsd, plan9, windows.. 9 fmt.Printf(\u0026#34;%s\u0026#34;,os) 10} 11 12 13switch{ 14 case 0\u0026lt;=NUM \u0026amp;\u0026amp; NUM \u0026lt;=3: 15 fmt.Printf(\u0026#34;0-3\u0026#34;) 16 case 4 \u0026lt;=NUM \u0026amp;\u0026amp; NUM \u0026lt;= 6: 17 fmt.Printf(\u0026#34;4-6\u0026#34;) 18 case 7\u0026lt;=NUM \u0026amp;\u0026amp; NUM \u0026lt;= 9: 19 fmt.Printf(\u0026#34;7-9\u0026#34;) 20} è¿ç»­å­˜å‚¨ç©ºé—´\næ•°ç»„:\n1var a [3]int // å£°æ˜å¹¶åˆå§‹åŒ–ä¸ºé»˜è®¤é›¶å€¼ 2a[0] = 1 3 4b := [3]int{1,2,3} // å£°æ˜å¹¶åˆå§‹åŒ– 5c := [2][2]int{{1,2},{3,4}} // å¤šç»´æ•°ç»„ æ•°ç»„å…ƒç´ éå†\n1func TestArrayTravel(t *testing.T) { 2\tarr := [...]int{1, 2, 3, 4, 5} 3\tfor idx, i := range arr { 4\tt.Log(idx, i) 5\t} 6} æ•°ç»„æˆªå–\na[å¼€å§‹ç´¢å¼•(åŒ…å«)ï¼Œç»“æŸç´¢å¼•(ä¸åŒ…å«)], å·¦é—­å³å¼€åŒºé—´\n1a:= [...]int{1, 2, 3, 4, 5} 2a[1:2] // 2 3a[1:3] // 2,3 4a[1:len(1)] // 2,3,4,5 5a[1:] // 2,3,4,5 6a[:3] // 1,2,3 åˆ‡ç‰‡Slice\nåˆ‡ç‰‡å†…éƒ¨ç»“æ„ï¼Œä¼šé€ æˆå¤§é‡GC\nhttps://gyazo.com/b4dd7a1f65dcab076fc41d9dfac95180\nprt -\u0026gt; Array çš„åœ°å€\nlen å¯ä»¥è®¿é—®çš„å…ƒç´ ä¸ªæ•°ï¼Œ\ncap å†…éƒ¨æ•°ç»„çš„å®¹é‡\n1var s0 []int 2s0 = append(s0, 1) 3 4s := []int 5s1 := []int{1,2,3} 6s2 := make([]int,2,4) 7/* []type,len,cap 8å…¶ä¸­lenä¸ªå…ƒç´ ä¼šè¢«åˆå§‹åŒ–ä¸ºé»˜è®¤é›¶å€¼ï¼Œæœªåˆå§‹åŒ–å…ƒç´ ä¸å¯è®¿é—® 9*/ åˆ‡ç‰‡å…±äº«å­˜å‚¨ç»“æ„\nhttps://gyazo.com/96049daf69a2855181cedd023fe396d8\n1024 ä»¥ä¸‹æ˜¯2çš„å€æ•°ï¼Œå¤§äº1024 çº¦ 1.25å€\nè‡ªå¢é•¿çš„ä»£ä»·\næ•°ç»„VS åˆ‡ç‰‡\nå®¹é‡æ˜¯å¦å¯ä»¥ä¼¸ç¼©\næ˜¯å¦å¯ä»¥è¿›è¡Œæ¯”è¾ƒ\nslice åªèƒ½ä¸nil è¿›è¡Œæ¯”è¾ƒï¼Ÿï¼Ÿ\nMap å£°æ˜\n1m := map[stirng]int{\u0026#34;one\u0026#34;:1,\u0026#34;two\u0026#34;:2,\u0026#34;three\u0026#34;:3} 2m1 := map[string]int 3m1[\u0026#34;one\u0026#34;] = 1 4m2 := make(ma) 5 6m2 := make(map[string]int, 10 ) 7// 10 initial capacity 8// ä¸ºä»€ä¹ˆä¸åˆå§‹åŒ–lenï¼Œ ä¼šå‡ºäº‹åŒ–ä¸ºé»˜è®¤é›¶å€¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ 9// cap æ— æ³•è®¡ç®—map å®¹é‡ã€‚ len å¯ä»¥è®¡ç®—map æ•°æ®é•¿åº¦ map ä¸å­˜åœ¨çš„æ—¶å€™é»˜è®¤ä¼šé›¶å€¼ï¼Œå¯èƒ½ä¼šæœ‰æ­§ä¹‰\nåœ¨è®¿é—®çš„keyä¸å­˜åœ¨çš„æ—¶å€™ï¼Œä»ä¼šè¿”å›é›¶å€¼ï¼Œä¸èƒ½é€šè¿‡nilæ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚\nmap éå†ï¼Œ map æ˜¯å¦æ˜¯æœ‰åºçš„\nmap ä¸å·¥å‚æ¨¡å¼ï¼Œ å®ç°set\nå‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘\nmapçš„valueä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªæ–¹æ³• ä¸go çš„duck type æ¥å£æ–¹å¼ä¸€èµ·ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å•ä¸€æ–¹æ³•å¯¹è±¡çš„å·¥å‚æ¨¡å¼ å®ç°Set\ngo å†…ç½®é›†åˆä¸­æ²¡æœ‰setå®ç°ï¼Œå¯ä»¥map[type]struct{}\nå…ƒç´ çš„å”¯ä¸€æ€§ åŸºæœ¬æ“ä½œ æ·»åŠ å…ƒç´  åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨ åˆ é™¤å…ƒç´  å…ƒç´ ä¸ªæ•° å­—ç¬¦ä¸²\nunicodeï¼Œutf8\nstring æ˜¯æ•°æ®ç±»å‹ï¼Œä¸æ˜¯å¼•ç”¨æˆ–è€…æŒ‡é’ˆç±»å‹ stringæ˜¯åªè¯»çš„byte sliceï¼Œ lenå‡½æ•°å¯ä»¥è®¡ç®—æ‰€åŒ…å«çš„byteæ•° stringçš„byteæ•°ç»„å¯ä»¥å­˜æ”¾ä»»ä½•æ•°æ®ï¼Œ ä¸å¯è§äºŒè¿›åˆ¶ç¼–ç  string æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ byte slice\nunicode UTF8\nUnicode æ˜¯ä¸€ç§å­—ç¬¦é›†(code point) UTF8 æ˜¯unicodeçš„å­˜å‚¨å®ç°ï¼ˆè½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è§„åˆ™ï¼‰ å­—ç¬¦ â€œä¸­\u0026quot;\nUnicode 0x4E2D\nUTF-8 0xE4B8AD\nstring/[]byte [0xE4, 0xB8, 0xAD]\nå¸¸ç”¨å­—ç¬¦ä¸²å‡½æ•°\nstrings\nstrconv\nå‡½æ•° ä¸€ç­‰å…¬æ°‘\nå¯ä»¥æœ‰å¤šä¸ªè¿”å›å€¼ æ‰€æœ‰çš„å‚æ•°éƒ½æ˜¯å€¼ä¼ é€’ï¼Œ sliceï¼Œmap, channel å‡½æ•°å¯ä»¥ä½œä¸ºå˜é‡çš„å€¼ å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°çš„å’Œè¿”å›å€¼ ç±»ä¼¼äºè£…é¥°å™¨çš„demoï¼Œ é‡ç”¨\nã€Šè®¡ç®—æœºç¨‹åºçš„æ„é€ å’Œè§£é‡Šã€‹ å‡½æ•°å¼ç¼–ç¨‹\nå¯å˜å‚æ•°, ç±»å‹ä¸€ç›´ï¼Œæ— éœ€æŒ‡å®šå‚æ•°çš„ä¸ªæ•°\n1func sum(ops ...int)int{ 2\ts := 0 3\tfor _,op := ops{ 4\ts +=op 5\t} 6 return s 7} defer å‡½æ•°\né‡Šæ”¾é”ï¼Œæˆ–è€…å…³é—­èµ„æºï¼Œé¿å…èµ„æºçš„æµªè´¹\nå°è£…æ•°æ®å’Œè¡Œä¸º\nç»“æ„ä½“å®šä¹‰\n1type Employee struct{ 2 Id string 3 Name string 4 Age int 5} 6 7e := Employee{\u0026#34;0\u0026#34;,\u0026#34;Bob\u0026#34;,20} 8e1 := Employee{Name:\u0026#34;Mike\u0026#34;,Age:20} 9e2 := new(Employee) // æ³¨æ„ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯å¼•ç”¨/æŒ‡é’ˆ, ç›¸å½“äº e := \u0026amp;Employee{} 10e2.Id = \u0026#34;2\u0026#34; // ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„å·®å¼‚ï¼Œé€šè¿‡å®ä¾‹çš„æŒ‡é’ˆè®¿é—®æˆå‘˜ä¸éœ€è¦ -\u0026gt; 11e2.Age = 22 12e2.Name = \u0026#34;Rose\u0026#34; è¡Œä¸ºæ–¹æ³•å®šä¹‰\n1// ç¬¬ä¸€ä¸­æ–¹å¼åœ¨å®ä¾‹å¯¹åº”çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå®ä¾‹çš„æˆå‘˜ä¼šè¿›è¡Œå€¼å¤åˆ¶ 2func(e Employee) Stringï¼ˆï¼‰ string{ 3 return fmt.Sprintf(\u0026#34;ID:%s-Name:%s-Age:%s\u0026#34;, e.Id,e.Name,e.Age) 4} 5 6// é€šå¸¸æƒ…å†µä¸‹ä¸ºäº†é¿å…å†…å­˜copyæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ 7func(e *Employee) Stringï¼ˆï¼‰ string{ 8 return fmt.Sprintf(\u0026#34;ID:%s-Name:%s-Age:%s\u0026#34;, e.Id,e.Name,e.Age) 9} Goè¯­è¨€çš„ç›¸å…³æ¥å£\næ¥å£ä¸ºéä¾µå…¥æ€§ï¼Œå®ç°ä¸ä¾èµ–ä¸æ¥å£å®šä¹‰ æ‰€æœ‰æ¥å£çš„å®šä¹‰å¯ä»¥åŒ…å«åœ¨æ¥å£ä½¿ç”¨è€…åŒ…å†…ï¼ˆè§£å†³å¾ªç¯ä¾èµ–ï¼‰ interface åˆ¤æ–­æ˜¯å¦ä¸ºnil\nè‡ªå®šä¹‰ç±»å‹\n1type IntConvertionFn func(n int) int // è‡ªå®šä¹‰å‡½æ•°ç±»å‹ 2type MyPoint int æ‰©å±•ä¸æœç”¨\nå¤åˆvsç»§æ‰¿\nä¸æ”¯æŒLSP åŸåˆ™\nåŒ¿ååµŒå¥—ç±»å‹\næ— æ³•é‡è½½çˆ¶ç±»çš„æ–¹æ³• å¤šæ€\ninterface å¯¹åº”çš„åªèƒ½æ˜¯ä¸€ä¸ªstructçš„æŒ‡é’ˆ\nç©ºinterface\nç©ºæ¥å£å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»å‹\né€šè¿‡æ–­è¨€å°†ç©ºæ¥å£è½¬æ¢ä¸ºå®šåˆ¶ç±»å‹\n1v,ok := p.(int) // ok=true æ—¶è½¬æ¢æˆåŠŸ Go æ¥å£æœ€ä½³å®ç°\nsingle method interface\né”™è¯¯å¤„ç† æ²¡æœ‰å¼‚å¸¸æœºåˆ¶ï¼Œ\nGOçš„é”™è¯¯æœºåˆ¶\næ²¡æœ‰å¼‚å¸¸æœºåˆ¶ error ç±»å‹å®ç°äº†error æ¥å£ å¯ä»¥é€šè¿‡errors.New æ¥å¿«é€Ÿåˆ›å»ºé”™è¯¯å®ä¾‹ 1type error interface{ 2 Error() string 3} 4 5errors.New(\u0026#34;n must be in range[0,10]\u0026#34;) æœ‰é”™è¯¯åŠæ—©å¤±è´¥ï¼Œé¿å…åµŒå¥—\npackage\nåŸºæœ¬å¤ç”¨çš„æ¨¡å—å•å…ƒ\né¦–å­—æ¯å¤§å†™è¡¨æ˜å¯ä»¥è¢«åŒ…å¤–çš„ä»£ç è®¿é—®\nä»£ç çš„package å¯ä»¥å’Œæ‰€åœ¨çš„ç›®å½•ä¸ä¸€è‡´\nåŒä¸€ç›®å½•é‡Œçš„Goä»£ç çš„Packageè¦ä¿æŒä¸€è‡´\ninit\nåœ¨mainè¢«æ‰§è¡Œå‰ï¼Œæ‰€æœ‰ä¾èµ–çš„packageçš„initæ–¹æ³•éƒ½ä¼šè¢«æ‰§è¡Œ ä¸é€šåŒ…çš„initå‡½æ•°æŒ‰ç…§åŒ…å¯¼å…¥çš„ä¾èµ–å…³ç³»å†³å®šæ‰§è¡Œé¡ºåº æ¯ä¸ªåŒ…å¯ä»¥æœ‰å¤šä¸ªinitå‡½æ•° åŒ…çš„æ¯ä¸€ä¸ªæºæ–‡ä»¶ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªinitå‡½æ•°ï¼Œ go get -u \u0026lt; module name/ æºç çš„github è·¯å¾„ \u0026gt;\ngo get -u å¼ºåˆ¶ä»ç½‘ç»œæ›´æ–°è¿œç¨‹ä¾èµ–\npanic\nç”¨äºä¸å¯æ¢å¤çš„é”™è¯¯ æ¨å‡ºå‰ä¼šæ‰§è¡Œdeferçš„å†…å®¹ os.Exitï¼ˆï¼‰ é€€å‡ºæ—¶ä¸ä¼šè°ƒç”¨deferæŒ‡å®šçš„å‡½æ•°\nos.Exitï¼ˆï¼‰ é€€å‡ºæ—¶ä¸ä¼šè°ƒç”¨å½“å‰æ ˆä¿¡æ¯\nrecover\n1# java 2try{ 3}catch(Throwable t){} 4# c++ 5try{}catch(..){} 1defer func(){ 2 if err := recover(); err != nil{ 3 // æ¢å¤é”™è¯¯ 4 } 5}() æœ€å¸¸è§çš„â€œé”™è¯¯æ¢å¤â€\n1defer func(){ 2 if err:= recover(); err!= nil{ 3 log.Error(\u0026#34;recoverd panic\u0026#34;,err) 4 } 5}() 6// å½“å¿ƒrecoveræˆä¸ºæ¶é­” 7// å½¢æˆåƒµå°¸æœåŠ¡è¿›ç¨‹ï¼Œå¯¼è‡´health checkå¤±æ•ˆ 8// \u0026#34;Let it creash\u0026#34; å¾€å¾€æ˜¯æˆ‘ä»¬æ¢å¤ä¸ç¡®å®šæ€§é”™è¯¯çš„æœ€å¥½æ–¹æ³• 9// è®©å®ˆæŠ¤è¿›ç¨‹é‡å¯æœåŠ¡ ä¾èµ–ç®¡ç†\nåŒä¸€ç¯å¢ƒä¸‹ï¼Œä¸åŒé¡¹ç›®ä½¿ç”¨åŒä¸€åŒ…çš„ä¸åŒç‰ˆæœ¬ï¼Ÿ æ— æ³•ç®¡ç†å¯¹åŒ…çš„ç‰¹å®šç‰ˆæœ¬çš„ä¾èµ–ï¼Ÿ vendorè·¯å¾„\næŸ¥æ‰¾ä¾èµ–åŒ…è·¯å¾„çš„é¡ºåº\nåœ¨å½“å‰åŒ…çš„vendorç›®å½• å‘ä¸Šçº§ç›®å½•æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°src ä¸‹çš„vendorç›®å½• åœ¨GOPATHä¸‹é¢æŸ¥æ‰¾ä¾èµ–åŒ… åœ¨GOROOTç›®å½•ä¸‹æŸ¥æ‰¾ ç°åœ¨éƒ½ç”¨go mod\nåç¨‹æœºåˆ¶\nThread VS Goutine\nåˆ›å»ºæ—¶é»˜è®¤stackçš„å¤§å° JDK5ä»¥åJAVA Thread Stack é»˜è®¤ä¸º1M Goroutine çš„Stackåˆå§‹åŒ–å¤§å°ä¸º2k å’ŒKSE(kernel space entity)çš„å¯¹åº”å…³ç³» Java Thread æ˜¯1ï¼š1 Goroutine æ˜¯M:N çº¿ç¨‹åˆ‡æ¢ contextçš„æ¶ˆè€—é«˜\nè®¡æ•°æ¯ä¸ªprocesserå®Œæˆçš„æ•°é‡\nå¦‚æœç³»ç»Ÿè¿›ç¨‹åœ¨ç­‰å¾…IOäº†ï¼ŒPä¼šç»‘å®šå…¶ä»–çš„ç³»ç»Ÿçº¿ç¨‹\nä½¿ç”¨åç¨‹çš„æ—¶å€™æ³¨æ„é—­åŒ…çš„å‚æ•°ä¼ é€’\nå…±äº«å†…å­˜å’Œå¹¶å‘æœºåˆ¶\nLock\n1Lock lock=...; 2lock.lock() 3try{ 4\t// process 5}catch(Exception ex){ 6 7}finally{ 8 lock.unlock 9} 1package sync 2mutex 3RWLock WaitGroup\nRWLock è¯»ä¸æ˜¯äº’æ–¥çš„\nCSP (Communicating Sequential processes)å¹¶å‘æ§åˆ¶\næ— buffer çš„ç­‰å¾…ï¼ˆåŒæ–¹éƒ½åœ¨ï¼‰\nå¤šè·¯é€‰æ‹©å’Œè¶…æ—¶æ§åˆ¶\nå¦‚æœ retCh1 å’ŒretCH2 éƒ½readyçš„æƒ…å†µä¸‹ï¼Œæ— æ³•ä¿è¯selectçš„é¡ºåºã€‚\nå¦‚æœæ²¡æœ‰defaultä¼šé˜»å¡åœ¨select sessionä¸Š\né›ªå´©æ˜¯æ¯”quick failè¿˜è¦å¯æ€•çš„ä¸€ç§é”™è¯¯\nchannel çš„å…³é—­å’Œå¹¿æ’­\nchannelçš„å…³é—­\nå‘å…³é—­çš„channelå‘é€æ•°æ®ï¼Œä¼šå¯¼è‡´panic\næ¥å—å…³é—­çš„é€šé“çš„æ•°æ®ï¼Œæ¥å—åˆ°çš„æ˜¯å¯¹åº”æ•°æ®ç±»å‹çš„é›¶å€¼ï¼Œå¦‚æœé€šé“æœªå…³é—­ï¼Œä¸”é€šé“ä¸­æ²¡æœ‰æ•°æ®ï¼Œæ¥å—è€…ä¼šé˜»å¡\nv,ok \u0026lt;- chï¼Œ ok ä¸ºboolå€¼ï¼Œtrueè¡¨ç¤ºæ­£å¸¸æ¥å—ï¼Œfalseè¡¨ç¤ºé€šé“å…³é—­\næ‰€æœ‰channelæ¥å—è€…éƒ½ä¼šåœ¨channelå…³é—­æ—¶ï¼Œç«‹åˆ»ä»é˜»å¡ç­‰å¾…ä¸­è¿”å›ï¼Œä¸”ä¸Šè¿°okå€¼ä¸ºfalseã€‚è¿™ä¸ªå¹¿æ’­æœºåˆ¶å¸¸è¢«åˆ©ç”¨ï¼Œè¿›è¡Œå‘å¤šä¸ªè®¢é˜…è€…åŒæ—¶å‘é€ä¿¡å·ã€‚å¦‚ï¼Œé€€å‡ºä¿¡å·ã€‚\næ— é”é˜Ÿåˆ—ï¼Ÿï¼Ÿï¼Ÿ\nå¤šä¸ªreceiverçš„æƒ…å†µä¸‹\nç”Ÿäº§è€…åœ¨æ•°æ®å‘é€å®Œæˆåå¯ä»¥å…³é—­channel\nä»»åŠ¡çš„å–æ¶ˆï¼ˆå¤šæ¶ˆè´¹è€…ï¼‰\nContext ä¸ä»»åŠ¡å–æ¶ˆ\nContext\næ ¹Context, é€šè¿‡context.Background() åˆ›å»º\nå­Context: context.WithCancel(parentContext)\nctx, cancel := contxt.WithCancel(contxt.Background())\nå½“å‰contextå–æ¶ˆæ—¶å€™ï¼ŒåŸºäºä»–çš„å­context éƒ½ä¼šè¢«å–æ¶ˆã€‚\næ¥æ”¶å–æ¶ˆé€šçŸ¥ \u0026lt;- ctx.Done// cancel()\nåªè¿è¡Œä¸€æ¬¡\nsync.Once() åŸç†\nä»…éœ€ä»»æ„ä»»åŠ¡å®Œæˆ\næ‰€æœ‰ä»»åŠ¡å®Œæˆ\nå¯¹è±¡æ± ï¼ˆæ•°æ®åº“è¿æ¥ï¼Œç½‘ç»œè¿æ¥ï¼‰\nä½¿ç”¨buffered channelå®ç°å¯¹è±¡æ± \nå½’è¿˜å¯¹è±¡-\u0026gt; chan-\u0026gt; è·å–å¯¹è±¡\nsync pool å¯¹è±¡ç¼“å­˜\nsync.Pool å¯¹è±¡ç¼“å­˜ï¼Ÿï¼Ÿ sync cache\nhttps://gyazo.com/f8aeaf38cd3069044685d33868e6a12d\nhttps://gyazo.com/c32c6b3b02cbafab85d59d26375f0e71\nhttps://gyazo.com/af2fbba4e5b940ad64a41a570639ca98\nsync.Pool å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ\nGCä¼šæ¸…é™¤sync.Pool ç¼“å­˜çš„å¯¹è±¡ å¯¹è±¡ç¼“å­˜çš„æœ‰æ•ˆæœŸä¸ºä¸‹æ¬¡GCä¹‹å‰ åªè¦æ²¡æœ‰putæ“ä½œåœ¨ç§æœ‰å¯¹è±¡æ± é‡Œé¢æ˜¯æ²¡æœ‰çš„\nsync.Pool æ€»ç»“\né”å¸¦æ¥çš„å¼€é”€å¤§ï¼Œè¿˜æ˜¯åˆ›å»ºå¯¹è±¡å¸¦æ¥çš„å¼€é”€å¤§ï¼Ÿ https://gyazo.com/efb267b39289b30347c7478581d26890 åº·å¨å®šå¾‹ DDD\nè¯·æ±‚è¿›æ¥ï¼Œå‘ä¸‹æ‰‡å‡ºï¼Œå¹¶ä¸”callå¾ˆå¤šä¸‹æ¸¸API\nå•å…ƒæµ‹è¯•\n1func Square(n int)int{ 2 return n*n 3} 4 5func TestSquate(t *testing.T){ 6 inputs:=[...]int{1,2,3} 7 expected:=[...]int{1,4,9} 8 for i:=0;i\u0026lt;len(inputs);i++{ 9 ret := Square(inputs[i]) 10 if ret != expected[i]{ 11 t.Error(\u0026#34;input is %d, the expected is %d, the actual %d\u0026#34;, 12 input[i],expected[i],ret) 13 } 14 } 15} å†…ç½®å•å…ƒæµ‹è¯•æ¡†æ¶ï¼š\nFailï¼ŒError :è¯¥æµ‹è¯•å¤±è´¥ï¼Œè¯¥æµ‹è¯•ç»§ç»­ï¼Œå…¶ä»–æµ‹è¯•ç»§ç»­æ‰§è¡Œ FailNow, Fatal: è¯¥æµ‹è¯•å¤±è´¥ï¼Œè¯¥æµ‹è¯•ç»ˆæ­¢ï¼Œå…¶ä»–æµ‹è¯•ç»§ç»­æ‰§è¡Œ ä»£ç è¦†ç›–ç‡\ngo test -v -cover\næ–­è¨€ github.com/stretchr/testify\nBenchmark\nhttps://gyazo.com/aca94861bc4d40551e52e55d093947fa\nhttps://gyazo.com/b77c73ac12c5926f0a98c49eddd70e7f\n1go test -bench=. https://gyazo.com/f5f279536e4e069ed150839d395ee628\nBDD\nBehavior Driven Development\nhttps://gyazo.com/5d5ffb45da7404bb33ba185700767109\nhttps://gyazo.com/df785c94e5e02756c3dbe12c7fe71707\nhttps://gyazo.com/9a616c400ae7216c310fd4b19a11fae4\nhttps://gyazo.com/be028ad50b5833a27bb799a5683b7bd1\nåå°„ç¼–ç¨‹\nreflect.TypeOf vs reflect.ValueOf\nreflect.TypeOf è¿”å›å€¼ç±»å‹ reflect.Type\nreflect.ValueOf è¿”å›å€¼ reflect.Value\nå¯ä»¥ä»reflect.Value è·å¾—ç±»å‹\nå¯ä»¥é€šè¿‡kindåˆ¤æ–­ç±»å‹\nhttps://gyazo.com/b93fce6a84469927612985a4cfac0e10\nhttps://gyazo.com/c427b98e181d3df67aab98d0f33f08c9\n1 2type Employee struct{ 3\tEmployeeId string 4\tName string `format:\u0026#34;normal\u0026#34;` 5\tAge int 6} 7func(e *Employee)UpdateAge(newVal int){ 8\te.Age = newVal 9} 10 11type Customer struct{ 12\tCookieId string 13\tName string 14\tAge int 15} 16 17func TestInvokeByName(t *testing.T){ 18\te :=\u0026amp;Employee{\u0026#34;1\u0026#34;,\u0026#34;Mike\u0026#34;,30} 19\t// ç›´æ¥è·å–æˆå‘˜ 20\tt.Logf(\u0026#34;Name: value(%[1]v),Type(%[1]T)\u0026#34;,reflect.ValueOf(*e).FieldByName(\u0026#34;Name\u0026#34;)) 21\t// æˆå‘˜å¯èƒ½ä¸å­˜åœ¨ 22\tif nameField,ok := reflect.TypeOf(*e).FieldByName(\u0026#34;Name\u0026#34;);!ok{ 23\tt.Error(\u0026#34;Failed to get \u0026#39;Name\u0026#39; field.\u0026#34;) 24\t}else{ 25\tt.Log(\u0026#34;Tag: format\u0026#34;,nameField.Tag.Get(\u0026#34;format\u0026#34;)) 26\t} 27\treflect.ValueOf(e).MethodByName(\u0026#34;UpdateAge\u0026#34;).Call([]reflect.Value{reflect.ValueOf(1)}) 28\tt.Log(\u0026#34;Updated Age:\u0026#34;e) 29} https://gyazo.com/b266dc5d61461672dfe210005190ae8b\nä¸‡èƒ½ç¨‹åº\nDeepEqual\næ¯”è¾ƒåˆ‡ç‰‡å’ŒMap\n1func TestDeepEqual(t *testing.T){ 2 a:= map[int]string{1:\u0026#34;one\u0026#34;,2:\u0026#34;two\u0026#34;,3:\u0026#34;three\u0026#34;} 3 b:= map[int]string{1:\u0026#34;one\u0026#34;,2:\u0026#34;two\u0026#34;,3:\u0026#34;three\u0026#34;} 4 t.Log(reflect.DeepEqual(a,b)) 5 6 s1 := []int{1,2,3} 7 s2 := []int{1,2,3} 8 s2 := []int{3,2,1} 9 t.Log(reflect.DeepEqual(s1,s2)) 10 t.Log(reflect.DeepEqual(s1,s3)) 11 12 c1 := Custumer{\u0026#34;1\u0026#34;,\u0026#34;Mike\u0026#34;,40} 13 c2 := Custumer{\u0026#34;1\u0026#34;,\u0026#34;Mike\u0026#34;,40} 14 t.Log(reflect.DeepEqual(c1,c2)) 15 16 17} https://gyazo.com/a10a1bcb995573dd695ab27d362ceca1\nhttps://gyazo.com/fc411a9bea3bba9c78f13bb9f47f57a8\nhttps://gyazo.com/ebd871ec44f80daf8b4d50d59fba0a9e\nhttps://gyazo.com/5a7666fe357f7a9576db005cd53eb745\nhttps://gyazo.com/a5b94370bac23e75094e495405c111f1\nå…³äºåå°„ä½ åº”è¯¥çŸ¥é“çš„\næé«˜äº†ç¨‹åºçš„çµæ´»æ€§ï¼Œé™ä½äº†ç¨‹åºçš„å¯è¯»æ€§ï¼Œé™ä½äº†ç¨‹åºçš„æ€§èƒ½ ä¸å®‰å…¨ç¼–ç¨‹\nhttps://gyazo.com/917b71d73089020c708b31836cce58b2\nhttps://gyazo.com/f500624a5a03fa01e39bf2cf6f9f3e28\nhttps://gyazo.com/e63eb8f56624a55d773ca820c119b65d\nhttps://gyazo.com/2e992064b118159d0a58a656d017d380\nhttps://gyazo.com/9c90262305e5b81aa0005ff9bf16ca15\nhttps://gyazo.com/a3ca87532dab82e02ec360a144ad18b6\næ¶æ„æ¨¡å¼\nhttps://gyazo.com/3d2dd605b897f106549c2939da35182e\nPipe-Filter æ¶æ„\nhttps://gyazo.com/ea75711a765ce8554e2854afb974658e\néå¸¸é€‚åˆæ•°æ®å¤„ç†ä»¥åŠæ•°æ®åˆ†æç³»ç»Ÿ\nFilterå°è£…æ•°æ®å¤„ç†çš„åŠŸèƒ½\næ¾è€¦åˆï¼š Filteråªè·Ÿæ•°æ®(æ ¼å¼)è€¦åˆ\nPipeç”¨äºè¿æ¥Filterä¼ é€’æ•°æ®ï¼Œæˆ–è€…åœ¨å¼‚æ­¥å¤„ç†è¿‡ç¨‹ä¸­ç¼“å†²æ•°æ®æµï¼Œ\nè¿›ç¨‹å†…åŒæ­¥è°ƒç”¨æ—¶ï¼Œpipeæ¼”å˜ä¸ºæ•°æ®åœ¨æ–¹æ³•è°ƒç”¨é—´ä¼ é€’\nhttps://gyazo.com/dfe390ab438b9758de391accd05fb082\nhttps://gyazo.com/eb5079cf5f82c333c83af1b90b69078a\nhttps://gyazo.com/674b755eeb2b3bd401d4e1afb79abb3e\nå†…ç½®Jsonè§£æ\nhttps://gyazo.com/62caf1d3ac52c3641583b05c91e651b3\neasyJson\nå°½é‡å°‘çš„ä½¿ç”¨åå°„\nhttps://gyazo.com/9d35fb4b70f7b028d9650d5481b0d297\nGo ç¨‹åºè®¾è®¡è¯­è¨€\né¢å‘æ¨¡å¼çš„è½¯ä»¶æ¶æ„\nè®¡ç®—æœºç¨‹åºçš„æ„é€ å’Œè§£é‡Š\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/99_jike_go_note/","summary":"è½¯ä»¶å¼€å‘çš„æ–°æŒ‘æˆ˜\nå¤šæ ¸ç¡¬ä»¶æ¶æ„\nè¶…å¤§è§„æ¨¡åˆ†å¸ƒå¼è®¡ç®—é›†ç¾¤\nwebæ¨¡å¼ä¸‹å¯¼è‡´çš„å‰æ‰€æœªæœ‰çš„è§„æ¨¡å’Œæ›´æ–°é€Ÿåº¦\nåŒºå—é“¾å¼€å‘è¯­è¨€ï¼Œ\nKubernetes\nDocker\nåªæœ‰25ä¸ªå…³é”®å­—\næœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥ç›´æ¥ä½¿ç”¨æŒ‡é’ˆè®¿é—®å†…å­˜\nCSPå¹¶å‘æœºåˆ¶\nå…³é”®å­—\nc 37\nc++ 11 84\ngo 25\ngo åƒåœ¾å›æ”¶ï¼Œä½¿ç”¨æŒ‡é’ˆç›´æ¥å†…å­˜è®¿é—®.\nå¤åˆå’Œç»§æ‰¿\ndocker kubernetes\ngo é»˜è®¤ä½¿ç”¨é™æ€è¿æ¥ï¼Œç¼–è¯‘å®Œæˆæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶\n1package main // package name 2 3import \u0026#34;fmt\u0026#34; // dependence 4 5// functionality 6func main() { 7\tfmt.Print(\u0026#34;hello world \\n\u0026#34;) 8} åº”ç”¨ç¨‹åºå…¥å£ï¼Œ\nå¿…é¡»æ˜¯mainåŒ… package main å¿…é¡»æ˜¯mainæ–¹æ³• func main() æ–‡ä»¶åä¸ä¸€å®šæ˜¯main.go package çš„åå­—ä¸éœ€è¦ä¸ç›®å½•ä¿æŒä¸€è‡´\né€€å‡ºè¿”å›å€¼\nä¸å…¶ä»–ä¸»è¦ç¼–ç¨‹è¯­è¨€çš„å·®å¼‚\nGo mainå‡½æ•°ä¸æ”¯æŒä»»ä½•è¿”å›å€¼ é€šè¿‡os.Exit æ¥è¿”å›çŠ¶æ€ 1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;os\u0026#34; 6) 7 8func main() { 9\tfmt.","tags":null,"title":""},{"categories":null,"contents":" 1package dal 2 3import \u0026#34;testing\u0026#34; 4 5func Empty() { 6\tstr := \u0026#34;12312\u0026#34; 7\tif str == \u0026#34;\u0026#34; { 8 9\t} 10} 11func Lenzero() { 12\tstr := \u0026#34;\u0026#34; 13\tif len(str) == 0 { 14 15\t} 16} 17func BenchmarkEmpty(b *testing.B) { 18\tfor n := 0; n \u0026lt; b.N; n++ { 19\tEmpty() 20\t} 21} 22 23func BenchmarkLenzero(b *testing.B) { 24\tfor n := 0; n \u0026lt; b.N; n++ { 25\tLenzero() 26\t} 27} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/base/string_operate/","summary":"1package dal 2 3import \u0026#34;testing\u0026#34; 4 5func Empty() { 6\tstr := \u0026#34;12312\u0026#34; 7\tif str == \u0026#34;\u0026#34; { 8 9\t} 10} 11func Lenzero() { 12\tstr := \u0026#34;\u0026#34; 13\tif len(str) == 0 { 14 15\t} 16} 17func BenchmarkEmpty(b *testing.B) { 18\tfor n := 0; n \u0026lt; b.N; n++ { 19\tEmpty() 20\t} 21} 22 23func BenchmarkLenzero(b *testing.B) { 24\tfor n := 0; n \u0026lt; b.","tags":null,"title":""},{"categories":null,"contents":"é›¶copyï¼Œ\nclose wait and time wait. Tcp/IP\nhttps\ntcp æ‹¥å¡æ§åˆ¶ï¼Œç²˜åŒ…\nio, select, epoll\nçº¢é»‘æ ‘\u0026amp;\nraft\nå…ƒç©ºé—´ä¸­åˆ›å»ºå¯¹è±¡ä¼šä¸ä¼šç”¨åˆ°ç‰©ç†å†…å­˜\næ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² 106 25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ 84 206. åè½¬é“¾è¡¨ 83 215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  81 146. LRUç¼“å­˜æœºåˆ¶ https://www.zhihu.com/question/339135205\nGolang slice å¯ä»¥åŠ¨æ€æ‰©å®¹ï¼Œä½†æ˜¯å¦‚ä½•åŠ¨æ€ç¼©å®¹å‘¢ï¼Ÿ\nGolang race\nHeap å’Œstack\nporm æŠ€æœ¯æ ˆtest golang æ•™ç¨‹\nhttps://www.kancloud.cn/mutouzhang/gocookbook/686698\nhttps://gobyexample.com/sha1-hashes\nhttp://c.biancheng.net/view/vip_7363.html\nprome æ•™ç¨‹\nhttp://www.eryajf.net/2468.html\nhttps://ethancai.github.io/2016/06/23/bad-parts-about-json-serialization-in-Golang/\n123123123123\nhttps://www.robustperception.io/cardinality-is-key\nhttps://github.com/nusr/hacker-laws-zh\nç¼–è¯‘åŸç†\nhttps://segmentfault.com/a/1190000020239208\nraft\nGDPR æŠ¥è­¦\ngrafql\nhttps://jobs.intel.com/ShowJob/Id/2891615/Cloud-Native-Runtime-Development-Engineer\nhttps://jobs.intel.com/ShowJob/Id/2829606/Software-Development-Engineer\nhttps://jobs.intel.com/ShowJob/Id/2891612/Edge-Software-Engineer\n*https://jobs.intel.com/ShowJob/Id/2891618/Cloud-Native-Software-Engineer\nä¸»é¢˜æ›´æ–°ç»´æŠ¤ æ²¡æœ‰æ—¶é—´é˜…è¯»ï¼Œå¾ˆéš¾æ·±åº¦æ€è€ƒ\nå—å­˜å‚¨\nBook Read ã€ŠKubernetesç½‘ç»œæƒå¨æŒ‡å—ã€‹\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/Plan/","summary":"é›¶copyï¼Œ\nclose wait and time wait. Tcp/IP\nhttps\ntcp æ‹¥å¡æ§åˆ¶ï¼Œç²˜åŒ…\nio, select, epoll\nçº¢é»‘æ ‘\u0026amp;\nraft\nå…ƒç©ºé—´ä¸­åˆ›å»ºå¯¹è±¡ä¼šä¸ä¼šç”¨åˆ°ç‰©ç†å†…å­˜\næ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² 106 25. K ä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ 84 206. åè½¬é“¾è¡¨ 83 215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  81 146. LRUç¼“å­˜æœºåˆ¶ https://www.zhihu.com/question/339135205\nGolang slice å¯ä»¥åŠ¨æ€æ‰©å®¹ï¼Œä½†æ˜¯å¦‚ä½•åŠ¨æ€ç¼©å®¹å‘¢ï¼Ÿ\nGolang race\nHeap å’Œstack\nporm æŠ€æœ¯æ ˆtest golang æ•™ç¨‹\nhttps://www.kancloud.cn/mutouzhang/gocookbook/686698\nhttps://gobyexample.com/sha1-hashes\nhttp://c.biancheng.net/view/vip_7363.html\nprome æ•™ç¨‹\nhttp://www.eryajf.net/2468.html\nhttps://ethancai.github.io/2016/06/23/bad-parts-about-json-serialization-in-Golang/\n123123123123\nhttps://www.robustperception.io/cardinality-is-key\nhttps://github.com/nusr/hacker-laws-zh\nç¼–è¯‘åŸç†\nhttps://segmentfault.com/a/1190000020239208\nraft\nGDPR æŠ¥è­¦\ngrafql\nhttps://jobs.intel.com/ShowJob/Id/2891615/Cloud-Native-Runtime-Development-Engineer\nhttps://jobs.intel.com/ShowJob/Id/2829606/Software-Development-Engineer\nhttps://jobs.intel.com/ShowJob/Id/2891612/Edge-Software-Engineer\n*https://jobs.intel.com/ShowJob/Id/2891618/Cloud-Native-Software-Engineer\nä¸»é¢˜æ›´æ–°ç»´æŠ¤ æ²¡æœ‰æ—¶é—´é˜…è¯»ï¼Œå¾ˆéš¾æ·±åº¦æ€è€ƒ\nå—å­˜å‚¨\nBook Read ã€ŠKubernetesç½‘ç»œæƒå¨æŒ‡å—ã€‹","tags":null,"title":""},{"categories":null,"contents":"ESXI configuration and usage ESXI admin interface : https://10.239.241.100/\n1user: root passwd: CREshare- è·³æ¿æœºCRE-relay\n1ssh cre@cre-relay.sh.intel.com # 10.239.241.116 2user: cre passwd: 123456 BIOSï¼š123456/123123\nHow to create a VM with SGX and NIC direct mode 1.select a creation type 2.Select a name and guest OS 3.Select storage 4.Customize settings, CPU/Mem/Disk/SGX/PCI device, and select an OS image SGX enable Add a PCI device Select an OS Image 5.Start your machine and check the status ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/CRE-Share/","summary":"ESXI configuration and usage ESXI admin interface : https://10.239.241.100/\n1user: root passwd: CREshare- è·³æ¿æœºCRE-relay\n1ssh cre@cre-relay.sh.intel.com # 10.239.241.116 2user: cre passwd: 123456 BIOSï¼š123456/123123\nHow to create a VM with SGX and NIC direct mode 1.select a creation type 2.Select a name and guest OS 3.Select storage 4.Customize settings, CPU/Mem/Disk/SGX/PCI device, and select an OS image SGX enable Add a PCI device Select an OS Image 5.Start your machine and check the status ","tags":null,"title":""},{"categories":null,"contents":"openwrt login 1curl -XPOST curl --location -v --request POST \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/?luci_username=root\u0026amp;luci_password=root1\u0026#39; --cacert ./ca.pem 2 3 # Cert is the cnf-default-cert, must use the h 4curl --location -v --request POST \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/\u0026#39; \\ 5--header \u0026#39;Content-Type: application/x-www-form-urlencoded\u0026#39; \\ 6--data-urlencode \u0026#39;luci_username=root\u0026#39; \\ 7--data-urlencode \u0026#39;luci_password=root1\u0026#39; \\ 8--cacert ./ca.pem Create CSR\n1curl -XGET \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/sdewan/nat/v1/nats\u0026#39; --cacert ./ca.pem 1curl -XGET \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/sdewan/pkcs11/v1/crs\u0026#39; --cacert ./ca.pem 1#!/bin/bash 2 3set -x 4 5cnf_ip=\u0026#34;10-233-76-144.default.pod.cluster.local\u0026#34; 6cert_label=\u0026#34;node-1\u0026#34; 7cert_subject=\u0026#34;/CN=node-1\u0026#34; 8 9# you alway a same csr, even you try many times 10curl --location --request POST \u0026#34;https://${cnf_ip}/cgi-bin/luci/sdewan/pkcs11/v1/crs\u0026#34; \\ 11--header \u0026#39;Content-Type: application/json\u0026#39; \\ 12--data-raw \u0026#34;{ 13 \\\u0026#34;cert\\\u0026#34;: { 14 \\\u0026#34;key_pair\\\u0026#34;: { 15 \\\u0026#34;key_type\\\u0026#34;: \\\u0026#34;rsa:2048\\\u0026#34;, 16 \\\u0026#34;label\\\u0026#34;: \\\u0026#34;${cert_label}\\\u0026#34;, 17 \\\u0026#34;id\\\u0026#34;: \\\u0026#34;0001\\\u0026#34; 18 }, 19 \\\u0026#34;subject\\\u0026#34;: \\\u0026#34;${cert_subject}\\\u0026#34;, 20 \\\u0026#34;pem\\\u0026#34;: \\\u0026#34;\\\u0026#34; 21 } 22}\u0026#34; --cert ca.pem | tee new.csr 23 24openssl x509 -req -days 365 -CA caCert.pem -CAkey caKey.pem -set_serial 1 -in new.csr -out client.crt 25 26cert=\u0026#34;-----BEGIN CERTIFICATE-----\\n$(cat client.crt|awk \u0026#34;NR\u0026gt;1{print $1}\u0026#34;|sed \u0026#39;$d\u0026#39;|tr -d \u0026#34;\\n\u0026#34;)\\n-----END CERTIFICATE-----\u0026#34; 27 28curl --location --request POST \u0026#34;https://${cnf_ip}/cgi-bin/luci/sdewan/pkcs11/v1/cert\u0026#34; \\ 29--header \u0026#39;Content-Type: application/json\u0026#39; \\ 30--data-raw \u0026#34;{ 31 \\\u0026#34;token\\\u0026#34;: { 32 \\\u0026#34;label\\\u0026#34;: \\\u0026#34;sdewan-sgx\\\u0026#34;, 33 \\\u0026#34;slot\\\u0026#34;: 0, 34 \\\u0026#34;so_pin\\\u0026#34;: \\\u0026#34;12345678\\\u0026#34;, 35 \\\u0026#34;pin\\\u0026#34;: \\\u0026#34;12345678\\\u0026#34; 36 }, 37 \\\u0026#34;cert\\\u0026#34;: { 38 \\\u0026#34;key_pair\\\u0026#34;: { 39 \\\u0026#34;key_type\\\u0026#34;: \\\u0026#34;rsa:2048\\\u0026#34;, 40 \\\u0026#34;label\\\u0026#34;: \\\u0026#34;node-1\\\u0026#34;, 41 \\\u0026#34;id\\\u0026#34;: \\\u0026#34;12345678\\\u0026#34; 42 }, 43 \\\u0026#34;subject\\\u0026#34;: \\\u0026#34;/CN=node-1\\\u0026#34;, 44 \\\u0026#34;pem\\\u0026#34;: \\\u0026#34;${cert}\\\u0026#34; 45 } 46}\u0026#34; 1pkcs11-tool --module /lib/x86_64-linux-gnu/pkcs11/p11-kit-client.so -L 2 2 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 3 3 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -b --type cert --label node-1 4 4 pkcs11-tool --module /usr/local/lib/libp11sgx.so -L 5 5 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -b --type cert --label node-1 --slot 0x7bfa3749 6 6 pkcs11-tool --module /usr/local/lib/libp11sgx.so -L 7 7 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 8 8 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -b --type cert --label node-1 --slot 0x7bfa3749 9 9 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 10 10 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -b --type cert --label node-1 --slot 0x7bfa3749 11 11 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 12 12 pkcs11-tool --help \u0026gt; help 13 13 vi help 14 14 apt update 15 15 apt install vim 16 16 ls 17 17 vi help 18 18 -O 19 19 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 20 20 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -b --type cert --label node-1 --slot 0x7bfa3749 21 21 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 22 22 pkcs11-tool --module /usr/local/lib/libp11sgx.so -L 23 23 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 24 24 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -b --type cert --label node-1 --token sdewan-sgx 25 25 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O 26 26 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -b --type cert --label node-1 --token sdewan-sgx 27 28 29 30 certificatesigningrequests.certificates.k8s.io ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/sdewan-cnf-test/","summary":"openwrt login 1curl -XPOST curl --location -v --request POST \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/?luci_username=root\u0026amp;luci_password=root1\u0026#39; --cacert ./ca.pem 2 3 # Cert is the cnf-default-cert, must use the h 4curl --location -v --request POST \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/\u0026#39; \\ 5--header \u0026#39;Content-Type: application/x-www-form-urlencoded\u0026#39; \\ 6--data-urlencode \u0026#39;luci_username=root\u0026#39; \\ 7--data-urlencode \u0026#39;luci_password=root1\u0026#39; \\ 8--cacert ./ca.pem Create CSR\n1curl -XGET \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/sdewan/nat/v1/nats\u0026#39; --cacert ./ca.pem 1curl -XGET \u0026#39;https://10-233-76-144.default.pod.cluster.local/cgi-bin/luci/sdewan/pkcs11/v1/crs\u0026#39; --cacert ./ca.pem 1#!/bin/bash 2 3set -x 4 5cnf_ip=\u0026#34;10-233-76-144.default.pod.cluster.local\u0026#34; 6cert_label=\u0026#34;node-1\u0026#34; 7cert_subject=\u0026#34;/CN=node-1\u0026#34; 8 9# you alway a same csr, even you try many times 10curl --location --request POST \u0026#34;https://${cnf_ip}/cgi-bin/luci/sdewan/pkcs11/v1/crs\u0026#34; \\ 11--header \u0026#39;Content-Type: application/json\u0026#39; \\ 12--data-raw \u0026#34;{ 13 \\\u0026#34;cert\\\u0026#34;: { 14 \\\u0026#34;key_pair\\\u0026#34;: { 15 \\\u0026#34;key_type\\\u0026#34;: \\\u0026#34;rsa:2048\\\u0026#34;, 16 \\\u0026#34;label\\\u0026#34;: \\\u0026#34;${cert_label}\\\u0026#34;, 17 \\\u0026#34;id\\\u0026#34;: \\\u0026#34;0001\\\u0026#34; 18 }, 19 \\\u0026#34;subject\\\u0026#34;: \\\u0026#34;${cert_subject}\\\u0026#34;, 20 \\\u0026#34;pem\\\u0026#34;: \\\u0026#34;\\\u0026#34; 21 } 22}\u0026#34; --cert ca.","tags":null,"title":""},{"categories":null,"contents":"Leverage TEE to enhance the integrity and security of the SASE network\nSoftware-Define wide area network is one of the most essential components of the SASE architecture, which is based on network technologies that create virtualized WAN connections. SD-WAN decouples the network services from the underlying networks and allows the application traffic to be carried independently of the underlying network hardware, enabling the client\u0026rsquo;s connection anywhere to the applications. How to build up a strong shield for the overlay network of SD-WAN has become a hot issue in the industry. Most virtual private network (VPN) technology needs a certificate for authentication and cryptographic operations. The traditional hardware security module (HSM) is the best plugin for most VPN services to provide cryptographic functions., However, in the SASE scenario, most applications need the capability of scaling and dynamic migration capability, but the physical HSM is hard to meet.\nOur solution utilizes the Trusted Execution Environment (TEE) technology (e.g., Intel SGX) embedded in generic servers to build and cloud-native HSM service to provide extra defense against the attack by protecting the keys used during a handshake. We can achieve flexibility, performance, security, and cloud-scale network service by integrating inside the SD-WAN solution. In this presentation, we will demonstrate how we leverage the power of hardware TEE to protect the overlay network establishment and transportation.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/sdewan-proposal/","summary":"Leverage TEE to enhance the integrity and security of the SASE network\nSoftware-Define wide area network is one of the most essential components of the SASE architecture, which is based on network technologies that create virtualized WAN connections. SD-WAN decouples the network services from the underlying networks and allows the application traffic to be carried independently of the underlying network hardware, enabling the client\u0026rsquo;s connection anywhere to the applications. How to build up a strong shield for the overlay network of SD-WAN has become a hot issue in the industry.","tags":null,"title":""},{"categories":null,"contents":"Test Result Passed Case: Cluster k8s scc crd-controller cnf cert-manager overlay v1.17.0 old version latest version 0.5.1 v1.1.0 hub/edge-1/edge-2 v1.23.0 - latest version 0.5.1 v1.6.1 Failed Case: case1:\nCluster k8s scc crd-controller cnf cert-manager overlay v1.23.0 new version latest version 0.5.1 v1.6.1 hub/edge-1/edge-2 v1.23.0 - latest version 0.5.1 v1.6.1 case2:\nCluster k8s scc crd-controller cnf cert-manager overlay v1.23.0 new version latest version 0.5.0 v1.6.1 hub/edge-1/edge-2 v1.23.0 - latest version 0.5.0 v1.6.1 Bugs: CNF can\u0026rsquo;t auto load cacert \u0026ldquo;CN=overlay1-cert\u0026rdquo; from /etc/ipsec.d/cacerts/localtodevice*_ca.pem. If multiple cacerts in one file, Strongswan only can load the first cert through ipsec rereadall. Do not find the root cause, on in the Failed Case. If the Default NAT CR added the Iptables rule to CNF before the Data Plane Tunnel is established, it will add a wrong rule without an interface name. this bug also exist in Passed Case. DNS IP 10.248.2.5\nvi /etc/resolve.conf\n1sysctl net.ipv4.ip_forward xxxxxxxxxx udhcpc -i net1\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/test-result/","summary":"Test Result Passed Case: Cluster k8s scc crd-controller cnf cert-manager overlay v1.17.0 old version latest version 0.5.1 v1.1.0 hub/edge-1/edge-2 v1.23.0 - latest version 0.5.1 v1.6.1 Failed Case: case1:\nCluster k8s scc crd-controller cnf cert-manager overlay v1.23.0 new version latest version 0.5.1 v1.6.1 hub/edge-1/edge-2 v1.23.0 - latest version 0.5.1 v1.6.1 case2:\nCluster k8s scc crd-controller cnf cert-manager overlay v1.23.0 new version latest version 0.5.0 v1.6.1 hub/edge-1/edge-2 v1.23.0 - latest version 0.5.0 v1.","tags":null,"title":""},{"categories":null,"contents":"RabbitMQ æ¶ˆæ¯ä¸­é—´ä»¶ æŠ€æœ¯ç²¾è®²\n1. RabbitMQ ç®€ä»‹ä»¥åŠAMQPåè®® RabbitMQ æ˜¯ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯ä»£ç†å’Œ\nRabbitMQåº•å±‚æ˜¯é‡‡ç”¨Erlangè¯­è¨€è¿›è¡Œç¼–å†™ å¼€æºã€æ€§èƒ½ä¼˜ç§€ï¼Œ ç¨³å®šæ€§ä¿éšœ ä¸spring AMQPå®Œç¾æ•´åˆï¼ŒAPIä¸°å¯Œ é›†ç¾¤æ¨¡å¼ä¸°å¯Œï¼Œè¡¨è¾¾å¼é…ç½®ï¼Œ HAæ¨¡å¼ï¼Œ é•œåƒé˜Ÿåˆ—æ¨¡å‹ ä¿è¯æ•°æ®ä¸ä¸¢å¤±çš„å‰æåšåˆ°é«˜å¯é æ€§ï¼Œå¯ç”¨æ€§ AMQPï¼š é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®® RabbitMQ çš„å®‰è£…ä»¥åŠä½¿ç”¨ erlang socat rabbitmq-server rpm -ivh XXXXX.rpm lsof -i:5672 # æŸ¥çœ‹ç«¯å£ å¯ç”¨æ§åˆ¶å°æ’ä»¶ rabbit å¯ä»¥é€‰æ‹©ä½¿ç”¨å†…å­˜è¿›è¡Œå­˜å‚¨\nRabbitMQ æ ¸å¿ƒæ¦‚å¿µ AMQPæ ¸å¿ƒæ¦‚å¿µ\nServerï¼šåˆç§°ä½œBrokerï¼Œ æ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå®ç°AMQPå®ä½“æœåŠ¡\nConnectionï¼š è¿æ¥ï¼Œ åº”ç”¨ç¨‹åºä¸Brokerçš„ç½‘ç»œè¿æ¥\nChannelï¼š ç½‘ç»œä¿¡é“ï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½åœ¨Channelä¸­è¿›è¡Œï¼ŒChannelæ˜¯è¿›è¡Œæ¶ˆæ¯è¯»å†™çš„ä¸€ä¸ªé€šé“ã€‚å®¢æˆ·ç«¯å¯ä»¥å»ºç«‹å¤šä¸ªChannelï¼Œæ¯ä¸ªChannelä»£è¡¨ä¸€ä¸ªä¼šè¯ä»»åŠ¡ã€‚\nMessageï¼š æ¶ˆæ¯ï¼Œ æœåŠ¡å™¨å’Œåº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€çš„æ•°æ®ï¼Œç”±Propertieså’ŒBodyç»„æˆã€‚Propertieså¯ä»¥å¯¹æ¶ˆæ¯è¿›è¡Œä¿®é¥°ï¼Œæ¯”å¦‚æ¶ˆæ¯çš„ä¼˜å…ˆçº§ã€å»¶è¿Ÿç­‰é«˜çº§ç‰¹æ€§ï¼›Bodyåˆ™å°±æ˜¯æ¶ˆæ¯ä½“å†…å®¹ã€‚\nVirtual hostï¼š è™šæ‹Ÿåœ°å€ï¼Œç”¨äºè¿›è¡Œé€»è¾‘éš”ç¦»ï¼Œæ˜¯æœ€ä¸Šå±‚çš„æ¶ˆæ¯è·¯ç”±ã€‚ä¸€ä¸ªVirtual Hosté‡Œé¢å¯ä»¥æœ‰è‹¥å¹²ä¸ªExchange å’ŒQueueï¼Œ åŒä¸€ä¸ªVirtual Hosté‡Œé¢ä¸èƒ½æœ‰ç›¸åŒåç§°çš„Exchangeæˆ–Queueã€‚\nExchangeï¼š äº¤æ¢æœºï¼Œæ¥æ”¶æ¶ˆæ¯ï¼Œæ ¹æ®è·¯ç”±é”®è½¬å‘æ¶ˆæ¯åˆ°ç»‘å®šçš„é˜Ÿåˆ—\nBindingï¼š Exchange å’ŒQueueä¹‹é—´çš„è™šæ‹Ÿè¿æ¥ï¼Œbindingå¯ä»¥åŒ…å«routing key\nRouting key: ä¸€ä¸ªè·¯ç”±è§„åˆ™ï¼Œè™šæ‹Ÿæœºå¯ä»¥ç”¨å®ƒæ¥ç¡®å®šå¦‚ä½•è·¯ç”±ä¸€ä¸ªç‰¹å®šæ¶ˆæ¯\nQueueï¼š ä¹Ÿç§°ä¸ºMassage Queue, æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¿å­˜æ¶ˆæ¯å¹¶å°†ä»–ä»¬è½¬å‘ç»™æ¶ˆè´¹è€…\nRabbitMQ RabbitMQé»˜è®¤ç«¯å£å· 4369 (epmd), 25672 (Erlang distribution) 4369 erlang å‘ç°ç«¯å£ 25672 serveré—´é€šä¿¡ç«¯å£ 5672, 5671 (AMQP 0-9-1 without and with TLS) clientç«¯é€šä¿¡å£ 15672 (if management plugin is enabled) ç®¡ç†ç•Œé¢uiç«¯å£ 61613, 61614 (if STOMP is enabled) 1883, 8883 (if MQTT is enabled) ç”Ÿäº§ç«¯çš„å¯é æŠ•é€’ ä¿è¯æ¶ˆæ¯ä»ç”Ÿäº§è€…åˆ°MQä¹‹é—´çš„ä¼ è¾“æ˜¯100%å¯é çš„ï¼Œç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ä¸€å®šèƒ½è¿›å…¥æ¶ˆæ¯é˜Ÿåˆ—\nä¿éšœæ¶ˆæ¯æˆåŠŸå‘å‡ºï¼Œ å¦‚æœä¸­é€”ç”±äºç½‘ç»œæˆ–è€…å…¶ä»–åŸå› å¯¼è‡´å‘é€å¤±è´¥ï¼Œè¦ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Œå¯ä»¥å†æ¬¡å‘é€ã€‚ ï¼ˆå¦‚æœæ¶ˆæ¯å‘é€æˆåŠŸï¼Œä½†æ˜¯æ¶ˆè´¹ç«¯å¯¹æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œä¹Ÿè¦è€ƒè™‘æ¶ˆæ¯çš„é‡æ–°å¤„ç†ï¼Œä½†ä¸å±äºæ­¤èŒƒå›´ï¼‰ ä¿è¯MQèŠ‚ç‚¹æˆåŠŸæ¥æ”¶åˆ°æ¶ˆæ¯ å‘é€ç«¯è¦æ”¶åˆ°MQèŠ‚ç‚¹(Broker)çš„ç¡®è®¤åº”ç­” å®Œå–„çš„æ¶ˆæ¯è¿›è¡Œè¡¥å¿æœºåˆ¶ï¼Ÿï¼Ÿ æ–¹æ¡ˆ1ï¼š æ¶ˆæ¯è½åº“ï¼Œå¯¹æ¶ˆæ¯çŠ¶æ€è¿›è¡Œæ‰“æ ‡ BIZ DBï¼šè®¢å•æ•°æ®åº“(æˆ–å…¶ä»–å…·ä½“ä¸šåŠ¡) \u0026ndash; å¯ä»¥è¯´æ˜¯æ¶ˆæ¯çš„Payloadï¼Œå…·ä½“çš„æ¶ˆæ¯å†…å®¹ã€‚ MSG DBï¼šæ¶ˆæ¯å‘é€æ—¥å¿—æ•°æ®åº“ \u0026ndash; å­˜å‚¨æ¶ˆæ¯çš„å‘é€çŠ¶æ€(å‘é€ä¸­ 0ï¼Œå·²ç¡®è®¤ 1ï¼Œ Retry\u0026gt;max ä¹‹åè®¾ç½®ä¸ºå‘é€å¤±è´¥ 2)ï¼Œé‡è¯•æ¬¡æ•°ï¼Œå‘é€æ—¶é—´ç­‰ã€‚\nç¬¬1æ­¥ï¼šå°†è®¢å•æ•°æ®å…¥åº“ï¼Œä¹‹ååˆ›å»ºä¸€æ¡MSG(çŠ¶æ€ä¸º0) å…¥MSG DBåº“ ç¬¬2æ­¥ï¼šå°†æ¶ˆæ¯å‘é€åˆ°MQ ç¬¬3æ­¥ï¼šç›‘å¬æ¶ˆæ¯åº”ç­”(æ¥è‡ªBroker) ç¬¬4æ­¥ï¼šä¿®æ”¹æ¶ˆæ¯çš„çŠ¶æ€ä¸º1(æˆåŠŸ)ï¼ˆåªè¦æœ‰åº”ç­”ï¼ŒMQä¸€å®šæ˜¯æ”¶åˆ°äº†æ¶ˆæ¯ï¼Ÿæ¶ˆæ¯æ˜¯å¦æ ¹æ®exchangeå’ŒroutingKeyæ”¾å…¥äº†æ­£ç¡®çš„é˜Ÿåˆ—ï¼Œæ˜¯å¦ä¼šæœ‰å¼‚å¸¸å‡ºç°ï¼‰ ç¬¬5æ­¥ï¼šåˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡æŠ“å–çŠ¶æ€ä¸º0çš„æ¶ˆæ¯ ç¬¬6æ­¥ï¼šå°†çŠ¶æ€ä¸º0çš„æ¶ˆæ¯é‡å‘ ç¬¬7æ­¥ï¼šå¦‚æœå°è¯•äº†3æ¬¡(å¯æŒ‰å®é™…æƒ…å†µä¿®æ”¹)ä»¥ä¸Šåˆ™å°†çŠ¶æ€ç½®ä¸º2(æ¶ˆæ¯æŠ•é€’å¤±è´¥çŠ¶æ€)\nPS: è¿™ç§æ–¹æ¡ˆéœ€è¦ä¸¤æ¬¡å…¥åº“ï¼Œåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹æ€§èƒ½ä¸æ˜¯å¾ˆå¥½ã€‚\næ–¹æ¡ˆäºŒï¼š æ¶ˆæ¯å»¶è¿ŸæŠ•é€’ï¼ŒåšäºŒæ¬¡ç¡®è®¤ï¼Œå›è°ƒæ£€æŸ¥ Upstream serviceï¼šä¸Šæ¸¸æœåŠ¡ï¼Œå¯èƒ½ä¸ºç”Ÿäº§ç«¯ Downstream serviceï¼šä¸‹æ¸¸æœåŠ¡ï¼Œå¯èƒ½ä¸ºæ¶ˆè´¹ç«¯ MQ Brokerï¼šMQ Callback serviceï¼šå›è°ƒæœåŠ¡ï¼Œç›‘å¬confirmæ¶ˆæ¯\nç¬¬1æ­¥ï¼šé¦–å…ˆä¸šåŠ¡æ•°æ®è½åº“ï¼ŒæˆåŠŸæ‰åç¬¬ä¸€æ¬¡æ¶ˆæ¯å‘é€ ç¬¬2æ­¥ï¼šç´§ç€ç€å‘é€ç¬¬2æ¡æ¶ˆæ¯ï¼ˆå¯ä»¥ç”¨äºå¯»æ‰¾ç¬¬1æ¡æ¶ˆæ¯,æ¶ˆæ¯çš„IDæ˜¯å”¯ä¸€çš„ï¼‰ï¼Œç”¨äºå»¶è¿Ÿ(å¯èƒ½2,3åˆ†é’Ÿåæ‰å‘é€)æ¶ˆæ¯æŠ•é€’æ£€æŸ¥ ç¬¬3æ­¥ï¼šBrokerç«¯æ”¶åˆ°æ¶ˆæ¯åï¼Œæ¶ˆè´¹ç«¯è¿›è¡Œæ¶ˆæ¯å¤„ç† ç¬¬4æ­¥ï¼šå¤„ç†æˆåŠŸåï¼Œå‘é€confirmæ¶ˆæ¯ï¼ˆCallback serviceå¦‚ä½•è·å¾—confirmä¿¡æ¯\u0026gt;ï¼‰ ç¬¬5æ­¥ï¼šæ”¶åˆ°confirmæ¶ˆæ¯åï¼Œå°†æ¶ˆæ¯è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ ç¬¬6æ­¥ï¼šæ”¶åˆ°äº†delayæ¶ˆæ¯ï¼Œæ£€æŸ¥DBæ•°æ®åº“ï¼Œè‹¥å¯¹åº”çš„ç¬¬1æ¡æ¶ˆæ¯å·²å¤„ç†å®Œæˆï¼Œåˆ™ä¸åšä»»ä½•äº‹æƒ…ï¼›è‹¥æ”¶åˆ°äº†delayæ¶ˆæ¯ï¼Œæ£€æŸ¥DBæ•°æ®åº“ï¼Œå‘ç°å¯¹åº”çš„ç¬¬1æ¡æ¶ˆæ¯å¤„ç†å¤±è´¥(æˆ–æ— è®°å½•)ï¼Œåˆ™å‘é€é‡ä¼ å‘½ä»¤åˆ°ä¸Šæ¸¸æœåŠ¡ï¼Œå¾ªç¯ç¬¬1æ­¥ã€‚\næ¶ˆæ¯çš„å¹‚ç­‰æ€§\næ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œæ— è®ºæ‰§è¡Œå¤šå°‘æ¬¡ï¼Œç»“æœéƒ½æ˜¯ä¸€è‡´çš„å°±è¯´å…·æœ‰å¹‚ç­‰æ€§ã€‚\nä¾‹å¦‚ä¸€æ¡æ›´æ–°åº“å­˜çš„SQLè¯­å¥\n1update T_REPS set count=count-1, version=version-1 where version=1 ç¬¬ä¸€æ­¥æŸ¥å‡ºè®°å½•çš„versionï¼Œç¬¬äºŒæ­¥é€šè¿‡è¿™ä¸ªversionä¿¡æ¯è¿›è¡Œå…¶ä»–å­—æ®µçš„æ›´æ–°ã€‚è¿™æ ·æ— è®ºè¿™æ¡SQLæ‰§è¡Œ å¤šå°‘æ¬¡ï¼Œæ‰€å¾—åˆ°çš„çš„ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œå°±ä¿è¯äº†å¹‚ç­‰æ€§ã€‚\nå¦‚ä½•é¿å…é‡å¤æ¶ˆè´¹\næ¶ˆè´¹ç«¯å®ç°å¹‚ç­‰æ€§ï¼Œç„¶åæ°¸è¿œéƒ½ä¸ä¼šå‡ºç°é‡å¤æ¶ˆè´¹å¤šæ¬¡çš„æƒ…å†µï¼Œå³ä½¿å—åˆ°å¤šæ¡ä¸€æ ·çš„æ¶ˆæ¯\næ¶ˆè´¹å¹‚ç­‰æ€§ æ¶ˆè´¹ç«¯å®ç°å¹‚ç­‰æ€§çš„ä¸»æµè§£å†³æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š\nå”¯ä¸€ID +æŒ‡çº¹ç  æœºåˆ¶\nåˆ©ç”¨Redisçš„åŸå­æ€§å®ç°\nå”¯ä¸€ID +æŒ‡çº¹ç  æœºåˆ¶ åˆ©ç”¨æ•°æ®åº“ä¸»é”®å»é‡ æŒ‡çº¹ç ï¼šå¯èƒ½æ˜¯ä¸šåŠ¡è§„åˆ™ï¼Œæ—¶é—´æˆ³+å…·ä½“é“¶è¡ŒèŒƒå›´çš„å”¯ä¸€ä¿¡æ¯ç ï¼Œèƒ½ä¿éšœè¿™æ¬¡æ“ä½œçš„ç»å¯¹å”¯ä¸€ æ¯”å¦‚select count(1) from T_ORDER where id = \u0026lt;å”¯ä¸€ID+æŒ‡çº¹ç \u0026gt; å°†å”¯ä¸€ID+æŒ‡çº¹ç è®¾æˆä¸»é”®ï¼Œå¦‚æœä¸Šé¢SQLè¿”å›1ï¼Œè¯´æ˜å·²ç»æ“ä½œäº†ï¼Œåˆ™ä¸éœ€è¦å†æ¬¡æ“ä½œï¼›å¦åˆ™æ‰å»æ‰§è¡Œæ“ä½œ ä¼˜ç‚¹ï¼š å®ç°ç®€å• ç¼ºç‚¹ï¼šé«˜å¹¶å‘ä¸‹æœ‰æ•°æ®åº“å†™å…¥çš„æ€§èƒ½ç“¶é¢ˆï¼ˆè§£å†³æ–¹æ¡ˆï¼šé€šè¿‡IDè¿›è¡Œåˆ†åº“åˆ†è¡¨è¿›è¡Œç®—æ³•è·¯ç”±ï¼‰\nåˆ©ç”¨Redisçš„åŸå­æ€§å®ç° é€šè¿‡setnxç­‰å‘½ä»¤ SET è®¢å•å· æ—¶é—´æˆ³ è¿‡æœŸæ—¶é—´\n1SET 1893505609317740 1466849127 EX 300 NX åˆ©ç”¨Redisè¿›è¡Œå¹‚ç­‰ï¼Œéœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼š\nå¦‚æœè¦è¿›è¡Œæ•°æ®è½åº“ï¼Œå…³é”®è§£å†³çš„é—®é¢˜æ˜¯æ•°æ®åº“å’Œç¼“å­˜å¦‚ä½•åšåˆ°æ•°æ®ä¸€è‡´æ€§ã€‚ å¦‚æœä¸è½åº“ï¼Œé‚£ä¹ˆéƒ½å­˜åœ¨ç¼“å­˜ä¸­ï¼Œå¦‚ä½•è®¾ç½®å®šæ—¶åŒæ­¥çš„ç­–ç•¥(åŒæ­¥æ˜¯æŒ‡å°†æ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œä¸è½åº“æŒ‡çš„æ˜¯æš‚æ—¶ä¸è½åº“ï¼Œä¸å¯èƒ½æ°¸è¿œä¸è½åº“)\næŠ•é€’æ¶ˆæ¯æœºåˆ¶ Confirmç¡®è®¤æ¶ˆæ¯ æ¶ˆæ¯ç¡®è®¤ï¼Œæ˜¯æŒ‡ç”Ÿäº§è€…æ¶ˆæ¯æŠ•é€’åï¼Œå¦‚æœBrokeræ”¶åˆ°æ¶ˆæ¯ï¼Œåˆ™ä¼šç»™ç”Ÿäº§è€…ä¸€ä¸ªåº”ç­” ç”Ÿäº§è€…è¿›è¡Œæ¥æ”¶åº”ç­”ï¼Œç”¨æ¥ç¡®å®šè¿™æ¡æ¶ˆæ¯æ˜¯å¦æ­£å¸¸çš„å‘é€åˆ°Brokerï¼Œè¿™ç§æ–¹å¼ä¹Ÿæ˜¯æ¶ˆæ¯çš„å¯é æ€§æŠ•é€’çš„æ ¸å¿ƒä¿éšœ ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ä¸ç›‘å¬Confirmæ˜¯å¼‚æ­¥çš„ã€‚(Nackæ˜¯æŒ‡æ¥æ”¶è¶…æ—¶å—?)\n1public class Producer { 2 3 public static void main(String[] args) throws IOException, TimeoutException, InterruptedException { 4 Connection connection = ConnectionUtil.getConn(); 5 //1. é€šè¿‡connectionåˆ›å»ºä¸€ä¸ªChannel 6 Channel channel = connection.createChannel(); 7 //2.æŒ‡å®šæ¶ˆæ¯ç¡®è®¤æ¨¡å¼ 8 channel.confirmSelect(); 9 String exchangeName = \u0026#34;test_confirm_exchange\u0026#34;; 10 String routingKey = \u0026#34;confirm.save\u0026#34;; 11 12 //3. é€šè¿‡Channelå‘é€æ•°æ® 13 String message = \u0026#34;Hello from Producer\u0026#34;; 14 channel.basicPublish(exchangeName,routingKey,null,message.getBytes()); 15 16 //4. æ·»åŠ ä¸€ä¸ªç¡®è®¤ç›‘å¬ 17 channel.addConfirmListener(new ConfirmListener() { 18 @Override 19 public void handleAck(long deliveryTag, boolean multiple) throws IOException { 20 //æˆåŠŸçš„æƒ…å†µ deliveryTag:æ¶ˆæ¯çš„å”¯ä¸€æ ‡ç­¾ï¼› 21 System.out.println(\u0026#34;â€”â€”get ackâ€”â€”\u0026#34;); 22 } 23 24 @Override 25 public void handleNack(long deliveryTag, boolean multiple) throws IOException { 26 //å¤±è´¥çš„æƒ…å†µ 27 System.out.println(\u0026#34;â€”â€”have no ackâ€”â€”\u0026#34;); 28 } 29 }); 30 31 // å…³é—­æ‰å°±æ²¡confirmäº† 32 // CloseTool.closeElegantly(channel,connection); 33 34 } 35} 1public class Consumer { 2 3 public static void main(String[] args) throws Exception { 4 Connection connection = ConnectionUtil.getConn(); 5 6 //1. é€šè¿‡connectionåˆ›å»ºä¸€ä¸ªChannel 7 Channel channel = connection.createChannel(); 8 9 String exchangeName = \u0026#34;test_confirm_exchange\u0026#34;; 10 String routingKey = \u0026#34;confirm.save\u0026#34;; 11 String queueName = \u0026#34;test_confirm_queue\u0026#34;; 12 //2. å£°æ˜ä¸€ä¸ªexchange 13 channel.exchangeDeclare(exchangeName,\u0026#34;topic\u0026#34;,true); 14 //3. å£°æ˜ä¸€ä¸ªé˜Ÿåˆ— 15 channel.queueDeclare(queueName,true,false,false,null); 16 //4. ç»‘å®š 17 channel.queueBind(queueName,exchangeName,routingKey); 18 //5. åˆ›å»ºæ¶ˆè´¹è€… 19 QueueingConsumer queueingConsumer = new QueueingConsumer(channel); 20 //6. è®¾ç½®Channel 21 channel.basicConsume(queueName,true,queueingConsumer); 22 //7. è·å–æ¶ˆæ¯ 23 while (true) { 24 //nextDelivery ä¼šé˜»å¡ç›´åˆ°æœ‰æ¶ˆæ¯è¿‡æ¥ 25 QueueingConsumer.Delivery delivery = queueingConsumer.nextDelivery(); 26 String message = new String(delivery.getBody()); 27 System.out.println(\u0026#34;æ”¶åˆ°:\u0026#34; + message); 28 } 29 } 30} returnè¿”å›æ¶ˆæ¯ Return Listenerç”¨äºå¤„ç†ä¸€äº›ä¸å¯è·¯ç”±æ¶ˆæ¯ ç”Ÿäº§è€…æŒ‡å®šExchangeå’ŒRoutingKeyï¼Œå°†æ¶ˆæ¯æŠ•é€’åˆ°æŸä¸ªé˜Ÿåˆ—ï¼Œç„¶åæ¶ˆè´¹è€…ç›‘å¬é˜Ÿåˆ—ï¼Œè¿›è¡Œæ¶ˆæ¯å¤„ç† ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œè‹¥å½“å‰çš„exchangeä¸å­˜åœ¨æˆ–æŒ‡å®šçš„è·¯ç”±keyè·¯ç”±å¤±è´¥ï¼Œè¿™æ—¶ï¼Œå¦‚æœéœ€è¦ç›‘å¬è¿™ç§ä¸å¯è¾¾çš„æ¶ˆæ¯ï¼Œåˆ™è¦ä½¿ç”¨return listener return æ¶ˆæ¯æœºåˆ¶\nåœ¨åŸºç¡€APIä¸­æœ‰ä¸€ä¸ªå…³é”®çš„é…ç½®é¡¹ï¼š\nMandatory : è‹¥ä¸ºtrue,åˆ™ç›‘å¬å™¨ä¼šæ¥æ”¶åˆ°è·¯ç”±ä¸å¯è¾¾çš„æ¶ˆæ¯ï¼Œç„¶åè¿›è¡Œåç²—å¤„ç† ï¼›è‹¥ä¸ºfalseï¼Œåˆ™brokerç«¯è‡ªåŠ¨åˆ é™¤è¯¥æ¶ˆæ¯\nå‘é€ç«¯å‘é€äº†ä¸€æ¡æ¶ˆæ¯ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°Exchangeï¼Œåˆ™å¯é€šè¿‡return listenerç›‘å¬è¿™äº›æ¶ˆæ¯\n1public class Producer { 2 public static final String MQ_HOST = \u0026#34;192.168.222.101\u0026#34;; 3 public static final String MQ_VHOST = \u0026#34;/\u0026#34;; 4 public static final int MQ_PORT = 5672; 5 6 public static void main(String[] args) throws IOException, TimeoutException { 7 //1. åˆ›å»ºä¸€ä¸ªConnectionFactory 8 ConnectionFactory connectionFactory = new ConnectionFactory(); 9 connectionFactory.setHost(MQ_HOST);//é…ç½®host 10 connectionFactory.setPort(MQ_PORT);//é…ç½®port 11 connectionFactory.setVirtualHost(MQ_VHOST);//é…ç½®vHost 12 13 //2. é€šè¿‡è¿æ¥å·¥å‚åˆ›å»ºè¿æ¥ 14 Connection connection = connectionFactory.newConnection(); 15 //3. é€šè¿‡connectionåˆ›å»ºä¸€ä¸ªChannel 16 Channel channel = connection.createChannel(); 17 String exchange = \u0026#34;test_return_exchange\u0026#34;; 18 String routingKey = \u0026#34;return.save\u0026#34;; 19 String routingKeyError = \u0026#34;abc.save\u0026#34;; 20 21 22 //4. é€šè¿‡Channelå‘é€æ•°æ® 23 String message = \u0026#34;Hello Return Message\u0026#34;; 24 25 channel.addReturnListener((replyCode, replyText, exchange1, routingKey1, properties, body) -\u0026gt; { 26 System.out.println(\u0026#34;â€”â€”handle returnâ€”â€”\u0026#34;); 27 System.out.println(\u0026#34;replyCode:\u0026#34; + replyCode); 28 System.out.println(\u0026#34;replyText:\u0026#34; + replyText); 29 System.out.println(\u0026#34;exchange1:\u0026#34; + exchange1); 30 System.out.println(\u0026#34;routingKey1:\u0026#34; + routingKey1); 31 System.out.println(\u0026#34;properties:\u0026#34; + properties); 32 System.out.println(\u0026#34;body:\u0026#34; + new String(body)); 33 }); 34 35 //mandatory : true 36 //channel.basicPublish(exchange,routingKey,true,null,message.getBytes()); 37 channel.basicPublish(exchange,routingKeyError,true,null,message.getBytes()); 38 } 39} 1 2public class Consumer { 3 4 public static void main(String[] args) throws Exception { 5 Connection connection = ConnectionUtil.getConn(); 6 7 //1. é€šè¿‡connectionåˆ›å»ºä¸€ä¸ªChannel 8 Channel channel = connection.createChannel(); 9 10 String exchange = \u0026#34;test_return_exchange\u0026#34;; 11 String routingKey = \u0026#34;return.#\u0026#34;; 12 String queueName = \u0026#34;test_return_queue\u0026#34;; 13 14 //2. å£°æ˜ä¸€ä¸ªexchange 15 channel.exchangeDeclare(exchange,\u0026#34;topic\u0026#34;,true,false,null); 16 //3. å£°æ˜ä¸€ä¸ªé˜Ÿåˆ— 17 channel.queueDeclare(queueName,true,false,false,null); 18 //4. ç»‘å®š 19 channel.queueBind(queueName,exchange,routingKey); 20 //5. åˆ›å»ºæ¶ˆè´¹è€… 21 QueueingConsumer queueingConsumer = new QueueingConsumer(channel); 22 //6. è®¾ç½®Channel 23 channel.basicConsume(queueName,true,queueingConsumer); 24 //7. è·å–æ¶ˆæ¯ 25 while (true) { 26 //nextDelivery ä¼šé˜»å¡ç›´åˆ°æœ‰æ¶ˆæ¯è¿‡æ¥ 27 QueueingConsumer.Delivery delivery = queueingConsumer.nextDelivery(); 28 String message = new String(delivery.getBody()); 29 System.out.println(\u0026#34;æ”¶åˆ°:\u0026#34; + message); 30 } 31 32 33 } 34} å½“ç”Ÿäº§ç«¯æ‰§è¡Œchannel.basicPublish(exchange,routingKey,true,null,message.getBytes());æ¶ˆæ¯èƒ½å‘é€æˆåŠŸï¼Œä¹Ÿå¯ä»¥ä»æ¶ˆè´¹ç«¯çœ‹åˆ°æ‰“å°\nå½“æ‰§è¡Œchannel.basicPublish(exchange,routingKeyError,true,null,message.getBytes());æ¶ˆæ¯å‘é€å¤±è´¥ï¼Œå› ä¸ºè·¯ç”±å¤±è´¥äº†å˜›ï¼Œç”Ÿäº§ç«¯èƒ½çœ‹åˆ°å¦‚ä¸‹æ‰“å°ï¼š\n1â€”â€”handle returnâ€”â€” 2replyCode:312 3replyText:NO_ROUTE 4exchange1:test_return_exchange 5routingKey1:abc.save 6properties:#contentHeader\u0026lt;basic\u0026gt;(content-type=null, content-encoding=null, headers=null, delivery-mode=null, priority=null, correlation-id=null, reply-to=null, expiration=null, message-id=null, timestamp=null, type=null, user-id=null, app-id=null, cluster-id=null) 7body:Hello Return Message è‹¥ç”Ÿäº§ç«¯å°†mandatoryè®¾ä¸ºfalse,åˆ™ReturnListenerä¸ä¼šè¿›è¡Œå›è°ƒ\nä¿éšœ100% çš„æ¶ˆæ¯å¯é æ€§æŠ•é€’æ–¹æ¡ˆè½åœ°å®ç° ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/RabbitMQ/","summary":"RabbitMQ æ¶ˆæ¯ä¸­é—´ä»¶ æŠ€æœ¯ç²¾è®²\n1. RabbitMQ ç®€ä»‹ä»¥åŠAMQPåè®® RabbitMQ æ˜¯ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯ä»£ç†å’Œ\nRabbitMQåº•å±‚æ˜¯é‡‡ç”¨Erlangè¯­è¨€è¿›è¡Œç¼–å†™ å¼€æºã€æ€§èƒ½ä¼˜ç§€ï¼Œ ç¨³å®šæ€§ä¿éšœ ä¸spring AMQPå®Œç¾æ•´åˆï¼ŒAPIä¸°å¯Œ é›†ç¾¤æ¨¡å¼ä¸°å¯Œï¼Œè¡¨è¾¾å¼é…ç½®ï¼Œ HAæ¨¡å¼ï¼Œ é•œåƒé˜Ÿåˆ—æ¨¡å‹ ä¿è¯æ•°æ®ä¸ä¸¢å¤±çš„å‰æåšåˆ°é«˜å¯é æ€§ï¼Œå¯ç”¨æ€§ AMQPï¼š é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®® RabbitMQ çš„å®‰è£…ä»¥åŠä½¿ç”¨ erlang socat rabbitmq-server rpm -ivh XXXXX.rpm lsof -i:5672 # æŸ¥çœ‹ç«¯å£ å¯ç”¨æ§åˆ¶å°æ’ä»¶ rabbit å¯ä»¥é€‰æ‹©ä½¿ç”¨å†…å­˜è¿›è¡Œå­˜å‚¨\nRabbitMQ æ ¸å¿ƒæ¦‚å¿µ AMQPæ ¸å¿ƒæ¦‚å¿µ\nServerï¼šåˆç§°ä½œBrokerï¼Œ æ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå®ç°AMQPå®ä½“æœåŠ¡\nConnectionï¼š è¿æ¥ï¼Œ åº”ç”¨ç¨‹åºä¸Brokerçš„ç½‘ç»œè¿æ¥\nChannelï¼š ç½‘ç»œä¿¡é“ï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½åœ¨Channelä¸­è¿›è¡Œï¼ŒChannelæ˜¯è¿›è¡Œæ¶ˆæ¯è¯»å†™çš„ä¸€ä¸ªé€šé“ã€‚å®¢æˆ·ç«¯å¯ä»¥å»ºç«‹å¤šä¸ªChannelï¼Œæ¯ä¸ªChannelä»£è¡¨ä¸€ä¸ªä¼šè¯ä»»åŠ¡ã€‚\nMessageï¼š æ¶ˆæ¯ï¼Œ æœåŠ¡å™¨å’Œåº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€çš„æ•°æ®ï¼Œç”±Propertieså’ŒBodyç»„æˆã€‚Propertieså¯ä»¥å¯¹æ¶ˆæ¯è¿›è¡Œä¿®é¥°ï¼Œæ¯”å¦‚æ¶ˆæ¯çš„ä¼˜å…ˆçº§ã€å»¶è¿Ÿç­‰é«˜çº§ç‰¹æ€§ï¼›Bodyåˆ™å°±æ˜¯æ¶ˆæ¯ä½“å†…å®¹ã€‚\nVirtual hostï¼š è™šæ‹Ÿåœ°å€ï¼Œç”¨äºè¿›è¡Œé€»è¾‘éš”ç¦»ï¼Œæ˜¯æœ€ä¸Šå±‚çš„æ¶ˆæ¯è·¯ç”±ã€‚ä¸€ä¸ªVirtual Hosté‡Œé¢å¯ä»¥æœ‰è‹¥å¹²ä¸ªExchange å’ŒQueueï¼Œ åŒä¸€ä¸ªVirtual Hosté‡Œé¢ä¸èƒ½æœ‰ç›¸åŒåç§°çš„Exchangeæˆ–Queueã€‚\nExchangeï¼š äº¤æ¢æœºï¼Œæ¥æ”¶æ¶ˆæ¯ï¼Œæ ¹æ®è·¯ç”±é”®è½¬å‘æ¶ˆæ¯åˆ°ç»‘å®šçš„é˜Ÿåˆ—\nBindingï¼š Exchange å’ŒQueueä¹‹é—´çš„è™šæ‹Ÿè¿æ¥ï¼Œbindingå¯ä»¥åŒ…å«routing key\nRouting key: ä¸€ä¸ªè·¯ç”±è§„åˆ™ï¼Œè™šæ‹Ÿæœºå¯ä»¥ç”¨å®ƒæ¥ç¡®å®šå¦‚ä½•è·¯ç”±ä¸€ä¸ªç‰¹å®šæ¶ˆæ¯\nQueueï¼š ä¹Ÿç§°ä¸ºMassage Queue, æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¿å­˜æ¶ˆæ¯å¹¶å°†ä»–ä»¬è½¬å‘ç»™æ¶ˆè´¹è€…\nRabbitMQ RabbitMQé»˜è®¤ç«¯å£å· 4369 (epmd), 25672 (Erlang distribution) 4369 erlang å‘ç°ç«¯å£ 25672 serveré—´é€šä¿¡ç«¯å£ 5672, 5671 (AMQP 0-9-1 without and with TLS) clientç«¯é€šä¿¡å£ 15672 (if management plugin is enabled) ç®¡ç†ç•Œé¢uiç«¯å£ 61613, 61614 (if STOMP is enabled) 1883, 8883 (if MQTT is enabled) ç”Ÿäº§ç«¯çš„å¯é æŠ•é€’ ä¿è¯æ¶ˆæ¯ä»ç”Ÿäº§è€…åˆ°MQä¹‹é—´çš„ä¼ è¾“æ˜¯100%å¯é çš„ï¼Œç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ä¸€å®šèƒ½è¿›å…¥æ¶ˆæ¯é˜Ÿåˆ—","tags":null,"title":""},{"categories":null,"contents":"Distributed System Engineering parallelism\nFault tolerance\nPhysical\nSecurity /isolated\nChallenges:\nconcurrency\nPartial failure\nPerformance\nLab\nMapReduce Raft for fault tolerrance K/V server Sharding K/V servers Infrastructure\nstorage Communication Computation Abstraction\nImplementation\nRPC, Threadï¼ŒConcurrency Performance\nscalability , scabale to speed 2 x computer = 2X throughput Fault Tolerance\nAvailability Recoverability NV (non-volatile)storage /Replication Topic - Consistency\nPut (key, value) Get(key) -\u0026gt; value Map Reduce What is distributed system? multiple cooperating computers storage for big web sites, MapReduce, peer-to-peer sharing, \u0026amp;c lots of critical infrastructure is distributed Why do people build distributed system? to increase capacity via parallelism to tolerate faults via replication to place computing physically close to external entities to achieve security via isolation But:\nmany concurrent parts, complex interactions must cope with partial failure tricky to realize performance potential Why take this course ?\ninteresting \u0026ndash; hard problem, powerful solutions used by real system \u0026ndash; driven by rise of big web sites. active research area \u0026ndash; important unsolved problems hands-on \u0026ndash; you\u0026rsquo;ll build real system in the labs Lab https://pdos.csail.mit.edu/6.824/labs/lab-mr.html\nReference:\nhttps://chunlife.top/2020/04/18/The-Google-File-System%E4%B8%AD%E6%96%87%E7%89%88/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/6.824/LEC_1_Introduction/","summary":"Distributed System Engineering parallelism\nFault tolerance\nPhysical\nSecurity /isolated\nChallenges:\nconcurrency\nPartial failure\nPerformance\nLab\nMapReduce Raft for fault tolerrance K/V server Sharding K/V servers Infrastructure\nstorage Communication Computation Abstraction\nImplementation\nRPC, Threadï¼ŒConcurrency Performance\nscalability , scabale to speed 2 x computer = 2X throughput Fault Tolerance\nAvailability Recoverability NV (non-volatile)storage /Replication Topic - Consistency\nPut (key, value) Get(key) -\u0026gt; value Map Reduce What is distributed system? multiple cooperating computers storage for big web sites, MapReduce, peer-to-peer sharing, \u0026amp;c lots of critical infrastructure is distributed Why do people build distributed system?","tags":null,"title":"ã€Œ6.824ã€ Lecture 1 Introduction"},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/6.824/MapReduce/","summary":"","tags":null,"title":"ã€Œ6.824ã€ MapReduce"},{"categories":null,"contents":" ä»€ä¹ˆæ˜¯consul Consulæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ æœåŠ¡å¦‚ä½•æ³¨å†Œåˆ°Consulï¼Œä»¥åŠå¦‚ä½•è¿›è¡ŒæœåŠ¡å‘ç° Consuléƒ¨ç½² åŸºäºdockeréƒ¨ç½²\nnode consul-server server consul-1 client consul-2 client 1docker run -d -p 8500:8500 -e CONSUL_BIND_INTERFACE=eth0 --name consul-server consul:1.9.4 2docker run -d -e CONSUL_BIND_INTERFACE=eth0 --name consul-1 consul:1.9.4 agent -dev -join=172.17.0.13 3docker run -d -e CONSUL_BIND_INTERFACE=eth0 --name consul-2 consul:1.9.4 agent -dev -join=172.17.0.13 4 5# docker stop consul-server consul-1 consul-2 6# docker rm consul-server consul-1 consul-2 Tipsï¼š æŸ¥çœ‹consul-server ip\n1 docker exec -t consul-server ifconfig å¯ä»¥é€šè¿‡8500ç«¯å£è®¿é—®UI\nServer:\nClient:\nClient åªä¸Serveräº¤äº’ã€‚\nPortï¼š\nPost Desc 8300 consul agentæœåŠ¡ relplaction ã€rpcï¼ˆclient-serverï¼‰ 8301 lan gossip 8302 wan gossip 8500 http apiç«¯å£ 8600 DNSæœåŠ¡ç«¯å£ æœåŠ¡æ³¨å†Œ æœåŠ¡è‡ªå·±è°ƒç”¨http APIæ³¨å†Œ 1curl -X PUT -d \u0026#39;{\u0026#34;Datacenter\u0026#34;: \u0026#34;sz-1\u0026#34;, \u0026#34;Node\u0026#34;: \u0026#34;mysql-1\u0026#34;, \u0026#34;Address\u0026#34;: \\ 2\u0026#34;mysql-1.node.consul\u0026#34;,\u0026#34;Service\u0026#34;: {\u0026#34;Service\u0026#34;: \u0026#34;mysql\u0026#34;, \u0026#34;tags\u0026#34;: [\u0026#34;master\u0026#34;,\u0026#34;v1\u0026#34;], \\ 3\u0026#34;Port\u0026#34;: 3306}}\u0026#39; http://127.0.0.1:8500/v1/catalog/register jsoné…ç½®æ–‡ä»¶æ³¨å†Œ å¯åŠ¨æ—¶å€™æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„-config-dir /etc/consul.d/\n1{ 2 \u0026#34;service\u0026#34;:{ 3 \u0026#34;name\u0026#34;:\u0026#34;alertmanager\u0026#34;, 4 \u0026#34;tags\u0026#34;:[ 5 \u0026#34;prom\u0026#34; 6 ], 7 \u0026#34;port\u0026#34;:9093, 8 \u0026#34;check\u0026#34;:{ 9 \u0026#34;name\u0026#34;:\u0026#34;ping\u0026#34;, 10 \u0026#34;args\u0026#34;:[\u0026#34;curl -s 10.227.4.115:9093\u0026#34;], 11 \u0026#34;interval\u0026#34;:\u0026#34;3s\u0026#34; 12 } 13 } 14} æœåŠ¡å‘ç° HttpAPI é€šè¿‡æœåŠ¡åå­—â€œalertmanagerâ€è·å–æœåŠ¡çš„IPå’ŒPort\nDNS 8600 ä½¿ç”¨dnsæŸ¥è¯¢ï¼Œé»˜è®¤åŸŸåæ ¼å¼NAME.service.consulï¼ŒNAMEå°±æ˜¯web.jsoné‡Œé¢å®šä¹‰çš„serviceçš„nameã€‚å¯ä»¥è‡ªå·±æŒ‡å®šåŸŸå’Œç«¯å£ï¼š-domainã€-dns-port 53\nConsul Consulçš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºæœåŠ¡æ²»ç†ã€‚\nåœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼ŒæœåŠ¡ä¼šéƒ¨ç½²å¤šä¸ªå®ä¾‹ã€‚ä¼ ç»Ÿçš„åŸºäºAPIç›´è¿çš„è°ƒç”¨æ–¹å¼ï¼Œåœ¨æœåŠ¡æŒ‚æ‰æˆ–è€…è¿æ¥ä¿¡æ¯è¢«ä¿®æ”¹ä¹‹åå°±ä¼šå¯¼è‡´APIè°ƒç”¨å¤±è´¥ã€‚å¦‚æœè°ƒç”¨æ–¹ä¸ç”¨å»å…³æ³¨æ‰€è°ƒç”¨æœåŠ¡çš„å®é™…éƒ¨ç½²æƒ…å†µï¼Œåªè¦çŸ¥é“æ‰€è°ƒç”¨æœåŠ¡çš„åç§°ã€‚å…¶ä»–å®é™…éƒ¨ç½²æƒ…å†µï¼Œè´Ÿè½½å‡è¡¡ã€å¥åº·æ£€æŸ¥ç”±ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°å»åšã€‚è¿™ä¸ªå°±æ˜¯Consulçš„ä½œç”¨ã€‚\nConsulåˆ†ä¸ºServer Agentå’ŒClient Agentã€‚\nServerï¼šconsulçš„serveræ¨¡å¼ï¼Œè¡¨æ˜è¿™ä¸ªconsulæ˜¯ä¸ªserverï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼ŒåŠŸèƒ½å’ŒCLIENTéƒ½ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå®ƒä¼šæŠŠæ‰€æœ‰çš„ä¿¡æ¯æŒä¹…åŒ–çš„æœ¬åœ°ï¼Œè¿™æ ·é‡åˆ°æ•…éšœï¼Œä¿¡æ¯æ˜¯å¯ä»¥è¢«ä¿ç•™çš„ã€‚æœåŠ¡ç«¯, ä¿å­˜é…ç½®ä¿¡æ¯, é«˜å¯ç”¨é›†ç¾¤, åœ¨å±€åŸŸç½‘å†…ä¸æœ¬åœ°å®¢æˆ·ç«¯é€šè®¯, é€šè¿‡å¹¿åŸŸç½‘ä¸å…¶ä»–æ•°æ®ä¸­å¿ƒé€šè®¯. æ¯ä¸ªæ•°æ®ä¸­å¿ƒçš„ server æ•°é‡æ¨èä¸º 3 ä¸ªæˆ–æ˜¯ 5 ä¸ªã€‚å­˜å‚¨æœåŠ¡ä¿¡æ¯\nServer-Leaderï¼š\nä¸ªSERVERä¸‹é¢æœ‰LEADERçš„å­—çœ¼ï¼Œè¡¨æ˜è¿™ä¸ªSERVERæ˜¯å®ƒä»¬çš„è€å¤§ï¼Œå®ƒå’Œå…¶å®ƒSERVERä¸ä¸€æ ·çš„ä¸€ç‚¹æ˜¯ï¼Œå®ƒéœ€è¦è´Ÿè´£åŒæ­¥æ³¨å†Œçš„ä¿¡æ¯ç»™å…¶å®ƒçš„SERVERï¼ŒåŒæ—¶ä¹Ÿè¦è´Ÿè´£å„ä¸ªèŠ‚ç‚¹çš„å¥åº·ç›‘æµ‹ã€‚\nClientï¼š å®¢æˆ·ç«¯, æ— çŠ¶æ€, å°† HTTP å’Œ DNS æ¥å£è¯·æ±‚è½¬å‘ç»™å±€åŸŸç½‘å†…çš„æœåŠ¡ç«¯é›†ç¾¤ã€‚æ³¨å†Œåˆ°å½“å‰èŠ‚ç‚¹çš„ä¿¡æ¯éƒ½ä¼šè½¬å‘ç»™Server, æœ¬èº«ä¸æŒä¹…åŒ–ä¿¡æ¯ã€‚\nConsulä½¿ç”¨gossipåè®®ç®¡ç†æˆå‘˜å…³ç³»ã€å¹¿æ’­æ¶ˆæ¯åˆ°æ•´ä¸ªé›†ç¾¤ï¼Œä»–æœ‰ä¸¤ä¸ªgossip poolï¼ˆLAN poolå’ŒWAN poolï¼‰ï¼ŒLAN poolæ˜¯åŒä¸€ä¸ªæ•°æ®ä¸­å¿ƒå†…éƒ¨é€šä¿¡çš„ï¼ŒWAN poolæ˜¯å¤šä¸ªæ•°æ®ä¸­å¿ƒé€šä¿¡çš„ï¼ŒLAN poolæœ‰å¤šä¸ªï¼ŒWAN poolåªæœ‰ä¸€ä¸ªã€‚\næœåŠ¡å‘ç° http \u0026amp; DNS\nconsulæ”¯æŒä¸¤ç§æ–¹å¼å®ç°æœåŠ¡å‘ç°ï¼Œä¸€ç§æ˜¯é€šè¿‡http APIæ¥æŸ¥è¯¢æœ‰å“ªäº›æœåŠ¡ï¼Œå¦å¤–ä¸€ç§æ˜¯é€šè¿‡consul agent è‡ªå¸¦çš„DNSï¼ˆ8600ç«¯å£ï¼‰ï¼ŒåŸŸåæ˜¯ä»¥NAME.service.consulçš„å½¢å¼ç»™å‡ºï¼ŒNAMEå³åœ¨å®šä¹‰çš„æœåŠ¡é…ç½®æ–‡ä»¶ä¸­ï¼ŒæœåŠ¡çš„åç§°ã€‚DNSæ–¹å¼å¯ä»¥é€šè¿‡checkçš„æ–¹å¼æ£€æŸ¥æœåŠ¡ã€‚\næœåŠ¡é…ç½® consulæ”¯æŒä¸¤ç§æ–¹å¼å®ç°æœåŠ¡æ³¨å†Œï¼Œä¸€ç§æ˜¯é€šè¿‡consulçš„æœåŠ¡æ³¨å†Œhttp APIï¼Œç”±æœåŠ¡è‡ªå·±è°ƒç”¨APIå®ç°æ³¨å†Œï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡jsonä¸ªæ˜¯çš„é…ç½®æ–‡ä»¶å®ç°æ³¨å†Œï¼Œå°†éœ€è¦æ³¨å†Œçš„æœåŠ¡ä»¥jsonæ ¼å¼çš„é…ç½®æ–‡ä»¶ç»™å‡ºã€‚consulå®˜æ–¹å»ºè®®ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ã€‚\nå¥åº·æ£€æŸ¥ é”®å€¼å­˜å‚¨ å®‰å…¨æœåŠ¡é€šä¿¡ å¤šæ•°æ®ä¸­å¿ƒ ç±»ä¼¼çš„æœåŠ¡ç»„ä»¶æœ‰Eurekaï¼Œzookeeperï¼Œetcd\nä¸€è‡´æ€§åè®®é‡‡ç”¨Raftç®—æ³•\ntodo\nDig å‚è€ƒæ–‡æ¡£ https://blog.csdn.net/a312586670/article/details/105337943/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/MicroService/Consul/","summary":"ä»€ä¹ˆæ˜¯consul Consulæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ æœåŠ¡å¦‚ä½•æ³¨å†Œåˆ°Consulï¼Œä»¥åŠå¦‚ä½•è¿›è¡ŒæœåŠ¡å‘ç° Consuléƒ¨ç½² åŸºäºdockeréƒ¨ç½²\nnode consul-server server consul-1 client consul-2 client 1docker run -d -p 8500:8500 -e CONSUL_BIND_INTERFACE=eth0 --name consul-server consul:1.9.4 2docker run -d -e CONSUL_BIND_INTERFACE=eth0 --name consul-1 consul:1.9.4 agent -dev -join=172.17.0.13 3docker run -d -e CONSUL_BIND_INTERFACE=eth0 --name consul-2 consul:1.9.4 agent -dev -join=172.17.0.13 4 5# docker stop consul-server consul-1 consul-2 6# docker rm consul-server consul-1 consul-2 Tipsï¼š æŸ¥çœ‹consul-server ip\n1 docker exec -t consul-server ifconfig å¯ä»¥é€šè¿‡8500ç«¯å£è®¿é—®UI\nServer:\nClient:","tags":null,"title":"ã€ŒConsulã€Consul"},{"categories":null,"contents":"TaskList æœ€çŸ­è·¯å¾„ç®—æ³•\næœ€å°ç”Ÿæˆæ ‘\næ·±åº¦ä¼˜å…ˆéå†ã€å¹¿åº¦ä¼˜å…ˆéå†\nKMPç®—æ³•\nLRU\nå“ˆå¼—æ›¼æ ‘\ngoçŸ¥è¯†å­¦ä¹  å‚è€ƒè¿™ä¸ªæ–‡æ¡£ï¼Œå®Œæ•´çš„å­¦ä¹ ä¸€è¾¹go\nhttps://draveness.me/golang/docs/part3-runtime/ch06-concurrency/golang-context/\ncontext æ˜¥æ‹›ç›®æ ‡\nä¾å›¾\nPDD\nå­—èŠ‚è·³åŠ¨\næµ¦å‘\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/TaskList/","summary":"TaskList æœ€çŸ­è·¯å¾„ç®—æ³•\næœ€å°ç”Ÿæˆæ ‘\næ·±åº¦ä¼˜å…ˆéå†ã€å¹¿åº¦ä¼˜å…ˆéå†\nKMPç®—æ³•\nLRU\nå“ˆå¼—æ›¼æ ‘\ngoçŸ¥è¯†å­¦ä¹  å‚è€ƒè¿™ä¸ªæ–‡æ¡£ï¼Œå®Œæ•´çš„å­¦ä¹ ä¸€è¾¹go\nhttps://draveness.me/golang/docs/part3-runtime/ch06-concurrency/golang-context/\ncontext æ˜¥æ‹›ç›®æ ‡\nä¾å›¾\nPDD\nå­—èŠ‚è·³åŠ¨\næµ¦å‘","tags":null,"title":"ã€ŒDailyã€TaskList"},{"categories":null,"contents":"centos å®‰è£…docker æŠŠyumåŒ…æ›´æ–°åˆ°æœ€æ–°\n1yum update å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…\n1yum install -y yum-utils device-mapper-persistent-data lvm2 è®¾ç½®yumæº\n1yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo æŸ¥çœ‹æ‰€æœ‰ä»“åº“ä¸­æ‰€æœ‰dockerç‰ˆæœ¬ï¼Œå¹¶é€‰æ‹©ç‰¹å®šç‰ˆæœ¬å®‰è£…\n1yum list docker-ce --showduplicates | sort -r 2 3[root@MiWiFi-R3-srv ~]# yum list docker-ce --showduplicates | sort -r 4 * updates: mirrors.aliyun.com 5Loading mirror speeds from cached hostfile 6Loaded plugins: fastestmirror 7Installed Packages 8 * extras: mirrors.aliyun.com 9docker-ce.x86_64 3:18.09.0-3.el7 docker-ce-stable 10docker-ce.x86_64 18.06.1.ce-3.el7 docker-ce-stable 11docker-ce.x86_64 18.06.1.ce-3.el7 @docker-ce-stable 12docker-ce.x86_64 18.06.0.ce-3.el7 docker-ce-stable 13docker-ce.x86_64 18.03.1.ce-1.el7.centos docker-ce-stable 14docker-ce.x86_64 18.03.0.ce-1.el7.centos docker-ce-stable 15...... å®‰è£…Dockerï¼Œå‘½ä»¤ï¼šyum install docker-ce-ç‰ˆæœ¬å·ï¼Œæˆ‘é€‰çš„æ˜¯18.06.1.ce-3.el7ï¼Œå¦‚ä¸‹\n1yum install docker-ce-18.06.1.ce-3.el7 å¯åŠ¨Dockerï¼Œå‘½ä»¤ï¼šsystemctl start dockerï¼Œç„¶ååŠ å…¥å¼€æœºå¯åŠ¨ï¼Œå¦‚ä¸‹\n1systemctl start docker 2systemctl enable docker éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ docker version\n1[root@MiWiFi-R3-srv ~]# docker version 2Client: 3 Version: 18.06.1-ce 4 API version: 1.38 5 Go version: go1.10.3 6 Git commit: e68fc7a 7 Built: Tue Aug 21 17:23:03 2018 8 OS/Arch: linux/amd64 9 Experimental: false 10 11Server: 12 Engine: 13 Version: 18.06.1-ce 14 API version: 1.38 (minimum version 1.12) 15 Go version: go1.10.3 16 Git commit: e68fc7a 17 Built: Tue Aug 21 17:25:29 2018 18 OS/Arch: linux/amd64 19 Experimental: false ä½¿ç”¨Docker ä¸­å›½åŠ é€Ÿå™¨ ç”±äºç½‘ç»œåŸå› ï¼Œæˆ‘ä»¬åœ¨pull Image çš„æ—¶å€™ï¼Œä»Docker Hubä¸Šä¸‹è½½ä¼šå¾ˆæ…¢ã€‚\nä¿®æ”¹æ–‡ä»¶\n1vi /etc/docker/daemon.json 2#æ·»åŠ åï¼š 3{ 4 \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://registry.docker-cn.com\u0026#34;], 5 \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://ustc-edu-cn.mirror.aliyuncs.com\u0026#34;], 6 7 \u0026#34;live-restore\u0026#34;: true 8} é‡èµ·dockeræœåŠ¡\n1systemctl daemon-reload \u0026amp;\u0026amp; systemctl restart docker è¿›å…¥å®¹å™¨Shell 1docker exec -it \u0026lt;continer\u0026gt; /bin/bash # or sh 2docker exec -it --user root \u0026lt;container id\u0026gt; /bin/bash # root ç”¨æˆ·è¿›å…¥ -u root ä¿®æ”¹å®¹å™¨ä¸­çš„æ–‡ä»¶ æ–¹æ³•1ï¼šè¿›å…¥å®¹å™¨ï¼Œä½¿ç”¨vimä¿®æ”¹\næ–¹æ³•2ï¼šdocker cp\n1 # å°†æ–‡ä»¶ä»å®¹å™¨ä¸­copy åˆ°æœ¬åœ° 2 docker cp fbaf54e9940a:/opt/cerebro/conf ./ 3 # ä½¿ç”¨æœ¬åœ°ç¼–è¾‘å™¨ä¿®æ”¹åï¼Œcopyå›å®¹å™¨ä¸­ 4 docker cp application.conf fbaf54e9940a:/opt/cerebro/conf æ–¹æ³•3ï¼šè¿è¡Œå®¹å™¨æ—¶ä½¿ç”¨æœ¬åœ°çš„æ–‡ä»¶\n1# å†’å·å‰æ˜¯æœ¬åœ°è·¯å¾„ï¼ˆéœ€è¦ç»å¯¹è·¯å¾„ï¼‰ï¼Œå†’å·åæ˜¯å®¹å™¨ä¸­çš„è·¯å¾„ 2docker run -itd -p 8080:80 -v /etc/nginx/nginx.conf:/etc/nginx/nginx.conf --name=webtest nginx:latest å®‰è£…docker Debain 1# æŸ¥çœ‹dockerçŠ¶æ€ï¼Œå¹¶å°è¯•å¯åŠ¨. 2$ systemctl status docker 3$ /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock 4$ echo \u0026#39;\u0026#39; \u0026gt; /etc/modprobe.d/nf-blacklist.conf 5$ systemctl status docker.service 6 7# å¦‚æœå‡ºç° 8# failed to load listeners: no sockets found via socket activation: make sure the service was started by systemd 9$ systemctl daemon-reload 10$ service docker restart 11$ service docker status 12 13# æˆ–è€…å°† /etc/docker/daemon.json ç½®ä¸ºç©º{} docker image å¯¼å‡º 1# å¯¼å‡ºimage 2docker save -o new_file.tar mysql:8.0.2 3 4# é€šè¿‡taråŒ…è½½å…¥image, --input -i æŒ‡å®šå¯¼å…¥çš„æ–‡ä»¶ 5docker load --input new_file.tar dockerç¥å™¨ runlike\næ‰¹é‡åˆ é™¤å·²ç»exit çš„å®¹å™¨ https://www.cnblogs.com/brady-wang/p/10500597.html\nå®¹å™¨è‡ªåŠ¨é‡å¯ 1docker update --restart=always [container ID] fix Exited(139) https://github.com/docker/for-linux/issues/58\nIn case someone stumbles on this closed issue, here\u0026rsquo;s quick howto: Description: centos:6 docker image fails to start, no output given. Workaround: append vsyscall=emulate to line GRUB_CMDLINE_LINUX_DEFAULT in your /etc/default/grub. E.g.\n1GRUB_CMDLINE_LINUX_DEFAULT=\u0026#34;consoleblank=0 systemd.show_status=true elevator=noop console=tty1 console=ttyS0 vsyscall=emulate\u0026#34; then update grub update-grub and reboot host machine reboot\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Docker/dock_tips/","summary":"centos å®‰è£…docker æŠŠyumåŒ…æ›´æ–°åˆ°æœ€æ–°\n1yum update å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…\n1yum install -y yum-utils device-mapper-persistent-data lvm2 è®¾ç½®yumæº\n1yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo æŸ¥çœ‹æ‰€æœ‰ä»“åº“ä¸­æ‰€æœ‰dockerç‰ˆæœ¬ï¼Œå¹¶é€‰æ‹©ç‰¹å®šç‰ˆæœ¬å®‰è£…\n1yum list docker-ce --showduplicates | sort -r 2 3[root@MiWiFi-R3-srv ~]# yum list docker-ce --showduplicates | sort -r 4 * updates: mirrors.aliyun.com 5Loading mirror speeds from cached hostfile 6Loaded plugins: fastestmirror 7Installed Packages 8 * extras: mirrors.aliyun.com 9docker-ce.x86_64 3:18.09.0-3.el7 docker-ce-stable 10docker-ce.x86_64 18.06.1.ce-3.el7 docker-ce-stable 11docker-ce.x86_64 18.06.1.ce-3.el7 @docker-ce-stable 12docker-ce.x86_64 18.06.0.ce-3.el7 docker-ce-stable 13docker-ce.x86_64 18.03.1.ce-1.el7.centos docker-ce-stable 14docker-ce.x86_64 18.03.0.ce-1.el7.centos docker-ce-stable 15.","tags":null,"title":"ã€ŒDockerã€ Docker å¸¸ç”¨å‘½ä»¤"},{"categories":null,"contents":"docker runåˆ›å»ºå®¹å™¨æ—¶å€™ï¼Œå¯ä»¥ç”¨-netæŒ‡å®šå®¹å™¨çš„ç½‘ç»œæ¨¡å¼\n1# host æ¨¡å¼ 2--net=host 3# containeræ¨¡å¼ 4--net=container:NameorId 5# noneæ¨¡å¼ 6-net=none 7# bridgeæ¨¡å¼ 8-net=bridge host æ¨¡å¼\nå¦‚æœå¯åŠ¨å®¹å™¨çš„æ—¶å€™ä½¿ç”¨ host æ¨¡å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¹å™¨å°†ä¸ä¼šè·å¾—ä¸€ä¸ªç‹¬ç«‹çš„ Network Namespaceï¼Œè€Œæ˜¯å’Œå®¿ä¸»æœºå…±ç”¨ä¸€ä¸ª Network Namespaceã€‚å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ IP ç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„ IP å’Œç«¯å£ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ 10.10.101.105/24 çš„æœºå™¨ä¸Šç”¨ host æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå«æœ‰ web åº”ç”¨çš„ Docker å®¹å™¨ï¼Œç›‘å¬ tcp 80 ç«¯å£ã€‚å½“æˆ‘ä»¬åœ¨å®¹å™¨ä¸­æ‰§è¡Œä»»ä½•ç±»ä¼¼ ifconfig å‘½ä»¤æŸ¥çœ‹ç½‘ç»œç¯å¢ƒæ—¶ï¼Œçœ‹åˆ°çš„éƒ½æ˜¯å®¿ä¸»æœºä¸Šçš„ä¿¡æ¯ã€‚è€Œå¤–ç•Œè®¿é—®å®¹å™¨ä¸­çš„åº”ç”¨ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ 10.10.101.105:80 å³å¯ï¼Œä¸ç”¨ä»»ä½• NAT è½¬æ¢ï¼Œå°±å¦‚ç›´æ¥è·‘åœ¨å®¿ä¸»æœºä¸­ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå®¹å™¨çš„å…¶ä»–æ–¹é¢ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹åˆ—è¡¨ç­‰è¿˜æ˜¯å’Œå®¿ä¸»æœºéš”ç¦»çš„ã€‚\ncontainer æ¨¡å¼ è¿™ä¸ªæ¨¡å¼æŒ‡å®šæ–°åˆ›å»ºçš„å®¹å™¨å’Œå·²ç»å­˜åœ¨çš„ä¸€ä¸ªå®¹å™¨å…±äº«ä¸€ä¸ª Network Namespaceï¼Œè€Œä¸æ˜¯å’Œå®¿ä¸»æœºå…±äº«ã€‚æ–°åˆ›å»ºçš„å®¹å™¨ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ IPï¼Œè€Œæ˜¯å’Œä¸€ä¸ªæŒ‡å®šçš„å®¹å™¨å…±äº« IPã€ç«¯å£èŒƒå›´ç­‰ã€‚åŒæ ·ï¼Œä¸¤ä¸ªå®¹å™¨é™¤äº†ç½‘ç»œæ–¹é¢ï¼Œå…¶ä»–çš„å¦‚æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹åˆ—è¡¨ç­‰è¿˜æ˜¯éš”ç¦»çš„ã€‚ä¸¤ä¸ªå®¹å™¨çš„è¿›ç¨‹å¯ä»¥é€šè¿‡ lo ç½‘å¡è®¾å¤‡é€šä¿¡ã€‚\nnoneæ¨¡å¼ è¿™ä¸ªæ¨¡å¼å’Œå‰ä¸¤ä¸ªä¸åŒã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒDocker å®¹å™¨æ‹¥æœ‰è‡ªå·±çš„ Network Namespaceï¼Œä½†æ˜¯ï¼Œå¹¶ä¸ä¸º Dockerå®¹å™¨è¿›è¡Œä»»ä½•ç½‘ç»œé…ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ª Docker å®¹å™¨æ²¡æœ‰ç½‘å¡ã€IPã€è·¯ç”±ç­‰ä¿¡æ¯ã€‚éœ€è¦æˆ‘ä»¬è‡ªå·±ä¸º Docker å®¹å™¨æ·»åŠ ç½‘å¡ã€é…ç½® IP ç­‰ã€‚\nbridgeæ¨¡å¼ bridge æ¨¡å¼æ˜¯ Docker é»˜è®¤çš„ç½‘ç»œè®¾ç½®ï¼Œæ­¤æ¨¡å¼ä¼šä¸ºæ¯ä¸€ä¸ªå®¹å™¨åˆ†é… Network Namespaceã€è®¾ç½® IP ç­‰ï¼Œå¹¶å°†ä¸€ä¸ªä¸»æœºä¸Šçš„ Docker å®¹å™¨è¿æ¥åˆ°ä¸€ä¸ªè™šæ‹Ÿç½‘æ¡¥ä¸Šã€‚å½“ Docker server å¯åŠ¨æ—¶ï¼Œä¼šåœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ªåä¸º docker0 çš„è™šæ‹Ÿç½‘æ¡¥ï¼Œæ­¤ä¸»æœºä¸Šå¯åŠ¨çš„ Docker å®¹å™¨ä¼šè¿æ¥åˆ°è¿™ä¸ªè™šæ‹Ÿç½‘æ¡¥ä¸Šã€‚è™šæ‹Ÿç½‘æ¡¥çš„å·¥ä½œæ–¹å¼å’Œç‰©ç†äº¤æ¢æœºç±»ä¼¼ï¼Œè¿™æ ·ä¸»æœºä¸Šçš„æ‰€æœ‰å®¹å™¨å°±é€šè¿‡äº¤æ¢æœºè¿åœ¨äº†ä¸€ä¸ªäºŒå±‚ç½‘ç»œä¸­ã€‚æ¥ä¸‹æ¥å°±è¦ä¸ºå®¹å™¨åˆ†é… IP äº†ï¼ŒDocker ä¼šä» RFC1918 æ‰€å®šä¹‰çš„ç§æœ‰ IP ç½‘æ®µä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªå’Œå®¿ä¸»æœºä¸åŒçš„IPåœ°å€å’Œå­ç½‘åˆ†é…ç»™ docker0ï¼Œè¿æ¥åˆ° docker0 çš„å®¹å™¨å°±ä»è¿™ä¸ªå­ç½‘ä¸­é€‰æ‹©ä¸€ä¸ªæœªå ç”¨çš„ IP ä½¿ç”¨ã€‚å¦‚ä¸€èˆ¬ Docker ä¼šä½¿ç”¨ 172.17.0.0/16 è¿™ä¸ªç½‘æ®µï¼Œå¹¶å°† 172.17.42.1/16 åˆ†é…ç»™ docker0 ç½‘æ¡¥ï¼ˆåœ¨ä¸»æœºä¸Šä½¿ç”¨ ifconfig å‘½ä»¤æ˜¯å¯ä»¥çœ‹åˆ° docker0 çš„ï¼Œå¯ä»¥è®¤ä¸ºå®ƒæ˜¯ç½‘æ¡¥çš„ç®¡ç†æ¥å£ï¼Œåœ¨å®¿ä¸»æœºä¸Šä½œä¸ºä¸€å—è™šæ‹Ÿç½‘å¡ä½¿ç”¨ï¼‰\nå‚è€ƒæ–‡æ¡£\nhttps://www.huaweicloud.com/articles/5bb8f4efe7aaca9d4332750d73876db8.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Docker/docker_net/","summary":"docker runåˆ›å»ºå®¹å™¨æ—¶å€™ï¼Œå¯ä»¥ç”¨-netæŒ‡å®šå®¹å™¨çš„ç½‘ç»œæ¨¡å¼\n1# host æ¨¡å¼ 2--net=host 3# containeræ¨¡å¼ 4--net=container:NameorId 5# noneæ¨¡å¼ 6-net=none 7# bridgeæ¨¡å¼ 8-net=bridge host æ¨¡å¼\nå¦‚æœå¯åŠ¨å®¹å™¨çš„æ—¶å€™ä½¿ç”¨ host æ¨¡å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¹å™¨å°†ä¸ä¼šè·å¾—ä¸€ä¸ªç‹¬ç«‹çš„ Network Namespaceï¼Œè€Œæ˜¯å’Œå®¿ä¸»æœºå…±ç”¨ä¸€ä¸ª Network Namespaceã€‚å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ IP ç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„ IP å’Œç«¯å£ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ 10.10.101.105/24 çš„æœºå™¨ä¸Šç”¨ host æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå«æœ‰ web åº”ç”¨çš„ Docker å®¹å™¨ï¼Œç›‘å¬ tcp 80 ç«¯å£ã€‚å½“æˆ‘ä»¬åœ¨å®¹å™¨ä¸­æ‰§è¡Œä»»ä½•ç±»ä¼¼ ifconfig å‘½ä»¤æŸ¥çœ‹ç½‘ç»œç¯å¢ƒæ—¶ï¼Œçœ‹åˆ°çš„éƒ½æ˜¯å®¿ä¸»æœºä¸Šçš„ä¿¡æ¯ã€‚è€Œå¤–ç•Œè®¿é—®å®¹å™¨ä¸­çš„åº”ç”¨ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ 10.10.101.105:80 å³å¯ï¼Œä¸ç”¨ä»»ä½• NAT è½¬æ¢ï¼Œå°±å¦‚ç›´æ¥è·‘åœ¨å®¿ä¸»æœºä¸­ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå®¹å™¨çš„å…¶ä»–æ–¹é¢ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹åˆ—è¡¨ç­‰è¿˜æ˜¯å’Œå®¿ä¸»æœºéš”ç¦»çš„ã€‚\ncontainer æ¨¡å¼ è¿™ä¸ªæ¨¡å¼æŒ‡å®šæ–°åˆ›å»ºçš„å®¹å™¨å’Œå·²ç»å­˜åœ¨çš„ä¸€ä¸ªå®¹å™¨å…±äº«ä¸€ä¸ª Network Namespaceï¼Œè€Œä¸æ˜¯å’Œå®¿ä¸»æœºå…±äº«ã€‚æ–°åˆ›å»ºçš„å®¹å™¨ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ IPï¼Œè€Œæ˜¯å’Œä¸€ä¸ªæŒ‡å®šçš„å®¹å™¨å…±äº« IPã€ç«¯å£èŒƒå›´ç­‰ã€‚åŒæ ·ï¼Œä¸¤ä¸ªå®¹å™¨é™¤äº†ç½‘ç»œæ–¹é¢ï¼Œå…¶ä»–çš„å¦‚æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹åˆ—è¡¨ç­‰è¿˜æ˜¯éš”ç¦»çš„ã€‚ä¸¤ä¸ªå®¹å™¨çš„è¿›ç¨‹å¯ä»¥é€šè¿‡ lo ç½‘å¡è®¾å¤‡é€šä¿¡ã€‚\nnoneæ¨¡å¼ è¿™ä¸ªæ¨¡å¼å’Œå‰ä¸¤ä¸ªä¸åŒã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒDocker å®¹å™¨æ‹¥æœ‰è‡ªå·±çš„ Network Namespaceï¼Œä½†æ˜¯ï¼Œå¹¶ä¸ä¸º Dockerå®¹å™¨è¿›è¡Œä»»ä½•ç½‘ç»œé…ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ª Docker å®¹å™¨æ²¡æœ‰ç½‘å¡ã€IPã€è·¯ç”±ç­‰ä¿¡æ¯ã€‚éœ€è¦æˆ‘ä»¬è‡ªå·±ä¸º Docker å®¹å™¨æ·»åŠ ç½‘å¡ã€é…ç½® IP ç­‰ã€‚\nbridgeæ¨¡å¼ bridge æ¨¡å¼æ˜¯ Docker é»˜è®¤çš„ç½‘ç»œè®¾ç½®ï¼Œæ­¤æ¨¡å¼ä¼šä¸ºæ¯ä¸€ä¸ªå®¹å™¨åˆ†é… Network Namespaceã€è®¾ç½® IP ç­‰ï¼Œå¹¶å°†ä¸€ä¸ªä¸»æœºä¸Šçš„ Docker å®¹å™¨è¿æ¥åˆ°ä¸€ä¸ªè™šæ‹Ÿç½‘æ¡¥ä¸Šã€‚å½“ Docker server å¯åŠ¨æ—¶ï¼Œä¼šåœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ªåä¸º docker0 çš„è™šæ‹Ÿç½‘æ¡¥ï¼Œæ­¤ä¸»æœºä¸Šå¯åŠ¨çš„ Docker å®¹å™¨ä¼šè¿æ¥åˆ°è¿™ä¸ªè™šæ‹Ÿç½‘æ¡¥ä¸Šã€‚è™šæ‹Ÿç½‘æ¡¥çš„å·¥ä½œæ–¹å¼å’Œç‰©ç†äº¤æ¢æœºç±»ä¼¼ï¼Œè¿™æ ·ä¸»æœºä¸Šçš„æ‰€æœ‰å®¹å™¨å°±é€šè¿‡äº¤æ¢æœºè¿åœ¨äº†ä¸€ä¸ªäºŒå±‚ç½‘ç»œä¸­ã€‚æ¥ä¸‹æ¥å°±è¦ä¸ºå®¹å™¨åˆ†é… IP äº†ï¼ŒDocker ä¼šä» RFC1918 æ‰€å®šä¹‰çš„ç§æœ‰ IP ç½‘æ®µä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªå’Œå®¿ä¸»æœºä¸åŒçš„IPåœ°å€å’Œå­ç½‘åˆ†é…ç»™ docker0ï¼Œè¿æ¥åˆ° docker0 çš„å®¹å™¨å°±ä»è¿™ä¸ªå­ç½‘ä¸­é€‰æ‹©ä¸€ä¸ªæœªå ç”¨çš„ IP ä½¿ç”¨ã€‚å¦‚ä¸€èˆ¬ Docker ä¼šä½¿ç”¨ 172.","tags":null,"title":"ã€ŒDockerã€Docker ç½‘ç»œæ¨¡å¼"},{"categories":null,"contents":"å¤ç”¨http.request.body\nhttps://studygolang.com/articles/15641?fr=sideba\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/5.4ioutil/","summary":"å¤ç”¨http.request.body\nhttps://studygolang.com/articles/15641?fr=sideba","tags":null,"title":"ã€ŒGoã€ioutil"},{"categories":null,"contents":"pprof\nå¯ä»¥ç”¨äºåˆ†æç¨‹åºçš„æ€§èƒ½ï¼Œå¹¶æ‰¾åˆ°ç“¶é¢ˆç‚¹ã€‚\nç¨‹åºä¸­çš„ runtime/pprof æ€§èƒ½å‰–æå·¥å…· go tool pprof ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/performance_analysis/pprof/","summary":"pprof\nå¯ä»¥ç”¨äºåˆ†æç¨‹åºçš„æ€§èƒ½ï¼Œå¹¶æ‰¾åˆ°ç“¶é¢ˆç‚¹ã€‚\nç¨‹åºä¸­çš„ runtime/pprof æ€§èƒ½å‰–æå·¥å…· go tool pprof ","tags":null,"title":"ã€ŒGoã€pprof æ€§èƒ½åˆ†æ"},{"categories":null,"contents":"åŒ¿åstructæ¯”è¾ƒ\n1func main() { 2\tsn1 := struct { 3\tage int 4\tname string 5\t}{age: 11, name: \u0026#34;qq\u0026#34;} 6 7\tsn2 := struct { 8\tage int 9\tname string 10\t}{age: 11, name: \u0026#34;qq\u0026#34;} 11 12\tif sn1 == sn2 { 13\tfmt.Println(\u0026#34;sn1 == sn2\u0026#34;,sn1) 14\t} 15 16\tfmt.Printf(\u0026#34;sn1 addr %p\\n\u0026#34;,\u0026amp;sn1) 17\tfmt.Printf(\u0026#34;sn2 addr %p\\n\u0026#34;,\u0026amp;sn2) 18} 1sn1 == sn2 {11 qq} 2sn1 addr 0xc0000a6020 3sn2 addr 0xc0000a6040 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/5.5Struct/","summary":"åŒ¿åstructæ¯”è¾ƒ\n1func main() { 2\tsn1 := struct { 3\tage int 4\tname string 5\t}{age: 11, name: \u0026#34;qq\u0026#34;} 6 7\tsn2 := struct { 8\tage int 9\tname string 10\t}{age: 11, name: \u0026#34;qq\u0026#34;} 11 12\tif sn1 == sn2 { 13\tfmt.Println(\u0026#34;sn1 == sn2\u0026#34;,sn1) 14\t} 15 16\tfmt.Printf(\u0026#34;sn1 addr %p\\n\u0026#34;,\u0026amp;sn1) 17\tfmt.Printf(\u0026#34;sn2 addr %p\\n\u0026#34;,\u0026amp;sn2) 18} 1sn1 == sn2 {11 qq} 2sn1 addr 0xc0000a6020 3sn2 addr 0xc0000a6040 ","tags":null,"title":"ã€ŒGoã€Struct"},{"categories":null,"contents":" é‡ç‚¹å‰–æGoè¿è¡Œæ—¶çš„å†…éƒ¨æœºåˆ¶ï¼Œæ·±å…¥äº†è§£Goè¿è¡ŒæœŸçŠ¶æ€ï¼Œè§„é¿GCæ½œåœ¨çš„é—®é¢˜ï¼ŒèŠ‚çº¦å†…å­˜ï¼Œæå‡è¿è¡Œæ€§èƒ½\nç¯å¢ƒ Macç¯å¢ƒ\n(ä¸å»ºè®®ä½¿ç”¨ï¼Œä¼šæœ‰å¾ˆå¤šå›°æ‰°ï¼Œç›´æ¥ç”¨Linux)\nDebianç¯å¢ƒ ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œæ–‡ä»¶çœŸæ­£çš„æ‰§è¡Œå…¥å£å¹¶ä¸åœ¨main.goçš„mian()å‡½æ•°ä¸­ã€‚ç¼–è¯‘å™¨æ€»ä¼šæ’å…¥ä¸€æ®µå¼•å¯¼ä»£ç ï¼Œå®Œæˆå‘½ä»¤è¡Œå‚æ•°ã€è¿è¡Œæ—¶åˆå§‹åŒ–ç­‰å·¥ä½œæ‰ä¼šè¿›å…¥ç”¨æˆ·é€»è¾‘ã€‚\nç¼–è¯‘\u0026amp;GDBè°ƒè¯• main.go\n1package main 2 3func main() { 4\tprintln(\u0026#34;hello world\u0026#34;) 5} -gcflags \u0026ldquo;-N -l\u0026rdquo; å…³é—­ç¼–è¯‘å™¨ä»£ç ä¼˜åŒ–å’Œå‡½æ•°å†…è”ï¼Œé¿å…æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œæ— æ³•å‡†ç¡®å¯¹åº”æºç è¡Œï¼Œé¿å…å°å‡½æ•°å’Œå±€éƒ¨å˜é‡è¢«ä¼˜åŒ–æ‰\n1go build -gcflags \u0026#34;-N -l\u0026#34; 2# go build -gcflags \u0026#34;-N -l\u0026#34; -o test main.go é€šè¿‡info fileså¯ä»¥æ‰¾åˆ°ç¨‹åºçœŸæ­£çš„å…¥å£åœ°å€0x105a8c0 ,åˆ©ç”¨æ–­ç‚¹å‘½ä»¤å¯ä»¥æ‰¾åˆ°ç›®æ ‡æºæ–‡ä»¶ä¿¡æ¯ã€‚\nMac ä¸‹breakpoint å¹¶æœªæ˜¾ç¤ºå¯¹åº”çš„æ–‡ä»¶ä¿¡æ¯ï¼Œä»¥ä¸‹æ‰€æœ‰çš„æ“ä½œå‡åœ¨Debianä¸­æŸ¥çœ‹ã€‚\nä¸åŒçš„æ“ä½œç³»ç»Ÿå°±ä½¿ç”¨ä¸åŒçš„æ±‡ç¼–æ–‡ä»¶\nä¸‹é¢è¿™è¿™ä¸ªæ±‡ç¼–æ–‡ä»¶å®Œæˆäº†åˆå§‹åŒ–å’Œè¿è¡Œæ—¶çš„å¯åŠ¨åŠ¨ä½œã€‚\nè°ƒç”¨åˆå§‹åŒ–å‡½æ•° åˆ›å»ºmain goroutineç”¨äºæ‰§è¡Œruntime.main è®©å½“å‰çº¿ç¨‹å¼€å§‹æ‰§è¡Œmain goroutine è‡³æ­¤ï¼Œæ±‡ç¼–è¯­è¨€é’ˆå¯¹ç‰¹å®šå¹³å°çš„å¼•å¯¼è¿‡ç¨‹å…¨éƒ¨å®Œæˆï¼Œåç»­çš„å†…å®¹åŸºæœ¬ä¸Šéƒ½æ˜¯ç”±Goä»£ç å®ç°çš„ã€‚\ngoçš„æ±‡ç¼–\nGo ASM å’Œæ ‡å‡†çš„æ±‡ç¼–è¯­æ³•ï¼ˆ NASM æˆ– YASM ï¼‰ä¸å¤ªä¸€æ ·ï¼Œé¦–å…ˆä½ ä¼šå‘ç°å®ƒæ˜¯æ¶æ„ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰æ‰€è°“çš„ 32 æˆ– 64 ä½å¯„å­˜å™¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nTips:Mac é…ç½®gdbç¯å¢ƒ GDB Installation on Mac OS X\nâ€‹\tåœ¨macOSä¸Šï¼Œç”¨äºdebugçš„å·¥å…·æœ‰lldbå’Œgdb. å…¶ä¸­lldbä½œä¸ºä¸€ç§å¯å¤ç”¨çš„ç»„ä»¶ï¼Œå‚ä¸äº†å¤§å‹llvmé¡¹ç›®åº“çš„æ„æˆï¼›åŒæ—¶ï¼Œlldbä¹Ÿæ˜¯Xcodeé»˜è®¤çš„è°ƒè¯•å·¥å…·, æ”¯æŒWindows, macOS, iOS, Linuxå’ŒFreeBSD. è€Œgdbæ˜¯GNUé¡¹ç›®çš„è°ƒè¯•å™¨ï¼Œæ”¯æŒWindowså’Œå¤§å¤šæ•°UNIXå˜ç§ï¼Œä¹ŸåŒ…æ‹¬macOS.\n1brew install gdb é…ç½®è¯ä¹¦ç­¾å\nKeyChain Access æ–°å»ºä¸€ä¸ªç³»ç»Ÿè¯ä¹¦, æŒ‡å®šNameä¸ºgdb_cert, Identity Typeä¸ºSelf Signed Rootï¼ŒCertificate Type ä¸ºCode Signingã€‚ ä¸€ç›´continueï¼ŒKeychainä¸ºSystemã€‚å®Œæˆåè®¾ç½®ä¸ºAlways Trustã€‚ æ–°å»ºä¸€ä¸ªå«åšgdb-entitlement.xmlçš„æ–‡ä»¶\n1\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; 2\u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; 3\u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; 4\u0026lt;dict\u0026gt; 5 \u0026lt;key\u0026gt;com.apple.security.cs.debugger\u0026lt;/key\u0026gt; 6 \u0026lt;true/\u0026gt; 7\u0026lt;/dict\u0026gt; 8\u0026lt;/plist\u0026gt; æ‰§è¡Œ\n1codesign --entitlements gdb-entitlement.xml -fs gdb_cert \u0026#34;${which gdb}\u0026#34; 2# è§£å†³å¡æ­»é—®é¢˜ 3echo \u0026#34;set startup-with-shell off\u0026#34; \u0026gt;\u0026gt; ~/.gdbinit ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/source_code_profiling/mem_allocation/mem_allocation/","summary":"é‡ç‚¹å‰–æGoè¿è¡Œæ—¶çš„å†…éƒ¨æœºåˆ¶ï¼Œæ·±å…¥äº†è§£Goè¿è¡ŒæœŸçŠ¶æ€ï¼Œè§„é¿GCæ½œåœ¨çš„é—®é¢˜ï¼ŒèŠ‚çº¦å†…å­˜ï¼Œæå‡è¿è¡Œæ€§èƒ½\nç¯å¢ƒ Macç¯å¢ƒ\n(ä¸å»ºè®®ä½¿ç”¨ï¼Œä¼šæœ‰å¾ˆå¤šå›°æ‰°ï¼Œç›´æ¥ç”¨Linux)\nDebianç¯å¢ƒ ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œæ–‡ä»¶çœŸæ­£çš„æ‰§è¡Œå…¥å£å¹¶ä¸åœ¨main.goçš„mian()å‡½æ•°ä¸­ã€‚ç¼–è¯‘å™¨æ€»ä¼šæ’å…¥ä¸€æ®µå¼•å¯¼ä»£ç ï¼Œå®Œæˆå‘½ä»¤è¡Œå‚æ•°ã€è¿è¡Œæ—¶åˆå§‹åŒ–ç­‰å·¥ä½œæ‰ä¼šè¿›å…¥ç”¨æˆ·é€»è¾‘ã€‚\nç¼–è¯‘\u0026amp;GDBè°ƒè¯• main.go\n1package main 2 3func main() { 4\tprintln(\u0026#34;hello world\u0026#34;) 5} -gcflags \u0026ldquo;-N -l\u0026rdquo; å…³é—­ç¼–è¯‘å™¨ä»£ç ä¼˜åŒ–å’Œå‡½æ•°å†…è”ï¼Œé¿å…æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œæ— æ³•å‡†ç¡®å¯¹åº”æºç è¡Œï¼Œé¿å…å°å‡½æ•°å’Œå±€éƒ¨å˜é‡è¢«ä¼˜åŒ–æ‰\n1go build -gcflags \u0026#34;-N -l\u0026#34; 2# go build -gcflags \u0026#34;-N -l\u0026#34; -o test main.go é€šè¿‡info fileså¯ä»¥æ‰¾åˆ°ç¨‹åºçœŸæ­£çš„å…¥å£åœ°å€0x105a8c0 ,åˆ©ç”¨æ–­ç‚¹å‘½ä»¤å¯ä»¥æ‰¾åˆ°ç›®æ ‡æºæ–‡ä»¶ä¿¡æ¯ã€‚\nMac ä¸‹breakpoint å¹¶æœªæ˜¾ç¤ºå¯¹åº”çš„æ–‡ä»¶ä¿¡æ¯ï¼Œä»¥ä¸‹æ‰€æœ‰çš„æ“ä½œå‡åœ¨Debianä¸­æŸ¥çœ‹ã€‚\nä¸åŒçš„æ“ä½œç³»ç»Ÿå°±ä½¿ç”¨ä¸åŒçš„æ±‡ç¼–æ–‡ä»¶\nä¸‹é¢è¿™è¿™ä¸ªæ±‡ç¼–æ–‡ä»¶å®Œæˆäº†åˆå§‹åŒ–å’Œè¿è¡Œæ—¶çš„å¯åŠ¨åŠ¨ä½œã€‚\nè°ƒç”¨åˆå§‹åŒ–å‡½æ•° åˆ›å»ºmain goroutineç”¨äºæ‰§è¡Œruntime.main è®©å½“å‰çº¿ç¨‹å¼€å§‹æ‰§è¡Œmain goroutine è‡³æ­¤ï¼Œæ±‡ç¼–è¯­è¨€é’ˆå¯¹ç‰¹å®šå¹³å°çš„å¼•å¯¼è¿‡ç¨‹å…¨éƒ¨å®Œæˆï¼Œåç»­çš„å†…å®¹åŸºæœ¬ä¸Šéƒ½æ˜¯ç”±Goä»£ç å®ç°çš„ã€‚\ngoçš„æ±‡ç¼–\nGo ASM å’Œæ ‡å‡†çš„æ±‡ç¼–è¯­æ³•ï¼ˆ NASM æˆ– YASM ï¼‰ä¸å¤ªä¸€æ ·ï¼Œé¦–å…ˆä½ ä¼šå‘ç°å®ƒæ˜¯æ¶æ„ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰æ‰€è°“çš„ 32 æˆ– 64 ä½å¯„å­˜å™¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nTips:Mac é…ç½®gdbç¯å¢ƒ GDB Installation on Mac OS X","tags":null,"title":"ã€ŒGoã€å†…å­˜åˆ†é…"},{"categories":null,"contents":"å †å†…å­˜ä¸æ ˆå†…å­˜\nGoç¨‹åºä¼šåœ¨ä¸¤ä¸ªåœ°æ–¹ä¸ºå˜é‡åˆ†é…å†…å­˜ï¼Œä¸€ä¸ªæ˜¯å…¨å±€çš„å †ç©ºé—´ç”¨æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œå¦ä¸€ä¸ªæ˜¯æ¯ä¸ªgoroutineçš„æ ˆç©ºé—´ã€‚ä¸Javaã€Pythonç­‰è¯­è¨€ç±»ä¼¼ï¼ŒGoè¯­è¨€å®ç°åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæ‰€ä»¥Goè¯­è¨€çš„å†…å­˜ç®¡ç†æ˜¯è‡ªåŠ¨çš„ï¼Œé€šå¸¸å¼€å‘è€…ä¸ç”¨å…³å¿ƒå†…å­˜åˆ†é…åˆ°æ ˆä¸Šè¿˜æ˜¯å †ä¸Šã€‚ä½†æ˜¯ä»æ€§èƒ½çš„è§’åº¦å‡ºå‘ï¼Œåœ¨æ ˆä¸Šå’Œå †ä¸Šåˆ†é…å†…å­˜ï¼Œæ€§èƒ½å·®å¼‚æ˜¯éå¸¸å¤§çš„ã€‚\nåœ¨å‡½æ•°ä¸­ç”³è¯·ä¸€ä¸ªå¯¹è±¡ï¼Œï¼Œå¦‚æœåˆ†é…åœ¨æ ˆä¸­ï¼Œå‡½æ•°æ‰§è¡Œç»“æŸæ—¶è‡ªåŠ¨å›æ”¶ï¼›å¦‚æœåˆ†é…åœ¨å †ä¸­ï¼Œåˆ™åœ¨å‡½æ•°ç»“æŸåæŸä¸ªæ—¶é—´ç‚¹è¿›è¡Œåƒåœ¾å›æ”¶ã€‚\nåœ¨æ ˆä¸Šåˆ†é…å’Œå›æ”¶å†…å­˜çš„å¼€é”€å¾ˆä½ï¼Œåªéœ€è¦2ä¸ªcpuæŒ‡ä»¤: PUSHå’ŒPOPã€‚ä¸€ä¸ªæ˜¯å°†æ•°æ®pushåˆ°æ ˆç©ºé—´ä»¥å®Œæˆåˆ†é…ï¼Œpopåˆ™æ˜¯é‡Šæ”¾ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œæ¶ˆè€—çš„ä»…æ˜¯å°†æ•°æ®copyåˆ°å†…å­˜çš„æ—¶é—´ã€‚å†…å­˜çš„I/Oé€šå¸¸èƒ½è¾¾åˆ°30GB/sï¼Œå› æ­¤åœ¨æ ˆä¸Šåˆ†é…å†…å­˜çš„æ•ˆç‡æ˜¯éå¸¸é«˜çš„ã€‚\nåœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œä¸€ä¸ªå¾ˆå¤§çš„é¢å¤–å¼€é”€åˆ™æ˜¯åƒåœ¾å›æ”¶ã€‚Goè¯­è¨€ä½¿ç”¨çš„æ˜¯æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šä½¿ç”¨äº†ä¸‰è‰²æ ‡è®°æ³•å’Œå†™å±éšœæŠ€æœ¯ï¼Œæé«˜äº†æ•ˆç‡ã€‚\nå‚è€ƒèµ„æ–™ï¼š\nhttps://geektutu.com/post/hpg-escape-analysis.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/compile_optimize/escape_analysis/","summary":"å †å†…å­˜ä¸æ ˆå†…å­˜\nGoç¨‹åºä¼šåœ¨ä¸¤ä¸ªåœ°æ–¹ä¸ºå˜é‡åˆ†é…å†…å­˜ï¼Œä¸€ä¸ªæ˜¯å…¨å±€çš„å †ç©ºé—´ç”¨æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œå¦ä¸€ä¸ªæ˜¯æ¯ä¸ªgoroutineçš„æ ˆç©ºé—´ã€‚ä¸Javaã€Pythonç­‰è¯­è¨€ç±»ä¼¼ï¼ŒGoè¯­è¨€å®ç°åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæ‰€ä»¥Goè¯­è¨€çš„å†…å­˜ç®¡ç†æ˜¯è‡ªåŠ¨çš„ï¼Œé€šå¸¸å¼€å‘è€…ä¸ç”¨å…³å¿ƒå†…å­˜åˆ†é…åˆ°æ ˆä¸Šè¿˜æ˜¯å †ä¸Šã€‚ä½†æ˜¯ä»æ€§èƒ½çš„è§’åº¦å‡ºå‘ï¼Œåœ¨æ ˆä¸Šå’Œå †ä¸Šåˆ†é…å†…å­˜ï¼Œæ€§èƒ½å·®å¼‚æ˜¯éå¸¸å¤§çš„ã€‚\nåœ¨å‡½æ•°ä¸­ç”³è¯·ä¸€ä¸ªå¯¹è±¡ï¼Œï¼Œå¦‚æœåˆ†é…åœ¨æ ˆä¸­ï¼Œå‡½æ•°æ‰§è¡Œç»“æŸæ—¶è‡ªåŠ¨å›æ”¶ï¼›å¦‚æœåˆ†é…åœ¨å †ä¸­ï¼Œåˆ™åœ¨å‡½æ•°ç»“æŸåæŸä¸ªæ—¶é—´ç‚¹è¿›è¡Œåƒåœ¾å›æ”¶ã€‚\nåœ¨æ ˆä¸Šåˆ†é…å’Œå›æ”¶å†…å­˜çš„å¼€é”€å¾ˆä½ï¼Œåªéœ€è¦2ä¸ªcpuæŒ‡ä»¤: PUSHå’ŒPOPã€‚ä¸€ä¸ªæ˜¯å°†æ•°æ®pushåˆ°æ ˆç©ºé—´ä»¥å®Œæˆåˆ†é…ï¼Œpopåˆ™æ˜¯é‡Šæ”¾ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œæ¶ˆè€—çš„ä»…æ˜¯å°†æ•°æ®copyåˆ°å†…å­˜çš„æ—¶é—´ã€‚å†…å­˜çš„I/Oé€šå¸¸èƒ½è¾¾åˆ°30GB/sï¼Œå› æ­¤åœ¨æ ˆä¸Šåˆ†é…å†…å­˜çš„æ•ˆç‡æ˜¯éå¸¸é«˜çš„ã€‚\nåœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œä¸€ä¸ªå¾ˆå¤§çš„é¢å¤–å¼€é”€åˆ™æ˜¯åƒåœ¾å›æ”¶ã€‚Goè¯­è¨€ä½¿ç”¨çš„æ˜¯æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šä½¿ç”¨äº†ä¸‰è‰²æ ‡è®°æ³•å’Œå†™å±éšœæŠ€æœ¯ï¼Œæé«˜äº†æ•ˆç‡ã€‚\nå‚è€ƒèµ„æ–™ï¼š\nhttps://geektutu.com/post/hpg-escape-analysis.html","tags":null,"title":"ã€ŒGoã€é€ƒé€¸åˆ†æ"},{"categories":null,"contents":"Grafanaç›‘æ§é¢æ¿ å®‰è£…\n1docker run -d --name=grafana -p 3000:3000 grafana/grafana ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/install_grafana/","summary":"Grafanaç›‘æ§é¢æ¿ å®‰è£…\n1docker run -d --name=grafana -p 3000:3000 grafana/grafana ","tags":null,"title":"ã€ŒGrafanaã€å®‰è£…ä½¿ç”¨Grafana"},{"categories":null,"contents":"å†¥ç‹å³¡è°·å¯ä»¥ä½¿ç”¨HacMiniå®ç°å‚»ç“œåŒ–çš„å®Œç¾é»‘è‹¹æœï¼Œç›®å‰å·²ç»å®Œç¾æ”¯æŒBig Sur 11.1ã€‚åªéœ€é¢å¤–ä¹°ä¸€ä¸ªæ— çº¿ç½‘å¡ï¼Œæ—¢å¯ä»¥å®ç°WiFiã€è“ç‰™ã€Airdropå’ŒHandOffçš„å®Œç¾ä½¿ç”¨ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/nuc_perfect_hacintosh/","summary":"å†¥ç‹å³¡è°·å¯ä»¥ä½¿ç”¨HacMiniå®ç°å‚»ç“œåŒ–çš„å®Œç¾é»‘è‹¹æœï¼Œç›®å‰å·²ç»å®Œç¾æ”¯æŒBig Sur 11.1ã€‚åªéœ€é¢å¤–ä¹°ä¸€ä¸ªæ— çº¿ç½‘å¡ï¼Œæ—¢å¯ä»¥å®ç°WiFiã€è“ç‰™ã€Airdropå’ŒHandOffçš„å®Œç¾ä½¿ç”¨ã€‚","tags":null,"title":"ã€ŒHackintoshã€å†¥ç‹å³¡è°· å®Œç¾é»‘è‹¹æœ"},{"categories":null,"contents":"hugo å¢åŠ  è¯„è®º\nç¼–è¯‘\u0026amp;å‘å¸ƒ\nMarkDown è¯­æ³• å…¬å¼è§£æ\nå¼•å…¥MathJaxã€‚MathJax æ˜¯ä¸€ä¸ªJavascriptåº“ï¼Œé€šè¿‡å®˜æ–¹æä¾›çš„CDNé›†æˆåˆ°è‡ªå·±çš„é¡µé¢éå¸¸ç®€å•ï¼Œåªéœ€æŠŠä¸€ä¸‹å†…å®¹æ·»åŠ åˆ°æ‰€æœ‰çš„é¡µé¢ï¼Œä¾‹å¦‚foot.html\n1\u0026lt;script type=\u0026#34;text/javascript\u0026#34; async 2 src=\u0026#34;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML\u0026#34;\u0026gt; 3\u0026lt;/script\u0026gt; é…ç½®æ–‡ä»¶ config.toml ä»£ç é«˜äº®è®¾ç½®\n1pygmentsUseClasses = true 2[markup] 3 [markup.highlight] 4 codeFences = true 5 guessSyntax = true 6 hl_Lines = \u0026#34;\u0026#34; 7 lineNoStart = 1 # display line number 8 lineNos = true 9 lineNumbersInTable = false 10 noClasses = true 11 style = \u0026#34;github\u0026#34; 12 tabWidth = 4 è¡Œå·å·²ç»å¯ä»¥æ˜¾ç¤ºäº†ï¼Œä½†æ˜¯å¤åˆ¶çš„æ—¶å€™ä¼šä¸è¡Œå·ä¸€èµ·å¤åˆ¶ï¼Œä¿®æ”¹è‡ªå®šä¹‰css\n1.highlight .ln { 2 width: 20px; 3 display: block; 4 float: left; 5 text-align: right; 6 user-select: none; # è¡¨ç¤ºå¤åˆ¶æ˜¯ä¸èƒ½è¢«é€‰ä¸­çš„ 7 padding-right: 8px; 8 color: #ccc; 9} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/hugo_basic/","summary":"hugo å¢åŠ  è¯„è®º\nç¼–è¯‘\u0026amp;å‘å¸ƒ\nMarkDown è¯­æ³• å…¬å¼è§£æ\nå¼•å…¥MathJaxã€‚MathJax æ˜¯ä¸€ä¸ªJavascriptåº“ï¼Œé€šè¿‡å®˜æ–¹æä¾›çš„CDNé›†æˆåˆ°è‡ªå·±çš„é¡µé¢éå¸¸ç®€å•ï¼Œåªéœ€æŠŠä¸€ä¸‹å†…å®¹æ·»åŠ åˆ°æ‰€æœ‰çš„é¡µé¢ï¼Œä¾‹å¦‚foot.html\n1\u0026lt;script type=\u0026#34;text/javascript\u0026#34; async 2 src=\u0026#34;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML\u0026#34;\u0026gt; 3\u0026lt;/script\u0026gt; é…ç½®æ–‡ä»¶ config.toml ä»£ç é«˜äº®è®¾ç½®\n1pygmentsUseClasses = true 2[markup] 3 [markup.highlight] 4 codeFences = true 5 guessSyntax = true 6 hl_Lines = \u0026#34;\u0026#34; 7 lineNoStart = 1 # display line number 8 lineNos = true 9 lineNumbersInTable = false 10 noClasses = true 11 style = \u0026#34;github\u0026#34; 12 tabWidth = 4 è¡Œå·å·²ç»å¯ä»¥æ˜¾ç¤ºäº†ï¼Œä½†æ˜¯å¤åˆ¶çš„æ—¶å€™ä¼šä¸è¡Œå·ä¸€èµ·å¤åˆ¶ï¼Œä¿®æ”¹è‡ªå®šä¹‰css\n1.highlight .ln { 2 width: 20px; 3 display: block; 4 float: left; 5 text-align: right; 6 user-select: none; # è¡¨ç¤ºå¤åˆ¶æ˜¯ä¸èƒ½è¢«é€‰ä¸­çš„ 7 padding-right: 8px; 8 color: #ccc; 9} ","tags":null,"title":"ã€ŒHugoã€HugoåŸºæœ¬ä½¿ç”¨"},{"categories":null,"contents":"å®‰è£…InfluxDB 1docker run --name=influxdb -d -p 8086:8086 influxdb 2docker exec -it influxdb influx InfluxDB Desc å¯¹åº”æ•°æ®åº“ database æ•°æ®åº“ measurement æ•°æ®åº“ä¸­çš„è¡¨ point è¡¨ä¸­çš„ä¸€è¡Œæ•°æ® databases\n1show databases 2use iaas_metrics 3show measurements æ•°æ®æŸ¥è¯¢\n1select * from host_CpuBusy where time \u0026gt; now() -7d order by time limit 10; influx(\u0026ldquo;telegraf\u0026rdquo;, \u0026lsquo;\u0026lsquo;\u0026lsquo;SELECT sum(usage_system) FROM \u0026ldquo;cpu\u0026rdquo; group by \u0026ldquo;host\u0026rdquo; \u0026lsquo;\u0026rsquo;\u0026rsquo;, \u0026ldquo;20m\u0026rdquo;, \u0026ldquo;2m\u0026rdquo;, \u0026ldquo;1m\u0026rdquo;)****\nhttps://zhuanlan.zhihu.com/p/97247465\nhttps://zhuanlan.zhihu.com/p/85097140\nhttps://www.cnblogs.com/suhaha/p/11692210.html\nhttps://www.cnblogs.com/suhaha/p/11692210.html\ngrafa é…ç½®æŸ¥è¯¢influxdb\nhttps://ken.io/note/grafana-quickstart-influxdb-datasource-graph\nhttps://www.jianshu.com/p/f0905f36e9c3\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/install_influxdb/","summary":"å®‰è£…InfluxDB 1docker run --name=influxdb -d -p 8086:8086 influxdb 2docker exec -it influxdb influx InfluxDB Desc å¯¹åº”æ•°æ®åº“ database æ•°æ®åº“ measurement æ•°æ®åº“ä¸­çš„è¡¨ point è¡¨ä¸­çš„ä¸€è¡Œæ•°æ® databases\n1show databases 2use iaas_metrics 3show measurements æ•°æ®æŸ¥è¯¢\n1select * from host_CpuBusy where time \u0026gt; now() -7d order by time limit 10; influx(\u0026ldquo;telegraf\u0026rdquo;, \u0026lsquo;\u0026lsquo;\u0026lsquo;SELECT sum(usage_system) FROM \u0026ldquo;cpu\u0026rdquo; group by \u0026ldquo;host\u0026rdquo; \u0026lsquo;\u0026rsquo;\u0026rsquo;, \u0026ldquo;20m\u0026rdquo;, \u0026ldquo;2m\u0026rdquo;, \u0026ldquo;1m\u0026rdquo;)****\nhttps://zhuanlan.zhihu.com/p/97247465\nhttps://zhuanlan.zhihu.com/p/85097140\nhttps://www.cnblogs.com/suhaha/p/11692210.html\nhttps://www.cnblogs.com/suhaha/p/11692210.html\ngrafa é…ç½®æŸ¥è¯¢influxdb\nhttps://ken.io/note/grafana-quickstart-influxdb-datasource-graph\nhttps://www.jianshu.com/p/f0905f36e9c3","tags":null,"title":"ã€ŒInfluxDBã€InfluxDB å®‰è£…"},{"categories":null,"contents":"Automic åŸå­ç±» 1 Atomic åŸå­ç±»ä»‹ç» Atomic æ˜¯æŒ‡ä¸€ä¸ªæ“ä½œæ˜¯ä¸å¯ä¸­æ–­çš„ã€‚å³ä½¿æ˜¯åœ¨å¤šä¸ªçº¿ç¨‹ä¸€èµ·æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€ä¸ªæ“ä½œä¸€æ—¦å¼€å§‹ï¼Œå°±ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹å¹²æ‰°ã€‚\næ‰€ä»¥ï¼Œæ‰€è°“åŸå­ç±»è¯´ç®€å•ç‚¹å°±æ˜¯å…·æœ‰åŸå­/åŸå­æ“ä½œç‰¹å¾çš„ç±»ã€‚\nå¹¶å‘åŒ… java.util.concurrent çš„åŸå­ç±»éƒ½å­˜æ”¾åœ¨java.util.concurrent.atomicä¸‹,å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\næ ¹æ®æ“ä½œçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°†JUCåŒ…ä¸­çš„åŸå­ç±»åˆ†ä¸º4ç±»\nåŸºæœ¬ç±»å‹\nä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹\nAtomicIntegerï¼šæ•´å‹åŸå­ç±» AtomicLongï¼šé•¿æ•´å‹åŸå­ç±» AtomicBoolean ï¼šå¸ƒå°”å‹åŸå­ç±» æ•°ç»„ç±»å‹\nä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´ \nAtomicIntegerArrayï¼šæ•´å‹æ•°ç»„åŸå­ç±» AtomicLongArrayï¼šé•¿æ•´å‹æ•°ç»„åŸå­ç±» AtomicReferenceArray ï¼šå¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±» å¼•ç”¨ç±»å‹\nAtomicReferenceï¼šå¼•ç”¨ç±»å‹åŸå­ç±» AtomicReferenceFieldUpdaterï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µ AtomicMarkableReference ï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°ä½çš„å¼•ç”¨ç±»å‹ å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹\nAtomicIntegerFieldUpdater:åŸå­æ›´æ–°æ•´å‹å­—æ®µçš„æ›´æ–°å™¨ AtomicLongFieldUpdaterï¼šåŸå­æ›´æ–°é•¿æ•´å‹å­—æ®µçš„æ›´æ–°å™¨ AtomicStampedReference ï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†æ•´æ•°å€¼ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œå¯ç”¨äºè§£å†³åŸå­çš„æ›´æ–°æ•°æ®å’Œæ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚ AtomicMarkableReferenceï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°† boolean æ ‡è®°ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œä¹Ÿå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚ CAS ABA é—®é¢˜\næè¿°: ç¬¬ä¸€ä¸ªçº¿ç¨‹å–åˆ°äº†å˜é‡ x çš„å€¼ Aï¼Œç„¶åå·´æ‹‰å·´æ‹‰å¹²åˆ«çš„äº‹ï¼Œæ€»ä¹‹å°±æ˜¯åªæ‹¿åˆ°äº†å˜é‡ x çš„å€¼ Aã€‚è¿™æ®µæ—¶é—´å†…ç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿå–åˆ°äº†å˜é‡ x çš„å€¼ Aï¼Œç„¶åæŠŠå˜é‡ x çš„å€¼æ”¹ä¸º Bï¼Œç„¶åå·´æ‹‰å·´æ‹‰å¹²åˆ«çš„äº‹ï¼Œæœ€ååˆæŠŠå˜é‡ x çš„å€¼å˜ä¸º A ï¼ˆç›¸å½“äºè¿˜åŸäº†ï¼‰ã€‚åœ¨è¿™ä¹‹åç¬¬ä¸€ä¸ªçº¿ç¨‹ç»ˆäºè¿›è¡Œäº†å˜é‡ x çš„æ“ä½œï¼Œä½†æ˜¯æ­¤æ—¶å˜é‡ x çš„å€¼è¿˜æ˜¯ Aï¼Œæ‰€ä»¥ compareAndSet æ“ä½œæ˜¯æˆåŠŸã€‚ ä¾‹å­æè¿°(å¯èƒ½ä¸å¤ªåˆé€‚ï¼Œä½†å¥½ç†è§£): å¹´åˆï¼Œç°é‡‘ä¸ºé›¶ï¼Œç„¶åé€šè¿‡æ­£å¸¸åŠ³åŠ¨èµšäº†ä¸‰ç™¾ä¸‡ï¼Œä¹‹åæ­£å¸¸æ¶ˆè´¹äº†ï¼ˆæ¯”å¦‚ä¹°æˆ¿å­ï¼‰ä¸‰ç™¾ä¸‡ã€‚å¹´æœ«ï¼Œè™½ç„¶ç°é‡‘é›¶æ”¶å…¥ï¼ˆå¯èƒ½å˜æˆå…¶ä»–å½¢å¼äº†ï¼‰ï¼Œä½†æ˜¯èµšäº†é’±æ˜¯äº‹å®ï¼Œè¿˜æ˜¯å¾—äº¤ç¨çš„ï¼ ä»£ç ä¾‹å­ï¼ˆä»¥AtomicIntegerä¸ºä¾‹ï¼‰ 1import java.util.concurrent.atomic.AtomicInteger; 2 3public class AtomicIntegerDefectDemo { 4 public static void main(String[] args) { 5 defectOfABA(); 6 } 7 8 static void defectOfABA() { 9 final AtomicInteger atomicInteger = new AtomicInteger(1); 10 11 Thread coreThread = new Thread( 12 () -\u0026gt; { 13 final int currentValue = atomicInteger.get(); 14 System.out.println(Thread.currentThread().getName() + \u0026#34; ------ currentValue=\u0026#34; + currentValue); 15 16 // è¿™æ®µç›®çš„ï¼šæ¨¡æ‹Ÿå¤„ç†å…¶ä»–ä¸šåŠ¡èŠ±è´¹çš„æ—¶é—´ 17 try { 18 Thread.sleep(300); 19 } catch (InterruptedException e) { 20 e.printStackTrace(); 21 } 22 23 boolean casResult = atomicInteger.compareAndSet(1, 2); 24 System.out.println(Thread.currentThread().getName() 25 + \u0026#34; ------ currentValue=\u0026#34; + currentValue 26 + \u0026#34;, finalValue=\u0026#34; + atomicInteger.get() 27 + \u0026#34;, compareAndSet Result=\u0026#34; + casResult); 28 } 29 ); 30 coreThread.start(); 31 32 // è¿™æ®µç›®çš„ï¼šä¸ºäº†è®© coreThread çº¿ç¨‹å…ˆè·‘èµ·æ¥ 33 try { 34 Thread.sleep(100); 35 } catch (InterruptedException e) { 36 e.printStackTrace(); 37 } 38 39 Thread amateurThread = new Thread( 40 () -\u0026gt; { 41 int currentValue = atomicInteger.get(); 42 boolean casResult = atomicInteger.compareAndSet(1, 2); 43 System.out.println(Thread.currentThread().getName() 44 + \u0026#34; ------ currentValue=\u0026#34; + currentValue 45 + \u0026#34;, finalValue=\u0026#34; + atomicInteger.get() 46 + \u0026#34;, compareAndSet Result=\u0026#34; + casResult); 47 48 currentValue = atomicInteger.get(); 49 casResult = atomicInteger.compareAndSet(2, 1); 50 System.out.println(Thread.currentThread().getName() 51 + \u0026#34; ------ currentValue=\u0026#34; + currentValue 52 + \u0026#34;, finalValue=\u0026#34; + atomicInteger.get() 53 + \u0026#34;, compareAndSet Result=\u0026#34; + casResult); 54 } 55 ); 56 amateurThread.start(); 57 } 58} 59â€‹``` 60 61è¾“å‡ºå†…å®¹å¦‚ä¸‹ï¼š Thread-0 \u0026mdash;\u0026mdash; currentValue=1 Thread-1 \u0026mdash;\u0026mdash; currentValue=1, finalValue=2, compareAndSet Result=true Thread-1 \u0026mdash;\u0026mdash; currentValue=2, finalValue=1, compareAndSet Result=true Thread-0 \u0026mdash;\u0026mdash; currentValue=1, finalValue=2, compareAndSet Result=true â€‹```\nä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹è¿™äº›åŸå­ç±»ã€‚\n2 åŸºæœ¬ç±»å‹åŸå­ç±» 2.1 åŸºæœ¬ç±»å‹åŸå­ç±»ä»‹ç» ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹\nAtomicIntegerï¼šæ•´å‹åŸå­ç±» AtomicLongï¼šé•¿æ•´å‹åŸå­ç±» AtomicBoolean ï¼šå¸ƒå°”å‹åŸå­ç±» ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥ AtomicInteger ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚\nAtomicInteger ç±»å¸¸ç”¨æ–¹æ³•\n1public final int get() //è·å–å½“å‰çš„å€¼ 2public final int getAndSet(int newValue)//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼ 3public final int getAndIncrement()//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå¢ 4public final int getAndDecrement() //è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå‡ 5public final int getAndAdd(int delta) //è·å–å½“å‰çš„å€¼ï¼Œå¹¶åŠ ä¸Šé¢„æœŸçš„å€¼ 6boolean compareAndSet(int expect, int update) //å¦‚æœè¾“å…¥çš„æ•°å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºè¾“å…¥å€¼ï¼ˆupdateï¼‰ 7public final void lazySet(int newValue)//æœ€ç»ˆè®¾ç½®ä¸ºnewValue,ä½¿ç”¨ lazySet è®¾ç½®ä¹‹åå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹åœ¨ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…è¿˜æ˜¯å¯ä»¥è¯»åˆ°æ—§çš„å€¼ã€‚ 8â€‹``` 9 10#### 2.2 AtomicInteger å¸¸è§æ–¹æ³•ä½¿ç”¨ 11 12â€‹```java 13import java.util.concurrent.atomic.AtomicInteger; 14 15public class AtomicIntegerTest { 16 17\tpublic static void main(String[] args) { 18\t// TODO Auto-generated method stub 19\tint temvalue = 0; 20\tAtomicInteger i = new AtomicInteger(0); 21\ttemvalue = i.getAndSet(3); 22\tSystem.out.println(\u0026#34;temvalue:\u0026#34; + temvalue + \u0026#34;; i:\u0026#34; + i);//temvalue:0; i:3 23\ttemvalue = i.getAndIncrement(); 24\tSystem.out.println(\u0026#34;temvalue:\u0026#34; + temvalue + \u0026#34;; i:\u0026#34; + i);//temvalue:3; i:4 25\ttemvalue = i.getAndAdd(5); 26\tSystem.out.println(\u0026#34;temvalue:\u0026#34; + temvalue + \u0026#34;; i:\u0026#34; + i);//temvalue:4; i:9 27\t} 28 29} 30â€‹``` 31 32#### 2.3 åŸºæœ¬æ•°æ®ç±»å‹åŸå­ç±»çš„ä¼˜åŠ¿ 33 34é€šè¿‡ä¸€ä¸ªç®€å•ä¾‹å­å¸¦å¤§å®¶çœ‹ä¸€ä¸‹åŸºæœ¬æ•°æ®ç±»å‹åŸå­ç±»çš„ä¼˜åŠ¿ 35 36**â‘ å¤šçº¿ç¨‹ç¯å¢ƒä¸ä½¿ç”¨åŸå­ç±»ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ï¼‰** 37 38â€‹```java 39class Test { 40 private volatile int count = 0; 41 //è‹¥è¦çº¿ç¨‹å®‰å…¨æ‰§è¡Œæ‰§è¡Œcount++ï¼Œéœ€è¦åŠ é” 42 public synchronized void increment() { 43 count++; 44 } 45 46 public int getCount() { 47 return count; 48 } 49} 50â€‹``` 51**â‘¡å¤šçº¿ç¨‹ç¯å¢ƒä½¿ç”¨åŸå­ç±»ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ï¼‰** 52 53â€‹```java 54class Test2 { 55 private AtomicInteger count = new AtomicInteger(); 56 57 public void increment() { 58 count.incrementAndGet(); 59 } 60 //ä½¿ç”¨AtomicIntegerä¹‹åï¼Œä¸éœ€è¦åŠ é”ï¼Œä¹Ÿå¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨ã€‚ 61 public int getCount() { 62 return count.get(); 63 } 64} 2.4 AtomicInteger çº¿ç¨‹å®‰å…¨åŸç†ç®€å•åˆ†æ AtomicInteger ç±»çš„éƒ¨åˆ†æºç ï¼š\n1 // setup to use Unsafe.compareAndSwapInt for updatesï¼ˆæ›´æ–°æ“ä½œæ—¶æä¾›â€œæ¯”è¾ƒå¹¶æ›¿æ¢â€çš„ä½œç”¨ï¼‰ 2 private static final Unsafe unsafe = Unsafe.getUnsafe(); 3 private static final long valueOffset; 4 5 static { 6 try { 7 valueOffset = unsafe.objectFieldOffset 8 (AtomicInteger.class.getDeclaredField(\u0026#34;value\u0026#34;)); 9 } catch (Exception ex) { throw new Error(ex); } 10 } 11 12 private volatile int value; AtomicInteger ç±»ä¸»è¦åˆ©ç”¨ CAS (compare and swap) + volatile å’Œ native æ–¹æ³•æ¥ä¿è¯åŸå­æ“ä½œï¼Œä»è€Œé¿å… synchronized çš„é«˜å¼€é”€ï¼Œæ‰§è¡Œæ•ˆç‡å¤§ä¸ºæå‡ã€‚\nCASçš„åŸç†æ˜¯æ‹¿æœŸæœ›çš„å€¼å’ŒåŸæœ¬çš„ä¸€ä¸ªå€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™æ›´æ–°æˆæ–°çš„å€¼ã€‚UnSafe ç±»çš„ objectFieldOffset() æ–¹æ³•æ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥æ‹¿åˆ°â€œåŸæ¥çš„å€¼â€çš„å†…å­˜åœ°å€ã€‚å¦å¤– value æ˜¯ä¸€ä¸ªvolatileå˜é‡ï¼Œåœ¨å†…å­˜ä¸­å¯è§ï¼Œå› æ­¤ JVM å¯ä»¥ä¿è¯ä»»ä½•æ—¶åˆ»ä»»ä½•çº¿ç¨‹æ€»èƒ½æ‹¿åˆ°è¯¥å˜é‡çš„æœ€æ–°å€¼ã€‚\n3 æ•°ç»„ç±»å‹åŸå­ç±» 3.1 æ•°ç»„ç±»å‹åŸå­ç±»ä»‹ç» ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´ \nAtomicIntegerArrayï¼šæ•´å½¢æ•°ç»„åŸå­ç±» AtomicLongArrayï¼šé•¿æ•´å½¢æ•°ç»„åŸå­ç±» AtomicReferenceArray ï¼šå¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±» ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥ AtomicIntegerArray ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚\nAtomicIntegerArray ç±»å¸¸ç”¨æ–¹æ³•\n1public final int get(int i) //è·å– index=i ä½ç½®å…ƒç´ çš„å€¼ 2public final int getAndSet(int i, int newValue)//è¿”å› index=i ä½ç½®çš„å½“å‰çš„å€¼ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºæ–°å€¼ï¼šnewValue 3public final int getAndIncrement(int i)//è·å– index=i ä½ç½®å…ƒç´ çš„å€¼ï¼Œå¹¶è®©è¯¥ä½ç½®çš„å…ƒç´ è‡ªå¢ 4public final int getAndDecrement(int i) //è·å– index=i ä½ç½®å…ƒç´ çš„å€¼ï¼Œå¹¶è®©è¯¥ä½ç½®çš„å…ƒç´ è‡ªå‡ 5public final int getAndAdd(int delta) //è·å– index=i ä½ç½®å…ƒç´ çš„å€¼ï¼Œå¹¶åŠ ä¸Šé¢„æœŸçš„å€¼ 6boolean compareAndSet(int expect, int update) //å¦‚æœè¾“å…¥çš„æ•°å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°† index=i ä½ç½®çš„å…ƒç´ å€¼è®¾ç½®ä¸ºè¾“å…¥å€¼ï¼ˆupdateï¼‰ 7public final void lazySet(int i, int newValue)//æœ€ç»ˆ å°†index=i ä½ç½®çš„å…ƒç´ è®¾ç½®ä¸ºnewValue,ä½¿ç”¨ lazySet è®¾ç½®ä¹‹åå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹åœ¨ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…è¿˜æ˜¯å¯ä»¥è¯»åˆ°æ—§çš„å€¼ã€‚ 8â€‹``` 9#### 3.2 AtomicIntegerArray å¸¸è§æ–¹æ³•ä½¿ç”¨ 10 11â€‹```java 12 13import java.util.concurrent.atomic.AtomicIntegerArray; 14 15public class AtomicIntegerArrayTest { 16 17\tpublic static void main(String[] args) { 18\t// TODO Auto-generated method stub 19\tint temvalue = 0; 20\tint[] nums = { 1, 2, 3, 4, 5, 6 }; 21\tAtomicIntegerArray i = new AtomicIntegerArray(nums); 22\tfor (int j = 0; j \u0026lt; nums.length; j++) { 23\tSystem.out.println(i.get(j)); 24\t} 25\ttemvalue = i.getAndSet(0, 2); 26\tSystem.out.println(\u0026#34;temvalue:\u0026#34; + temvalue + \u0026#34;; i:\u0026#34; + i); 27\ttemvalue = i.getAndIncrement(0); 28\tSystem.out.println(\u0026#34;temvalue:\u0026#34; + temvalue + \u0026#34;; i:\u0026#34; + i); 29\ttemvalue = i.getAndAdd(0, 5); 30\tSystem.out.println(\u0026#34;temvalue:\u0026#34; + temvalue + \u0026#34;; i:\u0026#34; + i); 31\t} 32 33} 34â€‹``` 35 36### 4 å¼•ç”¨ç±»å‹åŸå­ç±» 37 38#### 4.1 å¼•ç”¨ç±»å‹åŸå­ç±»ä»‹ç» 39 40åŸºæœ¬ç±»å‹åŸå­ç±»åªèƒ½æ›´æ–°ä¸€ä¸ªå˜é‡ï¼Œå¦‚æœéœ€è¦åŸå­æ›´æ–°å¤šä¸ªå˜é‡ï¼Œéœ€è¦ä½¿ç”¨ å¼•ç”¨ç±»å‹åŸå­ç±»ã€‚ 41 42- AtomicReferenceï¼šå¼•ç”¨ç±»å‹åŸå­ç±» 43- AtomicStampedReferenceï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µåŸå­ç±» 44- AtomicMarkableReference ï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°ä½çš„å¼•ç”¨ç±»å‹ 45 46ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥ AtomicReference ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚ 47 48#### 4.2 AtomicReference ç±»ä½¿ç”¨ç¤ºä¾‹ 49 50â€‹```java 51import java.util.concurrent.atomic.AtomicReference; 52 53public class AtomicReferenceTest { 54 55\tpublic static void main(String[] args) { 56\tAtomicReference\u0026lt;Person\u0026gt; ar = new AtomicReference\u0026lt;Person\u0026gt;(); 57\tPerson person = new Person(\u0026#34;SnailClimb\u0026#34;, 22); 58\tar.set(person); 59\tPerson updatePerson = new Person(\u0026#34;Daisy\u0026#34;, 20); 60\tar.compareAndSet(person, updatePerson); 61\t62\tSystem.out.println(ar.get().getName()); 63\tSystem.out.println(ar.get().getAge()); 64\t} 65} 66 67class Person { 68\tprivate String name; 69\tprivate int age; 70 71\tpublic Person(String name, int age) { 72\tsuper(); 73\tthis.name = name; 74\tthis.age = age; 75\t} 76\t77\tpublic String getName() { 78\treturn name; 79\t} 80\t81\tpublic void setName(String name) { 82\tthis.name = name; 83\t} 84\t85\tpublic int getAge() { 86\treturn age; 87\t} 88\t89\tpublic void setAge(int age) { 90\tthis.age = age; 91\t} 92 93} 94â€‹``` 95ä¸Šè¿°ä»£ç é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª Person å¯¹è±¡ï¼Œç„¶åæŠŠ Person å¯¹è±¡è®¾ç½®è¿› AtomicReference å¯¹è±¡ä¸­ï¼Œç„¶åè°ƒç”¨ compareAndSet æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°±æ˜¯é€šè¿‡é€šè¿‡ CAS æ“ä½œè®¾ç½® arã€‚å¦‚æœ ar çš„å€¼ä¸º person çš„è¯ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸º updatePersonã€‚å®ç°åŸç†ä¸ AtomicInteger ç±»ä¸­çš„ compareAndSet æ–¹æ³•ç›¸åŒã€‚è¿è¡Œä¸Šé¢çš„ä»£ç åçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š Daisy 20 â€‹```\n4.3 AtomicStampedReference ç±»ä½¿ç”¨ç¤ºä¾‹ 1import java.util.concurrent.atomic.AtomicStampedReference; 2 3public class AtomicStampedReferenceDemo { 4 public static void main(String[] args) { 5 // å®ä¾‹åŒ–ã€å–å½“å‰å€¼å’Œ stamp å€¼ 6 final Integer initialRef = 0, initialStamp = 0; 7 final AtomicStampedReference\u0026lt;Integer\u0026gt; asr = new AtomicStampedReference\u0026lt;\u0026gt;(initialRef, initialStamp); 8 System.out.println(\u0026#34;currentValue=\u0026#34; + asr.getReference() + \u0026#34;, currentStamp=\u0026#34; + asr.getStamp()); 9 10 // compare and set 11 final Integer newReference = 666, newStamp = 999; 12 final boolean casResult = asr.compareAndSet(initialRef, newReference, initialStamp, newStamp); 13 System.out.println(\u0026#34;currentValue=\u0026#34; + asr.getReference() 14 + \u0026#34;, currentStamp=\u0026#34; + asr.getStamp() 15 + \u0026#34;, casResult=\u0026#34; + casResult); 16 17 // è·å–å½“å‰çš„å€¼å’Œå½“å‰çš„ stamp å€¼ 18 int[] arr = new int[1]; 19 final Integer currentValue = asr.get(arr); 20 final int currentStamp = arr[0]; 21 System.out.println(\u0026#34;currentValue=\u0026#34; + currentValue + \u0026#34;, currentStamp=\u0026#34; + currentStamp); 22 23 // å•ç‹¬è®¾ç½® stamp å€¼ 24 final boolean attemptStampResult = asr.attemptStamp(newReference, 88); 25 System.out.println(\u0026#34;currentValue=\u0026#34; + asr.getReference() 26 + \u0026#34;, currentStamp=\u0026#34; + asr.getStamp() 27 + \u0026#34;, attemptStampResult=\u0026#34; + attemptStampResult); 28 29 // é‡æ–°è®¾ç½®å½“å‰å€¼å’Œ stamp å€¼ 30 asr.set(initialRef, initialStamp); 31 System.out.println(\u0026#34;currentValue=\u0026#34; + asr.getReference() + \u0026#34;, currentStamp=\u0026#34; + asr.getStamp()); 32 33 // [ä¸æ¨èä½¿ç”¨ï¼Œé™¤éææ¸…æ¥šæ³¨é‡Šçš„æ„æ€äº†] weak compare and set 34 // å›°æƒ‘ï¼weakCompareAndSet è¿™ä¸ªæ–¹æ³•æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨ compareAndSet æ–¹æ³•ã€‚[ç‰ˆæœ¬: jdk-8u191] 35 // ä½†æ˜¯æ³¨é‡Šä¸Šå†™ç€ \u0026#34;May fail spuriously and does not provide ordering guarantees, 36 // so is only rarely an appropriate alternative to compareAndSet.\u0026#34; 37 // todo æ„Ÿè§‰æœ‰å¯èƒ½æ˜¯ jvm é€šè¿‡æ–¹æ³•ååœ¨ native æ–¹æ³•é‡Œé¢åšäº†è½¬å‘ 38 final boolean wCasResult = asr.weakCompareAndSet(initialRef, newReference, initialStamp, newStamp); 39 System.out.println(\u0026#34;currentValue=\u0026#34; + asr.getReference() 40 + \u0026#34;, currentStamp=\u0026#34; + asr.getStamp() 41 + \u0026#34;, wCasResult=\u0026#34; + wCasResult); 42 } 43} 44â€‹``` 45 46è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 47â€‹``` 48currentValue=0, currentStamp=0 49currentValue=666, currentStamp=999, casResult=true 50currentValue=666, currentStamp=999 51currentValue=666, currentStamp=88, attemptStampResult=true 52currentValue=0, currentStamp=0 53currentValue=666, currentStamp=999, wCasResult=true 54â€‹``` 55 56#### 4.4 AtomicMarkableReference ç±»ä½¿ç”¨ç¤ºä¾‹ 57 58â€‹``` java 59import java.util.concurrent.atomic.AtomicMarkableReference; 60 61public class AtomicMarkableReferenceDemo { 62 public static void main(String[] args) { 63 // å®ä¾‹åŒ–ã€å–å½“å‰å€¼å’Œ mark å€¼ 64 final Boolean initialRef = null, initialMark = false; 65 final AtomicMarkableReference\u0026lt;Boolean\u0026gt; amr = new AtomicMarkableReference\u0026lt;\u0026gt;(initialRef, initialMark); 66 System.out.println(\u0026#34;currentValue=\u0026#34; + amr.getReference() + \u0026#34;, currentMark=\u0026#34; + amr.isMarked()); 67 68 // compare and set 69 final Boolean newReference1 = true, newMark1 = true; 70 final boolean casResult = amr.compareAndSet(initialRef, newReference1, initialMark, newMark1); 71 System.out.println(\u0026#34;currentValue=\u0026#34; + amr.getReference() 72 + \u0026#34;, currentMark=\u0026#34; + amr.isMarked() 73 + \u0026#34;, casResult=\u0026#34; + casResult); 74 75 // è·å–å½“å‰çš„å€¼å’Œå½“å‰çš„ mark å€¼ 76 boolean[] arr = new boolean[1]; 77 final Boolean currentValue = amr.get(arr); 78 final boolean currentMark = arr[0]; 79 System.out.println(\u0026#34;currentValue=\u0026#34; + currentValue + \u0026#34;, currentMark=\u0026#34; + currentMark); 80 81 // å•ç‹¬è®¾ç½® mark å€¼ 82 final boolean attemptMarkResult = amr.attemptMark(newReference1, false); 83 System.out.println(\u0026#34;currentValue=\u0026#34; + amr.getReference() 84 + \u0026#34;, currentMark=\u0026#34; + amr.isMarked() 85 + \u0026#34;, attemptMarkResult=\u0026#34; + attemptMarkResult); 86 87 // é‡æ–°è®¾ç½®å½“å‰å€¼å’Œ mark å€¼ 88 amr.set(initialRef, initialMark); 89 System.out.println(\u0026#34;currentValue=\u0026#34; + amr.getReference() + \u0026#34;, currentMark=\u0026#34; + amr.isMarked()); 90 91 // [ä¸æ¨èä½¿ç”¨ï¼Œé™¤éææ¸…æ¥šæ³¨é‡Šçš„æ„æ€äº†] weak compare and set 92 // å›°æƒ‘ï¼weakCompareAndSet è¿™ä¸ªæ–¹æ³•æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨ compareAndSet æ–¹æ³•ã€‚[ç‰ˆæœ¬: jdk-8u191] 93 // ä½†æ˜¯æ³¨é‡Šä¸Šå†™ç€ \u0026#34;May fail spuriously and does not provide ordering guarantees, 94 // so is only rarely an appropriate alternative to compareAndSet.\u0026#34; 95 // todo æ„Ÿè§‰æœ‰å¯èƒ½æ˜¯ jvm é€šè¿‡æ–¹æ³•ååœ¨ native æ–¹æ³•é‡Œé¢åšäº†è½¬å‘ 96 final boolean wCasResult = amr.weakCompareAndSet(initialRef, newReference1, initialMark, newMark1); 97 System.out.println(\u0026#34;currentValue=\u0026#34; + amr.getReference() 98 + \u0026#34;, currentMark=\u0026#34; + amr.isMarked() 99 + \u0026#34;, wCasResult=\u0026#34; + wCasResult); 100 } 101} 102â€‹``` 103 104è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 105â€‹``` 106currentValue=null, currentMark=false 107currentValue=true, currentMark=true, casResult=true 108currentValue=true, currentMark=true 109currentValue=true, currentMark=false, attemptMarkResult=true 110currentValue=null, currentMark=false 111currentValue=true, currentMark=true, wCasResult=true 112â€‹``` 113 114### 5 å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±» 115 116#### 5.1 å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»ä»‹ç» 117 118å¦‚æœéœ€è¦åŸå­æ›´æ–°æŸä¸ªç±»é‡Œçš„æŸä¸ªå­—æ®µæ—¶ï¼Œéœ€è¦ç”¨åˆ°å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»ã€‚ 119 120- AtomicIntegerFieldUpdater:åŸå­æ›´æ–°æ•´å½¢å­—æ®µçš„æ›´æ–°å™¨ 121- AtomicLongFieldUpdaterï¼šåŸå­æ›´æ–°é•¿æ•´å½¢å­—æ®µçš„æ›´æ–°å™¨ 122- AtomicStampedReference ï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†æ•´æ•°å€¼ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œå¯ç”¨äºè§£å†³åŸå­çš„æ›´æ–°æ•°æ®å’Œæ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚ 123 124è¦æƒ³åŸå­åœ°æ›´æ–°å¯¹è±¡çš„å±æ€§éœ€è¦ä¸¤æ­¥ã€‚ç¬¬ä¸€æ­¥ï¼Œå› ä¸ºå¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»éƒ½æ˜¯æŠ½è±¡ç±»ï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨éƒ½å¿…é¡»ä½¿ç”¨é™æ€æ–¹æ³• newUpdater()åˆ›å»ºä¸€ä¸ªæ›´æ–°å™¨ï¼Œå¹¶ä¸”éœ€è¦è®¾ç½®æƒ³è¦æ›´æ–°çš„ç±»å’Œå±æ€§ã€‚ç¬¬äºŒæ­¥ï¼Œæ›´æ–°çš„å¯¹è±¡å±æ€§å¿…é¡»ä½¿ç”¨ public volatile ä¿®é¥°ç¬¦ã€‚ 125 126ä¸Šé¢ä¸‰ä¸ªç±»æä¾›çš„æ–¹æ³•å‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä»¥ `AtomicIntegerFieldUpdater`ä¸ºä¾‹å­æ¥ä»‹ç»ã€‚ 127 128#### 5.2 AtomicIntegerFieldUpdater ç±»ä½¿ç”¨ç¤ºä¾‹ 129 130â€‹```java 131import java.util.concurrent.atomic.AtomicIntegerFieldUpdater; 132 133public class AtomicIntegerFieldUpdaterTest { 134\tpublic static void main(String[] args) { 135\tAtomicIntegerFieldUpdater\u0026lt;User\u0026gt; a = AtomicIntegerFieldUpdater.newUpdater(User.class, \u0026#34;age\u0026#34;); 136 137\tUser user = new User(\u0026#34;Java\u0026#34;, 22); 138\tSystem.out.println(a.getAndIncrement(user));// 22 139\tSystem.out.println(a.get(user));// 23 140\t} 141} 142 143class User { 144\tprivate String name; 145\tpublic volatile int age; 146 147\tpublic User(String name, int age) { 148\tsuper(); 149\tthis.name = name; 150\tthis.age = age; 151\t} 152\t153\tpublic String getName() { 154\treturn name; 155\t} 156\t157\tpublic void setName(String name) { 158\tthis.name = name; 159\t} 160\t161\tpublic int getAge() { 162\treturn age; 163\t} 164\t165\tpublic void setAge(int age) { 166\tthis.age = age; 167\t} 168 169} 170â€‹``` 171 172è¾“å‡ºç»“æœï¼š 22 23 â€‹```\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/JavaNote/Automic-%E5%8E%9F%E5%AD%90%E7%B1%BB/","summary":"Automic åŸå­ç±» 1 Atomic åŸå­ç±»ä»‹ç» Atomic æ˜¯æŒ‡ä¸€ä¸ªæ“ä½œæ˜¯ä¸å¯ä¸­æ–­çš„ã€‚å³ä½¿æ˜¯åœ¨å¤šä¸ªçº¿ç¨‹ä¸€èµ·æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€ä¸ªæ“ä½œä¸€æ—¦å¼€å§‹ï¼Œå°±ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹å¹²æ‰°ã€‚\næ‰€ä»¥ï¼Œæ‰€è°“åŸå­ç±»è¯´ç®€å•ç‚¹å°±æ˜¯å…·æœ‰åŸå­/åŸå­æ“ä½œç‰¹å¾çš„ç±»ã€‚\nå¹¶å‘åŒ… java.util.concurrent çš„åŸå­ç±»éƒ½å­˜æ”¾åœ¨java.util.concurrent.atomicä¸‹,å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\næ ¹æ®æ“ä½œçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°†JUCåŒ…ä¸­çš„åŸå­ç±»åˆ†ä¸º4ç±»\nåŸºæœ¬ç±»å‹\nä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹\nAtomicIntegerï¼šæ•´å‹åŸå­ç±» AtomicLongï¼šé•¿æ•´å‹åŸå­ç±» AtomicBoolean ï¼šå¸ƒå°”å‹åŸå­ç±» æ•°ç»„ç±»å‹\nä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´ \nAtomicIntegerArrayï¼šæ•´å‹æ•°ç»„åŸå­ç±» AtomicLongArrayï¼šé•¿æ•´å‹æ•°ç»„åŸå­ç±» AtomicReferenceArray ï¼šå¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±» å¼•ç”¨ç±»å‹\nAtomicReferenceï¼šå¼•ç”¨ç±»å‹åŸå­ç±» AtomicReferenceFieldUpdaterï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µ AtomicMarkableReference ï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°ä½çš„å¼•ç”¨ç±»å‹ å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹\nAtomicIntegerFieldUpdater:åŸå­æ›´æ–°æ•´å‹å­—æ®µçš„æ›´æ–°å™¨ AtomicLongFieldUpdaterï¼šåŸå­æ›´æ–°é•¿æ•´å‹å­—æ®µçš„æ›´æ–°å™¨ AtomicStampedReference ï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†æ•´æ•°å€¼ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œå¯ç”¨äºè§£å†³åŸå­çš„æ›´æ–°æ•°æ®å’Œæ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚ AtomicMarkableReferenceï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°† boolean æ ‡è®°ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œä¹Ÿå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚ CAS ABA é—®é¢˜\næè¿°: ç¬¬ä¸€ä¸ªçº¿ç¨‹å–åˆ°äº†å˜é‡ x çš„å€¼ Aï¼Œç„¶åå·´æ‹‰å·´æ‹‰å¹²åˆ«çš„äº‹ï¼Œæ€»ä¹‹å°±æ˜¯åªæ‹¿åˆ°äº†å˜é‡ x çš„å€¼ Aã€‚è¿™æ®µæ—¶é—´å†…ç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿå–åˆ°äº†å˜é‡ x çš„å€¼ Aï¼Œç„¶åæŠŠå˜é‡ x çš„å€¼æ”¹ä¸º Bï¼Œç„¶åå·´æ‹‰å·´æ‹‰å¹²åˆ«çš„äº‹ï¼Œæœ€ååˆæŠŠå˜é‡ x çš„å€¼å˜ä¸º A ï¼ˆç›¸å½“äºè¿˜åŸäº†ï¼‰ã€‚åœ¨è¿™ä¹‹åç¬¬ä¸€ä¸ªçº¿ç¨‹ç»ˆäºè¿›è¡Œäº†å˜é‡ x çš„æ“ä½œï¼Œä½†æ˜¯æ­¤æ—¶å˜é‡ x çš„å€¼è¿˜æ˜¯ Aï¼Œæ‰€ä»¥ compareAndSet æ“ä½œæ˜¯æˆåŠŸã€‚ ä¾‹å­æè¿°(å¯èƒ½ä¸å¤ªåˆé€‚ï¼Œä½†å¥½ç†è§£): å¹´åˆï¼Œç°é‡‘ä¸ºé›¶ï¼Œç„¶åé€šè¿‡æ­£å¸¸åŠ³åŠ¨èµšäº†ä¸‰ç™¾ä¸‡ï¼Œä¹‹åæ­£å¸¸æ¶ˆè´¹äº†ï¼ˆæ¯”å¦‚ä¹°æˆ¿å­ï¼‰ä¸‰ç™¾ä¸‡ã€‚å¹´æœ«ï¼Œè™½ç„¶ç°é‡‘é›¶æ”¶å…¥ï¼ˆå¯èƒ½å˜æˆå…¶ä»–å½¢å¼äº†ï¼‰ï¼Œä½†æ˜¯èµšäº†é’±æ˜¯äº‹å®ï¼Œè¿˜æ˜¯å¾—äº¤ç¨çš„ï¼ ä»£ç ä¾‹å­ï¼ˆä»¥AtomicIntegerä¸ºä¾‹ï¼‰ 1import java.","tags":null,"title":"ã€ŒJavaã€"},{"categories":null,"contents":"è‡ªåŠ¨è¡¥é½json Format é€šè¿‡SFTPåŒæ­¥æœ¬åœ°ä¸è¿œç«¯ä»£ç  Preference\u0026gt;Build,Execution,Deployment\u0026gt;SFTP\nGo è¿œç¨‹Debug https://github.com/derekparker/delve\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/goland/","summary":"è‡ªåŠ¨è¡¥é½json Format é€šè¿‡SFTPåŒæ­¥æœ¬åœ°ä¸è¿œç«¯ä»£ç  Preference\u0026gt;Build,Execution,Deployment\u0026gt;SFTP\nGo è¿œç¨‹Debug https://github.com/derekparker/delve","tags":null,"title":"ã€ŒJetBrainsã€ GoLandæŠ€å·§"},{"categories":null,"contents":"ç¯å¢ƒå‡†å¤‡ K8s åªèƒ½åŸºäºLinuxç¯å¢ƒéƒ¨ç½²ï¼Œç”¨Win/Macçš„å°ä¼™ä¼´ä»¬æ€ä¹ˆåœ¨è‡ªå·±çš„PCä¸ŠSetupç¯å¢ƒå‘¢ã€‚æ­¤æ—¶å°±æ¨èCanonicalå®¶çš„Multipassäº†ï¼ŒCanonical æ˜¯è°ï¼Œå½“ç„¶æ˜¯Ubuntuçš„æ¯å…¬å¸äº†ã€‚\nå®‰è£… kubelet kubeadm kubectl å®˜æ–¹æ–‡æ¡£\n1sudo apt-get update \u0026amp;\u0026amp; sudo apt-get install -y apt-transport-https curl 2curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add - 3cat \u0026lt;\u0026lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list 4deb https://apt.kubernetes.io/ kubernetes-xenial main 5EOF 6sudo apt-get update 7sudo apt-get install -y kubelet kubeadm kubectl 8sudo apt-mark hold kubelet kubeadm kubectl # è®¾ç½®ä¸ºä¸å†æ›´æ–° åˆå§‹åŒ– 1swapoff -a 2kubeadm init ctl 3# kubeadm config images pull --v=10 4 # å›½å†…æ­£å¸¸ç½‘ç»œä¸èƒ½ä»k8s.grc.ioæ‹‰å–é•œåƒ, æ‰€ä»¥ä»docker.ioæ‹‰å–, ç„¶åé‡æ–°æ‰“ä¸Šä¸€ä¸ªç¬¦åˆk8sçš„tag: 5docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-apiserver:v1.20.1 6docker tag registry.cn-hangzhou.aliyuncs.com/google_containers/kube-apiserver:v1.20.1 k8s.gcr.io/kube-apiserver:v1.20.1 7 8docker pull mirrorgooglecontainers/kube-apiserver:v1.12.2 9docker pull mirrorgooglecontainers/kube-controller-manager:v1.12.2 10docker pull mirrorgooglecontainers/kube-scheduler:v1.12.2 11docker pull mirrorgooglecontainers/kube-proxy:v1.12.2 12docker pull mirrorgooglecontainers/pause:3.1 13docker pull mirrorgooglecontainers/etcd:3.2.24 14docker pull coredns/coredns:1.2.2 15 16docker tag docker.io/mirrorgooglecontainers/kube-apiserver:v1.12.2 k8s.gcr.io/kube-apiserver:v1.12.2 17docker tag docker.io/mirrorgooglecontainers/kube-controller-manager:v1.12.2 k8s.gcr.io/kube-controller-manager:v1.12.2 18docker tag docker.io/mirrorgooglecontainers/kube-scheduler:v1.12.2 k8s.gcr.io/kube-scheduler:v1.12.2 19docker tag docker.io/mirrorgooglecontainers/kube-proxy:v1.12.2 k8s.gcr.io/kube-proxy:v1.12.2 20docker tag docker.io/mirrorgooglecontainers/pause:3.1 k8s.gcr.io/pause:3.1 21docker tag docker.io/mirrorgooglecontainers/etcd:3.2.24 k8s.gcr.io/etcd:3.2.24 22docker tag docker.io/coredns/coredns:1.2.2 k8s.gcr.io/coredns:1.2.2 23 24docker rmi mirrorgooglecontainers/kube-apiserver:v1.12.2 25docker rmi mirrorgooglecontainers/kube-controller-manager:v1.12.2 26docker rmi mirrorgooglecontainers/kube-scheduler:v1.12.2 27docker rmi mirrorgooglecontainers/kube-proxy:v1.12.2 28docker rmi mirrorgooglecontainers/pause:3.1 29docker rmi mirrorgooglecontainers/etcd:3.2.24 30docker rmi coredns/coredns:1.2.2 å®‰è£…æˆåŠŸ\n1Your Kubernetes control-plane has initialized successfully! 2 3To start using your cluster, you need to run the following as a regular user: 4 5 mkdir -p $HOME/.kube 6 sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config 7 sudo chown $(id -u):$(id -g) $HOME/.kube/config 8 9Alternatively, if you are the root user, you can run: 10 11 export KUBECONFIG=/etc/kubernetes/admin.conf 12 13You should now deploy a pod network to the cluster. 14Run \u0026#34;kubectl apply -f [podnetwork].yaml\u0026#34; with one of the options listed at: 15 https://kubernetes.io/docs/concepts/cluster-administration/addons/ 16 17Then you can join any number of worker nodes by running the following on each as root: 18 19kubeadm join 10.227.4.115:6443 --token 3hf7uz.3stfkg430pppne10 \\ 20 --discovery-token-ca-cert-hash sha256:14d0a3cd33e86dc80081d806499a95366c4f0bdfd83d364c1e6576864684d3d7 å®‰è£…ç½‘ç»œç»„ä»¶ 1# sysctl net.bridge.bridge-nf-call-iptables=1 2# https://kubernetes.io/docs/concepts/cluster-administration/addons/ 3kubectl apply -f \u0026#34;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d \u0026#39;\\n\u0026#39;)\u0026#34; æ£€æŸ¥é›†ç¾¤çŠ¶æ€ 1kubectl get nodes 2kubectl get pod --all-namespaces -o wide 3kubectl get pod --all-namespaces 4kubectl get pods -n kube-system # æŒ‡å®šå‘½åç©ºé—´ å‚è€ƒæ–‡æ¡£ æ¦‚å¿µ\nhttp://www.dockone.io/article/932\nhttps://www.zhihu.com/question/37498459/answer/826736487\nå®‰è£…æ–‡æ¡£\nhttps://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/\nhttps://www.hangge.com/blog/cache/detail_2414.html\nhttps://zhuanlan.zhihu.com/p/46341911\ninit ubuntu as a k8s node\n1sudo su 2apt update \u0026amp;\u0026amp; apt -y upgrade 3apt install -y apt-transport-https curl net-tools 4curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg 5echo \u0026#34;deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-xenial main\u0026#34; | sudo tee /etc/apt/sources.list.d/kubernetes.list 6apt update 7apt install -y kubelet kubeadm kubectl docker.io How completely uninstall kubernetes 1#!/bin/sh 2# Kube Admin Reset 3kubeadm reset 4 5# Remove all packages related to Kubernetes 6apt remove -y kubeadm kubectl kubelet kubernetes-cni 7apt purge -y kube* 8 9# Remove docker containers/ images ( optional if using docker) 10docker image prune -a 11systemctl restart docker 12apt purge -y docker-engine docker docker.io docker-ce docker-ce-cli containerd containerd.io runc --allow-change-held-packages 13 14# Remove parts 15 16apt autoremove -y 17 18# Remove all folder associated to kubernetes, etcd, and docker 19rm -rf ~/.kube 20rm -rf /etc/cni /etc/kubernetes /var/lib/dockershim /var/lib/etcd /var/lib/kubelet /var/lib/etcd2/ /var/run/kubernetes ~/.kube/* 21rm -rf /var/lib/docker /etc/docker /var/run/docker.sock 22rm -f /etc/apparmor.d/docker /etc/systemd/system/etcd* 23 24# Delete docker group (optional) 25groupdel docker 26 27# Clear the iptables 28iptables -F \u0026amp;\u0026amp; iptables -X 29iptables -t nat -F \u0026amp;\u0026amp; iptables -t nat -X 30iptables -t raw -F \u0026amp;\u0026amp; iptables -t raw -X 31iptables -t mangle -F \u0026amp;\u0026amp; iptables -t mangle -X ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/KubernatesInstall/","summary":"ç¯å¢ƒå‡†å¤‡ K8s åªèƒ½åŸºäºLinuxç¯å¢ƒéƒ¨ç½²ï¼Œç”¨Win/Macçš„å°ä¼™ä¼´ä»¬æ€ä¹ˆåœ¨è‡ªå·±çš„PCä¸ŠSetupç¯å¢ƒå‘¢ã€‚æ­¤æ—¶å°±æ¨èCanonicalå®¶çš„Multipassäº†ï¼ŒCanonical æ˜¯è°ï¼Œå½“ç„¶æ˜¯Ubuntuçš„æ¯å…¬å¸äº†ã€‚\nå®‰è£… kubelet kubeadm kubectl å®˜æ–¹æ–‡æ¡£\n1sudo apt-get update \u0026amp;\u0026amp; sudo apt-get install -y apt-transport-https curl 2curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add - 3cat \u0026lt;\u0026lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list 4deb https://apt.kubernetes.io/ kubernetes-xenial main 5EOF 6sudo apt-get update 7sudo apt-get install -y kubelet kubeadm kubectl 8sudo apt-mark hold kubelet kubeadm kubectl # è®¾ç½®ä¸ºä¸å†æ›´æ–° åˆå§‹åŒ– 1swapoff -a 2kubeadm init ctl 3# kubeadm config images pull --v=10 4 # å›½å†…æ­£å¸¸ç½‘ç»œä¸èƒ½ä»k8s.","tags":null,"title":"ã€ŒK8sã€Kubernates å®‰è£…"},{"categories":null,"contents":"1 1 package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6\tfmt.Println(twoSum([]int{2, 7, 11, 15}, 9)) 7} 8 9func twoSum(nums []int, target int) []int { 10 11\tmaps := make(map[int]int) 12 13\tfor i, value := range nums { 14\tmid := target - value 15 16\tres, ok := maps[mid] 17\tif ok { 18\treturn []int{res, i} 19\t} else { 20\tmaps[value] = i 21\t} 22\t} 23\treturn []int{} 24} 120. ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ ç»™å®šä¸€ä¸ªä¸‰è§’å½¢ triangle ï¼Œæ‰¾å‡ºè‡ªé¡¶å‘ä¸‹çš„æœ€å°è·¯å¾„å’Œã€‚\næ¯ä¸€æ­¥åªèƒ½ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œä¸­ç›¸é‚»çš„ç»“ç‚¹ä¸Šã€‚ç›¸é‚»çš„ç»“ç‚¹ åœ¨è¿™é‡ŒæŒ‡çš„æ˜¯ ä¸‹æ ‡ ä¸ ä¸Šä¸€å±‚ç»“ç‚¹ä¸‹æ ‡ ç›¸åŒæˆ–è€…ç­‰äº ä¸Šä¸€å±‚ç»“ç‚¹ä¸‹æ ‡ + 1 çš„ä¸¤ä¸ªç»“ç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ­£ä½äºå½“å‰è¡Œçš„ä¸‹æ ‡ i ï¼Œé‚£ä¹ˆä¸‹ä¸€æ­¥å¯ä»¥ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œçš„ä¸‹æ ‡ i æˆ– i + 1 ã€‚\nç¤ºä¾‹ 1ï¼š\n1è¾“å…¥ï¼štriangle = [[2],[3,4],[6,5,7],[4,1,8,3]] 2è¾“å‡ºï¼š11 3è§£é‡Šï¼šå¦‚ä¸‹é¢ç®€å›¾æ‰€ç¤ºï¼š 4 2 5 3 4 66 5 7 74 1 8 3 8è‡ªé¡¶å‘ä¸‹çš„æœ€å°è·¯å¾„å’Œä¸º 11ï¼ˆå³ï¼Œ2 + 3 + 5 + 1 = 11ï¼‰ã€‚ ç¤ºä¾‹ 2ï¼š\n1è¾“å…¥ï¼štriangle = [[-10]] 2è¾“å‡ºï¼š-10 æç¤ºï¼š\n11 \u0026lt;= triangle.length \u0026lt;= 200 2triangle[0].length == 1 3triangle[i].length == triangle[i - 1].length + 1 4-104 \u0026lt;= triangle[i][j] \u0026lt;= 104 è¿›é˜¶ï¼š\nä½ å¯ä»¥åªä½¿ç”¨ O(n) çš„é¢å¤–ç©ºé—´ï¼ˆn ä¸ºä¸‰è§’å½¢çš„æ€»è¡Œæ•°ï¼‰æ¥è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ\næ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’ è‡ªåº•å‘ä¸Šé€’æ¨\nçŠ¶æ€å®šä¹‰ï¼š å½“å‰ä½ç½®åˆ°å¶å­èŠ‚ç‚¹çš„æœ€å°å€¼ DP[i.j]\nçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š DP[i,j] = min(DP[i+1,j], DP[i+1,j+1])+Triangle[i,j] â€‹\n1func minimumTotal(triangle [][]int) int { 2 3\t// checkout input value 4\tif len(triangle) == 0 { 5\treturn 0 6\t} 7\tif len(triangle) == 1 { 8\treturn triangle[0][0] 9\t} 10\t// algorithm 11\traw := len(triangle) 12\tstatus := make([][]int, raw+1) 13\tstatus[raw] = make([]int, raw+1) 14\tfor i := raw; i \u0026gt; 0; i-- { 15\tstatus[i-1] = make([]int, i) 16\tfor j := 0; j \u0026lt; i; j++ { 17\tstatus[i-1][j] = getMin(status[i][j], status[i][j+1]) + triangle[i-1][j] 18\t} 19\t} 20\treturn status[0][0] 21} 22 23func getMin(a, b int) int { 24\tif a \u0026gt; b { 25\treturn b 26\t} 27\treturn a 28} 29 30func TestSolution(t *testing.T) { 31\tprintln(minimumTotal([][]int{ 32\t{2}, {3, 4}, {6, 5, 7}, {4, 1, 8, 3}, 33\t})) 34} ä¸Šè¿°è§£æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(mn), ç©ºé—´å¤æ‚åº¦ä¸ºO(mn),nmä¸ºè¡Œåˆ—æ•°\nç©ºé—´å¤æ‚åº¦å¯ä¼˜åŒ–ï¼ŒçŠ¶æ€åªéœ€ä¿å­˜å‰ä¸€è¡Œçš„çŠ¶æ€å³å¯ï¼Œä¼˜åŒ–åä»£ç å¦‚ä¸‹\n1func minimumTotal(triangle [][]int) int { 2\t// algorithm 3\traw := len(triangle) 4\tstatus := make([]int, raw+1) 5\tfor i := raw; i \u0026gt; 0; i-- { 6\tfor j := 0; j \u0026lt; i; j++ { 7\tstatus[j] = getMin(status[j], status[j+1]) + triangle[i-1][j] 8\t} 9\t} 10\treturn status[0] 11} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/LeetCode/","summary":"1 1 package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6\tfmt.Println(twoSum([]int{2, 7, 11, 15}, 9)) 7} 8 9func twoSum(nums []int, target int) []int { 10 11\tmaps := make(map[int]int) 12 13\tfor i, value := range nums { 14\tmid := target - value 15 16\tres, ok := maps[mid] 17\tif ok { 18\treturn []int{res, i} 19\t} else { 20\tmaps[value] = i 21\t} 22\t} 23\treturn []int{} 24} 120.","tags":null,"title":"ã€ŒLeetCodeã€LeetCode"},{"categories":null,"contents":"å®ˆæŠ¤è¿›ç¨‹\nhttp://www.ruanyifeng.com/blog/2016/02/linux-daemon.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/systemd/","summary":"å®ˆæŠ¤è¿›ç¨‹\nhttp://www.ruanyifeng.com/blog/2016/02/linux-daemon.html","tags":null,"title":"ã€ŒLinuxã€Systemd"},{"categories":null,"contents":"\r","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/xorgs/","summary":"\r","tags":null,"title":"ã€ŒLinuxã€xargs"},{"categories":null,"contents":"æ–‡æœ¬å·¥å…· Typora æ•ˆç‡ç›¸å…³ Karabiner å¼€å‘ç›¸å…³ goland Brew go git iterm2 Alfred ohmyzsh vim docker Kitematic .virmrc 1syntax on 2set nu 3inoremap jj \u0026lt;ESC\u0026gt; git\n1git config --global init.defaultBranch main ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/mac_init/","summary":"æ–‡æœ¬å·¥å…· Typora æ•ˆç‡ç›¸å…³ Karabiner å¼€å‘ç›¸å…³ goland Brew go git iterm2 Alfred ohmyzsh vim docker Kitematic .virmrc 1syntax on 2set nu 3inoremap jj \u0026lt;ESC\u0026gt; git\n1git config --global init.defaultBranch main ","tags":null,"title":"ã€ŒMacã€Macåˆå§‹åŒ–"},{"categories":null,"contents":"https://blog.csdn.net/u013594528/article/details/80859443?utm_medium=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase\u0026depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase\nhttps://blog.csdn.net/u013594528/article/details/80859443?utm_medium=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase\u0026depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/web_mvc_pattern/","summary":"https://blog.csdn.net/u013594528/article/details/80859443?utm_medium=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase\u0026depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase\nhttps://blog.csdn.net/u013594528/article/details/80859443?utm_medium=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase\u0026depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase","tags":null,"title":"ã€ŒMVCã€ WebæœåŠ¡çš„MVCè®¾è®¡æ¨¡å¼"},{"categories":null,"contents":"NIO\nepoll linux\nmac\nwindows\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/cs_basic/net_io/","summary":"NIO\nepoll linux\nmac\nwindows","tags":null,"title":"ã€ŒNIOã€ç½‘ç»œIO"},{"categories":null,"contents":"1.æ“ä½œç³»ç»Ÿæ¦‚è¿° ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿï¼Ÿ\næ“ä½œç³»ç»Ÿå°±æ˜¯ç»„ç»‡æ‰€æœ‰çš„ç¡¬ä»¶ï¼Œä¸ºç”¨æˆ·ç¨‹åºæä¾›è°ƒç”¨æ¥å£çš„ä»£ç ã€‚æ˜¯è®¡ç®—æœºç¡¬ä»¶ä¸åº”ç”¨ä¹‹é—´çš„ä¸€å±‚è½¯ä»¶ã€‚å°è£…äº†å¯¹ç¡¬ä»¶è°ƒç”¨çš„å®ç°ï¼Œä»¥åŠè¿›ç¨‹çš„ç®¡ç†ã€‚\nç¡¬ä»¶ç®¡ç†åˆ†ç±»ï¼š\nCPUç®¡ç†ã€å†…å­˜ç®¡ç†ã€ç»ˆç«¯ç®¡ç†ã€ç£ç›˜ç®¡ç†ã€æ–‡ä»¶ç®¡ç†\nç½‘ç»œç®¡ç†ã€ç”µæºç®¡ç†ã€å¤šæ ¸ç®¡ç†\nè®¡ç®—æœºç¡¬ä»¶ç»„æˆå¦‚å›¾\næˆ‘ä»¬å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œæœ€å…ˆå­¦ä¹ çš„å°±æ˜¯æ‰“å°â€œHello Worldâ€ã€‚\nè®¡ç®—æœºæŠŠä»£ç åŠ è½½åˆ°å†…å­˜ï¼Œé€šè¿‡PCIæ€»çº¿å°†æ•°æ®å†™å…¥æ˜¾å­˜åœ°å€ï¼Œå›¾å½¢æ§åˆ¶å™¨å°†æ•°æ®æ˜¾ç¤ºåˆ°é¢æ¿ã€‚\nå¯¹æ“ä½œç³»ç»Ÿçš„å­¦ä¹ éœ€è¦æŒæ¡ä»¥ä¸‹å‡ ç‚¹\nç³»ç»Ÿè°ƒç”¨: ä½¿ç”¨æ˜¾ç¤ºå™¨ printï¼› ä½¿ç”¨CPUï¼šforkï¼› ä½¿ç”¨æ–‡ä»¶ï¼š openã€read\nä¸€æ®µæ–‡å­—æ˜¯å¦‚ä½•å†™åˆ°ç£ç›˜ä¸Šçš„\næˆä¸ºæŒæ¡è®¡ç®—æœºå…³é”®æŠ€æœ¯çš„å·¥ç¨‹å¸ˆï¼Œè€Œä¸æ˜¯ä»…ä»…è°ƒç”¨APIçš„å·¥ç¨‹å¸ˆã€‚\nLab1: æ‰©å±•çº¿ç¨‹ å®ç°çº¿ç¨‹è°ƒåº¦ Lab2: å®ç°ç³»ç»Ÿè°ƒç”¨ å°†æ•´ä¸ªæ¥å£å‰¥æ‰ï¼Œæ·»åŠ  Lab3: å®ç°è™šå­˜ç®¡ç† æ‰©å±•å®ç°å†…å­˜ç®¡ç† Lab4: æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ æ‰©å±•å®ç°ä¸€ä¸ªæ–‡ä»¶ç®¡ç† çŸ¥åè®¡ç®—æœºé«˜æ ¡\nCMU Carnegie Mellon University: å¡å†…åŸºÂ·æ¢…éš†å¤§å­¦\nMIT Massachusetts Institute of Technologyï¼š éº»çœç†å·¥å­¦é™¢\nLeland Stanford Junior University æ–¯å¦ç¦å¤§å­¦\n\u0026ldquo;Learn OS concepts by coding them!!!\u0026rdquo;\n2. æ“ä½œç³»ç»Ÿå¼•å¯¼ ä»æ‰“å¼€ç”µæºå¼€å§‹ï¼Œæ“ä½œç³»ç»Ÿåšäº†ä»€ä¹ˆï¼Ÿ\nè®¡ç®—æœºæ€ä¹ˆå·¥ä½œçš„\nä¸è¦æ€»ç­‰ç€åˆ«äººå‘Šè¯‰ä½ ç­”æ¡ˆï¼Œå°½é‡è‡ªå·±å»å¯»æ‰¾\nä»çŸ¥è¯†å’Œå¸¸è¯†å‡ºå‘è¿›è¡Œæ¨ç†ï¼Œæ€ç´¢\nå›¾çµæœº-\u0026gt; é€šç”¨å›¾çµæœº\nå‰ç¼€è¡¨è¾¾å¼\nåç¼€è¡¨è¾¾å¼\nè‡ªåŠ¨æœº\nPC program counter\nå–æŒ‡æ‰§è¡Œ\nã€\nBIOSï¼š Basic Input Output System\nCS æ®µå¯„å­˜å™¨\ncs \u0026laquo; 4 +IP\nä¸€ä¸ªæ‰‡åŒº512Byte\n0 ç£é“0æ‰‡åŒº å¼•å¯¼æ‰‡åŒº\nc ç¼–è¯‘åint i æ— æ³•ç¡®å®šå†…å­˜åœ°å€\næ®µå¯„å­˜å™¨ï¼Œæ®µå†…åç§»\nå®å®šä¹‰\nBochsis a highly portable open source IA-32 (x86) PC emulator written in C++, that runs on most popular platforms. It includes emulation of the Intel x86 CPU, common I/O devices, and a custom BIOS. Bochs can be compiled to emulate many different x86 CPUs, from early 386 to the most recent x86-64 Intel and AMD processors which may even not reached the market yet.\nThe GNU Compiler Collection includes front ends for C, C++, Objective-C, Fortran, Ada, Go, and D, as well as libraries for these languages (libstdc++,\u0026hellip;). GCC was originally written as the compiler for the GNU operating system. The GNU system was developed to be 100% free software, free in the sense that it respects the user\u0026rsquo;s freedom.\nGDB, the GNU Project debugger, allows you to see what is going on `inside\u0026rsquo; another program while it executes \u0026ndash; or what another program was doing at the moment it crashed.\nCMU\næ–¯å¦ç¦\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/os/base_of_os/","summary":"1.æ“ä½œç³»ç»Ÿæ¦‚è¿° ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿï¼Ÿ\næ“ä½œç³»ç»Ÿå°±æ˜¯ç»„ç»‡æ‰€æœ‰çš„ç¡¬ä»¶ï¼Œä¸ºç”¨æˆ·ç¨‹åºæä¾›è°ƒç”¨æ¥å£çš„ä»£ç ã€‚æ˜¯è®¡ç®—æœºç¡¬ä»¶ä¸åº”ç”¨ä¹‹é—´çš„ä¸€å±‚è½¯ä»¶ã€‚å°è£…äº†å¯¹ç¡¬ä»¶è°ƒç”¨çš„å®ç°ï¼Œä»¥åŠè¿›ç¨‹çš„ç®¡ç†ã€‚\nç¡¬ä»¶ç®¡ç†åˆ†ç±»ï¼š\nCPUç®¡ç†ã€å†…å­˜ç®¡ç†ã€ç»ˆç«¯ç®¡ç†ã€ç£ç›˜ç®¡ç†ã€æ–‡ä»¶ç®¡ç†\nç½‘ç»œç®¡ç†ã€ç”µæºç®¡ç†ã€å¤šæ ¸ç®¡ç†\nè®¡ç®—æœºç¡¬ä»¶ç»„æˆå¦‚å›¾\næˆ‘ä»¬å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œæœ€å…ˆå­¦ä¹ çš„å°±æ˜¯æ‰“å°â€œHello Worldâ€ã€‚\nè®¡ç®—æœºæŠŠä»£ç åŠ è½½åˆ°å†…å­˜ï¼Œé€šè¿‡PCIæ€»çº¿å°†æ•°æ®å†™å…¥æ˜¾å­˜åœ°å€ï¼Œå›¾å½¢æ§åˆ¶å™¨å°†æ•°æ®æ˜¾ç¤ºåˆ°é¢æ¿ã€‚\nå¯¹æ“ä½œç³»ç»Ÿçš„å­¦ä¹ éœ€è¦æŒæ¡ä»¥ä¸‹å‡ ç‚¹\nç³»ç»Ÿè°ƒç”¨: ä½¿ç”¨æ˜¾ç¤ºå™¨ printï¼› ä½¿ç”¨CPUï¼šforkï¼› ä½¿ç”¨æ–‡ä»¶ï¼š openã€read\nä¸€æ®µæ–‡å­—æ˜¯å¦‚ä½•å†™åˆ°ç£ç›˜ä¸Šçš„\næˆä¸ºæŒæ¡è®¡ç®—æœºå…³é”®æŠ€æœ¯çš„å·¥ç¨‹å¸ˆï¼Œè€Œä¸æ˜¯ä»…ä»…è°ƒç”¨APIçš„å·¥ç¨‹å¸ˆã€‚\nLab1: æ‰©å±•çº¿ç¨‹ å®ç°çº¿ç¨‹è°ƒåº¦ Lab2: å®ç°ç³»ç»Ÿè°ƒç”¨ å°†æ•´ä¸ªæ¥å£å‰¥æ‰ï¼Œæ·»åŠ  Lab3: å®ç°è™šå­˜ç®¡ç† æ‰©å±•å®ç°å†…å­˜ç®¡ç† Lab4: æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ æ‰©å±•å®ç°ä¸€ä¸ªæ–‡ä»¶ç®¡ç† çŸ¥åè®¡ç®—æœºé«˜æ ¡\nCMU Carnegie Mellon University: å¡å†…åŸºÂ·æ¢…éš†å¤§å­¦\nMIT Massachusetts Institute of Technologyï¼š éº»çœç†å·¥å­¦é™¢\nLeland Stanford Junior University æ–¯å¦ç¦å¤§å­¦\n\u0026ldquo;Learn OS concepts by coding them!!!\u0026rdquo;\n2. æ“ä½œç³»ç»Ÿå¼•å¯¼ ä»æ‰“å¼€ç”µæºå¼€å§‹ï¼Œæ“ä½œç³»ç»Ÿåšäº†ä»€ä¹ˆï¼Ÿ\nè®¡ç®—æœºæ€ä¹ˆå·¥ä½œçš„\nä¸è¦æ€»ç­‰ç€åˆ«äººå‘Šè¯‰ä½ ç­”æ¡ˆï¼Œå°½é‡è‡ªå·±å»å¯»æ‰¾\nä»çŸ¥è¯†å’Œå¸¸è¯†å‡ºå‘è¿›è¡Œæ¨ç†ï¼Œæ€ç´¢\nå›¾çµæœº-\u0026gt; é€šç”¨å›¾çµæœº\nå‰ç¼€è¡¨è¾¾å¼\nåç¼€è¡¨è¾¾å¼\nè‡ªåŠ¨æœº\nPC program counter\nå–æŒ‡æ‰§è¡Œ\nã€","tags":null,"title":"ã€ŒOSã€æ“ä½œç³»ç»Ÿä¹‹åŸºç¡€"},{"categories":null,"contents":"æ­£åˆ™è¡¨è¾¾å¼ä¸»è¦ç”¨æ¥è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…æ“ä½œ\n1^[0-9]+abc$ 2# ^ è¡¨ç¤ºä»¥xxxå¼€å¤´çš„å­—ç¬¦ä¸² 3# [0-9] è¡¨ç¤ºåŒ¹é…0-9ä¹‹é—´çš„ä¸€ä¸ªæ•°å­—ï¼Œä¾‹å¦‚ 8ï¼› [0-9]+è¡¨ç¤ºåŒ¹é…0-9ä¹‹é—´çš„å¤šä¸ªæ•°å­—ï¼Œä¾‹å¦‚ï¼š867 4# abc$ è¡¨ç¤ºä»¥abcç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œ$è¡¨ç¤ºä»¥xxxç»“å°¾ 1^[a-z0-9_-]{5,16}$ 2# åªèƒ½å«æœ‰å°å†™å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿,å‡å·ï¼Œä¸”é•¿åº¦ä¸º5-16çš„å­—ç¬¦ä¸² å­—ç¬¦ Description . é™¤äº†\\r \\nä»¥å¤–çš„ä»»ä½•å•å­—ç¬¦ \\w åŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº[A-Za-Z0-9_] * åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–è€…å¤šæ¬¡ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/regex/","summary":"æ­£åˆ™è¡¨è¾¾å¼ä¸»è¦ç”¨æ¥è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…æ“ä½œ\n1^[0-9]+abc$ 2# ^ è¡¨ç¤ºä»¥xxxå¼€å¤´çš„å­—ç¬¦ä¸² 3# [0-9] è¡¨ç¤ºåŒ¹é…0-9ä¹‹é—´çš„ä¸€ä¸ªæ•°å­—ï¼Œä¾‹å¦‚ 8ï¼› [0-9]+è¡¨ç¤ºåŒ¹é…0-9ä¹‹é—´çš„å¤šä¸ªæ•°å­—ï¼Œä¾‹å¦‚ï¼š867 4# abc$ è¡¨ç¤ºä»¥abcç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œ$è¡¨ç¤ºä»¥xxxç»“å°¾ 1^[a-z0-9_-]{5,16}$ 2# åªèƒ½å«æœ‰å°å†™å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿,å‡å·ï¼Œä¸”é•¿åº¦ä¸º5-16çš„å­—ç¬¦ä¸² å­—ç¬¦ Description . é™¤äº†\\r \\nä»¥å¤–çš„ä»»ä½•å•å­—ç¬¦ \\w åŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº[A-Za-Z0-9_] * åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–è€…å¤šæ¬¡ ","tags":null,"title":"ã€ŒRegexã€æ­£åˆ™è¡¨è¾¾å¼"},{"categories":null,"contents":"1sudo vi /etc/ssh/ssh_config 2 3# å¢åŠ å¦‚ä¸‹ä¸¤è¡Œ 4ServerAliveInterval 50 #æ¯éš”50ç§’å°±å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ 5ServerAliveCountMax 3 #å…è®¸è¶…æ—¶çš„æ¬¡æ•°ï¼Œä¸€èˆ¬éƒ½ä¼šå“åº” 6 7vim /etc/ssh/sshd_config 8ï¼Œæ‰¾åˆ°ClientAliveInternal å°†åé¢çš„æ•°å­—0æ”¹ä¸º60 ï¼Œæ³¨æ„å»æ‰å‰é¢çš„#ï¼Œå› ä¸ºå¦‚æœæœ€å‰é¢æ˜¯äº•å·çš„è¯æ˜¯æ³¨é‡Šæ‰çš„ Iterm ssh å¯¼è‡´å¡æ­»\n1vi /etc/ssh/ssh_config 2# å¢åŠ å¦‚ä¸‹ä¸¤è¡Œ 3ServerAliveInterval 60 4ServerAliveCountMax 2 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/ssh_stuck/","summary":"1sudo vi /etc/ssh/ssh_config 2 3# å¢åŠ å¦‚ä¸‹ä¸¤è¡Œ 4ServerAliveInterval 50 #æ¯éš”50ç§’å°±å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ 5ServerAliveCountMax 3 #å…è®¸è¶…æ—¶çš„æ¬¡æ•°ï¼Œä¸€èˆ¬éƒ½ä¼šå“åº” 6 7vim /etc/ssh/sshd_config 8ï¼Œæ‰¾åˆ°ClientAliveInternal å°†åé¢çš„æ•°å­—0æ”¹ä¸º60 ï¼Œæ³¨æ„å»æ‰å‰é¢çš„#ï¼Œå› ä¸ºå¦‚æœæœ€å‰é¢æ˜¯äº•å·çš„è¯æ˜¯æ³¨é‡Šæ‰çš„ Iterm ssh å¯¼è‡´å¡æ­»\n1vi /etc/ssh/ssh_config 2# å¢åŠ å¦‚ä¸‹ä¸¤è¡Œ 3ServerAliveInterval 60 4ServerAliveCountMax 2 ","tags":null,"title":"ã€ŒSSHã€Iterm sshé•¿æ—¶é—´å¡æ­»"},{"categories":null,"contents":" Telegraf is an agent for collecting metrics and writing the to InfluxDB or other outputs.\nInstall\n1docker run -d --name telegraf --net=container:influxdb telegraf ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/telegraph/","summary":" Telegraf is an agent for collecting metrics and writing the to InfluxDB or other outputs.\nInstall\n1docker run -d --name telegraf --net=container:influxdb telegraf ","tags":null,"title":"ã€ŒTelegrafã€ Telegraf"},{"categories":null,"contents":" â€‹\tå½“ä½¿ç”¨ssh è¿æ¥ä¸€å°è¿œç¨‹è®¡ç®—æœºçš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶æ­£åœ¨æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œçªç„¶æ–­ç½‘äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿›ç¨‹ä¹Ÿä¼šè¢«è¿«ä¸­æ–­äº†ã€‚å½“é‡æ–°sshè¿æ¥åˆ°è¿™å°è¿œç¨‹è®¡ç®—æœºçš„æ—¶å€™ï¼Œå·²ç»æ‰¾ä¸åˆ°ä¹‹å‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹äº†ã€‚å› ä¸ºä¸Šä¸€æ¬¡è¿æ¥çš„ä¼šè¯(Session)å·²ç»ç»ˆæ­¢ï¼Œ è¿™æ¬¡çš„é‡æ–°è¿æ¥åˆæ–°å»ºäº†ä¸€ä¸ªä¼šè¯ã€‚å¦‚æœä½ é‡åˆ°è¿‡è¿™ç§é—®é¢˜ä½ å°±ä¼šå‘ç°ï¼š ä¼šè¯å’Œè¿›ç¨‹æ˜¯ç»‘å®šçš„ï¼Œä¼šè¯ç»ˆæ­¢ï¼Œå½“å‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ä¹Ÿä¼šç»ˆæ­¢ã€‚\nâ€‹\tä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œä½ å¯ä»¥å°è¯•ä½¿ç”¨ä¸‹Tmuxã€‚\nå®‰è£…åŠåŸºæœ¬ä½¿ç”¨ 1# å®‰è£…åœ¨éœ€è¦è¿œç¨‹è¿æ¥çš„è¿œç¨‹æœåŠ¡å™¨ä¸Š 2apt install tmux 1# æ–°å»º 2tmux new -s \u0026lt;session name\u0026gt; 3 4# åˆ‡æ¢åˆ°æŸä¸ªsession 5tmux attach -t \u0026lt;session name\u0026gt; 6 7# é€€å‡ºæŸä¸ªsessionï¼Œä¾æ—§ä¿ç•™è¿›ç¨‹ 8tmux detach 9 10# åˆ†éš”çª—å£ 11tmux split-window 12tmux split-window -h # æ°´å¹³åˆ†éš” 13 14# åˆ‡æ¢çª—å£ ã€Ctrlã€‘+ã€bã€‘ ç„¶åæŒ‰ä¸‹ ã€ï¼›ã€‘ å¿«æ·é”® å‰ç¼€é”® ã€Ctrlã€‘+ã€bã€‘ã€‚å…ˆæŒ‰ä¸‹å‰ç¼€é”®åï¼Œåœ¨ä½¿ç”¨åŠŸèƒ½é”®ã€‚\ncopy-mode use vi shortcuts 1cat \u0026lt;\u0026lt;EOF | tee -a ~/.tmux.conf 2setw -g mode-keys vi 3set -g @plugin \u0026#39;tmux-plugins/tpm\u0026#39; 4set -g @plugin \u0026#39;tmux-plugins/tmux-sensible\u0026#39; 5set -g @plugin \u0026#39;tmux-plugins/tmux-resurrect\u0026#39; 6 7run \u0026#39;~/.tmux/plugins/tpm/tpm\u0026#39; 8EOF æ’ä»¶ç®¡ç† Tmux Plugin Manager Tmuxéœ€è¦å®‰è£…æ’ä»¶å¯ä»¥é€šè¿‡Tmux Plugin Manager è¿™ä¸ªæ’ä»¶è¿›è¡Œå®‰è£…ï¼Œ è¿™ä¸ªæ’ä»¶ç›¸å½“äºä¸€ä¸ªæ’ä»¶ç®¡ç†ç³»ç»Ÿã€‚\n1git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm 2 3 4# vi .tmux.conf 5# List of plugins 6set -g @plugin \u0026#39;tmux-plugins/tpm\u0026#39; 7set -g @plugin \u0026#39;tmux-plugins/tmux-sensible\u0026#39; 8 9# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf) 10run \u0026#39;~/.tmux/plugins/tpm/tpm\u0026#39; 11 12 13# é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ 14 # type this in terminal if tmux is already running 15 tmux source ~/.tmux.conf ç„¶åå°±å¯ä»¥åœ¨Tmuxä¸­ä½¿ç”¨prefix+I(å¤§å†™I)å®‰è£…é…ç½®æ–‡ä»¶.tmux.confä¸­å®šä¹‰çš„æ’ä»¶äº†ã€‚\nTmux Resurrect å½“æˆ‘ä»¬é‡å¯ç³»ç»ŸåTmuxçš„sessionä¼šè¢«æ¸…é™¤ï¼Œå¯¼è‡´æ¯æ¬¡é‡å¯ä¹‹åéƒ½è¦é‡å»ºä¸€å †sessionå¹¶ä¸”é‡å»ºPaneã€‚\nTmux Resurrectæ’ä»¶å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¿å­˜å’Œæ¢å¤Tmux Session\n1# 1st, add config 2set -g @plugin \u0026#39;tmux-plugins/tmux-resurrect\u0026#39; 3# 2nd, instlal 4prefix +I é‡å¯ç”µè„‘ä¹‹å‰å…ˆæ‰§è¡Œï¼Œä¿å­˜ session ï¼š prefix + Ctrl-s\né‡å¯ä¹‹åï¼Œé¦–å…ˆæ‰“å¼€ tmux ç„¶å Restore Sessionï¼š prefix + Ctrl-r\nå¦‚æœæœ‰å¤šä¸ªsessionå¯ä»¥ä½¿ç”¨prefix +s é€‰æ‹© sessionã€‚\nå‚è€ƒæ–‡æ¡£ http://www.ruanyifeng.com/blog/2019/10/tmux.html\nhttps://www.scutmath.com/tmux_session_save_restore.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/tmux/","summary":"â€‹\tå½“ä½¿ç”¨ssh è¿æ¥ä¸€å°è¿œç¨‹è®¡ç®—æœºçš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶æ­£åœ¨æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œçªç„¶æ–­ç½‘äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿›ç¨‹ä¹Ÿä¼šè¢«è¿«ä¸­æ–­äº†ã€‚å½“é‡æ–°sshè¿æ¥åˆ°è¿™å°è¿œç¨‹è®¡ç®—æœºçš„æ—¶å€™ï¼Œå·²ç»æ‰¾ä¸åˆ°ä¹‹å‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹äº†ã€‚å› ä¸ºä¸Šä¸€æ¬¡è¿æ¥çš„ä¼šè¯(Session)å·²ç»ç»ˆæ­¢ï¼Œ è¿™æ¬¡çš„é‡æ–°è¿æ¥åˆæ–°å»ºäº†ä¸€ä¸ªä¼šè¯ã€‚å¦‚æœä½ é‡åˆ°è¿‡è¿™ç§é—®é¢˜ä½ å°±ä¼šå‘ç°ï¼š ä¼šè¯å’Œè¿›ç¨‹æ˜¯ç»‘å®šçš„ï¼Œä¼šè¯ç»ˆæ­¢ï¼Œå½“å‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ä¹Ÿä¼šç»ˆæ­¢ã€‚\nâ€‹\tä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œä½ å¯ä»¥å°è¯•ä½¿ç”¨ä¸‹Tmuxã€‚\nå®‰è£…åŠåŸºæœ¬ä½¿ç”¨ 1# å®‰è£…åœ¨éœ€è¦è¿œç¨‹è¿æ¥çš„è¿œç¨‹æœåŠ¡å™¨ä¸Š 2apt install tmux 1# æ–°å»º 2tmux new -s \u0026lt;session name\u0026gt; 3 4# åˆ‡æ¢åˆ°æŸä¸ªsession 5tmux attach -t \u0026lt;session name\u0026gt; 6 7# é€€å‡ºæŸä¸ªsessionï¼Œä¾æ—§ä¿ç•™è¿›ç¨‹ 8tmux detach 9 10# åˆ†éš”çª—å£ 11tmux split-window 12tmux split-window -h # æ°´å¹³åˆ†éš” 13 14# åˆ‡æ¢çª—å£ ã€Ctrlã€‘+ã€bã€‘ ç„¶åæŒ‰ä¸‹ ã€ï¼›ã€‘ å¿«æ·é”® å‰ç¼€é”® ã€Ctrlã€‘+ã€bã€‘ã€‚å…ˆæŒ‰ä¸‹å‰ç¼€é”®åï¼Œåœ¨ä½¿ç”¨åŠŸèƒ½é”®ã€‚\ncopy-mode use vi shortcuts 1cat \u0026lt;\u0026lt;EOF | tee -a ~/.tmux.conf 2setw -g mode-keys vi 3set -g @plugin \u0026#39;tmux-plugins/tpm\u0026#39; 4set -g @plugin \u0026#39;tmux-plugins/tmux-sensible\u0026#39; 5set -g @plugin \u0026#39;tmux-plugins/tmux-resurrect\u0026#39; 6 7run \u0026#39;~/.","tags":null,"title":"ã€Œtmuxã€è™šæ‹Ÿç»ˆç«¯"},{"categories":null,"contents":" ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®ï¼Ÿ\næ—¶åºæ•°æ®çš„åº”ç”¨åœºæ™¯å’Œç‰¹å¾ï¼Ÿ\næ—¶åºæ•°æ®åº“ï¼Ÿ\næ—¶åºæ•°æ® æ—¶åºæ•°æ®ï¼Œå°±æ˜¯ä¸æ—¶é—´å¼ºç›¸å…³åº¦çš„ä¸€ç³»åˆ—æ•°æ®ã€‚å…³æ³¨çš„æ˜¯æŸä¸€æ—¶åˆ»çš„æ•°æ®å€¼ï¼Œè€Œä¸æ˜¯æœ€ç»ˆçš„æ•°æ®ã€‚æ˜¯ä¸€ä¸ªè¿‡ç¨‹è€Œä¸æ˜¯ä¸€ä¸ªç»“æœã€‚æ—¶åºæ•°æ®æè¿°çš„æ˜¯ä¸€ä¸ªæ•°æ®ï¼ˆæŒ‡æ ‡ï¼‰åœ¨æ—¶é—´ç»´åº¦ä¸Šçš„å˜åŒ–ã€‚ä¾‹å¦‚ï¼š è‚¡ç¥¨Kçº¿ã€ç¯å¢ƒç›‘æµ‹ã€‚\næ—¶åºæ•°æ®çš„ç‰¹å¾ï¼š\næ•°æ®ä»¥ä¸€å®šçš„æ—¶é—´é—´éš”äº§ç”Ÿï¼Œç”Ÿäº§é€Ÿç‡ç¨³å®šã€‚ å†™å…¥å¤šï¼ŒæŸ¥è¯¢å°‘ æ—¶åºæ•°æ®ä¸å…è®¸æ›´æ–° æ—¶åºæ•°æ®ä¸»è¦æ˜¯æŒ‰æ—¶é—´èŒƒå›´æŸ¥è¯¢ æ—¶åºæ•°æ®åº“ ä¼ ç»Ÿçš„æ•°æ®åº“å¹¶ä¸é€‚åˆå­˜å‚¨æ—¶åºæ•°æ®ï¼Œé’ˆå¯¹æ—¶åºæ•°æ®çš„ç‰¹å¾ï¼Œæ—¶åºæ•°æ®åº“çš„åŸºæœ¬è¦æ±‚å¦‚ä¸‹ï¼š\næ”¯æŒé«˜å¹¶å‘ã€é«˜ååé‡çš„å†™å…¥ æ”¯æŒæµ·é‡æ•°æ®å­˜å‚¨ é«˜å¯ç”¨ï¼ˆæ—¶åºæ•°æ®åœ¨äº’è”ç½‘å…¬å¸å¸¸ç”¨ä½œæŠ¥è­¦æ•°æ®æºï¼‰ æ”¯æŒå¤æ‚çš„å¤šç»´åº¦çš„æŸ¥è¯¢ æ˜“äºæ¨ªå‘æ‰©å±• å¸¸è§çš„æ—¶åºæ•°æ®åº“\næ—¶åºæ•°æ®åŸºæœ¬æ¦‚å¿µ ä¸€æ¡æ—¶åºæ•°æ®æ˜¯ç”±å¤šä¸ªDataPointæ„æˆçš„ã€‚æ¯ä¸ªDataPointåŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹é¢\nmetricï¼š ä¸€èˆ¬ä¹Ÿå«metric nameï¼Œæ˜¯æ—¶åºæ•°æ®çš„æŒ‡æ ‡å\ntags: ä¸€ä¸ªæˆ–è€…å¤šä¸ªtagç»„åˆï¼Œç”¨æˆ·æè¿°metricçš„ä¸åŒç»´åº¦ã€‚æ¯ä¸ªTagç”±tagk\u0026amp;tagvç»„æˆã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªè¯·æ±‚çš„æ¥æº host=10.20.178.23ï¼Œdc=cnã€‚tagsæ ‡æ˜æ•°æ®çš„ç»´åº¦ã€‚\nvalueï¼š è¡¨ç¤ºå¯¹åº”çš„æ•°å€¼ã€‚ä¾‹å¦‚ï¼šè¯·æ±‚çš„latency æˆ–è€…qpsç­‰ã€‚\ntimestampï¼š æ—¶åºæ•°æ®çš„å…·ä½“æ—¶é—´ï¼Œå¯ä»¥æ˜¯ç§’çº§æˆ–è€…æ¯«ç§’çº§åˆ«çš„Unixæ—¶é—´æˆ³ã€‚\nä¾‹å¦‚ï¼š JVM_Heap_Memory_Usage_MB{host=127.0.0.1, instanceId=jvm01}\nDownsampling\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/opentsdb_introduction/","summary":"ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®ï¼Ÿ\næ—¶åºæ•°æ®çš„åº”ç”¨åœºæ™¯å’Œç‰¹å¾ï¼Ÿ\næ—¶åºæ•°æ®åº“ï¼Ÿ\næ—¶åºæ•°æ® æ—¶åºæ•°æ®ï¼Œå°±æ˜¯ä¸æ—¶é—´å¼ºç›¸å…³åº¦çš„ä¸€ç³»åˆ—æ•°æ®ã€‚å…³æ³¨çš„æ˜¯æŸä¸€æ—¶åˆ»çš„æ•°æ®å€¼ï¼Œè€Œä¸æ˜¯æœ€ç»ˆçš„æ•°æ®ã€‚æ˜¯ä¸€ä¸ªè¿‡ç¨‹è€Œä¸æ˜¯ä¸€ä¸ªç»“æœã€‚æ—¶åºæ•°æ®æè¿°çš„æ˜¯ä¸€ä¸ªæ•°æ®ï¼ˆæŒ‡æ ‡ï¼‰åœ¨æ—¶é—´ç»´åº¦ä¸Šçš„å˜åŒ–ã€‚ä¾‹å¦‚ï¼š è‚¡ç¥¨Kçº¿ã€ç¯å¢ƒç›‘æµ‹ã€‚\næ—¶åºæ•°æ®çš„ç‰¹å¾ï¼š\næ•°æ®ä»¥ä¸€å®šçš„æ—¶é—´é—´éš”äº§ç”Ÿï¼Œç”Ÿäº§é€Ÿç‡ç¨³å®šã€‚ å†™å…¥å¤šï¼ŒæŸ¥è¯¢å°‘ æ—¶åºæ•°æ®ä¸å…è®¸æ›´æ–° æ—¶åºæ•°æ®ä¸»è¦æ˜¯æŒ‰æ—¶é—´èŒƒå›´æŸ¥è¯¢ æ—¶åºæ•°æ®åº“ ä¼ ç»Ÿçš„æ•°æ®åº“å¹¶ä¸é€‚åˆå­˜å‚¨æ—¶åºæ•°æ®ï¼Œé’ˆå¯¹æ—¶åºæ•°æ®çš„ç‰¹å¾ï¼Œæ—¶åºæ•°æ®åº“çš„åŸºæœ¬è¦æ±‚å¦‚ä¸‹ï¼š\næ”¯æŒé«˜å¹¶å‘ã€é«˜ååé‡çš„å†™å…¥ æ”¯æŒæµ·é‡æ•°æ®å­˜å‚¨ é«˜å¯ç”¨ï¼ˆæ—¶åºæ•°æ®åœ¨äº’è”ç½‘å…¬å¸å¸¸ç”¨ä½œæŠ¥è­¦æ•°æ®æºï¼‰ æ”¯æŒå¤æ‚çš„å¤šç»´åº¦çš„æŸ¥è¯¢ æ˜“äºæ¨ªå‘æ‰©å±• å¸¸è§çš„æ—¶åºæ•°æ®åº“\næ—¶åºæ•°æ®åŸºæœ¬æ¦‚å¿µ ä¸€æ¡æ—¶åºæ•°æ®æ˜¯ç”±å¤šä¸ªDataPointæ„æˆçš„ã€‚æ¯ä¸ªDataPointåŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–¹é¢\nmetricï¼š ä¸€èˆ¬ä¹Ÿå«metric nameï¼Œæ˜¯æ—¶åºæ•°æ®çš„æŒ‡æ ‡å\ntags: ä¸€ä¸ªæˆ–è€…å¤šä¸ªtagç»„åˆï¼Œç”¨æˆ·æè¿°metricçš„ä¸åŒç»´åº¦ã€‚æ¯ä¸ªTagç”±tagk\u0026amp;tagvç»„æˆã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªè¯·æ±‚çš„æ¥æº host=10.20.178.23ï¼Œdc=cnã€‚tagsæ ‡æ˜æ•°æ®çš„ç»´åº¦ã€‚\nvalueï¼š è¡¨ç¤ºå¯¹åº”çš„æ•°å€¼ã€‚ä¾‹å¦‚ï¼šè¯·æ±‚çš„latency æˆ–è€…qpsç­‰ã€‚\ntimestampï¼š æ—¶åºæ•°æ®çš„å…·ä½“æ—¶é—´ï¼Œå¯ä»¥æ˜¯ç§’çº§æˆ–è€…æ¯«ç§’çº§åˆ«çš„Unixæ—¶é—´æˆ³ã€‚\nä¾‹å¦‚ï¼š JVM_Heap_Memory_Usage_MB{host=127.0.0.1, instanceId=jvm01}\nDownsampling","tags":["TSDB","OpenTSDB"],"title":"ã€ŒTSDBã€æ—¶åºæ•°æ®\u0026æ—¶åºæ•°æ®åº“ç®€ä»‹"},{"categories":null,"contents":"https://geek-docs.com/vscode/vscode-tutorials/vscode-workspace-switch.html\nhttps://zhuanlan.zhihu.com/p/188499395\nCtrl +K Ctrl +S Keyboard Shortcuts\nåˆ‡æ¢åŒºåŸŸçš„å¿«æ·é”® -\u0026gt; Focus on\nåŒºåŸŸ key Focus on folders view Ctrl + K L Focus on Open Editors View Ctrl + K E Focun on Terminal View Ctrl +K K Extensions Usage Extension Spell checker Code spell checker ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/tips/vscode/","summary":"https://geek-docs.com/vscode/vscode-tutorials/vscode-workspace-switch.html\nhttps://zhuanlan.zhihu.com/p/188499395\nCtrl +K Ctrl +S Keyboard Shortcuts\nåˆ‡æ¢åŒºåŸŸçš„å¿«æ·é”® -\u0026gt; Focus on\nåŒºåŸŸ key Focus on folders view Ctrl + K L Focus on Open Editors View Ctrl + K E Focun on Terminal View Ctrl +K K Extensions Usage Extension Spell checker Code spell checker ","tags":null,"title":"ã€ŒVSCodeã€Vs Code ä½¿ç”¨æŠ€å·§"},{"categories":null,"contents":"PCBè®¾è®¡ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/xiaokr/","summary":"PCBè®¾è®¡ ","tags":null,"title":"ã€ŒXiaoKrã€å°æ°ªæœºå™¨äºº"},{"categories":null,"contents":" ç¼–ç è¿‡ç¨‹ä¸­é¦–å…ˆè¦æ ¡éªŒè¾“å…¥æ•°æ®çš„åˆæ³•æ€§ã€‚\nå†™ä»£ç ä¹‹å‰é¦–å…ˆæƒ³å¥½æœ‰å“ªäº›æµ‹è¯•ç”¨ä¾‹ï¼Œè¦æé«˜ä»£ç çš„æµ‹è¯•è¦†ç›–ç‡ã€‚\n3. æ•°ç»„ä¸­é‡å¤çš„æ•°å­— æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—ã€‚\nåœ¨ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ nums é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨ 0ï½n-1 çš„èŒƒå›´å†…ã€‚æ•°ç»„ä¸­æŸäº›æ•°å­—æ˜¯é‡å¤çš„ï¼Œä½†ä¸çŸ¥é“æœ‰å‡ ä¸ªæ•°å­—é‡å¤äº†ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°å­—é‡å¤äº†å‡ æ¬¡ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚\n2 \u0026lt;= n \u0026lt;= 100000\nå¦‚æœä½¿ç”¨Mapï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸ºO(n), ç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚é¢˜ç›®ä¸­çš„å…³é”®ä¿¡æ¯ä¸ºé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œä¸”æ‰€æœ‰æ•°å­—éƒ½åœ¨0~n-1çš„èŒƒå›´å†…ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨é¢å¤–å¼€è¾Ÿç©ºé—´ã€‚\n1func findRepeatNumber(nums []int) int { 2\tvar tmp int 3\tfor i, v := range nums { 4\tif v != i { 5\tif nums[v] == v { 6\treturn v 7\t} 8\ttmp = nums[v] 9\tnums[v] = v 10\tnums[i] = tmp 11\t} 12\t} 13\treturn -1 14} 15 16// æ—¶é—´å¤æ‚åº¦ä¸ºO(n),ç©ºé—´å¤æ‚è¯»ä¸ºO(1) 4. äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ åœ¨ä¸€ä¸ª n * m çš„äºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªé«˜æ•ˆçš„å‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚\nç¤ºä¾‹:\nç°æœ‰çŸ©é˜µ matrix å¦‚ä¸‹ï¼š\n1[ 2 [1, 4, 7, 11, 15], 3 [2, 5, 8, 12, 19], 4 [3, 6, 9, 16, 22], 5 [10, 13, 14, 17, 24], 6 [18, 21, 23, 26, 30] 7] ç»™å®š target = 5ï¼Œè¿”å› trueã€‚\nç»™å®š target = 20ï¼Œè¿”å› falseã€‚\né™åˆ¶ï¼š\n0 \u0026lt;= n \u0026lt;= 1000\n0 \u0026lt;= m \u0026lt;= 1000\nçŸ©é˜µä»å·¦åˆ°å³é€’å¢ï¼Œä»ä¸Šåˆ°ä¸‹é€’å¢ã€‚å¦‚æœå³ä¸Šè§’çœ‹ï¼Œåˆ™å¾€å·¦é€’å‡ï¼Œå¾€ä¸‹é€’å¢ï¼Œå¾ˆåƒä¸€æ£µæœç´¢äºŒå‰æ ‘ã€‚\n[æ€è€ƒ]ï¼š é€’å¢ or éé€’å‡\n1func findNumberIn2DArray(matrix [][]int, target int) bool { 2\tn := len(matrix) 3\tif n == 0 { 4\treturn false 5\t} 6\tm := len(matrix[0]) 7\tif m == 0 { 8\treturn false 9\t} 10\tfor j, i := m-1, 0; j \u0026gt;= 0 \u0026amp;\u0026amp; i \u0026lt; n; { 11\ttmp := matrix[i][j] 12\tif tmp == target { 13\treturn true 14\t} else if tmp \u0026gt; target { 15\tj-- 16\t} else { 17\ti++ 18\t} 19\t} 20\treturn false 21} 22 23// æ—¶é—´å¤æ‚åº¦ä¸ºO(m+n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1) 5. æ›¿æ¢ç©ºæ ¼ è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸² s ä¸­çš„æ¯ä¸ªç©ºæ ¼æ›¿æ¢æˆ\u0026quot;%20\u0026quot;ã€‚\nç¤ºä¾‹ 1ï¼š\n1è¾“å…¥ï¼šs = \u0026#34;We are happy.\u0026#34; 2è¾“å‡ºï¼š\u0026#34;We%20are%20happy.\u0026#34; é™åˆ¶ï¼š\n0 \u0026lt;= s çš„é•¿åº¦ \u0026lt;= 10000\nç›´æ¥ä½¿ç”¨å†…ç½®å‡½æ•° 1func replaceSpace(s string) string { 2 return strings.ReplaceAll(s,\u0026#34; \u0026#34;,\u0026#34;%20\u0026#34;) 3} ä½¿ç”¨bytes.Buffer 1func replaceSpace(s string) string { 2\tl := len(s) 3\tnewStr := bytes.Buffer{} 4\tfor i := 0; i \u0026lt; l; i++ { 5\tv := s[i] 6\tif v == \u0026#39; \u0026#39; { 7\tnewStr.WriteString(\u0026#34;%20\u0026#34;) 8\tcontinue 9\t} 10\tnewStr.WriteByte(v) 11\t} 12\treturn newStr.String() 13} 6. ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ è¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œä»å°¾åˆ°å¤´åè¿‡æ¥è¿”å›æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ï¼ˆç”¨æ•°ç»„è¿”å›ï¼‰ã€‚\nç¤ºä¾‹ 1ï¼š\n1è¾“å…¥ï¼šhead = [1,3,2] 2è¾“å‡ºï¼š[2,3,1] é™åˆ¶ï¼š\n0 \u0026lt;= é“¾è¡¨é•¿åº¦ \u0026lt;= 10000\nä½¿ç”¨æ ˆ, å…ˆå…¥åå‡º 1func reversePrint(head *ListNode) []int { 2 res := make([]int, 0) 3 for head != nil { 4 res = append(res, head.Val) 5 head = head.Next 6 } 7 for i, j := 0, len(res)-1; i \u0026lt; j; i, j = i+1, j-1 { 8 res[i],res[j] = res[j], res[i] 9 } 10 return res 11} é“¾è¡¨åè½¬ 7. é‡å»ºäºŒå‰æ ‘ è¾“å…¥æŸäºŒå‰æ ‘çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœï¼Œè¯·é‡å»ºè¯¥äºŒå‰æ ‘ã€‚å‡è®¾è¾“å…¥çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœä¸­éƒ½ä¸å«é‡å¤çš„æ•°å­—ã€‚\nä¾‹å¦‚ï¼Œç»™å‡º\n1å‰åºéå† preorder = [3,9,20,15,7] 2ä¸­åºéå† inorder = [9,3,15,20,7] è¿”å›å¦‚ä¸‹çš„äºŒå‰æ ‘ï¼š\n1 3 2 / \\ 3 9 20 4/ \\ 515 7 é™åˆ¶ï¼š\n0 \u0026lt;= èŠ‚ç‚¹ä¸ªæ•° \u0026lt;= 5000\n1//* Definition for a binary tree node. 2type TreeNode struct { 3\tVal int 4\tLeft *TreeNode 5\tRight *TreeNode 6} 7 8func buildTree(preorder []int, inorder []int) *TreeNode { 9 10\tif len(preorder) == 0 { 11\treturn nil 12\t} 13 14\tif len(preorder) == 1 { 15\treturn \u0026amp;TreeNode{ 16\tVal: preorder[0], 17\tLeft: nil, 18\tRight: nil, 19\t} 20\t} 21 22\tval := preorder[0] // root val 23\tindex := 0 // inorder root index 24\tfor i, v := range inorder { 25\tif val == v { 26\tindex = i 27\tbreak 28\t} 29\t} 30\troot := TreeNode{ 31\tVal: val, 32\tLeft: buildTree(preorder[1:index+1], inorder[0:index]), 33\tRight: buildTree(preorder[index+1:], inorder[index+1:]), 34\t} 35\treturn \u0026amp;root 36} 9. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ— ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼Œè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•° appendTail å’Œ deleteHead ï¼Œåˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥æ•´æ•°å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤æ•´æ•°çš„åŠŸèƒ½ã€‚(è‹¥é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ ï¼ŒdeleteHead æ“ä½œè¿”å› -1 )\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥ï¼š\n1[\u0026#34;CQueue\u0026#34;,\u0026#34;appendTail\u0026#34;,\u0026#34;deleteHead\u0026#34;,\u0026#34;deleteHead\u0026#34;] 2[[],[3],[],[]] 3è¾“å‡ºï¼š[null,null,3,-1] ç¤ºä¾‹ 2ï¼š\nè¾“å…¥ï¼š\n1[\u0026#34;CQueue\u0026#34;,\u0026#34;deleteHead\u0026#34;,\u0026#34;appendTail\u0026#34;,\u0026#34;appendTail\u0026#34;,\u0026#34;deleteHead\u0026#34;,\u0026#34;deleteHead\u0026#34;] 2[[],[],[5],[2],[],[]] 3è¾“å‡ºï¼š[null,-1,null,null,5,2] æç¤ºï¼š\n11 \u0026lt;= values \u0026lt;= 10000 2æœ€å¤šä¼šå¯¹ appendTailã€deleteHead è¿›è¡Œ 10000 æ¬¡è°ƒç”¨ ä½¿ç”¨ Listçš„Double Listä½œä¸ºStack\n1type CQueue struct{ 2 stack1, stack2 *list.List 3} 4 5func Constructor() CQueue{ 6 return CQueue{ 7 list.New(), 8 list.New(), 9 } 10} 11 12func (q *CQueue) AppendTail(value int){ 13 q.stack1.PushBack(value) 14} 15 16func (q *CQueue) DeleteHead() int{ 17 if q.stack2.Len() == 0{ 18 for this.stack1.Len() \u0026gt; 0{ 19 this.stack2.PushBack(this.stack1.Remove(this.stack1.Back())) 20 } 21 } 22} è‡ªå®šä¹‰Stack\n1type CQueue struct{ 2 stack1, stack2 Stack 3} 4 5func Constructor() CQueue{ 6 return CQueue{ 7 Stack{}, 8 Stack{}, 9 } 10} 11 12func (q *CQueue) AppendTail(value int){ 13 q.stack1.Push(value) 14} 15 16func (q *CQueue) DeleteHead() int{ 17 if q.stack2.Len== 0{ 18 for q.stack1.Len \u0026gt; 0 { 19 q.stack2.Push(q.stack1.Pop()) 20 } 21 } 22 if q.stack2.Len != 0{ 23 return q.stack2.Pop() 24 } 25 return -1 26} 27 28 29type Stack struct { 30 Values []int 31 Len int 32} 33 34func(s *Stack) Push(value int){ 35 if len(s.Values) \u0026lt; (s.Len+1){ 36 s.Values = append(s.Values,0) 37 } 38 s.Values[s.Len] = value 39 s.Len++ 40} 41 42func(s *Stack) Pop()int{ 43 e := s.Values[s.Len-1] 44 s.Len-- 45 return e 46} 53. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾æ•°å­— 59. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ ç»™å®šä¸€ä¸ªæ•°ç»„ nums å’Œæ»‘åŠ¨çª—å£çš„å¤§å° kï¼Œè¯·æ‰¾å‡ºæ‰€æœ‰æ»‘åŠ¨çª—å£é‡Œçš„æœ€å¤§å€¼ã€‚\nç¤ºä¾‹:\n1è¾“å…¥: nums = [1,3,-1,-3,5,3,6,7], å’Œ k = 3 2è¾“å‡º: [3,3,5,5,6,7] 3è§£é‡Š: 4 5 æ»‘åŠ¨çª—å£çš„ä½ç½® æœ€å¤§å€¼ 6--------------- ----- 7[1 3 -1] -3 5 3 6 7 3 8 1 [3 -1 -3] 5 3 6 7 3 9 1 3 [-1 -3 5] 3 6 7 5 10 1 3 -1 [-3 5 3] 6 7 5 11 1 3 -1 -3 [5 3 6] 7 6 12 1 3 -1 -3 5 [3 6 7] 7 æç¤ºï¼š\nä½ å¯ä»¥å‡è®¾ k æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œåœ¨è¾“å…¥æ•°ç»„ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œ1 â‰¤ k â‰¤ è¾“å…¥æ•°ç»„çš„å¤§å°ã€‚\n1package main 2 3import ( 4\t\u0026#34;container/heap\u0026#34; 5\t\u0026#34;sort\u0026#34; 6) 7 8var a []int 9 10type hp struct{ sort.IntSlice } 11 12func (h hp) Less(i, j int) bool { return a[h.IntSlice[i]] \u0026gt; a[h.IntSlice[j]] } 13func (h *hp) Push(v interface{}) { h.IntSlice = append(h.IntSlice, v.(int)) } 14func (h *hp) Pop() interface{} { a := h.IntSlice; v := a[len(a)-1]; h.IntSlice = a[:len(a)-1]; return v } 15 16func maxSlidingWindow(nums []int, k int) []int { 17\ta = nums 18\tq := \u0026amp;hp{make([]int, k)} 19\tfor i := 0; i \u0026lt; k; i++ { 20\tq.IntSlice[i] = i 21\t} 22\theap.Init(q) 23 24\tn := len(nums) 25\tans := make([]int, 1, n-k+1) 26\tans[0] = nums[q.IntSlice[0]] 27\tfor i := k; i \u0026lt; n; i++ { 28\theap.Push(q, i) 29\tfor q.IntSlice[0] \u0026lt;= i-k { 30\theap.Pop(q) 31\t} 32\tans = append(ans, nums[q.IntSlice[0]]) 33\t} 34\treturn ans 35} 36 37func main() { 38\tmaxSlidingWindow([]int{1, 3, 9, -3, 5, 3, 6, 7}, 3) 39} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/%E5%89%91%E6%8C%87offer/","summary":"ç¼–ç è¿‡ç¨‹ä¸­é¦–å…ˆè¦æ ¡éªŒè¾“å…¥æ•°æ®çš„åˆæ³•æ€§ã€‚\nå†™ä»£ç ä¹‹å‰é¦–å…ˆæƒ³å¥½æœ‰å“ªäº›æµ‹è¯•ç”¨ä¾‹ï¼Œè¦æé«˜ä»£ç çš„æµ‹è¯•è¦†ç›–ç‡ã€‚\n3. æ•°ç»„ä¸­é‡å¤çš„æ•°å­— æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—ã€‚\nåœ¨ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ nums é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨ 0ï½n-1 çš„èŒƒå›´å†…ã€‚æ•°ç»„ä¸­æŸäº›æ•°å­—æ˜¯é‡å¤çš„ï¼Œä½†ä¸çŸ¥é“æœ‰å‡ ä¸ªæ•°å­—é‡å¤äº†ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°å­—é‡å¤äº†å‡ æ¬¡ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚\n2 \u0026lt;= n \u0026lt;= 100000\nå¦‚æœä½¿ç”¨Mapï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸ºO(n), ç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚é¢˜ç›®ä¸­çš„å…³é”®ä¿¡æ¯ä¸ºé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œä¸”æ‰€æœ‰æ•°å­—éƒ½åœ¨0~n-1çš„èŒƒå›´å†…ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨é¢å¤–å¼€è¾Ÿç©ºé—´ã€‚\n1func findRepeatNumber(nums []int) int { 2\tvar tmp int 3\tfor i, v := range nums { 4\tif v != i { 5\tif nums[v] == v { 6\treturn v 7\t} 8\ttmp = nums[v] 9\tnums[v] = v 10\tnums[i] = tmp 11\t} 12\t} 13\treturn -1 14} 15 16// æ—¶é—´å¤æ‚åº¦ä¸ºO(n),ç©ºé—´å¤æ‚è¯»ä¸ºO(1) 4.","tags":null,"title":"ã€Œå‰‘æŒ‡offerã€ Goè¯­è¨€ç‰ˆæœ¬"},{"categories":null,"contents":"æ°¸è¿œä¸è¦è®©åˆ«äººå½±å“ä½ çš„å¿ƒæ™´\nå­¦ä¹ å¥½çš„åœ°æ–¹ï¼Œ\næ‘’å¼ƒåçš„åœ°æ–¹ï¼Œ\nä¸è¦è¢«åŒåŒ–\nTo Be A Nice Person.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/do_not_mazy/","summary":"æ°¸è¿œä¸è¦è®©åˆ«äººå½±å“ä½ çš„å¿ƒæ™´\nå­¦ä¹ å¥½çš„åœ°æ–¹ï¼Œ\næ‘’å¼ƒåçš„åœ°æ–¹ï¼Œ\nä¸è¦è¢«åŒåŒ–\nTo Be A Nice Person.","tags":null,"title":"ã€Œå¿ƒæ™´ã€"},{"categories":null,"contents":"ä¾‹é¢˜ ã€ç®€å•ã€‘nä¸ªæ´»åŠ¨æ—¶é—´ï¼Œé€‰æ‹©å¯ä»¥å‚ä¸æœ€å¤šçš„æ´»åŠ¨\nä¼˜å…ˆé€‰æ‹©ç»“æŸæœ€æ—©çš„æ´»åŠ¨\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sort\u0026#34; 6) 7 8type node struct { 9\tstartAt int 10\tendAt int 11} 12 13var ( 14\ttotal int 15\tnow int 16\tres int 17\tnodeList = make([]node, 0) 18) 19 20func main() { 21\t_, _ = fmt.Scanf(\u0026#34;%d\u0026#34;, \u0026amp;total) 22\tnodeList = make([]node, total) 23\tfor i := 0; i \u0026lt; total; i++ { 24\t_, _ = fmt.Scanf(\u0026#34;%d\u0026#34;, \u0026amp;nodeList[i].startAt) 25\t_, _ = fmt.Scanf(\u0026#34;%d\u0026#34;, \u0026amp;nodeList[i].endAt) 26\t} 27 28\tsort.Slice(nodeList, func(i, j int) bool { 29\treturn nodeList[i].endAt \u0026lt; nodeList[j].endAt 30\t}) 31 32\tnow = 0 33\tres = 1 34\tfor i := 1; i \u0026lt; total; i++ { 35\tif nodeList[now].endAt \u0026lt;= nodeList[i].startAt { 36\tnow = i 37\tres++ 38\tfmt.Printf(\u0026#34;%v\\n\u0026#34;, nodeList[i]) 39\t} 40\t} 41 42\tfmt.Printf(\u0026#34;%v\u0026#34;, res) 43} 44 45/* Input 464 471 3 484 6 492 5 501 7 51 52*/ [ç®€å•]ç§æ ‘é—®é¢˜ï¼Œå±…æ°‘è¦æ±‚ä¸€å®š\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/ds_greed/","summary":"ä¾‹é¢˜ ã€ç®€å•ã€‘nä¸ªæ´»åŠ¨æ—¶é—´ï¼Œé€‰æ‹©å¯ä»¥å‚ä¸æœ€å¤šçš„æ´»åŠ¨\nä¼˜å…ˆé€‰æ‹©ç»“æŸæœ€æ—©çš„æ´»åŠ¨\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sort\u0026#34; 6) 7 8type node struct { 9\tstartAt int 10\tendAt int 11} 12 13var ( 14\ttotal int 15\tnow int 16\tres int 17\tnodeList = make([]node, 0) 18) 19 20func main() { 21\t_, _ = fmt.Scanf(\u0026#34;%d\u0026#34;, \u0026amp;total) 22\tnodeList = make([]node, total) 23\tfor i := 0; i \u0026lt; total; i++ { 24\t_, _ = fmt.","tags":null,"title":"ã€Œç®—æ³•ã€è´ªå¿ƒç®—æ³•"},{"categories":null,"contents":" å•é“¾è¡¨çš„æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦æ˜¯O(n)\nè·³è¡¨\næ ‘\nå›¾\nLinked List æ˜¯ç‰¹æ®ŠåŒ–çš„Tree\nTree æ˜¯ç‰¹æ®ŠåŒ–çš„å›¾\næ–æ³¢é‚£å¥‘ï¼Œ çŠ¶æ€æ ‘ï¼Œé€’å½’æ ‘\nçŠ¶æ€æ ‘ç©ºé—´\nå†³ç­–æ ‘ç©ºé—´\näºŒå‰æ ‘ æ»¡äºŒå‰æ ‘ï¼šä¸€ä¸ªäºŒå‰æ ‘çš„æ‰€æœ‰éå¶å­èŠ‚ç‚¹éƒ½å­˜åœ¨å·¦å³å­©å­ï¼Œå¹¶ä¸”æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚çº§ä¸Šã€‚\nå®Œå…¨äºŒå‰æ ‘:\nå­˜å‚¨ç»“æ„:\né“¾å¼å­˜å‚¨\n1// golang 2type Node struct { 3\tData int64 4\tLeftNode *Node 5\tRightNode *Node 6} // C++ struct TreeNode{ int val; TreeNode *left; TreeNode *right; TreeNode(int x): val(x), left(NULL), right(NULL){} }\n1 23. ```java 3public class TreeNode{ 4 public int val; 5 public TreeNode left,right; 6 public TreeNode(int val){ 7\tthis.val=val; 8 this.left=NULL; 9 this.right=NULL; 10 } 11} æ•°ç»„: é€‚ç”¨äºè¡¨ç¤ºå®Œå…¨äºŒå‰æ ‘ï¼Œå¯¹äºç¨€ç–äºŒå‰æ ‘æ˜¯éå¸¸æµªè´¹ç©ºé—´çš„ã€‚\n1\tTree := make([]int64,1000) 2\t// ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ0 ä¸ºrootèŠ‚ç‚¹ã€‚ å¯¹äºnä½ç½®çš„èŠ‚ç‚¹ å·¦å­©å­ Tree[2*n-1]ï¼Œ å³å­©å­ä¸ºTree[2*n] ä¸­åºéå†ï¼Œå‰åºéå†\n1import java.util.*; 2 3public class Solutions { 4 5 public class TreeNode { 6 int val; 7 TreeNode left; 8 TreeNode right; 9 TreeNode(int x) { val = x; } 10 } 11 public TreeNode Solutions(int [] pre,int [] in) { 12 if(pre == null || in == null || pre.length == 0){ 13 return null; 14 } 15 int rootValue = pre[0]; 16 TreeNode node = new TreeNode(rootValue); 17 for(int i = 0; i \u0026lt; in.length; i++){ 18 if(in[i] == rootValue ){ 19 if(pre.length \u0026gt; 1){ 20 node.left = Solutions(Arrays.copyOfRange(pre, 1, i+1), 21 Arrays.copyOfRange(in, 0,i)); 22 node.right = Solutions(Arrays.copyOfRange(pre,i+1,pre.length), 23 Arrays.copyOfRange(in,i+1,in.length)); 24 }else{ 25 node.left = null; 26 node.right = null; 27 } 28 29 } 30 } 31 32 return node; 33 } 34 35 36 public static void main(String[] args) { 37 int[] a = new int[]{1,2,3,4,5,6,7}; 38 int[] b = new int[]{3,2,4,1,6,5,7}; 39 40 Solutions solution = new Solutions(); 41 TreeNode node = solution.Solutions(a,b); 42 System.out.println(\u0026#34;result\u0026#34;); 43 44 int i = 0; 45 46 //int s = i++ + i; 47 int tmp = i; 48 i = i +1; 49 i = tmp +i; 50 51 System.out.println( (byte)129); 52 } 53} äºŒå‰æœç´¢æ ‘ äºŒå‰æ’åºæ ‘ï¼ˆBinary Sort Treeï¼‰ï¼Œåˆç§°äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆBinary Search Treeï¼‰ï¼Œäº¦ç§°äºŒå‰æœç´¢æ ‘ã€‚\nå®šä¹‰\näºŒå‰æ’åºæ ‘æˆ–è€…æ˜¯ä¸€ä¸ªæ£µç©ºæ ‘ï¼Œæˆ–è€…å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘\nè‹¥å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› è‹¥å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘ï¼› æ²¡æœ‰é”®å€¼ç›¸ç­‰çš„èŠ‚ç‚¹ã€‚ ä¸­åºéå† ï¼šå‡åºæ’åˆ—\nå·¦å­æ ‘å§‹ç»ˆè¦å°äºå³å­æ ‘\næŸ¥æ‰¾ æ—¶é—´å¤æ‚åº¦ï¼šO(logn) æ­¥éª¤ï¼š\nè‹¥æ ¹ç»“ç‚¹çš„å…³é”®å­—å€¼ç­‰äºæŸ¥æ‰¾çš„å…³é”®å­—ï¼ŒæˆåŠŸã€‚ å¦åˆ™ï¼Œè‹¥å°äºæ ¹ç»“ç‚¹çš„å…³é”®å­—å€¼ï¼Œé€’å½’æŸ¥å·¦å­æ ‘ã€‚ è‹¥å¤§äºæ ¹ç»“ç‚¹çš„å…³é”®å­—å€¼ï¼Œé€’å½’æŸ¥å³å­æ ‘ã€‚ è‹¥å­æ ‘ä¸ºç©ºï¼ŒæŸ¥æ‰¾ä¸æˆåŠŸã€‚ æ’å…¥ é¦–å…ˆæ‰§è¡ŒæŸ¥æ‰¾ç®—æ³•ï¼Œæ‰¾å‡ºè¢«æ’ç»“ç‚¹çš„çˆ¶äº²ç»“ç‚¹ã€‚ åˆ¤æ–­è¢«æ’ç»“ç‚¹æ˜¯å…¶çˆ¶äº²ç»“ç‚¹çš„å·¦ã€å³å„¿å­ã€‚å°†è¢«æ’ç»“ç‚¹ä½œä¸ºå¶å­ç»“ç‚¹æ’å…¥ã€‚ è‹¥äºŒå‰æ ‘ä¸ºç©ºã€‚åˆ™é¦–å…ˆå•ç‹¬ç”Ÿæˆæ ¹ç»“ç‚¹ã€‚ æ³¨æ„ï¼šæ–°æ’å…¥çš„ç»“ç‚¹æ€»æ˜¯å¶å­ç»“ç‚¹ã€‚\nåˆ é™¤ åœ¨äºŒå‰æ’åºæ ‘åˆ å»ä¸€ä¸ªç»“ç‚¹ï¼Œåˆ†ä¸‰ç§æƒ…å†µè®¨è®ºï¼š\nè‹¥*pç»“ç‚¹ä¸ºå¶å­ç»“ç‚¹ï¼Œå³PL(å·¦å­æ ‘)å’ŒPR(å³å­æ ‘)å‡ä¸ºç©ºæ ‘ã€‚ç”±äºåˆ å»å¶å­ç»“ç‚¹ä¸ç ´åæ•´æ£µæ ‘çš„ç»“æ„ï¼Œåˆ™å¯ä»¥ç›´æ¥åˆ é™¤æ­¤å­ç»“ç‚¹ã€‚ è‹¥*pç»“ç‚¹åªæœ‰å·¦å­æ ‘PLæˆ–å³å­æ ‘PRï¼Œæ­¤æ—¶åªè¦ä»¤PLæˆ–PRç›´æ¥æˆä¸ºå…¶åŒäº²ç»“ç‚¹*fçš„å·¦å­æ ‘ï¼ˆå½“*pæ˜¯å·¦å­æ ‘ï¼‰æˆ–å³å­æ ‘ï¼ˆå½“*pæ˜¯å³å­æ ‘ï¼‰å³å¯ï¼Œä½œæ­¤ä¿®æ”¹ä¹Ÿä¸ç ´åäºŒå‰æ’åºæ ‘çš„ç‰¹æ€§ã€‚ è‹¥*pç»“ç‚¹çš„å·¦å­æ ‘å’Œå³å­æ ‘å‡ä¸ç©ºã€‚åœ¨åˆ å»*pä¹‹åï¼Œä¸ºä¿æŒå…¶å®ƒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œå¯æŒ‰ä¸­åºéå†ä¿æŒæœ‰åºè¿›è¡Œè°ƒæ•´ï¼Œå¯ä»¥æœ‰ä¸¤ç§åšæ³•ï¼š å…¶ä¸€æ˜¯ä»¤*pçš„å·¦å­æ ‘ä¸º*fçš„å·¦/å³(ä¾*pæ˜¯*fçš„å·¦å­æ ‘è¿˜æ˜¯å³å­æ ‘è€Œå®š)å­æ ‘ï¼Œ*sä¸º*på·¦å­æ ‘çš„æœ€å³ä¸‹çš„ç»“ç‚¹ï¼Œè€Œ*pçš„å³å­æ ‘ä¸º*sçš„å³å­æ ‘ï¼› å…¶äºŒæ˜¯ä»¤*pçš„ç›´æ¥å‰é©±ï¼ˆæˆ–ç›´æ¥åç»§ï¼‰æ›¿ä»£*pï¼Œç„¶åå†ä»äºŒå‰æ’åºæ ‘ä¸­åˆ å»å®ƒçš„ç›´æ¥å‰é©±ï¼ˆæˆ–ç›´æ¥åç»§ï¼‰ï¼å³è®©*fçš„å·¦å­æ ‘(å¦‚æœæœ‰çš„è¯)æˆä¸º*på·¦å­æ ‘çš„æœ€å·¦ä¸‹ç»“ç‚¹(å¦‚æœæœ‰çš„è¯)ï¼Œå†è®©*fæˆä¸º*pçš„å·¦å³ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ã€‚ åœ¨äºŒå‰æ’åºæ ‘ä¸Šåˆ é™¤ä¸€ä¸ªç»“ç‚¹çš„ç®—æ³•å¦‚ä¸‹ï¼š äºŒå‰æ ‘é¡ºåºå­˜å‚¨ç»“æ„ https://www.jianshu.com/p/74490c570cc1\nhttps://blog.csdn.net/u012469528/article/details/81475824\näºŒå‰æ ‘çš„éå† æ·±åº¦ä¼˜å…ˆéå†ï¼ˆå‰/ä¸­/ååºéå†ï¼‰ 1# pre-order In-order Post-order 2 3func() preOrder(root TreeNode){ 4\tif root != nil{ 5\tprint(root.val) 6\tpreOrder(root.left) 7\tpreOrder(root.right) 8\t} 9} é€’å½’éå† 1/** 2 * Definition for a binary tree node. 3 * type TreeNode struct { 4 * Val int 5 * Left *TreeNode 6 * Right *TreeNode 7 * } 8 */ 9func inorderTraversal(root *TreeNode) []int { 10 11 tmp := make([]int,0,0) 12 if root == nil{ 13 return tmp 14 } 15 if root.Left != nil{ 16 tmp = append(tmp,inorderTraversal(root.Left)... ) 17 } 18 tmp = append(tmp, root.Val) 19 if root.Right != nil{ 20 tmp = append(tmp,inorderTraversal(root.Right)... ) 21 } 22 return tmp 23} éé€’å½’éå† å¹¿åº¦ä¼˜å…ˆéå†ï¼ˆå±‚åºéå†ï¼‰ ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæœ€å¤§å †ï¼Œæœ€å°å †ï¼‰ å¹³è¡¡äºŒå‰æ ‘ å¹³è¡¡æ ‘ï¼Œå³å¹³è¡¡äºŒå‰æ ‘ï¼ˆBalanced Binary Treeï¼‰ï¼Œå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼šå®ƒæ˜¯ä¸€æ£µç©ºæ ‘æˆ–å®ƒçš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ï¼Œå¹¶ä¸”å·¦å³ä¸¤ä¸ªå­æ ‘éƒ½æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚ å¹³è¡¡äºŒå‰æ ‘çš„å¸¸ç”¨ç®—æ³•æœ‰çº¢é»‘æ ‘ã€AVLã€Treapã€ä¼¸å±•æ ‘ã€SBTç­‰ã€‚\nå¯¹ä¸€æ£µæŸ¥æ‰¾æ ‘ï¼ˆsearch treeï¼‰è¿›è¡ŒæŸ¥è¯¢/æ–°å¢/åˆ é™¤ ç­‰åŠ¨ä½œ, æ‰€èŠ±çš„æ—¶é—´ä¸æ ‘çš„é«˜åº¦h æˆæ¯”ä¾‹, å¹¶ä¸ä¸æ ‘çš„å®¹é‡ n æˆæ¯”ä¾‹ã€‚å¦‚æœå¯ä»¥è®©æ ‘ç»´æŒçŸ®çŸ®èƒ–èƒ–çš„å¥½èº«æ, ä¹Ÿå°±æ˜¯è®©hç»´æŒåœ¨O(lg n)å·¦å³, å®Œæˆä¸Šè¿°å·¥ä½œå°±å¾ˆçœæ—¶é—´ã€‚èƒ½å¤Ÿä¸€ç›´ç»´æŒå¥½èº«æ, ä¸å› æ–°å¢åˆ é™¤è€Œé•¿æ­ªçš„æœå¯»æ ‘, å«åšbalanced search treeï¼ˆå¹³è¡¡æ ‘ï¼‰ã€‚ å¹³è¡¡æ ‘æœ‰å¾ˆå¤šç§, å…¶ä¸­æœ‰å‡ ç±»æ ‘ç»´æŒå¹³è¡¡çš„æ–¹æ³•ã€‚\näºŒå‰å·¦æ—‹ äºŒå‰å³æ—‹ çº¢é»‘æ ‘ AVL æ ‘çš„é¢è¯•é¢˜ä¸€èˆ¬éƒ½æ˜¯é€’å½’ï¼Œä¸ºä»€ä¹ˆ\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/06_ds_tree/","summary":"å•é“¾è¡¨çš„æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦æ˜¯O(n)\nè·³è¡¨\næ ‘\nå›¾\nLinked List æ˜¯ç‰¹æ®ŠåŒ–çš„Tree\nTree æ˜¯ç‰¹æ®ŠåŒ–çš„å›¾\næ–æ³¢é‚£å¥‘ï¼Œ çŠ¶æ€æ ‘ï¼Œé€’å½’æ ‘\nçŠ¶æ€æ ‘ç©ºé—´\nå†³ç­–æ ‘ç©ºé—´\näºŒå‰æ ‘ æ»¡äºŒå‰æ ‘ï¼šä¸€ä¸ªäºŒå‰æ ‘çš„æ‰€æœ‰éå¶å­èŠ‚ç‚¹éƒ½å­˜åœ¨å·¦å³å­©å­ï¼Œå¹¶ä¸”æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚çº§ä¸Šã€‚\nå®Œå…¨äºŒå‰æ ‘:\nå­˜å‚¨ç»“æ„:\né“¾å¼å­˜å‚¨\n1// golang 2type Node struct { 3\tData int64 4\tLeftNode *Node 5\tRightNode *Node 6} // C++ struct TreeNode{ int val; TreeNode *left; TreeNode *right; TreeNode(int x): val(x), left(NULL), right(NULL){} }\n1 23. ```java 3public class TreeNode{ 4 public int val; 5 public TreeNode left,right; 6 public TreeNode(int val){ 7\tthis.","tags":null,"title":"ã€Œç®—æ³•ä¸æ•°æ®ç»“æ„ã€Tree"},{"categories":null,"contents":"ç»„åˆ 1import java.util.*; 2 3public class Mains{ 4 public static List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; resultss = new ArrayList\u0026lt;\u0026gt;(); 5 6 public void combinations(List\u0026lt;Integer\u0026gt; selected, List\u0026lt;Integer\u0026gt; data, int num){ 7 if(num == 0){ 8 resultss.add(new ArrayList\u0026lt;Integer\u0026gt;(selected)); 9 return; 10 } 11 if(data.size() == 0 ){ 12 System.out.print(\u0026#34;\u0026#34;); 13 return; 14 } 15 selected.add(data.get(0)); 16 combinations(selected, data.subList(1, data.size()), num -1); 17 selected.remove(data.get(0)); 18 combinations(selected, data.subList(1, data.size()), num ); 19 } 20 public static void main(String[] args) { 21 Mains combin = new Mains(); 22 int[] nums = new int[]{1,2,3,4,5}; 23 combin.combinations(new ArrayList\u0026lt;Integer\u0026gt;(),Arrays.asList(1,2,3,4),3); 24 for (List\u0026lt;Integer\u0026gt; res : Mains.resultss) { 25 System.out.println(res.toString()); 26 } 27 } 28} 29 30/* 31Output 32 33[1, 2, 3] 34[1, 2, 4] 35[1, 3, 4] 36[2, 3, 4] 37 38*/ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/ds_combine/","summary":"ç»„åˆ 1import java.util.*; 2 3public class Mains{ 4 public static List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; resultss = new ArrayList\u0026lt;\u0026gt;(); 5 6 public void combinations(List\u0026lt;Integer\u0026gt; selected, List\u0026lt;Integer\u0026gt; data, int num){ 7 if(num == 0){ 8 resultss.add(new ArrayList\u0026lt;Integer\u0026gt;(selected)); 9 return; 10 } 11 if(data.size() == 0 ){ 12 System.out.print(\u0026#34;\u0026#34;); 13 return; 14 } 15 selected.add(data.get(0)); 16 combinations(selected, data.subList(1, data.size()), num -1); 17 selected.remove(data.get(0)); 18 combinations(selected, data.subList(1, data.size()), num ); 19 } 20 public static void main(String[] args) { 21 Mains combin = new Mains(); 22 int[] nums = new int[]{1,2,3,4,5}; 23 combin.","tags":null,"title":"ã€Œç®—æ³•ä¸æ•°æ®ç»“æ„ã€æ’åˆ—ç»„åˆ"},{"categories":null,"contents":"æ’åºç®—æ³• æœ¯è¯­è¯´æ˜ ç¨³å®šï¼šå¦‚æœaåŸæœ¬åœ¨bå‰é¢ï¼Œè€Œa=bï¼Œæ’åºä¹‹åaä»ç„¶åœ¨bçš„å‰é¢ï¼›\nä¸ç¨³å®šï¼šå¦‚æœaåŸæœ¬åœ¨bçš„å‰é¢ï¼Œè€Œa=bï¼Œæ’åºä¹‹åaå¯èƒ½ä¼šå‡ºç°åœ¨bçš„åé¢ï¼›\nå†…éƒ¨æ’åºï¼šå¾…æ’åºçš„æ•°æ®å¯ä»¥å…¨éƒ¨æ”¾å…¥å†…å­˜ä¸­ï¼›\nå¤–éƒ¨æ’åºï¼šå¾…æ’åºæ•°æ®çš„æ•°é‡å¾ˆå¤§ï¼Œä»¥è‡´äºå†…å­˜ä¸èƒ½ä¸€æ¬¡å®¹çº³å…¨éƒ¨è®°å½•ï¼Œæ‰€ä»¥åœ¨æ’åºè¿‡ç¨‹ä¸­éœ€è¦å¯¹å¤–å­˜(ç£ç›˜)è¿›è¡Œè®¿é—®ï¼›\næ—¶é—´å¤æ‚åº¦ï¼š ä¸€ä¸ªç®—æ³•æ‰§è¡Œæ‰€è€—è´¹çš„æ—¶é—´ã€‚\nç©ºé—´å¤æ‚åº¦ï¼šè¿è¡Œå®Œä¸€ä¸ªç¨‹åºæ‰€éœ€å†…å­˜çš„å¤§å°ã€‚\næ’åºç®—æ³•æ€»ç»“ æ’åºç®—æ³• å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ æ’åºæ–¹å¼ ç¨³å®šæ€§ å†’æ³¡æ’åº O(n^2^) O(n) O(n^2^) O(1) In-place ç¨³å®š é€‰æ‹©æ’åº O(n^2^) O(n^2^) O(n^2^) O(1) In-place ä¸ç¨³å®š æ’å…¥æ’åº O(n^2^) O(n) O(n^2^) O(1) In-place ç¨³å®š å¸Œå°”æ’åº O(n logn) O(nlog^2^n) O(nlog^2^n) O(1) In-place ä¸ç¨³å®š å½’å¹¶æ’åº O(n logn) O(n logn) O(n logn) O(n) Out-place ç¨³å®š å¿«é€Ÿæ’åº O(n logn) O(n logn) O(n^2^) O(n logn) In-place ä¸ç¨³å®š å †æ’åº O(n logn) O(n logn) O(n logn) O(1) In-place ä¸ç¨³å®š è®¡æ•°æ’åº O(n+k) O(n+k) O(n+k) O(k) Out-place ç¨³å®š æ¡¶æ’åº O(n+k) O(n+k) O(n^2^) O(n+k) Out-place ç¨³å®š åŸºæ•°æ’åº O(n*k) O(n*k) O(n*k) O(n+k) Out-place ç¨³å®š n:æ•°æ®è§„æ¨¡ï¼›k:\u0026ldquo;æ¡¶\u0026quot;çš„ä¸ªæ•°ï¼›n-place:å ç”¨å¸¸æ•°å†…å­˜ï¼Œä¸å ç”¨é¢å¤–å†…å­˜ï¼›Out-place:å ç”¨é¢å¤–å†…å­˜\nç®—æ³•åˆ†ç±» æ—¶é—´åˆ†ç±»\néçº¿æ€§æ—¶é—´æ¯”è¾ƒç±»æ’åºï¼šé€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œç”±äºå…¶æ—¶é—´å¤æ‚åº¦ä¸èƒ½çªç ´O(nlogn)ï¼Œå› æ­¤ç§°ä¸ºéçº¿æ€§æ—¶é—´æ¯”è¾ƒç±»æ’åºã€‚ çº¿æ€§æ—¶é—´éæ¯”è¾ƒç±»æ’åºï¼šä¸é€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œå®ƒå¯ä»¥çªç ´åŸºäºæ¯”è¾ƒæ’åºçš„æ—¶é—´ä¸‹ç•Œï¼Œä»¥çº¿æ€§æ—¶é—´è¿è¡Œï¼Œå› æ­¤ç§°ä¸ºçº¿æ€§æ—¶é—´éæ¯”è¾ƒç±»æ’åºã€‚ æ¯”è¾ƒåˆ†ç±»\næ¯”è¾ƒï¼šå¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å †æ’åºã€å†’æ³¡æ’åº åœ¨æ’åºçš„æœ€ç»ˆç»“æœé‡Œï¼Œå…ƒç´ ä¹‹é—´çš„æ¬¡åºä¾èµ–äºå®ƒä»¬ä¹‹é—´çš„æ¯”è¾ƒã€‚æ¯ä¸ªæ•°éƒ½å¿…é¡»å’Œå…¶ä»–æ•°è¿›è¡Œæ¯”è¾ƒï¼Œæ‰èƒ½ç¡®å®šè‡ªå·±çš„ä½ç½®ã€‚\néæ¯”è¾ƒï¼šè®¡æ•°æ’åºã€åŸºæ•°æ’åºã€æ¡¶æ’åº éæ¯”è¾ƒæ’åºæ˜¯é€šè¿‡ç¡®å®šæ¯ä¸ªå…ƒç´ ä¹‹å‰ï¼Œåº”è¯¥æœ‰å¤šå°‘ä¸ªå…ƒç´ æ¥æ’åºã€‚é’ˆå¯¹æ•°ç»„arrï¼Œè®¡ç®—arrä¹‹å‰æœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼Œåˆ™å”¯ä¸€ç¡®å®šäº†arråœ¨æ’åºåæ•°ç»„ä¸­çš„ä½ç½®ã€‚\néçº¿æ€§æ—¶é—´æ¯”è¾ƒç±»æ’åº\näº¤æ¢æ’åº\nå†’æ³¡æ’åº å¿«é€Ÿæ’ æ’å…¥æ’åº\nç®€å•æ’å…¥æ’åº å¸Œå°”æ’åº é€‰æ‹©æ’åº\nç®€å•é€‰æ‹©æ’åº å †æ’åº å½’å¹¶æ’åº\näºŒè·¯å½’å¹¶æ’åº\nå¤šè·¯å½’å¹¶æ’åº\nçº¿æ€§æ—¶é—´éæ¯”è¾ƒç±»æ’åº\nè®¡æ•°æ’åº æ¡¶æ’åº åŸºæ•°æ’åº å†’æ³¡æ’åº (Bubble Sort) å†’æ³¡æ’åºæ˜¯ä¸€ç§ç®€å•çš„æ’åºç®—æ³•ã€‚å®ƒé‡å¤åœ°èµ°è®¿è¿‡è¦æ’åºçš„æ•°åˆ—ï¼Œä¸€æ¬¡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœå®ƒä»¬çš„é¡ºåºé”™è¯¯å°±æŠŠå®ƒä»¬äº¤æ¢è¿‡æ¥ã€‚èµ°è®¿æ•°åˆ—çš„å·¥ä½œæ˜¯é‡å¤åœ°è¿›è¡Œç›´åˆ°æ²¡æœ‰å†éœ€è¦äº¤æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥æ•°åˆ—å·²ç»æ’åºå®Œæˆã€‚è¿™ä¸ªç®—æ³•çš„åå­—ç”±æ¥æ˜¯å› ä¸ºè¶Šå°çš„å…ƒç´ ä¼šç»ç”±äº¤æ¢æ…¢æ…¢â€œæµ®â€åˆ°æ•°åˆ—çš„é¡¶ç«¯ã€‚\nç®—æ³•æè¿° æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢å®ƒä»¬ä¸¤ä¸ªï¼› å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ï¼Œè¿™æ ·åœ¨æœ€åçš„å…ƒç´ åº”è¯¥ä¼šæ˜¯æœ€å¤§çš„æ•°ï¼› é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼› é‡å¤æ­¥éª¤1~3ï¼Œç›´åˆ°æ’åºå®Œæˆã€‚ åŠ¨å›¾æ¼”ç¤º ä»£ç å®ç° 1public class BubbleSort { 2 public static void bubbleSort(int[] arr) { 3 int n = arr.length; 4 int tmp; 5 for (int i = 0; i \u0026lt; n - 1; i++) { 6 for (int j = 0; j \u0026lt; n - i - 1; j++) { 7 if (arr[j] \u0026gt; arr[j + 1]) { // ç›¸é‚»å…ƒç´ ä¸¤ä¸¤å¯¹æ¯” 8 tmp = arr[j]; // å…ƒç´ äº¤æ¢ 9 arr[j] = arr[j + 1]; 10 arr[j + 1] = tmp; 11 } 12 } 13 } 14 } 15 16 public static void main(String[] args) { 17 int[] arr = { 6, 1, 2, 7, 9, 3, 4, 5, 10, 8 }; 18 bubbleSort(arr); 19 for (int i = 0; i \u0026lt; arr.length; i++) { 20 System.out.print(arr[i] + \u0026#34; \u0026#34;); 21 } 22 } 23} 24 25/* Output 261 2 3 4 5 6 7 8 9 10 27*/ é€‰æ‹©æ’åºï¼ˆSelection Sortï¼‰ é€‰æ‹©æ’åº(Selection-sort)æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒçš„å·¥ä½œåŸç†ï¼šé¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œç„¶åï¼Œå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚\nç®—æ³•æè¿° nä¸ªè®°å½•çš„ç›´æ¥é€‰æ‹©æ’åºå¯ç»è¿‡n-1è¶Ÿç›´æ¥é€‰æ‹©æ’åºå¾—åˆ°æœ‰åºç»“æœã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š\nåˆå§‹çŠ¶æ€ï¼šæ— åºåŒºä¸ºR[1..n]ï¼Œæœ‰åºåŒºä¸ºç©ºï¼› ç¬¬iè¶Ÿæ’åº(i=1,2,3â€¦n-1)å¼€å§‹æ—¶ï¼Œå½“å‰æœ‰åºåŒºå’Œæ— åºåŒºåˆ†åˆ«ä¸ºR[1..i-1]å’ŒR(i..nï¼‰ã€‚è¯¥è¶Ÿæ’åºä»å½“å‰æ— åºåŒºä¸­-é€‰å‡ºå…³é”®å­—æœ€å°çš„è®°å½• R[k]ï¼Œå°†å®ƒä¸æ— åºåŒºçš„ç¬¬1ä¸ªè®°å½•Räº¤æ¢ï¼Œä½¿R[1..i]å’ŒR[i+1..n)åˆ†åˆ«å˜ä¸ºè®°å½•ä¸ªæ•°å¢åŠ 1ä¸ªçš„æ–°æœ‰åºåŒºå’Œè®°å½•ä¸ªæ•°å‡å°‘1ä¸ªçš„æ–°æ— åºåŒºï¼› n-1è¶Ÿç»“æŸï¼Œæ•°ç»„æœ‰åºåŒ–äº†ã€‚ åŠ¨å›¾æ¼”ç¤º ä»£ç å®ç° 1public class SelectionSort { 2 public static void selectionSort(int[] arr) { 3 int n = arr.length; 4 int tmp, minIndex; 5 for (int i = 0; i \u0026lt; n - 1; i++) { 6 minIndex = i; 7 for (int j = i + 1; j \u0026lt; n; j++) { 8 if (arr[minIndex] \u0026gt; arr[j]) { 9 minIndex = j; 10 } 11 } 12 tmp = arr[i]; 13 arr[i] = arr[minIndex]; 14 arr[minIndex] = tmp; 15 } 16 } 17 18 public static void main(String[] args) { 19 int[] arr = { 6, 1, 2, 7, 9, 3, 4, 5, 10, 8 }; 20 selectionSort(arr); 21 for (int i = 0; i \u0026lt; arr.length; i++) { 22 System.out.print(arr[i] + \u0026#34;, \u0026#34;); 23 } 24 } 25} æ’å…¥æ’åºï¼ˆInsertion Sortï¼‰ æ’å…¥æ’åºï¼ˆInsertion-Sortï¼‰çš„ç®—æ³•æè¿°æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡æ„å»ºæœ‰åºåºåˆ—ï¼Œå¯¹äºæœªæ’åºæ•°æ®ï¼Œåœ¨å·²æ’åºåºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼Œæ‰¾åˆ°ç›¸åº”ä½ç½®å¹¶æ’å…¥ã€‚\nç®—æ³•æè¿° ä¸€èˆ¬æ¥è¯´ï¼Œæ’å…¥æ’åºéƒ½é‡‡ç”¨in-placeåœ¨æ•°ç»„ä¸Šå®ç°ã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š\nä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åºï¼› å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼› å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®ï¼› é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®ï¼› å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®åï¼› é‡å¤æ­¥éª¤2~5ã€‚ åŠ¨å›¾æ¼”ç¤º ä»£ç å®ç° 1public class InsertionSort { 2 public static void insertionSort(int[] arr) { 3 int n = arr.length; 4 int preIndex, current; 5 for (int i = 1; i \u0026lt; n; i++) { 6 preIndex = i - 1; 7 current = arr[i]; 8 while (preIndex \u0026gt;= 0 \u0026amp;\u0026amp; current \u0026lt; arr[preIndex]) { 9 arr[preIndex + 1] = arr[preIndex]; 10 preIndex--; 11 } 12 arr[preIndex + 1] = current; 13 } 14 } 15 16 public static void main(String[] args) { 17 int[] arr = { 6, 1, 2, 7, 9, 3, 4, 5, 10, 8 }; 18 insertionSort(arr); 19 for (int i = 0; i \u0026lt; arr.length; i++) { 20 System.out.print(arr[i] + \u0026#34; \u0026#34;); 21 } 22 } 23} ç®—æ³•åˆ†æ æ’å…¥æ’åºåœ¨å®ç°ä¸Šï¼Œé€šå¸¸é‡‡ç”¨in-placeæ’åºï¼ˆå³åªéœ€ç”¨åˆ°O(1)çš„é¢å¤–ç©ºé—´çš„æ’åºï¼‰ï¼Œå› è€Œåœ¨ä»åå‘å‰æ‰«æè¿‡ç¨‹ä¸­ï¼Œéœ€è¦åå¤æŠŠå·²æ’åºå…ƒç´ é€æ­¥å‘åæŒªä½ï¼Œä¸ºæœ€æ–°å…ƒç´ æä¾›æ’å…¥ç©ºé—´ã€‚\nå¸Œå°”æ’åºï¼ˆShell Sortï¼‰ 1959å¹´Shellå‘æ˜ï¼Œç¬¬ä¸€ä¸ªçªç ´O(n2)çš„æ’åºç®—æ³•ï¼Œæ˜¯ç®€å•æ’å…¥æ’åºçš„æ”¹è¿›ç‰ˆã€‚å®ƒä¸æ’å…¥æ’åºçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä¼šä¼˜å…ˆæ¯”è¾ƒè·ç¦»è¾ƒè¿œçš„å…ƒç´ ã€‚å¸Œå°”æ’åºåˆå«ç¼©å°å¢é‡æ’åºã€‚\nç®—æ³•æè¿° å…ˆå°†æ•´ä¸ªå¾…æ’åºçš„è®°å½•åºåˆ—åˆ†å‰²æˆä¸ºè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå…·ä½“ç®—æ³•æè¿°ï¼š\né€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—t1ï¼Œt2ï¼Œâ€¦ï¼Œtkï¼Œå…¶ä¸­ti\u0026gt;tjï¼Œtk=1ï¼› æŒ‰å¢é‡åºåˆ—ä¸ªæ•°kï¼Œå¯¹åºåˆ—è¿›è¡Œk è¶Ÿæ’åºï¼› æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸ºm çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»…å¢é‡å› å­ä¸º1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚ åŠ¨å›¾æ¼”ç¤º ä»£ç å®ç° 1public class ShellSort { 2 public static void shellSort(int[] arr) { 3 int n = arr.length; 4 for (int gap = Math.floorDiv(n, 2); gap \u0026gt; 0; gap = Math.floorDiv(gap, 2)) { 5 // æ³¨æ„ï¼šè¿™é‡Œå’ŒåŠ¨å›¾æ¼”ç¤ºçš„ä¸ä¸€æ ·ï¼ŒåŠ¨å›¾æ˜¯åˆ†ç»„æ‰§è¡Œï¼Œå®é™…æ“ä½œæ˜¯å¤šä¸ªåˆ†ç»„äº¤æ›¿æ‰§è¡Œ 6 for (int i = gap; i \u0026lt; n; i++) { 7 int j = i; 8 int current = arr[i]; 9 while (j - gap \u0026gt;= 0 \u0026amp;\u0026amp; current \u0026lt; arr[j - gap]) { 10 arr[j] = arr[j - gap]; 11 j = j - gap; 12 } 13 arr[j] = current; 14 } 15 } 16 } 17 18 public static void main(String[] args) { 19 int[] arr = { 6, 1, 2, 7, 9, 3, 4, 5, 10, 8 }; 20 shellSort(arr); 21 for (int i = 0; i \u0026lt; arr.length; i++) { 22 System.out.print(arr[i] + \u0026#34; \u0026#34;); 23 } 24 } 25} 26/* Output 271 2 3 4 5 6 7 8 9 10 28*/ ç®—æ³•åˆ†æ å¸Œå°”æ’åºçš„æ ¸å¿ƒåœ¨äºé—´éš”åºåˆ—çš„è®¾å®šã€‚æ—¢å¯ä»¥æå‰è®¾å®šå¥½é—´éš”åºåˆ—ï¼Œä¹Ÿå¯ä»¥åŠ¨æ€çš„å®šä¹‰é—´éš”åºåˆ—ã€‚åŠ¨æ€å®šä¹‰é—´éš”åºåˆ—çš„ç®—æ³•æ˜¯ã€Šç®—æ³•ï¼ˆç¬¬4ç‰ˆï¼‰ã€‹çš„åˆè‘—è€…Robert Sedgewickæå‡ºçš„ã€‚ã€€å½’å¹¶æ’åºï¼ˆMerge Sortï¼‰ å½’å¹¶æ’åºæ˜¯å»ºç«‹åœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•ã€‚è¯¥ç®—æ³•æ˜¯é‡‡ç”¨åˆ†æ²»æ³•ï¼ˆDivide and Conquerï¼‰çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨ã€‚å°†å·²æœ‰åºçš„å­åºåˆ—åˆå¹¶ï¼Œå¾—åˆ°å®Œå…¨æœ‰åºçš„åºåˆ—ï¼›å³å…ˆä½¿æ¯ä¸ªå­åºåˆ—æœ‰åºï¼Œå†ä½¿å­åºåˆ—æ®µé—´æœ‰åºã€‚è‹¥å°†ä¸¤ä¸ªæœ‰åºè¡¨åˆå¹¶æˆä¸€ä¸ªæœ‰åºè¡¨ï¼Œç§°ä¸º2-è·¯å½’å¹¶ã€‚\nç®—æ³•æè¿° æŠŠé•¿åº¦ä¸ºnçš„è¾“å…¥åºåˆ—åˆ†æˆä¸¤ä¸ªé•¿åº¦ä¸ºn/2çš„å­åºåˆ—ï¼› å¯¹è¿™ä¸¤ä¸ªå­åºåˆ—åˆ†åˆ«é‡‡ç”¨å½’å¹¶æ’åºï¼› å°†ä¸¤ä¸ªæ’åºå¥½çš„å­åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ€ç»ˆçš„æ’åºåºåˆ—ã€‚ åŠ¨å›¾æ¼”ç¤º ä»£ç å®ç° 1import java.util.Arrays; 2 3public class MergeSort { 4 public static void main(String[] args) { 5 int[] arr = { 9, 8, 7, 6, 5, 4, 3, 2, 1 }; 6 sort(arr); 7 System.out.println(Arrays.toString(arr)); 8 } 9 10 public static void sort(int []arr){ 11 int[] temp = new int[arr.length];//åœ¨æ’åºå‰ï¼Œå…ˆå»ºå¥½ä¸€ä¸ªé•¿åº¦ç­‰äºåŸæ•°ç»„é•¿åº¦çš„ä¸´æ—¶æ•°ç»„ï¼Œé¿å…é€’å½’ä¸­é¢‘ç¹å¼€è¾Ÿç©ºé—´ 12 sort(arr,0,arr.length-1,temp); 13 } 14 15 private static void sort(int[] arr, int left, int right, int[] temp) { 16 if (left \u0026lt; right) { 17 int mid = (left + right) / 2; 18 sort(arr, left, mid, temp);// å·¦è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å·¦å­åºåˆ—æœ‰åº 19 sort(arr, mid + 1, right, temp);// å³è¾¹å½’å¹¶æ’åºï¼Œä½¿å¾—å³å­åºåˆ—æœ‰åº 20 merge(arr, left, mid, right, temp);// å°†ä¸¤ä¸ªæœ‰åºå­æ•°ç»„åˆå¹¶æ“ä½œ 21 } 22 } 23 24 private static void merge(int[] arr, int left, int mid, int right, int[] temp) { 25 int i = left;// å·¦åºåˆ—æŒ‡é’ˆ 26 int j = mid + 1;// å³åºåˆ—æŒ‡é’ˆ 27 int t = 0;// ä¸´æ—¶æ•°ç»„æŒ‡é’ˆ 28 while (i \u0026lt;= mid \u0026amp;\u0026amp; j \u0026lt;= right) { 29 if (arr[i] \u0026lt;= arr[j]) { 30 temp[t++] = arr[i++]; 31 } else { 32 temp[t++] = arr[j++]; 33 } 34 } 35 while (i \u0026lt;= mid) {// å°†å·¦è¾¹å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­ 36 temp[t++] = arr[i++]; 37 } 38 while (j \u0026lt;= right) {// å°†å³åºåˆ—å‰©ä½™å…ƒç´ å¡«å……è¿›tempä¸­ 39 temp[t++] = arr[j++]; 40 } 41 t = 0; 42 // å°†tempä¸­çš„å…ƒç´ å…¨éƒ¨æ‹·è´åˆ°åŸæ•°ç»„ä¸­ 43 while (left \u0026lt;= right) { 44 arr[left++] = temp[t++]; 45 } 46 } 47} ç®—æ³•åˆ†æ å½’å¹¶æ’åºæ˜¯ä¸€ç§ç¨³å®šçš„æ’åºæ–¹æ³•ã€‚å’Œé€‰æ‹©æ’åºä¸€æ ·ï¼Œå½’å¹¶æ’åºçš„æ€§èƒ½ä¸å—è¾“å…¥æ•°æ®çš„å½±å“ï¼Œä½†è¡¨ç°æ¯”é€‰æ‹©æ’åºå¥½çš„å¤šï¼Œå› ä¸ºå§‹ç»ˆéƒ½æ˜¯O(nlognï¼‰çš„æ—¶é—´å¤æ‚åº¦ã€‚ä»£ä»·æ˜¯éœ€è¦é¢å¤–çš„å†…å­˜ç©ºé—´ã€‚\nå¿«é€Ÿæ’åºï¼ˆQuick Sortï¼‰ å¿«é€Ÿæ’åºçš„åŸºæœ¬æ€æƒ³ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†å¾…æ’è®°å½•åˆ†éš”æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†è®°å½•çš„å…³é”®å­—å‡æ¯”å¦ä¸€éƒ¨åˆ†çš„å…³é”®å­—å°ï¼Œåˆ™å¯åˆ†åˆ«å¯¹è¿™ä¸¤éƒ¨åˆ†è®°å½•ç»§ç»­è¿›è¡Œæ’åºï¼Œä»¥è¾¾åˆ°æ•´ä¸ªåºåˆ—æœ‰åºã€‚\nç®—æ³•æè¿° å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»æ³•æ¥æŠŠä¸€ä¸ªä¸²ï¼ˆlistï¼‰åˆ†ä¸ºä¸¤ä¸ªå­ä¸²ï¼ˆsub-listsï¼‰ã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š\nä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º â€œåŸºå‡†â€ï¼ˆpivotï¼‰ï¼› é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œï¼› é€’å½’åœ°ï¼ˆrecursiveï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºã€‚ åŠ¨å›¾æ¼”ç¤º ä»£ç å®ç° 1public class QuickSort { 2 public static void quickSort(int[] arr, int low, int high) { 3 int i, j, temp, t; 4 if (low \u0026gt; high) { 5 return; 6 } 7 i = low; 8 j = high; 9 // tempå°±æ˜¯åŸºå‡†ä½ 10 temp = arr[low]; 11 while (i \u0026lt; j) { 12 // å…ˆçœ‹å³è¾¹ï¼Œä¾æ¬¡å¾€å·¦é€’å‡ 13 while (temp \u0026lt;= arr[j] \u0026amp;\u0026amp; i \u0026lt; j) { 14 j--; 15 } 16 // å†çœ‹å·¦è¾¹ï¼Œä¾æ¬¡å¾€å³é€’å¢ 17 while (temp \u0026gt;= arr[i] \u0026amp;\u0026amp; i \u0026lt; j) { 18 i++; 19 } 20 // å¦‚æœæ»¡è¶³æ¡ä»¶åˆ™äº¤æ¢ 21 if (i \u0026lt; j) { 22 t = arr[j]; 23 arr[j] = arr[i]; 24 arr[i] = t; 25 } 26 27 } 28 // æœ€åå°†åŸºå‡†ä¸ºä¸iå’Œjç›¸ç­‰ä½ç½®çš„æ•°å­—äº¤æ¢ 29 arr[low] = arr[i]; 30 arr[i] = temp; 31 // é€’å½’è°ƒç”¨å·¦åŠæ•°ç»„ 32 quickSort(arr, low, j - 1); 33 // é€’å½’è°ƒç”¨å³åŠæ•°ç»„ 34 quickSort(arr, j + 1, high); 35 } 36 37 public static void main(String[] args) { 38 int[] arr = { 6, 1, 2, 7, 9, 3, 4, 5, 10, 8 }; 39 quickSort(arr, 0, arr.length - 1); 40 for (int i = 0; i \u0026lt; arr.length; i++) { 41 System.out.print(arr[i] + \u0026#34; \u0026#34;); 42 } 43 } 44} å †æ’åºï¼ˆHeap Sortï¼‰ å †æ’åºï¼ˆHeapsortï¼‰æ˜¯æŒ‡åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„æ‰€è®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•ã€‚å †ç§¯æ˜¯ä¸€ä¸ªè¿‘ä¼¼å®Œå…¨äºŒå‰æ ‘çš„ç»“æ„ï¼Œå¹¶åŒæ—¶æ»¡è¶³å †ç§¯çš„æ€§è´¨ï¼šå³å­ç»“ç‚¹çš„é”®å€¼æˆ–ç´¢å¼•æ€»æ˜¯å°äºï¼ˆæˆ–è€…å¤§äºï¼‰å®ƒçš„çˆ¶èŠ‚ç‚¹ã€‚\nç®—æ³•æè¿° å°†åˆå§‹å¾…æ’åºå…³é”®å­—åºåˆ—(R1,R2â€¦.Rn)æ„å»ºæˆå¤§é¡¶å †ï¼Œæ­¤å †ä¸ºåˆå§‹çš„æ— åºåŒºï¼› å°†å †é¡¶å…ƒç´ R[1]ä¸æœ€åä¸€ä¸ªå…ƒç´ R[n]äº¤æ¢ï¼Œæ­¤æ—¶å¾—åˆ°æ–°çš„æ— åºåŒº(R1,R2,â€¦â€¦Rn-1)å’Œæ–°çš„æœ‰åºåŒº(Rn),ä¸”æ»¡è¶³R[1,2â€¦n-1]\u0026lt;=R[n]ï¼› ç”±äºäº¤æ¢åæ–°çš„å †é¡¶R[1]å¯èƒ½è¿åå †çš„æ€§è´¨ï¼Œå› æ­¤éœ€è¦å¯¹å½“å‰æ— åºåŒº(R1,R2,â€¦â€¦Rn-1)è°ƒæ•´ä¸ºæ–°å †ï¼Œç„¶åå†æ¬¡å°†R[1]ä¸æ— åºåŒºæœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œå¾—åˆ°æ–°çš„æ— åºåŒº(R1,R2â€¦.Rn-2)å’Œæ–°çš„æœ‰åºåŒº(Rn-1,Rn)ã€‚ä¸æ–­é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æœ‰åºåŒºçš„å…ƒç´ ä¸ªæ•°ä¸ºn-1ï¼Œåˆ™æ•´ä¸ªæ’åºè¿‡ç¨‹å®Œæˆã€‚ åŠ¨å›¾æ¼”ç¤º ä»£ç å®ç° è®¡æ•°æ’åºï¼ˆCounting Sortï¼‰ è®¡æ•°æ’åºä¸æ˜¯åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•ï¼Œå…¶æ ¸å¿ƒåœ¨äºå°†è¾“å…¥çš„æ•°æ®å€¼è½¬åŒ–ä¸ºé”®å­˜å‚¨åœ¨é¢å¤–å¼€è¾Ÿçš„æ•°ç»„ç©ºé—´ä¸­ã€‚ ä½œä¸ºä¸€ç§çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„æ’åºï¼Œè®¡æ•°æ’åºè¦æ±‚è¾“å…¥çš„æ•°æ®å¿…é¡»æ˜¯æœ‰ç¡®å®šèŒƒå›´çš„æ•´æ•°ã€‚\nç®—æ³•æè¿° æ‰¾å‡ºå¾…æ’åºçš„æ•°ç»„ä¸­æœ€å¤§å’Œæœ€å°çš„å…ƒç´ ï¼› ç»Ÿè®¡æ•°ç»„ä¸­æ¯ä¸ªå€¼ä¸ºiçš„å…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼Œå­˜å…¥æ•°ç»„Cçš„ç¬¬ié¡¹ï¼› å¯¹æ‰€æœ‰çš„è®¡æ•°ç´¯åŠ ï¼ˆä»Cä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯ä¸€é¡¹å’Œå‰ä¸€é¡¹ç›¸åŠ ï¼‰ï¼› åå‘å¡«å……ç›®æ ‡æ•°ç»„ï¼šå°†æ¯ä¸ªå…ƒç´ iæ”¾åœ¨æ–°æ•°ç»„çš„ç¬¬C(i)é¡¹ï¼Œæ¯æ”¾ä¸€ä¸ªå…ƒç´ å°±å°†C(i)å‡å»1ã€‚ åŠ¨å›¾æ¼”ç¤º ç®—æ³•åˆ†æ è®¡æ•°æ’åºæ˜¯ä¸€ä¸ªç¨³å®šçš„æ’åºç®—æ³•ã€‚å½“è¾“å…¥çš„å…ƒç´ æ˜¯ n ä¸ª 0åˆ° k ä¹‹é—´çš„æ•´æ•°æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n+k)ï¼Œç©ºé—´å¤æ‚åº¦ä¹Ÿæ˜¯O(n+k)ï¼Œå…¶æ’åºé€Ÿåº¦å¿«äºä»»ä½•æ¯”è¾ƒæ’åºç®—æ³•ã€‚å½“kä¸æ˜¯å¾ˆå¤§å¹¶ä¸”åºåˆ—æ¯”è¾ƒé›†ä¸­æ—¶ï¼Œè®¡æ•°æ’åºæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ•ˆçš„æ’åºç®—æ³•ã€‚\n##æ¡¶æ’åºï¼ˆBucket Sortï¼‰\næ¡¶æ’åºæ˜¯è®¡æ•°æ’åºçš„å‡çº§ç‰ˆã€‚å®ƒåˆ©ç”¨äº†å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œé«˜æ•ˆä¸å¦çš„å…³é”®å°±åœ¨äºè¿™ä¸ªæ˜ å°„å‡½æ•°çš„ç¡®å®šã€‚æ¡¶æ’åº (Bucket sort)çš„å·¥ä½œçš„åŸç†ï¼šå‡è®¾è¾“å…¥æ•°æ®æœä»å‡åŒ€åˆ†å¸ƒï¼Œå°†æ•°æ®åˆ†åˆ°æœ‰é™æ•°é‡çš„æ¡¶é‡Œï¼Œæ¯ä¸ªæ¡¶å†åˆ†åˆ«æ’åºï¼ˆæœ‰å¯èƒ½å†ä½¿ç”¨åˆ«çš„æ’åºç®—æ³•æˆ–æ˜¯ä»¥é€’å½’æ–¹å¼ç»§ç»­ä½¿ç”¨æ¡¶æ’åºè¿›è¡Œæ’ï¼‰ã€‚\nç®—æ³•æè¿°? è®¾ç½®ä¸€ä¸ªå®šé‡çš„æ•°ç»„å½“ä½œç©ºæ¡¶ï¼› éå†è¾“å…¥æ•°æ®ï¼Œå¹¶ä¸”æŠŠæ•°æ®ä¸€ä¸ªä¸€ä¸ªæ”¾åˆ°å¯¹åº”çš„æ¡¶é‡Œå»ï¼› å¯¹æ¯ä¸ªä¸æ˜¯ç©ºçš„æ¡¶è¿›è¡Œæ’åºï¼› ä»ä¸æ˜¯ç©ºçš„æ¡¶é‡ŒæŠŠæ’å¥½åºçš„æ•°æ®æ‹¼æ¥èµ·æ¥ã€‚ å›¾ç‰‡æ¼”ç¤º ä»£ç å®ç° ç®—æ³•åˆ†æ æ¡¶æ’åºæœ€å¥½æƒ…å†µä¸‹ä½¿ç”¨çº¿æ€§æ—¶é—´O(n)ï¼Œæ¡¶æ’åºçš„æ—¶é—´å¤æ‚åº¦ï¼Œå–å†³ä¸å¯¹å„ä¸ªæ¡¶ä¹‹é—´æ•°æ®è¿›è¡Œæ’åºçš„æ—¶é—´å¤æ‚åº¦ï¼Œå› ä¸ºå…¶å®ƒéƒ¨åˆ†çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(n)ã€‚å¾ˆæ˜¾ç„¶ï¼Œæ¡¶åˆ’åˆ†çš„è¶Šå°ï¼Œå„ä¸ªæ¡¶ä¹‹é—´çš„æ•°æ®è¶Šå°‘ï¼Œæ’åºæ‰€ç”¨çš„æ—¶é—´ä¹Ÿä¼šè¶Šå°‘ã€‚ä½†ç›¸åº”çš„ç©ºé—´æ¶ˆè€—å°±ä¼šå¢å¤§ã€‚\nåŸºæ•°æ’åºï¼ˆRadix Sortï¼‰ åŸºæ•°æ’åºæ˜¯æŒ‰ç…§ä½ä½å…ˆæ’åºï¼Œç„¶åæ”¶é›†ï¼›å†æŒ‰ç…§é«˜ä½æ’åºï¼Œç„¶åå†æ”¶é›†ï¼›ä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°æœ€é«˜ä½ã€‚æœ‰æ—¶å€™æœ‰äº›å±æ€§æ˜¯æœ‰ä¼˜å…ˆçº§é¡ºåºçš„ï¼Œå…ˆæŒ‰ä½ä¼˜å…ˆçº§æ’åºï¼Œå†æŒ‰é«˜ä¼˜å…ˆçº§æ’åºã€‚æœ€åçš„æ¬¡åºå°±æ˜¯é«˜ä¼˜å…ˆçº§é«˜çš„åœ¨å‰ï¼Œé«˜ä¼˜å…ˆçº§ç›¸åŒçš„ä½ä¼˜å…ˆçº§é«˜çš„åœ¨å‰ã€‚\nç®—æ³•æè¿° å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°ï¼› arrä¸ºåŸå§‹æ•°ç»„ï¼Œä»æœ€ä½ä½å¼€å§‹å–æ¯ä¸ªä½ç»„æˆradixæ•°ç»„ï¼› å¯¹radixè¿›è¡Œè®¡æ•°æ’åºï¼ˆåˆ©ç”¨è®¡æ•°æ’åºé€‚ç”¨äºå°èŒƒå›´æ•°çš„ç‰¹ç‚¹ï¼‰ï¼› åŠ¨å›¾æ¼”ç¤º ç®—æ³•åˆ†æ åŸºæ•°æ’åºåŸºäºåˆ†åˆ«æ’åºï¼Œåˆ†åˆ«æ”¶é›†ï¼Œæ‰€ä»¥æ˜¯ç¨³å®šçš„ã€‚ä½†åŸºæ•°æ’åºçš„æ€§èƒ½æ¯”æ¡¶æ’åºè¦ç•¥å·®ï¼Œæ¯ä¸€æ¬¡å…³é”®å­—çš„æ¡¶åˆ†é…éƒ½éœ€è¦O(n)çš„æ—¶é—´å¤æ‚åº¦ï¼Œè€Œä¸”åˆ†é…ä¹‹åå¾—åˆ°æ–°çš„å…³é”®å­—åºåˆ—åˆéœ€è¦O(n)çš„æ—¶é—´å¤æ‚åº¦ã€‚å‡å¦‚å¾…æ’æ•°æ®å¯ä»¥åˆ†ä¸ºdä¸ªå…³é”®å­—ï¼Œåˆ™åŸºæ•°æ’åºçš„æ—¶é—´å¤æ‚åº¦å°†æ˜¯O(d*2n) ï¼Œå½“ç„¶dè¦è¿œè¿œå°äºnï¼Œå› æ­¤åŸºæœ¬ä¸Šè¿˜æ˜¯çº¿æ€§çº§åˆ«çš„ã€‚\nåŸºæ•°æ’åºçš„ç©ºé—´å¤æ‚åº¦ä¸ºO(n+k)ï¼Œå…¶ä¸­kä¸ºæ¡¶çš„æ•°é‡ã€‚ä¸€èˆ¬æ¥è¯´n\u0026raquo;kï¼Œå› æ­¤é¢å¤–ç©ºé—´éœ€è¦å¤§æ¦‚nä¸ªå·¦å³ã€‚\nåŸºæ•°æ’åº vs è®¡æ•°æ’åº vs æ¡¶æ’åº\nè¿™ä¸‰ç§æ’åºç®—æ³•éƒ½åˆ©ç”¨äº†æ¡¶çš„æ¦‚å¿µï¼Œä½†å¯¹æ¡¶çš„ä½¿ç”¨æ–¹æ³•ä¸Šæœ‰æ˜æ˜¾å·®å¼‚ï¼š\nåŸºæ•°æ’åºï¼šæ ¹æ®é”®å€¼çš„æ¯ä½æ•°å­—æ¥åˆ†é…æ¡¶ è®¡æ•°æ’åºï¼šæ¯ä¸ªæ¡¶åªå­˜å‚¨å•ä¸€é”®å€¼ æ¡¶æ’åºï¼šæ¯ä¸ªæ¡¶å­˜å‚¨ä¸€å®šèŒƒå›´çš„æ•°å€¼ å‚è€ƒé“¾æ¥ https://www.cnblogs.com/onepixel/articles/7674659.html\nhttps://www.cnblogs.com/guoyaohua/p/8600214.html\nhttps://blog.csdn.net/zhangshk_/article/details/82911093\nhttps://blog.csdn.net/meibenxiang/article/details/92796909\nhttps://www.cnblogs.com/itsharehome/p/11058010.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/ds_sort/","summary":"æ’åºç®—æ³• æœ¯è¯­è¯´æ˜ ç¨³å®šï¼šå¦‚æœaåŸæœ¬åœ¨bå‰é¢ï¼Œè€Œa=bï¼Œæ’åºä¹‹åaä»ç„¶åœ¨bçš„å‰é¢ï¼›\nä¸ç¨³å®šï¼šå¦‚æœaåŸæœ¬åœ¨bçš„å‰é¢ï¼Œè€Œa=bï¼Œæ’åºä¹‹åaå¯èƒ½ä¼šå‡ºç°åœ¨bçš„åé¢ï¼›\nå†…éƒ¨æ’åºï¼šå¾…æ’åºçš„æ•°æ®å¯ä»¥å…¨éƒ¨æ”¾å…¥å†…å­˜ä¸­ï¼›\nå¤–éƒ¨æ’åºï¼šå¾…æ’åºæ•°æ®çš„æ•°é‡å¾ˆå¤§ï¼Œä»¥è‡´äºå†…å­˜ä¸èƒ½ä¸€æ¬¡å®¹çº³å…¨éƒ¨è®°å½•ï¼Œæ‰€ä»¥åœ¨æ’åºè¿‡ç¨‹ä¸­éœ€è¦å¯¹å¤–å­˜(ç£ç›˜)è¿›è¡Œè®¿é—®ï¼›\næ—¶é—´å¤æ‚åº¦ï¼š ä¸€ä¸ªç®—æ³•æ‰§è¡Œæ‰€è€—è´¹çš„æ—¶é—´ã€‚\nç©ºé—´å¤æ‚åº¦ï¼šè¿è¡Œå®Œä¸€ä¸ªç¨‹åºæ‰€éœ€å†…å­˜çš„å¤§å°ã€‚\næ’åºç®—æ³•æ€»ç»“ æ’åºç®—æ³• å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ æ’åºæ–¹å¼ ç¨³å®šæ€§ å†’æ³¡æ’åº O(n^2^) O(n) O(n^2^) O(1) In-place ç¨³å®š é€‰æ‹©æ’åº O(n^2^) O(n^2^) O(n^2^) O(1) In-place ä¸ç¨³å®š æ’å…¥æ’åº O(n^2^) O(n) O(n^2^) O(1) In-place ç¨³å®š å¸Œå°”æ’åº O(n logn) O(nlog^2^n) O(nlog^2^n) O(1) In-place ä¸ç¨³å®š å½’å¹¶æ’åº O(n logn) O(n logn) O(n logn) O(n) Out-place ç¨³å®š å¿«é€Ÿæ’åº O(n logn) O(n logn) O(n^2^) O(n logn) In-place ä¸ç¨³å®š å †æ’åº O(n logn) O(n logn) O(n logn) O(1) In-place ä¸ç¨³å®š è®¡æ•°æ’åº O(n+k) O(n+k) O(n+k) O(k) Out-place ç¨³å®š æ¡¶æ’åº O(n+k) O(n+k) O(n^2^) O(n+k) Out-place ç¨³å®š åŸºæ•°æ’åº O(n*k) O(n*k) O(n*k) O(n+k) Out-place ç¨³å®š n:æ•°æ®è§„æ¨¡ï¼›k:\u0026ldquo;æ¡¶\u0026quot;çš„ä¸ªæ•°ï¼›n-place:å ç”¨å¸¸æ•°å†…å­˜ï¼Œä¸å ç”¨é¢å¤–å†…å­˜ï¼›Out-place:å ç”¨é¢å¤–å†…å­˜","tags":null,"title":"ã€Œç®—æ³•ä¸æ•°æ®ç»“æ„ã€æ’åºç®—æ³•"},{"categories":null,"contents":"äºŒåˆ†æŸ¥æ‰¾ 1public class BinarySearch{ 2 public static void main(String[] args) { 3 int[] arr = {1,2,3,4,5,6,7,8}; 4 int k = 8; 5 System.out.println(binarySerach(arr, k)); 6 } 7 8 public static int binarySerach(int[] arr, int k){ 9 int a = 0; 10 int b = arr.length; 11 12 while(a \u0026lt; b){ 13 int mid = a+(b-a)/2; 14 if(k \u0026lt; arr[mid]){ 15 b = mid; 16 }else if(k \u0026gt; arr[mid]){ 17 a = mid + 1; 18 }else{ 19 return mid; 20 } 21 } 22 return -1; 23 24 } 25} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/ds_find/","summary":"äºŒåˆ†æŸ¥æ‰¾ 1public class BinarySearch{ 2 public static void main(String[] args) { 3 int[] arr = {1,2,3,4,5,6,7,8}; 4 int k = 8; 5 System.out.println(binarySerach(arr, k)); 6 } 7 8 public static int binarySerach(int[] arr, int k){ 9 int a = 0; 10 int b = arr.length; 11 12 while(a \u0026lt; b){ 13 int mid = a+(b-a)/2; 14 if(k \u0026lt; arr[mid]){ 15 b = mid; 16 }else if(k \u0026gt; arr[mid]){ 17 a = mid + 1; 18 }else{ 19 return mid; 20 } 21 } 22 return -1; 23 24 } 25} ","tags":null,"title":"ã€Œç®—æ³•ä¸æ•°æ®ç»“æ„ã€æŸ¥æ‰¾ç®—æ³•"},{"categories":null,"contents":"å•å‘é“¾è¡¨ 1import java.util.*; 2class Node{ 3 private final int value; 4 private Node next; 5 6 public Node(int value){ 7 this.value = value; 8 this.next = null; 9 } 10 public int getValue(){ 11 return this.value; 12 } 13 public Node getNext(){ 14 return this.next; 15 } 16 public void setNext(Node next){ 17 this.next = next; 18 } 19 20 public static void printLinkedList(Node head){ 21 while(head != null){ 22 System.out.print(head.getValue()); 23 System.out.print(\u0026#34; \u0026#34;); 24 head = head.next; 25 } 26 System.out.println(\u0026#34;\u0026#34;); 27 } 28 29} 30class LinkedListCreator{ 31 public Node createLinkedList(List\u0026lt;Integer\u0026gt; data){ 32 if(data.isEmpty()){ 33 return null; 34 } 35 Node firstNode = new Node(data.get(0)); 36 firstNode.setNext(createLinkedList(data.subList(1,data.size()))); 37 return firstNode; 38 } 39} 40 41class LinkedListReverser{ 42 public Node reverseLinkedList(Node head){ 43 if(head==null || head.getNext()==null){ 44 return head; 45 } 46 Node newHead = reverseLinkedList(head.getNext()); 47 head.getNext().setNext(head); 48 head.setNext(null); 49 return newHead; 50 } 51} 52 53public class Main { 54 public static void main(String[] args) { 55 LinkedListCreator creator = new LinkedListCreator(); 56 LinkedListReverser reverser = new LinkedListReverser(); 57 58 // Node.printLinkedList(creator.createLinkedList(Arrays.asList(1))); 59 Node.printLinkedList(reverser.reverseLinkedList(creator.createLinkedList(Arrays.asList(1,2,3,4,5)))); 60 61 System.out.println(\u0026#34;Hello World!\u0026#34;); 62 } 63} åŒå‘é“¾è¡¨ 1import java.util.*; 2 3class Node { 4 private Integer value; 5 private Node next; 6 7 public Node(Integer value) { 8 this.value = value; 9 this.next = null; 10 } 11 12 public Integer getValue() { 13 return this.value; 14 } 15 16 public void setNext(Node next) { 17 this.next = next; 18 } 19 20 public Node getNext() { 21 return this.next; 22 } 23 24 public static void printLinkedList(Node head) { 25 while (head != null) { 26 System.out.print(head.getValue()); 27 System.out.print(\u0026#34; \u0026#34;); 28 head = head.getNext(); 29 } 30 System.out.println(); 31 } 32} 33 34class LinkedListCreator { 35 public Node createLinkedList(List\u0026lt;Integer\u0026gt; data) { 36 Node head = null; 37 Node prev = null; 38 for (Integer i : data) { 39 Node node = new Node(i); 40 if (prev != null) { 41 prev.setNext(node); 42 } else { 43 head = node; 44 } 45 prev = node; 46 } 47 return head; 48 49 } 50} 51 52class LinkedListReverser { 53 public Node reverseLinkedList(Node head) { 54 Node newHead = null; 55 Node curHead = head; 56 while (curHead != null) { 57 Node node = curHead.getNext(); 58 curHead.setNext(newHead); 59 newHead = curHead; 60 curHead = node; 61 } 62 return newHead; 63 } 64} 65 66class LinkedListDeleter { 67 public Node deleteIfEqual(Node head, int value) { 68 while (head != null \u0026amp;\u0026amp; head.getValue() == value) { 69 head = head.getNext(); 70 } 71 Node curNode = head; 72 while (curNode.getNext() != null) { 73 if (curNode.getNext().getValue() == value) { 74 curNode.setNext(curNode.getNext().getNext()); 75 } else { 76 curNode = curNode.getNext(); 77 } 78 } 79 80 return head; 81 82 } 83} 84 85public class Main { 86 87 public static Node deleteNodeEquals(Node head, int value){ 88 while(head != null \u0026amp;\u0026amp; head.getValue() == value){ 89 head = head.getNext(); 90 } 91 Node curNode = head; 92 while(curNode.getNext() != null){ 93 if(curNode.getNext().getValue() == value){ 94 curNode.setNext(curNode.getNext().getNext()); 95 }else{ 96 curNode = curNode.getNext(); 97 } 98 } 99 return head; 100 } 101 public static void main(String[] args) { 102 LinkedListCreator creator = new LinkedListCreator(); 103 LinkedListReverser reverser = new LinkedListReverser(); 104 LinkedListDeleter deleter = new LinkedListDeleter(); 105 106 Node.printLinkedList(creator.createLinkedList(Arrays.asList(1, 2, 3, 4, 5, 6))); 107 Node.printLinkedList(reverser.reverseLinkedList(creator.createLinkedList(Arrays.asList(1, 2, 3, 4, 5, 6)))); 108 Node.printLinkedList(deleter.deleteIfEqual(creator.createLinkedList(Arrays.asList(1, 2, 3, 4, 5, 6)), 6)); 109 110 111 Node.printLinkedList(deleteNodeEquals(creator.createLinkedList(Arrays.asList(1,2,3,4,5,6,7)), 5)); 112 113 System.out.println(\u0026#34;Hello World!\u0026#34;); 114 } 115} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/ds_linkedlist/","summary":"å•å‘é“¾è¡¨ 1import java.util.*; 2class Node{ 3 private final int value; 4 private Node next; 5 6 public Node(int value){ 7 this.value = value; 8 this.next = null; 9 } 10 public int getValue(){ 11 return this.value; 12 } 13 public Node getNext(){ 14 return this.next; 15 } 16 public void setNext(Node next){ 17 this.next = next; 18 } 19 20 public static void printLinkedList(Node head){ 21 while(head != null){ 22 System.","tags":null,"title":"ã€Œç®—æ³•ä¸æ•°æ®ç»“æ„ã€é“¾è¡¨"},{"categories":null,"contents":"What is the network layer? Network-to-network connections are what make the Internet possible. The \u0026ldquo;network layer\u0026rdquo; is the part of the Internet communications process where these connections occur, by sending packets of data back and forth between different networks, In the 7-layer OSI model, the network layer is layer 3. The Internet Protocol(IP) is one of the main protocols used at this layer, along with several other protocols for routing, resting and encryption.\nSuppose Bob and Alice are connected to the same local area network(LAN), and Bob wants to send Alice a message. Because Bob is on the same network with Alice, he could send it directly to her computer across the network. However, if Alice is instead on a different LAN several miles away, Bob\u0026rsquo;s message will have to be addressed and sent to Alice\u0026rsquo;s network before it can reach her computer, which is a network layer process.\nWhat is a network? A network is a group of two or more connected computing devices. Usually all devices in the network are connected to a central hub\u0026ndash; for instance, a router. A network can also include subnetworks, or smaller subdivisions of the network. Sub-networking is how very large networks, such as those provided by ISPs, are able to manage thousands of IP addresses and connected devices.\nThink of the internet ad a network of networks: computers are connected to each other within networks, and these networks connect to other networks. This enable these computers to connect with other computers both near and far.\nWhat happens at the network layer? Anything that has to do with inter-network connections takes place at the network layer. This includes setting up the routes for data packets to take, checking to see if a server in another network is up and running, and addressing and receiving IP packets from other networks. This last process is perhaps the most important, as the vast majority of the internet traffic is sent over IP.\nWhat is a packet? All data sent over the Internet is broken down into smaller chunks called \u0026ldquo;packets\u0026rdquo;. When Bob send Alice a message, for instance, his message is broken down into smaller pieces and the reassembled on Alice\u0026rsquo;s computer. A packets has two parts: the header, which contains information about the packets itself, and the body, which is the actual data being sent.\nAt the network layer, networking software attaches a header to each packet when the packet is sent out over the Internet, and on the other end, networking software can use the header to understand how to handle the packet.\nA header contains information about the content, source, and destination of each packet(somewhat link stamping an envelope with a destination and return address). For example, an IP header contains the destination IP address of each packet, the total size of the packets, an indication of weather or not the packet has been fragmented(broken up into still smaller pieces)in transit, and a count of how many networks the packets has traveled through.\nWhat is the OSI model? The Open System Interconnection(OSI) Model is a description of how the Internet works. It breaks down the functions involved in sending data over the Internet into seven layers. Each layer has some function that prepares the data to be sent over wires, cables, and radio waves ad a series of bits.\nThe server layers of the OSI model are:\n7.Application layer: Data generated by and usable by software applications. The main protocol user ad this layer is HTTP.\n6.Presentation layer: Data is translated into a form the application can accept. Some authorities consider HTTPS encryption and decryption to take place at this layer.\n5.Session layer: Controls connection between computers(this can also be handle at layer 4 by the TCP protocol).\n4.Transport layer: Provides the means for transmitting data between two connected parties, as wells as controlling the quality of service. The main protocol used here are TCP and UDP.\n3.Network layer: Handles the routing and sending of data between different networks. The most important protocols at this layer are IP and ICMP.\n2.Data link layer: Handle communications between devices on the same network. If layer 3 is like the address on a piece of mail, the layer 2 is like indicating the office number or apartment number at the address. Ethernet is the protocol most used here.\n1.Physical layer: Packets are converted into electrical, radio, or optical pulses and transmitted at bits(the smallest possible units of information) over wires, radio waves, or cables.\nIt is important to keep in mind that the OSI model is an abstract conceptualization of the process that make the Internet work, and interpreting and applying the models to the real-world Internet is sometime a subjective exercise.\nThe OSI model is useful for helping people talk about networking equipment and protocols, determining which protocols are used by which software and hardware, and showing roughly how the Internet works. But it is not a rigid step-by-step definition of how Internet connections always function.\nOSI model vs. TCP/IP model The TCP/IP model is alternative model of how the Internet works. It divides the processes involved in to four layers instead of seven. Some would argue the the TCP/IP model better reflects the way the Internet functions today, but the OSI model is still widely referenced for understanding the Internet, and both models have their strengths and weaknesses.\n4.Application layer: This corresponds, approximately, to layer 7 in the OSI model. 3.Transport layer: Corresponds to layer 4 in the OSI model. 2.Internet layer: Corresponds to layer3 in the OSI model. 1.Network access layer: Combines the process of layer 1 and 2 in the OSI model. But where are the OSI layers 5 and 6 in the TCP/IP model? Some source hold that the process at OSI layer 5 and 6 either no longer necessary in the modern Internet, or actually belong to layer 7 and 4(represented by layer 4 and 3 in the TCP/IP model).\nFor instance, since the TCP protocol opens and maintains sessions at OSI layer 4, one could consider OSI layer 5(the \u0026ldquo;session\u0026rdquo; layer) to be unnecessary \u0026ndash; and it is not represented in the TCP/IP model. Additionally, HTTPS encryption and decryption can be considered an application layer (OSI layer7 or TCP/IP layer 4) process instead of a presentation layer(OSI layer 6) process.\nWhat the difference between the network layer and the Internet layer In the TCP/IP model, there is no \u0026ldquo;network\u0026rdquo; layer. The OSI model network layer roughly corresponds to the TCP/IP model Internet layer. In the OSI model network layer is layer 3; in the TCP/IP model the Internet layer is layer 2.\nIn other words, the network layer and the Internet layer are basically the same thing, but the come from different models of how the Internet works.\nWhat the protocols are used at the network layer? A protocol is an agreed-upon way of formatting data so that two or more devices are able to communicate with and understand each other. A number of different protocols make connections, testing, routing and encryption possible at the network layer, including:\nIP IPsec ICMP IGMP GRE Because they are exposed to the rest of the Internet, network layer infrastructure is vulnerable to external attacks, especially distributed denial-of-service(DDoS) attacks. Router, switches, and other network interfaces can all be overwhelmed and compromised by malicious network traffic, and almost any of the above network protocols can be used in an attack.\nxxx protect networking infrastructure using the same technology that keeps millions of web properties up and running in the face of vulnerability exploits and DDoS attacks. It extends the protection to on-premise and data center networks, keep organizations secure from layer attacks.\nWhat is MSS(maximum segment size)? MSS, or maximum segment size, is the largest data payload that a device will accept form a network connection.\nMSS(maximum segment size) limits the size of packets, or small chunks of data, the travel sccross a network, such as the internel. All data that travels over a network is broken up into packets. Packets have serveral headers attached to them that contain information about their contents and destination. MSS measures the non-header portion of a packet, which is called the payload.\nNetwork Deivice Hub\nSwitch/ 2 layer switch/3 layer switch/ VLAN\nBridge\nRouter/NAT/SNAT/DNAT\nç½‘ç»œç›¸å…³å‘½ä»¤ ipstable\nifconfig/ç½‘å¡up and down\nroute\nä¸€ä¸ªæœºå™¨å¦‚æœæœ‰è¿ä¸ªç½‘å¡\nä¸€ä¸ªäº¤æ¢æœºä¸‹ä¸¤ä¸ªç½‘æ®µï¼Œä¸ºä»€ä¹ˆä¸å¯ä»¥äº’ç›¸é€šä¿¡\nä¸€ä¸ªäº¤æ¢æœºä¸‹è¿ä¸ªç½‘æ®µæ˜¯å¦å¯ä»¥ç‹¬ç«‹é€šä¿¡\nè·¯ç”±å™¨åŸç†ï¼Œä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªlinuxä½œä¸ºç½‘å…³\nReference\nhttps://www.cloudflare.com/learning/network-layer/what-is-mss/\nhttps://www.cloudflare.com/learning/network-layer/what-is-the-network-layer/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_base/","summary":"What is the network layer? Network-to-network connections are what make the Internet possible. The \u0026ldquo;network layer\u0026rdquo; is the part of the Internet communications process where these connections occur, by sending packets of data back and forth between different networks, In the 7-layer OSI model, the network layer is layer 3. The Internet Protocol(IP) is one of the main protocols used at this layer, along with several other protocols for routing, resting and encryption.","tags":null,"title":"ã€Œç½‘ç»œã€ç½‘ç»œåŸºç¡€"},{"categories":null,"contents":"ITXæœºç®± è¯¦è®¾è®¡ä¸€ä¸ªå±äºè‡ªå·±çš„ITXæœºç®±\nè£…æœºæ¸…å• å‚è€ƒé“¾æ¥ ITXæœºç®±å›¾çº¸å‚è€ƒé“¾æ¥ https://sff.design/1210.html https://sff.design/15201.html ACC X11å‚è€ƒé“¾æ¥ https://item.jd.com/10024295444328.html#crumb-wrap\ngpp https://www.kyairsoft.com/4-3-desert-warrior-full-marking.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/itx_%E6%9C%BA%E7%AE%B1%E8%AE%BE%E8%AE%A1/","summary":"ITXæœºç®± è¯¦è®¾è®¡ä¸€ä¸ªå±äºè‡ªå·±çš„ITXæœºç®±\nè£…æœºæ¸…å• å‚è€ƒé“¾æ¥ ITXæœºç®±å›¾çº¸å‚è€ƒé“¾æ¥ https://sff.design/1210.html https://sff.design/15201.html ACC X11å‚è€ƒé“¾æ¥ https://item.jd.com/10024295444328.html#crumb-wrap\ngpp https://www.kyairsoft.com/4-3-desert-warrior-full-marking.html","tags":null,"title":"ã€Œè£…æœºã€ ITX A4æœºç®±è®¾è®¡"},{"categories":null,"contents":"ç½‘ç»œç¡¬ä»¶ åŒç»çº¿ ç±»å‹ äº”ç±»çº¿CAT5 è¶…äº”ç±»çº¿CAT5e å…­ç±»çº¿CAT6 è¶…å…­ç±»çº¿CATT6e ä¸ƒç±»çº¿CAT7 é¢‘ç‡å¸¦å®½ 100MHz 100MHz 200MHz 500MHz 600MHz ä¼ è¾“é€Ÿç‡ 100Mbps 1000Mbps 1000Mbps 1Gbps 10Gbps æœ€å¤§é•¿åº¦ 100m 100m 100m 55m å±è”½ç±»å‹ å±è”½/éå±è”½ å±è”½/éå±è”½ å±è”½/éå±è”½ å±è”½/éå±è”½ åŒå±‚å±è”½ åŒç»çº¿çº¿åº ç›´é€šï¼Œäº¤å‰(ä¸»è¦ç”¨äºå¯¹ç­‰è®¾å¤‡çš„é€šä¿¡)\næ ‡å‡† 1 2 3 4 5 6 7 8 EIA/TIA 568A ç»¿ç™½ ç»¿ æ©™ç™½ è“ è“ç™½ æ©™ æ£•ç™½ æ£• EIA/TIA 568B æ©™ç™½ æ©™ ç»¿ç™½ è“ è“ç™½ ç»¿ æ£•ç™½ æ£• ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/cs_basic/network_basic/","summary":"ç½‘ç»œç¡¬ä»¶ åŒç»çº¿ ç±»å‹ äº”ç±»çº¿CAT5 è¶…äº”ç±»çº¿CAT5e å…­ç±»çº¿CAT6 è¶…å…­ç±»çº¿CATT6e ä¸ƒç±»çº¿CAT7 é¢‘ç‡å¸¦å®½ 100MHz 100MHz 200MHz 500MHz 600MHz ä¼ è¾“é€Ÿç‡ 100Mbps 1000Mbps 1000Mbps 1Gbps 10Gbps æœ€å¤§é•¿åº¦ 100m 100m 100m 55m å±è”½ç±»å‹ å±è”½/éå±è”½ å±è”½/éå±è”½ å±è”½/éå±è”½ å±è”½/éå±è”½ åŒå±‚å±è”½ åŒç»çº¿çº¿åº ç›´é€šï¼Œäº¤å‰(ä¸»è¦ç”¨äºå¯¹ç­‰è®¾å¤‡çš„é€šä¿¡)\næ ‡å‡† 1 2 3 4 5 6 7 8 EIA/TIA 568A ç»¿ç™½ ç»¿ æ©™ç™½ è“ è“ç™½ æ©™ æ£•ç™½ æ£• EIA/TIA 568B æ©™ç™½ æ©™ ç»¿ç™½ è“ è“ç™½ ç»¿ æ£•ç™½ æ£• ","tags":null,"title":"ã€Œè®¡ç®—æœºç½‘ç»œã€ è®¡ç®—æœºç½‘ç»œä¸²è®²"},{"categories":null,"contents":"1# é€šè¿‡Pidè·å–å¯¹åº”çš„service 2systemd status \u0026lt;Pid\u0026gt; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/linux_systemd/","summary":"1# é€šè¿‡Pidè·å–å¯¹åº”çš„service 2systemd status \u0026lt;Pid\u0026gt; ","tags":null,"title":"ã€Linuxã€‘ Systemd"},{"categories":null,"contents":"1 çŸ­åœ°å€æœåŠ¡ å°†é•¿åœ°å€ç¼©çŸ­åˆ°ä¸€ä¸ªå¾ˆçŸ­çš„åœ°å€ï¼Œç”¨æˆ·è®¿é—®è¿™ä¸ªçŸ­åœ°å€å¯ä»¥é‡å®šå‘åˆ°åŸæœ¬çš„é•¿åœ°å€ã€‚\nå¦‚ä½•è®¾è®¡HTTP Router å’Œhandler å¦‚ä½•åœ¨HTTP å¤„ç†æµç¨‹ä¸­åŠ å…¥Middleware å¦‚ä½•åˆ©ç”¨Goçš„Interfaceæ¥å®ç°å¯æ‰©å±•çš„è®¾è®¡ å¦‚ä½•ä½¿ç”¨redisçš„è‡ªå¢é•¿åºåˆ—ç”ŸæˆçŸ­åœ°å€ 2 ä¸»æœåŠ¡æ¨¡å— APIæ¥å£ POST /api/shorten GET /api/info?shortlink=shortlink GET /:shortlink - return 302 code é‡å®šå‘ POST /api/shorten Params\nName Type Description url string Required. URL to shorten. e.g. https://www.example.com expiration_in_minutes int Required. Expiration of short link in minutes. e.g. value 0 represents permanent. Response\n1{ 2 \u0026#34;shortlink\u0026#34;:\u0026#34;P\u0026#34; 3} GET /api/info?shortlink=shortlink Params\nName Type Description shortlink string Required. Id of shortened. e.g. P Response\n1{ 2 \u0026#34;url\u0026#34;:\u0026#34;https://www.example.com\u0026#34;, 3 \u0026#34;created_at\u0026#34;: \u0026#34;2022-03-09 23:07:03\u0026#34;, 4 \u0026#34;expiration_in_minutes\u0026#34;: 60 5} GET /:shortlink - return 302 code é‡å®šå‘ Redirect 302 ä¸´æ—¶é‡å®šå‘ï¼›301ä¼šæ°¸ä¹…ä¿å­˜åœ¨ç”¨æˆ·çš„ç¼“å­˜ä¸­ã€‚\nä¸€ä¸ªå®Œæ•´çš„HTTP å¤„ç†æµç¨‹\nMiddleware æ˜¯ä¸€ä¸ªpipelineï¼šè®¤è¯ï¼Œé‰´æƒï¼Œlog\nMuxä¸­routerå’ŒHandlerè®¾è®¡ gorilla/mux å¤„ç†router å’Œhandler\n1func main(){ 2 r := mux.NewRouter() 3 r.HandleFunc(\u0026#34;/\u0026#34;, HomeHandler) 4 r.HandleFunc(\u0026#34;/product\u0026#34;, ProductsHandler) 5 r.HandleFunc(\u0026#34;/articles\u0026#34;,ArticlesHandler) 6 http.Handle(\u0026#34;/\u0026#34;,r) 7} å®ç°routerå’Œhandler å·¥ç¨‹ä»£ç \n1âœ goshorten tree 2. 3â”œâ”€â”€ app.go 4â””â”€â”€ main.go main.go\n1package main 2 3func main() { 4 a := App{} 5 a.Initialize() 6 a.Run(\u0026#34;:8000\u0026#34;) 7} app.go\n1package main 2 3import ( 4\t\u0026#34;encoding/json\u0026#34; 5\t\u0026#34;fmt\u0026#34; 6\t\u0026#34;io\u0026#34; 7\t\u0026#34;log\u0026#34; 8\t\u0026#34;net/http\u0026#34; 9 10\t\u0026#34;github.com/gorilla/mux\u0026#34; 11\t\u0026#34;gopkg.in/validator.v2\u0026#34; 12) 13 14// App encapsulate Env, Router and middleware 15type App struct { 16\tRouter *mux.Router 17} 18 19type shortenReq struct { 20\tURL string `json:\u0026#34;url\u0026#34; validate:\u0026#34;nonzero\u0026#34;` 21\tExpirationInMinutes int64 `json:\u0026#34;expiration_in_minutes\u0026#34; validate:\u0026#34;min=0\u0026#34;` 22} 23 24type shortlinkResp struct { 25\tShortLink string `json:\u0026#34;shortlink\u0026#34;` 26} 27 28// Initialize is initialization of app 29func (a *App) Initialize() { 30\t// set log formatter 31\tlog.SetFlags(log.LstdFlags | log.Lshortfile) 32\ta.Router = mux.NewRouter() 33\ta.initializeRouters() 34} 35 36func (a *App) initializeRouters() { 37 38\ta.Router.HandleFunc(\u0026#34;/api/shorten\u0026#34;, a.createShortLink).Methods(\u0026#34;POST\u0026#34;) 39\ta.Router.HandleFunc(\u0026#34;/api/info\u0026#34;, a.getShortLinkInfo).Methods(\u0026#34;GET\u0026#34;) 40\ta.Router.HandleFunc(\u0026#34;/{shortlink:[a-zA-Z0-9]{1,11}}\u0026#34;, a.redirect).Methods(\u0026#34;GET\u0026#34;) 41} 42 43func (a *App) createShortLink(w http.ResponseWriter, r *http.Request) { 44\tvar req shortenReq 45\tif err := json.NewDecoder(r.Body).Decode(\u0026amp;req); err != nil { 46\treturn 47\t} 48\tif err := validator.Validate(req); err != nil { 49\treturn 50\t} 51\tdefer func(Body io.ReadCloser) { 52\t_ = Body.Close() 53\t}(r.Body) 54 55\tfmt.Printf(\u0026#34;%v\\n\u0026#34;, req) 56} 57 58func (a *App) getShortLinkInfo(w http.ResponseWriter, r *http.Request) { 59 60\tvars := r.URL.Query() 61\ts := vars.Get(\u0026#34;shortlink\u0026#34;) 62 63\tfmt.Printf(\u0026#34;%s\\n\u0026#34;, s) 64} 65 66func (a *App) redirect(w http.ResponseWriter, r *http.Request) { 67 68\tvars := mux.Vars(r) 69\tfmt.Printf(\u0026#34;%s\\n\u0026#34;, vars[\u0026#34;shortlink\u0026#34;]) 70} 71 72// Run starts listen and serve 73func (a *App) Run(addr string) { 74\tlog.Fatal(http.ListenAndServe(addr, a.Router)) 75} æµ‹è¯•API 1curl -X POST \\ 2 http://localhost:8000/api/shorten \\ 3 -d \u0026#39;{\u0026#34;url\u0026#34;:\u0026#34;www.baidu.com\u0026#34;,\u0026#34;expiration_in_minutes\u0026#34;:1}\u0026#39; 4 5curl -X GET \\ 6 \u0026#39;http://localhost:8000/api/info?shortlink=hi\u0026#39; 7 8curl -X GET \\ 9 http://localhost:8000/A é”™è¯¯å¤„ç†è®¾è®¡ An interface type is defined as a set of method signatures.\nä¸€ä¸ªæ¥å£æ˜¯ä¸€ç³»åˆ—æ–¹æ³•ç­¾åçš„é›†åˆ\nA values of interface type can hold any value that implements those methods.\nä¸€ä¸ªæ¥å£çš„ç±»å‹ å¯ä»¥æ¥å—ä»»ä½•å®ç°äº†æ¥å£æ–¹æ³•çš„å¯¹è±¡\n1// Go çš„å†…ç½®æ¥å£ 2type error interface{ 3 Error() string 4} 1err := errors.New(\u0026#34;Error message!\u0026#34;) 2if err != nil{ 3 fmt.Print(err) 4} å·¥ç¨‹ä»£ç \n1. 2â”œâ”€â”€ app.go 3â”œâ”€â”€ error.go 4â””â”€â”€ main.go error.go\n1package main 2 3type Error interface { 4 error 5 Status() int 6} 7 8type StatusError struct { 9 Code int 10 Err error 11} 12 13func (se StatusError) Error() string { // (se *StatusError) åŒºåˆ« 14 return se.Err.Error() 15} 16 17func (se StatusError) Status() int { 18 return se.Code 19} app.go\n1func (a *App) createShortLink(w http.ResponseWriter, r *http.Request) { 2\tvar req shortenReq 3\tif err := json.NewDecoder(r.Body).Decode(\u0026amp;req); err != nil { 4\tresponseWithError(w, StatusError{http.StatusBadRequest, 5\tfmt.Errorf(\u0026#34;prase parameters failed %v\u0026#34;, r.Body)}) 6\treturn 7\t} 8\tif err := validator.Validate(req); err != nil { 9\tresponseWithError(w, StatusError{http.StatusBadRequest, 10\tfmt.Errorf(\u0026#34;validate parameters failed %v\u0026#34;, req)}) 11\treturn 12\t} 13\tdefer func(Body io.ReadCloser) { 14\t_ = Body.Close() 15\t}(r.Body) 16 17\tfmt.Printf(\u0026#34;%v\\n\u0026#34;, req) 18} 19 20func responseWithError(w http.ResponseWriter, err error) { 21\tswitch e := err.(type) { 22\tcase Error: 23\tlog.Printf(\u0026#34;HTTP %d - %s\u0026#34;, e.Status(), e) 24\tresponseWithJSON(w, e.Status(), e.Error()) 25\tdefault: 26\tresponseWithJSON(w, http.StatusInternalServerError, 27\thttp.StatusText(http.StatusInternalServerError)) 28\t} 29 30} 31 32func responseWithJSON(w http.ResponseWriter, code int, payload interface{}) { 33\tresp, _ := json.Marshal(payload) 34\tw.Header().Set(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;) 35\tw.WriteHeader(code) 36\t_, _ = w.Write(resp) 37} 3 ä¸­é—´ä»¶æ¨¡å— Middleware Log Middleware\nRecover Middleware\nmiddleware.go\n1package main 2 3import ( 4\t\u0026#34;log\u0026#34; 5\t\u0026#34;net/http\u0026#34; 6\t\u0026#34;time\u0026#34; 7) 8 9type Middleware struct { 10} 11 12//LoggingHandler log the time-consuming of http request 13func (m Middleware) LoggingHandler(next http.Handler) http.Handler { 14\tfn := func(w http.ResponseWriter, r *http.Request) { 15\tt1 := time.Now() 16\tnext.ServeHTTP(w, r) 17\tt2 := time.Now() 18\tlog.Printf(\u0026#34;[%s] %q %v\u0026#34;, r.Method, r.URL.String(), t2.Sub(t1)) 19\t} 20 21\t// adaptor 22\treturn http.HandlerFunc(fn) 23} 24 25// RecoverHandler recover panic 26func (m Middleware) RecoverHandler(next http.Handler) http.Handler { 27\tfn := func(w http.ResponseWriter, r *http.Request) { 28\tdefer func() { 29\tif err := recover(); err != nil { 30\tlog.Printf(\u0026#34;Recover from panic: %+v\u0026#34;, err) 31\thttp.Error(w, http.StatusText(500), 500) 32\t} 33\t}() 34\tnext.ServeHTTP(w, r) 35\t} 36\treturn http.HandlerFunc(fn) 37} AliceåŒ…çš„ä½¿ç”¨ Alice provide a convenient way to chain your HTTP middleware function and the app handler. 1Middleware1(Middlerware2(Middlerware3(app))) 2 3alice.New(Middlerware1, Middleware2, Middleware3).Then(app) 4 å­˜å‚¨æ¨¡å— Storage å¦‚ä½•ç”ŸæˆçŸ­åœ°å€ INCR key 1redis\u0026gt; SET mykey \u0026#34;10\u0026#34; 2\u0026#34;OK\u0026#34; 3redis\u0026gt;INCR mykey 4(integer) 11 5redis\u0026gt;get mykey 6\u0026#34;11\u0026#34; 7redis\u0026gt; Redis å®¢æˆ·ç«¯\nMedis TablePlus\nRedis-cli\nStorageæ¥å£è®¾è®¡ å®ç°Shorten, Unshort å’Œ ShortlinkInfo æ¥å£ 1curl -X POST \\ 2 http://localhost:8000/api/shorten \\ 3 -d \u0026#39;{\u0026#34;url\u0026#34;:\u0026#34;www.baidu.com\u0026#34;,\u0026#34;expiration_in_minutes\u0026#34;:15}\u0026#39; 4 5curl -X GET \\ 6 \u0026#39;http://localhost:8000/api/info?short_link=8\u0026#39; 7 8curl -X GET \\ 9 http://localhost:8000/2 5 å•å…ƒæµ‹è¯• ä¸»æœåŠ¡æµ‹è¯•ç”¨ä¾‹\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/99_go_short_addr/","summary":"1 çŸ­åœ°å€æœåŠ¡ å°†é•¿åœ°å€ç¼©çŸ­åˆ°ä¸€ä¸ªå¾ˆçŸ­çš„åœ°å€ï¼Œç”¨æˆ·è®¿é—®è¿™ä¸ªçŸ­åœ°å€å¯ä»¥é‡å®šå‘åˆ°åŸæœ¬çš„é•¿åœ°å€ã€‚\nå¦‚ä½•è®¾è®¡HTTP Router å’Œhandler å¦‚ä½•åœ¨HTTP å¤„ç†æµç¨‹ä¸­åŠ å…¥Middleware å¦‚ä½•åˆ©ç”¨Goçš„Interfaceæ¥å®ç°å¯æ‰©å±•çš„è®¾è®¡ å¦‚ä½•ä½¿ç”¨redisçš„è‡ªå¢é•¿åºåˆ—ç”ŸæˆçŸ­åœ°å€ 2 ä¸»æœåŠ¡æ¨¡å— APIæ¥å£ POST /api/shorten GET /api/info?shortlink=shortlink GET /:shortlink - return 302 code é‡å®šå‘ POST /api/shorten Params\nName Type Description url string Required. URL to shorten. e.g. https://www.example.com expiration_in_minutes int Required. Expiration of short link in minutes. e.g. value 0 represents permanent. Response\n1{ 2 \u0026#34;shortlink\u0026#34;:\u0026#34;P\u0026#34; 3} GET /api/info?shortlink=shortlink Params\nName Type Description shortlink string Required. Id of shortened. e.g. P Response","tags":null,"title":"ã€æ…•è¯¾ç½‘ã€‘Goå¼€å‘çŸ­åœ°å€æœåŠ¡"},{"categories":null,"contents":"Golang\nä»¥ä¸‹ä»£ç çš„è¾“å‡ºå†…å®¹ 1package main 2import ( 3\t\u0026#34;fmt\u0026#34; 4) 5 6func main() { 7\tdeferCall() 8} 9func deferCall() { 10\tdefer func() { fmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; before\u0026#34;) }() 11\tdefer func() { fmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; in process\u0026#34;) }() 12\tdefer func() { fmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; done\u0026#34;) }() 13\tpanic(\u0026#34;\u0026lt;\u0026lt;\u0026lt; panic here\u0026#34;) 14} è¾“å‡ºç»“æœå¦‚ä¸‹\n1\u0026gt;\u0026gt;\u0026gt; done 2\u0026gt;\u0026gt;\u0026gt; in process 3\u0026gt;\u0026gt;\u0026gt; before 4panic: \u0026lt;\u0026lt;\u0026lt; panic here deferæ‰§è¡Œçš„é¡ºåºæ˜¯åè¿›å…ˆå‡º, å‹æ ˆã€‚å½“å‡ºç°panicçš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§deferçš„åè¿›å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œï¼Œæœ€åæ‰ä¼šæ‰§è¡Œpanicã€‚\ndeferæ˜¯ä¸€ä¸ªå‹æ ˆè¿‡ç¨‹ã€‚\nè¿™æ®µä»£ç çš„è¾“å‡ºï¼Œä»¥åŠåŸå›  1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6\tslice := []int{0, 1, 2, 3} 7\tm := make(map[int]*int) 8 9\tfor key, val := range slice { 10\tm[key] = \u0026amp;val 11\t} 12 13\tfor k, v := range m { 14\tfmt.Println(k, \u0026#34;-\u0026gt;\u0026#34;, *v) 15\t} 16} ç»“æœè¾“å‡ºå¦‚ä¸‹\n10 -\u0026gt; 3 21 -\u0026gt; 3 32 -\u0026gt; 3 43 -\u0026gt; 3 for range å¾ªç¯ä¸­çš„key \u0026amp; val åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ã€‚\næ‰€æœ‰çš„m[key]çš„å–å€¼éƒ½ä¸ºå˜é‡valçš„åœ°å€ï¼Œval æœ€åè¢«èµ‹å€¼ä¸º3ã€‚\nå¦‚æœæŠŠfmt.Println(k, \u0026quot;-\u0026gt;\u0026quot;, *v) ä¿®æ”¹ä¸ºfmt.Println(k, \u0026quot;-\u0026gt;\u0026quot;, v) ç»“æœå¦‚ä¸‹, æ‰€æœ‰çš„m[key]éƒ½æŒ‡å‘äº†åŒä¸€åœ°å€\n10 -\u0026gt; 0xc0000b4008 21 -\u0026gt; 0xc0000b4008 32 -\u0026gt; 0xc0000b4008 43 -\u0026gt; 0xc0000b4008 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-12/","summary":"Golang\nä»¥ä¸‹ä»£ç çš„è¾“å‡ºå†…å®¹ 1package main 2import ( 3\t\u0026#34;fmt\u0026#34; 4) 5 6func main() { 7\tdeferCall() 8} 9func deferCall() { 10\tdefer func() { fmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; before\u0026#34;) }() 11\tdefer func() { fmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; in process\u0026#34;) }() 12\tdefer func() { fmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; done\u0026#34;) }() 13\tpanic(\u0026#34;\u0026lt;\u0026lt;\u0026lt; panic here\u0026#34;) 14} è¾“å‡ºç»“æœå¦‚ä¸‹\n1\u0026gt;\u0026gt;\u0026gt; done 2\u0026gt;\u0026gt;\u0026gt; in process 3\u0026gt;\u0026gt;\u0026gt; before 4panic: \u0026lt;\u0026lt;\u0026lt; panic here deferæ‰§è¡Œçš„é¡ºåºæ˜¯åè¿›å…ˆå‡º, å‹æ ˆã€‚å½“å‡ºç°panicçš„æ—¶å€™ï¼Œä¼šæŒ‰ç…§deferçš„åè¿›å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œï¼Œæœ€åæ‰ä¼šæ‰§è¡Œpanicã€‚\ndeferæ˜¯ä¸€ä¸ªå‹æ ˆè¿‡ç¨‹ã€‚\nè¿™æ®µä»£ç çš„è¾“å‡ºï¼Œä»¥åŠåŸå›  1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6\tslice := []int{0, 1, 2, 3} 7\tm := make(map[int]*int) 8 9\tfor key, val := range slice { 10\tm[key] = \u0026amp;val 11\t} 12 13\tfor k, v := range m { 14\tfmt.","tags":null,"title":"2021-03-12"},{"categories":null,"contents":"Golang\nä¸‹é¢ä¸¤æ®µä»£ç è¾“å‡ºä»€ä¹ˆ 1// 1. 2 func main() { 3 s := make([]int, 5) 4 s = append(s, 1, 2, 3) 5 fmt.Println(s) 6 } 7 8// 2. 9 func main() { 10 s := make([]int,0) 11 s = append(s,1,2,3,4) 12 fmt.Println(s) 13} è¾“å‡ºç»“æœå¦‚ä¸‹\n1[0 0 0 0 0 1 2 3] 2[1 2 3 4] ä½¿ç”¨make æ–°å»º slice ä¼šæ ¹æ®åˆå§‹åŒ–çš„å®¹é‡è¡¥0\nè¿™æ®µä»£ç çš„é—®é¢˜ 1 func funcMui(x,y int)(sum int,error){ 2 return x+y,nil 3 } æœ‰å¤šä¸ªè¿”å›å€¼çš„æ—¶å€™ï¼Œè¿”å›å€¼çš„åå­—è¦ä¹ˆå…¨éƒ¨çœç•¥ï¼Œè¦ä¹ˆå…¨éƒ¨å†™ä¸Š\nnew() ä¸make() çš„åŒºåˆ« new(T)å’Œmake(T, args)æ˜¯goè¯­è¨€çš„å†…å»ºå‡½æ•°ï¼Œç”¨æ¥åˆ†é…å†…å­˜ï¼Œä½†æ˜¯é€‚ç”¨çš„ç±»å‹ä¸åŒã€‚\nnew(T) ä¼šä¸ºTç±»å‹åˆ†é…å·²ç»ç½®é›¶çš„å†…å­˜ç©ºé—´ï¼Œå¹¶è¿”å›åœ°å€(æŒ‡é’ˆ)ï¼Œå³ç±»å‹ä¸º*Tçš„å€¼ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼Œè¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘é‚£ä¸ªæ–°åˆ†é…çš„ï¼Œç±»å‹ä¸ºTçš„é›¶å€¼ã€‚é€‚ç”¨äºå€¼ç±»å‹ï¼Œå¦‚æ•°ç»„ã€ç»“æ„ä½“ç­‰ã€‚\nmake(T,args) è¿”å›åˆå§‹åŒ–ä¹‹åçš„ T ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªå€¼å¹¶ä¸æ˜¯ T ç±»å‹çš„é›¶å€¼ï¼Œä¹Ÿä¸æ˜¯æŒ‡é’ˆ *Tï¼Œæ˜¯ç»è¿‡åˆå§‹åŒ–ä¹‹åçš„ T çš„å¼•ç”¨ã€‚make() åªé€‚ç”¨äº sliceã€map å’Œ channel.\n1func main() { 2\tfmt.Println(\u0026#34;\u0026gt;\u0026gt;\u0026gt; make: \u0026#34;) 3\tfmt.Println(make([]int, 4)) 4\tfmt.Println(make(map[string]int)) 5\tfmt.Println(make(chan int, 5)) 6 7\tfmt.Println(\u0026#34;\\n \u0026gt;\u0026gt;\u0026gt; new:\u0026#34;) 8\tfmt.Println(new(int)) 9} 1\u0026gt;\u0026gt;\u0026gt; make: 2[0 0 0 0] 3map[] 40xc0000ba000 5 6 \u0026gt;\u0026gt;\u0026gt; new: 70xc0000b4038 ä¸‹é¢è¿™æ®µä»£ç èƒ½å¦é€šè¿‡ç¼–è¯‘ï¼Œä¸èƒ½çš„è¯åŸå› æ˜¯ä»€ä¹ˆï¼›å¦‚æœèƒ½ï¼Œè¾“å‡ºä»€ä¹ˆã€‚ 1func main() { 2 list := new([]int) 3 list = append(list, 1) 4 fmt.Println(list) 5} ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œnew([]int) ä¹‹åçš„ list æ˜¯ä¸€ä¸ª *[]int ç±»å‹çš„æŒ‡é’ˆï¼Œä¸èƒ½å¯¹æŒ‡é’ˆæ‰§è¡Œ append æ“ä½œã€‚å¯ä»¥ä½¿ç”¨ make() åˆå§‹åŒ–ä¹‹åå†ç”¨ã€‚åŒæ ·çš„ï¼Œmap å’Œ channel å»ºè®®ä½¿ç”¨ make() æˆ–å­—é¢é‡çš„æ–¹å¼åˆå§‹åŒ–ï¼Œä¸è¦ç”¨ new() ã€‚\nä¸‹é¢è¿™æ®µä»£ç èƒ½å¦é€šè¿‡ç¼–è¯‘ï¼Œå¦‚æœå¯ä»¥ï¼Œè¾“å‡ºä»€ä¹ˆï¼Ÿ 1func main() { 2 s1 := []int{1, 2, 3} 3 s2 := []int{4, 5} 4 s1 = append(s1, s2) 5 fmt.Println(s1) 6} ä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚append() çš„ç¬¬äºŒä¸ªå‚æ•°ä¸èƒ½ç›´æ¥ä½¿ç”¨ sliceï¼Œéœ€ä½¿ç”¨ â€¦ æ“ä½œç¬¦ï¼Œå°†ä¸€ä¸ªåˆ‡ç‰‡è¿½åŠ åˆ°å¦ä¸€ä¸ªåˆ‡ç‰‡ä¸Šï¼šappend(s1,s2â€¦)ã€‚æˆ–è€…ç›´æ¥è·Ÿä¸Šå…ƒç´ ï¼Œå½¢å¦‚ï¼šappend(s1,1,2,3)ã€‚\nä¸‹é¢è¿™æ®µä»£ç èƒ½å¦é€šè¿‡ç¼–è¯‘ï¼Œå¦‚æœå¯ä»¥ï¼Œè¾“å‡ºä»€ä¹ˆï¼Ÿ 1var( 2 size := 1024 3 max_size = size*2 4) 5 6func main() { 7 fmt.Println(size,max_size) 8} ä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚è¿™é“é¢˜çš„ä¸»è¦çŸ¥è¯†ç‚¹æ˜¯å˜é‡å£°æ˜çš„ç®€çŸ­æ¨¡å¼ï¼Œå½¢å¦‚ï¼šx := 100ã€‚ä½†è¿™ç§å£°æ˜æ–¹å¼æœ‰é™åˆ¶ï¼š\n11.å¿…é¡»ä½¿ç”¨æ˜¾ç¤ºåˆå§‹åŒ–ï¼› 22.ä¸èƒ½æä¾›æ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨å¯¼ï¼› 33.åªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ç®€çŸ­æ¨¡å¼ï¼› ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-13/","summary":"Golang\nä¸‹é¢ä¸¤æ®µä»£ç è¾“å‡ºä»€ä¹ˆ 1// 1. 2 func main() { 3 s := make([]int, 5) 4 s = append(s, 1, 2, 3) 5 fmt.Println(s) 6 } 7 8// 2. 9 func main() { 10 s := make([]int,0) 11 s = append(s,1,2,3,4) 12 fmt.Println(s) 13} è¾“å‡ºç»“æœå¦‚ä¸‹\n1[0 0 0 0 0 1 2 3] 2[1 2 3 4] ä½¿ç”¨make æ–°å»º slice ä¼šæ ¹æ®åˆå§‹åŒ–çš„å®¹é‡è¡¥0\nè¿™æ®µä»£ç çš„é—®é¢˜ 1 func funcMui(x,y int)(sum int,error){ 2 return x+y,nil 3 } æœ‰å¤šä¸ªè¿”å›å€¼çš„æ—¶å€™ï¼Œè¿”å›å€¼çš„åå­—è¦ä¹ˆå…¨éƒ¨çœç•¥ï¼Œè¦ä¹ˆå…¨éƒ¨å†™ä¸Š","tags":null,"title":"2021-03-13"},{"categories":null,"contents":"Golang\nä½¿ç”¨channelå®ç°ç®€å•å¹¶å‘ï¼Œæ³¨æ„æ‰§è¡Œé¡ºåº\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sync\u0026#34; 6\t\u0026#34;time\u0026#34; 7) 8 9var wg sync.WaitGroup 10 11func printer(ch chan int) { 12\tfor i := range ch { 13\tfmt.Printf(\u0026#34;Received %d \\n\u0026#34;, i) 14\t\u0026lt;-time.After(time.Second / 5) 15\tfmt.Printf(\u0026#34;Job %v done \\n\u0026#34;, i) 16\t} 17\tprintln(\u0026#34;All Jobs done\u0026#34;) 18\twg.Done() 19\tprintln(\u0026#34;Finished\u0026#34;) 20} 21 22// main is the entry point for the program. 23func main() { 24\tc := make(chan int) 25\tgo printer(c) 26\twg.Add(1) 27 28\t// Send 5 integers on the channel. 29\tfor i := 1; i \u0026lt;= 5; i++ { 30\tc \u0026lt;- i 31\t} 32\tprintln(\u0026#34;\u0026gt;\u0026gt;\u0026gt; Close chan\u0026#34;) 33\tclose(c) 34\tprintln(\u0026#34;\u0026gt;\u0026gt;\u0026gt; Closed\u0026#34;) 35\twg.Wait() 36} æ‰§è¡Œç»“æœå¦‚å›¾ï¼š\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-14/","summary":"Golang\nä½¿ç”¨channelå®ç°ç®€å•å¹¶å‘ï¼Œæ³¨æ„æ‰§è¡Œé¡ºåº\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;sync\u0026#34; 6\t\u0026#34;time\u0026#34; 7) 8 9var wg sync.WaitGroup 10 11func printer(ch chan int) { 12\tfor i := range ch { 13\tfmt.Printf(\u0026#34;Received %d \\n\u0026#34;, i) 14\t\u0026lt;-time.After(time.Second / 5) 15\tfmt.Printf(\u0026#34;Job %v done \\n\u0026#34;, i) 16\t} 17\tprintln(\u0026#34;All Jobs done\u0026#34;) 18\twg.Done() 19\tprintln(\u0026#34;Finished\u0026#34;) 20} 21 22// main is the entry point for the program. 23func main() { 24\tc := make(chan int) 25\tgo printer(c) 26\twg.","tags":null,"title":"2021-03-14"},{"categories":null,"contents":"Golang\nè·å–å˜é‡çš„æ•°æ®ç±»å‹\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;reflect\u0026#34; 6) 7 8func main() { 9 10\t// string type : string 11\tvar1 := \u0026#34;hello world\u0026#34; 12 13\t// integer : int 14\tvar2 := 10 15 16\t// float : float64 17\tvar3 := 1.55 18 19\t// boolean : bool 20\tvar4 := true 21 22\t// shorthand string array declaration : []string 23\tvar5 := []string{\u0026#34;foo\u0026#34;, \u0026#34;bar\u0026#34;, \u0026#34;baz\u0026#34;} 24 25\t// map is reference datatype : map[string]string 26\tvar6 := map[int]string{100: \u0026#34;Ana\u0026#34;, 101: \u0026#34;Lisa\u0026#34;, 102: \u0026#34;Rob\u0026#34;} 27 28\t// complex64 and complex128 29\t// is basic datatype : complex128 30\tvar7 := complex(9, 15) 31 32\t// using %T format specifier to 33\t// determine the datatype of the variables 34 35\tfmt.Println(\u0026#34;Using Percent T with Printf\u0026#34;) 36 37\tfmt.Printf(\u0026#34;var1 = %T\\n\u0026#34;, var1) 38\tfmt.Printf(\u0026#34;var2 = %T\\n\u0026#34;, var2) 39\tfmt.Printf(\u0026#34;var3 = %T\\n\u0026#34;, var3) 40\tfmt.Printf(\u0026#34;var4 = %T\\n\u0026#34;, var4) 41\tfmt.Printf(\u0026#34;var5 = %T\\n\u0026#34;, var5) 42\tfmt.Printf(\u0026#34;var6 = %T\\n\u0026#34;, var6) 43\tfmt.Printf(\u0026#34;var7 = %T\\n\u0026#34;, var7) 44 45\t// using TypeOf() method of reflect package 46\t// to determine the datatype of the variables 47\tfmt.Println() 48\tfmt.Println(\u0026#34;Using reflect.TypeOf Function\u0026#34;) 49 50\tfmt.Println(\u0026#34;var1 = \u0026#34;, reflect.TypeOf(var1)) 51\tfmt.Println(\u0026#34;var2 = \u0026#34;, reflect.TypeOf(var2)) 52\tfmt.Println(\u0026#34;var3 = \u0026#34;, reflect.TypeOf(var3)) 53\tfmt.Println(\u0026#34;var4 = \u0026#34;, reflect.TypeOf(var4)) 54\tfmt.Println(\u0026#34;var5 = \u0026#34;, reflect.TypeOf(var5)) 55\tfmt.Println(\u0026#34;var6 = \u0026#34;, reflect.TypeOf(var6)) 56\tfmt.Println(\u0026#34;var7 = \u0026#34;, reflect.TypeOf(var7)) 57 58\t// using ValueOf() method of reflect package 59\t// to determine the value of the variable 60\t// Kind() method returns the datatype of the 61\t// value fetched by the ValueOf() method 62\tfmt.Println() 63\tfmt.Println(\u0026#34;Using reflect.ValueOf.Kind() Function\u0026#34;) 64 65\tfmt.Println(\u0026#34;var1 = \u0026#34;, reflect.ValueOf(var1).Kind()) 66\tfmt.Println(\u0026#34;var2 = \u0026#34;, reflect.ValueOf(var2).Kind()) 67\tfmt.Println(\u0026#34;var3 = \u0026#34;, reflect.ValueOf(var3).Kind()) 68\tfmt.Println(\u0026#34;var4 = \u0026#34;, reflect.ValueOf(var4).Kind()) 69\tfmt.Println(\u0026#34;var5 = \u0026#34;, reflect.ValueOf(var5).Kind()) 70\tfmt.Println(\u0026#34;var6 = \u0026#34;, reflect.ValueOf(var6).Kind()) 71\tfmt.Println(\u0026#34;var7 = \u0026#34;, reflect.ValueOf(var7).Kind()) 72 73} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-15/","summary":"Golang\nè·å–å˜é‡çš„æ•°æ®ç±»å‹\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;reflect\u0026#34; 6) 7 8func main() { 9 10\t// string type : string 11\tvar1 := \u0026#34;hello world\u0026#34; 12 13\t// integer : int 14\tvar2 := 10 15 16\t// float : float64 17\tvar3 := 1.55 18 19\t// boolean : bool 20\tvar4 := true 21 22\t// shorthand string array declaration : []string 23\tvar5 := []string{\u0026#34;foo\u0026#34;, \u0026#34;bar\u0026#34;, \u0026#34;baz\u0026#34;} 24 25\t// map is reference datatype : map[string]string 26\tvar6 := map[int]string{100: \u0026#34;Ana\u0026#34;, 101: \u0026#34;Lisa\u0026#34;, 102: \u0026#34;Rob\u0026#34;} 27 28\t// complex64 and complex128 29\t// is basic datatype : complex128 30\tvar7 := complex(9, 15) 31 32\t// using %T format specifier to 33\t// determine the datatype of the variables 34 35\tfmt.","tags":null,"title":"2021-03-15"},{"categories":null,"contents":"Golang\nåŒæ—¶å®šä¹‰å¤šä¸ªç›¸å…³çš„struct, è¿™æ ·å†™å¯è¯»æ€§æ›´å¥½ä¸€äº›\n1type ( 2\t// item defines the fields associated with the item tag 3\t// in the rss document. 4\titem struct { 5\tXMLName xml.Name `xml:\u0026#34;item\u0026#34;` 6\tPubDate string `xml:\u0026#34;pubDate\u0026#34;` 7\tTitle string `xml:\u0026#34;title\u0026#34;` 8\tDescription string `xml:\u0026#34;description\u0026#34;` 9\tLink string `xml:\u0026#34;link\u0026#34;` 10\tGUID string `xml:\u0026#34;guid\u0026#34;` 11\tGeoRssPoint string `xml:\u0026#34;georss:point\u0026#34;` 12\t} 13 14\t// image defines the fields associated with the image tag 15\t// in the rss document. 16\timage struct { 17\tXMLName xml.Name `xml:\u0026#34;image\u0026#34;` 18\tURL string `xml:\u0026#34;url\u0026#34;` 19\tTitle string `xml:\u0026#34;title\u0026#34;` 20\tLink string `xml:\u0026#34;link\u0026#34;` 21\t} 22 23\t// channel defines the fields associated with the channel tag 24\t// in the rss document. 25\tchannel struct { 26\tXMLName xml.Name `xml:\u0026#34;channel\u0026#34;` 27\tTitle string `xml:\u0026#34;title\u0026#34;` 28\tDescription string `xml:\u0026#34;description\u0026#34;` 29\tLink string `xml:\u0026#34;link\u0026#34;` 30\tPubDate string `xml:\u0026#34;pubDate\u0026#34;` 31\tLastBuildDate string `xml:\u0026#34;lastBuildDate\u0026#34;` 32\tTTL string `xml:\u0026#34;ttl\u0026#34;` 33\tLanguage string `xml:\u0026#34;language\u0026#34;` 34\tManagingEditor string `xml:\u0026#34;managingEditor\u0026#34;` 35\tWebMaster string `xml:\u0026#34;webMaster\u0026#34;` 36\tImage image `xml:\u0026#34;image\u0026#34;` 37\tItem []item `xml:\u0026#34;item\u0026#34;` 38\t} 39 40\t// rssDocument defines the fields associated with the rss document. 41\trssDocument struct { 42\tXMLName xml.Name `xml:\u0026#34;rss\u0026#34;` 43\tChannel channel `xml:\u0026#34;channel\u0026#34;` 44\t} 45) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-16/","summary":"Golang\nåŒæ—¶å®šä¹‰å¤šä¸ªç›¸å…³çš„struct, è¿™æ ·å†™å¯è¯»æ€§æ›´å¥½ä¸€äº›\n1type ( 2\t// item defines the fields associated with the item tag 3\t// in the rss document. 4\titem struct { 5\tXMLName xml.Name `xml:\u0026#34;item\u0026#34;` 6\tPubDate string `xml:\u0026#34;pubDate\u0026#34;` 7\tTitle string `xml:\u0026#34;title\u0026#34;` 8\tDescription string `xml:\u0026#34;description\u0026#34;` 9\tLink string `xml:\u0026#34;link\u0026#34;` 10\tGUID string `xml:\u0026#34;guid\u0026#34;` 11\tGeoRssPoint string `xml:\u0026#34;georss:point\u0026#34;` 12\t} 13 14\t// image defines the fields associated with the image tag 15\t// in the rss document.","tags":null,"title":"2021-03-16"},{"categories":null,"contents":"Golang\n1// A map of registered matchers for searching. 2var matchers = make(map[string]Matcher) 3 4// Run performs the search logic. 5func Run(searchTerm string) { 6\t// Retrieve the list of feeds to search through. 7\tfeeds, err := RetrieveFeeds() 8\tif err != nil { 9\tlog.Fatal(err) 10\t} 11 12\t// Create an unbuffered channel to receive match results to display. 13\tresults := make(chan *Result) 14 15\t// Setup a wait group so we can process all the feeds. 16\tvar waitGroup sync.WaitGroup 17 18\t// Set the number of goroutines we need to wait for while 19\t// they process the individual feeds. 20\twaitGroup.Add(len(feeds)) 21 22\t// Launch a goroutine for each feed to find the results. 23\tfor _, feed := range feeds { 24\t// Retrieve a matcher for the search. 25\tmatcher, exists := matchers[feed.Type] 26\tif !exists { 27\tmatcher = matchers[\u0026#34;default\u0026#34;] 28\t} 29 30\t// Launch the goroutine to perform the search. 31\tgo func(matcher Matcher, feed *Feed) { 32\tMatch(matcher, feed, searchTerm, results) 33\twaitGroup.Done() 34\t}(matcher, feed) 35\t} 36 37\t// Launch a goroutine to monitor when all the work is done. 38\tgo func() { 39\t// Wait for everything to be processed. 40\twaitGroup.Wait() 41 42\t// Close the channel to signal to the Display 43\t// function that we can exit the program. 44\tclose(results) 45\t}() 46 47\t// Start displaying results as they are available and 48\t// return after the final result is displayed. 49\tDisplay(results) 50} 51 52// Register is called to register a matcher for use by the program. 53func Register(feedType string, matcher Matcher) { 54\tif _, exists := matchers[feedType]; exists { 55\tlog.Fatalln(feedType, \u0026#34;Matcher already registered\u0026#34;) 56\t} 57 58\tlog.Println(\u0026#34;Register\u0026#34;, feedType, \u0026#34;matcher\u0026#34;) 59\tmatchers[feedType] = matcher 60} é€šè¿‡Register()æ–¹æ³•æ›´æ–° matchers\nwg.Wait() å¦‚æœwg.Add(n)æ²¡æœ‰å®Œæˆå¯¹åº”çš„wg.Done()å°±ä¼šä¸€ç›´hangåœ¨è¿™é‡Œ\nfor v:=range chan åªè¦chanæ²¡æœ‰å…³é—­ï¼Œå°±ä¼šä¸€ç›´hangåœ¨è¿™é‡Œ\nDisplay()è¿™æ ·ç”¨ä¼šä¸ä¼šæ˜“è¯»ä¸€ç‚¹\n1\t// Start displaying results as they are available and 2\t// return after the final result is displayed. 3\tgo Display(results) 4 5\t// Wait for everything to be processed. 6\twaitGroup.Wait() 7 8\t// Close the channel to signal to the Display 9\t// function that we can exit the program. 10\tclose(results) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-17/","summary":"Golang\n1// A map of registered matchers for searching. 2var matchers = make(map[string]Matcher) 3 4// Run performs the search logic. 5func Run(searchTerm string) { 6\t// Retrieve the list of feeds to search through. 7\tfeeds, err := RetrieveFeeds() 8\tif err != nil { 9\tlog.Fatal(err) 10\t} 11 12\t// Create an unbuffered channel to receive match results to display. 13\tresults := make(chan *Result) 14 15\t// Setup a wait group so we can process all the feeds.","tags":null,"title":"2021-03-17"},{"categories":null,"contents":"Golang\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-xxxx/","summary":"Golang","tags":null,"title":"2021-03-xx"},{"categories":null,"contents":"Flush\næ¸…ç©ºç¼“å†²åŒº\né¦–å…ˆï¼Œå’±ä»¬è®¾æƒ³è¦ç»™é±¼ç¼¸æ¢æ°´ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ°´æ³µï¼Œæ°´æ³µæ˜¯è¿æ¥é±¼ç¼¸å’Œä¸‹æ°´é“çš„ï¼Œå’±ä»¬çš„ä»»åŠ¡å°±æ˜¯å°†é±¼ç¼¸é‡Œé¢æ°´å…¨æŠ½å¹²ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ°´ç®¡å½“åšç¼“å†²åŒºã€‚å¦‚æœå’±ä»¬ä¸€è§é±¼ç¼¸é‡Œé¢æ°´æŠ½å¹²äº†å°±ç«‹é©¬å…³äº†æ°´æ³µï¼Œè¿™æ—¶ä¼šå‘ç°æ°´ç®¡é‡Œè¿˜æœ‰æ¥ä¸åŠé€šè¿‡æ°´æ³µæµå‘ä¸‹æ°´é“çš„æ®‹ç•™æ°´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæŠ½æ°´å½“åšè¯»æ•°æ®ï¼Œæ’æ°´å½“åšå†™æ•°æ®ï¼Œæ°´ç®¡å½“åšç¼“å†²åŒºï¼Œè¿™æ ·å°±å®¹æ˜“æ˜ç™½äº†ã€‚\né‚£ä¹ˆè¿™æ ·ä¸€æ¥æˆ‘ä»¬å¦‚æœä¸­é€”è°ƒç”¨close()æ–¹æ³•ï¼Œè¾“å‡ºåŒºä¹Ÿè¿˜æ˜¯æœ‰æ•°æ®çš„ï¼Œå°±åƒæ°´ç¼¸é‡Œæœ‰æ°´ï¼Œåªæ˜¯åœ¨ç¼“å†²åŒºé—ç•™äº†ä¸€éƒ¨åˆ†ï¼Œè¿™æ—¶å¦‚æœæˆ‘ä»¬å…ˆè°ƒç”¨flush()æ–¹æ³•ï¼Œå°±ä¼šå¼ºåˆ¶æŠŠæ•°æ®è¾“å‡ºï¼Œç¼“å­˜åŒºå°±æ¸…ç©ºäº†ï¼Œæœ€åå†å…³é—­è¯»å†™æµè°ƒç”¨close()å°±å®Œæˆäº†ã€‚\nç¼“å†²åŒºå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºä¸€æ®µå†…å­˜åŒºåŸŸã€‚å¯ä»¥ç®€å•åœ°æŠŠç¼“å†²åŒºç†è§£ä¸ºä¸€æ®µç‰¹æ®Šçš„å†…å­˜ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé¢‘ç¹åœ°æ“ä½œä¸€ä¸ªèµ„æºï¼ˆå¦‚æ–‡ä»¶æˆ–æ•°æ®åº“ï¼‰ï¼Œåˆ™æ€§èƒ½ä¼šå¾ˆä½ï¼Œæ­¤æ—¶ä¸ºäº†æå‡æ€§èƒ½ï¼Œå°±å¯ä»¥å°†ä¸€éƒ¨åˆ†æ•°æ®æš‚æ—¶è¯»å…¥åˆ°å†…å­˜çš„ä¸€å—åŒºåŸŸä¹‹ä¸­ï¼Œä»¥åç›´æ¥ä»æ­¤åŒºåŸŸä¸­è¯»å–æ•°æ®å³å¯ï¼Œå› ä¸ºè¯»å–å†…å­˜é€Ÿåº¦ä¼šæ¯”è¾ƒå¿«ï¼Œè¿™æ ·å¯ä»¥æå‡ç¨‹åºçš„æ€§èƒ½ã€‚\nhttps://blog.csdn.net/qq_38129062/article/details/87115620\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-04-20/","summary":"Flush\næ¸…ç©ºç¼“å†²åŒº\né¦–å…ˆï¼Œå’±ä»¬è®¾æƒ³è¦ç»™é±¼ç¼¸æ¢æ°´ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ°´æ³µï¼Œæ°´æ³µæ˜¯è¿æ¥é±¼ç¼¸å’Œä¸‹æ°´é“çš„ï¼Œå’±ä»¬çš„ä»»åŠ¡å°±æ˜¯å°†é±¼ç¼¸é‡Œé¢æ°´å…¨æŠ½å¹²ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ°´ç®¡å½“åšç¼“å†²åŒºã€‚å¦‚æœå’±ä»¬ä¸€è§é±¼ç¼¸é‡Œé¢æ°´æŠ½å¹²äº†å°±ç«‹é©¬å…³äº†æ°´æ³µï¼Œè¿™æ—¶ä¼šå‘ç°æ°´ç®¡é‡Œè¿˜æœ‰æ¥ä¸åŠé€šè¿‡æ°´æ³µæµå‘ä¸‹æ°´é“çš„æ®‹ç•™æ°´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæŠ½æ°´å½“åšè¯»æ•°æ®ï¼Œæ’æ°´å½“åšå†™æ•°æ®ï¼Œæ°´ç®¡å½“åšç¼“å†²åŒºï¼Œè¿™æ ·å°±å®¹æ˜“æ˜ç™½äº†ã€‚\né‚£ä¹ˆè¿™æ ·ä¸€æ¥æˆ‘ä»¬å¦‚æœä¸­é€”è°ƒç”¨close()æ–¹æ³•ï¼Œè¾“å‡ºåŒºä¹Ÿè¿˜æ˜¯æœ‰æ•°æ®çš„ï¼Œå°±åƒæ°´ç¼¸é‡Œæœ‰æ°´ï¼Œåªæ˜¯åœ¨ç¼“å†²åŒºé—ç•™äº†ä¸€éƒ¨åˆ†ï¼Œè¿™æ—¶å¦‚æœæˆ‘ä»¬å…ˆè°ƒç”¨flush()æ–¹æ³•ï¼Œå°±ä¼šå¼ºåˆ¶æŠŠæ•°æ®è¾“å‡ºï¼Œç¼“å­˜åŒºå°±æ¸…ç©ºäº†ï¼Œæœ€åå†å…³é—­è¯»å†™æµè°ƒç”¨close()å°±å®Œæˆäº†ã€‚\nç¼“å†²åŒºå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºä¸€æ®µå†…å­˜åŒºåŸŸã€‚å¯ä»¥ç®€å•åœ°æŠŠç¼“å†²åŒºç†è§£ä¸ºä¸€æ®µç‰¹æ®Šçš„å†…å­˜ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé¢‘ç¹åœ°æ“ä½œä¸€ä¸ªèµ„æºï¼ˆå¦‚æ–‡ä»¶æˆ–æ•°æ®åº“ï¼‰ï¼Œåˆ™æ€§èƒ½ä¼šå¾ˆä½ï¼Œæ­¤æ—¶ä¸ºäº†æå‡æ€§èƒ½ï¼Œå°±å¯ä»¥å°†ä¸€éƒ¨åˆ†æ•°æ®æš‚æ—¶è¯»å…¥åˆ°å†…å­˜çš„ä¸€å—åŒºåŸŸä¹‹ä¸­ï¼Œä»¥åç›´æ¥ä»æ­¤åŒºåŸŸä¸­è¯»å–æ•°æ®å³å¯ï¼Œå› ä¸ºè¯»å–å†…å­˜é€Ÿåº¦ä¼šæ¯”è¾ƒå¿«ï¼Œè¿™æ ·å¯ä»¥æå‡ç¨‹åºçš„æ€§èƒ½ã€‚\nhttps://blog.csdn.net/qq_38129062/article/details/87115620","tags":null,"title":"2021-04-20"},{"categories":null,"contents":"Flush\næ¸…ç©ºç¼“å†²åŒº\né¦–å…ˆï¼Œå’±ä»¬è®¾æƒ³è¦ç»™é±¼ç¼¸æ¢æ°´ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ°´æ³µï¼Œæ°´æ³µæ˜¯è¿æ¥é±¼ç¼¸å’Œä¸‹æ°´é“çš„ï¼Œå’±ä»¬çš„ä»»åŠ¡å°±æ˜¯å°†é±¼ç¼¸é‡Œé¢æ°´å…¨æŠ½å¹²ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ°´ç®¡å½“åšç¼“å†²åŒºã€‚å¦‚æœå’±ä»¬ä¸€è§é±¼ç¼¸é‡Œé¢æ°´æŠ½å¹²äº†å°±ç«‹é©¬å…³äº†æ°´æ³µï¼Œè¿™æ—¶ä¼šå‘ç°æ°´ç®¡é‡Œè¿˜æœ‰æ¥ä¸åŠé€šè¿‡æ°´æ³µæµå‘ä¸‹æ°´é“çš„æ®‹ç•™æ°´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæŠ½æ°´å½“åšè¯»æ•°æ®ï¼Œæ’æ°´å½“åšå†™æ•°æ®ï¼Œæ°´ç®¡å½“åšç¼“å†²åŒºï¼Œè¿™æ ·å°±å®¹æ˜“æ˜ç™½äº†ã€‚\né‚£ä¹ˆè¿™æ ·ä¸€æ¥æˆ‘ä»¬å¦‚æœä¸­é€”è°ƒç”¨close()æ–¹æ³•ï¼Œè¾“å‡ºåŒºä¹Ÿè¿˜æ˜¯æœ‰æ•°æ®çš„ï¼Œå°±åƒæ°´ç¼¸é‡Œæœ‰æ°´ï¼Œåªæ˜¯åœ¨ç¼“å†²åŒºé—ç•™äº†ä¸€éƒ¨åˆ†ï¼Œè¿™æ—¶å¦‚æœæˆ‘ä»¬å…ˆè°ƒç”¨flush()æ–¹æ³•ï¼Œå°±ä¼šå¼ºåˆ¶æŠŠæ•°æ®è¾“å‡ºï¼Œç¼“å­˜åŒºå°±æ¸…ç©ºäº†ï¼Œæœ€åå†å…³é—­è¯»å†™æµè°ƒç”¨close()å°±å®Œæˆäº†ã€‚\nç¼“å†²åŒºå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºä¸€æ®µå†…å­˜åŒºåŸŸã€‚å¯ä»¥ç®€å•åœ°æŠŠç¼“å†²åŒºç†è§£ä¸ºä¸€æ®µç‰¹æ®Šçš„å†…å­˜ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé¢‘ç¹åœ°æ“ä½œä¸€ä¸ªèµ„æºï¼ˆå¦‚æ–‡ä»¶æˆ–æ•°æ®åº“ï¼‰ï¼Œåˆ™æ€§èƒ½ä¼šå¾ˆä½ï¼Œæ­¤æ—¶ä¸ºäº†æå‡æ€§èƒ½ï¼Œå°±å¯ä»¥å°†ä¸€éƒ¨åˆ†æ•°æ®æš‚æ—¶è¯»å…¥åˆ°å†…å­˜çš„ä¸€å—åŒºåŸŸä¹‹ä¸­ï¼Œä»¥åç›´æ¥ä»æ­¤åŒºåŸŸä¸­è¯»å–æ•°æ®å³å¯ï¼Œå› ä¸ºè¯»å–å†…å­˜é€Ÿåº¦ä¼šæ¯”è¾ƒå¿«ï¼Œè¿™æ ·å¯ä»¥æå‡ç¨‹åºçš„æ€§èƒ½ã€‚\nhttps://blog.csdn.net/qq_38129062/article/details/87115620\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-03-21/","summary":"Flush\næ¸…ç©ºç¼“å†²åŒº\né¦–å…ˆï¼Œå’±ä»¬è®¾æƒ³è¦ç»™é±¼ç¼¸æ¢æ°´ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ°´æ³µï¼Œæ°´æ³µæ˜¯è¿æ¥é±¼ç¼¸å’Œä¸‹æ°´é“çš„ï¼Œå’±ä»¬çš„ä»»åŠ¡å°±æ˜¯å°†é±¼ç¼¸é‡Œé¢æ°´å…¨æŠ½å¹²ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ°´ç®¡å½“åšç¼“å†²åŒºã€‚å¦‚æœå’±ä»¬ä¸€è§é±¼ç¼¸é‡Œé¢æ°´æŠ½å¹²äº†å°±ç«‹é©¬å…³äº†æ°´æ³µï¼Œè¿™æ—¶ä¼šå‘ç°æ°´ç®¡é‡Œè¿˜æœ‰æ¥ä¸åŠé€šè¿‡æ°´æ³µæµå‘ä¸‹æ°´é“çš„æ®‹ç•™æ°´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæŠ½æ°´å½“åšè¯»æ•°æ®ï¼Œæ’æ°´å½“åšå†™æ•°æ®ï¼Œæ°´ç®¡å½“åšç¼“å†²åŒºï¼Œè¿™æ ·å°±å®¹æ˜“æ˜ç™½äº†ã€‚\né‚£ä¹ˆè¿™æ ·ä¸€æ¥æˆ‘ä»¬å¦‚æœä¸­é€”è°ƒç”¨close()æ–¹æ³•ï¼Œè¾“å‡ºåŒºä¹Ÿè¿˜æ˜¯æœ‰æ•°æ®çš„ï¼Œå°±åƒæ°´ç¼¸é‡Œæœ‰æ°´ï¼Œåªæ˜¯åœ¨ç¼“å†²åŒºé—ç•™äº†ä¸€éƒ¨åˆ†ï¼Œè¿™æ—¶å¦‚æœæˆ‘ä»¬å…ˆè°ƒç”¨flush()æ–¹æ³•ï¼Œå°±ä¼šå¼ºåˆ¶æŠŠæ•°æ®è¾“å‡ºï¼Œç¼“å­˜åŒºå°±æ¸…ç©ºäº†ï¼Œæœ€åå†å…³é—­è¯»å†™æµè°ƒç”¨close()å°±å®Œæˆäº†ã€‚\nç¼“å†²åŒºå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºä¸€æ®µå†…å­˜åŒºåŸŸã€‚å¯ä»¥ç®€å•åœ°æŠŠç¼“å†²åŒºç†è§£ä¸ºä¸€æ®µç‰¹æ®Šçš„å†…å­˜ã€‚æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé¢‘ç¹åœ°æ“ä½œä¸€ä¸ªèµ„æºï¼ˆå¦‚æ–‡ä»¶æˆ–æ•°æ®åº“ï¼‰ï¼Œåˆ™æ€§èƒ½ä¼šå¾ˆä½ï¼Œæ­¤æ—¶ä¸ºäº†æå‡æ€§èƒ½ï¼Œå°±å¯ä»¥å°†ä¸€éƒ¨åˆ†æ•°æ®æš‚æ—¶è¯»å…¥åˆ°å†…å­˜çš„ä¸€å—åŒºåŸŸä¹‹ä¸­ï¼Œä»¥åç›´æ¥ä»æ­¤åŒºåŸŸä¸­è¯»å–æ•°æ®å³å¯ï¼Œå› ä¸ºè¯»å–å†…å­˜é€Ÿåº¦ä¼šæ¯”è¾ƒå¿«ï¼Œè¿™æ ·å¯ä»¥æå‡ç¨‹åºçš„æ€§èƒ½ã€‚\nhttps://blog.csdn.net/qq_38129062/article/details/87115620","tags":null,"title":"2021-04-21"},{"categories":null,"contents":" 1package main 2 3import \u0026#34;fmt\u0026#34; 4 5var testMap = map[string]map[string]struct { 6\tName string 7}{ 8\t\u0026#34;first\u0026#34;: {\u0026#34;second\u0026#34;: {Name: \u0026#34;12312\u0026#34;}}, 9\t\u0026#34;second\u0026#34;: {\u0026#34;second\u0026#34;: {\u0026#34;12312\u0026#34;}}, 10} 11 12func main() { 13\td := testMap[\u0026#34;first\u0026#34;][\u0026#34;second\u0026#34;].Name 14\tfmt.Printf(\u0026#34;++-%v-++\\n\u0026#34;, d) 15 16 17 // map ä¸ä¼šæŠ¥ nil 18\tc := testMap[\u0026#34;first22\u0026#34;][\u0026#34;second\u0026#34;].Name 19\tfmt.Printf(\u0026#34;++-%v-++\\n\u0026#34;, c) 20} ç»“æœ\n1++-12312-++ 2++--++ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-05-20/","summary":" 1package main 2 3import \u0026#34;fmt\u0026#34; 4 5var testMap = map[string]map[string]struct { 6\tName string 7}{ 8\t\u0026#34;first\u0026#34;: {\u0026#34;second\u0026#34;: {Name: \u0026#34;12312\u0026#34;}}, 9\t\u0026#34;second\u0026#34;: {\u0026#34;second\u0026#34;: {\u0026#34;12312\u0026#34;}}, 10} 11 12func main() { 13\td := testMap[\u0026#34;first\u0026#34;][\u0026#34;second\u0026#34;].Name 14\tfmt.Printf(\u0026#34;++-%v-++\\n\u0026#34;, d) 15 16 17 // map ä¸ä¼šæŠ¥ nil 18\tc := testMap[\u0026#34;first22\u0026#34;][\u0026#34;second\u0026#34;].Name 19\tfmt.Printf(\u0026#34;++-%v-++\\n\u0026#34;, c) 20} ç»“æœ\n1++-12312-++ 2++--++ ","tags":null,"title":"2021-05-20"},{"categories":null,"contents":"rwarestse ewartawe\n-gcflags=-l\n1. çº¿ä¸Šçš„é…ç½®æ–‡ä»¶å†™åœ¨äº†å“ªé‡Œ 1GOMAXPROCS = 8 2TSDB_HOST = bytetsd-query-server-prod-ppe-va.byted.org 3 4 5# influxdb é…ç½® æœ¬åœ°å¦‚ä½•è°ƒè¯• ä¸€äº›ç‰¹æ®Šçš„tokençš„è§£æ NaNAsZero, not_sliteral_or, nullAsZero æ˜¯å¦è¿˜å¯ä»¥rebase bosunå¼€æºç‰ˆæœ¬ ui fenbu cs Trace bytetrace\nexpr ï¼ˆcontextï¼‰ trace å¯¹é½å…¶ä»–è¯­è¨€çš„æ¡†æ¶ï¼Œ ä¾‹å¦‚ginex context\nstate \u0026ndash;\u0026gt; context\ninf.bytesd.bosun\nLog slog\nError errors ä¸šåŠ¡çŠ¶æ€ç \nerr\né™æ€\né200\n5001 æ‰§è¡Œå¤±è´¥ï¼ŒåŠ¨æ€å‚æ•°è§£æå¤±è´¥ï¼Œ durationï¼Œ è®¡ç®—é”™è¯¯\n5002 runtime panic\n5003 panic string\nå¯¹é½trace\næ–°åŠ çš„ä¸€äº›å‡½æ•° funcs.go\npprof 8071\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-05-26/","summary":"rwarestse ewartawe\n-gcflags=-l\n1. çº¿ä¸Šçš„é…ç½®æ–‡ä»¶å†™åœ¨äº†å“ªé‡Œ 1GOMAXPROCS = 8 2TSDB_HOST = bytetsd-query-server-prod-ppe-va.byted.org 3 4 5# influxdb é…ç½® æœ¬åœ°å¦‚ä½•è°ƒè¯• ä¸€äº›ç‰¹æ®Šçš„tokençš„è§£æ NaNAsZero, not_sliteral_or, nullAsZero æ˜¯å¦è¿˜å¯ä»¥rebase bosunå¼€æºç‰ˆæœ¬ ui fenbu cs Trace bytetrace\nexpr ï¼ˆcontextï¼‰ trace å¯¹é½å…¶ä»–è¯­è¨€çš„æ¡†æ¶ï¼Œ ä¾‹å¦‚ginex context\nstate \u0026ndash;\u0026gt; context\ninf.bytesd.bosun\nLog slog\nError errors ä¸šåŠ¡çŠ¶æ€ç \nerr\né™æ€\né200\n5001 æ‰§è¡Œå¤±è´¥ï¼ŒåŠ¨æ€å‚æ•°è§£æå¤±è´¥ï¼Œ durationï¼Œ è®¡ç®—é”™è¯¯\n5002 runtime panic\n5003 panic string\nå¯¹é½trace\næ–°åŠ çš„ä¸€äº›å‡½æ•° funcs.go\npprof 8071","tags":null,"title":"2021-05-26"},{"categories":null,"contents":"rwarestse ewartawe\n-gcflags=-l\n1. çº¿ä¸Šçš„é…ç½®æ–‡ä»¶å†™åœ¨äº†å“ªé‡Œ 1GOMAXPROCS = 8 2TSDB_HOST = bytetsd-query-server-prod-ppe-va.byted.org 3 4 5# influxdb é…ç½® æœ¬åœ°å¦‚ä½•è°ƒè¯• ä¸€äº›ç‰¹æ®Šçš„tokençš„è§£æ NaNAsZero, not_sliteral_or, nullAsZero æ˜¯å¦è¿˜å¯ä»¥rebase bosunå¼€æºç‰ˆæœ¬ ui fenbu ssssTrace bytetrace\nexpr ï¼ˆcontextï¼‰ trace å¯¹é½å…¶ä»–è¯­è¨€çš„æ¡†æ¶ï¼Œ ä¾‹å¦‚ginex context\nstate \u0026ndash;\u0026gt; context\ninf.bytesd.bosun\nLog slog\nError errors ä¸šåŠ¡çŠ¶æ€ç \nerr\né™æ€\né200\n5001 æ‰§è¡Œå¤±è´¥ï¼ŒåŠ¨æ€å‚æ•°è§£æå¤±è´¥ï¼Œ durationï¼Œ è®¡ç®—é”™è¯¯\n5002 runtime panic\n5003 panic string\nå¯¹é½trace\næ–°åŠ çš„ä¸€äº›å‡½æ•° funcs.go\npprof 8071\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-05-27/","summary":"rwarestse ewartawe\n-gcflags=-l\n1. çº¿ä¸Šçš„é…ç½®æ–‡ä»¶å†™åœ¨äº†å“ªé‡Œ 1GOMAXPROCS = 8 2TSDB_HOST = bytetsd-query-server-prod-ppe-va.byted.org 3 4 5# influxdb é…ç½® æœ¬åœ°å¦‚ä½•è°ƒè¯• ä¸€äº›ç‰¹æ®Šçš„tokençš„è§£æ NaNAsZero, not_sliteral_or, nullAsZero æ˜¯å¦è¿˜å¯ä»¥rebase bosunå¼€æºç‰ˆæœ¬ ui fenbu ssssTrace bytetrace\nexpr ï¼ˆcontextï¼‰ trace å¯¹é½å…¶ä»–è¯­è¨€çš„æ¡†æ¶ï¼Œ ä¾‹å¦‚ginex context\nstate \u0026ndash;\u0026gt; context\ninf.bytesd.bosun\nLog slog\nError errors ä¸šåŠ¡çŠ¶æ€ç \nerr\né™æ€\né200\n5001 æ‰§è¡Œå¤±è´¥ï¼ŒåŠ¨æ€å‚æ•°è§£æå¤±è´¥ï¼Œ durationï¼Œ è®¡ç®—é”™è¯¯\n5002 runtime panic\n5003 panic string\nå¯¹é½trace\næ–°åŠ çš„ä¸€äº›å‡½æ•° funcs.go\npprof 8071","tags":null,"title":"2021-05-26"},{"categories":null,"contents":"sync.pool\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/interview/daily/2021-06-01/","summary":"sync.pool","tags":null,"title":"2021-06-01"},{"categories":null,"contents":" Telegraf is an agent for collecting metrics and writing the to InfluxDB or other outputs. ä½¿ç”¨bosunä¹‹å‰é¦–å…ˆè¦äº†è§£ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®ï¼Œæ—¶åºæ•°æ®çš„ç»„æˆéƒ¨åˆ†ä»¥åŠæ—¶åºæ•°æ®çš„å¸¸ç”¨æŸ¥è¯¢\næ—¶åºæ•°æ®çš„ç±»å‹ counter\nguage(store)\nBosunçš„æ•°æ®ç±»å‹ Scalar NumberSetï¼š Group+Scalar Bosun æŸ¥è¯¢è¯­æ³• ç®€å•æŸ¥è¯¢ æŸ¥è¯¢è¿‡å»10åˆ†é’Ÿåˆ°è¿‡å»1åˆ†é’Ÿä¹‹é—´çš„æ—¶åºæ•°æ®\navgæ˜¯æ—¶åºæ•°æ®åº“çš„çš„è¿ç®—ï¼Œå¯¹ä¸åŒçš„tag setçš„æ•°æ®æ±‚å¹³å‡\næœ€å¤–é¢çš„avg æ˜¯å¯¹è¿™æ®µæ—¶é—´å†…çš„æ—¶åºæ•°æ®åšä¸€ä¸ªå¹³å‡ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°å€¼\nå®æ›¿æ¢ è¿ç®—çš„æ—¶å€™ä¼šå¯¹å˜é‡è¿›è¡Œå®æ›¿æ¢\nOpenTSDB\nå¦‚æœæ²¡æœ‰æ•°æ®çš„æ—¶å€™ä¼šå¯¼è‡´bosunæŸ¥è¯¢å¤±è´¥ï¼Œå¯ä»¥é‡‡å–ä¸ä¸Š\n1avg(100*q(\u0026#34;avg:1m-avg-zero:store:toutiao.tce.sysprobe.aweme.recommend.predict.cpu.usage.pod{sidecar_psm=ad.qa.java_sidecar,pod_name=dp-cb2f23ec64-6987c9d65d-ds7j5}\u0026#34;,\u0026#34;1h\u0026#34;,\u0026#34;\u0026#34;)/q(\u0026#34;avg:1m-avg:store:toutiao.tce.sysprobe.aweme.recommend.predict.cpu.limit.pod{sidecar_psm=ad.qa.java_sidecar,pod_name=dp-cb2f23ec64-6987c9d65d-ds7j5}\u0026#34;,\u0026#34;1h\u0026#34;,\u0026#34;\u0026#34;)) Streak è¿ç»­é0 æ•°æ®çš„æœ€å¤§é•¿åº¦\nhttps://blog.csdn.net/lslxdx/article/details/79454916\nè½¬ç½®\nInfluxDB 1influx(\u0026#34;iaas_metrics\u0026#34;, \u0026#39;\u0026#39;\u0026#39;SELECT sum(value) FROM \u0026#34;host_CpuSystem\u0026#34; group by \u0026#34;resource_id\u0026#34; \u0026#39;\u0026#39;\u0026#39;, \u0026#34;7d\u0026#34;, \u0026#34;2m\u0026#34;, \u0026#34;1m\u0026#34;) Bosun, Time Series, and OpenTSDB\u0026rsquo;s DataModel An introduction to the data model of Bosun\u0026rsquo;s Primary time series backend OpenTSDB. Time Series, Metircs and Tags, Aggregation, Rate Calculation, and Downsampling are covered. These features are demoed using Bosun\u0026rsquo;s graphing interface.\nTime Series A Series of observations , each recorded as a Time and Date with an associated Value.\n1Observation on 08-22-2015 10:20:01 of 10 2Observation on 08-22-2015 10:20:15 of 20 3Observation on ... of ... Open TSDB Time Series Database\nEach Time Series in the Database in Uniquely Identified by:\nA Metric Name\nA Set of Tags\nA Tag is made of : A Tag Key \u0026amp; A Tag Value\nå‚è€ƒæ–‡æ¡£ https://blog.csdn.net/lslxdx/article/details/79454916\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/TimeSeries/bosun/","summary":"Telegraf is an agent for collecting metrics and writing the to InfluxDB or other outputs. ä½¿ç”¨bosunä¹‹å‰é¦–å…ˆè¦äº†è§£ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®ï¼Œæ—¶åºæ•°æ®çš„ç»„æˆéƒ¨åˆ†ä»¥åŠæ—¶åºæ•°æ®çš„å¸¸ç”¨æŸ¥è¯¢\næ—¶åºæ•°æ®çš„ç±»å‹ counter\nguage(store)\nBosunçš„æ•°æ®ç±»å‹ Scalar NumberSetï¼š Group+Scalar Bosun æŸ¥è¯¢è¯­æ³• ç®€å•æŸ¥è¯¢ æŸ¥è¯¢è¿‡å»10åˆ†é’Ÿåˆ°è¿‡å»1åˆ†é’Ÿä¹‹é—´çš„æ—¶åºæ•°æ®\navgæ˜¯æ—¶åºæ•°æ®åº“çš„çš„è¿ç®—ï¼Œå¯¹ä¸åŒçš„tag setçš„æ•°æ®æ±‚å¹³å‡\næœ€å¤–é¢çš„avg æ˜¯å¯¹è¿™æ®µæ—¶é—´å†…çš„æ—¶åºæ•°æ®åšä¸€ä¸ªå¹³å‡ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°å€¼\nå®æ›¿æ¢ è¿ç®—çš„æ—¶å€™ä¼šå¯¹å˜é‡è¿›è¡Œå®æ›¿æ¢\nOpenTSDB\nå¦‚æœæ²¡æœ‰æ•°æ®çš„æ—¶å€™ä¼šå¯¼è‡´bosunæŸ¥è¯¢å¤±è´¥ï¼Œå¯ä»¥é‡‡å–ä¸ä¸Š\n1avg(100*q(\u0026#34;avg:1m-avg-zero:store:toutiao.tce.sysprobe.aweme.recommend.predict.cpu.usage.pod{sidecar_psm=ad.qa.java_sidecar,pod_name=dp-cb2f23ec64-6987c9d65d-ds7j5}\u0026#34;,\u0026#34;1h\u0026#34;,\u0026#34;\u0026#34;)/q(\u0026#34;avg:1m-avg:store:toutiao.tce.sysprobe.aweme.recommend.predict.cpu.limit.pod{sidecar_psm=ad.qa.java_sidecar,pod_name=dp-cb2f23ec64-6987c9d65d-ds7j5}\u0026#34;,\u0026#34;1h\u0026#34;,\u0026#34;\u0026#34;)) Streak è¿ç»­é0 æ•°æ®çš„æœ€å¤§é•¿åº¦\nhttps://blog.csdn.net/lslxdx/article/details/79454916\nè½¬ç½®\nInfluxDB 1influx(\u0026#34;iaas_metrics\u0026#34;, \u0026#39;\u0026#39;\u0026#39;SELECT sum(value) FROM \u0026#34;host_CpuSystem\u0026#34; group by \u0026#34;resource_id\u0026#34; \u0026#39;\u0026#39;\u0026#39;, \u0026#34;7d\u0026#34;, \u0026#34;2m\u0026#34;, \u0026#34;1m\u0026#34;) Bosun, Time Series, and OpenTSDB\u0026rsquo;s DataModel An introduction to the data model of Bosun\u0026rsquo;s Primary time series backend OpenTSDB.","tags":null,"title":"Bosun"},{"categories":null,"contents":"1# g++ Linux 2g++ -std=c++17 -W -Wall -Wfatal-errors \u0026lt;file_name\u0026gt; 3# Clang MacOS 4clang++ -std=c++17 -W -Wall -Wfatal-errors \u0026lt;file_name\u0026gt; Makefile AutoMake 1sudo apt install autoconf autopoint pkg-config libffi-dev libtool libtasn1-6-dev gettext libtasn1-bin cmake ä¸ºäº†è·¨å¹³å°å®ç°ã€‚\nåˆ›å»º CMakeLists.txt, ä½¿ç”¨cmake ,ç”Ÿæˆ Makefile, ç„¶åå†ä½¿ç”¨make æˆ–è€… cmake --build . -j\nhttps://www.cnblogs.com/52php/p/5681725.html\nhttps://stackoverflow.com/questions/1516609/difference-between-cc-gcc-and-g\nMeson https://mesonbuild.com/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_c/C++/","summary":"1# g++ Linux 2g++ -std=c++17 -W -Wall -Wfatal-errors \u0026lt;file_name\u0026gt; 3# Clang MacOS 4clang++ -std=c++17 -W -Wall -Wfatal-errors \u0026lt;file_name\u0026gt; Makefile AutoMake 1sudo apt install autoconf autopoint pkg-config libffi-dev libtool libtasn1-6-dev gettext libtasn1-bin cmake ä¸ºäº†è·¨å¹³å°å®ç°ã€‚\nåˆ›å»º CMakeLists.txt, ä½¿ç”¨cmake ,ç”Ÿæˆ Makefile, ç„¶åå†ä½¿ç”¨make æˆ–è€… cmake --build . -j\nhttps://www.cnblogs.com/52php/p/5681725.html\nhttps://stackoverflow.com/questions/1516609/difference-between-cc-gcc-and-g\nMeson https://mesonbuild.com/","tags":null,"title":"C Build Tool"},{"categories":null,"contents":"Client-go The Client Library\u0026ndash; k8s.io/client-go The kubernetes programming interface in Go mainly consists of the k8s.io/client-go library (for brevity we will just call it client-go going foward).\nk8s.io/client-go is a typical web service client library that supports all API types that are officially part of Kubernetes. It can be used to execute the usual REST verbs.\nCreate Get List Update Delete Patch Watch For each Kubernetes 1.x.y release, there is a client-go release with a matching tag kubernetes-1.x.y.\nMost of your code that speaks to Kubernetes APIs will use tools/clientcmd/ to set up a client from a kubeconfig file, and kubernetes/ for the actual Kubernetes API clients.\nKubernetes API Types\u0026ndash;k8s.io/api As we have seen, client-go holds the client interfaces. The Kubernetes API Go types for objects like pods, services, and deployments are located in their oven repository. It is accessed as ki8.io/api in Go code.\nPods are part of the legacy API group(often also called the \u0026ldquo;core\u0026rdquo; group) version v1 Hence, the Pod Go types is found in k8s.io/api/core/v1, and similarly for all other API types in Kubernetes. The actual Go types are contained in a type.go file. In addition, there are other files, most of them automatically generated by a code generator.\n1# k8s.io/api/core/v1 2Pod 3Service 4ReplicaSet API Machinery\u0026ndash;k8s.io/apimachinery Last but not least, there is a third repository called API Machinery, which is used as k8s.io/apimachinery in Go. It include all the generic building blocks to implement a Kubernetes-like API. API machinery is not restricted to container management, so, for example, it could be used to build APIs for an online shop or any other business-specific domain.\nNevertheless, you\u0026rsquo;ll meet a lot of API Machinery packages in Kubernetes-native Go code. An important one is k8s.io/apimachinery/pkg/api/meta/v1. It contains many of the generic API types such as ObjectMeta, TypeMeta, GetOptions, and ListOptions.\n1# pkg/apis/meta/v1 2ObjectMeta 3TypeMeta 4ListOptions 5DeleteOptions 6GetOptions 7Status 8Events Create and Using a client when running a binary inside of a pod in a cluster, the kubelet will automatically mount a service account into the container at /var/run/secrets/kuberntes.io/serviceaccount. It replaces the kubeconfig file just mentioned and can easily be turned into a rest.Config via the rest.InClusterConfig() method.\n1package main 2 3import ( 4\t\u0026#34;context\u0026#34; 5\t\u0026#34;encoding/json\u0026#34; 6\t\u0026#34;flag\u0026#34; 7\t\u0026#34;fmt\u0026#34; 8\t\u0026#34;os\u0026#34; 9\t// \u0026#34;path/filepath\u0026#34; 10 11\tmetav1 \u0026#34;k8s.io/apimachinery/pkg/apis/meta/v1\u0026#34; 12\t\u0026#34;k8s.io/client-go/kubernetes\u0026#34; 13\t// \u0026#34;k8s.io/client-go/rest\u0026#34; 14\t\u0026#34;k8s.io/client-go/tools/clientcmd\u0026#34; 15) 16 17func main() { 18\tkubeconfig := flag.String(\u0026#34;kubeconfig\u0026#34;, \u0026#34;./config\u0026#34;, \u0026#34;kubeconfig file\u0026#34;) 19\tflag.Parse() 20 21\t//************ Running a Binary Inside of a Pod in Cluster ***************** 22\t// config, err := rest.InClusterConfig() 23\t// if err != nil { 24\t// // fallback to kubeconfig 25\t// kubeconfig2 := filepath.Join(\u0026#34;~\u0026#34;, \u0026#34;.kube\u0026#34;, \u0026#34;config\u0026#34;) 26\t// if envvar := os.Getenv(\u0026#34;KUBECONFIG\u0026#34;); len(envvar) \u0026gt; 0 { 27\t// kubeconfig2 = envvar 28\t// } 29\t// } 30 31\t// Import clientcmd from client-go in order to parse the kubernetes config. 32\t// The client configuration with server name, credentials. 33\t// Retrun a rest.Config 34\tconfig, err := clientcmd.BuildConfigFromFlags(\u0026#34;\u0026#34;, *kubeconfig) 35\tif err != nil { 36\tfmt.Printf(\u0026#34;The kuber config can not be loaded: %v\\n\u0026#34;, err) 37\tos.Exit(1) 38\t} 39 40\t// You can enable protobuf for native kubernetes resource cliensts by modifying 41\tconfig.AcceptContentTypes = 42\t\u0026#34;application/vnd.kubernetes.protobuf,application/json\u0026#34; 43 44\tconfig.ContentType = \u0026#34;application/vnd.kubernetes.protobuf\u0026#34; 45 46\t// Clinetset contains multiple clients for all native kubernetes resources. 47\t// Create actual kubernetes client set. 48\tclientset, err := kubernetes.NewForConfig(config) 49\tif err != nil { 50\tfmt.Printf(\u0026#34;create clientset failed: %v\u0026#34;, err) 51\tos.Exit(1) 52\t} 53 54\t// The Get call send and HTTP GET request to 55\t// /api/v1/namespace/calico-apiserver/pods/calico-apiserver-xxx 56\tpod, err := clientset.CoreV1().Pods(\u0026#34;calico-apiserver\u0026#34;).Get(context.TODO(), 57\t\u0026#34;calico-apiserver-5b68b6b54-ngfdw\u0026#34;, metav1.GetOptions{}) 58 59\tif err != nil { 60\tos.Exit(1) 61\t} 62 63\tstrByte, _ := json.Marshal(pod) 64\tfmt.Println(string(strByte)) 65 66} group ?\nVersioning and Compatibility We have seen in the previous section that pods are in v1 of core group. The core group actually exists in only one version today. There are other groups, though\u0026ndash; for example, the apps groups, which exists in v1, v1beta2, and v1beta1.\nâ€‹\nClients are hardcode to a version, and the application developer has to select the right API group version in order to speak to the cluster at hand.\nA second aspect of compatibility is the meta API features of the API server that client-go is speaking to.\nThere are options structs for CURD verbs, like CreateOptions,GetOptions,UpdateOptions, and DeleteOptions. Another important one is ObjectMeta, which part of every kind. All of these are frequently extended with new features; we usually call them API machinery features.\n1// k8s.io/apimachinery/pkg/apis/meta/v1/types.go 2// Delete options may be provided when deleting an API object 3type DeleteOptions struct{ 4\tTypeMeta 5\tGracePeriodSeconds *int64 6\tPreconditions *Preconditions 7\tOrphanDependents *bool 8 PropagationPolicy *DeletePropagation 9 10 // When present, indicates that modifications should not be 11\t// persisted. An invalid or unrecognized dryRun directive will 12\t// result in an error response and no further processing of the 13\t// request. Valid values are: 14\t// - All: all dry run stages will be processed 15\t// +optional 16 DryRun []string 17 // Was added in Kubernetes in 1.12. 18} API versions and Compatibility Guarantees Kubernetes versions all API Groups. A common Kubernetes-style versioning scheme is used, which consists of alpha, beta, and GA(general availability) versions.\nalpha versions\nv1alpha1, v1alpha2, v2alpha1\nbeta versions\nv1beta1, v1beta2, v2beta1\nv1, v2\nGA\nIn connections to API group versions, there are two important points to keep in mind.\nAPI groups versions apply to API resources as a whole, like the format of pods or service. Furthermore, API groups versions play a role in accessing the API. Kubernetes Objects in Go From the type system point of view, Kubenetes objects fulfill a Go interface called runtime.Object form the package k8s.io/apimachinery/pkg/runtime.\n1// Object interface must be support by all API types registered with Scheme. 2// Since Objects in a scheme are expected to be serialized to the wire, the interface an Object 3// must provide to the Scheme allows serializers to set the kind, version, and group the object 4// is represented as. An Object may choose to return a no-op ObjectKindAccessor in case where 5// it is not expected to be serialized. 6type Object interface{ 7\tGetObjectKind() schema.ObjectKind 8\tDeepCopyObject() Object 9} Here, scheme.ObjectKind is a another simple interface from k8s.io/apimachinery/pkg/runtime/schema.\n1// All objects that are serialized form a Scheme encode their type information. 2// This interface is used by serialization to set type information from the Scheme onto the 3// serialized version of an Object. For objects that cannot be serialized or have unique 4// requirements, this interface may be no-op. 5type ObjectKind interface{ 6 SetGroupVersionKind(kind GroupVersionKind) 7 GroupVersionKind() GroupVersionKind 8} In other words, a Kubernetes Object in Go is a data structure that can:\nReturn and set the GroupVersionKind Be deep-copied A deep copy is a clone of the data structure such that it does not share any memory the the original object. It is used wherever code has to mutate an object without modifying the original.\nTypeMeta Kubernetes objects form k8s.io/api implement the type getter and setter of scheme.ObjectKind by embedding the metav1.TypeMeta struct form the package k8s.io/apimachinery/apis/meta/v1.\n1// TypeMeta describes an individual object in an API response or request 2// with strings representing the type of the object and its API schema version. 3// Structures that are versioned or persisted should inline TypeMeta. 4// 5// +k8s:deepcopy-gen=false 6type TypeMeta struct { 7\t// Kind is a string value representing the REST resource this object represents. 8\t// Servers may infer this from the endpoint the client submits requests to. 9\t// Cannot be updated. 10\t// In CamelCase. 11\t// More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds 12\t// +optional 13\tKind string `json:\u0026#34;kind,omitempty\u0026#34; protobuf:\u0026#34;bytes,1,opt,name=kind\u0026#34;` 14 15\t// APIVersion defines the versioned schema of this representation of an object. 16\t// Servers should convert recognized schemas to the latest internal value, and 17\t// may reject unrecognized values. 18\t// More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources 19\t// +optional 20\tAPIVersion string `json:\u0026#34;apiVersion,omitempty\u0026#34; protobuf:\u0026#34;bytes,2,opt,name=apiVersion\u0026#34;` 21} with this, a pod declaration in Go looks like this form package k8s.io/api/core/v1/types.go.\n1// Pod is a collection of containers that can run on a host. This resource is created 2// by clients and scheduled onto hosts. 3type Pod struct { 4\tmetav1.TypeMeta `json:\u0026#34;,inline\u0026#34;` 5\t// Standard object\u0026#39;s metadata. 6\t// More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#metadata 7\t// +optional 8\tmetav1.ObjectMeta `json:\u0026#34;metadata,omitempty\u0026#34; protobuf:\u0026#34;bytes,1,opt,name=metadata\u0026#34;` 9 10\t// Specification of the desired behavior of the pod. 11\t// More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#spec-and-status 12\t// +optional 13\tSpec PodSpec `json:\u0026#34;spec,omitempty\u0026#34; protobuf:\u0026#34;bytes,2,opt,name=spec\u0026#34;` 14 15\t// Most recently observed status of the pod. 16\t// This data may not be up to date. 17\t// Populated by the system. 18\t// Read-only. 19\t// More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#spec-and-status 20\t// +optional 21\tStatus PodStatus `json:\u0026#34;status,omitempty\u0026#34; protobuf:\u0026#34;bytes,3,opt,name=status\u0026#34;` 22} As you can see, TypeMeta is embedded. Moreover, the pod type has JSON tags that also declare TypeMeta as being inlined.\nThis match the YAML representation of a Pod.\n1apiVersion: v1 2kind: Pod 3metadata: 4\tnamespace: default 5\tname: example 6spec: 7\tcontainers: 8\t- name: hello 9\timages: debian:latest 10\tcommand: 11\t- /bin/sh 12\targs: 13\t- -c 14\t- echo \u0026#34;hello world\u0026#34;; sleep 10000 The version is stored in TypeMeta.APIVersion, the kind in TypeMeta.Kind.\nThe Core Group is different for historic reasons\nPods and many other types that were added to Kubernetes very early on are part of the core group\u0026ndash; often also called the legacy group \u0026ndash; which is represented by the empty string. Hence, apiVersion is just set to \u0026ldquo;v1\u0026rdquo;.\nEventually API groups were added to Kubernetes, and the group name separated by slash, was prepended to apiVersion. In the case of apps, the version would be apps/v1. Hence, the apiVersion field is actually misnamed; it stores the API group name and the version string. This is for historic reasons because apiVersion was defined when only the core group\u0026ndash;and none of these other API groups\u0026ndash;existed.\nObjectMeta most top-level objects have a field of type metav1.ObjectMeta, again from the package k8s.io/apimachinery/pkgs/meta/v1.\n1// ObjectMeta id metadata that all persisted resources must have, which includes all objects user must create. 2type ObjectMeta struct{ 3 // Name must be unique within a namespace. 4 Name string 5 GenerateName string 6 // Namespace defines the space within which each name must be unique. 7 Namespace string 8 SelfLink string 9 UID types.UID 10 // An opaque value that represents the internel version of this object that can be used by 11 // clients to determine when objects have changes. corresponds to a key in etcd. 12 ResourceVersion string 13 Generation int64 14 CreateTimestamp Time 15 DeleteTimestamp *Time 16 DeleteGracePeriodSeconds *int64 17 // Map of string keys and values that can be used to organize and categorize objects. 18 Labels map[string]string 19 // Annotations is an unstructrued key value map stored with a resource that may be set 20 // by externel tools to store and retrieve arbitrary metadata. 21 Annotations map[string]string 22 OwnerReferences []OwnerReference 23 // Finalizers must be empty before the object is deleted from the registry. 24 Finalizers []string 25 // The name of cluster which the object belongs to. 26 ClusterName string 27 ManagedFields []ManagedFieldsEntry 28} spec and status Finally, nearly every top-level object has a spec and a status section. This conventions comes from the declarative nature of the Kubernetes API: spec is the user desire, and status it the outcome of that desire, usually filled by a controller in the system.\nThere are only a few exception to the spec and status convention in the system-for example, endpoints in the core groups, or RBAC objects like ClusterRole.\nClient Set A client set gives access to clients for multiple API groups and resources. In the case of kubernetes.NewForConfig(config) from k8s.io/client-go/kubernetes, we get access to all API groups and resources defined in k8s.io/api. This is, with a few exception\u0026ndash;such as APIService and CustomerResourcesDefinition\u0026ndash; the whole set of resources served by the Kubernetes API server.\nThe client set main interface in k8s.io/client-go/kubernetes/clientset.go for Kubernetes-native resources like this:\n1type Interface interface{ 2 Discover() discover.DiscoverInterface 3 AppsV1() appsv1.AppsV1Interface 4 AppsV1beta1() appsv1beta1.AppsV1beta1Interface 5 AppsV1beta2() appsv1beta2.AppsV1beta2Interface 6 AuthenticationV1() authenticationv1.AuthenticationV1Interface 7 AuthenticationV1beta1() authenticationv1beta1.AuthenticationV1betaInterface 8 AuthorizationV1() authorizationv1.AuthorizationV1Interface 9 AuthorizationV1beta1() authorizationv1beta1.AuthorizationV1beta1Interface 10 ... 11} Behind each GroupVersion method, we find the resource of the API group.\n1type AppsV1beta1Interface interface { 2 RESTClinet() rest.Interface 3 ControllerRevisionGetter 4 DeploymentsGetter 5 StatefulSetsGetter 6} With RESTClinet being a generic REST client, and one interface per resource, as in:\n1// DeploymentsGetter has a method to return a DeploymentInterface. 2// A group\u0026#39;s client should implement this interface. 3type DeploymentsGetter interface{ 4 Deployments(name string) DeploymentInterface 5} 6 7// DeploymentInterface has methods to work with Deployment resources. 8type DeploymentInterface interface { 9\tCreate(ctx context.Context, deployment *v1beta1.Deployment, opts v1.CreateOptions) (*v1beta1.Deployment, error) 10\tUpdate(ctx context.Context, deployment *v1beta1.Deployment, opts v1.UpdateOptions) (*v1beta1.Deployment, error) 11\tUpdateStatus(ctx context.Context, deployment *v1beta1.Deployment, opts v1.UpdateOptions) (*v1beta1.Deployment, error) 12\tDelete(ctx context.Context, name string, opts v1.DeleteOptions) error 13\tDeleteCollection(ctx context.Context, opts v1.DeleteOptions, listOpts v1.ListOptions) error 14\tGet(ctx context.Context, name string, opts v1.GetOptions) (*v1beta1.Deployment, error) 15\tList(ctx context.Context, opts v1.ListOptions) (*v1beta1.DeploymentList, error) 16\tWatch(ctx context.Context, opts v1.ListOptions) (watch.Interface, error) 17\tPatch(ctx context.Context, name string, pt types.PatchType, data []byte, opts v1.PatchOptions, subresources ...string) (result *v1beta1.Deployment, err error) 18\tApply(ctx context.Context, deployment *appsv1beta1.DeploymentApplyConfiguration, opts v1.ApplyOptions) (result *v1beta1.Deployment, err error) 19\tApplyStatus(ctx context.Context, deployment *appsv1beta1.DeploymentApplyConfiguration, opts v1.ApplyOptions) (result *v1beta1.Deployment, err error) 20\tDeploymentExpansion 21} Depending on the scope of the resource\u0026ndash;that is , whether it is cluster or namespace scoped\u0026ndash; the accessor(here DeploymentsGetter) may or may not have a namespace argument.\nStatus Subresources: UpdateStatus Deployments have a so-called status subresource. This means that UpdateStatus uses an additional HTTP endpoint suffixed with /status. While updates on the /api/apps/v1beta1/namespace/ns/deployments/name endpoints can change only the spce of the deployment, the endpoint /api/apps/v1beta1/namespace/ns/deployments/name/status can change only the status of the object.\nBy default the client-gen generates the UpdateStatus() method.\nListings and Deletions DeleteCollections allows us to delete multiple objects of namespace at once. The ListOptions parameters allows us to define which objects should be deleted using a filed or label selector:\n1// k8s.io/apimachinery/pkg/apis/meta/v1/types.go 2// ListOptions is the query options to a standard REST list call. 3type ListOptions struct{ 4 TypeMeta 5 // A selector to restrict the list of returned objects by their labels. 6 LabelSelector string 7 // A selector to restrict the list of returned objects by their fields. 8 FieldSelector string 9 Watch bool 10 AllowWatchBookmarks bool 11 ResourceVersion string 12 ResourceVersionMatch ResourceVersionMatch 13 TimeSecond *int64 14 Limit int64 15 Continue string 16} Watches Watch gives an event interface for all changes(adds, removes, and updates) to objects. The returned watch.Interface form k8s.io/apimachinery/pkg/watch/watch.go.\n1// Interface can be implemented by anything that knows how to watch and report changes. 2type Interface interface{ 3 // Stop watching. Will close the channel returned by ResoultChan(). Release any resources 4 // used by watch. 5 Stop() 6 // Returns a chan which will receive all the events. If an errors occurs or Stop() 7 // is canceled, the implementation will close this channel and release any resources 8 // used by watch. 9 ResultChan() \u0026lt;-chan Event 10} The result channel of watch interface returns three kinds of events.\n1// EventType defines the possible types of events 2type EventTypes string 3const ( 4\tAdded EventType = \u0026#34;ADDED\u0026#34; 5 Modified EventType = \u0026#34;MODIFIED\u0026#34; 6 Deleted EventType = \u0026#34;DELETED\u0026#34; 7 Bookmark EventType = \u0026#34;BOOKMARK\u0026#34; 8 Error EventType = \u0026#34;ERROR\u0026#34; 9) 10 11// Event represents a single event to watched resource. 12Type Event struct{ 13 Type EventType 14 15 Object runtime.Object 16} While it is tempting to use this interface directly, in practice it is actually discouraged in favor of informers.\nInformers are a combination of this event interface and in-memory cache with indexed lookup. This is by far the most common use case for watches. Under the hood informers first call List on the client to get the set of all objects(as a baseline for the cache) and then Watch to update the cache.\nClient Expansion DeploymentExpansion is actually an empty interface. It is used to add custom client behavior, but it\u0026rsquo;s hardly used in Kubernetes nowdays. Instead, the client generator allows up to add custom methods in a declarative way.\nNote again that all of those methods in DeploymentInterface neither expect valid information in the TypeMeta fields Kind and APIVersion, nor set those fields on Get() and List(). These fields are filled with real values only on the wire.\nClient Options Client-go What is clientset?\nClientSet: every Resource has their own client, and ClientSet is a client set for different Resources. ClientSet on handle the k8s internal resource, generate by client-gen.\nDynamicClient is for CRD resources.\nDiscoverClientï¼š find all api-resources\nè·å–kube confçš„æ–¹å¼ï¼š\nfile path ~/.kube/config KUBECONFIG åˆå¹¶å¤šä¸ªkubeconfig ä¿¡æ¯\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_dev_3_clinet_go/","summary":"Client-go The Client Library\u0026ndash; k8s.io/client-go The kubernetes programming interface in Go mainly consists of the k8s.io/client-go library (for brevity we will just call it client-go going foward).\nk8s.io/client-go is a typical web service client library that supports all API types that are officially part of Kubernetes. It can be used to execute the usual REST verbs.\nCreate Get List Update Delete Patch Watch For each Kubernetes 1.x.y release, there is a client-go release with a matching tag kubernetes-1.","tags":null,"title":"client-go"},{"categories":null,"contents":"4C8G 70%-80% è™šæ‹ŸåŒ–æµªè´¹æ‰äº†\nè£¸é‡‘å±\n2001 VMwareè™šæ‹ŸåŒ–æŠ€æœ¯\n2006 AWSæ¨å‡ºEC2æœåŠ¡\n2010 Openstackç¤¾åŒºæˆç«‹ã€‚ è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œç®¡ç†æ“ä½œç³»ç»Ÿ\n2011.04 ç¬¬ä¸€ä¸ª å¼€æºPaaSå¹³å° CloudFoundry\n2013.03 å¼€æºDockerå‘å¸ƒã€‚ æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„åº”ç”¨å®¹å™¨åŒ–ã€‚\n2014.06 Google å‘å¸ƒKubernetes, åº”ç”¨ç¼–æ’\n2015.07 Google å®£å¸ƒæˆç«‹CNCFåŸºé‡‘ä¼š\nBuilding sustainable ecosystems for cloud native software.\nIaaS Infrastructure-as-a-service åŸºç¡€è®¾æ–½å³æœåŠ¡\nPaaS Platform as a service\nSaaS Software as a service\nCaaS container as a service\nä¼˜åŠ¿ ï¼š\nç¨³å®šæ€§ï¼š å‡ ä¸ª9 SLA 0.999 å¹´å®•æœºæ—¶é—´\nå¼¹æ€§æ‰©å±•\nå®‰å…¨æ€§\næˆæœ¬\næ˜“ç”¨æ€§\nIDC\nå•ä½“æ¶æ„\né›†ç¾¤æ¶æ„é˜¶æ®µï¼ˆå•é›†ç¾¤ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªå®ä¾‹æä¾›æœåŠ¡ï¼‰\nåˆ†å¸ƒå¼æ¶æ„é˜¶æ®µï¼ˆè´Ÿè½½å‡è¡¡ï¼ŒåŒæ—¶æä¾›æœåŠ¡ï¼‰\nå¾®æœåŠ¡æ¶æ„ï¼Œ ä»¥ä¸šåŠ¡å¤©ç„¶åˆ†åº“\nServiceMeshï¼š ç½‘æ ¼åŒ–æ¶æ„\nRPC è¿œç¨‹è°ƒç”¨/ Gateway è´Ÿè½½å‡è¡¡-\u0026gt; æœåŠ¡ä¸IPæ˜ å°„ facade pattern ï¼š çœŸæ­£æƒ³åšä¸€ä»¶äº‹ï¼Œå¯¹å¤–æš´éœ²ç»Ÿä¸€è®¿é—®æ¥å£ï¼šè´Ÿè½½å‡è¡¡ã€åè®®æŠ“æ¢ã€ç”¨æˆ·é‰´æƒ\nNginx å’ŒAPI Gatewayï¼Œ æœ‰äº¤é›†ï¼ŒåŠ¨æ€å†³å®š\nNginxï¼šåå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡\nGatewayï¼š é‰´æƒï¼Œåè®®è½¬æ¢ï¼Œ ç‰µæ‰¯åˆ°ä¸šåŠ¡ä»£ç çš„ç›¸å…³ä¸œè¥¿ï¼Œ å¯ä»¥åšæ›´å¤šçš„ä¸šåŠ¡èåˆæœåŠ¡\nåˆ†å¸ƒå¼ å’Œé›†ç¾¤çš„åŒºåˆ«ï¼Ÿ\nåˆ†å¸ƒå¼ï¼šæŠŠä¸€ä¸ªå¤§å‹åº”ç”¨æ‹†åˆ†å‡ºå¾ˆå¤šåŠŸèƒ½æ¨¡å—ï¼Œå„ä¸ªåŠŸèƒ½éƒ¨ç½²å†ä¸åŒæœåŠ¡å™¨ä¸Šï¼Œæ‰€æœ‰çš„è¿™äº›æœåŠ¡å™¨è”åˆèµ·æ¥æä¾›å®ŒæˆæœåŠ¡ã€‚\né›†ç¾¤ï¼š å¾ˆå¤šä¸€æ¨¡ä¸€æ ·çš„æœåŠ¡\nè½¯ä»¶ éƒ¨ç½²æœºå™¨\nA 5 -\u0026gt; é›†ç¾¤\nB 4\nC 8\nD 7\nå¾ˆå¤šæœºå™¨éƒ½å¯ä»¥å«åšé›†ç¾¤ï¼›ä¸åŒæœåŠ¡éƒ¨ç½²åˆ°ä¸åŒæœåŠ¡å™¨ï¼Œæ‰èƒ½ç§°ä¸ºåˆ†å¸ƒå¼ï¼›\nå¼‚åœ°å¤šæ´»ï¼š\nIP æ¼‚ç§»ï¼Œ keep alive\näº‘ä¸ŠæŒ‘æˆ˜\näº‘æœºå™¨çš„èµ„æºç¼–æ’\näº‘å­˜å‚¨æ–¹æ¡ˆï¼š æ–‡ä»¶å­˜å‚¨\näº‘è´Ÿè½½å‡è¡¡æ–¹æ¡ˆ\näº‘ç¼“å­˜æ–¹æ¡ˆï¼šCDNï¼Œæ•°æ®åº“ï¼Œä¸­é—´ä»¶\näº‘æŒä¹…åŒ–ï¼š Mysql\näº‘è¿ç»´\näº‘ç›‘æ§ï¼š\näº‘å®¹å™¨æŠ€æœ¯ï¼š\näº‘DevOps\näº‘å®‰å…¨é˜²æŠ¤\næŠ€æœ¯å˜é©ï¼š\nåŠ¨æ€æ‰©å®¹-\u0026gt; æ°´å¹³æ‰©å®¹\nåº”ç”¨ä¸Šäº‘æ— å…³è¯­è¨€\ndocker \u0026ndash; docker shim-\u0026gt; k8s\nå› ä¸º docker æ²¡æœ‰å®ç°CRIï¼ˆContainer Runtime Interfaceï¼‰ï¼Œ ä¹‹å‰æ˜¯é€šè¿‡docker shim è°ƒç”¨ï¼Œå®ç°CRI interfaceï¼Œè¿˜æ˜¯å¹²æ‰ dockerã€‚\n2021å¹´åº•çš„æœ€åä¸€æ¬¡æ›´æ–°ä¼šæ›¿æ¢æ‰\ndocker-\u0026gt; å®¹å™¨çš„å°è£…å±‚ï¼Œ containd(runc)?\nå®¹å™¨çš„æ‰€æœ‰æ€æƒ³éƒ½æ˜¯é€šç”¨çš„ã€‚å®¹å™¨ï¼Œé•œåƒã€‚ã€‚ã€‚\nåº”ç”¨ä¸Šäº‘çš„æ–°å‹æ¶æ„ï¼š Kubernetes + serviceMesh\näº‘åŸç”Ÿçš„ç”Ÿæ€ç³»ç»Ÿ CloudNative\nMicroservice Containers Continuous Delivery DevOps å¸¸è§æŠ€æœ¯:\nåŸºç¡€ç ”ç©¶é‡\nServiceMesh\nserverlessï¼š\näº‘åŸç”Ÿçš„æœ¯è¯­ graceful shutdown\nè“ç»¿éƒ¨ç½²ï¼Œç»¿è‰²ç¯å¢ƒä¸ºå®éªŒç¯å¢ƒ\ncka, ckad, cks è€ƒè¯\npipeline\ndocker containerd runc ä¹‹é—´çš„å…³ç³»\nhttps://zhuanlan.zhihu.com/p/87602649\nhttps://www.huweihuang.com/kubernetes-notes/runtime/runtime.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/CloudNative/","summary":"4C8G 70%-80% è™šæ‹ŸåŒ–æµªè´¹æ‰äº†\nè£¸é‡‘å±\n2001 VMwareè™šæ‹ŸåŒ–æŠ€æœ¯\n2006 AWSæ¨å‡ºEC2æœåŠ¡\n2010 Openstackç¤¾åŒºæˆç«‹ã€‚ è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œç®¡ç†æ“ä½œç³»ç»Ÿ\n2011.04 ç¬¬ä¸€ä¸ª å¼€æºPaaSå¹³å° CloudFoundry\n2013.03 å¼€æºDockerå‘å¸ƒã€‚ æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„åº”ç”¨å®¹å™¨åŒ–ã€‚\n2014.06 Google å‘å¸ƒKubernetes, åº”ç”¨ç¼–æ’\n2015.07 Google å®£å¸ƒæˆç«‹CNCFåŸºé‡‘ä¼š\nBuilding sustainable ecosystems for cloud native software.\nIaaS Infrastructure-as-a-service åŸºç¡€è®¾æ–½å³æœåŠ¡\nPaaS Platform as a service\nSaaS Software as a service\nCaaS container as a service\nä¼˜åŠ¿ ï¼š\nç¨³å®šæ€§ï¼š å‡ ä¸ª9 SLA 0.999 å¹´å®•æœºæ—¶é—´\nå¼¹æ€§æ‰©å±•\nå®‰å…¨æ€§\næˆæœ¬\næ˜“ç”¨æ€§\nIDC\nå•ä½“æ¶æ„\né›†ç¾¤æ¶æ„é˜¶æ®µï¼ˆå•é›†ç¾¤ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªå®ä¾‹æä¾›æœåŠ¡ï¼‰\nåˆ†å¸ƒå¼æ¶æ„é˜¶æ®µï¼ˆè´Ÿè½½å‡è¡¡ï¼ŒåŒæ—¶æä¾›æœåŠ¡ï¼‰\nå¾®æœåŠ¡æ¶æ„ï¼Œ ä»¥ä¸šåŠ¡å¤©ç„¶åˆ†åº“\nServiceMeshï¼š ç½‘æ ¼åŒ–æ¶æ„\nRPC è¿œç¨‹è°ƒç”¨/ Gateway è´Ÿè½½å‡è¡¡-\u0026gt; æœåŠ¡ä¸IPæ˜ å°„ facade pattern ï¼š çœŸæ­£æƒ³åšä¸€ä»¶äº‹ï¼Œå¯¹å¤–æš´éœ²ç»Ÿä¸€è®¿é—®æ¥å£ï¼šè´Ÿè½½å‡è¡¡ã€åè®®æŠ“æ¢ã€ç”¨æˆ·é‰´æƒ","tags":null,"title":"Cloud Native"},{"categories":null,"contents":"Patent Cloud-Native HSM is a cloud-native Hardware Security Module(HSM) service that allows you to host encryption keys in the Intel Software Guard extension enclave and perform cryptographic operations accelerated by QAT in a cluster of HSM. You can manage the HSM resource with the Kubernetes customer resources, so you do not need to worry about scaling, managing, and clustering. You can leverage the Kubernetes\u0026rsquo; function to provide the HSM to your service.\nThis is the architecture of the Cloud Native HSM.\nIf the application needs an HSM device to create a secure connection with a remote host, you can deploy an HSM agent as a sidecar to work with the application Pod. And then, the application can call the HSM controller to generate a Key Pair and a CSR. The HSM controller received the request and then call the corresponding HSM manager to really create a Key Pair and Generate a CSR from the CTK for Intel SGX. After that, the application can take the CSR to the remote CA center to get a certificate. The application can put the received certificate to the SGX enclave and cross the HSM controller through the HSM manager. After getting the certificate, the Application can call the Crypoki through the PKCS#11 client and PKCS#11 server to the CTK. Advantage:\nHSM agent works as a sidecar, and it won\u0026rsquo;t need to make any change in the application code. The application can use the Unix socket to involve the HSM. It keeps the safety of the HSM. HSM controller leverages the Kubernetes function to manage the HSM cluster, it\u0026rsquo;s convenient The SGX enhances the security of the data and private key. If they use the CTK for Intel SGX as a sidecar, and use the Unix socket to forward the PKCS#11 service between the Pod they will hit the patent.\nAWS Cloud HSM What is Cloud Hardware Security Module(HSM)?\nA hardware security module(HSM) is a computing device that processes cryptographic operations and provides secure storage for cryptographic keys.\nAWS Cloud HSM is a cloud-based hardware security module (HSM) that enables you to genereate and use you own encryption keys.\nCloud HSM is a compliant with FIPS 140-2 level 3 (The Federal Information Processing Stanard Publication 140-2)\nIt automates administrative tasks like hardware provisioning, sofeware pathcing, high-availability, and backups\nApplications can integrate with Cloud HSM using PKCS#11, Java Cryptography Extensions(JCE), and Microsoft CryptoNG (CNG) API libraries.\nCloudHSM can scale quickly on-demand with no up-front costs.\nCloud HSM Cluster AWS Cloud HSM provides hardware securtiy modules (HSM) in a cluster.\nA cluster is one logical HSM.\nTo interact with the HSMs in a cluster, you need the AWS Cloud HSM Client software.\nClient can be installed on Amazon EC2 instances, known as client instances, that reside in the same VPC as the HSM ENIs.\nWhen you perform a task or operation on the one HSM in a cluster, the other HSM in that cluster are automatically updated.\nYou can create a cluster that has from 1 to 28 HSMs (the defaut limit is 6 HSMs per AWS account per AWS region.)\nBenefits Generate and manager cryptographic keys Cluster based makes it easy to load balance and scale API based integration for Applications Integrates with AWS KMS to create custom key stores Google Cloud HSM Cloud HSM Cavium Liquid Security HSM\nWhy Cloud HSM\nComplicance\nFIPS 140-2 level 3 certified HSMs Regionalization\nHSM keys are cryptographically bound to region Avaiable in all GCP Regions Support for multi-regions No application changes for Cloud KMS customers\nSame API and client libraries as Cloud KMS It leverages the exact same API as Cloud KMS, what that mean is that if you know how to use cloud KMS, then you know howe to use Cloud HSM.\nKey Fearures:\nGlobal and multi-region support Attestation statement confidence your keys are hardware protected Cryptographically signed statement provided by the HSM verifying the creation of the key si within an HSM boundary and non-exportable statement can be verified manually or through a script verify key attriburtes CMEK integration The HSM is bind with Vm not bind with application Pod\nTenant Separation\nSummary Cloud HSM provides a scalable, reliable, and low-maintenance service Provides a modern, intergrated approach to administrative control and tenant isolation Keys can be effortlessly created in multi-regions or event a global region. HSM keys can be used to seamlessly protect your data-at-rest with CMEK services Look for an upcomming Cloud HSM white paper What is a Cloud Hardware Security Module The CloudHSM helps you meet corporate, contractual and regulatory compliance requirements for data security by using dedicated Hardware Secutiry Module(HSM) applicances withing the cloud.\nvery critical area in the cryptography, Stand out on CV, fundamental topic to learn for cloud security role.\n1. Title of the invention Cloud Native HSM based on Intel Software Guard Extension (SGX) And QAT\n2. names of the inventors Ren, Qiang 11717682\nYing, Ruoyu\nHuang, Jiahao\n3. TECHNOLOGY BACKGROUND 3.1 Problem Definition - What technical problem did you solve? There are many scenarios that need Hardware security module (HSM) to protect transactions, identities, and applications. HSM is excel at storing cryptographic keys and provisioning encryption, decryption, authentication, and digital signing service for a wide range of applications. The dilemma here is that most cloud native services are hard to co-work with the traditional HSM that are physical devices. In the cloud native scenario, most applications need the capability of scaling and dynamic migration, but the physical HSM is hard to meet the requirement.\nCloud-Native HSM is a cloud-native Hardware Security Module service that allows you to host encryption keys or data in the Intel Software Guard extensions (SGX) enclave and perform cryptographic operations accelerated by Quick Assistant Technology (QAT) in a cluster of HSM. You can manage the HSM resource with the Kubernetes customer resources, so you do not need to worry about scaling, managing, and clustering. You can leverage the IA (Intel Architecture) features which are SGX to keep the private data security and QAT to accelerate the data encryption.\n3.2 Previous Solutions (if any): Currently, there are two main types of cloud HSM. One is to provide users with the right to use HSM as a single tenant on the physical level, such as Microsoft Azure Dedicated HSM. The cloud providers deploy HSM in different data centers. When the customer needs it, the cloud providers preconfigure HSM and connect it to the customer\u0026rsquo;s virtual network as a cloud HSM so that only the customer can access it. After the customer accesses the cloud HSM for the first time and changes the password, the cloud providers will no longer have the management rights of this cloud HSM. The customer can have full control and management rights.\nThis is a highly specialized service. This service is very secure and easy to migrate programs that directly access physical HSM. The service can meet the unique needs of some large organizations. However, due to excessive cost, complex configuration, inconvenient scaling, and resource waste, it is not suitable for many customers.\nThe second is to provide virtual HSM for users, such as AWS Cloud HSM. The cloud providers generate multiple virtual HSM on the physical HSM through virtualization technology, and users can obtain the access permission of the virtual HSM as a single tenant. Users can easily start and stop virtual HSM, build Cloud HSM clusters, and automatically synchronize virtual HSM by using relevant Cloud HSM API in their own virtual network. The users configure the corresponding client on their own virtual machine instances, and then applications on the virtual machine instances can use the virtual HSM cluster through a secure network connection between client and server.\nThis is the current mainstream service. Customers can quickly build virtual HSM clusters through the various APIs provided by cloud providers. In addition to this, customers can quickly scale clusters on demand. However, this service will also bring a lot of costs, which is often unacceptable for those who want to use the cloud to reduce costs. Secondly, the solution provides services to virtual machine instances through a virtual HSM cluster, which does not conform to the idea of cloud native. Managing virtual HSM clusters and secure Internet connections requires the use of dedicated resources and integration, so the operation capability has also proved to be a problem.\nâ€‹\nFigure 1: Architecture of AWS Cloud HSM\n4. OVERVIEW OF THE INVENTION 4.1 Short summary â€“ In 1-3 sentences, describe the core of your solution. a. Cloud-Native HSM provides HSM service for applications only with SGX feature of CPU, and the QAT is optional for acceleration, do not need to plug in another physical device to the machine.\nb. HSM agents work as a sidecar to provide Cryptoki for usersâ€™ application, which work as a usual physical device without code change for the application.\nc. The private key and sensitive data stored in the SGX enclave, itâ€™s safety.\nd. The cryptographic operations can leverage the QAT to accelerate the process.\ne. Cloud-Native HSM is a Kubernetes native service which has capability of scaling, migrating and reliability.\n4.2 Advantages â€“ In 1-3 sentences, describe the value of the invention to Intel or to our customers. In general, the Cloud Native HSM agent provides HSM service based on the Intel Software Guard Extensions (SGX) that keep the private key in the enclave and only the applications pod can access it which keeps the sensitive dataâ€™s security. And the HSM agent can scale and migrate with the application pod, which is convenient. Whatâ€™s more, Cloud Native HSM can leverage the QAT to accelerate the cryptographic operations.\nCompared with the Cloud HSM, there is a risk for the transport between the application and the Cloud HSM. But, when using the Cloud HSM, the data will not leave the application Pod.\nCloud native HSM is especially suitable for the pod whose life cycle is consistent with that of confidential information, such as protecting the private key for a mutual SSL connection between to pod in service mesh from administrator attacks.\nCloud native HSM can also be used in combination with other security devices. For example, we can copy an existing private key from a Cloud HSM to the Cloud Native HSM, but not suggested.\nFor customers, the Cloud Native HSM provides them with a flexibility HSM device which can be managed by Kubernetes customer resources. It makes it much more convenient to use HSM in the cloud native application and much more secure for their application. The application can involve the Cloud Native HSM without code change.\nFor Intel, it is a good chance to promote the SGX technology to provide security service for most cloud native applications and promote the QAT technology to accelerate the encryption and decryption process. Thus, it is also helpful to promote our Sapphire Rapids Platform.\n5. Detectability 5.1 Please describe in detail how your invention is detectable in a final product. A. If your invention results in a specific structural feature please describe the appearance of that feature (e.g., include SEM/TEMs of actual features if available). B. If there are visual inspection and/or reverse engineering techniques that can be used to identify the feature, please describe them. If they use CTK for SGX work as a sidecar pod and forward the HSM token to the application pod through the Unix socket.\nC. If documentation such as product literature would show usage of the invention, please let us know what to look for in that regard. The cloud native application that wants to use HSM to provide a dedicated, secure, tamper-resistant environment to protect cryptographic keys and data, and to automate the lifecycle of those same keys. For example, the mutual SSL connection between to pod in service mesh like Istio.\n6. DETAILS OF THE INVENTION 6.1 Provide details that help us fully understand your invention, including details on how you solved the technical problem, and at least one figure. You may also provide flowcharts, graphs, slides, or data to support your description. Where appropriate, please provide and explain any empirical support, such as experimental data or) simulation results, that can demonstrate the viability of your invention.\nSoftHSM with Intel SGX/QAT: This works as a software HSM to provide enhancing the security of data and key protection applications by exposing interfaces. That runs the key generation and cryptographic operations securely inside an Intel Software Guard Extensions (SGX) enclave. And this can leverage the QAT to accelerate the cryptographic operations.\nHSM Agent: HSM Agent is an operator of the HSM customer resource which aims at managing the local SoftHSM, to create tokens, create key pairs, generate CSR, add certificate to the SGX enclave, and even add an existing private key to the SoftHSM.\nHSM Controller: The HSM Controller monitors the changing of the customer resource of HSM and calls the HSM Agent to apply the change of the resources.\nPKCS#11 Client/Server: PKCS#11 Server is used to forward the HSM token in the HSM agent container to the application pod through Unix socket. PKCS#11 Client connects to the PKCS#11 Server by the Unix socket and provides Cryptoki API for the application. For the application, the PKCS#11 Client and server is transparent. The application calls the HSM token through the PKCS#11 API like locally.\nFigure 2: Architecture of Cloud Native HSM\nFigure 1 is the architecture of the Cloud Native HSM.\nThe default workflow is as follows.\n\\1. If the application needs an HSM device to create a secure connection with a remote host, you can deploy an HSM agent as a sidecar reside the application Pod.\n\\2. And then, the application can call the Kubernetes API to create a customer resource of HSM Key Pair as follows.\n1apiVersion: soft-hsm-sgx.intel.com/v1alpha1 2kind: SoftHSMKeyPair 3metadata: 4 name: keypair-1 5 namespace: default 6spec: 7 name: keypair-1 8 applicationPod: application-1 9 token: 10 lable: \u0026#34;token-1\u0026#34; 11 slot: 0 12 soPin: 12345678 13 pin: 12345678 14 cert: 15 keyPair: 16 keyType: \u0026#34;rsa:2048\u0026#34; 17 lable: \u0026#34;keypair-1\u0026#34; 18 id: \u0026#34;0001\u0026#34; 19 subject: \u0026#34;/CN=application-1\u0026#34; 20 21 22apiVersion: soft-hsm-sgx.intel.com/v1alpha1 23kind: SoftHSMKeyPair 24metadata: 25 name: keypair-1 26 namespace: default 27spec: 28 name: keypair-1 29 applicationPod: application-1 30 token: 31 lable: \u0026#34;token-1\u0026#34; 32 slot: 0 33 soPin: 12345678 34 pin: 12345678 35 cert: 36 keyPair: 37 keyType: \u0026#34;rsa:2048\u0026#34; 38 lable: \u0026#34;keypair-1\u0026#34; 39 id: \u0026#34;0001\u0026#34; 40subject: \u0026#34;/CN=application-1\u0026#34; 41csr: CZ01fouDJIXLehgw62ol7TsuKC1CvUkVUiI= apiVersion: soft-hsm-sgx.intel.com/v1alpha1 kind: SoftHSMKeyPair metadata: name: keypair-1 namespace: default spec: name: keypair-1 applicationPod: application-1 token: lable: \u0026ldquo;token-1\u0026rdquo; slot: 0 soPin: 12345678 pin: 12345678 cert: keyPair: keyType: \u0026ldquo;rsa:2048\u0026rdquo; lable: \u0026ldquo;keypair-1\u0026rdquo; id: \u0026ldquo;0001\u0026rdquo; subject: \u0026ldquo;/CN=application-1\u0026rdquo;\n\\3. After creating the customer resource, the HSM controller will call the specific HSM agent according the applicationPod field to generate a Key Pair in the SGX enclave, and a CSR is created write back the SoftHSMKeyPair for the certificate request, which is a base64 encode string.\napiVersion: soft-hsm-sgx.intel.com/v1alpha1 kind: SoftHSMKeyPair metadata: name: keypair-1 namespace: default spec: name: keypair-1 applicationPod: application-1 token: lable: \u0026ldquo;token-1\u0026rdquo; slot: 0 soPin: 12345678 pin: 12345678 cert: keyPair: keyType: \u0026ldquo;rsa:2048\u0026rdquo; lable: \u0026ldquo;keypair-1\u0026rdquo; id: \u0026ldquo;0001\u0026rdquo; subject: \u0026ldquo;/CN=application-1\u0026rdquo; csr: CZ01fouDJIXLehgw62ol7TsuKC1CvUkVUiI=\n\\4. When the application pod found the CSR field is not empty, the applications can call the remote CA center to get a certificate for themselves.\n\\5. The application can put the received certificate to the pem filed with base64 encode in the customer resource of SoftHSMKeyPair. And then, the HSM controller will write the cert to the SoftHSM in SGX enclave cross the HSM controller and the HSM manager.\napiVersion: soft-hsm-sgx.intel.com/v1alpha1 kind: SoftHSMKeyPair metadata: name: keypair-1 namespace: default spec: name: keypair-1 applicationPod: application-1 token: lable: \u0026ldquo;token-1\u0026rdquo; slot: 0 soPin: 12345678 pin: 12345678 cert: keyPair: keyType: \u0026ldquo;rsa:2048\u0026rdquo; lable: \u0026ldquo;keypair-1\u0026rdquo; id: \u0026ldquo;0001\u0026rdquo; subject: \u0026ldquo;/CN=application-1\u0026rdquo; csr: CZ01fouDJIXLehgw62ol7TsuKC1CvUkVUiI= pem: y9EelphCnI2MFUvbVZ3YUl3aHhwcHRaY2g2OFQ2TGJyQml2dk9xSFA\n\\6. Finally, the application can call the Cryptoki through the PKCS#11 client and PKCS#11 server to the SoftHSM. The PKCS#11 client and PKCS#11 server are connected by the Unix socket mounted in a shared point. The application can offload the cryptographic operations to the HSM Agent container which use SGX for keep the security and QAT for acceleration.\nIf you already have an existing keypair and cert, you can use the Cloud Native HSM as follows.\n\\1. If the application needs an HSM device to create a secure connection with a remote host, you can deploy an HSM agent as a sidecar reside the application Pod.\n\\2. The application can call the Kubernetes api to create a customer resource SoftHSMKeyPair with existing keypair and cert which are base64 encoded like as follows:\napiVersion: soft-hsm-sgx.intel.com/v1alpha1 kind: SoftHSMKeyPair metadata: name: keypair-1 namespace: default spec: name: keypair-1 applicationPod: application-1 token: lable: \u0026ldquo;token-1\u0026rdquo; slot: 0 soPin: 12345678 pin: 12345678 privateKey: VZ3YUl3aHhwcHRaY2g2OFQ2 publicKey: 7TsuKC1CvUkVUi cert: keyPair: keyType: \u0026ldquo;rsa:2048\u0026rdquo; lable: \u0026ldquo;keypair-1\u0026rdquo; id: \u0026ldquo;0001\u0026rdquo; subject: \u0026ldquo;/CN=application-1\u0026rdquo; csr: CZ01fouDJIXLehgw62ol7TsuKC1CvUkVUiI= pem: y9EelphCnI2MFUvbVZ3YUl3aHhwcHRaY2g2OFQ2TGJyQml2dk9xSFA\n\\3. After creating the customer resource, the HSM controller will call the specific HSM agent according the applicationPod field to create a Key Pair with the existing key, and save the certificate in the SGX enclave.\n\\4. Finally, the application can call the Cryptoki through the PKCS#11 client and PKCS#11 server to the SoftHSM. The PKCS#11 client and PKCS#11 server are connected by the Unix socket mounted in a shared point. The application can offload the cryptographic operations to the HSM Agent container which use SGX for keep the security and QAT for acceleration.\nTODO:\n- Add load balance to this architecture\n- QAT accelerate\n- Attestation\n- Dedicated Device is expensive\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/SGX-HSM/","summary":"Patent Cloud-Native HSM is a cloud-native Hardware Security Module(HSM) service that allows you to host encryption keys in the Intel Software Guard extension enclave and perform cryptographic operations accelerated by QAT in a cluster of HSM. You can manage the HSM resource with the Kubernetes customer resources, so you do not need to worry about scaling, managing, and clustering. You can leverage the Kubernetes\u0026rsquo; function to provide the HSM to your service.","tags":null,"title":"Cloud-Native HSM based on Intel Software Guard(SGX)"},{"categories":null,"contents":"Cluster Net Test Environment Access method 1# this machine is out of intel, please use the socks proxy: 2# proxy-prc.intel.com:1080 3# use this private key to access this the relay machine: 4# first login to 5ssh -p 3302 airren@124.223.99.93 # passwd: 123- 6# next login to 7ssh airren@node-1 # passwd:123- PreRequisites Kind Create cluster\n1# create cluster one node 2 3 4# create cluster multinode 5 6# create cluster with configuration Delete cluster\n1kind delete cluster --name=\u0026lt;clustername\u0026gt; Setup mcs-api demo Re-setup 4 cluster. This will create 4 K8s clusters by Kind. parent, child1,child2,child3.\n1cd ~/clusternet/hack 2./local-running.sh 3 4export KUBECONFIG=${HOME}/.kube/clusternet.config After that, you will see 4 clusters\u0026rsquo; contexts.\nCheck Clusters status\nDeploy application to child-clusters by kubectl clusternet.\nChange the cluster id in subscription.yaml to what you want to be deployed. 1cd ~/clusternet/examples/scheduling-with-mcs-api/scheduling 2vi subscription.yaml Deploy the applicaton(deployment, servcie, service-export) to the child-cluster\n1cd ~/clusternet/examples/scheduling-with-mcs-api/ 2k clusternet apply -f scheduling/ Deploy the service import in the Parent-Cluster\n1k apply -f service-import.yaml Check the deploy result.\nsuccessfullycreated a service.and then, find the endpointslice bind with this service\nThe service port name shoule be same with the endpoint slice Name.\nArchtecture Clusternet is a lightweight addon that consists of three components, clusternet-agent, clusternet-scheduler andclusternet-hub.\nClusternet-agent is responsible for:\nAuto-registering current cluster to parent cluster as a child cluster. Report heartbeats of current cluster, including kubernetes version, running platform, health/readyz/livez status,etc; setting up websocket connection that provides full-duplex communication channels over a single TCP connection to parent cluster. Clusternet-scheduler is responsible for\nscheduling resources/feeds to marched child clusters based on SchedulingStrategy. Clusternet-hub is responsible for\napproving cluster registration request and creating dedicated resources, suce as namespaces, servceaccounts and RBAC rules, for each child cluster;\nServing ad an aggregated apiserver(AA),which is used to provide shadow APIs and serve as a websocket server that maintain multiple active webscoket connections form child clusters;\nproviding Kubernetes-styled API to redirect/proxy/upgrade request to each child cluster.\ncoordinating and deploying applications to multiple clusters from a single set of APIs;\nClusterRegistrationRequest: This is cluster-agent created in parent-cluster for child-cluster.\n1k get clsrr ManagedCluseter: clusternet-hub approved the clsrr and created this object\n1k get mcls -A HelmChart: helm chart configuration\nSubscription: the resource for the child cluster. with a Base Object in corresponding namespace\nLocalization and Globalization\nBase\nDescription\nMultiCluster API ServiceExport ServiceExport, used to specify which service should be exposed across all clusters in the clusterset. ServiceExport must be created in each cluster that the underlying Service reside in. Creation of a ServiceExport in a cluster will signify that Service with the same name and namespace as the export should be visible to other clusters in the clusterset.\nServiceImport ServcieImport is introduced to act as the in-cluster representation of a multi-cluster service in each importing cluster. This is analogous to the traditional Service type in Kubernetes, Importing clusters will have a corresponding ServiceImport for each uniquely named Service that has been exported within the clusterset, referenced by namespaced name. ServiceImport resources will be managed by the MCS implementation\u0026rsquo;s mcs-controller.\nDebug of Clusternet Reference https://github.com/clusternet/clusternet/tree/main/examples/scheduling-with-mcs-api\nhttps://github.com/kubernetes/community/tree/master/sig-multicluster\nhttps://github.com/kubernetes/enhancements/tree/master/keps/sig-multicluster/1645-multi-cluster-services-api\n1$env:HTTP_PROXY=\u0026#34;proxy-prc.intel.com:913\u0026#34; 2$env:HTTPS_PROXY=\u0026#34;proxy-prc.intel.com:913\u0026#34; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/clusternet/","summary":"Cluster Net Test Environment Access method 1# this machine is out of intel, please use the socks proxy: 2# proxy-prc.intel.com:1080 3# use this private key to access this the relay machine: 4# first login to 5ssh -p 3302 airren@124.223.99.93 # passwd: 123- 6# next login to 7ssh airren@node-1 # passwd:123- PreRequisites Kind Create cluster\n1# create cluster one node 2 3 4# create cluster multinode 5 6# create cluster with configuration Delete cluster","tags":null,"title":"clusternet"},{"categories":null,"contents":"Docker CNM What is CNI?\nHow CNI plugin works?\nWhat a CNI plugin is made of?\nHow a CNI plugin is being used in K8s?\nHow a CNI plugin is executed?\nAnatomy of Pod networking\nWhat is CNI CNI stands for Container Networking Interface\nAn interface between container runtime and the network implementation\nConfigure the network interfaces and routes\nConcern itself only with the netwrok connectivity.\nHow CNI plugin works? A CNI binary Handle connectivity - configures the network interface of the Pod /opt/cni/bin A daemon Handle reachability - manager routings across the cluster What a CNI plugin is made of ? Part 1 /etc/cni/net.d contains the CNI configuration. The name decide the order.\nPart2 1# cat /opt/cni/bin/my-cni.demo 2case $CNI_COMMAND in 3ADD) 4 # configure networking for a new container 5;; 6DEL) 7 # cleanup when container is stopped 8;; 9GET) 10;; 11VERSION) 12 # get the version of CNI 13;; 14esac How CNI plugin is executed? 1CNI_COMMAND=ADD 2CNI_CONTAINERID=123456780 3CIN_NETNS=/proc/123456/netns 4CNI_IFNAME=eth0 1Container Info ---- env vars --- 2 3 ---\u0026gt; CNI 4CNI config ------ stdin -------- Anatomy of Pod Netwroking veth pair\n1case $CNI_COMMAND in 2ADD) 3 podcidr=$(cat /dev/stdin | jq -r \u0026#34;.podcidr\u0026#34;) # 10.240.0.0/24 4 podcidr_gw=$(echo $podcidr| sed \u0026#34;s:0/24:1/g\u0026#34;) # 10.240.0.1 5 btctl addbr cni0 # create a new bridge(if doesnt exist),cni0 6 ip link set cni0 up 7 ip addr add \u0026#34;$(podcidr_gw)/24\u0026#34; dev cni0 # assign 10.230.0.1/24 to cni0 8 9 10 host_ifname=\u0026#34;veth$n\u0026#34; # n = 1,2,3.. 11 ip link add $CNI_IFNAMW type veth peer name $host_ifname 12 ip link set $host_ifname up 13 14 ip link set $host_ifname master cni0 # connect veth1 to bridge 15 ln -sfT $CNI_NETNS /var/run/netns/$CNI_CONTAINERID 16 ip link set $CNI_IFNAME netns $CNI_CONTAINERID # move eth0 to Pod ns 17 18 # calculate $ip 19 ip netns exec $CNI_CONTAINERID ip link set $CNI_IFNAME up 20 ip netns exec $CNI_CONTAINERID ip link addr add $ip/24 dev $CNI_IFNAME 21 ip netns exec $CNI_CONTAINERID ip route add default via $podcidr_gw dev $CNI_IFNAME 22 23;; 1if [ -f /tmp/last_allocated_ip ]; then 2 n=`cat /tmp/last_allocated_ip` 3else 4 n =1 5fi 6ip=$(echo $podcidr| sed \u0026#34;s:0/24:$(($n+1)):g\u0026#34;) 7echo $(($n+1)) \u0026gt; /tmp/last_allocated_ip If the pod-to-pod communactaion is doesn\u0026rsquo;t work\n1iptables -A FORWARD -s 10.240.0.0/16 -j ACCEPT 2iptables -A FORWARD -d 10.240.0.0/16 -j ACCEPT connect to another node\n1# node-1 2ip route add 10.240.1.0/24 via 10.10.10.11 dev enp0s9 3# node-2 4ip route add 10.240.0.0/24 via 10.10.10.11 dev enp0s9 5# and enable ipv4-forward Pod to publice network need a SNAT\n1iptables -t nat -A POSTROUTING -s 10.240.0.0/24 -o cni0 -j MASQUERADE expose pod\n1kubectl expose pod nginx2 --port=8080 --target-port=80 2# this will create service with cluster IP CNI Kubernetes Networking Requirements\nEach Pod get their own IP addresss\nContainers within a Pod share network namespace All pod can communicate with all other pods without NAT(Network Address Translation)\nAll nodes can communicate with all pods without NAT\nThe IP of the Pod is same throughout the cluster\nruntime is the program responwsible for executing CNI plugins.\nplugin is a program that applies a specified network configuration.\nCNI generic parameters 1{ 2 \u0026#34;cniVersion\u0026#34;: \u0026#34;0.2.0\u0026#34;, 3 \u0026#34;name\u0026#34;: \u0026#34;mybridge\u0026#34;, 4 \u0026#34;type\u0026#34;: \u0026#34;bridge\u0026#34;, 5 \u0026#34;bridge\u0026#34;: \u0026#34;cni_bridge0\u0026#34;, 6 \u0026#34;isGateway\u0026#34;: true, 7 \u0026#34;ipMasq\u0026#34;: true, 8 \u0026#34;ipam\u0026#34;: { 9 \u0026#34;type\u0026#34;: \u0026#34;host-local\u0026#34;, 10 \u0026#34;subnet\u0026#34;: \u0026#34;10.15.20.0/24\u0026#34;, 11 \u0026#34;routes\u0026#34;: [ 12 { 13 \u0026#34;dst\u0026#34;: \u0026#34;0.0.0.0/0\u0026#34; 14 }, 15 { 16 \u0026#34;dst\u0026#34;: \u0026#34;1.1.1.1/32\u0026#34;, 17 \u0026#34;gw\u0026#34;: \u0026#34;10.15.20.1\u0026#34; 18 } 19 ] 20 } 21} cniVersion: The version of the CNI spec in thich the definition works with name: The network name type: The name of the plugin you wish to use. In this case, the actual name of the plugin executable args: Optinal additional parameters ipMasq: Configure outbound masquerade (source NAT) for this network ipam type: The name of the IPAM plugin executable subnet: The subnet to allocate out of (this is actually part of the IPAM plugin) routes: dst: The subnet you wish to reach gw: The IP address of the next hop to reach the dst. If not specified the default fateway for the subnet is assumed dns: nameservers: A list of nameservers you wish to use with this network domain: The search domain to use for DNS requests search: A list of search domains options: A list of options to be passed to the receiver Plugin (bridge) specific paramters isgateway: If true, assigns an IP address to the bridge so containers connected to it may use is as a gateway. isdefaultgateway: If true, sets the assigned IP address as the default route. forceAddress: Tell the plugin to allocate a new IP address if the previous value has changed. mtu: define the MTU of the bridge hairpinMode: Set hairpin mode for the interfaces on the bridge. These variables are passed to the plugin via environmental variables.\n1sudo CNI_COMMAND=ADD CNI_CONTAINERID=1234567890 CNI_NETNS=/var/run/netns/1234567890 CNI_IFNAME=eth12 CNI_PATH=`pwd` ./bridge \u0026lt; mybridge.conf CNI_COMMAND=ADD we are telling CNI that we want to add a connection CNI_CONTAINERID=1234567890 We\u0026rsquo;re telling CNI that the network namespace we want to work CNI_NETNS=/var/run/netns/1234567890 The path to the namspace CNI_IFNAME=eth12 The name of the interface we wish to use on the container side of the connection CNI_PATH=pwd We always need to tell CNI where the plugin executables live. In this [7/15/2022 10:33 AM] Ramakrishnan, Kuralamudhan https://www.dasblinkenlichten.com/understanding-cni-container-networking-interface/ [7/15/2022 10:36 AM] Ramakrishnan, Kuralamudhan https://github.com/containernetworking/cni/blob/main/SPEC.md [7/15/2022 10:36 AM] Ramakrishnan, Kuralamudhan https://github.com/containernetworking/plugins/tree/main/plugins/main/bridge [7/15/2022 10:37 AM] Ramakrishnan, Kuralamudhan https://github.com/containernetworking/plugins/blob/main/plugins/main/bridge/bridge.go\nhttps://www.youtube.com/watch?v=zmYxdtFzK6s\u0026ab_channel=CNCF%5BCloudNativeComputingFoundation%5D\nhttps://github.com/eranyanay/cni-from-scratch\nQuestion: the CNI configuration default path is /etc/cni/net.d/. If there are multiple configuration file in this path, for example, In SDEWAN project, there are as following:\n1root@pull-edge-1:/etc/cni/net.d# ll 2total 32 3drwxr-xr-x 4 root root 4096 Jul 12 14:09 ./ 4drwxr-xr-x 3 root root 4096 Jul 12 14:08 ../ 5-rw------- 1 root root 857 Jul 12 14:08 00-multus.conf 6-rw-r--r-- 1 root root 804 Jul 12 14:08 10-calico.conflist 7-rw-r--r-- 1 root root 88 Jul 12 14:09 20-network.conf 8-rw------- 1 root root 2854 Jul 19 09:11 calico-kubeconfig 9drwxr-xr-x 2 root root 4096 Jul 12 14:08 multus.d/ 10drwxr-xr-x 2 root root 4096 Jul 12 14:09 ovn4nfv-k8s.d/ â€‹ How kublet know which one is the default CNI? Does it depend on the file name numberic perfix ?\nI found all the CNI binary in this Path /opt/cni/bin. Is this a default PATH for CNI spec ? If any CNI will put the binary in this path. In the Service Function Chain Demo Archtecture. Is the brown box represent a virtual switch? And except the brown box, does it still need another CNI interface as the default CNI interface for kubelet to manager the pod. Does kubernetes support any versoin of CNI SPEC.For example, does kubernetest support all of the CNI SPEC version. Reference https://wiki.ith.intel.com/display/containers/Nodus\nHow kubelet find which one is the primariy CNI.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/nodus/k8s-network-cni/","summary":"Docker CNM What is CNI?\nHow CNI plugin works?\nWhat a CNI plugin is made of?\nHow a CNI plugin is being used in K8s?\nHow a CNI plugin is executed?\nAnatomy of Pod networking\nWhat is CNI CNI stands for Container Networking Interface\nAn interface between container runtime and the network implementation\nConfigure the network interfaces and routes\nConcern itself only with the netwrok connectivity.\nHow CNI plugin works? A CNI binary Handle connectivity - configures the network interface of the Pod /opt/cni/bin A daemon Handle reachability - manager routings across the cluster What a CNI plugin is made of ?","tags":null,"title":"CNI Container Networking Interface"},{"categories":null,"contents":"openWRT Cross compile 1export STAGING_DIR=/home/airren/openwrt/staging_dir/toolchain-x86_64_gcc-8.4.0_musl 2 3 4export TOOLCHAIN_DIR=$STAGING_DIR 5export TOOLCHAIN_PATH=$TOOLCHAIN_DIR/bin 6export CXX=$TOOLCHAIN_PATH/g++-uc 7export AR=$TOOLCHAIN_PATH/x86_64-openwrt-linux-musl-ar 8export CXXFLAGS=\u0026#34;-O2\u0026#34; 9 10 11export CROSSCOMPILE_PATH=$TOOLCHAIN_DIR/usr 12# export CFLAGS=\u0026#34;-I$CROSSCOMPILE_PATH/jhhhhinclude\u0026#34; 13 14 15export LDCFLAGS=\u0026#34;-L$TOOLCHAIN_DIR/usr/lib -lz\u0026#34; 16export LD_LIBRARY_PATH=$TOOLCHAIN_DIR/usr/lib 17export PATH=$TOOLCHAIN_PATH:$PATH 1./autogen.sh --build=x86_64-pc-linux-gnu --host=i486-openwrt-linux 2./autogen.sh --build=x86_64-pc-linux-gnu --host=x86_64-openwrt-linux 3 4make CC=i486-openwrt-linux-gcc LD=i486-openwrt-linux-ld 5make CC=x86_64-openwrt-linux-gcc LD=x86_64-openwrt-linux-ld build openwrt in a docker\n1apt update 2apt install -y git wget build-essential gawk gcc-multilib flex git gettext libncurses5-dev libssl-dev python3-distutils rsync unzip zlib1g-dev 3 4apt update 5apt install build-essential ccache ecj fastjar file g++ gawk \\ 6gettext git java-propose-classpath libelf-dev libncurses5-dev \\ 7libncursesw5-dev libssl-dev python python2.7-dev python3 unzip wget \\ 8python-distutils-extra python3-setuptools python3-dev rsync subversion \\ 9swig time xsltproc zlib1g-dev 10 11 12 13 14# Update the feeds 15./scripts/feeds update -a 16./scripts/feeds install -a 17 18# Configure the firmware image and the kernel 19make menuconfig ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/openwrt_cross_compile/","summary":"openWRT Cross compile 1export STAGING_DIR=/home/airren/openwrt/staging_dir/toolchain-x86_64_gcc-8.4.0_musl 2 3 4export TOOLCHAIN_DIR=$STAGING_DIR 5export TOOLCHAIN_PATH=$TOOLCHAIN_DIR/bin 6export CXX=$TOOLCHAIN_PATH/g++-uc 7export AR=$TOOLCHAIN_PATH/x86_64-openwrt-linux-musl-ar 8export CXXFLAGS=\u0026#34;-O2\u0026#34; 9 10 11export CROSSCOMPILE_PATH=$TOOLCHAIN_DIR/usr 12# export CFLAGS=\u0026#34;-I$CROSSCOMPILE_PATH/jhhhhinclude\u0026#34; 13 14 15export LDCFLAGS=\u0026#34;-L$TOOLCHAIN_DIR/usr/lib -lz\u0026#34; 16export LD_LIBRARY_PATH=$TOOLCHAIN_DIR/usr/lib 17export PATH=$TOOLCHAIN_PATH:$PATH 1./autogen.sh --build=x86_64-pc-linux-gnu --host=i486-openwrt-linux 2./autogen.sh --build=x86_64-pc-linux-gnu --host=x86_64-openwrt-linux 3 4make CC=i486-openwrt-linux-gcc LD=i486-openwrt-linux-ld 5make CC=x86_64-openwrt-linux-gcc LD=x86_64-openwrt-linux-ld build openwrt in a docker\n1apt update 2apt install -y git wget build-essential gawk gcc-multilib flex git gettext libncurses5-dev libssl-dev python3-distutils rsync unzip zlib1g-dev 3 4apt update 5apt install build-essential ccache ecj fastjar file g++ gawk \\ 6gettext git java-propose-classpath libelf-dev libncurses5-dev \\ 7libncursesw5-dev libssl-dev python python2.","tags":null,"title":"cross complile"},{"categories":null,"contents":"å¯¹ç§°åŠ å¯† éå¯¹ç§°åŠ å¯† RSA ç”±äºè®¡ç®—éå¸¸å¤æ‚ï¼Œåªé€‚ç”¨äºå°æ•°æ®åŠ å¯†ã€‚\nHTTPS éå¯¹ç§°åŠ å¯†+å¯¹ç§°åŠ å¯†\nmTLS æ•°å­—è¯ä¹¦ æ•°å­—è¯ä¹¦çš„é¢å‘è¿‡ç¨‹ä¸€èˆ¬ä¸ºï¼š ç”¨æˆ·é¦–å…ˆäº§ç”Ÿè‡ªå·±çš„å¯†é’¥å¯¹ï¼Œå¹¶å°†å…¬å…±å¯†é’¥ä»¥åŠéƒ¨åˆ†ä¸ªäººèº«ä»½ä¿¡æ¯ä¼ é€ç»™è®¤è¯ä¸­å¿ƒã€‚è®¤è¯ä¸­å¿ƒåœ¨æ ¸å®èº«ä»½åï¼Œæ‰§è¡Œä¸€äº›å¿…è¦çš„æ­¥éª¤ï¼Œä»¥ç¡®è®¤è¯·æ±‚ç¡®å®æ˜¯ç”±ç”¨æˆ·å‘é€æ¥çš„ã€‚ç„¶åï¼Œè®¤è¯ä¸­å¿ƒå°†å‘ç»™ç”¨æˆ·ä¸€ä¸ªæ•°å­—è¯ä¹¦ã€‚è¯¥è¯ä¹¦å†…åŒ…å«ç”¨æˆ·çš„ä¸ªä¿¡æ¯å’Œä»–çš„å…¬é’¥ä¿¡æ¯ã€‚åŒæ—¶è¿˜é™„æœ‰è®¤è¯ä¸­å¿ƒçš„ç­¾åä¿¡æ¯ã€‚\nåŠ å¯†é€šä¿¡ Alice [Decode message by Alice\u0026rsquo;s private key] \u0026lt;\u0026mdash;- send message \u0026mdash; [message encrypted with Alice\u0026rsquo;s public key] Bob\nå…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†\næ•°å­—ç­¾å Bob ç»™Aliceå‘é€çš„æ–‡ä»¶éœ€è¦æºå¸¦æ•°å­—ç­¾åã€‚\nBobä½¿ç”¨è‡ªå·±çš„ç§é’¥ ä»¥åŠæ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼Œ é€šè¿‡ç­¾åç®—æ³• è®¡ç®—å‡º æ•°å­—ç­¾å\nAlice æ”¶åˆ°æ–‡ä»¶åï¼Œ é€šè¿‡æ–‡ä»¶å“ˆå¸Œå€¼ï¼ŒBobçš„æ•°å­—ç­¾åï¼Œä»¥åŠBobçš„å…¬é’¥ è¿›è¡Œç­¾åéªŒè¯\næ•°å­—ç­¾åä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªä½œç”¨ï¼šè®¤è¯ï¼Œç¡®è®¤æ”¶åˆ°çš„æ•°æ®çš„èº«ä»½ä¿¡æ¯ï¼›é˜²æ­¢æŠµèµ–ï¼Œæ–‡ä»¶ä¸€æ—¦ç­¾ååä¸èƒ½åæ‚”ï¼›é˜²æ­¢ç¯¡æ”¹ï¼Œä¿è¯æ–‡ä»¶åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„å®Œæ•´æ€§ã€‚\næ¯”ç‰¹å¸å…¶å®å°±æ˜¯æ•°å­—ç­¾å\nX.509 æ•°å­—è¯ä¹¦ è¯ä¹¦ç‰ˆæœ¬ä¿¡æ¯\nè¯ä¹¦çš„åºåˆ—å·ï¼Œæ¯ä¸ªè¯ä¹¦éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„è¯ä¹¦åºåˆ—å·\nè¯ä¹¦æ‰€ä½¿ç”¨çš„ç­¾åç®—æ³•ï¼›\nè¯ä¹¦çš„å‘è¡Œæœºæ„åç§°ï¼Œå‘½åè§„åˆ™ä¸€èˆ¬é‡‡ç”¨X.500æ ¼å¼ï¼›\nè¯ä¹¦çš„æœ‰æ•ˆæœŸï¼Œç°åœ¨é€šç”¨çš„è¯ä¹¦ä¸€èˆ¬é‡‡ç”¨UTCæ—¶é—´æ ¼å¼ï¼Œå®ƒçš„è®¡æ—¶èŒƒå›´1950-2049ï¼›\nè¯ä¹¦æ‰€æœ‰äººçš„åç§°ï¼Œå‘½åè§„åˆ™ä¸€èˆ¬é‡‡ç”¨X.500æ ¼å¼ï¼›\nè¯ä¹¦æ‰€æœ‰äººçš„å…¬å¼€å¯†é’¥ï¼›\nè¯ä¹¦å‘è¡Œè€…å¯¹è¯ä¹¦çš„ç­¾åï¼›\nOpenssl åˆ›å»ºä¸€ä¸ª root certificates å’Œ private key ç”¨æ¥ä¸ºæœåŠ¡ç­¾ç½² certificates\n1openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -subj \u0026#39;/O=example Inc./CN=example.com\u0026#39; -keyout root.key -out root.crt åˆ›å»ºä¸€ä¸ª certificate å’Œ private for service\n1openssl req -out service.csr -newkey rsa:2048 -nodes -keyout service.key -subj \u0026#34;/CN=service/O=some organization\u0026#34; 2openssl x509 -req -days 365 -CA root.crt -CAkey root.key -set_serial 0 -in service.csr -out service.crt åˆ›å»ºä¸€ä¸ªclientçš„certificate å’Œ private key\n1openssl req -out client.csr -newkey rsa:2048 -nodes -keyout client.key -subj \u0026#34;/CN=client/O=client organization\u0026#34; 2openssl x509 -req -days 365 -CA root.crt -CAkey root.key -set_serial 1 -in client.csr -out client.crt 1cert$ tree 2. 3â”œâ”€â”€ root.crt # CERTIFICATE 4â”œâ”€â”€ root.key # PRIVATE KEY 5â”œâ”€â”€ client.crt 6â”œâ”€â”€ client.csr # CERTIFICATE REQUEST 7â”œâ”€â”€ client.key 8â”œâ”€â”€ service.crt 9â”œâ”€â”€ service.csr 10â””â”€â”€ service.key æŸ¥çœ‹è¯ä¹¦è¯¦æƒ…\n1openssl x509 -text -noout -in xxx.crt Step by Step Generate Keys, CSR \u0026amp; Self Signed Certificates Generate Key-Pair -\u0026gt; Extract Public Key -\u0026gt; Generate CSR File -\u0026gt; Generate Self-signed Certificate\n1# get key pair, contains private key and public key 2openssl genrsa -out demo.key 2048 # RSA PRIVATE KEY 3# extrace public frm above 4openssl rsa -in demo.key -pubout -out demo_pub.key # PUBLIC KEY 5# create CSR 6openssl req -new -key demo.key -out demo.csr 7# verify CSR 8openssl req -text -in demo.csr -noout -verify 9# self signed certificate 10openssl x509 -in demo.csr -out demo.crt -req -signkey demo.key -days 365 When create CSR need to fill some details.\nVerify the CRS created above.\nRSA - public key \u0026amp; private key\nuse private key to create CSR, and use CSR and sign-key to sign a certificate.\nPSCK#11 æ¥å£è§£æï¼š https://blog.csdn.net/zhubeifen_521/article/details/89360027\nhttps://blog.csdn.net/wan706364166/article/details/8617293?spm=1001.2101.3001.6650.12\u0026utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-12.no_search_link\u0026depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-12.no_search_link\nåœ¨å¯†ç ç³»ç»Ÿä¸­ï¼ŒPKCS#11 æ—¶å…¬é’¥åŠ å¯†æ ‡å‡†(PKCS, Public-Key Cryptography Standards)çš„ä¸€ä»½å­,ç”±RSAå®éªŒå®¤å‘å¸ƒï¼Œå®ƒä¸ºåŠ å¯†å¹³å°å®šä¹‰äº†ä¸€ç»„å¹³å°æ— å…³çš„APIï¼Œå¦‚ç¡¬ä»¶å®‰å…¨æ¨¡å—HSMå’Œæ™ºèƒ½å¡ã€‚\nç”±äºæ²¡æœ‰ä¸€ä¸ªçœŸæ­£çš„æ ‡å‡†åŠ å¯†ä»¤ç‰Œï¼Œè¿™ä¸ªAPIå·²ç»å‘å±•æˆä¸ºä¸€ä¸ªé€šç”¨çš„åŠ å¯†ä»¤ç‰Œçš„æŠ½è±¡å±‚ã€‚PKCS#11 APIå®šä¹‰æœ€å¸¸ç”¨çš„åŠ å¯†å¯¹è±¡ç±»å‹(RSAå¯†é’¥ï¼ŒX.509è¯ä¹¦ï¼ŒDES/ä¸‰é‡DESå¯†é’¥ç­‰)å’Œæ‰€æœ‰éœ€è¦ä½¿ç”¨çš„åŠŸèƒ½ï¼Œåˆ›å»º/ç”Ÿæˆï¼Œä¿®æ”¹å’Œåˆ é™¤è¿™äº›å¯¹è±¡ã€‚PKCS#11åªæä¾›äº†æ¥å£çš„å®šä¹‰ï¼Œä¸åŒ…æ‹¬æ¥å£çš„å®ç°ï¼Œä¸€èˆ¬æ¥å£çš„å®ç°æ˜¯ç”±è®¾å¤‡æä¾›å•†æä¾›çš„ï¼Œå¦‚usbkeyçš„ç”Ÿäº§å•†ä¼šæä¾›ç¬¦åˆPKCS#11æ¥å£æ ‡å‡†çš„APIå®ç°ã€‚è¿™æ ·ä½ åªè¦é€šè¿‡æ¥å£è°ƒç”¨APIå‡½æ•°å°±å¯ä»¥å®ç°å…¶åŠŸèƒ½ã€‚\næœ¬æ ‡å‡†ä¸ºé‚£äº›ä¿å­˜å¯†ç ä¿¡æ¯ï¼Œæ‰§è¡Œå¯†ç å‡½æ•°çš„è®¾å¤‡ç¡®å®šä¸€ç§ç¨‹åºè®¾è®¡æ¥å£(API)ï¼Œè¯¥æ¥å£ç§°ä½œCryptoki. éŸ³â€œCrypto-Keyâ€ï¼Œcryptographic token interface(å¯†ç ä»¤ç‰Œæ¥å£), å®ƒéµå¾ªä¸€ç§åŸºäºå¯¹è±¡çš„ç®€å•æ–¹æ³•ï¼Œæå‡ºæŠ€æœ¯ç‹¬ç«‹æ€§(å„ç§å„æ ·çš„è®¾å¤‡)å’Œèµ„æºå…±äº«(å¤šä¸ªåº”ç”¨ç¨‹åºè®¿é—®å¤šä¸ªè®¾å¤‡)çš„ç›®æ ‡ï¼ŒæŠŠè®¾å¤‡çš„ä¸€ç§é€šç”¨é€»è¾‘è¯•å›¾ï¼Œå³å¯†ç ä»¤ç‰Œï¼Œæä¾›ç»™åº”ç”¨ç¨‹åºã€‚\nPKCS#11ä¸»è¦æ˜¯åº”ç”¨äºæ™ºèƒ½å¡å’ŒHSMã€‚å¤§å¤šæ•°å•†ä¸šè¯ä¹¦é¢å‘æœºæ„è½¯ä»¶ä½¿ç”¨PKCS#11è®¿é—®CAçš„ç­¾åå¯†é’¥æˆ–æ³¨å†Œç”¨æˆ·è¯ä¹¦ã€‚\nmount /dev/sda1 /mnt/boot/efi\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/1_cryptography/","summary":"å¯¹ç§°åŠ å¯† éå¯¹ç§°åŠ å¯† RSA ç”±äºè®¡ç®—éå¸¸å¤æ‚ï¼Œåªé€‚ç”¨äºå°æ•°æ®åŠ å¯†ã€‚\nHTTPS éå¯¹ç§°åŠ å¯†+å¯¹ç§°åŠ å¯†\nmTLS æ•°å­—è¯ä¹¦ æ•°å­—è¯ä¹¦çš„é¢å‘è¿‡ç¨‹ä¸€èˆ¬ä¸ºï¼š ç”¨æˆ·é¦–å…ˆäº§ç”Ÿè‡ªå·±çš„å¯†é’¥å¯¹ï¼Œå¹¶å°†å…¬å…±å¯†é’¥ä»¥åŠéƒ¨åˆ†ä¸ªäººèº«ä»½ä¿¡æ¯ä¼ é€ç»™è®¤è¯ä¸­å¿ƒã€‚è®¤è¯ä¸­å¿ƒåœ¨æ ¸å®èº«ä»½åï¼Œæ‰§è¡Œä¸€äº›å¿…è¦çš„æ­¥éª¤ï¼Œä»¥ç¡®è®¤è¯·æ±‚ç¡®å®æ˜¯ç”±ç”¨æˆ·å‘é€æ¥çš„ã€‚ç„¶åï¼Œè®¤è¯ä¸­å¿ƒå°†å‘ç»™ç”¨æˆ·ä¸€ä¸ªæ•°å­—è¯ä¹¦ã€‚è¯¥è¯ä¹¦å†…åŒ…å«ç”¨æˆ·çš„ä¸ªä¿¡æ¯å’Œä»–çš„å…¬é’¥ä¿¡æ¯ã€‚åŒæ—¶è¿˜é™„æœ‰è®¤è¯ä¸­å¿ƒçš„ç­¾åä¿¡æ¯ã€‚\nåŠ å¯†é€šä¿¡ Alice [Decode message by Alice\u0026rsquo;s private key] \u0026lt;\u0026mdash;- send message \u0026mdash; [message encrypted with Alice\u0026rsquo;s public key] Bob\nå…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†\næ•°å­—ç­¾å Bob ç»™Aliceå‘é€çš„æ–‡ä»¶éœ€è¦æºå¸¦æ•°å­—ç­¾åã€‚\nBobä½¿ç”¨è‡ªå·±çš„ç§é’¥ ä»¥åŠæ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼Œ é€šè¿‡ç­¾åç®—æ³• è®¡ç®—å‡º æ•°å­—ç­¾å\nAlice æ”¶åˆ°æ–‡ä»¶åï¼Œ é€šè¿‡æ–‡ä»¶å“ˆå¸Œå€¼ï¼ŒBobçš„æ•°å­—ç­¾åï¼Œä»¥åŠBobçš„å…¬é’¥ è¿›è¡Œç­¾åéªŒè¯\næ•°å­—ç­¾åä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªä½œç”¨ï¼šè®¤è¯ï¼Œç¡®è®¤æ”¶åˆ°çš„æ•°æ®çš„èº«ä»½ä¿¡æ¯ï¼›é˜²æ­¢æŠµèµ–ï¼Œæ–‡ä»¶ä¸€æ—¦ç­¾ååä¸èƒ½åæ‚”ï¼›é˜²æ­¢ç¯¡æ”¹ï¼Œä¿è¯æ–‡ä»¶åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„å®Œæ•´æ€§ã€‚\næ¯”ç‰¹å¸å…¶å®å°±æ˜¯æ•°å­—ç­¾å\nX.509 æ•°å­—è¯ä¹¦ è¯ä¹¦ç‰ˆæœ¬ä¿¡æ¯\nè¯ä¹¦çš„åºåˆ—å·ï¼Œæ¯ä¸ªè¯ä¹¦éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„è¯ä¹¦åºåˆ—å·\nè¯ä¹¦æ‰€ä½¿ç”¨çš„ç­¾åç®—æ³•ï¼›\nè¯ä¹¦çš„å‘è¡Œæœºæ„åç§°ï¼Œå‘½åè§„åˆ™ä¸€èˆ¬é‡‡ç”¨X.500æ ¼å¼ï¼›\nè¯ä¹¦çš„æœ‰æ•ˆæœŸï¼Œç°åœ¨é€šç”¨çš„è¯ä¹¦ä¸€èˆ¬é‡‡ç”¨UTCæ—¶é—´æ ¼å¼ï¼Œå®ƒçš„è®¡æ—¶èŒƒå›´1950-2049ï¼›\nè¯ä¹¦æ‰€æœ‰äººçš„åç§°ï¼Œå‘½åè§„åˆ™ä¸€èˆ¬é‡‡ç”¨X.500æ ¼å¼ï¼›\nè¯ä¹¦æ‰€æœ‰äººçš„å…¬å¼€å¯†é’¥ï¼›\nè¯ä¹¦å‘è¡Œè€…å¯¹è¯ä¹¦çš„ç­¾åï¼›\nOpenssl åˆ›å»ºä¸€ä¸ª root certificates å’Œ private key ç”¨æ¥ä¸ºæœåŠ¡ç­¾ç½² certificates\n1openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -subj \u0026#39;/O=example Inc.","tags":null,"title":"Cryptography"},{"categories":null,"contents":"K8sStudy:\nDocker Node: Jenkins, Mysql, casbin_allinone, portioner,hemidall (1 node 4 core, 8G)\nODMS with NFS. (3 node, 1 NFS node)\nK8s node for CNI study\nK8s node for others, DPDK?\nDev node for source code and dev\nmove Openwrt and VM to a same node\nApplication Casdoor 1docker run -d --restart=always --name casdoor \\ 2-p 8001:8000 \\ 3casbin/casdoor-all-in-one Heimdall 1docker volume create heimdall 2docker run -d --restart unless-stopped --name=heimdall \\ 3-e PUID=1000 -e PGID=1000 -e TZ=Europe/London \\ 4-p 8086:80 -p 8463:443 \\ 5-v heimdall:/config \\ 6linuxserver/heimdall:latest CI\u0026amp;CD Jenkins 1docker volume create jenkins_data 2docker run -d --restart=always --name jenkins \\ 3-u 0 --privileged \\ 4-p 8080:8080 -p 50000:50000 \\ 5-v jenkins_data:/var/jenkins_home \\ 6-v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/usr/bin/docker \\ 7jenkins/jenkins:lts-jdk11 8 9# -v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/usr/bin/docker \\ 10 11# must ubuntu20.04 Docker pipeline configuration\n1 script{ 2 docker.withRegistry( \u0026#39;\u0026#39;, registryCredential ) { 3 dockerImage.push() 4 } 5 } https://octopus.com/blog/jenkins-docker-ecr\nhttps://medium.com/@gustavo.guss/jenkins-building-docker-image-and-sending-to-registry-64b84ea45ee9\nDatabase Mysql 1docker volume create mysql_data 2 3docker run -d --restart=always --name mysql \\ 4-p 3306:3306 \\ 5-e MYSQL_ROOT_PASSWORD=1q2w3e4r%T \\ 6-v mysql_data=/var/lib/mysql \\ 7mysql:8.0.30 Elastic Search 1docker run -d --name es01 \\ 2--net elastic -e ES_JAVA_OPTS=\u0026#34;-Xms1g -Xmx1g\u0026#34; \\ 3-p 9200:9200 -p 9300:9300 -it \\ 4docker.elastic.co/elasticsearch/elasticsearch:8.4.1 5 6# /usr/share/elasticsearch/config/certs/http_ca.crt 7# /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic Cerebro 1docker volume create cerebro_data 2docker run -d --restart=always --name cerebro \\ 3-p 9001:9000 --net elastic \\ 4-v cerebro_data:/opt/cerebro \\ 5lmenezes/cerebro:0.9.4 Add host configration to cerebro\n1# /opt/cerebro/conf 2hosts = [ 3 { 4 host = \u0026#34;https://10.105.61.90:9200\u0026#34; 5 name = \u0026#34;ES Cluster\u0026#34; 6 auth = { 7 username = \u0026#34;elastic\u0026#34; 8 password = \u0026#34;MyPassword\u0026#34; 9 } 10 } 11] 12 13play.ws.ssl { 14 trustManager = { 15 stores = [ 16 { type = \u0026#34;PEM\u0026#34;, path = \u0026#34;/opt/cerebro/conf/http_ca.crt\u0026#34; } 17 ] 18 } 19 loose = { 20 disableHostnameVerification=true } 21} 22 23# Disabling certificate validation 24# #play.ws.ssl.loose.acceptAnyCertificate=true MinIO 1docker volume create minio_data 2 3docker run -d --restart=always --name minio \\ 4 -p 9000:9000 \\ 5 -p 9099:9099 \\ 6 -v minio_data:/data \\ 7 -e \u0026#34;MINIO_ROOT_USER=admin\u0026#34; \\ 8 -e \u0026#34;MINIO_ROOT_PASSWORD=1q2w3e4r%T\u0026#34; \\ 9 minio/minio server /data --console-address \u0026#34;:9099\u0026#34; what is S3\nDocker manager Portainer 1docker volume create portainer_data 2docker run -d --restart=always --name portainer \\ 3-p 8000:8000 -p 9443:9443 -p 9090:9000 \\ 4-v /var/run/docker.sock:/var/run/docker.sock \\ 5-v portainer_data:/data \\ 6portainer/portainer-ce:latest Jira 1 docker volume create jira_data 2 docker run -d --restart=always --name jira \\ 3 -p 8082:8080 -v jira_data:/var/jira -e TZ=\u0026#39;Asia/Shanghai\u0026#39;\\ 4 haxqer/jira:9.5.0 5 6 7 docker exec jira java -jar /var/agent/atlassian-agent.jar \\ 8 -p jira \\ 9 -m haxqer666@gmail.com \\ 10 -n haxqer666@gmail.com \\ 11 -o http://echo-bio.cn:8082 \\ 12 -s B2GJ-KD5D-6V6J-KCK7 13 14 15 configure ubuntu as a router 1sudo iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE 2sudo iptables -A FORWARD -i eth1 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT 3sudo iptables -A FORWARD -i eth0 -o eth1 -j ACCEPT 4 5 6 7sudo iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o ens160 -j MASQUERADE 8sudo iptables -t nat -A POSTROUTING -s 10.0.12.0/24 -o ens160 -j MASQUERADE 9 10 11 12vi /etc/sysctl.conf 13 14net.ipv4.ip_forward = 1 # æ²¡æœ‰åˆ™æ·»åŠ ï¼Œæœ‰ä¿®æ”¹ä¸º1ï¼ˆ0ç¦æ­¢ï¼Œ1å¼€å¯ï¼‰ 15 16sysctl -p ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/deployment/","summary":"K8sStudy:\nDocker Node: Jenkins, Mysql, casbin_allinone, portioner,hemidall (1 node 4 core, 8G)\nODMS with NFS. (3 node, 1 NFS node)\nK8s node for CNI study\nK8s node for others, DPDK?\nDev node for source code and dev\nmove Openwrt and VM to a same node\nApplication Casdoor 1docker run -d --restart=always --name casdoor \\ 2-p 8001:8000 \\ 3casbin/casdoor-all-in-one Heimdall 1docker volume create heimdall 2docker run -d --restart unless-stopped --name=heimdall \\ 3-e PUID=1000 -e PGID=1000 -e TZ=Europe/London \\ 4-p 8086:80 -p 8463:443 \\ 5-v heimdall:/config \\ 6linuxserver/heimdall:latest CI\u0026amp;CD Jenkins 1docker volume create jenkins_data 2docker run -d --restart=always --name jenkins \\ 3-u 0 --privileged \\ 4-p 8080:8080 -p 50000:50000 \\ 5-v jenkins_data:/var/jenkins_home \\ 6-v /var/run/docker.","tags":null,"title":"Deploy essential components by Docker"},{"categories":null,"contents":"GitHub: Intel Device plugins for Kubernetes\nDevice Plugins Device Plugins\nUse the Kubernetes device plugin framework to implement plugins for GPUs, NICs, FPGAs, InfiniBand, and similar resources that require vendor-specific setup.\nInstead of customizing the code for Kubernetes itself, vendors can implements a device plugin that you deploy either manually or as a DaemonSet. The targeted device include GPUs, high-performance NICs, FPGAs, InfiniBand adapters, and other similar computing resources that may require vendor specific initialization and setup.\nDevice plugin registration The kubelet exports a Registration RPC service:\n1service Registration{ 2 rpc Register(RegisterRequest) return (Empty){} 3} Then, user can request devices in a Container specification as they request other types of resources, with the following limitations:\nExtended resources are only supported as integer resources and cannot be overcommitted. Devices cannot be shared among Containers. Here is an example of a pod requesting this resource to run a demo workload.\n1--- 2apiVersion: v1 3kind: Pod 4metaData: 5\tname: demo-pod 6spec: 7\tcontainers: 8\t- name: demo-container-1 9\timages: k8s.gcr.io/pause:2.0 10\tresource: 11\tlimit: 12\thardware-vendor.example/foo: 2 13# This Pod need 2 of the hardware-vendor.example/foo devices and can only schedule onto a Node 14# that\u0026#39;s able to satisfy the need. 15# If the Node has more than 2 of those device avaiable, the remainder would be available for 16# other Pods to use. ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_ops_device_plugin/","summary":"GitHub: Intel Device plugins for Kubernetes\nDevice Plugins Device Plugins\nUse the Kubernetes device plugin framework to implement plugins for GPUs, NICs, FPGAs, InfiniBand, and similar resources that require vendor-specific setup.\nInstead of customizing the code for Kubernetes itself, vendors can implements a device plugin that you deploy either manually or as a DaemonSet. The targeted device include GPUs, high-performance NICs, FPGAs, InfiniBand adapters, and other similar computing resources that may require vendor specific initialization and setup.","tags":null,"title":"Device Plugin"},{"categories":null,"contents":"é•œåƒä»“åº“ Linux æœ¬åœ°é•œåƒä»“åº“ï¼š/var/lib/docker/image\né•œåƒåº”è¯¥æ˜¯åˆ†å±‚å­˜å‚¨çš„ã€‚\nDocker images æ˜¯å­˜å‚¨åœ¨é•œåƒä»“åº“æœåŠ¡Images Registryã€‚Docker å®¢æˆ·ç«¯çš„é•œåƒä»“åº“æœåŠ¡æ˜¯å¯é…ç½®çš„ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯Docker Hubã€‚\né•œåƒä»“åº“æœåŠ¡åŒ…å«å¤šä¸ªé•œåƒä»“åº“ Image Repositoryï¼ˆåŒä¸€ä¸ªé•œåƒçš„ä¸åŒç‰ˆæœ¬ï¼‰ã€‚ä¸€ä¸ªé•œåƒä»“åº“ä¸­åŒ…å«å¤šä¸ªé•œåƒImageã€‚\nDocker Hub ä¹Ÿåˆ†ä¸ºOfficial Repository å’Œ Unofficial Repositoryã€‚\n1docker pull \u0026lt;repository\u0026gt;:\u0026lt;tag\u0026gt; 2// å¦‚æœçœç•¥tagé»˜è®¤ä¼špull tag ä¸º latestçš„imageã€‚ä½†æ˜¯latestå¹¶ä¸ä¿è¯è¿™æ˜¯ä»“åº“ä¸­æœ€æ–°çš„é•œåƒã€‚ å¦‚æœå¸Œæœ›ä»ç¬¬ä¸‰æ–¹é•œåƒæœåŠ¡ä»“åº“è·å–é•œåƒ(not Docker Hub)ï¼Œåˆ™éœ€è¦åœ¨é•œåƒä»“åº“åç§°å‰åŠ ä¸Šç¬¬ä¸‰æ–¹é•œåƒä»“åº“æœåŠ¡çš„DNSåç§°ã€‚\n1# gcr.io -\u0026gt; Google Container Images Registry. 2docker pull gcr.io/k8s-staging-nfd/node-feature-discovery:master Image Tag ä¸åŒçš„Images Tagå¯ä»¥ç»‘å®šåŒä¸€ä¸ªImage ID\né€šè¿‡--filter æ¥è¿‡æ»¤docker image ls è¿”å›çš„å†…å®¹\n1docker image ls --filter dangling=true dangling image -\u0026gt; with out name \u0026amp; tag :.\né€šå¸¸å› ä¸ºæ„å»ºæ–°çš„é•œåƒï¼Œä¸ºè¯¥é•œåƒæ‰“äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ ‡ç­¾ã€‚Dockerä¼šremove old imageä¸Šçš„æ ‡ç­¾ï¼Œå°†è¯¥æ ‡ç­¾æ ‡åœ¨æ–°Imageä¸Šã€‚Old Image å°±ä¼šå˜æˆ dangling imageã€‚\nå¯ä»¥é€šè¿‡docker image prune ç§»é™¤æ‰€æœ‰çš„Dangling imagesã€‚å¦‚æœæ·»åŠ ä¸‹äº†-aå‚æ•°ï¼ŒDockerä¼šç§»é™¤æ‰€æœ‰æ²¡æœ‰ä½¿ç”¨çš„é•œåƒã€‚\ndocker image æ ¼å¼åŒ–è¾“å‡º go text template\n1docker images --format \u0026#34;{{.Repository}}:{{.Tag}}:{{.Size}}\u0026#34; ä»å®¹å™¨åˆ›å»ºä¸€ä¸ªé•œåƒ 1docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]] 2docker commit -a \u0026#34;bytegopher.com\u0026#34; -m \u0026#34;first commit\u0026#34; a404c6c174a2 mymysql:v1 3# -a æäº¤é•œåƒçš„ä½œè€… 4# -m æäº¤ä¿¡æ¯ Re-Tag The image\n1docker tag images:tag new-image:new-tag é•œåƒåˆ†å±‚ Docker æ˜¯ç”±ä¸€äº›æ¾è€¦åˆçš„åªè¯»é•œåƒå±‚ç»„æˆï¼ŒDockerè´Ÿè´£å †å è¿™äº›å±‚ï¼Œå¹¶å°†ä»–ä»¬è¡¨ç¤ºä¸ºå•ä¸ªç»Ÿä¸€çš„å¯¹è±¡ã€‚\ndocker pull images çš„æ—¶å€™å¯ä»¥çœ‹åˆ°æ˜¯é€å±‚ä¸‹è½½çš„ã€‚\nBuilder Image WORKDIR: å¦‚æœæ²¡æœ‰æ–‡ä»¶å¤¹ï¼Œä¼šåˆ›å»ºå¹¶è¿›å…¥ã€‚\nDocker Build Use Proxy\n1 2docker build -f Dockerfile ./ -t image-name:tag --build-arg http_proxy=$(HTTP_PROXY) --build-arg https_proxy=$(HTTPS_PROXY) 3 4 5--build-arg http_proxy=http://proxy-prc.intel.com:913 --build-arg https_proxy=http://proxy-prc.intel.com:913 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Docker/docker_build_image/","summary":"é•œåƒä»“åº“ Linux æœ¬åœ°é•œåƒä»“åº“ï¼š/var/lib/docker/image\né•œåƒåº”è¯¥æ˜¯åˆ†å±‚å­˜å‚¨çš„ã€‚\nDocker images æ˜¯å­˜å‚¨åœ¨é•œåƒä»“åº“æœåŠ¡Images Registryã€‚Docker å®¢æˆ·ç«¯çš„é•œåƒä»“åº“æœåŠ¡æ˜¯å¯é…ç½®çš„ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯Docker Hubã€‚\né•œåƒä»“åº“æœåŠ¡åŒ…å«å¤šä¸ªé•œåƒä»“åº“ Image Repositoryï¼ˆåŒä¸€ä¸ªé•œåƒçš„ä¸åŒç‰ˆæœ¬ï¼‰ã€‚ä¸€ä¸ªé•œåƒä»“åº“ä¸­åŒ…å«å¤šä¸ªé•œåƒImageã€‚\nDocker Hub ä¹Ÿåˆ†ä¸ºOfficial Repository å’Œ Unofficial Repositoryã€‚\n1docker pull \u0026lt;repository\u0026gt;:\u0026lt;tag\u0026gt; 2// å¦‚æœçœç•¥tagé»˜è®¤ä¼špull tag ä¸º latestçš„imageã€‚ä½†æ˜¯latestå¹¶ä¸ä¿è¯è¿™æ˜¯ä»“åº“ä¸­æœ€æ–°çš„é•œåƒã€‚ å¦‚æœå¸Œæœ›ä»ç¬¬ä¸‰æ–¹é•œåƒæœåŠ¡ä»“åº“è·å–é•œåƒ(not Docker Hub)ï¼Œåˆ™éœ€è¦åœ¨é•œåƒä»“åº“åç§°å‰åŠ ä¸Šç¬¬ä¸‰æ–¹é•œåƒä»“åº“æœåŠ¡çš„DNSåç§°ã€‚\n1# gcr.io -\u0026gt; Google Container Images Registry. 2docker pull gcr.io/k8s-staging-nfd/node-feature-discovery:master Image Tag ä¸åŒçš„Images Tagå¯ä»¥ç»‘å®šåŒä¸€ä¸ªImage ID\né€šè¿‡--filter æ¥è¿‡æ»¤docker image ls è¿”å›çš„å†…å®¹\n1docker image ls --filter dangling=true dangling image -\u0026gt; with out name \u0026amp; tag :.\né€šå¸¸å› ä¸ºæ„å»ºæ–°çš„é•œåƒï¼Œä¸ºè¯¥é•œåƒæ‰“äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ ‡ç­¾ã€‚Dockerä¼šremove old imageä¸Šçš„æ ‡ç­¾ï¼Œå°†è¯¥æ ‡ç­¾æ ‡åœ¨æ–°Imageä¸Šã€‚Old Image å°±ä¼šå˜æˆ dangling imageã€‚","tags":null,"title":"Docker Images"},{"categories":null,"contents":"Docker networking is based on an open-source pluggable architecture called the Container Network Model(CNM). libnetwork is Docker\u0026rsquo;s real-work implementation of the CNM, adn it provides all of the Docker\u0026rsquo;s core networking capabilities. Drivers plug into libnework to provide specifice network topologies.\nThe theory At the highest level, Docker networking comprise three major components.\nSingle-host bridge network ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Docker/docker_networking/","summary":"Docker networking is based on an open-source pluggable architecture called the Container Network Model(CNM). libnetwork is Docker\u0026rsquo;s real-work implementation of the CNM, adn it provides all of the Docker\u0026rsquo;s core networking capabilities. Drivers plug into libnework to provide specifice network topologies.\nThe theory At the highest level, Docker networking comprise three major components.\nSingle-host bridge network ","tags":null,"title":"Docker networking"},{"categories":null,"contents":"Dockerfile ä¸­çš„entrypoint å’ŒCMDçš„åŒºåˆ«\n1CMD executable param1 param2 # ä¸ç”¨ä½¿ç”¨è¿™ç§shellè¡¨ç¤ºæ³•ï¼Œ1 å·è¿›ç¨‹ä¸ºshell 2CMD [\u0026#34;executable\u0026#34;,\u0026#34;param1\u0026#34;,\u0026#34;param2\u0026#34;] EntryPoint å’ŒCMDéƒ½å¯ä»¥åœ¨æ‰§è¡Œçš„æ—¶å€™è¢«è¦†ç›–ã€‚\nç»„åˆä½¿ç”¨ENTRYPOINTå’ŒCMD, ENTRYPOINTæŒ‡å®šé»˜è®¤çš„è¿è¡Œå‘½ä»¤, CMDæŒ‡å®šé»˜è®¤çš„è¿è¡Œå‚æ•°. ä¾‹å­å¦‚ä¸‹:\n1FROM ubuntu:trusty 2ENTRYPOINT [\u0026#34;/bin/ping\u0026#34;,\u0026#34;-c\u0026#34;,\u0026#34;3\u0026#34;] 3CMD [\u0026#34;localhost\u0026#34;] docker ä¼šæŠŠCMDçš„å‘½ä»¤æ‹¼æ¥åˆ°Entrypointä¹‹å\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/docker_dockerfile/","summary":"Dockerfile ä¸­çš„entrypoint å’ŒCMDçš„åŒºåˆ«\n1CMD executable param1 param2 # ä¸ç”¨ä½¿ç”¨è¿™ç§shellè¡¨ç¤ºæ³•ï¼Œ1 å·è¿›ç¨‹ä¸ºshell 2CMD [\u0026#34;executable\u0026#34;,\u0026#34;param1\u0026#34;,\u0026#34;param2\u0026#34;] EntryPoint å’ŒCMDéƒ½å¯ä»¥åœ¨æ‰§è¡Œçš„æ—¶å€™è¢«è¦†ç›–ã€‚\nç»„åˆä½¿ç”¨ENTRYPOINTå’ŒCMD, ENTRYPOINTæŒ‡å®šé»˜è®¤çš„è¿è¡Œå‘½ä»¤, CMDæŒ‡å®šé»˜è®¤çš„è¿è¡Œå‚æ•°. ä¾‹å­å¦‚ä¸‹:\n1FROM ubuntu:trusty 2ENTRYPOINT [\u0026#34;/bin/ping\u0026#34;,\u0026#34;-c\u0026#34;,\u0026#34;3\u0026#34;] 3CMD [\u0026#34;localhost\u0026#34;] docker ä¼šæŠŠCMDçš„å‘½ä»¤æ‹¼æ¥åˆ°Entrypointä¹‹å","tags":null,"title":"Dockerfile"},{"categories":null,"contents":"We have a sever for code test, but with the test case growth, the Disk space is not enough for use.\nFortunately, we use ubuntu LVM to manage the Disk.\n1fdisk /dev/sdb 1pvdisplay https://gyazo.com/40b3c078d6bb755f9cca318b3c28b2cf\n1vgextend ubuntu-vg /dev/sdc1 1vgdisplay 1lvdisplay 1lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv 2resize2fs /dev/ubuntu-vg/ubuntu-lv Multipass extend VM disk size.\nMultipass uses qemu to create the VM instance. So you can modify the qemu image manually to change the VM disk size.\nStop the VM 1multipass stop vm-name Find the VM image 1/var/snap/multipass/common/data/multipassd/vault/instances Expand the size of the image 1qemu-img resize xxx.img 200G 2# qemu-img resize xxx.img +100G Restart the VM 1multipass start vm-name https://blog.yqxpro.com/2021/10/31/%E9%80%9A%E8%BF%87LVM%E7%BB%99Ubuntu%E6%B7%BB%E5%8A%A0%E7%A1%AC%E7%9B%98%E7%A9%BA%E9%97%B4/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/linux-ubuntu-lvm/","summary":"We have a sever for code test, but with the test case growth, the Disk space is not enough for use.\nFortunately, we use ubuntu LVM to manage the Disk.\n1fdisk /dev/sdb 1pvdisplay https://gyazo.com/40b3c078d6bb755f9cca318b3c28b2cf\n1vgextend ubuntu-vg /dev/sdc1 1vgdisplay 1lvdisplay 1lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv 2resize2fs /dev/ubuntu-vg/ubuntu-lv Multipass extend VM disk size.\nMultipass uses qemu to create the VM instance. So you can modify the qemu image manually to change the VM disk size.","tags":null,"title":"Extend Disk Space without shutdown"},{"categories":null,"contents":" type desc total physical mem used used = total- free-buffers-cache free Free/Unused memory shared It is here only for backward comopatibility buff/cache The combined memory used by the kernel buffers and page cache ans slabs. This memory can be reclaimed at any time if needed by the applicaitons. If you want buffers and cache to displayed in two separate columns, use -w options. available An estimate of the amount of memory that is availablew for starting new applications, without swaping. https://linuxize.com/post/free-command-in-linux/\nhttps://www.cnblogs.com/peida/archive/2012/12/25/2831814.html\nhttps://www.jianshu.com/p/2ffeb3a3aa90\nhttps://www.codenong.com/jsafe796ceec93/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/free/","summary":"type desc total physical mem used used = total- free-buffers-cache free Free/Unused memory shared It is here only for backward comopatibility buff/cache The combined memory used by the kernel buffers and page cache ans slabs. This memory can be reclaimed at any time if needed by the applicaitons. If you want buffers and cache to displayed in two separate columns, use -w options. available An estimate of the amount of memory that is availablew for starting new applications, without swaping.","tags":null,"title":"freeå‘½ä»¤"},{"categories":null,"contents":"1# git cache user and passwd 2git config --global credential.helper cache ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/git/","summary":"1# git cache user and passwd 2git config --global credential.helper cache ","tags":null,"title":"Git"},{"categories":null,"contents":"Golangçš„æ±‡ç¼–æ˜¯åŸºäºPlan9çš„çš„æ±‡ç¼–ï¼Œæ˜¯ä¸€ä¸ªä¸­é—´æ±‡ç¼–çš„æ–¹å¼ï¼Œè¿™æ ·å¯ä»¥å¿½ç•¥åº•å±‚CPUæ¶æ„çš„å·®åˆ«ã€‚\næ±‡ç¼–ä¸»è¦äº†è§£å„ç§å¯„å­˜å™¨çš„ä½¿ç”¨ä»¥åŠå¯»å€æ–¹å¼ã€‚æ ¹æ®Golangçš„æ±‡ç¼–æˆ‘ä»¬å¯ä»¥æ·±å…¥ç†è§£Golangçš„åº•å±‚å®ç°ã€‚æ¯”å¦‚å†…å­˜å¦‚ä½•åˆ†é…ï¼Œæ ˆå¦‚ä½•æ‰©å¼ ï¼Œæ¥å£å¦‚ä½•è½¬å˜ã€‚\nå¦‚ä½•ä»goè¯­è¨€è·å–å¯¹åº”çš„æ±‡ç¼–\n1go build -gcflags \u0026#34;-N -l\u0026#34; -ldflags=-compressdwarf=false =o main.out main.g 2go tool objdump -s \u0026#34;main.main\u0026#34; main.out \u0026gt; main.S 3# or 4go tool compile -S main.go 5# or 6go build -gcflags -S main.go æ±‡ç¼–åŸºç¡€è¯­æ³• é€šç”¨å¯„å­˜å™¨ å¯„å­˜å™¨ä¸ç‰©ç†æœºæ¶æ„æœ‰å…³ï¼Œä¸åŒçš„æ¶æ„æœ‰ä¸åŒçš„ç‰©ç†å¯„å­˜å™¨ã€‚\nåœ¨amd64æ¶æ„ä¸Šæä¾›äº†16ä¸ªé€šç”¨å¯„å­˜å™¨ç»™ç”¨æˆ·ä½¿ç”¨ã€‚\nPlan9æ±‡ç¼–è¯­è¨€æä¾›äº†å¦‚ä¸‹æ˜ å°„ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ±‡ç¼–è¯­è¨€ä¸­è¿™å‡ åº”ç”¨å°±å¯ä»¥ä½¿ç”¨ç‰©ç†å¯„å­˜å™¨äº†ã€‚\nx64æ¶æ„ä¸­æ‰€æœ‰çš„å¯„å­˜å™¨éƒ½æ˜¯64ä½\namd64 Plan9 rax AX rbx BX rcx CX rdx DX rdi DI rsi SI rbp BP rsp SP r8 R8 r9 R9 r10 R10 r11 R11 r12 R12 r13 R13 r14 R14 rip PC è™šæ‹Ÿå¯„å­˜å™¨ ä¼ªå¯„å­˜å™¨ä¸æ˜¯çœŸæ­£çš„å¯„å­˜å™¨ï¼Œè€Œæ˜¯ç”±å·¥å…·é“¾ç»´æŠ¤çš„è™šæ‹Ÿå¯„å­˜å™¨ï¼Œä¾‹å¦‚å¸§æŒ‡é’ˆã€‚\nFP: Frame pointer: arguements and localsã€‚ å¸§æŒ‡é’ˆï¼Œå¿«é€Ÿè®¿é—®å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼\n0(FP) represent the first arguement, 8(FP) represents the second parameter(AMD64 arch). first_arg+0(FP)è¡¨ç¤ºæŠŠç¬¬ä¸€ä¸ªå‚æ•°åœ°å€ç»‘å®šåˆ°ç¬¦å·first_arg\nSP: Stack pointer: the highest address within the local stack frame. æŒ‡å‘å½“å‰æ ˆé¡¶ã€‚æ ˆæŒ‡é’ˆï¼ŒæŒ‡å‘å±€éƒ¨å˜é‡ã€‚\nlocalvar0-8(SP)åœ¨plan9ä¸­è¡¨ç¤ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚ç‰©ç†å¯„å­˜å™¨ä¸­ä¹Ÿæœ‰SP,ç¡¬ä»¶SPæ‰æ˜¯çœŸæ­£è¡¨ç¤ºæ ˆé¡¶çš„ä½ç½®ã€‚æ‰€ä»¥ä¸ºäº†åŒºåˆ†SPåˆ°åº•æ˜¯æŒ‡ç¡¬ä»¶SPè¿˜æ˜¯è™šæ‹Ÿå¯„å­˜å™¨ã€‚Plan9ä»£ç ä¸­éœ€è¦ä»¥ç‰¹å®šçš„æ ¼å¼æ¥åŒºåˆ†ã€‚\nsymbol+offset(SP)è¡¨ç¤ºè™šæ‹Ÿå¯„å­˜å™¨SPã€‚offset(SP)è¡¨ç¤ºç¡¬ä»¶SP.\nPC: Program counter: jumps and branchsã€‚ ç¨‹åºè®¡æ•°å™¨ï¼ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚åœ¨amd64æ—¶å…¶å®å°±æ˜¯ripå¯„å­˜å™¨ã€‚\né™¤äº†ä¸ªåˆ«è·³è½¬æ²»ç†ï¼Œä¸€èˆ¬ç”¨ä¸åˆ°\nSB: Static base pointer: global symbolsã€‚é™æ€åŸºå€æŒ‡é’ˆï¼Œå…¨å±€ç¬¦å·ã€‚\nè¡¨ç¤ºå…¨å±€å†…å­˜èµ·ç‚¹ã€‚foo(SB)è¡¨ç¤ºç¬¦å·fooä½œä¸ºå†…å­˜åœ°å€ä½¿ç”¨ã€‚è¿™ç§å½¢å¼ç”¨äºå£°æ˜å…¨å±€å‡½æ•°ã€æ•°æ®ã€‚foo+4(SB)è¡¨ç¤ºfooå¾€å4å­—èŠ‚çš„åœ°å€ã€‚\u0026lt;\u0026gt;é™åˆ¶ç¬¦å·åªèƒ½åœ¨å½“å‰æºæ–‡ä»¶ä½¿ç”¨ã€‚\næ‰€æœ‰ç”¨æˆ·å®šä¹‰çš„ç¬¦å·éƒ½ä½œä¸ºåç§»é‡å†™å…¥ä¼ªå¯„å­˜å™¨ FP å’Œ SBã€‚\næ±‡ç¼–ä»£ç ä¸­éœ€è¦è¡¨ç¤ºç”¨æˆ·å®šä¹‰çš„ç¬¦å·(å˜é‡)æ—¶ï¼Œå¯ä»¥é€šè¿‡ SP ä¸åç§»è¿˜æœ‰å˜é‡åçš„ç»„åˆï¼Œæ¯”å¦‚x-8(SP) ï¼Œå› ä¸º SP æŒ‡å‘çš„æ˜¯æ ˆé¡¶ï¼Œæ‰€ä»¥åç§»å€¼éƒ½æ˜¯è´Ÿçš„ï¼Œxåˆ™è¡¨ç¤ºå˜é‡å\nå¯»å€æ¨¡å¼ æ±‡ç¼–è¯­è¨€çš„ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µå°±æ˜¯å®ƒçš„å¯»å€æ¨¡å¼ï¼ŒPlan 9 æ±‡ç¼–ä¹Ÿä¸ä¾‹å¤–ï¼Œå®ƒæ”¯æŒå¦‚ä¸‹å¯»å€æ¨¡å¼ï¼š\n1R0 æ•°æ®å¯„å­˜å™¨ 2A0 åœ°å€å¯„å­˜å™¨ 3F0 æµ®ç‚¹å¯„å­˜å™¨ 4CAAR, CACR, ç­‰ ç‰¹æ®Šåå­— 5$con å¸¸é‡ 6$fcon æµ®ç‚¹æ•°å¸¸é‡ 7name+o(SB) å¤–éƒ¨ç¬¦å· 8name\u0026lt;\u0026gt;+o(SB) å±€éƒ¨ç¬¦å· 9name+o(SP) è‡ªåŠ¨ç¬¦å· 10name+o(FP) å®é™…å‚æ•° 11$name+o(SB) å¤–éƒ¨åœ°å€ 12$name\u0026lt;\u0026gt;+o(SB) å±€éƒ¨åœ°å€ 13(A0)+ é—´æ¥åå¢é‡ 14-(A0) é—´æ¥å‰å¢é‡ 15o(A0) 16o()(R0.s) symbol+offset(SP) å¼•ç”¨å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œoffset çš„åˆæ³•å–å€¼æ˜¯ [-framesize, 0) å±€éƒ¨å˜é‡éƒ½æ˜¯ 8 å­—èŠ‚ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå±€éƒ¨å˜é‡å°±å¯ä»¥ç”¨ localvar0-8(SP) æ¥è¡¨ç¤º\nå¦‚æœæ˜¯ symbol+offset(SP) å½¢å¼ï¼Œåˆ™è¡¨ç¤ºä¼ªå¯„å­˜å™¨ SP å¦‚æœæ˜¯ offset(SP) åˆ™è¡¨ç¤ºç¡¬ä»¶å¯„å­˜å™¨ SP\nAssembler Directives DATA\u0026amp;GLOBL Fomat: Declare a global variable using DATA and GLOBL\nå…¨å±€æ•°æ®ç¬¦å·ä»¥DATAæŒ‡ä»¤èµ·å§‹å’Œä¸€ä¸ªGLOBLæŒ‡ä»¤å®šä¹‰ã€‚æ¯ä¸ªDATAæŒ‡å®šåˆå§‹åŒ–ç›¸åº”å†…å­˜çš„ä¸€éƒ¨åˆ†ã€‚æœªåˆå§‹åŒ–çš„å†…å­˜ä¸ºé›¶ã€‚ä¸€èˆ¬å½¢å¼ä¸º\n1DATA sysbol+offset(SP)/width, value åœ¨ç»™å®šçš„offsetå’Œwidthå¤„åˆå§‹åŒ–è¯¥ç¬¦å·çš„å†…å­˜ä¸ºvalueã€‚DATAå¿…é¡»é€šè¿‡å¢åŠ çš„åç§»é‡æ¥å†™å…¥ç»™å®šç¬¦å·çš„æŒ‡ä»¤ã€‚\nGLOBLæŒ‡ä»¤å£°æ˜ç¬¦å·æ˜¯å…¨å±€çš„ã€‚å‚æ•°æ˜¯å¯é€‰æ ‡å¿—ï¼Œå¹¶ä¸”æ•°æ®çš„å¤§å°è¢«å£°æ˜ä¸ºå…¨å±€ï¼Œé™¤éDATAæŒ‡ä»¤å·²åˆå§‹åŒ–ï¼Œå¦åˆ™åˆå§‹å€¼å°†ä¸ºå…¨0.\n1DATA divtab\u0026lt;\u0026gt;+0x00(SB)/4, $0xf4f8fcff # set value for divtab from 0 to 4 2DATA divtab\u0026lt;\u0026gt;+0x04(SB)/4, $0xf3f4f8f9 3.... 4DATA divtab\u0026lt;\u0026gt;+0x3c(SB)/4, $0xf3f4f8f9 # divtab 64bytes 5GLOBL divtab\u0026lt;\u0026gt;(SB),RODATA,$64 # add flag RODATA means readonly, 6 #$64 is the var\u0026#39;s length 64byte 7 8GLOBL runtime.tlsoffset(SB),NOPTR,$4 # NOPTR This data contains no pointers. Rumtime Flag\nTEXT 1TEXT runtime.profileloop(SB),NOSPLIT,$8 # NOSPIT // Don\u0026#39;t insert stack check preamble. 2\tMOVQ $runtime.profileloop(SB),CX 3\tMOVQ CX, 0(SP) 4\tCALL runtime.externalthreadhandler(SB) 5\tRET è¿™æ®µä»£ç æˆä¸ºä¸€ä¸ªTEXT blockï¼Œruntime.profileloop(SB)åé¢æœ‰ä¸€ä¸ªNOSPLIT flagï¼Œç´§éšå…¶åçš„$8è¡¨ç¤ºframe_size, é€šå¸¸frame_sizeçš„æ„æˆéƒ½æ˜¯å½¢å¦‚$8-24,è¡¨ç¤ºè¿™ä¸ªtext blockè¿è¡Œéœ€è¦å ç”¨8byteçš„å†…å­˜ç©ºé—´ï¼Œå‚æ•°å’Œè¿”å›å€¼è¦å ç”¨24Byteçš„å†…å­˜ç©ºé—´ã€‚(è¿™24ä¸ªå­—èŠ‚å ç”¨çš„æ˜¯è°ƒç”¨æ–¹æ ˆå¸§é‡Œçš„ç©ºé—´)ã€‚\nå¦‚æœæœ‰NOSPLITè¿™ä¸ªflagï¼Œåˆ™å¯ä»¥å¿½ç•¥å‚æ•°å’Œè¿”å›å€¼å ç”¨çš„ç©ºé—´ï¼Œå¦‚ä¸Šè¿°ä¾‹å­ï¼Œåªæœ‰ä¸€ä¸ª$8ã€‚è¡¨ç¤ºframe_ziseåªæœ‰8å­—èŠ‚å¤§å°ã€‚è¿™ä»æ±‡ç¼–ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ MOVQ CX,0(SP)ï¼Œ å› ä¸ºMOVQè¡¨ç¤ºè¿™ä¸ªæ“ä½œçš„æ“ä½œæ•°æ˜¯8Bytes.\nFUNCDATA å’ŒPCDATAæŒ‡ä»¤åŒ…å«äº†æœ‰åƒåœ¾å›æ”¶å™¨ä½¿ç”¨çš„ä¿¡æ¯ï¼Œç”±ç¼–è¯‘å™¨å¼•å…¥\nInstruction å¸¸ç”¨æŒ‡ä»¤æœ‰ä»¥ä¸‹å‡ ç±»ï¼šæ•°æ®ç§»åŠ¨ç±»ï¼Œä¾‹å¦‚MOVï¼›è·³è½¬ï¼Œæ— æ¡ä»¶è·³è½¬æˆ–è€…æœ‰æ¡ä»¶è·³è½¬ï¼›é€»è¾‘è¿ç®—å’Œç®—æ•°è¿ç®—ï¼›è¿˜æœ‰æŒ‡ä»¤çš„prefix, ä¾‹å¦‚LOCK\nInstructoin Size MOVB 1 Bytes MOVW 2 Bytes MOVL 4 Bytes MOVQ 8 Bytes JMP MOVEQ LEAQ SUBQ ANDQ CALL PUSHQ POPQ CLD CMPQ CPUID JEQ â€‹\nè¿è¡Œæ—¶åè°ƒ ä¸ºä¿è¯åƒåœ¾å›æ”¶çš„æ­£ç¡®è¿è¡Œï¼Œåœ¨å¤§å¤šæ•°çš„æ ˆå¸§ä¸­ï¼Œè¿è¡Œæ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰çš„å…¨å±€æ•°æ®çš„æŒ‡é’ˆã€‚Goç¼–è¯‘å™¨ä¼šå°†è¿™ä¸€éƒ¨åˆ†ä¿¡æ¯è€¦åˆåˆ°Goæºç æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯æ±‡ç¼–ç¨‹åºå¿…é¡»è¿›è¡Œæ˜¾å¼çš„å®šä¹‰ã€‚\nè¢«æ ‡è®°ä¸º NOPTR æ ‡å¿—çš„æ•°æ®ç¬¦å·ä¼šè§†ä¸ºä¸åŒ…å«æŒ‡å‘è¿è¡Œæ—¶åˆ†é…æ•°æ®çš„æŒ‡é’ˆã€‚ å¸¦æœ‰ R0DATA æ ‡å¿—çš„æ•°æ®ç¬¦å·åœ¨åªè¯»å­˜å‚¨å™¨ä¸­åˆ†é…ï¼Œå› æ­¤è¢«éšå¼æ ‡è®°ä¸º NOPTRã€‚ æ€»å¤§å°å°äºæŒ‡é’ˆçš„æ•°æ®ç¬¦å·ä¹Ÿè¢«è§†ä¸ºéšå¼æ ‡è®° NOPTRã€‚ åœ¨ä¸€ä»½æ±‡ç¼–æºæ–‡ä»¶ä¸­æ˜¯æ— æ³•å®šä¹‰åŒ…å«æŒ‡é’ˆçš„ç¬¦å·çš„ï¼Œå› æ­¤è¿™ç§ç¬¦å·å¿…é¡»å®šä¹‰åœ¨ Go æºæ–‡ä»¶ä¸­ã€‚ ä¸€ä¸ªè‰¯å¥½çš„ç»éªŒæ³•åˆ™æ˜¯ R0DATA åœ¨ Go ä¸­å®šä¹‰æ‰€æœ‰éç¬¦å·è€Œä¸æ˜¯åœ¨æ±‡ç¼–ä¸­å®šä¹‰ã€‚\næ¯ä¸ªå‡½æ•°è¿˜éœ€è¦æ³¨é‡Šï¼Œåœ¨å…¶å‚æ•°ï¼Œç»“æœå’Œæœ¬åœ°å †æ ˆæ¡†æ¶ä¸­ç»™å‡ºå®æ—¶æŒ‡é’ˆçš„ä½ç½®ã€‚ å¯¹äºæ²¡æœ‰æŒ‡é’ˆç»“æœä¸”æ²¡æœ‰æœ¬åœ°å †æ ˆå¸§æˆ–æ²¡æœ‰å‡½æ•°è°ƒç”¨çš„æ±‡ç¼–å‡½æ•°ï¼Œ å”¯ä¸€çš„è¦æ±‚æ˜¯åœ¨åŒä¸€ä¸ªåŒ…ä¸­çš„ Go æºæ–‡ä»¶ä¸­ä¸ºå‡½æ•°å®šä¹‰ Go åŸå‹ã€‚ æ±‡ç¼–å‡½æ•°çš„åç§°ä¸èƒ½åŒ…å«åŒ…åç§°ç»„ä»¶ ï¼ˆä¾‹å¦‚ï¼Œsyscall åŒ…ä¸­çš„å‡½æ•° Syscall åº”ä½¿ç”¨åç§° Â·Syscall è€Œä¸æ˜¯ syscallÂ·Syscall å…¶ TEXT æŒ‡ä»¤ä¸­çš„ç­‰æ•ˆåç§°ï¼‰ã€‚ å¯¹äºæ›´å¤æ‚çš„æƒ…å†µï¼Œéœ€è¦æ˜¾å¼æ³¨é‡Šã€‚ è¿™äº›æ³¨é‡Šä½¿ç”¨æ ‡å‡† #include æ–‡ä»¶ä¸­å®šä¹‰çš„ä¼ªæŒ‡ä»¤ funcdata.hã€‚\nå¦‚æœå‡½æ•°æ²¡æœ‰å‚æ•°ä¸”æ²¡æœ‰ç»“æœï¼Œåˆ™å¯ä»¥çœç•¥æŒ‡é’ˆä¿¡æ¯ã€‚è¿™æ˜¯ç”±ä¸€ä¸ªå‚æ•°å¤§å° $n-0 æ³¨é‡ŠæŒ‡ç¤º TEXT å¯¹æŒ‡ä»¤ã€‚ å¦åˆ™ï¼ŒæŒ‡é’ˆä¿¡æ¯å¿…é¡»ç”± Go æºæ–‡ä»¶ä¸­çš„å‡½æ•°çš„ Go åŸå‹æä¾›ï¼Œå³ä½¿å¯¹äºæœªç›´æ¥ä» Go è°ƒç”¨çš„æ±‡ç¼–å‡½æ•°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ï¼ˆåŸå‹ä¹Ÿå°† go vet æ£€æŸ¥å‚æ•°å¼•ç”¨ã€‚ï¼‰åœ¨å‡½æ•°çš„å¼€å¤´ï¼Œå‡å®šå‚æ•°è¢«åˆå§‹åŒ–ä½†ç»“æœå‡å®šæœªåˆå§‹åŒ–ã€‚ å¦‚æœç»“æœå°†åœ¨è°ƒç”¨æŒ‡ä»¤æœŸé—´ä¿å­˜å®æ—¶æŒ‡é’ˆï¼Œåˆ™è¯¥å‡½æ•°åº”é¦–å…ˆå°†ç»“æœå½’é›¶ï¼Œ ç„¶åæ‰§è¡Œä¼ªæŒ‡ä»¤ GO_RESULTS_INITIALIZEDã€‚ æ­¤æŒ‡ä»¤è®°å½•ç»“æœç°åœ¨å·²åˆå§‹åŒ–ï¼Œåº”åœ¨å †æ ˆç§»åŠ¨å’Œåƒåœ¾å›æ”¶æœŸé—´è¿›è¡Œæ‰«æã€‚ é€šå¸¸æ›´å®¹æ˜“å®‰æ’æ±‡ç¼–å‡½æ•°ä¸è¿”å›æŒ‡é’ˆæˆ–ä¸åŒ…å«è°ƒç”¨æŒ‡ä»¤; æ ‡å‡†åº“ä¸­æ²¡æœ‰æ±‡ç¼–å‡½æ•°ä½¿ç”¨ GO_RESULTS_INITIALIZEDã€‚\nå¦‚æœå‡½æ•°æ²¡æœ‰æœ¬åœ°å †æ ˆå¸§ï¼Œåˆ™å¯ä»¥çœç•¥æŒ‡é’ˆä¿¡æ¯ã€‚è¿™ç”± TEXT æŒ‡ä»¤ä¸Šçš„æœ¬åœ°å¸§å¤§å° $0-n æ³¨é‡Šè¡¨ç¤ºã€‚å¦‚æœå‡½æ•°ä¸åŒ…å«è°ƒç”¨æŒ‡ä»¤ï¼Œä¹Ÿå¯ä»¥çœç•¥æŒ‡é’ˆä¿¡æ¯ã€‚å¦åˆ™ï¼Œæœ¬åœ°å †æ ˆå¸§ä¸èƒ½åŒ…å«æŒ‡é’ˆï¼Œå¹¶ä¸”æ±‡ç¼–å¿…é¡»é€šè¿‡æ‰§è¡Œä¼ªæŒ‡ä»¤ TEXTNO_LOCAL_POINTERS æ¥ç¡®è®¤è¿™ä¸€äº‹å®ã€‚å› ä¸ºé€šè¿‡ç§»åŠ¨å †æ ˆæ¥å®ç°å †æ ˆå¤§å°è°ƒæ•´ï¼Œæ‰€ä»¥å †æ ˆæŒ‡é’ˆå¯èƒ½åœ¨ä»»ä½•å‡½æ•°è°ƒç”¨æœŸé—´å‘ç”Ÿå˜åŒ–ï¼šç”šè‡³æŒ‡å‘å †æ ˆæ•°æ®çš„æŒ‡é’ˆä¹Ÿä¸èƒ½ä¿å­˜åœ¨å±€éƒ¨å˜é‡ä¸­ã€‚\næ±‡ç¼–å‡½æ•°åº”å§‹ç»ˆç»™å‡º Go åŸå‹ï¼Œæ—¢å¯ä»¥æä¾›å‚æ•°å’Œç»“æœçš„æŒ‡é’ˆä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ go vet æ£€æŸ¥ç”¨äºè®¿é—®å®ƒä»¬çš„åç§»é‡æ˜¯å¦æ­£ç¡®ã€‚\nDemo Runtime CAS æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·é˜…è¯» asm_amd64.sä¸­çš„æ±‡ç¼–\nç¬¬ä¸€ä¸ªæ±‡ç¼–ï¼šå®ç° CAS æ“ä½œ\n1// asm_amd64.s 2 3// bool Cas(int32 *val, int32 old, int32 new) 4// Atomically: 5//\tif(*val == old){ 6//\t*val = new; 7//\treturn 1; 8//\t} else 9//\treturn 0; 10TEXT runtimeâˆ•internalâˆ•atomic.Cas(SB),NOSPLIT,$0-17 11\tMOVQ\tptr+0(FP), BX 12\tMOVL\told+8(FP), AX 13\tMOVL\tnew+12(FP), CX 14\tLOCK 15\tCMPXCHGL\tCX, 0(BX) 16\tSETEQ\tret+16(FP) 17\tRET æˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ä¸ªæ±‡ç¼–ï¼Œä½¿ç”¨æ±‡ç¼–å®ç° CAS (compare and swap)æ“ä½œ\næˆ‘ä»¬ä¸€æ¡ä¸€æ¡çš„çœ‹ï¼Œå…ˆçœ‹TEXT runtimeâˆ•internalâˆ•atomicÂ·Cas(SB),NOSPLIT,$0-17 ã€‚$0-17è¡¨ç¤ºçš„æ„æ€æ˜¯è¿™ä¸ªTEXT blockè¿è¡Œçš„æ—¶å€™ï¼Œéœ€è¦å¼€è¾Ÿçš„æ ˆå¸§å¤§å°æ˜¯ 0 ï¼Œè€Œ17 = 8 + 4 + 4 + 1 = sizeof(pointer of int32) + sizeof(int32) + sizeof(int32) + sizeof(bool) ï¼ˆè¿”å›å€¼æ˜¯ bool ï¼Œå æ® 1 ä¸ªå­—èŠ‚\nç„¶åæˆ‘ä»¬å†çœ‹ block å†…çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ ï¼Œ è¿™é‡Œçš„ FPï¼Œæ˜¯ä¼ªå¯„å­˜å™¨(pseudo) ï¼Œé‡Œè¾¹å­˜çš„æ˜¯ Frame Pointer, FP é…åˆåç§» å¯ä»¥æŒ‡å‘å‡½æ•°è°ƒç”¨å‚æ•°æˆ–è€…ä¸´æ—¶å˜é‡\nMOVQ ptr+0(FP), BX è¿™ä¸€å¥è¯æ˜¯æŒ‡æŠŠå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ptr+0(FP)ç§»åŠ¨åˆ° BX å¯„å­˜å™¨ä¸­\nMOVQ ä»£è¡¨ç§»åŠ¨çš„æ˜¯ 8 ä¸ªå­—èŠ‚,Q ä»£è¡¨ 64bit ï¼Œå‚æ•°çš„å¼•ç”¨æ˜¯ å‚æ•°åç§°+åç§»(FP),å¯ä»¥çœ‹åˆ°è¿™é‡Œåç§°ç”¨äº† ptr,å¹¶ä¸æ˜¯ val,å˜é‡åå¯¹æ±‡ç¼–ä¸ä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Œä½†æ˜¯è¯­æ³•ä¸Šæ˜¯å¿…é¡»å¸¦ä¸Šçš„ï¼Œå¯è¯»æ€§ä¹Ÿä¼šæ›´å¥½äº›ã€‚\nåè¾¹ä¸¤æ¡ MOVL ä¸å†èµ˜è¿°\nLOCK å¹¶ä¸æ˜¯æŒ‡ä»¤ï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡ä»¤çš„å‰ç¼€ (instruction prefix)ï¼Œæ˜¯ç”¨æ¥ä¿®é¥° CMPXCHGL CX,0(BX) çš„\nThe LOCK prefix ensures that the CPU has exclusive ownership of the appropriate cache line for the duration of the operation, and provides certain additional ordering guarantees. This may be achieved by asserting a bus lock, but the CPU will avoid this where possible. If the bus is locked then it is only for the duration of the locked instruction\nCMPXCHGL æœ‰ä¸¤ä¸ªæ“ä½œæ•°ï¼ŒCX å’Œ 0(BX) ,0(BX) ä»£è¡¨çš„æ˜¯ val çš„åœ°å€ offset(BX) æ˜¯ä¸€ç§ addressing model , æŠŠå¯„å­˜å™¨é‡Œå­˜çš„å€¼ + offset ä½œä¸ºç›®æ ‡åœ°å€\nCMPXCHGL æŒ‡ä»¤åšçš„äº‹æƒ…ï¼Œé¦–å…ˆä¼šæŠŠ destination operand(ä¹Ÿå°±æ˜¯ 0(BX))é‡Œçš„å€¼ å’Œ AX å¯„å­˜å™¨é‡Œå­˜çš„å€¼åšæ¯”è¾ƒï¼Œå¦‚æœä¸€æ ·çš„è¯ä¼šæŠŠ CX é‡Œè¾¹å­˜çš„å€¼ä¿å­˜åˆ° 0(BX) è¿™å—åœ°å€é‡Œ (è™½ç„¶è¿™æ¡æŒ‡ä»¤é‡Œå¹¶æ²¡æœ‰å‡ºç° AXï¼Œä½†æ˜¯è¿˜æ˜¯ç”¨åˆ°äº†ï¼Œæ±‡ç¼–é‡Œè¿˜æ˜¯æœ‰ä¸å°‘è¿™æ ·çš„æƒ…å†µ) CMPXCHGL æœ€åçš„é‚£ä¸ª L åº”è¯¥è¡¨ç¤ºçš„æ˜¯æ“ä½œé•¿åº¦æ˜¯ 32 bit ï¼Œä»å‡½æ•°çš„å®šä¹‰æ¥çœ‹ old å’Œ new éƒ½æ˜¯ int32 å‡½æ•°è¿”å›ä¸€ä¸ª Bool å ç”¨ 8bit ï¼ŒSETEQ ä¼šåœ¨ AX å’Œ CX ç›¸ç­‰çš„æ—¶å€™æŠŠ 1 å†™è¿› ret+16(FP) (å¦åˆ™å†™ 0\nAVX512 Reference\nhttps://programmer.ink/think/introduction-to-golang-assembly.html\nhttps://golang.design/under-the-hood/zh-cn/part1basic/ch01basic/asm/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/0_go_assambely/","summary":"Golangçš„æ±‡ç¼–æ˜¯åŸºäºPlan9çš„çš„æ±‡ç¼–ï¼Œæ˜¯ä¸€ä¸ªä¸­é—´æ±‡ç¼–çš„æ–¹å¼ï¼Œè¿™æ ·å¯ä»¥å¿½ç•¥åº•å±‚CPUæ¶æ„çš„å·®åˆ«ã€‚\næ±‡ç¼–ä¸»è¦äº†è§£å„ç§å¯„å­˜å™¨çš„ä½¿ç”¨ä»¥åŠå¯»å€æ–¹å¼ã€‚æ ¹æ®Golangçš„æ±‡ç¼–æˆ‘ä»¬å¯ä»¥æ·±å…¥ç†è§£Golangçš„åº•å±‚å®ç°ã€‚æ¯”å¦‚å†…å­˜å¦‚ä½•åˆ†é…ï¼Œæ ˆå¦‚ä½•æ‰©å¼ ï¼Œæ¥å£å¦‚ä½•è½¬å˜ã€‚\nå¦‚ä½•ä»goè¯­è¨€è·å–å¯¹åº”çš„æ±‡ç¼–\n1go build -gcflags \u0026#34;-N -l\u0026#34; -ldflags=-compressdwarf=false =o main.out main.g 2go tool objdump -s \u0026#34;main.main\u0026#34; main.out \u0026gt; main.S 3# or 4go tool compile -S main.go 5# or 6go build -gcflags -S main.go æ±‡ç¼–åŸºç¡€è¯­æ³• é€šç”¨å¯„å­˜å™¨ å¯„å­˜å™¨ä¸ç‰©ç†æœºæ¶æ„æœ‰å…³ï¼Œä¸åŒçš„æ¶æ„æœ‰ä¸åŒçš„ç‰©ç†å¯„å­˜å™¨ã€‚\nåœ¨amd64æ¶æ„ä¸Šæä¾›äº†16ä¸ªé€šç”¨å¯„å­˜å™¨ç»™ç”¨æˆ·ä½¿ç”¨ã€‚\nPlan9æ±‡ç¼–è¯­è¨€æä¾›äº†å¦‚ä¸‹æ˜ å°„ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ±‡ç¼–è¯­è¨€ä¸­è¿™å‡ åº”ç”¨å°±å¯ä»¥ä½¿ç”¨ç‰©ç†å¯„å­˜å™¨äº†ã€‚\nx64æ¶æ„ä¸­æ‰€æœ‰çš„å¯„å­˜å™¨éƒ½æ˜¯64ä½\namd64 Plan9 rax AX rbx BX rcx CX rdx DX rdi DI rsi SI rbp BP rsp SP r8 R8 r9 R9 r10 R10 r11 R11 r12 R12 r13 R13 r14 R14 rip PC è™šæ‹Ÿå¯„å­˜å™¨ ä¼ªå¯„å­˜å™¨ä¸æ˜¯çœŸæ­£çš„å¯„å­˜å™¨ï¼Œè€Œæ˜¯ç”±å·¥å…·é“¾ç»´æŠ¤çš„è™šæ‹Ÿå¯„å­˜å™¨ï¼Œä¾‹å¦‚å¸§æŒ‡é’ˆã€‚","tags":null,"title":"Go Assembly"},{"categories":null,"contents":"n\nhttps://zhuanlan.zhihu.com/p/343562661\nhttps://draveness.me/golang/docs/part3-runtime/ch06-concurrency/golang-sysmon/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/0_go_compile/","summary":"n\nhttps://zhuanlan.zhihu.com/p/343562661\nhttps://draveness.me/golang/docs/part3-runtime/ch06-concurrency/golang-sysmon/","tags":null,"title":"Go compile"},{"categories":null,"contents":"å®‰è£…Go å¼€å§‹å†™Golangä¹‹å‰ï¼Œä½ é¦–å…ˆéœ€è¦ä¸‹è½½å¹¶ä¸”å®‰è£…Golangå¼€å‘å·¥å…·ã€‚å¯ä»¥åœ¨Golangçš„å®˜æ–¹ç½‘ç«™ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…ã€‚æ ¹æ®ä½ çš„å¼€å‘å¹³å°é€‰æ‹©ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ã€‚å¯¹äºMacç”¨æˆ·(æˆ–è€…Windowsç”¨æˆ·)æ¥è¯´.pkg(æˆ–msi)å®‰è£…åŒ…ä¼šè‡ªåŠ¨æŠŠGolangå®‰è£…åˆ°åˆé€‚çš„ä½ç½®ï¼Œå¹¶å°†å‘½ä»¤åŠ å…¥åˆ°ç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”è‡ªåŠ¨ç§»é™¤è€ç‰ˆæœ¬ã€‚å¦‚æœä½¿ç”¨Macæ›´åŠ æ¨èç›´æ¥ä½¿ç”¨brew install goï¼Œ ä½¿ç”¨brew å¯ä»¥æ–¹ä¾¿çš„ç®¡ç†Goå¤šä¸ªç‰ˆæœ¬ã€‚\nå¯¹äºLinuxæˆ–è€…FreeBSDç”¨æˆ·å¯ä»¥ç›´æ¥ä¸‹è½½å¯¹åº”çš„.tar.gz, å¹¶è§£å‹åˆ°æ–‡ä»¶åä¸ºgoçš„ç›®å½•ä¸­ã€‚æŠŠè¿™ä¸ªæ–‡ä»¶Copyåˆ°/usr/local/ä¸‹ã€‚ç„¶åæŠŠ/usr/local/go/binæ·»åŠ åˆ°$PATHä¸­ã€‚\n1tar -C /usr/local -xzvf go1.17.3.linux-amd64.tar.gz 2# change .profile to .bashrc or.zsh depend on you evnironment 3echo \u0026#34;export PATH=$PATH:/usr/local/go/bin\u0026#34; \u0026gt;\u0026gt;$HOME/.profile Go ç¨‹åºç¼–è¯‘å®Œæˆåæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸éœ€è¦ä¾èµ–ä»»ä½•è¿è¡Œè½¯ä»¶(ä¾‹å¦‚ï¼ŒPythonéœ€è¦Pythonè§£é‡Šå™¨ï¼ŒJavaéœ€è¦JVM)ã€‚ä»…åœ¨éœ€è¦ç¼–è¯‘Goä»£ç çš„ç¯å¢ƒä¸Šå®‰è£…Goå³å¯ã€‚\nå®‰è£…å®Œæˆåï¼Œæ‰“å¼€Terminal(Window æ‰“å¼€CMD)ï¼ŒéªŒè¯Goæ˜¯å¦å®‰è£…æˆåŠŸã€‚\n1go version åœ¨æ‰€æœ‰çš„é…ç½®éƒ½æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„ç‰ˆæœ¬ä¿¡æ¯\n1# mac intel cpu 64bit 2go version go1.17.3 darwin/amd64 ä»ä¸Šè¿°ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡ºï¼ŒGoçš„ç‰ˆæœ¬æ˜¯1.17.3,ä½¿ç”¨çš„å¼€å‘æœºå™¨æ˜¯ Mac(Darwin æ˜¯MacOSçš„Kernel Name, amd64 æ˜¯æŒ‡64-bitçš„x86 CPUæ¶æ„)ã€‚\nå¦‚æœä½ æ²¡æœ‰å¾—åˆ°æ­£ç¡®çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯ä½ æ²¡æœ‰æŠŠgoåŠ å…¥åˆ°ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…æœ‰å…¶ä»–çš„ç¨‹åºåç§°ä¹Ÿä¸ºgoã€‚å¯¹äºMacæˆ–è€…Unix-likeç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨which goæŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹çš„goçš„æ˜¯å¦æ­£ç¡®å…³è”åˆ°/usr/local/go/binã€‚å¦‚æœè·¯å¾„æ­£ç¡®ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸‹è½½é”™äº†å®‰è£…åŒ…ï¼Œæ£€æŸ¥ä¸‹å®‰è£…åŒ…çš„ä½æ•°æ˜¯å¦ä¸å½“å‰æ“ä½œç³»ç»ŸåŒ¹é…ï¼Œæœ‰å¯èƒ½åœ¨64-bitçš„ç³»ç»Ÿä¸Šä¸‹è½½äº†32-bitçš„å®‰è£…åŒ…ã€‚å¦å¤–ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯èŠ¯ç‰‡æ¶æ„é€‰é”™äº†ã€‚\nGo å·¥ä½œç©ºé—´ ä»2009å¹´Goå¼€å§‹ä½¿ç”¨ï¼Œåœ¨å¼€å‘è€…å¦‚æœç»„ç»‡ä»£ç å’Œç®¡ç†ä¾èµ–ä¸Šç»å†äº†å‡ æ¬¡å˜åŒ–ã€‚åœ¨Go 1.11æ‰€æœ‰çš„ä»£ç å¿…é¡»ä¿å­˜åœ¨GOPATHä¹‹ä¸‹ï¼Œä¹‹åçš„ç‰ˆæœ¬ç”¨æˆ·å¯ä»¥åœ¨ä»»æ„ç›®å½•ä¸‹å­˜å‚¨è‡ªå·±çš„ä»£ç ã€‚ä½†æ˜¯Goä¾ç„¶å¸Œæœ›æœ‰ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œç©ºé—´å¯ä»¥å­˜å‚¨é€šè¿‡go installå®‰è£…é¢ç¬¬ä¸‰æ–¹åŒ…ã€‚é»˜è®¤çš„å·¥ä½œç©ºé—´æ˜¯$HOME/go, ä¸‹è½½çš„ç¬¬ä¸‰æ–¹åŒ…é»˜è®¤å­˜å‚¨åœ¨$HOME/go/src,ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜å‚¨åœ¨$HOME/go/binã€‚ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé»˜è®¤çš„å·¥ä½œç©ºé—´ï¼Œæˆ–è€…é€šè¿‡è®¾ç½®$GOPAHTæŒ‡å®šä¸€ä¸ªå·¥ä½œç©ºé—´ã€‚\næ— è®ºä½ æ˜¯å¦ä½¿ç”¨é»˜è®¤çš„wokespaceï¼Œå»ºè®®ä½ æŠŠ$GOPATH/binåŠ å…¥åˆ°$PATHä¸­ã€‚ é€šè¿‡æŒ‡å®š$GOPATHå¯ä»¥æ¸…æ¥šåœ°æè¿°å½“å‰ç¯å¢ƒçš„Goå·¥ä½œç©ºé—´ï¼ŒæŠŠ$GOPATH/binåŠ å…¥åˆ°å¯æ‰§è¡Œè·¯å¾„ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨go install å®‰è£…çš„ç¬¬ä¸‰æ–¹åŒ…ã€‚\nå¦‚æœæ˜¯Unix-likeçš„å¼€å‘ç¯å¢ƒå¯ä»¥æŠŠä¸‹é¢å‡ è¡ŒåŠ å…¥åˆ°$HOME/.profileä¸­ã€‚\n1# if use ubuntu you should add to .bashrc,if yuo use zsh, suggest add to .zshrc 2export GOPATH=$HOME/go 3export PATH=$PATH:$GOPATH/bin æ·»åŠ å®Œæˆä¹‹åéœ€è¦æ‰§è¡Œsource $HOME/.profilä½¿å½“å‰çª—å£çš„terminalåŠ è½½é…ç½®ã€‚\nå¦‚æœæ˜¯Window ç³»ç»Ÿï¼Œå¯ä»¥è¿è¡Œå¦‚ä¸‹ä¸¤æ¡å‘½ä»¤,ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†ç•Œé¢é…ç½®ã€‚\n1set GOPATH %USERPROFILE%\\go 2set path \u0026#34;%path%;%GOPATH%\\bin\u0026#34; è¿è¡Œå®Œè¿™ä¸¤æ¡æŒ‡ä»¤åä½ éœ€è¦å…³é—­å½“å‰cmdçª—å£ï¼Œé‡æ–°æ‰“å¼€åå³å¯ç”Ÿæ•ˆã€‚\nè¿˜æœ‰å…¶ä»–å¾ˆå¤šGoéœ€è¦ç”¨åˆ°çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥é€šè¿‡go envæŸ¥çœ‹æ‰€æœ‰çš„å˜é‡åˆ—è¡¨ã€‚\n1âœ ~ go env 2# æ˜¯å¦å¯ç”¨go mod,å»ºè®®è®¾ç½®ä¸º autoï¼Œå…¼å®¹è€çš„project 3GO111MODULE=\u0026#34;\u0026#34; 4# cpu architecture for cross-compilation 5GOARCH=\u0026#34;amd64\u0026#34; 6GOBIN=\u0026#34;/Users/airren/go/bin\u0026#34; 7# os type for cross-compilation 8GOOS=\u0026#34;darwin\u0026#34; 9GOPATH=\u0026#34;/Users/airren/go:/tmp/goc2p\u0026#34; 10GOPROXY=\u0026#34;https://goproxy.cn,direct\u0026#34; 11GOROOT=\u0026#34;/usr/local/Cellar/go/1.17.3/libexec\u0026#34; 12GOSUMDB=\u0026#34;sum.golang.org\u0026#34; 13GOVERSION=\u0026#34;go1.17.3\u0026#34; 14GCCGO=\u0026#34;gccgo\u0026#34; 15AR=\u0026#34;ar\u0026#34; 16CC=\u0026#34;clang\u0026#34; 17CXX=\u0026#34;clang++\u0026#34; 18CGO_ENABLED=\u0026#34;1\u0026#34; 19GOMOD=\u0026#34;/dev/null\u0026#34; 20Â·Â·Â·Â·Â· Go å¸¸ç”¨å‘½ä»¤ goæä¾›äº†å¾ˆå¤šå‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤åŒ…å«compiler(ç¼–è¯‘)ã€code formatter(ä¹¦å†™æ ¼å¼åŒ–)ã€linter(é™æ€æ£€æŸ¥)ã€dependency manager(ä¾èµ–ç®¡ç†)ã€test runnerç­‰ç­‰ã€‚\ngo run å’Œ go build è¿™ä¸¤ä¸ªå‘½ä»¤go runå’Œgo buildéå¸¸ç›¸ä¼¼ï¼Œæ¯ä¸ªå‘½ä»¤åé¢éƒ½å¯ä»¥è·Ÿä¸€ä¸ªæˆ–è€…å¤šä¸ªGoæ–‡ä»¶ï¼Œæˆ–è€…Go packageã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„ç¨‹åºæ¥çœ‹ä¸‹è¿™è¿ä¸ªå‘½ä»¤å¦‚ä½•ä½¿ç”¨ã€‚\ngo run\nä»»æ„è·¯å¾„ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªç›®å½•helloï¼Œç„¶ååˆ›å»ºä¸€ä¸ªhello.go çš„æ–‡ä»¶\n1# ~/hello/hello.go 2package main 3import \u0026#34;fmt\u0026#34; 4func main(){ 5\tfmt.Println(\u0026#34;Hello Golang!\u0026#34;) 6} ä¿å­˜åï¼Œåœ¨terminalä¸­è¿›å…¥helloè¿™ä¸ªç›®å½•ä¸‹ï¼Œæ‰§è¡Œ\n1# usage: go run [build flags] [-exec xprog] package [arguments...] 2go run hello.go ä½ å¯ä»¥åœ¨consoleä¸­çœ‹åˆ°æ‰“å°çš„Hello Golang!ã€‚è¿è¡Œå®Œæˆåï¼Œå¦‚æœä½ æŸ¥çœ‹helloè¿™ä¸ªç›®å½•ä¸‹ï¼Œä½ ä¼šå‘ç°åªæœ‰æˆ‘ä»¬åˆ›å»ºçš„hello.goè¿™ä¸ªæ–‡ä»¶ã€‚ä½ å¯èƒ½ä¼šæƒ³ï¼Œgoæ˜¯ä¸€ä¸ªç¼–è¯‘å‹è¯­è¨€ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰äº§ç”Ÿç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶å‘¢ï¼Ÿ\nå®é™…ä¸Šï¼Œgo runç¡®å®ç¼–è¯‘äº†æˆ‘ä»¬çš„æºç æ–‡ä»¶ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæºç æ–‡ä»¶æ˜¯ä¿å­˜åœ¨ä¸€ä¸ªä¸´æ—¶ç›®å½•ä¸­çš„ï¼Œå½“è¿è¡Œç»“æŸä¹‹åï¼Œç¼–è¯‘å‡ºæ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¹Ÿå°±è¢«åˆ é™¤äº†ã€‚è¿™ç§æ–¹å¼å¾ˆé€‚åˆç”¨æ¥æµ‹è¯•ä¸€äº›æ¯”è¾ƒå°çš„ç¨‹åºï¼Œä¹Ÿè®©Goç”¨èµ·æ¥åƒæ˜¯ä¸€ç§è„šæœ¬è¯­è¨€ã€‚\ngo build\nå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éƒ½ä¼šé€‰æ‹©æŠŠç¨‹åºç¼–è¯‘æˆäºŒè¿›åˆ¶æ¥æ‰§è¡Œã€‚æˆ‘ä»¬ä½¿ç”¨go buildæ¥ç¼–è¯‘Go æºç æ–‡ä»¶ã€‚\n1# in hello directory 2go build hello.go æ‰§è¡Œå®Œè¿™æ¡å‘½ä»¤åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹çœ‹åˆ°å¤šäº†ä¸€ä¸ªhello(æˆ–hello.exe)æ–‡ä»¶ã€‚è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°\u0026quot;Hello Golang!\u0026ldquo;è¾“å‡ºåœ¨å±å¹•ä¸Šã€‚\nè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„åå­—å’Œä½ ä¼ é€’ç»™go runçš„æ–‡ä»¶åå­—æˆ–è€…packageåå­—æ˜¯ä¸€è‡´çš„ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„åå­—æˆ–è€…å­˜å‚¨åˆ°ä¸åŒçš„è·¯å¾„å¯ä»¥ä½¿ç”¨-oå‚æ•°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æŠŠå½“å‰æ–‡ä»¶ç¼–è¯‘æˆä¸ºä¸€ä¸ªåä¸º \u0026ldquo;hello_golang\u0026quot;çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚\n1# usage: go build [-o output] [build fl ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/1_SettingUpGoEnv/","summary":"å®‰è£…Go å¼€å§‹å†™Golangä¹‹å‰ï¼Œä½ é¦–å…ˆéœ€è¦ä¸‹è½½å¹¶ä¸”å®‰è£…Golangå¼€å‘å·¥å…·ã€‚å¯ä»¥åœ¨Golangçš„å®˜æ–¹ç½‘ç«™ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…ã€‚æ ¹æ®ä½ çš„å¼€å‘å¹³å°é€‰æ‹©ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ã€‚å¯¹äºMacç”¨æˆ·(æˆ–è€…Windowsç”¨æˆ·)æ¥è¯´.pkg(æˆ–msi)å®‰è£…åŒ…ä¼šè‡ªåŠ¨æŠŠGolangå®‰è£…åˆ°åˆé€‚çš„ä½ç½®ï¼Œå¹¶å°†å‘½ä»¤åŠ å…¥åˆ°ç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”è‡ªåŠ¨ç§»é™¤è€ç‰ˆæœ¬ã€‚å¦‚æœä½¿ç”¨Macæ›´åŠ æ¨èç›´æ¥ä½¿ç”¨brew install goï¼Œ ä½¿ç”¨brew å¯ä»¥æ–¹ä¾¿çš„ç®¡ç†Goå¤šä¸ªç‰ˆæœ¬ã€‚\nå¯¹äºLinuxæˆ–è€…FreeBSDç”¨æˆ·å¯ä»¥ç›´æ¥ä¸‹è½½å¯¹åº”çš„.tar.gz, å¹¶è§£å‹åˆ°æ–‡ä»¶åä¸ºgoçš„ç›®å½•ä¸­ã€‚æŠŠè¿™ä¸ªæ–‡ä»¶Copyåˆ°/usr/local/ä¸‹ã€‚ç„¶åæŠŠ/usr/local/go/binæ·»åŠ åˆ°$PATHä¸­ã€‚\n1tar -C /usr/local -xzvf go1.17.3.linux-amd64.tar.gz 2# change .profile to .bashrc or.zsh depend on you evnironment 3echo \u0026#34;export PATH=$PATH:/usr/local/go/bin\u0026#34; \u0026gt;\u0026gt;$HOME/.profile Go ç¨‹åºç¼–è¯‘å®Œæˆåæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸éœ€è¦ä¾èµ–ä»»ä½•è¿è¡Œè½¯ä»¶(ä¾‹å¦‚ï¼ŒPythonéœ€è¦Pythonè§£é‡Šå™¨ï¼ŒJavaéœ€è¦JVM)ã€‚ä»…åœ¨éœ€è¦ç¼–è¯‘Goä»£ç çš„ç¯å¢ƒä¸Šå®‰è£…Goå³å¯ã€‚\nå®‰è£…å®Œæˆåï¼Œæ‰“å¼€Terminal(Window æ‰“å¼€CMD)ï¼ŒéªŒè¯Goæ˜¯å¦å®‰è£…æˆåŠŸã€‚\n1go version åœ¨æ‰€æœ‰çš„é…ç½®éƒ½æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„ç‰ˆæœ¬ä¿¡æ¯\n1# mac intel cpu 64bit 2go version go1.17.3 darwin/amd64 ä»ä¸Šè¿°ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡ºï¼ŒGoçš„ç‰ˆæœ¬æ˜¯1.17.3,ä½¿ç”¨çš„å¼€å‘æœºå™¨æ˜¯ Mac(Darwin æ˜¯MacOSçš„Kernel Name, amd64 æ˜¯æŒ‡64-bitçš„x86 CPUæ¶æ„)ã€‚\nå¦‚æœä½ æ²¡æœ‰å¾—åˆ°æ­£ç¡®çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯ä½ æ²¡æœ‰æŠŠgoåŠ å…¥åˆ°ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…æœ‰å…¶ä»–çš„ç¨‹åºåç§°ä¹Ÿä¸ºgoã€‚å¯¹äºMacæˆ–è€…Unix-likeç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨which goæŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹çš„goçš„æ˜¯å¦æ­£ç¡®å…³è”åˆ°/usr/local/go/binã€‚å¦‚æœè·¯å¾„æ­£ç¡®ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸‹è½½é”™äº†å®‰è£…åŒ…ï¼Œæ£€æŸ¥ä¸‹å®‰è£…åŒ…çš„ä½æ•°æ˜¯å¦ä¸å½“å‰æ“ä½œç³»ç»ŸåŒ¹é…ï¼Œæœ‰å¯èƒ½åœ¨64-bitçš„ç³»ç»Ÿä¸Šä¸‹è½½äº†32-bitçš„å®‰è£…åŒ…ã€‚å¦å¤–ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯èŠ¯ç‰‡æ¶æ„é€‰é”™äº†ã€‚\nGo å·¥ä½œç©ºé—´ ä»2009å¹´Goå¼€å§‹ä½¿ç”¨ï¼Œåœ¨å¼€å‘è€…å¦‚æœç»„ç»‡ä»£ç å’Œç®¡ç†ä¾èµ–ä¸Šç»å†äº†å‡ æ¬¡å˜åŒ–ã€‚åœ¨Go 1.11æ‰€æœ‰çš„ä»£ç å¿…é¡»ä¿å­˜åœ¨GOPATHä¹‹ä¸‹ï¼Œä¹‹åçš„ç‰ˆæœ¬ç”¨æˆ·å¯ä»¥åœ¨ä»»æ„ç›®å½•ä¸‹å­˜å‚¨è‡ªå·±çš„ä»£ç ã€‚ä½†æ˜¯Goä¾ç„¶å¸Œæœ›æœ‰ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œç©ºé—´å¯ä»¥å­˜å‚¨é€šè¿‡go installå®‰è£…é¢ç¬¬ä¸‰æ–¹åŒ…ã€‚é»˜è®¤çš„å·¥ä½œç©ºé—´æ˜¯$HOME/go, ä¸‹è½½çš„ç¬¬ä¸‰æ–¹åŒ…é»˜è®¤å­˜å‚¨åœ¨$HOME/go/src,ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜å‚¨åœ¨$HOME/go/binã€‚ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé»˜è®¤çš„å·¥ä½œç©ºé—´ï¼Œæˆ–è€…é€šè¿‡è®¾ç½®$GOPAHTæŒ‡å®šä¸€ä¸ªå·¥ä½œç©ºé—´ã€‚\næ— è®ºä½ æ˜¯å¦ä½¿ç”¨é»˜è®¤çš„wokespaceï¼Œå»ºè®®ä½ æŠŠ$GOPATH/binåŠ å…¥åˆ°$PATHä¸­ã€‚ é€šè¿‡æŒ‡å®š$GOPATHå¯ä»¥æ¸…æ¥šåœ°æè¿°å½“å‰ç¯å¢ƒçš„Goå·¥ä½œç©ºé—´ï¼ŒæŠŠ$GOPATH/binåŠ å…¥åˆ°å¯æ‰§è¡Œè·¯å¾„ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨go install å®‰è£…çš„ç¬¬ä¸‰æ–¹åŒ…ã€‚\nå¦‚æœæ˜¯Unix-likeçš„å¼€å‘ç¯å¢ƒå¯ä»¥æŠŠä¸‹é¢å‡ è¡ŒåŠ å…¥åˆ°$HOME/.profileä¸­ã€‚\n1# if use ubuntu you should add to .","tags":null,"title":"Go è®¾ç½®Golangå¼€å‘ç¯å¢ƒ"},{"categories":null,"contents":" Introduce SIMD å•æŒ‡ä»¤æ•°æ®-\u0026gt; VNNI/INT8\nIntrinsics for Intel(R) Advanced Matrix Extension Instructions Intel Advanced Matrix Extension is a new 64-bit programming paradigm consisting of two components:\nA set of 2-dimensional registers(tiles) representing sub-arrays from a larger 2-dimensional memory image Am accelerator that is able to operate on tiles; the first implementation of this accelerator is called TMUL(tile matrix multiply unit) Intrinsic for Intel Advanced Matrix Extension AMX-BF16 Instructions This intrinsic supports tile computational operations on bfloat16 number.\n_tile_dpbf16ps Synopsis\n1void _tile_dpbf16ps (__tile dst, __tile a, __tile b) Description\nCompute dot-product of BF16(16-bit) floating-point pairs in tiles \u0026ldquo;a\u0026rdquo; and \u0026ldquo;b\u0026rdquo;, accumulating the intermediate single-precision(32-bit) floating-point elements with elements with elements in \u0026ldquo;dst\u0026rdquo;, and store the 32-bit result back to tile \u0026ldquo;dst\u0026rdquo;.\nOperation\nAVX Advanced Vector Extension\nAVX ä¹Ÿæ˜¯SIMDæŒ‡ä»¤ï¼Œ å•æŒ‡ä»¤å¤šæ•°æ®\nSIMD Single Instruction Multi Data\nå¯„å­˜å™¨ä½å®½ æ¼”ç¤ºå›¾\nhttps://gyazo.com/51d14424f81c80ae77ea790bfcc92d0d\nHow AVX Solve it AVX2 AVX256 8*32 8ä¸ª32ä½æµ®ç‚¹ä¹¦è¿ç®— 16FLOPs/cycle/FMAï¼ˆè¿ç®—å™¨ï¼Œcpuæ¶æ„ï¼‰ 32 FLOps/cycle/core 16 ä¸ª32ä½æµ®ç‚¹æ•°è¿ç®—ï¼Œ 2x 16 ä¸ª32ä½çš„æµ®ç‚¹è¿ç®— BF16 å°±æ˜¯ 16ä½çš„æµ®ç‚¹æ•°\nSapphire Rapids with high Bandwidth Memory å†…å­˜å¸¦å®½éœ€æ±‚è¾ƒé«˜çš„è´Ÿè½½æœ‰å“è¶Šçš„æ€§èƒ½æé«˜. æé«˜äº†Cacheçš„åˆ©ç”¨ç‡ã€‚\nAVX2 is enough\nAVX 512 æˆæƒAMD\næµ®ç‚¹æ•°å­¦è¿ç®—ï¼Œ\næ›´å¤šçš„æ˜¯é€šè¿‡GPUå®ç°2\n2008 å¹´ï¼Œè‹±ç‰¹å°”åœ¨ Sandy Bridge é…·ç¿ CPU æ¶æ„æ¨å‡ºçš„åŒæ—¶å‘å¸ƒäº† AVX æŒ‡ä»¤é›†ï¼ˆAdvanced Vector Extensionï¼Œé«˜çº§çŸ¢é‡æ‰©å±•æŒ‡ä»¤é›†ï¼‰ï¼Œèšç„¦çŸ¢é‡è¿ç®—ï¼ŒAVX å¾ˆå¿«å½¢æˆäº†ä¸€å¥—å®Œæ•´çš„å•æŒ‡ä»¤å¤šæ•°æ®æŒ‡ä»¤é›†è§„èŒƒï¼Œä¸€äº›ç‰ˆæœ¬ä¹Ÿå¾—åˆ°äº† AMD çš„æ”¯æŒã€‚\n2013 å¹´ï¼Œè‹±ç‰¹å°”å‘å¸ƒäº† AVX-512 æŒ‡ä»¤é›†ï¼Œå…¶æŒ‡ä»¤å®½åº¦æ‰©å±•ä¸º 512bitï¼Œæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å¯æ‰“åŒ… 32 æ¬¡åŒç²¾åº¦æˆ– 64 æ¬¡å•ç²¾åº¦æµ®ç‚¹è¿ç®—ï¼Œå› æ­¤åœ¨å›¾åƒ / éŸ³è§†é¢‘å¤„ç†ã€æ•°æ®åˆ†æã€ç§‘å­¦è®¡ç®—ã€æ•°æ®åŠ å¯†å’Œå‹ç¼©å’Œæ·±åº¦å­¦ä¹ ç­‰åº”ç”¨åœºæ™¯ä¸­ï¼Œä¼šå¸¦æ¥æ›´å¼ºå¤§çš„æ€§èƒ½è¡¨ç°ï¼Œç†è®ºä¸Šæµ®ç‚¹æ€§èƒ½ç¿»å€ï¼Œæ•´æ•°è®¡ç®—åˆ™å¢åŠ çº¦ 33% çš„æ€§èƒ½ã€‚\nIntel æ–°ä¸€ä»£ CPU å°†é™åˆ¶åŒ…æ‹¬ AVX-512 åœ¨å†…çš„æŒ‡ä»¤é›†åªèƒ½è¿è¡Œåœ¨å¤§æ ¸èŠ¯ç‰‡ä¸Š\nå•æŒ‡ä»¤æ•°æ®æµ\n$$X* Y$$\nå¤šæŒ‡ä»¤æ•°æ®æµ\nè‹±ç‰¹å°”AVX-512VNNI(VectorNeural NetworkInstructions)æ˜¯è‹±ç‰¹å°”æ·±åº¦å­¦ä¹ åŠ é€Ÿä¸€é¡¹é‡è¦çš„å†…å®¹ï¼Œä¹Ÿæ˜¯å¯¹æ ‡å‡†è‹±ç‰¹å°”AVX-512æŒ‡ä»¤é›†çš„æ‰©å±•ã€‚å¯ä»¥å°†ä¸‰æ¡æŒ‡ä»¤åˆå¹¶æˆä¸€æ¡æŒ‡ä»¤æ‰§è¡Œï¼Œæ›´è¿›ä¸€æ­¥çš„å‘æŒ¥æ–°ä¸€ä»£è‹±ç‰¹å°”è‡³å¼ºå¯æ‰©å±•å¤„ç†å™¨çš„è®¡ç®—æ½œèƒ½ï¼Œæå‡INT8æ¨¡å‹çš„æ¨ç†æ€§èƒ½ã€‚ç›®å‰ç¬¬2ä»£å’Œç¬¬3ä»£è‹±ç‰¹å°”è‡³å¼ºå¯æ‰©å±•å¤„ç†å™¨å‡æ”¯æŒè‹±ç‰¹å°”VNNIã€‚\nAVX å¼•å…¥äº†ä¸€ç§ç§°ä¸º VEX ç¼–ç æ–¹æ¡ˆçš„ä¸‰æ“ä½œæ•° SIMD æŒ‡ä»¤æ ¼å¼ï¼Œå…¶ä¸­ç›®æ ‡å¯„å­˜å™¨ä¸ä¸¤ä¸ªæºæ“ä½œæ•°ä¸åŒã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„åŒæ“ä½œæ•°å½¢å¼ a â† a + b çš„ SSE æŒ‡ä»¤ç°åœ¨å¯ä»¥åœ¨ a + b â†ä½¿ç”¨éç ´åæ€§ä¸‰æ“ä½œæ•°å½¢å¼ cï¼Œä»è€Œä¿ç•™ä¸¤ä¸ªæºæ“ä½œæ•°ã€‚æœ€åˆï¼ŒAVX çš„ä¸‰æ“ä½œæ•°æ ¼å¼ä»…é™äºå…·æœ‰ SIMD æ“ä½œæ•° ï¼ˆYMMï¼‰ çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”ä¸åŒ…æ‹¬å…·æœ‰é€šç”¨å¯„å­˜å™¨ï¼ˆä¾‹å¦‚ EAXï¼‰çš„æŒ‡ä»¤ã€‚å®ƒåæ¥ç”¨äºåœ¨åæ¥çš„æ‰©å±•ï¼ˆå¦‚BMIï¼‰ä¸­çš„é€šç”¨å¯„å­˜å™¨ä¸Šç¼–ç æ–°æŒ‡ä»¤ã€‚VEX ç¼–ç è¿˜ç”¨äºåœ¨ AVX-512 ä¸­å¼•å…¥çš„ k0-k7 æ©ç å¯„å­˜å™¨ä¸Šè¿è¡Œçš„æŒ‡ä»¤ã€‚\n8ç»´åŠä»¥ä¸‹çš„64ä½åŒç²¾åº¦æµ®ç‚¹çŸ¢é‡æˆ–è€…16ç»´åŠä»¥ä¸‹çš„å•ç²¾åº¦æµ®ç‚¹çŸ¢é‡ã€‚ä¹Ÿæ”¯æŒ8ç»´çš„64ä½æ•´æ•°çŸ¢é‡ï¼Œ16ç»´çš„32ä½æ•´æ•°çŸ¢é‡ ä½œè€…ï¼šç¡¬ä»¶è€å“¥å“¥ https://www.bilibili.com/read/cv9689142 å‡ºå¤„ï¼šbilibili\næµ®ç‚¹æ€§èƒ½æå‡\næé«˜æ•´æ•°å’Œæµ®ç‚¹è¿ç®—æ€§èƒ½ã€‚\nè§£å‹ç¼©ï¼Œæ’åºç®—æ³•\nè§†é¢‘ç¼–ç ï¼Œ3Då»ºæ¨¡ï¼Œæµ®ç‚¹è¿ç®—æ€§èƒ½\nAVX512 16ä¸ª32bit æˆ–è€… 8 ä¸ª64bitçš„æ•°æ®\nåŒå‘å°„AVX 512ï¼Œ\nä½†å‘å°„ AVX512ï¼Œ\nhttps://gyazo.com/88d101c5bb5ae241144f37fdddd0c02f\næ·±åº¦å­¦ä¹  å›¾ç‰‡é™å™ª\né«˜æ€§èƒ½è®¡ç®— 250 ä¸‡ä½åœ†å‘¨ç‡è®¡ç®—\næœ€å¤§å¯„å­˜å™¨ä½å®½\nAMX çš„releaseçš„timeæ˜¯2022ï¼Œ ä¼°è®¡ç°åœ¨å¸‚é¢ä¸Šè¿˜æ²¡æœ‰supportçš„CPUå¯ä»¥ç”¨æ¥æµ‹è¯•ã€‚\næ‰€æœ‰æ‰¾äº†ä¸€ä¸ªAVX512 çš„code demo. ç„¶åé€šè¿‡AVX512 ä»‹ç»ä¸€ä¸‹SIMDçš„ä½¿ç”¨\nå†è¿™ä¸ªç¤ºä¾‹ä¸­æ˜¯è®¡ç®—ä¸¤ä¸ªå‘é‡ï¼Œå¹¶æŠŠç»“æœå†™é“ç¬¬ä¸‰ä¸ªå‘é‡ä¸­ã€‚\nè¿™é‡Œå®šä¹‰äº†ABC3ä¸ªå‘é‡ï¼Œæ¯ä¸ªå‘é‡éƒ½æ˜¯8ä¸ª64ä½æµ®ç‚¹æ•°ã€‚åˆšå¥½æ˜¯512 bit. æ¯ä¸ªå‘é‡åˆšå¥½å­˜å…¥ä¸€ä¸ªAVX512å¯„å­˜å™¨ã€‚\nå³è¾¹çš„è¿™ä¸ªæ±‡ç¼–å°±æ˜¯ AVX512 è®¡ç®—ä¸¤ä¸ªå‘é‡å’Œçš„å®ç°ã€‚ ç¬¬ä¸€è¡Œå°±æ˜¯æŠŠå‘é‡Aä»å†…å­˜ä¸­åŠ è½½åˆ°å¯„å­˜å™¨0ï¼Œç¬¬äºŒè¡Œï¼Œå°±æ˜¯è®¡ç®—zmm0å’Œå†…å­˜ä¸­å‘é‡Bçš„å’Œï¼Œå¹¶å­˜å…¥zmm0ä¸­ã€‚ç¬¬ä¸‰è¡Œå°±æ˜¯æŠŠzmm0å¯„å­˜å™¨çš„å€¼å†™å…¥åˆ°å‘é‡Cã€‚ è¿™æ ·å°±å¾—åˆ°äº†è®¡ç®—ç»“æœã€‚å¦‚æœä½¿ç”¨SISDå‘½ä»¤ï¼Œå°±éœ€è¦å¯¹æ¯ä¸€ä¸ªæ•°æ®å•ç‹¬ç›¸åŠ ã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹é€šè¿‡è°ƒè¯•å™¨æ¥çœ‹ä¸‹ AVX512 å¯„å­˜å™¨ä¸­zmm0ä¸­çš„æ•°æ®æƒ…å†µï¼Œå‘é‡A åŠ è½½åˆ°zmm0çš„æ—¶å€™ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°AVX512 æ”¯æŒ çš„æ•°æ®ç±»å‹è¦è¿œè¿œå¤šäºAMXã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸ªAMXçš„æŒ‡ä»¤ã€‚_tile_spbf16()\nè¿™æ¡æŒ‡ä»¤å°±æ˜¯è®¡ç®—ä¸¤ä¸ªBF16çš„ç‚¹æˆ\nAVX å’ŒAMXç°åœ¨å¤§éƒ¨åˆ†åº”ç”¨åœºæ™¯éƒ½æ˜¯ç”¨åœ¨æœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹  é¢†åŸŸï¼Œå¤„ç†ä¸€äº›å¤§è§„æ¨¡çš„çŸ©é˜µè®¡ç®—ã€‚è¿™éƒ¨åˆ†å·²ç»æœ‰å¾ˆå¤šäººåšäº†å¾ˆå¤šå·¥ä½œï¼Œæ‰€ä»¥ å¦‚æœåœ¨è¿™æ–¹é¢å»åšä¸€äº›åŸºäºAMXçš„æˆ–AVXçš„ä¸“åˆ©å’Œæ”¹è¿›ä¼šæ¯”è¾ƒå›°éš¾ã€‚äºæ˜¯æˆ‘ä»¬é€‰æ‹©äº†æ•°æ®å¤„ç†è¿™ä¸ªæ–¹å‘ã€‚\nåœ¨æ•°æ®å¤„ç†è¿™ä¸ªæ–¹å‘ã€‚æˆ‘æƒ³ç®€å•ä»‹ç»ä¸€ä¸‹æ—¶åºæ•°æ®ã€‚é€šè¿‡è¿™å¼ å›¾ï¼Œå¤§å®¶å¯èƒ½ä¼šå¯¹æ—¶åºæ•°æ®æœ‰ä¸ªåˆæ­¥çš„æ¦‚å¿µã€‚\næ—¶åºæ•°æ®çš„ååé‡æ˜¯éå¸¸å¤§çš„ï¼Œå°¤å…¶æ˜¯IoTè®¾å¤‡ï¼Œè®¾å¤‡çš„è§„æ¨¡å¯èƒ½è¾¾åˆ°åƒä¸‡ä¸Šäº¿ï¼Œæ•°æ®è‡ªåŠ¨ç”Ÿæˆï¼Œå‡è®¾1sé‡‡æ ·ä¸€æ¬¡ï¼Œæ¯ç§’åƒä¸‡ã€äº¿çº§åˆ«çš„æ•°æ®å†™å…¥ã€‚\nåœ¨å¤§å†™å…¥ååé‡çš„æƒ…å†µä¸‹ï¼Œæ•°æ®çš„å®æ—¶æ€§è¦æ±‚ä¹Ÿå¾ˆé«˜ã€‚ä¾‹å¦‚ï¼Œå°†æ—¶åºæ•°æ®çš„ç»Ÿè®¡é‡å…³è”åšç›‘æ§ã€æŠ¥è­¦ï¼Œèƒ½å®¹å¿çš„å»¶è¿Ÿå¯èƒ½åœ¨ç§’çº§\néœ€è¦åšé™é¢‘é‡‡æ ·ã€æ’å€¼ã€å®æ—¶è®¡ç®—ã€èšåˆç­‰æ“ä½œï¼Œå…³å¿ƒçš„æ˜¯ä¸€æ®µæ—¶é—´çš„è¶‹åŠ¿ï¼Œè€Œä¸æ˜¯æŸä¸€ç‰¹å®šæ—¶é—´çš„å€¼ç­‰ã€‚\nç›®å‰æˆ‘ä»¬è¿˜æ²¡æœ‰å…·ä½“æ˜ç¡®è¦å¯¹å“ªä¸€ç§å…·ä½“çš„ç®—æ³•æˆ–è€…åº”ç”¨åœºæ™¯è¿›è¡ŒåŸºäºAMXçš„æ”¹è¿›ã€‚åªæ˜¯çœ‹åˆ°äº†è¿™ä¸ªäº‹æƒ…çš„å¯èƒ½æ€§ã€‚ä¾‹å¦‚è¯´æˆ‘è¦è®¡ç®—ä¸€ä¸ªæŒ‡æ ‡åœ¨ä¸€æ®µæ—¶é—´å†…çš„å‡å€¼ã€‚è¿™ä¸ªç®—æ³•åœ¨å°†é‡‡æ ·çš„è¿‡ç¨‹ä¸­éå¸¸å¸¸è§ã€‚è¿™ä¸€æ®µæ—¶é—´å†…çš„æ—¶åºæ˜¯æŒ‡æ ‡ã€‚\nå…³äºè¿™ä¸ªåº”ç”¨åœºæ™¯çš„ï¼Œå¤§å®¶gan\nå‚è€ƒæ–‡çŒ®\nhttps://baijiahao.baidu.com/s?id=1672265837981500533\u0026wfr=spider\u0026for=pc\nhttps://baijiahao.baidu.com/s?id=1729339781120838964\u0026wfr=spider\u0026for=pc\nhttps://www.prowesscorp.com/what-is-intel-avx-512-and-why-does-it-matter/\nhttps://www.elecfans.com/d/1812270.html\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/intel_spx_AMX/","summary":"Introduce SIMD å•æŒ‡ä»¤æ•°æ®-\u0026gt; VNNI/INT8\nIntrinsics for Intel(R) Advanced Matrix Extension Instructions Intel Advanced Matrix Extension is a new 64-bit programming paradigm consisting of two components:\nA set of 2-dimensional registers(tiles) representing sub-arrays from a larger 2-dimensional memory image Am accelerator that is able to operate on tiles; the first implementation of this accelerator is called TMUL(tile matrix multiply unit) Intrinsic for Intel Advanced Matrix Extension AMX-BF16 Instructions This intrinsic supports tile computational operations on bfloat16 number.","tags":null,"title":"Intel AMXAV"},{"categories":null,"contents":"æ¦‚è¿° https://www.intel.com/content/www/us/en/developer/tools/software-guard-extensions/overview.html\nhttps://blog.quarkslab.com/overview-of-intel-sgx-part-1-sgx-internals.html\nIntel Software Guard Extensions(Intel SGX) ä¿æŠ¤é€‰å®šçš„ä»£ç å’Œæ•°æ®ä¸è¢«æ³„éœ²çš„å’Œä¿®æ”¹ã€‚å¼€å‘è€…å¯ä»¥æŠŠåº”ç”¨ç¨‹åºåˆ’åˆ†åˆ°CPUå¼ºåŒ–çš„enclaveä¸­æˆ–è€…å†…å­˜ä¸­å¯æ‰§è¡Œçš„ä¿æŠ¤åŒºåŸŸï¼Œå³ä½¿åœ¨å—æ”»å‡»çš„å¹³å°ä¸­ä¹Ÿå¯ä»¥æé«˜å®‰å…¨æ€§ã€‚ä½¿ç”¨è¿™ç§æ–°çš„åº”ç”¨å±‚å¯ä¿¡æ‰§è¡Œç¯å¢ƒï¼Œå¼€å‘è€…èƒ½å¤Ÿå¯ç”¨èº«ä»½å’Œè®°å½•éšç§ï¼Œå®‰å…¨æµè§ˆå’Œæ•°æ®ä¿æŠ¤(DRM)æˆ–è€…ä»»ä½•éœ€è¦å®‰å…¨å­˜å‚¨æœºå¯†æˆ–è€…ä¿æŠ¤æ•°æ®çš„é«˜ä¿éšœå®‰å…¨åº”ç”¨åœºæ™¯ä¸­ã€‚\næœºå¯†æ€§å’Œå®Œæ•´æ€§ï¼Œ å³ä½¿åœ¨OSã€BIOSã€VMMæˆ–è€…SMMå±‚å­˜åœ¨ç‰¹æƒæ¶æ„è½¯ä»¶çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä¿è¯å®‰å…¨ã€‚ ä½å­¦ä¹ æ›²çº¿ï¼Œå’Œçˆ¶åº”ç”¨ç¨‹åºç±»ä¼¼çš„OSç¼–ç¨‹æ¨¡å‹ï¼Œå¹¶ä¸”åœ¨ä¸»CPUä¸Šæ‰§è¡Œ è¿œç¨‹è®¤è¯ è¿œç¨‹éƒ¨åˆ†èƒ½å¤Ÿè®¤è¯ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„enclaveçš„èº«ä»½ï¼Œå¹¶ä¸”å®‰å…¨çš„å°†å¯†é’¥ã€å‡­æ®å’Œæ•æ„Ÿæ•°æ®æä¾›ä¸ºenclave æœ€å°çš„å¯èƒ½æ”»å‡»é¢ï¼Œ CPUè¾¹ç•Œæˆä¸ºæ”»å‡»é¢å¤–å›´ï¼Œæ‰€æœ‰çš„æ•°æ®ã€å†…å­˜ã€å¤–å›´ä¹‹å¤–çš„IOéƒ½æ˜¯åŠ å¯†çš„ã€‚ æœ€å°æ”»å‡»é¢çš„ç¡¬ä»¶è¾…åŠ©å¯ä¿¡æ‰§è¡Œç¯å¢ƒã€‚\nintel SGXä¿æŠ¤çš„åº”ç”¨ç¨‹åº Intel SGXåº”ç”¨ç¨‹åºç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š ä¸å¯ä¿¡ä»£ç å’Œå¯ä¿¡Enclave. å¼€å‘è€…å¯ä»¥åˆ›å»ºä¸€å¯¹å¤šçš„å¯ä¿¡enclaveç”¨æ¥æ”¯æŒåˆ†å¸ƒå¼ä½“ç³»ç»“æ„ã€‚\nå¸¸ç”¨åº”ç”¨æœ‰å¯†é’¥ï¼Œä¸“æœ‰ç®—æ³•ï¼Œç”Ÿç‰©è¯†åˆ«æ•°æ®å’ŒCSRç”Ÿæˆç­‰ã€‚\nç¨‹åºè¿è¡Œæ—¶ï¼Œ Intel SGXæŒ‡ä»¤åœ¨ä¸€ä¸ªç‰¹å®šçš„ä¿æŠ¤å†…å­˜åŒºåŸŸä¸­åˆ›å»ºå’Œæ‰§è¡Œenclaveï¼Œè¯¥åŒºåŸŸæœ‰ç”±å¼€å‘è€…å®šä¹‰çš„å—é™å…¥å£å’Œå‡ºå£å‡½æ•°ã€‚èƒ½å¤Ÿé˜²æ­¢æ•°æ®æ³„éœ²ã€‚åœ¨CPUèŒƒå›´ä¸­çš„enclaveå’Œæ•°æ®è¿è¡Œåœ¨ä¸€ä¸ªcleançš„ç¯å¢ƒä¸­ï¼Œ enclaveæ•°æ®å†™å…¥åˆ°ç£ç›˜ä¼šè¢«åŠ å¯†ï¼Œå¹¶ä¸”æ ¡éªŒå…¶å®Œæ•´æ€§ã€‚\nä¸Šå›¾ä¸­çš„æµç¨‹\nApplicationç”±å¯ä¿¡å’Œä¸å¯ä¿¡éƒ¨åˆ†æ„æˆ Appè¿è¡Œå’Œåˆ›å»ºevclaveï¼Œ enclaveæ”¾å…¥åˆ°å¯ä¿¡å†…å­˜ä¸­ å¯ä¿¡å‡½æ•°è¢«è°ƒç”¨ï¼Œæ‰§è¡Œä¼šè½¬æ¢åˆ°enclaveä¸­ enclaveå¯ä»¥è®¿é—®æ‰€æœ‰è¿›ç¨‹æ•°æ®ï¼Œå¤–éƒ¨è¦è®¿é—®enclaveæ•°æ®è¢«ç¦æ­¢ å¯ä¿¡å‡½æ•°è¿”å›enclaveæ•°æ® å¯¹enclaveæœ‰æœªæˆæƒçš„è®¿é—®å’Œå†…å­˜ä¾¦å¬æ˜¯æœ‰å¯èƒ½çš„\nè®¤è¯Enclaveå’ŒåŠ å¯†æ•°æ® å½“å‰ï¼ŒODM(åŸå§‹è®¾å¤‡åˆ¶é€ ä¸Š)å’ŒISV(ç‹¬ç«‹è½¯ä»¶æä¾›å•†) é€šå¸¸åœ¨åˆ¶é€ æ—¶æˆ–é€šè¿‡æ— æ³•ä»¥æœºå¯†æ–¹å¼è¯æ˜XXXã€‚\nIntel SGXä½¿ç”¨enclaveä¹‹é—´æœ¬åœ°è®¤è¯æˆ–è€…ç¬¬ä¸‰æ–¹è¿œç¨‹è®¤è¯çš„æ–¹å¼æ¥ä¿è¯åº”ç”¨ç¨‹åºæ²¡æœ‰å—åˆ°ç ´åã€‚\nåº”ç”¨ç¨‹åºå—ä¿æŠ¤çš„éƒ¨åˆ†ä¼šåŠ è½½åˆ°ä¸€ä¸ªEnclaveï¼Œå®ƒçš„ä»£ç å’Œæ•°æ®éƒ½ä¼šæ”¶åˆ°ç›‘æµ‹ã€‚ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚åˆ°è¿œç«¯æœåŠ¡å™¨ï¼Œç”¨æ¥éªŒè¯è¿™ä¸ªEnclaveæ˜¯å¦æ˜¯å¯é çš„Intel å¤„ç†å™¨ç”Ÿæˆçš„ã€‚ å¦‚æœè®¤è¯äº†Enclaveçš„èº«ä»½ï¼Œè¿œç«¯å°±ä¼šä¿¡ä»»Enclaveå¹¶å®‰å…¨çš„æä¾›å¯†é’¥ï¼Œå‡­è¯å’Œæ•°æ®.\nIntel SGX åŒ…æ‹¬ä¸€ä¸ªç”ŸæˆCPUå’ŒEnclaveç‰¹å®šâ€œå¯†å°å¯†é’¥â€çš„æŒ‡ä»¤ã€‚å¯†é’¥èƒ½å¤Ÿç”¨æ¥å®‰å…¨çš„å­˜å‚¨å’Œå–å›å¯é¥ä½ éœ€è¦ä¿å­˜åœ¨ç£ç›˜ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚\nIntel SGX å®ç°æ–°çš„å®‰å…¨æ¨¡å‹ Intel SGX æ˜¯åœ¨å¾ˆå¤šå…¬å¸ã€å¤§å­¦çš„å®‰å…¨ç ”ç©¶äººå‘˜ä»¥åŠæ”¿åºœå®‰å…¨æœºæ„çš„æ”¯æŒä¸‹åˆ›å»ºçš„ï¼Œä¸Šç™¾å®¶ISVä¸Intelåˆä½œï¼Œä½¿ç”¨Intel SGXæ¥ä¿æŠ¤å…³é”®ä»»åŠ¡åº”ç”¨ç¨‹åºã€‚\nSet up SGX develop environment Install SGX driver\nInstall SGX SDK\nInstall SGX PSW\nç›´æ¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ä¾æ¬¡å®‰è£…ä¸Šè¿°3ä¸ªç»„ä»¶\nSample Enclave Demo 1############# SGX SDK Setting 2# ç¼–è¯‘å¹³å°å’Œæ¨¡å¼é…ç½® 3 4############## APP Setting 5# ä¸»è¦æ˜¯æŒ‡å®š 6# App_Cpp_Files éœ€è¦ç¼–è¯‘çš„cppæ–‡ä»¶ 7# App_Include_Paths åŒ…å«ç›®å½• 8# App_Cpp_Objects è¾“å‡º 9 10############### Enclave setting 11# Enclave_Cpp_Files 12# Enclave_Include_Paths 13# Enclave_Cpp_Objects 14 15# eld ç¼–è¯‘é…ç½® 16################ App Object 17################ Enclave Object Enclave ç›¸å…³å¼€å‘æµç¨‹ ä½¿ç”¨edlæ–‡ä»¶å®šä¹‰ä¸å¯ä¿¡appå’Œenclaveä¹‹é—´çš„æ¥å£ å®ç°appå’Œenclaveå‡½æ•° ç¼–è¯‘ app å’Œenclaveã€‚ç¼–è¯‘ä¸­ Edger8rç”Ÿæˆå¯ä¿¡å’Œä¸å¯ä¿¡çš„ä»£ç†/æ¡¥å‡½æ•°ï¼ŒEnclaveç­¾åå·¥å…·ç”Ÿæˆenclaveçš„metadataå’Œç­¾å åœ¨æ¨¡æ‹Ÿå’Œç¡¬ä»¶æ¨¡å¼ä¸‹è¿è¡Œå’Œè°ƒè¯•appï¼Œè¯¦ç»†çœ‹debug enclaveçš„å†…å®¹ å‡†å¤‡å‘å¸ƒapp å’Œenclave ç¼–å†™Enclaveå‡½æ•° åœ¨appè§’åº¦ï¼Œä½¿ç”¨ä¸å¯ä¿¡ä»£ç†å‡½æ•°è°ƒç”¨enclaveå‡½æ•°(ECALL)è·Ÿè°ƒç”¨å…¶ä»–å‡½æ•°æ²¡æœ‰åŒºåˆ«ã€‚Enclaveå‡½æ•°åªæ˜¯æœ‰äº›æ˜¾ç¤ºçš„c/c++å‡½æ•°ã€‚\nå¼€å‘è€…åªèƒ½ä½¿ç”¨cå’Œc++(Native)å¼€å‘enclaveå‡½æ•°ï¼Œå…¶ä»–ä¸æ”¯æŒã€‚\nEnclaveå‡½æ•°ä¾èµ–ç‰¹å®šç‰ˆæœ¬çš„c/c++è¿è¡Œæ—¶åº“,STL,åŒæ­¥å’Œå‡ ä¸ªå…¶ä»–å¯ä¿¡åº“ã€‚è¿™äº›ä¾èµ–åº“æ—¶Intel SGX SDKçš„ä¸€éƒ¨åˆ†ã€‚\nå¼€å‘è€…ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–å¯ä¿¡çš„åº“ï¼Œä½†å¿…é¡»ä¿è¯è¿™äº›åº“éµå¾ªå†…ç½®Enclaveå‡½æ•°çš„è§„åˆ™ï¼š\nEnclaveå‡½æ•°ä¸èƒ½ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„32ä½æˆ–64ä½æŒ‡ä»¤ã€‚æŸ¥çœ‹Intel Software Guard Extensions Programming Reference æ–‡æ¡£ä¸­Enclaveåˆæ³•æŒ‡ä»¤åˆ—è¡¨ã€‚ Enclaveå‡½æ•°åªè¿è¡Œåœ¨ç”¨æˆ·æ€ã€‚ä½¿ç”¨éœ€è¦cpuç‰¹æƒçš„æŒ‡ä»¤ä¼šé€ æˆenclaveå‡ºé”™ã€‚ å¦‚æœè¢«è°ƒç”¨å‡½æ•°é™æ€é“¾å…¥äº†Enclaveï¼Œé‚£ä¹ˆæ˜¯å¯ä»¥åœ¨Enclaveä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°(å‡½æ•°éœ€è¦åœ¨enclave imageä¸­)ã€‚linuxçš„å…±äº«å¯¹è±¡(shared object)ä¸æ”¯æŒã€‚ åœ¨ç¼–è¯‘æ—¶ï¼Œå¦‚æœEnclave Imageè¿˜æœ‰æ‰¾ä¸åˆ°çš„ä¾èµ–ï¼Œé‚£ä¹ˆEnclaveç­¾åä¼šå¤±è´¥ã€‚\nåœ¨Enclaveä¸­è°ƒç”¨å¤–é¢çš„å‡½æ•°å«åšOCALLs.\nIntel SGX è§„åˆ™å’Œé™åˆ¶\nFeature Supported Description è¯­è¨€ éƒ¨åˆ† Native C/C++ã€‚ Enclave æ¥å£å‡½æ•°åªèƒ½ä½¿ç”¨c C/C++è°ƒç”¨å…¶ä»–å…±äº«å¯¹è±¡ ä¸æ”¯æŒ å¯ä»¥ç”¨OCALLæ¥è°ƒç”¨å¤–éƒ¨å‡½æ•° C/C++è°ƒç”¨ç³»ç»Ÿæä¾›çš„C/C++/STLæ ‡å‡†åº“ ä¸æ”¯æŒ Intel SGX SDKä¸­æä¾›äº†æ›¿ä»£çš„å¯ä¿¡ç‰ˆæœ¬ ç³»ç»ŸAPIè°ƒç”¨ ä¸æ”¯æŒ ä½¿ç”¨OCALL C++æ¡†æ¶ ä¸æ”¯æŒ åŒ…æ‹¬MFCï¼ŒQTï¼ŒBoost* è°ƒç”¨C++ç±»å‡½æ•° æ”¯æŒ åŒ…æ‹¬C++ç±»ï¼Œé™æ€å’Œinlineå‡½æ•° å†…ç½®å‡½æ•° éƒ¨åˆ† å¦‚æœè¿™äº›å†…ç½®å‡½æ•°ä½¿ç”¨çš„æ˜¯æ”¯æŒçš„æŒ‡ä»¤ã€‚Intel SGX SDKæä¾›çš„å‡½æ•°è¿è¡Œã€‚ å†…è”æ±‡ç¼– éƒ¨åˆ† å’Œå†…ç½®å‡½æ•°ä¸€æ · æ¨¡æ¿å‡½æ•° éƒ¨åˆ† åªæ”¯æŒEnclaveçš„å†…ç½®å‡½æ•° Ellipse() éƒ¨åˆ† åªæ”¯æŒEnclaveçš„å†…ç½®å‡½æ•° Varargs(va_list) éƒ¨åˆ† åªæ”¯æŒEnclaveçš„å†…ç½®å‡½æ•° åŒæ­¥ éƒ¨åˆ† Intel SGX SDKæä¾›äº†åŒæ­¥çš„å‡½æ•°/å¯¹è±¡é›†åˆï¼Œspin-lockï¼Œmutexå’Œcondition variable çº¿ç¨‹æ”¯æŒ éƒ¨åˆ† ä¸æ”¯æŒåœ¨Enclaveå†…åˆ›å»ºçº¿ç¨‹ã€‚Enclaveå†…è¿è¡Œçš„çº¿ç¨‹æ˜¯ä¸å¯ä¿¡çš„appåˆ›å»ºçš„ã€‚spin-lockã€mutexå’Œæ¡ä»¶å˜é‡APIå¯ä»¥åœ¨Enclaveå†…ç”¨äºçº¿ç¨‹åŒæ­¥ã€‚ TLS éƒ¨åˆ† Only implicitly via__thread åŠ¨æ€å†…å­˜åˆ†é… æ”¯æŒ Enclaveå†…å­˜æ˜¯æœ‰é™çš„èµ„æºï¼Œåœ¨Enclaveåˆ›å»ºæ—¶ï¼Œåˆ¶å®šäº†æœ€å¤§Heapçš„å¤§å° C++å¼‚å¸¸ æ”¯æŒ è™½ç„¶æœ‰äº›å½±å“æ€§èƒ½ SEHå¼‚å¸¸ ä¸æ”¯æŒ Intel SGX SDK æä¾›äº†APIç”¨äºæ³¨å†Œå‡½æ•°æˆ–è€…å¼‚å¸¸å¥æŸ„æ¥å¤„ç†éƒ¨åˆ†ç¡¬ä»¶å¼‚å¸¸(è¯¦ç»†å¯è§ Customer Exception Handling) ä¿¡å· ä¸æ”¯æŒ Enclaveå†…ä¸æ”¯æŒsignal è°ƒç”¨Enclaveå†…å‡½æ•° EnclaveåŠ è½½æˆåŠŸä¹‹åï¼Œå¯ä»¥è·å¾—ä¸€ä¸ªEnclaveçš„ID,åœ¨ä½¿ç”¨ECALLæ—¶ä½œä¸ºå‚æ•°ä½¿ç”¨ã€‚æœ‰æ—¶å€™ï¼Œå¯ä»¥åœ¨ECALLå†…éƒ¨ä½¿ç”¨OCALLã€‚æ¯”å¦‚éœ€è¦åœ¨Enclaveä¸­è®¡ç®—æŸäº›ç§˜å¯†ä¿¡æ¯ï¼Œedlæ–‡ä»¶å¦‚ä¸‹\n1//demo.edl 2enclave{ 3\t// Add your definition of \u0026#34;secret_t\u0026#34; here 4\ttrusted{ 5\tpublic void get_secret([out] secret_t* secret); 6\t}; 7\tuntrusted{ 8\t// This OCALL if for illustration purposed only, 9\t// It should not be used in a real enclave, 10\t// unless it is during the development phare for debuging purposes. 11\tvoid dump_secret((in) const secret_t* secret); 12\t}; 13} sgx_edger8r ä½¿ç”¨ä¸Šé¢çš„edlä¼šç”Ÿæˆä¸å¯ä¿¡çš„ä»£ç†å‡½æ•°ï¼Œç”¨äºECALLå’ŒOCALLçš„å¯ä¿¡ä»£ç†å‡½æ•°\n1// untursted agent function (for app) 2sgx_status_t get_secret(sgx_enclave_id_t eid, secret_t* secret); 3// trusted agent function () 4sgx_status_t dump_secret(const secret_t* secret); ä½¿ç”¨ä¸å¯ä¿¡çš„ä»£ç†å‡½æ•°è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒå…¥Enclaveï¼Œå°†å‚æ•°ä¼ ç»™çœŸæ­£å¯ä¿¡çš„get_secret()ã€‚ åœ¨APPä¸­ä½¿ç”¨ä¸€ä¸ªECALL\n1// An enclave call(ECALL) will happen here 2secret_t secret; 3sgx_status_t status = get_secret(eid, \u0026amp;secret); Enclave ä¸­çš„å¯ä¿¡å‡½æ•°å¯ä»¥ä½¿ç”¨OCALLè°ƒç”¨å¯ä¿¡ä»£ç†å‡½æ•°dump_secret æ¥dumpç§˜å¯†ä¿¡æ¯ã€‚å®ƒä¼šè‡ªåŠ¨jiang-å‚æ•°ä¼ ç»™Enclaveå¤–çœŸæ­£çš„dump_secret å‡½æ•°ã€‚Enclaveå¤–çš„è¿™ä¸ªå‡½æ•°éœ€è¦å¼€å‘è€…å®ç°é“¾å…¥APPä¸­ã€‚\nå¯ä¿¡å’Œä¸å¯ä¿¡å‡½æ•°éƒ½ä¼šè¿”å›ä¸€ä¸ª sgx_status_t ç±»å‹çš„è¿”å›å€¼ã€‚å¦‚æœä»£ç†å‡½æ•°æˆåŠŸäº†ï¼Œä¼šè¿”å›SGX_SUCCESSï¼Œå¦åˆ™ä¼šè¿”å›æŒ‡å®šçš„é”™è¯¯å€¼ã€‚\nè°ƒç”¨Enclaveå¤–å‡½æ•° æœ‰äº›æ—¶å€™ï¼ŒEnclaveå†…ä»£ç éœ€è¦è°ƒç”¨å¤–éƒ¨ä¸å¯ä¿¡å†…å­˜ä¸­çš„å‡½æ•°æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ï¼Œæ¯”å¦‚ç³»ç»Ÿè°ƒç”¨ï¼ŒI/O æ“ä½œç­‰ç­‰ã€‚è¿™ç§è°ƒç”¨å°±å«åšOCALLã€‚\nè¿™äº›å‡½æ•°éœ€è¦åœ¨EDLæ–‡ä»¶çš„untrusted ä¸­å£°æ˜ã€‚\nEnclaveçš„åŠ è½½éå¸¸ç±»ä¼¼ä¸ç³»ç»ŸåŠ è½½dllã€‚appçš„å‡½æ•°åœ°å€ç©ºé—´å…±äº«ç»™äº†Enclaveï¼Œæ‰€æœ‰Enclaveå¯ä»¥ç›´æ¥è°ƒç”¨åˆ›å»ºè¯¥Enclaveçš„appçš„å‡½æ•°. ??\nä¸ä½¿ç”¨OCALLï¼Œç›´æ¥è°ƒç”¨appçš„å‡½æ•°ä¼šåœ¨è¿è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ã€‚\nåŒ…è£…å‡½æ•°(ä»£ç†å‡½æ•°)ä¼šä»ä¿æŠ¤å†…å­˜(Enclave)ä¸­æ‹·è´å‚æ•°åˆ°æœªä¿æŠ¤å†…å­˜ä¸­ï¼Œå› ä¸ºå¤–éƒ¨å‡½æ•°ä¸èƒ½ç›´æ¥è®¿é—®ä¿æŠ¤å†…å­˜åŒºåŸŸã€‚å®é™…ä¸Šå°±æ˜¯ OCALLåˆ é™¤è¢«copyåˆ°ä¸å¯ä¿¡çš„å †æ ˆä¸­ï¼Œæ ¹æ®OCALLçš„å‚æ•°ä¸ªæ•°ï¼Œæœ‰å¯èƒ½ä¼šå¼•èµ·æ ˆæº¢å‡ºã€‚\nOCALLå‡½æ•°å¿…é¡»éµå¾ªä¸€ä¸‹é™åˆ¶\nOCALLå‡½æ•°å¿…é¡»æ˜¯Cå‡½æ•°ï¼Œæˆ–è€…Cé“¾æ¥çš„C++å‡½æ•°ã€‚ å¼•ç”¨Enclaveå†…æ•°æ®çš„æŒ‡é’ˆå¿…é¡»åœ¨EDLæ–‡ä»¶ä¸­æ³¨é‡Šä¸ºpointer directionå±æ€§ï¼ŒåŒ…è£…å‡½æ•°ä¼šå¯¹è¿™äº›æŒ‡é’ˆåšæµ…æ‹·è´(ä¸€å±‚)ã€‚ Enclaveå†…ä¸ä¼šæ•æ‰å¼‚å¸¸ï¼Œéœ€è¦å¼€å‘è€…åœ¨ä¸å¯ä¿¡åŒ…è£…å‡½æ•°ä¸­å¤„ç†è¿™äº›å¼‚å¸¸ã€‚ OCALLå‡½æ•°åŸå‹ä¸­ä¸èƒ½æœ‰ellipse(\u0026hellip;)æˆ–va_list ä¸¾ä¸ªæ —å­ï¼š\n1// Step 1 - Add a declaration for foo in the EDL file 2// foo.edl 3enclave{ 4 untrusted{ 5 [cdecl] void foo(int param); 6 } 7} 8// Step 2 (optional but highly recommended ) - write a trusted, user-friendly wrapper. This function is part of the enclave\u0026#39;s trusted code. 9// The wrapper function ocall_foo function will look like: 10// Enclave\u0026#39;s trusted code 11#include \u0026#34;foo_t.h\u0026#34; 12void ocall_foo(int parm){ 13 // it is necessary to check the return value of foo() 14 if (foo(param) != SGX_SUCCESS){ 15 abort(); 16 } 17} 18 19// Setp 3 - write an untrusted foo function 20// untrusted code 21void foo(int param){ 22 // the implementation of foo 23} sgx_edger8r å°†ä¼šç”Ÿæˆè°ƒç”¨ä¸å¯ä¿¡å‡½æ•°fooçš„ä¸å¯ä¿¡æ¡¥å‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯appçš„éƒ¨åˆ†ï¼Œä¸æ˜¯åœ¨Enclaveä¸­ã€‚\nåœ¨Enclave ä¸­é“¾æ¥åº“ åŠ¨æ€é“¾æ¥åº“ Enclaveä¸å¯ä»¥ä¾èµ–ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ã€‚EnclaveåŠ è½½å™¨ç‰¹æ„è®¾è®¡æˆç¦æ­¢Enclaveä¸­ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“ã€‚Enclaveçš„ä¿æŠ¤ä¾èµ–äºåŠ è½½æ—¶ï¼Œè®¡ç®—æœºçš„Enclaveä¸­æ‰€æœ‰ä»£ç å’Œæ•°æ®çš„å‡†ç¡®æµ‹é‡å€¼ï¼Œå› æ­¤ï¼ŒåŠ¨æ€é“¾æ¥åº“é“¾å…¥ä¼šå¢åŠ å¤æ‚åº¦ã€‚\nEnclave æ–‡ä»¶å¦‚æœæœ‰ä»»ä½•æœªè¯†åˆ«çš„ä¾èµ–ï¼ŒEnclaveçš„ç­¾åè¿‡ç¨‹éƒ½ä¼šå¤±è´¥ã€‚æ‰€ä»¥Enclaveå¿…é¡»æœ‰ä¸€ä¸ªç©ºçš„IATã€‚\né™æ€åº“ åªæœ‰é™æ€åº“ï¼Œæ²¡æœ‰ä»»ä½•ä¾èµ–ä½ å°±å¯ä»¥é“¾æ¥å®ƒã€‚\nIntel SGX SDKæä¾›ä¸‹é¢è¿™äº›å¯ä¿¡çš„åº“\nName Description State sgx_trts.lib Intel SGX å†…éƒ¨ç»„ä»¶ åœ¨HWæ¨¡å¼ä¸‹è¿è¡Œå¿…é¡»é“¾æ¥ sgx_trts_sim.lib Intel SGX å†…éƒ¨ç»„ä»¶(ä»¿çœŸæ¨¡å¼) ä»¿çœŸæ¨¡å¼ä¸‹å¿…é¡»é“¾æ¥ sgx_tstdc.lib æ ‡å‡†cåº“(math string ç­‰) å¿…é¡»é“¾æ¥ sgx_tcxx.lib, sgx_tstdcxx.lib æ ‡å‡†C++åº“,STL å¯é€‰ sgx_tsrevice.lib æ•°æ®å°è£…/è§£å°(åŠ å¯†), å¯ä¿¡æ¶æ„Enclaveæ”¯æŒï¼ŒElliptic Curve Diffie-Hellman(EC HD)åº“ç­‰ HWæ¨¡å¼ä¸‹å¿…é¡»é“¾æ¥ sgx_tsrevice_sim.lib sgx_tsrevice.lib å¯¹åº”çš„ä»¿çœŸæ¨¡å¼åº“ ä»¿çœŸæ¨¡å¼ä¸‹å¿…é¡»é“¾æ¥ sgx_tcrypto.lib åŠ å¯†ç®—æ³•åº“ å¿…é¡»é“¾æ¥ sgx_tkey_exchange.lib å¯ä¿¡å¯†é’¥äº¤æ¢åº“ å¯é€‰ sgx_tprotected_fd.lib Intel ä¿æŠ¤æ–‡ä»¶ç³»ç»Ÿåº“ å¯é€‰ ä»¿çœŸåº“ Intel SGX SDKæä¾›ä»¿çœŸåº“è®©è½¯ä»¶è¿è¡Œåœ¨ä»¿çœŸæ¨¡å¼ä¸‹(ä¸è®¸è¦Intel SGXç¡¬ä»¶æ”¯æŒ)ã€‚æœ‰ä¸€ä¸ªå¯ä¿¡ä»¿çœŸåº“å’Œä¸€ä¸ªä¸å¯ä¿¡ä»¿çœŸåº“ã€‚ä¸å¯ä¿¡ä»¿çœŸåº“æä¾›ä¸å¯ä¿¡è¿è¡Œæ—¶åº“æ¥ç®¡ç†è¿æ¥äº†å¯ä¿¡ä»¿çœŸåº“çš„EnclaveåŠŸèƒ½ã€‚åŒ…æ‹¬åœ¨Enclaveå¤–ä»¿çœŸæ‰§è¡ŒIntel SGXæŒ‡ä»¤ï¼šECREATEï¼ŒEADDï¼ŒEEXTENED, EINT, EREMOVE å’ŒEENTERã€‚å¯ä¿¡ä»¿çœŸåº“ä½å“Ÿå•Šè´Ÿè´£Enclaveå†…ä½¿ç”¨çš„Intel SGXæŒ‡ä»¤çš„ä»¿çœŸï¼šEEXIT, EGETKEY, EREPORT.\nä»¿çœŸæ¨¡å¼ä¸éœ€è¦CPUæ”¯æŒIntel SGXã€‚ç„¶è€Œå¤„ç†å™¨è‡³å°‘æ”¯æŒSSE 4.1 æŒ‡ä»¤ã€‚\nåŠ è½½ä¸å¯ä¿¡SGXDLL SGX DDLå®‰è£…åœ¨ç³»ç»Ÿç›®å½•ä¸­ï¼Œé™„å¸¦PSW(sgx_urts.dll å’Œsgx_ae_service.dll)ã€‚ä½ å¿…é¡»é”å®šSGX appçš„å®‰è£…ç›®å½•ï¼Œå¦åˆ™å°±è¦æ˜¾å¼çš„åŠ è½½è¿™ä¸¤ä¸ªdll(å…¨è·¯å¾„)ã€‚\nå‡è®¾æ”»å‡»è€…è·å¾—appå®‰è£…ç›®å½•çš„æ§åˆ¶æƒï¼Œæ’å…¥äº†ä¸€ä¸ªæ¶æ„çš„sgx dllåˆ°è¿™ä¸ªç›®å½•ï¼Œå¦‚æœappéšå¼çš„åŠ è½½sgx dllï¼Œè¿™ä¸ªæ¶æ„çš„dll ä¼šä¼˜å…ˆäºç³»ç»Ÿç›®å½•åŸå§‹sgx dllè¢«åŠ è½½ã€‚(DLL åŠ«æŒ)\nä¸ºäº†ç¡®ä¿SGX appä»ç³»ç»Ÿç›®å½•ä¸­åŠ è½½SGX dllï¼Œ appå¿…é¡»æ˜¾å¼æ¶å­åŠ è½½è¿™ä¸¤ä¸ªdllï¼Œé¡ºåºæ˜¯\nsgx_uae_servcie.dll\nsgx_urts.sll\nEncalve é…ç½®æ–‡ä»¶ Enclaveé…ç½®æ–‡ä»¶æ˜¯ä¸€ä¸ªXMLæ–‡ä»¶ï¼ŒåŒ…å«äº†ç”¨æˆ·å®šä¹‰çš„Enclaveå‚æ•°ã€‚XMLæ–‡ä»¶æ˜¯Enclaveå·¥ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œsgx_signä¼šç”¨è¿™ä¸ªé…ç½®æ–‡ä»¶ä½œä¸ºè¾“å…¥æ¥åˆ›å»ºEnclaveçš„ç­¾åå’Œå…ƒæ•°æ®ã€‚\nä¸‹è¡¨ä¸ºé…ç½®æ–‡ä»¶å„ä¸ªå‚æ•°çš„å®šä¹‰ï¼Œæ‰€æœ‰çš„å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰å°±ä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚\nTag Description Default ProdID ISV assigned Product ID 0 ISVSVN ISV assigned SVN 0 TCSNum The number of TCS. Muster greater than 0 1 TCSPolicy TCS management policy. 0 - TCS is bound to the untrusted thread. 1 - TCS is not bound to the untrusted thread. 1 StackMaxSize The maximum stack size per thread. Must be 4k aligned. 0x40000 256k HeapMaxSize The maximun heap size for the process. Must be 4k aligned. 0x100000 1MB DisableDebug Enclave can not be debug . 0 - Enclabe can be debug 0 MiscSelect The desired Misc feature 0 MiscMask The mask bit for the Misc Feature 0xFFFFFFFF MiscSelect å’ŒMiscMask æ˜¯ä¸ºäº†æœªæ¥åŠŸèƒ½æ‰©å±•ä½¿ç”¨çš„ã€‚ç›®å‰MiscSelectå¿…é¡»æ˜¯0ï¼Œå¦åˆ™Enclaveä¸ä¼šåŠ è½½æˆåŠŸã€‚\nä¸ºäº†ä¸æµªè´¹é‡è¦çš„ä¿æŠ¤å†…å­˜èµ„æºï¼Œä½ å¯ä»¥ä½¿ç”¨sgx_emmt æµ‹é‡å·¥å…·é€‚å½“çš„è®¾ç½®StackMaxSize å’ŒHeapMaxSizeã€‚ å¯ä»¥çœ‹çœ‹Enclave Memory Measurementå·¥å…·çš„è¯¦ç»†è¯´æ˜ã€‚\nå¦‚æœenclaveä¸­æ²¡æœ‰è¶³å¤Ÿçš„Stackç©ºé—´ï¼ŒECALLä¼šè¿”å›SGX_ERROR_STACK_OVERRUNçš„é”™è¯¯ä»£ç ã€‚æç¤ºéœ€è¦åˆ†é…æ›´å¤šçš„StackMaxSizeã€‚\nEnclave Project Configuration ä»¿çœŸ\nä»¿çœŸæ¨¡å¼ä¸‹å·¥ä½œæ–¹å¼å’Œè°ƒè¯•æ¨¡å¼ä¸€æ ·ï¼Œä»¿çœŸæ¨¡å¼ä¸éœ€è¦æœ‰ç¡¬ä»¶æ”¯æŒã€‚ä½¿ç”¨Intel SGX æŒ‡ä»¤æ¥è¿›è¡Œè½¯ä»¶æ¨¡æ‹Ÿã€‚å•æ­¥ç­¾åæ˜¯å¯¹ä»¿çœŸEnclaveç­¾åçš„é»˜è®¤æ–¹å¼\nè°ƒè¯•\nå¦‚æœè®¾ç½®äº†Debugé€‰é¡¹ï¼ŒEnclaveç¼–è¯‘ä¸ºè°ƒå¼æ¨¡å¼ï¼Œç¼–è¯‘å‡ºæ¥çš„EnclaveåŒ…å«æœ‰è°ƒè¯•ä¿¡æ¯å’Œç¬¦å·ä¿¡æ¯ã€‚ é€šè¿‡SGX_DEBUG_FLAGä¼ é€’ç»™sgx_create_enclaveã€‚ å…è®¸EnclaveåŠ è½½åˆ° Enclave è°ƒè¯•æ¨¡å¼ã€‚å•æ­¥ç­¾åæ˜¯è¿™ä¸ªå·¥ç¨‹çš„é»˜è®¤ç­¾åæ–¹å¼ã€‚ç”¨äºè¿™ç§æ¨¡å¼çš„ç­¾åå¯†é’¥ä¸éœ€è¦ä½¿ç”¨ç™½åå•ä¸­çš„å€¼ã€‚\né¢„å‘è¡Œç‰ˆ\nç¼–è¯‘å™¨ä¼šä½¿ç”¨æœ€ä¼˜åŒ–ç¼–è¯‘Enclaveä¸ºå‘è¡Œæ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹EnclaveåŠ è½½åˆ°Enclaveè°ƒè¯•æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹Projectä¼šå®šä¹‰é¢„å¤„ç†å™¨æ ‡è®°EDEBUGåœ¨é¢„å¤„ç†å™¨é…ç½®ä¸­ã€‚å½“EDEBUGé¢„å¤„ç†å™¨æ ‡è®°å®šä¹‰äº†ï¼Œå®ƒä¼šEnable SGX_DEBUG_FLAG, ä¼šåŠ è½½Enclaveåˆ°Enclaveè°ƒè¯•æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹ä¹Ÿæ˜¯å•æ­¥ç­¾åä½œä¸ºç­¾åæ–¹å¼ã€‚ç­¾åå¯†é’¥ä¸éœ€è¦å†ç™½åå•ä¸­ã€‚\nå‘è¡Œç‰ˆ\nåŠ è½½Enclaveåˆ°Enclaveå‘è¡Œæ¨¡å¼ä¸‹ã€‚ä¼šç¦ç”¨SGX_DEBUG_FLAGæ ‡è®°ã€‚åªæœ‰å†NDEBUGæœªå®šä¹‰æˆ–è€…EDEBUGå®šä¹‰äº†ä¹‹åSGX_DEBUG_FLAGæ‰å¯ç”¨ã€‚è°ƒè¯•æ¨¡å¼ä¸‹NDEBUGæ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥SGX_DEBUG_FLAGå¯ç”¨ã€‚å‘è¡Œæ¨¡å¼ä¸‹é…ç½®ä¸­NDEBUGå·²å®šä¹‰ï¼ŒSGX_DEBUG_FLAGä¸å¯ç”¨ï¼Œæ‰€ä»¥åŠ è½½Enclaveåˆ°Enclaveå‘è¡Œæ¨¡å¼ã€‚Two-Stepç­¾åæ˜¯è¿™ç§æ¨¡å¼ä¸‹çš„é»˜è®¤ç­¾åæ–¹å¼ï¼ŒEnclaveéœ€è¦ä½¿ç”¨ç™½åå•ä¸­çš„ç­¾åå¯†é’¥ã€‚\nåŠ è½½/å¸è½½Enclave Enclaveæºç ä¼šç¼–è¯‘ä¸ºåŠ¨æ€è¿æ¥åº“ã€‚ä½¿ç”¨Enclaveï¼Œéœ€è¦è°ƒç”¨ sgx_create_enclave()æ¥åŠ è½½enclave.dll åˆ°ä¿æŠ¤å†…å­˜ä¸­ã€‚enclave.dll å¿…é¡»ä½¿ç”¨sgx_sign.exe æ¥ç­¾åã€‚å½“ç¬¬ä¸€æ¬¡åŠ è½½Enclaveæ—¶ï¼ŒåŠ è½½ä¼šè·å–ä»¥ä¸ªlaunch tokenï¼Œ ç„¶åä¿å­˜ç”¨äºåç»­in/outå‚æ•°ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨launch tokenåˆ°æ–‡ä»¶ä¸­ï¼Œç„¶åç¬¬äºŒæ¬¡åŠ è½½enclaveæ—¶ï¼Œappå¯ä»¥ä»tokenä¿å­˜çš„æ–‡ä»¶ä¸­è·å–tokenã€‚å‡†å¤‡ä¸€ä¸ªæœ‰æ•ˆçš„launch tokenæ¥æé«˜åŠ è½½æ€§èƒ½ã€‚å¼€å‘è€…å¿…é¡»ä½¿ç”¨sgx_destory_enclave()å¹¶ä¼ é€’sgx_enclave_id_tä½œä¸ºå‚æ•°æ¥å¸è½½Enclaveã€‚\nä¸‹é¢æ—¶åŠ è½½å’Œå¸è½½Enclaveçš„ç¤ºä¾‹ä»£ç \n1#include \u0026lt;stdio.h\u0026gt; 2#include \u0026lt;tchar.h\u0026gt; 3#include \u0026#34;sgx_urts.h\u0026#34; 4#define ENCLAVE_FILE_T(\u0026#34;Enclave.signed.dll\u0026#34;) 5int main(int argc,char* argv[]){ 6 sgx_enclave_id_t eid; 7 sgx_status_t ret = SGX_SUCCESS; 8 sgx_launch_token_t token = {0}; 9 int updated = 0; 10 11 // Create the Enclave with above launch token. 12 ret = sgx_create_enclave(ENCLAVE_FILE, SGX_DEBUG_FLAG, \u0026amp;token,\u0026amp;updatedï¼Œ\u0026amp;eid, NULL); 13 if (ret != SGX_SUCCESS){ 14 printf(\u0026#34;App: error %#x, failed to create enclave.\\n\u0026#34;,ret); 15 return -1; 16 } 17 // A bunch of Enclave calls(ECALL) will happen here. 18 // Destory the encalve when all Encalve calls finished 19 if (SGX_SUCCESS != sgx_destory_enclave(eid)) 20 return -1; 21 return 0; 22} å¤„ç†ç”µæºäº‹ä»¶\nä¿æŠ¤å†…å­˜åŠ å¯†å¯†é’¥ä¿å­˜åœ¨æ”¯æŒSGXçš„cpuä¸­ï¼Œæ¯æ¬¡ç”µæºäº‹ä»¶(suspend å’Œä¼‘çœ )ä¼šé”€æ¯ã€‚å› æ­¤å½“ç”µæºå‘ç”Ÿæ”¹å˜æ—¶ï¼ŒEnclaveå†…å­˜ä¼šè¢«ç§»é™¤ï¼Œæ‰€æœ‰enclaveæ•°æ®å°†ä¸å¯è®¿é—®ã€‚æ‰€ä»¥ï¼Œå½“ç³»ç»Ÿæ¢å¤äº†ä¹‹åï¼Œä»»ä½•åç»­çš„ECALLéƒ½ä¼šè¿”å›é”™è¯¯SGX_ERROR_ENCLAVE_LOST. è¿™ä¸ªé”™è¯¯è¡¨ç¤ºSGX enclaveåœ¨æ–­ç”µæ—¶ä¸¢å¤±äº†ã€‚\nSGX secure Enclaves Software Guard Extensions: Non-hierarchical Trust Model Secure Enclave:\nApplication can instantiate CPU-based trusted execution environment. Shielded from all other running software: confidentiality and integrity. Direct access to enclave memory is disallowed even form OS/Hypervisor since they are untrusted. Reduced Trusted Computing Base Enclave Identity\nFully measured (hash) at creation time Measurement establishes enclave idgentity Used for attestation: allows a remote entity to establish trust on an enclave. Enclave Page Cache (EPC)\nStores running enclaves Reserved by firmer at boot time Treated specially by CPU Memory traffic goes through encryption engine Not accessible when CPU not in enclave mode An enclave can only assess its own EPC pages Managed by OS/VMM Allocation, mapping, eviction K8s SGX Device Plugin This video demonstrates the Intel(R) Software Guard Extensions ECDSA Quote Generation in Kuberntes\nThe key building blocks are:\nIntel(R) Software Guard Extensions (SGX) Flexible Launch Control capable system(registered) Intel(R) SGX driver(RFC v41) for the host kernel Intel(R) SGX PCKID Certificate Caching Service configured Let\u0026rsquo;s get started!\nCheck the Kubernetes Cluster is in good shape\n1kubectl get nodes 2# Check all pods status 3# certmanager x 3 4# coredns x 2 5# weave 6kubectl get pods -A 7# create the demo namespace 8kubectl create ns sgx-ecdsa-quote 9 10# Pull: devel images and tag them as 0.23.0 11sudo ctr -n k8s.io i pull docker.io/intel/intel-sgx-plugin:devel 12sudo ctl -n k8s.io i pull docker.io/intel/intel-sgx-initcontainer:devel Deploy node-feature-discovery for Kubernetes\nIt\u0026rsquo;s used to label SGX capable nodes and register SGX EPC as an extened resource\n1kubectl apply -k intel-device-plugins-for-kubernetes/deployments/sgx_nfd 2 3# Check its pod is running 4kubectl wait --for=condition=Ready pod/nfd-worker-vcm4z -n node-feature-discovery Deploy Intel Device Plugin Operator as a DaemonSet\n1kubectl apply -k intel-device-plugins-for-kubernetes/deployments/sgx_plugin/overlays/epc-nfd/ Verify node resource\n1kubectl describe node \u0026lt;node name\u0026gt; | grep sgx.intel.com Both node labels and resources for SGX are in place\nRun Intel(R) SGX DCAP ECDSA Quote Generation(out-of-proc)\n1# Make the pre-built images available (from docker save) 2sudo ctr -n k8s.io i import sgx-aesmd.tar 3sudo ctr -n k8s.io i import sgx-demo.tar 4# Deploy Intel(R) AESMD 5kubectl apply -k intel-device-plugins-for-kubernetes/deployments/sgx_aesmd/ 6# Deploy Intel(R) SGX DCAP ECDSA Quote Genetation 7 k apply -k intel-device-plugins-for-kubernetes/deployments/sgx_enclave_apps/overlays/sgx_ecdsa_aesmd_quote/ 8 9kubectl logs ecdsa-quote-intelsgx-demo-job-npwvf -n sgx-ecdsa quote 10 11 12# Intel(R) SGX DCAP QuoteGenerationSample successfully requested a quote from Intel(R) AESMD 13 14# Delete the deployment 15 k delete -k intel-device-plugins-for-kubernetes/deployments/sgx_enclave_apps/overlays/sgx_ecdsa_aesmd_quote/ Run Intel(R) SGX DCAP ECDSA Quote Generation(in-proc)\n1# Deploy Intel(R) SGX DACP ECDSA Quote Generation 2kubectl apply -k intel-device-plugins-for-kubernetes/deployments/sgx_enclave_apps/overlays/sgx_ecdsa_aesmd_quote 3 4kubectl logs inproc-ecdsa-quote-intelsgx-demo-job 5 6# Intel(R) SGX DCAP QuoteGenerationsSmaple successfully generated a quote using DCAP Quote Provider Library. This video demonstrated the Intel(R) Sofrware Guard Extensions in Kubernetes\nThe following topics were covered:\nSGX Kubernetes Device Plugin deployment with an Operator Intel(R) SGX node resource and featured label registration to Kubernetes* Intel(R) SGX DCAP ECDSA Quote Generation I encountered a problem with the hardware when trying to enable the SGX device plugin demo. This feature needs the CPU support FLC, but mine doesnâ€™t support that. If anyone has a supported NUC, can you exchange it with mine NUC11TVHv7 32G\nCheck Method : https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html\nOn a Linux* system, execute cpuid in a terminal\nOpen a terminal and run: $ cpuid | grep -i sgx Look for output: SGX_LC: SGX launch config supported = true\nDevice Plugin Pod\n1apiVersion: v1 2kind: Pod 3metadata: 4 name: ubuntu-sgx-demo 5spec: 6 containers: 7 - 8 name: ubuntu-sgx 9 image: airren/ubuntu-sgx:v0.0.1 10 imagePullPolicy: IfNotPresent 11 workingDir: \u0026#34;/\u0026#34; 12 command: [\u0026#34;sleep\u0026#34;,\u0026#34;3600\u0026#34;] 13 resources: 14 limits: 15 sgx.intel.com/epc: \u0026#34;512Ki\u0026#34; Deploy SGX Plugin Quickly 1 k apply -k deployments/nfd/overlays/sgx 2 k apply -k deployments/nfd/overlays/node-feature-rules 3 k apply -k deployments/sgx_plugin/overlays/epc-nfd server mesh controller\nclusternet. use the latested version image\nservice discovery , A Bhow to find the the server in a\nå‚è€ƒèµ„æ–™\nhttps://zhuanlan.zhihu.com/p/39976702\nhttps://zhuanlan.zhihu.com/p/39912478\nprotobuf\n800-810-1972 Toll-free\n400-810-1972 Local Toll (For Mobile)\nMonday to Friday 08:00 - 18:00 GMT +8\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/3_intel_sgx/","summary":"æ¦‚è¿° https://www.intel.com/content/www/us/en/developer/tools/software-guard-extensions/overview.html\nhttps://blog.quarkslab.com/overview-of-intel-sgx-part-1-sgx-internals.html\nIntel Software Guard Extensions(Intel SGX) ä¿æŠ¤é€‰å®šçš„ä»£ç å’Œæ•°æ®ä¸è¢«æ³„éœ²çš„å’Œä¿®æ”¹ã€‚å¼€å‘è€…å¯ä»¥æŠŠåº”ç”¨ç¨‹åºåˆ’åˆ†åˆ°CPUå¼ºåŒ–çš„enclaveä¸­æˆ–è€…å†…å­˜ä¸­å¯æ‰§è¡Œçš„ä¿æŠ¤åŒºåŸŸï¼Œå³ä½¿åœ¨å—æ”»å‡»çš„å¹³å°ä¸­ä¹Ÿå¯ä»¥æé«˜å®‰å…¨æ€§ã€‚ä½¿ç”¨è¿™ç§æ–°çš„åº”ç”¨å±‚å¯ä¿¡æ‰§è¡Œç¯å¢ƒï¼Œå¼€å‘è€…èƒ½å¤Ÿå¯ç”¨èº«ä»½å’Œè®°å½•éšç§ï¼Œå®‰å…¨æµè§ˆå’Œæ•°æ®ä¿æŠ¤(DRM)æˆ–è€…ä»»ä½•éœ€è¦å®‰å…¨å­˜å‚¨æœºå¯†æˆ–è€…ä¿æŠ¤æ•°æ®çš„é«˜ä¿éšœå®‰å…¨åº”ç”¨åœºæ™¯ä¸­ã€‚\næœºå¯†æ€§å’Œå®Œæ•´æ€§ï¼Œ å³ä½¿åœ¨OSã€BIOSã€VMMæˆ–è€…SMMå±‚å­˜åœ¨ç‰¹æƒæ¶æ„è½¯ä»¶çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä¿è¯å®‰å…¨ã€‚ ä½å­¦ä¹ æ›²çº¿ï¼Œå’Œçˆ¶åº”ç”¨ç¨‹åºç±»ä¼¼çš„OSç¼–ç¨‹æ¨¡å‹ï¼Œå¹¶ä¸”åœ¨ä¸»CPUä¸Šæ‰§è¡Œ è¿œç¨‹è®¤è¯ è¿œç¨‹éƒ¨åˆ†èƒ½å¤Ÿè®¤è¯ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„enclaveçš„èº«ä»½ï¼Œå¹¶ä¸”å®‰å…¨çš„å°†å¯†é’¥ã€å‡­æ®å’Œæ•æ„Ÿæ•°æ®æä¾›ä¸ºenclave æœ€å°çš„å¯èƒ½æ”»å‡»é¢ï¼Œ CPUè¾¹ç•Œæˆä¸ºæ”»å‡»é¢å¤–å›´ï¼Œæ‰€æœ‰çš„æ•°æ®ã€å†…å­˜ã€å¤–å›´ä¹‹å¤–çš„IOéƒ½æ˜¯åŠ å¯†çš„ã€‚ æœ€å°æ”»å‡»é¢çš„ç¡¬ä»¶è¾…åŠ©å¯ä¿¡æ‰§è¡Œç¯å¢ƒã€‚\nintel SGXä¿æŠ¤çš„åº”ç”¨ç¨‹åº Intel SGXåº”ç”¨ç¨‹åºç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š ä¸å¯ä¿¡ä»£ç å’Œå¯ä¿¡Enclave. å¼€å‘è€…å¯ä»¥åˆ›å»ºä¸€å¯¹å¤šçš„å¯ä¿¡enclaveç”¨æ¥æ”¯æŒåˆ†å¸ƒå¼ä½“ç³»ç»“æ„ã€‚\nå¸¸ç”¨åº”ç”¨æœ‰å¯†é’¥ï¼Œä¸“æœ‰ç®—æ³•ï¼Œç”Ÿç‰©è¯†åˆ«æ•°æ®å’ŒCSRç”Ÿæˆç­‰ã€‚\nç¨‹åºè¿è¡Œæ—¶ï¼Œ Intel SGXæŒ‡ä»¤åœ¨ä¸€ä¸ªç‰¹å®šçš„ä¿æŠ¤å†…å­˜åŒºåŸŸä¸­åˆ›å»ºå’Œæ‰§è¡Œenclaveï¼Œè¯¥åŒºåŸŸæœ‰ç”±å¼€å‘è€…å®šä¹‰çš„å—é™å…¥å£å’Œå‡ºå£å‡½æ•°ã€‚èƒ½å¤Ÿé˜²æ­¢æ•°æ®æ³„éœ²ã€‚åœ¨CPUèŒƒå›´ä¸­çš„enclaveå’Œæ•°æ®è¿è¡Œåœ¨ä¸€ä¸ªcleançš„ç¯å¢ƒä¸­ï¼Œ enclaveæ•°æ®å†™å…¥åˆ°ç£ç›˜ä¼šè¢«åŠ å¯†ï¼Œå¹¶ä¸”æ ¡éªŒå…¶å®Œæ•´æ€§ã€‚\nä¸Šå›¾ä¸­çš„æµç¨‹\nApplicationç”±å¯ä¿¡å’Œä¸å¯ä¿¡éƒ¨åˆ†æ„æˆ Appè¿è¡Œå’Œåˆ›å»ºevclaveï¼Œ enclaveæ”¾å…¥åˆ°å¯ä¿¡å†…å­˜ä¸­ å¯ä¿¡å‡½æ•°è¢«è°ƒç”¨ï¼Œæ‰§è¡Œä¼šè½¬æ¢åˆ°enclaveä¸­ enclaveå¯ä»¥è®¿é—®æ‰€æœ‰è¿›ç¨‹æ•°æ®ï¼Œå¤–éƒ¨è¦è®¿é—®enclaveæ•°æ®è¢«ç¦æ­¢ å¯ä¿¡å‡½æ•°è¿”å›enclaveæ•°æ® å¯¹enclaveæœ‰æœªæˆæƒçš„è®¿é—®å’Œå†…å­˜ä¾¦å¬æ˜¯æœ‰å¯èƒ½çš„\nè®¤è¯Enclaveå’ŒåŠ å¯†æ•°æ® å½“å‰ï¼ŒODM(åŸå§‹è®¾å¤‡åˆ¶é€ ä¸Š)å’ŒISV(ç‹¬ç«‹è½¯ä»¶æä¾›å•†) é€šå¸¸åœ¨åˆ¶é€ æ—¶æˆ–é€šè¿‡æ— æ³•ä»¥æœºå¯†æ–¹å¼è¯æ˜XXXã€‚\nIntel SGXä½¿ç”¨enclaveä¹‹é—´æœ¬åœ°è®¤è¯æˆ–è€…ç¬¬ä¸‰æ–¹è¿œç¨‹è®¤è¯çš„æ–¹å¼æ¥ä¿è¯åº”ç”¨ç¨‹åºæ²¡æœ‰å—åˆ°ç ´åã€‚\nåº”ç”¨ç¨‹åºå—ä¿æŠ¤çš„éƒ¨åˆ†ä¼šåŠ è½½åˆ°ä¸€ä¸ªEnclaveï¼Œå®ƒçš„ä»£ç å’Œæ•°æ®éƒ½ä¼šæ”¶åˆ°ç›‘æµ‹ã€‚ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚åˆ°è¿œç«¯æœåŠ¡å™¨ï¼Œç”¨æ¥éªŒè¯è¿™ä¸ªEnclaveæ˜¯å¦æ˜¯å¯é çš„Intel å¤„ç†å™¨ç”Ÿæˆçš„ã€‚ å¦‚æœè®¤è¯äº†Enclaveçš„èº«ä»½ï¼Œè¿œç«¯å°±ä¼šä¿¡ä»»Enclaveå¹¶å®‰å…¨çš„æä¾›å¯†é’¥ï¼Œå‡­è¯å’Œæ•°æ®.\nIntel SGX åŒ…æ‹¬ä¸€ä¸ªç”ŸæˆCPUå’ŒEnclaveç‰¹å®šâ€œå¯†å°å¯†é’¥â€çš„æŒ‡ä»¤ã€‚å¯†é’¥èƒ½å¤Ÿç”¨æ¥å®‰å…¨çš„å­˜å‚¨å’Œå–å›å¯é¥ä½ éœ€è¦ä¿å­˜åœ¨ç£ç›˜ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚\nIntel SGX å®ç°æ–°çš„å®‰å…¨æ¨¡å‹ Intel SGX æ˜¯åœ¨å¾ˆå¤šå…¬å¸ã€å¤§å­¦çš„å®‰å…¨ç ”ç©¶äººå‘˜ä»¥åŠæ”¿åºœå®‰å…¨æœºæ„çš„æ”¯æŒä¸‹åˆ›å»ºçš„ï¼Œä¸Šç™¾å®¶ISVä¸Intelåˆä½œï¼Œä½¿ç”¨Intel SGXæ¥ä¿æŠ¤å…³é”®ä»»åŠ¡åº”ç”¨ç¨‹åºã€‚\nSet up SGX develop environment Install SGX driver\nInstall SGX SDK\nInstall SGX PSW\nç›´æ¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ä¾æ¬¡å®‰è£…ä¸Šè¿°3ä¸ªç»„ä»¶\nSample Enclave Demo 1############# SGX SDK Setting 2# ç¼–è¯‘å¹³å°å’Œæ¨¡å¼é…ç½® 3 4############## APP Setting 5# ä¸»è¦æ˜¯æŒ‡å®š 6# App_Cpp_Files éœ€è¦ç¼–è¯‘çš„cppæ–‡ä»¶ 7# App_Include_Paths åŒ…å«ç›®å½• 8# App_Cpp_Objects è¾“å‡º 9 10############### Enclave setting 11# Enclave_Cpp_Files 12# Enclave_Include_Paths 13# Enclave_Cpp_Objects 14 15# eld ç¼–è¯‘é…ç½® 16################ App Object 17################ Enclave Object Enclave ç›¸å…³å¼€å‘æµç¨‹ ä½¿ç”¨edlæ–‡ä»¶å®šä¹‰ä¸å¯ä¿¡appå’Œenclaveä¹‹é—´çš„æ¥å£ å®ç°appå’Œenclaveå‡½æ•° ç¼–è¯‘ app å’Œenclaveã€‚ç¼–è¯‘ä¸­ Edger8rç”Ÿæˆå¯ä¿¡å’Œä¸å¯ä¿¡çš„ä»£ç†/æ¡¥å‡½æ•°ï¼ŒEnclaveç­¾åå·¥å…·ç”Ÿæˆenclaveçš„metadataå’Œç­¾å åœ¨æ¨¡æ‹Ÿå’Œç¡¬ä»¶æ¨¡å¼ä¸‹è¿è¡Œå’Œè°ƒè¯•appï¼Œè¯¦ç»†çœ‹debug enclaveçš„å†…å®¹ å‡†å¤‡å‘å¸ƒapp å’Œenclave ç¼–å†™Enclaveå‡½æ•° åœ¨appè§’åº¦ï¼Œä½¿ç”¨ä¸å¯ä¿¡ä»£ç†å‡½æ•°è°ƒç”¨enclaveå‡½æ•°(ECALL)è·Ÿè°ƒç”¨å…¶ä»–å‡½æ•°æ²¡æœ‰åŒºåˆ«ã€‚Enclaveå‡½æ•°åªæ˜¯æœ‰äº›æ˜¾ç¤ºçš„c/c++å‡½æ•°ã€‚","tags":null,"title":"Intel SGX"},{"categories":null,"contents":"IPsec is a group of networking protocols used for setting up secure encrypted connections, such VPNs, across publicly shared networks.\nWhat is IPsec IPsec is a group of protocols that are used together to set up encrypted connections between devices. It helps keep data send over public networks secure. IPsec is often used to set up VPNs, and it works by encrypting IP packets, along with authenticating the source where the packets come from.\nWithin the term \u0026ldquo;IPsec\u0026rdquo;, \u0026ldquo;IP\u0026rdquo; stands for \u0026ldquo;Internet Protocol\u0026rdquo; and \u0026ldquo;sec\u0026rdquo; for \u0026ldquo;secure\u0026rdquo;. The Internet protocol is the main routing protocol used on the Internet; it designates where data will go using IP addresses. IPsec is secure because it adds encryption and authentication to this process.\nEncryption is the process of concealing information by mathematically alerting data so that it appears random. In simpler terms, encryption is the use of a \u0026ldquo;secret code\u0026rdquo; that only authorized parties can interpret.\nHow does IPsec Work? IPsec connections include the following steps:\nKey exchanges: Keys are the necessary for encryption; a key is a string of random characters that can be used to \u0026ldquo;lock\u0026rdquo;(encrypt) and \u0026ldquo;unlock\u0026rdquo;(decrypt) messages. IPsec set up keys with a key exchange between the connection devices, so that each device can decrypt the other device\u0026rsquo;s messages.\nPacket headers and trailers: All data that is sent over a network is broken down into smaller pieces call packets. Packets contain both a payload, or actual data being sent, and headers, or information about that data so that computers receiving the packets know what to do with them. IPsec add several headers to data packets containing authentication and encryption information. IPsec also add trailers, which go after each packet\u0026rsquo;s payload instead of before.\nAuthentication: IPsec providers authentication for each packets, like a stamp of authenticity on a collection item. This ensures that packets are from a trusted source and not an attacker.\nEncryption: IPsec encrypts the payloads within each packets and each packet\u0026rsquo;s IP header(unless transport mode is used instead of tunnel mode). This keeps data sent over IPsec secure and private.\nTransmission: Encrypted IPsec packets travel across one or more networks to their destination using a transport protocol. At this stage, IPsec traffic differs from regular IP traffic in that it most often uses UDP as its transport protocol, rather than TCP. TCP the transmission Control Protocol,set up dedicated connections between devices and ensures that all packets arrive. UDP, the User Datagram Protocol, does not set up these dedicated connections. IPsec uses UDP because this allows IPsec packets to get through firewalls.\nDecryption: At the other end of the communication, the packets are decrypted, and applications can now use the delivered data.\nWhat protocols are used in IPsec In networking, a protocol is specified way of formatting data so that any networked computer can interpret the data. IPsec is not one protocol, but a suite of protocols. The following protocol make up the IPsec suite.\nAuthentication Header(AH): The AH protocol ensures that data packets are form a trusted source and that the data has not been tampered with, link a temper-proof seal on a consumer product. These header do not provider any encryption; the do not help conceal the data from attackers.\nEncapsulating Security Protocol(ESP): ESP encrypts the IP header and the payload for each packet - unless transport mode is used, in which case it only encrypts the payload. ESP add its own header and a trailer to each data packet.\nSecurity Association(SA): SA refers to a number of protocols used for negotiating encryption keys and algorithm. One of the most common SA protocols is Internet Key Exchange(IKE).\nFinally, while the Internet Protocol(IP) is not part of the IPsec suite, IPsec runs directly on top of IP.\nWhat is the difference between IPsec tunnel mode and IPsec transport mode? IPsec tunnel mode is used between two dedicated routers, with each router acting as one end of a virtual \u0026ldquo;tunnel\u0026rdquo; through a public network. In IPsec tunnel mode, the original IP header containing the final destination of the packet is encrypted, in addition to the packet payload. To tell intermediary routers where to forward the packets, IPsec adds a new IP header. At each end of the tunnel, the router decrypt the IP headers to deliver the packets to their destination.\nIn transport mode, the payload of each packet is encrypted, but the original IP header is not. Intermediary routes thus able view the final destination of each packet\u0026ndash; unless a separate tunneling protocol(such as GER) is used.\nWhat port does IPsec use? A network port is the virtual location where data goes in a computer. Ports are how computers keep track of difference processes and connections; if data goes a certain port, the computer\u0026rsquo;s operating system knows which process it belongs to. IPsec usually uses port 500.\nHow does IPsec impact MSS and MTU? MSS and MTU are two measurements of packet size. Packets can only reach a certain size(measures in bytes) before computers, routers and switches cannot handle them. MSS measures the size of each packet\u0026rsquo;s payload, while MTU measures the entire packets, including headers. Packets that exceed a network\u0026rsquo;s MTU may be fragmented, meaning broken up into smaller packets and then reassembled. Packets that exceed the MSS are simply dropped.\nIPsec protocols add several headers and trailers to packets, all of which take up several bytes. For networks that use IPsec, either the MSS and MTU have to adjusted accordingly, or packets will be fragmented and slightly delayed. Usually, the MTU for a network is 1,500 bytes. A normal IP header is 20 bytes long, and a TCP header is also 20 bytes long, meaning each packet can contain 1,460 bytes of payload. However, IPsec add an Authentication Header, and ESP header, and associated trailers. These add 50-60 types to a packets, or more.\n1sudo iptables -t mangle -I POSTROUTING -p tcp -m tcp -j TCPMSS --tcp-flags SYN,RST SYN --set-mss 1280 2 3 4sudo iptables -t mangle -I POSTROUTING -p tcp -m tcp -j TCPMSS --tcp-flags SYN,RST SYN --set-mss 60 Challenge To secure traffic, IPsec requires an SA to be set up between two points, creating a tunnel for the traffic to travel through. Depending on the implementation model, this can introduce some challenges. For example, in a mesh model, all nodes(or locations) are connected to each other by dedicated tunnels. However, this requires creating managing several IPsec tunnels, which is difficult to scale.\nIKE Negotiating IPsec\u0026rsquo;s IKE Phase1. The best way to make sure you site-to-site tunnels get built is to remember to HAGLE: make sure you hash, Authentication, Group, Lifetime and Encryption are negotiated and agreed on.\nBefore the device establish the tunnel, you need to negotiate IPsec\u0026rsquo;s IKE Phase1. There are 5 times. To remember each step, Keith\u0026rsquo;s Recommend method is \u0026ldquo;HAGLE\u0026rdquo;.\nH: Hashing algorithm to verify data integrity A: Authentication to verify one another /PSK G: Groups to generate secret keys (DH, diffie helman Group Asymmetric) Lï¼šLifetime to determine how long the tunnel stands up E: Encryption to agree which algorithm to use(AES symmetric ) With these five items, you ASAs can stand up an IKE Phase1 and connect you site securely across the Internet.\nMD5\nIPsec is a protocol suit to authenticate and encrypt the packets being exchanged between two points.\nVPN is a private connection over a public network - Layer 2 or Layer 3\nIPsec is standard by IETF to create a VPN tunnel at layer 3(Network Layer)\nIPsec provides:\nIntegrity: It indicates that the received message is same message that was sent [MD5, SHA]\nAuthentication: refers to verifying identity of a network entity like user/device [PSK, RSA], Make sure the user is we expected.\nConfidentiality: it is used to hide information [DES, 3DES, AES,SEAL]\nKey Management: To agree on key used for authentication and other purpose [Manual or automatic]\nTo achieve the goal of creating a secure tunnel, two peers needs to negotiate all the required parameters.\nIPsec use following protocols:\nAuthentication Header(AH): It provides authentication and integrity Encapsulation Security Protocol(ESP): It provides authentication, integrity and confidentiality Internet Key Exchange(IKE): Key management protocol, used to negotiate Security Association(SA), SA are security polices for communication between peers. IKE performs it jobs using ISAKMP framework using two phases\nPhase-1 is used to negotiate ISAKMP policy by exchange 5 parameters referred to as HAGLE. In this phase, Peers authenticate each other and calculate a shared secret key. Phase-1 gives a secure tunnel to be used in second IKE phase.\nAfter the negotiation , then IKE Policy Set. then get a tunnel.\nthe tunnel for the second IKE phase.\nPhase 1 can run in two modes\nMain mode. identity of peers is protected using encryption Aggressive mode. identity of peers is not protected. Phase-2 is used to negotiate IPsec security parameters [negotiate protocols and algorithm]\nEncapsulation protocol(AH, ESP) Encryption Hashing Tunnel mode( Transport mode) When then have done that, IPsec Transform Set, IPsec policy for sending our data\nAuthentication Header IPsec use two main protocols - AH and/or ESP\nAuthentication Header(AH): It provides authentication and integrity(no confidentiality,no encryption to hide the message)\nAuthentication : both side authenticate each other\nIntegrity: The message from one side to another can not be changed. If change will be discard. can provide security against replay attack using sliding window. Replay attack allows a bad guy to resend the intercepted contents between two points.\nEncapsulation Security Protocol(ESP): It provides authentication, integrity and confidentiality\ncan provide security against replay attack using sliding window.\nå‚è€ƒèµ„æ–™\nhttps://www.cloudflare.com/learning/network-layer/what-is-ipsec/\nhttps://www.youtube.com/watch?v=tapoOQ-MkPU\u0026ab_channel=GDNetworkingNewbie\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_ipsec/","summary":"IPsec is a group of networking protocols used for setting up secure encrypted connections, such VPNs, across publicly shared networks.\nWhat is IPsec IPsec is a group of protocols that are used together to set up encrypted connections between devices. It helps keep data send over public networks secure. IPsec is often used to set up VPNs, and it works by encrypting IP packets, along with authenticating the source where the packets come from.","tags":null,"title":"IPSec"},{"categories":null,"contents":"é˜²ç«å¢™ é€»è¾‘ä¸Šï¼Œé˜²ç«å¢™å¯ä»¥åˆ†ä¸ºä¸»æœºé˜²ç«å¢™å’Œç½‘ç»œé˜²ç«å¢™ã€‚ä¸»æœºé˜²ç«å¢™é’ˆå¯¹å•ä¸ªä¸»æœºè¿›è¡Œé˜²æŠ¤ï¼›ç½‘ç»œé˜²ç«å¢™å¾€å¾€å¤„äºç½‘ç»œå…¥å£æˆ–è€…è¾¹ç¼˜ï¼Œé’ˆå¯¹ç½‘ç»œå…¥å£è¿›è¡Œé˜²æŠ¤ï¼ŒæœåŠ¡äºé˜²ç«å¢™èƒŒåçš„æœ¬åœ°å±€åŸŸç½‘ã€‚\nç‰©ç†ä¸Šï¼Œé˜²ç«å¢™å¯ä»¥åˆ†ä¸ºç¡¬ä»¶é˜²ç«å¢™å’Œè½¯ä»¶é˜²ç«å¢™ã€‚ç¡¬ä»¶é˜²ç«å¢™åœ¨ç¡¬ä»¶çº§åˆ«å®ç°éƒ¨åˆ†é˜²ç«å¢™åŠŸèƒ½ï¼Œå¦ä¸€éƒ¨åˆ†åŸºäºè½¯ä»¶å®ç°ï¼Œæ€§èƒ½é«˜ï¼Œæˆæœ¬é«˜ï¼›è½¯ä»¶é˜²ç«å¢™åº”ç”¨è½¯ä»¶å¤„ç†é€»è¾‘è¿è¡Œäºé€šç”¨è®¡ç®—å¹³å°ä¹‹ä¸Šçš„é˜²ç«å¢™ï¼Œæ€§èƒ½ä½ï¼Œæˆæœ¬ä½ã€‚\niptables/netfilter iptableså…¶å®ä¸æ˜¯çœŸæ­£çš„é˜²ç«å¢™ï¼Œå¯ä»¥æŠŠå®ƒç†è§£é™ˆä¼Ÿä¸€ä¸ªå®¢æˆ·ç«¯ä»£ç†ï¼Œç”¨æˆ·é€šè¿‡iptablesè¿™ä¸ªä»£ç†ï¼Œå°†ç”¨æˆ·çš„å®‰å…¨è®¾å®šæ‰§è¡Œåˆ°å¯¹åº”çš„â€œå®‰å…¨æ¡†æ¶â€ä¸­ï¼Œè¿™ä¸ªâ€œå®‰å…¨æ¡†æ¶â€æ‰æ˜¯çœŸæ­£çš„é˜²ç«å¢™ï¼Œ è¿™ä¸ªæ¡†æ¶çš„åå­—å«netfilterã€‚\nnetfilteræ‰æ˜¯é˜²ç«å¢™çœŸæ­£çš„å®‰å…¨æ¡†æ¶ï¼Œä½äºå†…æ ¸ç©ºé—´ã€‚iptableså…¶å®æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œ ä½äºç”¨æˆ·ç©ºé—´ï¼Œæˆ‘ä»¬ä½¿ç”¨iptablesè¿™ä¸ªå·¥å…·æ“ä½œçœŸæ­£çš„æ¡†æ¶netfilterã€‚\nnetfilter/iptablesç»„æˆçš„linuxå¹³å°ä¸‹çš„åŒ…è¿‡æ»¤é˜²ç«å¢™ï¼Œæ˜¯å…è´¹çš„ï¼Œå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š\nç½‘ç»œåœ°å€è½¬æ¢(NAT, Network Address Translate) æ•°æ®åŒ…å†…å®¹ä¿®æ”¹ æ•°æ®åŒ…è¿‡æ»¤(é˜²ç«å¢™åŠŸèƒ½) æˆ‘ä»¬è™½ç„¶å¯ä»¥ä½¿ç”¨service iptables startå¯ç”¨iptablesæœåŠ¡ï¼Œä½†å…¶å®å‡†ç¡®çš„æ¥è¯´iptableså¹¶æ²¡æœ‰ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œä¸èƒ½ç®—æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æœåŠ¡ï¼Œè€Œç®—æ˜¯å†…æ ¸æä¾›çš„åŠŸèƒ½ã€‚\niptablesæ˜¯æŒ‰ç…§è§„åˆ™(rules)æ¥åŠäº‹çš„, rules å°±æ˜¯æˆ‘ä»¬é¢„å®šä¹‰çš„æ¡ä»¶ã€‚è§„åˆ™ä¸€èˆ¬å®šä¹‰ä¸ºâ€œå¦‚æœæ•°æ®åŒ…å¤´ç¬¦åˆè¿™æ ·çš„æ¡ä»¶ï¼Œå°±è¿™æ ·å¤„ç†è¿™ä¸ªæ•°æ®åŒ…â€ã€‚è§„åˆ™å­˜å‚¨åœ¨å†…æ ¸ç©ºé—´çš„ä¿¡æ¯åŒ…è¿‡æ»¤è¡¨ä¸­ã€‚è¿™äº›è§„åˆ™åˆ†åˆ«æŒ‡å®šäº†æºåœ°å€ã€ç›®çš„åœ°å€ã€ä¼ è¾“åè®®(å¦‚TCPã€UDPã€ICMP)å’ŒæœåŠ¡ç±»å‹(å¦‚HTTPã€FTPå’ŒSMTP)ç­‰ã€‚å½“æ•°æ®åŒ…ä¸è§„åˆ™åŒ¹é…æ—¶ï¼Œiptableså°±æ ¹æ®è§„åˆ™æ‰€å®šä¹‰çš„æ–¹æ³•æ¥å¤„ç†è¿™äº›æ•°æ®åŒ…ï¼Œ å¦‚æ”¾è¡Œ(accept)ã€æ‹’ç»(reject)å’Œä¸¢å¼ƒ(drop)ç­‰ã€‚é…ç½®é˜²ç«å¢™ä¸»è¦å·¥ä½œå°±æ˜¯æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤è¿™äº›è§„åˆ™ã€‚\newctl\nhubDevice Objcet true é»˜è®¤hub\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_iptables/","summary":"é˜²ç«å¢™ é€»è¾‘ä¸Šï¼Œé˜²ç«å¢™å¯ä»¥åˆ†ä¸ºä¸»æœºé˜²ç«å¢™å’Œç½‘ç»œé˜²ç«å¢™ã€‚ä¸»æœºé˜²ç«å¢™é’ˆå¯¹å•ä¸ªä¸»æœºè¿›è¡Œé˜²æŠ¤ï¼›ç½‘ç»œé˜²ç«å¢™å¾€å¾€å¤„äºç½‘ç»œå…¥å£æˆ–è€…è¾¹ç¼˜ï¼Œé’ˆå¯¹ç½‘ç»œå…¥å£è¿›è¡Œé˜²æŠ¤ï¼ŒæœåŠ¡äºé˜²ç«å¢™èƒŒåçš„æœ¬åœ°å±€åŸŸç½‘ã€‚\nç‰©ç†ä¸Šï¼Œé˜²ç«å¢™å¯ä»¥åˆ†ä¸ºç¡¬ä»¶é˜²ç«å¢™å’Œè½¯ä»¶é˜²ç«å¢™ã€‚ç¡¬ä»¶é˜²ç«å¢™åœ¨ç¡¬ä»¶çº§åˆ«å®ç°éƒ¨åˆ†é˜²ç«å¢™åŠŸèƒ½ï¼Œå¦ä¸€éƒ¨åˆ†åŸºäºè½¯ä»¶å®ç°ï¼Œæ€§èƒ½é«˜ï¼Œæˆæœ¬é«˜ï¼›è½¯ä»¶é˜²ç«å¢™åº”ç”¨è½¯ä»¶å¤„ç†é€»è¾‘è¿è¡Œäºé€šç”¨è®¡ç®—å¹³å°ä¹‹ä¸Šçš„é˜²ç«å¢™ï¼Œæ€§èƒ½ä½ï¼Œæˆæœ¬ä½ã€‚\niptables/netfilter iptableså…¶å®ä¸æ˜¯çœŸæ­£çš„é˜²ç«å¢™ï¼Œå¯ä»¥æŠŠå®ƒç†è§£é™ˆä¼Ÿä¸€ä¸ªå®¢æˆ·ç«¯ä»£ç†ï¼Œç”¨æˆ·é€šè¿‡iptablesè¿™ä¸ªä»£ç†ï¼Œå°†ç”¨æˆ·çš„å®‰å…¨è®¾å®šæ‰§è¡Œåˆ°å¯¹åº”çš„â€œå®‰å…¨æ¡†æ¶â€ä¸­ï¼Œè¿™ä¸ªâ€œå®‰å…¨æ¡†æ¶â€æ‰æ˜¯çœŸæ­£çš„é˜²ç«å¢™ï¼Œ è¿™ä¸ªæ¡†æ¶çš„åå­—å«netfilterã€‚\nnetfilteræ‰æ˜¯é˜²ç«å¢™çœŸæ­£çš„å®‰å…¨æ¡†æ¶ï¼Œä½äºå†…æ ¸ç©ºé—´ã€‚iptableså…¶å®æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œ ä½äºç”¨æˆ·ç©ºé—´ï¼Œæˆ‘ä»¬ä½¿ç”¨iptablesè¿™ä¸ªå·¥å…·æ“ä½œçœŸæ­£çš„æ¡†æ¶netfilterã€‚\nnetfilter/iptablesç»„æˆçš„linuxå¹³å°ä¸‹çš„åŒ…è¿‡æ»¤é˜²ç«å¢™ï¼Œæ˜¯å…è´¹çš„ï¼Œå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š\nç½‘ç»œåœ°å€è½¬æ¢(NAT, Network Address Translate) æ•°æ®åŒ…å†…å®¹ä¿®æ”¹ æ•°æ®åŒ…è¿‡æ»¤(é˜²ç«å¢™åŠŸèƒ½) æˆ‘ä»¬è™½ç„¶å¯ä»¥ä½¿ç”¨service iptables startå¯ç”¨iptablesæœåŠ¡ï¼Œä½†å…¶å®å‡†ç¡®çš„æ¥è¯´iptableså¹¶æ²¡æœ‰ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œä¸èƒ½ç®—æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æœåŠ¡ï¼Œè€Œç®—æ˜¯å†…æ ¸æä¾›çš„åŠŸèƒ½ã€‚\niptablesæ˜¯æŒ‰ç…§è§„åˆ™(rules)æ¥åŠäº‹çš„, rules å°±æ˜¯æˆ‘ä»¬é¢„å®šä¹‰çš„æ¡ä»¶ã€‚è§„åˆ™ä¸€èˆ¬å®šä¹‰ä¸ºâ€œå¦‚æœæ•°æ®åŒ…å¤´ç¬¦åˆè¿™æ ·çš„æ¡ä»¶ï¼Œå°±è¿™æ ·å¤„ç†è¿™ä¸ªæ•°æ®åŒ…â€ã€‚è§„åˆ™å­˜å‚¨åœ¨å†…æ ¸ç©ºé—´çš„ä¿¡æ¯åŒ…è¿‡æ»¤è¡¨ä¸­ã€‚è¿™äº›è§„åˆ™åˆ†åˆ«æŒ‡å®šäº†æºåœ°å€ã€ç›®çš„åœ°å€ã€ä¼ è¾“åè®®(å¦‚TCPã€UDPã€ICMP)å’ŒæœåŠ¡ç±»å‹(å¦‚HTTPã€FTPå’ŒSMTP)ç­‰ã€‚å½“æ•°æ®åŒ…ä¸è§„åˆ™åŒ¹é…æ—¶ï¼Œiptableså°±æ ¹æ®è§„åˆ™æ‰€å®šä¹‰çš„æ–¹æ³•æ¥å¤„ç†è¿™äº›æ•°æ®åŒ…ï¼Œ å¦‚æ”¾è¡Œ(accept)ã€æ‹’ç»(reject)å’Œä¸¢å¼ƒ(drop)ç­‰ã€‚é…ç½®é˜²ç«å¢™ä¸»è¦å·¥ä½œå°±æ˜¯æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤è¿™äº›è§„åˆ™ã€‚\newctl\nhubDevice Objcet true é»˜è®¤hub","tags":null,"title":"iptables"},{"categories":null,"contents":"Multicluster Replicated Control Plane is an uses case to enable communication between two service in difference service mesh without using Ingress and can enable mutual TLS between the service.\nIstio 1.8 Upgrade Notes\nMulticluster .global Stub Domain Deprecation As part of this release, Istio has switched to a new configuration for multi-primary (formerly â€œreplicated control planesâ€). The new configuration is simpler, has fewer limitations, and has been thoroughly tested in a variety of environments. As a result, the .global stub domain is now deprecated and no longer guaranteed to work going forward.\nhttps://istio.io/v1.9/docs/setup/install/multicluster/multi-primary_multi-network/\nControl plane models å¤šé›†ç¾¤éƒ¨ç½²ä¹Ÿå¯ä»¥å…±äº«æ§åˆ¶é¢(control plane)æœåŠ¡å®ä¾‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ§åˆ¶é¢å®ä¾‹å¯ä»¥è¢«ä¸€ä¸ªæˆ–è€…å¤šä¸ªprimary clusterå‘ç°ã€‚\nReference\nhttps://zufardhiyaulhaq.com/istio-multicluster-replicated-control-plane/\nhttps://istio.io/latest/docs/setup/install/multicluster/\nIsito æ˜¯å¯¹Serviceè¿›è¡Œç®¡ç†\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/4_istio_multicluster/","summary":"Multicluster Replicated Control Plane is an uses case to enable communication between two service in difference service mesh without using Ingress and can enable mutual TLS between the service.\nIstio 1.8 Upgrade Notes\nMulticluster .global Stub Domain Deprecation As part of this release, Istio has switched to a new configuration for multi-primary (formerly â€œreplicated control planesâ€). The new configuration is simpler, has fewer limitations, and has been thoroughly tested in a variety of environments.","tags":null,"title":"Istio MultiCluster"},{"categories":null,"contents":"Kubenetesç”Ÿäº§è½åœ°å…¨ç¨‹å®è·µ\næ ¸å¿ƒæ¦‚å¿µ\næ¶æ„è®¾è®¡\nè®¤è¯æˆæƒ\né«˜å¯ç”¨é›†ç¾¤æ­å»º\näºŒè¿›åˆ¶\u0026amp; kubeadm\n3å°masterä¸¤å°2 node\ncalicoã€corednsã€dashboard\nä¸šåŠ¡è¿ç§»åˆ°Kubenetes\nHarbor\næœåŠ¡å‘ç°ç­–ç•¥\nIngressNginx\nDocker åŒ–æœåŠ¡ã€K8sã€æœåŠ¡å‘ç°\nCICD\nnamespaceã€resourcesã€label\næœåŠ¡çš„è°ƒåº¦ä¸ç¼–æ’\nå¥åº·æ£€æŸ¥\nè°ƒåº¦ç­–ç•¥\néƒ¨ç½²ç­–ç•¥\næ—¥å¿—ä¸ç›‘æ§\nç¬¬2ç«  kuberneteså¿«é€Ÿå…¥é—¨ æœ¬ç« ä¸­å°†ä»æ ¸å¿ƒæ¦‚å¿µã€æ¶æ„è®¾è®¡ã€è®¤è¯æˆæƒä»¥åŠé›†ç¾¤æ­å»ºæ–¹æ¡ˆå¯¹æ¯”å‡ æ–¹é¢ï¼Œå¸¦é¢†å¤§å®¶å¿«é€ŸæŒæ¡kubernetesçš„é‡è¦çŸ¥è¯†ç‚¹ï¼ŒåŠ©åŠ›å¿«é€Ÿå…¥é—¨ã€‚\n2-1 äº†è§£kubernetes èˆµæ‰‹ï¼š æ¸”ç½‘ã€æ¸”èˆ¹ docker : é²¸é±¼ï¼Œé›†è£…ç®± ğŸ³\nKubernetes is an open-source system for automating deployment, scaling, and management of containerized applications.\nIt groups containers that makeup application in to logical units for easy management and discovery.Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community.\nkubernetesçš„ä¸»è¦ç‰¹å¾\nä»¥æœåŠ¡ä¸ºä¸­å¿ƒ è‡ªåŠ¨åŒ–ï¼Œ è‡ªåŠ¨æ‰©ç¼©å®¹ï¼Œæ›´æ–°ã€è´Ÿè½½å‡è¡¡ã€å®ä¾‹çŠ¶æ€ kubernetes vs docker\nä»¥docker å®¹å™¨æŠ€æœ¯æŠ€æœ¯çš„æ ‡å‡†ä¸ºåŸºç¡€ï¼ŒCRI K8sæ¶æ„è®¾è®¡\npodï¼š pause ä½œä¸ºæ ¹å®¹å™¨ï¼Œå…±äº«ç½‘ç»œæ–‡ä»¶ç­‰èµ„æº\nlabelï¼š deploy/pod/container\n2-2 kubernetesçš„æ ¸å¿ƒæ¦‚å¿µ 2-3 kubernetesçš„æ¶æ„è®¾è®¡ master (APIServer/Scheduler(èµ„æºã€å†…å­˜ã€cpu)/controller(k8sèµ„æºrs,service)) etcd\nworker worker (kubeletç»´æŠ¤podçš„ç”Ÿå‘½å‘¨æœŸï¼Œç½‘ç»œã€volume/ docker )\n2-4 kubernetesè®¤è¯çš„å¯†ç å­¦åŸç† (15:30) è®¤è¯(Authentication) é˜²æ­¢æœ‰äººå…¥ä¾µ\næˆæƒ(Authorization)\nAPIserver\nA \u0026ndash;8 ç¯¡æ”¹\u0026ndash; \u0026gt; B\nå¯¹ç§°åŠ å¯†ï¼šå°å§å§å¥½å¯çˆ± \u0026ndash;\u0026gt; å¯¹ç§°åŠ å¯† abc123\u0026mdash;\u0026gt; wqerjqwoeurfasdhjfskalj -\u0026gt; å¯¹ç§°è§£å¯†abc123 \u0026mdash;\u0026gt; å°å§å§å¥½å¯çˆ±\néå¯¹ç§°åŠ å¯†: å°å§å§å¥½å¯çˆ± \u0026ndash;\u0026gt; éå¯¹ç§°åŠ å¯† abc123(å…¬é’¥ public key)\u0026mdash;\u0026gt; wuqyieruzsxchjfvash -\u0026gt; éå¯¹ç§°è§£å¯†cde987(ç§é’¥ private key) \u0026mdash;\u0026gt; å°å§å§å¥½å¯çˆ±\nå‘é€ä¸€ä¸ªhello\nserviceA \u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-\u0026gt; ServiceB\nserviceA \u0026mdash;\u0026mdash;\u0026ndash;asdfqwefwsadfasd å¯†æ–‡\u0026mdash;\u0026mdash;\u0026mdash;-\u0026gt; serviceB\nA ä½¿ç”¨ serverBçš„pubkeyè¿›è¡ŒåŠ å¯†ï¼Œç„¶åå‘é€åˆ°serverBã€‚ cæˆªè·åä¹Ÿè§£ä¸å¼€ã€‚åªæœ‰Bç”¨è‡ªå·±çš„ç§é’¥æ‰å¯ä»¥è§£å¼€ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•çš„æ¶ˆè€—æ¯”è¾ƒå¤§ã€‚å¯¹ç§°åŠ å¯†çš„ç®—æ³•æ¶ˆè€—è¾ƒä½ã€‚\nç»“åˆéå¯¹ç§°åŠ å¯†å’Œå¯¹ç§°åŠ å¯†ã€‚\nä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ŒåŠ å¯†å¯¹ç§°åŠ å¯†è¦ä½¿ç”¨çš„å¯†é’¥ã€‚å¯ä»¥æŠŠå¯¹ç§°åŠ å¯†éœ€è¦çš„å¯†é’¥å®‰å…¨å¸¦çš„é€åˆ°Bã€‚æ¥ä¸‹æ¥åŒæ–¹å°±å¯ä»¥ä½¿ç”¨å¯¹ç§°åŠ å¯†è¿›è¡Œé€šä¿¡ã€‚\næ€§èƒ½å’Œå®‰å…¨æ€§éƒ½å¾—åˆ°äº†è§£å†³ã€‚\nSSL/TLSåè®® \u0026mdash;\u0026gt; HTTPS\nç›®å‰å¯èƒ½å­˜åœ¨çš„é£é™©å°±æ˜¯B åœ¨è¿”å›pubkeyçš„æ—¶å€™ï¼Œæœ‰å¯èƒ½è¢«Cæˆªè·ï¼ŒCæˆªè·åè¿”å›Cçš„å…¬é’¥ç»™Aï¼Œè¿™æ ·Aå°±æ‹¿åˆ°äº†Cçš„å…¬é’¥ã€‚\nCA è®¤è¯æœºæ„ï¼Œè®©Aå¯ä»¥éªŒè¯æ‹¿åˆ°çš„Bçš„pubkey ç¡®å®æ˜¯Bçš„ï¼Œç¡®å®æ˜¯åˆæ³•çš„ï¼Œæ˜¯CAé¢å‘çš„ã€‚\n2-5 kubernetesçš„è®¤è¯ä¸æˆæƒ è®¤è¯\n1. å®¢æˆ·ç«¯è¯ä¹¦è®¤è¯(TLSåŒå‘è®¤è¯)\nCA è‡ªå·±çš„è®¤è¯æœºæ„\nç»™å„ä¸ªç»„ä»¶é¢å‘è¯ä¹¦\nkubectl \u0026mdash;\u0026gt; API server\nåŒå‘è®¤è¯ ï¼š äº’ç›¸éªŒè¯è¯ä¹¦æ˜¯å¦ä¸ºCAé¢å‘\nAPI serveræ˜¯å¦æ˜¯kubectl éœ€è¦è®¿é—®çš„\nkubectl å®¢æˆ·ç«¯æ˜¯å¦æ˜¯ä¸€ä¸ªåˆæ³•çš„å®¢æˆ·ç«¯\n2.BearerToken\n3.ServcieAccount\nPodä¸API serveræ‰“äº¤é“\n(namespaceï¼Œtokenï¼Œca) æŒ‚è½½åˆ°podçš„æ–‡ä»¶ç³»ç»Ÿä¸­\næˆæƒ\nABAC\nwebhook\nRBAC(Role Based Access Control)\nUser \u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-\u0026gt; Role \u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-\u0026gt; Authority(Resource, Verbs:Curd)\n|_ User\n|_ ServiceAccount\nRoleBinding\nAdmisionControl: å‡†å…¥æ§åˆ¶\nAlwaysAdmitã€AlwaysDenyã€ServiceAccountã€DenyEscolatingExec\n2-6 é›†ç¾¤æ­å»ºæ–¹æ¡ˆå¯¹æ¯” ç¤¾åŒºæ–¹æ¡ˆ\nKubeadmï¼š\nBinaryï¼š\næ˜“äºç»´æŠ¤\niterm çº§è”åŠŸèƒ½\nç¬¬3ç«  å®¹å™¨è¿è¡Œæ—¶-Docker or Containerd æœ¬ç« ä¸»è¦è®²è§£Docker or Containerdå¦‚ä½•é€‰æ‹©å’Œå…¨é¢ä¸Šæ‰‹å®è·µContainerdã€‚\n3-1 Docker or Containerdå¦‚ä½•é€‰æ‹© (07:40)\n3-2 Containerdå…¨é¢ä¸Šæ‰‹å®è·µ (26:18) ç¬¬4ç«  é«˜å¯ç”¨é›†ç¾¤æ­å»º\u0026mdash;kubesprayæ–¹å¼ã€é›†ç¾¤è½åœ°æ–¹æ¡ˆ1ã€‘6 èŠ‚ | 52åˆ†é’Ÿ æœ¬ç« ä¸­å°†è®²è§£kubesprayé›†ç¾¤æ­å»ºæ–¹æ¡ˆã€‚å¸¦é¢†å¤§å®¶ä¸€èµ·åˆ†ækubesprayéƒ¨ç½²æ–¹æ¡ˆã€åŸºç¡€ç¯å¢ƒã€kubesprayçš„å®‰è£…é…ç½®ã€ç”¨kubesprayä¸€é”®éƒ¨ç½²ç”Ÿäº§çº§K8sé›†ç¾¤ç­‰ï¼Œå…¨é¢ç³»ç»Ÿå­¦ä¼škubesprayçš„é›†ç¾¤è½åœ°æ–¹æ¡ˆã€‚\n4-1 åˆ†ækubesprayéƒ¨ç½²æ–¹æ¡ˆï¼Œå‡†å¤‡åŸºç¡€ç¯å¢ƒ (08:42)\n4-2 kubesprayçš„å®‰è£…ã€é…ç½® (15:13)\n4-3 ç”¨kubesprayä¸€é”®éƒ¨ç½²ç”Ÿäº§çº§k8sé›†ç¾¤ (08:28)\n4-4 é›†ç¾¤å†’çƒŸæµ‹è¯• (06:52)\n4-5 è®¿é—®dashboard (04:41)\n4-6 åŸºäºkubesprayçš„é›†ç¾¤è¿ç»´ (07:20) ç¬¬5ç«  é«˜å¯ç”¨é›†ç¾¤æ­å»º\u0026mdash;äºŒè¿›åˆ¶æ–¹å¼ã€é›†ç¾¤è½åœ°æ–¹æ¡ˆ2ã€‘9 èŠ‚ | 73åˆ†é’Ÿ æœ¬ç« ä¸­å°†è®²è§£ï¼Œå¦‚ä½•ä½¿ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼ï¼Œæ­å»ºæœ€æ–°ç‰ˆæœ¬çš„kubernetesé«˜å¯ç”¨é›†ç¾¤ã€‚åŒæ ·ä¼šä»¥ä¸‰ä¸ªmasterï¼Œä¸¤ä¸ªworkerèŠ‚ç‚¹ä¸ºä¾‹ï¼Œä¼šé’ˆå¯¹é›†ç¾¤å¯ç”¨æ€§è¿›è¡Œçš„æµ‹è¯•ï¼Œå¹¶å®Œæˆdashboardçš„æ­å»ºå’Œä½¿ç”¨ã€‚å¹¶åœ¨æœ¬ç« ç»“å°¾ï¼Œé€šè¿‡æ–‡æ¡£æ–¹å¼ï¼Œé’ˆå¯¹å‰é¢å†…å®¹è¿›è¡Œæ€»ç»“ï¼Œä¾¿äºåŒå­¦ä»¬å›é¡¾æŸ¥é˜…ã€‚\u0026hellip;\n5-1 åŸºç¡€ç¯å¢ƒå‡†å¤‡ (13:58)\n5-2 ç”Ÿæˆè¯ä¹¦ (10:58)\n5-3 kuberneteså„ç»„ä»¶çš„è®¤è¯é…ç½® (04:31)\n5-4 éƒ¨ç½²etcdé›†ç¾¤ (04:08)\n5-5 éƒ¨ç½²kubernetesæ§åˆ¶å¹³é¢ (08:16)\n5-6 éƒ¨ç½²kuberneteså·¥ä½œèŠ‚ç‚¹ (13:38)\n5-7 ç½‘ç»œæ’ä»¶-Calico_1 (06:00)\n5-8 DNSæ’ä»¶-CoreDNS (04:40)\n5-9 é›†ç¾¤å†’çƒŸæµ‹è¯• (06:36) ç¬¬6ç«  ä¸šåŠ¡ç³»ç»Ÿè¿ç§»kubernetes\u0026mdash;å‡†å¤‡å·¥ä½œã€ä¸ºå¹³ç¨³è¿ç§»åšå¥½å‚¨å¤‡ã€‘6 èŠ‚ | 90åˆ†é’Ÿ æ­å»ºå®Œé›†ç¾¤è¿˜ä¸èƒ½é©¬ä¸Šè¿ç§»ä¸šåŠ¡ï¼Œæœ¬ç« ä¸­å°†è®²è§£è¿ç§»å‰çš„ä¸€äº›å‡†å¤‡å·¥ä½œï¼šåŒ…æ‹¬é•œåƒä»“åº“harborçš„å…¥é—¨å’Œéƒ¨ç½²ã€å¯¹kubernetesæœåŠ¡å‘ç°æ–¹æ¡ˆçš„å­¦ä¹ åˆ†æä»¥åŠingress-nginxæœåŠ¡å‘ç°æ–¹æ¡ˆçš„éƒ¨ç½²ã€‚\n6-1 Harborå…¥é—¨ (17:06)\n6-2 Harboré«˜å¯ç”¨éƒ¨ç½²ï¼ˆä¸Šï¼‰ (11:50)\n6-3 Harboré«˜å¯ç”¨éƒ¨ç½²ï¼ˆä¸‹ï¼‰ (12:21)\n6-4 kubernetesçš„æœåŠ¡å‘ç° é›†ç¾¤å†…éƒ¨\né›†ç¾¤å†…-\u0026gt; é›†ç¾¤å¤–\né›†ç¾¤å¤–-\u0026gt; é›†ç¾¤å†…\n6-5 éƒ¨ç½²ingress-nginxï¼ˆä¸Šï¼‰ (14:52)\n6-6 éƒ¨ç½²ingress-nginxï¼ˆä¸‹ï¼‰ (13:36) ç¬¬7ç«  ä¸šåŠ¡ç³»ç»Ÿè¿ç§»kubernetes\u0026mdash;æœ€ä½³å®è·µã€å¤šç±»å‹ä¸šåŠ¡è¿ç§»è½åœ°ã€‘7 èŠ‚ | 86åˆ†é’Ÿ æœ¬ç« ä¸­å°†åˆ†æå¦‚ä½•å°†édockerä¸šåŠ¡è¿ç§»åˆ°dockerã€ä½¿dockeræœåŠ¡è¿è¡Œåœ¨kubernetesä¸­ï¼Œä»¥åŠåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚åŒæ—¶ä¹Ÿä¼šä»‹ç»ï¼Œå°†å®šæ—¶ä»»åŠ¡ã€ä¼ ç»Ÿçš„webæœåŠ¡ã€springbootçš„webæœåŠ¡è¿˜æœ‰dubboæœåŠ¡è¿ç§»éƒ¨ç½²åœ¨kubernetesä¸­çš„å…¨è¿‡ç¨‹ã€‚\n7-1 å®šæ—¶ä»»åŠ¡è¿ç§»kubernetes (21:56)\næœåŠ¡åšåˆ°é•œåƒé‡Œ\nåŸºç¡€é•œåƒ æå®šæœåŠ¡è¿è¡Œçš„ç›¸å…³æ–‡ä»¶ æ„å»ºé•œåƒ Dockerfile åˆ¶ä½œK8sæœåŠ¡ï¼Œå¹¶è°ƒåº¦\nç¡®å®šæœåŠ¡å‘ç°çš„ç­–ç•¥ ç¼–å†™K8sé…ç½® å›¾æ–‡ï¼š 7-2 ã€ä¸ç†Ÿæ‚‰SpringBootçš„ç­’å­çœ‹è¿‡æ¥ã€‘SpringBootå¿«é€Ÿå…¥é—¨\n7-3 springbootçš„webæœåŠ¡è¿ç§»kubernetes (11:29) å›¾æ–‡ï¼š 7-4 ã€ä¸ç†Ÿæ‚‰Dubboçš„ç­’å­çœ‹è¿‡æ¥ã€‘Dubboå¿«é€Ÿå…¥é—¨\n7-5 ä¼ ç»ŸdubboæœåŠ¡è¿ç§»kubernetesï¼ˆä¸Šï¼‰ (16:22)\n7-6 ä¼ ç»ŸdubboæœåŠ¡è¿ç§»kubernetesï¼ˆä¸‹ï¼‰ (16:08)\n7-7 ä¼ ç»ŸwebæœåŠ¡è¿ç§»kubernetes (19:40) ç¬¬8ç«  CICDå®è·µã€åªä¼šè¿ç§»è¿˜ä¸å¤Ÿï¼ŒæŒç»­é›†æˆèµ°èµ·ã€‘5 èŠ‚ | 70åˆ†é’Ÿ æœ¬ç« å°†è®²è§£å¦‚ä½•è®©æœåŠ¡å¯ä»¥åœ¨kubernetesé‡Œé¢å®ç°æŒç»­é›†æˆã€‚é€æ­¥å®ç°gitlabç®¡ç†ä»£ç ã€mavenæ„å»ºã€dockerå®ç°é•œåƒçš„æ„å»ºã€æ¨é€åˆ°harborä»“åº“ä»¥åŠé€šè¿‡è„šæœ¬è·Ÿkuberneteså¯¹æ¥å®ŒæˆæŒç»­å‘å¸ƒã€‚æœ€åè¿˜ä¼šåº”ç”¨jenkinsé€šè¿‡pipelineæ•´åˆæ•´ä¸ªæµç¨‹å®ç°CICDã€‚\u0026hellip;\n8-1 kubernetesä¸cicd (12:41)\n8-2 cicdå®è·µï¼ˆ1ï¼‰ (12:56)\n8-3 cicdå®è·µï¼ˆ2ï¼‰ (13:26)\n8-4 cicdå®è·µï¼ˆ3ï¼‰ (13:31)\n8-5 cicdå®è·µï¼ˆ4ï¼‰ (17:18)\nç¬¬9ç«  æ·±å…¥kubernete\u0026mdash;å‡ ä¸ªé‡è¦çš„èµ„æºå¯¹è±¡ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨\u0026amp;è£…é€¼å¯é€‰åŒ…ã€‘4 èŠ‚ | 83åˆ†é’Ÿ æœ¬ç« ä¸­ä»‹ç»äº†kubernetesçš„é‡è¦èµ„æºï¼šnamespaceã€resourceså’Œlabelã€‚ è®²è§£å¹¶å®è·µäº†ï¼Œå‘½åç©ºé—´å¯¹èµ„æºå¯¹è±¡å’Œèµ„æºé…é¢å¤šå±‚é¢çš„éš”ç¦»æœºåˆ¶ã€podèµ„æºé™åˆ¶çš„é…ç½®æ–¹å¼ã€podåœ¨èŠ‚ç‚¹èµ„æºç´§ç¼ºæ—¶çš„é©±é€æœºåˆ¶ã€labelä½œç”¨äºä¸åŒèµ„æºå¯¹è±¡ä¸Šçš„ä¸åŒçš„ä½œç”¨ç­‰æ ¸å¿ƒçŸ¥è¯†ã€‚ \u0026hellip;\n9-1 Namespace \u0026mdash; é›†ç¾¤çš„å…±äº«ä¸éš”ç¦» åˆ›å»ºä¸€ä¸ªnamespace\n1apiVersion: v1 2kind: Namespace 3metadata: 4 name: dev 9-2 Resources\u0026mdash;å¤šç»´åº¦é›†ç¾¤èµ„æºç®¡ç†ï¼ˆä¸Šï¼‰ (22:45)\n9-3 Resources\u0026mdash;å¤šç»´åº¦é›†ç¾¤èµ„æºç®¡ç†ï¼ˆä¸‹ï¼‰ (22:26)\n9-4 Label\u0026mdash;å°æ ‡ç­¾å¤§ä½œä¸º (19:31) ç¬¬10ç«  æ·±å…¥kubernete\u0026mdash;æœåŠ¡è°ƒåº¦ä¸ç¼–æ’ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨\u0026amp;è£…é€¼å¯é€‰åŒ…ã€‘6 èŠ‚ | 121åˆ†é’Ÿ æœ¬ç« ä¸­ä¸»è¦å›´ç»•æœåŠ¡çš„è°ƒåº¦ä¸ç¼–æ’è®²è§£è®²è§£å¹¶å®è·µäº†ï¼špodçš„å¥åº·æ£€æŸ¥çš„å‚æ•°é…ç½®åŠå½±å“ã€è°ƒåº¦å™¨çš„æ•´ä½“å·¥ä½œåŸç†ä»¥åŠå¸¸è§çš„é¢„é€‰ç­–ç•¥å’Œä¼˜é€‰ç­–ç•¥ã€å¦‚ä½•åˆ©ç”¨kubernetesæœ¬èº«çš„æœºåˆ¶å®Œæˆä¸åŒçš„éƒ¨ç½²æ–¹å¼ã€‚\n10-1 å¥åº·æ£€æŸ¥\u0026mdash;é«˜å¯ç”¨çš„å®ˆæŠ¤è€… (23:06)\n10-2 Scheduler\u0026mdash; ç©è½¬podè°ƒåº¦ï¼ˆä¸Šï¼‰ (13:57)\n10-3 Scheduler \u0026mdash; ç©è½¬podè°ƒåº¦ï¼ˆä¸‹ï¼‰ (13:49)\n10-4 éƒ¨ç½²ç­–ç•¥è¯¦è§£ \u0026mdash; é‡å»ºã€æ»šåŠ¨ã€è“ç»¿ã€é‡‘ä¸é›€ (26:11)\n10-5 æ·±å…¥Pod - podç›¸å…³çš„ç‚¹ç‚¹æ»´æ»´ï¼ˆä¸Šï¼‰ (21:24)\n10-6 æ·±å…¥Pod - podç›¸å…³çš„ç‚¹ç‚¹æ»´æ»´ï¼ˆä¸‹ï¼‰ (22:04) ç¬¬11ç«  æ·±å…¥kubernete\u0026mdash; è½åœ°å®è·µæ·±å…¥ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨\u0026amp;è£…é€¼å¯é€‰åŒ…ã€‘7 èŠ‚ | 123åˆ†é’Ÿ æœ¬ç« ä¸»è¦ä»kubernetesè½åœ°çš„è§’åº¦è¿›è¡Œæ·±å…¥è®²è§£ï¼Œåˆ†åˆ«ä»‹ç»ï¼šingressåœ¨è½åœ°è¿‡ç¨‹å¯èƒ½é‡åˆ°çš„é—®é¢˜ä¸åº”å¯¹æ–¹å¼ã€åŸºäºglusterfsçš„å…±äº«å­˜å‚¨ã€kubernetes apiçš„è®¾è®¡ï¼Œå¹¶ä»¥ä¸€ä¸ªçœŸå®çš„ç¤ºä¾‹é¡¹ç›®è®©å¤§å®¶çœ‹åˆ°å®¹å™¨ç®¡ç†å¹³å°å¯ä»¥åšæˆä»€ä¹ˆæ ·å­çš„ã€‚\n11-1 ingress \u0026mdash; å››å±‚ä»£ç†ã€sessionä¿æŒã€å®šåˆ¶é…ç½®ã€æµé‡æ§åˆ¶ï¼ˆä¸Šï¼‰ (17:42)\n11-2 ingress \u0026ndash; å››å±‚ä»£ç†ã€sessionä¿æŒã€å®šåˆ¶é…ç½®ã€æµé‡æ§åˆ¶ï¼ˆä¸­ï¼‰ (17:18)\n11-3 ingress \u0026mdash; å››å±‚ä»£ç†ã€sessionä¿æŒã€å®šåˆ¶é…ç½®ã€æµé‡æ§åˆ¶ï¼ˆä¸‹ï¼‰ (16:42)\n11-4 å…±äº«å­˜å‚¨ \u0026mdash; PVã€PVCå’ŒStorageClassï¼ˆä¸Šï¼‰.mp4 (16:13)\n11-5 å…±äº«å­˜å‚¨ \u0026mdash; PVã€PVCå’ŒStorageClassï¼ˆä¸‹ï¼‰ (16:04)\n11-6 StatefulSet \u0026mdash; æœ‰çŠ¶æ€åº”ç”¨çš„å®ˆæŠ¤è€… (18:47)\n11-7 KubernetesAPI \u0026mdash;å¦‚ä½•å¼€å‘ä¸€ä¸ªåŸºäºkubernetesçš„å®¹å™¨ç®¡ç†å¹³å° (19:38) ç¬¬12ç«  æ·±å…¥kubernete\u0026mdash;æ—¥å¿—å’Œç›‘æ§ã€é€è¿‡è¡¨è±¡çœ‹æœ¬è´¨\u0026amp;è£…é€¼å¯é€‰åŒ…ã€‘10 èŠ‚ | 131åˆ†é’Ÿ æœ¬ç« ä¸­å°†ä»‹ç»K8Sä½¿ç”¨è€…å¿…é¡»è€ƒè™‘çš„é‡é‡çº§é—®é¢˜ï¼šæ—¥å¿—ä¸ç›‘æ§ã€‚è¯¾ç¨‹ä¸­ä¼šåˆ†æå½“ä¸‹ä¸»æµçš„æ—¥å¿—å¤„ç†æ–¹æ¡ˆå¹¶é€‰æ‹©ä¸€ç§æ–¹æ¡ˆè¿›è¡Œæ—¥å¿—ä»é‡‡é›†åˆ°å±•ç¤ºçš„å®Œæ•´å®è·µï¼›ä¼šè®²è§£ä¸»æµk8sç›‘æ§æ–¹æ¡ˆprometheusï¼ŒåŒ…æ‹¬å®ƒçš„å®ç°åŸç†ï¼Œæ”¯æŒçš„å„ç§æŒ‡æ ‡ç­‰ã€‚\n12-1 å¸¸è§æ—¥å¿—é‡‡é›†é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆåˆ†æ (08:41)\n12-2 logpilot+elasticsearch+kibanaæ—¥å¿—å®è·µ (19:26)\n12-3 ç›‘æ§å…¥é—¨\u0026mdash;ä»æ•´ä½“æŠŠæ¡ç›‘æ§ (07:39)\n12-4 Prometheuså…¥é—¨\u0026mdash;æ¶æ„å’ŒåŸç† (11:45)\n12-5 éƒ¨ç½²å‰å¥ - Helm \u0026amp; Operator (10:31)\n12-6 ç›‘æ§éƒ¨ç½²å®æˆ˜ - Helm+PrometheusOperator (19:30)\n12-7 ç›‘æ§è½åœ° - æŒ‡æ ‡å®Œå–„ã€Grafanaçœ‹æ¿å’Œé‚®ä»¶æŠ¥è­¦ï¼ˆä¸Šï¼‰ (17:16)\n12-8 ç›‘æ§è½åœ° - æŒ‡æ ‡å®Œå–„ã€Grafanaçœ‹æ¿å’Œé‚®ä»¶æŠ¥è­¦ï¼ˆä¸­ï¼‰ (17:28)\n12-9 ç›‘æ§è½åœ° - æŒ‡æ ‡å®Œå–„ã€Grafanaçœ‹æ¿å’Œé‚®ä»¶æŠ¥è­¦ï¼ˆä¸‹ï¼‰ (18:21) å›¾æ–‡ï¼š 12-10 ã€æ­¥éª¤æ€»ç»“ï¼Œä¾¿äºå¿«é€Ÿå›é¡¾ã€‘Helméƒ¨ç½²æ–‡æ¡£\nç¬¬13ç«  ServiceMeshä»£è¡¨ä½œistio æœ¬ç« ä¸­æˆ‘ä»¬ä¼šä»istioçš„æ¶æ„è®¾è®¡å¼€å§‹è®©ä½ å¯¹å®ƒçš„å®ç°åŸç†æœ‰æ·±å…¥äº†è§£ï¼Œå¹¶ä¼šéƒ¨ç½²å®Œæ•´çš„istioç¯å¢ƒï¼Œä»æ¶æ„ä¸Šè®©æˆ‘ä»¬çš„æœåŠ¡è‡ªåŠ¨æ”¯æŒistioçš„åŠŸèƒ½ï¼Œæœ€åä½¿ç”¨å‡ ä¸ªistioçš„å¸¸è§å·¥å…·é›†å®ç°æ•°æ®å±•ç°ã€‚\n13-1 ä»€ä¹ˆæ˜¯ServiceMeshï¼Ÿä»€ä¹ˆæ˜¯Istioï¼Ÿ (04:51)\nå¾®æœåŠ¡æ¶æ„\nè®¾ä¹ˆæ˜¯ServiceMesh\næœåŠ¡ç½‘æ ¼ æ˜¯æ¦‚å¿µä¸æ˜¯äº§å“ è§£å†³ç½‘ç»œå±‚é¢çš„é—®é¢˜ æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€è·¯ç”±ã€æµé‡æ§åˆ¶ã€æœåŠ¡é—´é€šä¿¡çš„å¯é æ€§ã€ç›‘æ§\u0026mdash;- API ç½‘å…³ï¼Ÿ\nLinkerd\nå§‹äº2016å¹´CNCFå®˜æ–¹é¡¹ç›®\n1.x åŸºäºèŠ‚ç‚¹(è™šæ‹Ÿæœºã€ç‰©ç†æœº)\n2.x åŸºäºkubernetes(conduit)\nIstio\nGoogle/IBM/Lyft å‘èµ·çš„å¼€æºé¡¹ç›®ï¼Œ17å¹´æ¨å‡ºï¼Œ18å¹´7æœˆå‘å¸ƒ1.0ã€å¤šå¹³å°æ”¯æŒ\néƒ½æ˜¯åŸºäºsidecaræ¨¡å¼\néƒ½åˆ†ä¸ºæ•°æ®å±‚å’Œæ§åˆ¶å±‚\nIstio æ›´å—æ¬¢è¿\nPilot -\u0026gt; envoy æä¾›ä¿¡æ¯ï¼ŒæœåŠ¡å‘ç°ï¼Œ ABæµ‹è¯•\nMixerï¼šç­–ç•¥(è®¿é—®æ§åˆ¶)ã€é¥æµ‹(æ•°æ®æ”¶é›†å’Œæ±‡æŠ¥ï¼ŒæœåŠ¡ä¹‹é—´æµè½¬çš„æ•°æ®)\nGalley: é…ç½®ç®¡ç†ä¸­å¿ƒ\nCitadelï¼š å®‰å…¨\næ•…éšœæ’æŸ¥ï¼š\nè¯·æ±‚åœ¨å“ªå¤±è´¥çš„ï¼ŒAæœ‰è°ƒç”¨Bå—\nä¸ºä»€ä¹ˆç”¨æˆ·è¯·æ±‚/é¡µé¢hungä½äº†\nä¸ºä»€ä¹ˆç³»ç»Ÿç»„ä»¶è¿™ä¹ˆæ…¢ï¼Ÿé‚£ä¸ªç»„ä»¶æœ€æ…¢ï¼Ÿ\nåº”ç”¨å®¹é”™æ€§\nå®¢æˆ·ç«¯æ²¡æœ‰è®¾ç½®timeoutå¯¼è‡´åº”ç”¨å¡ä½\næ²¡æœ‰é‡è¯•æœºåˆ¶ï¼ŒæŸä¸ªæœåŠ¡å¶å°”å¼‚å¸¸å¯¼è‡´ç”¨æˆ·é¡µé¢é”™è¯¯\næŸäº›èŠ‚ç‚¹å¼‚å¸¸ï¼Œå¯¼è‡´æœåŠ¡å“åº”æ—¶é—´è¿‡é•¿\nåº”ç”¨å‡çº§å‘å¸ƒ\næ–°ç‰ˆæœ¬ä¸€æ¬¡æ€§å‡çº§ï¼Œä¸€æ—¦å‡ºé”™å½±å“èŒƒå›´å¾ˆå¤§\næ— æ³•è¿›è¡ŒABæµ‹è¯•ï¼Œæ ¹æ®ç”¨æˆ·å±æ€§è®¿é—®ä¸åŒç‰ˆæœ¬\næœåŠ¡ç‰ˆæœ¬çš„ä¾èµ–å…³ç³»å¤„ç†ä¸å½“å¯¼è‡´æœåŠ¡ä¸å¯ç”¨\nç³»ç»Ÿå®‰å…¨\næœåŠ¡éƒ½æ˜¯HTTPè€Œéhttps\næ²¡æœ‰æµé‡é™åˆ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥å¯¹æœåŠ¡å‘èµ·æ”»å‡»\n13-2 Istioæ¶æ„å’ŒåŸç† (11:41)\n13-3 éƒ¨ç½²istio\n13-4 éƒ¨ç½²BookInfoç¤ºä¾‹åº”ç”¨ (11:38)\n13-5 é…ç½®è¯·æ±‚è·¯ç”± (08:47)\n13-6 æ•…éšœæ³¨å…¥ (07:38)\n13-7 æµé‡è½¬ç§» (09:27)\n13-8 è®¾ç½®è¯·æ±‚è¶…æ—¶ (03:16)\n13-9 ç†”æ–­ (08:44)\n13-10 æµé‡é•œåƒ (05:58)\n13-11 Istioä¸­çš„Prometheuså’ŒGrafana (11:44)\n13-12 åˆ†å¸ƒå¼è¿½è¸ªJaeger (09:29)\n13-13 ç½‘æ ¼å¯è§†åŒ– (10:59) ç¬¬14ç«  è¯¾ç¨‹æ€»ç»“ã€æ²‰æ·€\u0026amp;å±•æœ›ã€‘1 èŠ‚ | 6åˆ†é’Ÿ æœ¬ç« ä¸­å°†æ€»ç»“æœ¬è¯¾ç¨‹æ‰€å­¦çŸ¥è¯†ï¼Œå±•æœ›dockerå’Œkubernetesçš„å‘å±•ã€‚\nhttps://www.youtube.com/watch?v=2b7MRI6tmMo\u0026list=PLsbVibQXuLjqZwdpSBXR27gNGgtHlQLHR\u0026index=2\nhttps://www.youtube.com/watch?v=8MlW9nixkwk\u0026list=PLsbVibQXuLjqw6mCC4QMyLZ282dhdPWr3\u0026index=13\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/1-k8s-cloudnative/","summary":"Kubenetesç”Ÿäº§è½åœ°å…¨ç¨‹å®è·µ\næ ¸å¿ƒæ¦‚å¿µ\næ¶æ„è®¾è®¡\nè®¤è¯æˆæƒ\né«˜å¯ç”¨é›†ç¾¤æ­å»º\näºŒè¿›åˆ¶\u0026amp; kubeadm\n3å°masterä¸¤å°2 node\ncalicoã€corednsã€dashboard\nä¸šåŠ¡è¿ç§»åˆ°Kubenetes\nHarbor\næœåŠ¡å‘ç°ç­–ç•¥\nIngressNginx\nDocker åŒ–æœåŠ¡ã€K8sã€æœåŠ¡å‘ç°\nCICD\nnamespaceã€resourcesã€label\næœåŠ¡çš„è°ƒåº¦ä¸ç¼–æ’\nå¥åº·æ£€æŸ¥\nè°ƒåº¦ç­–ç•¥\néƒ¨ç½²ç­–ç•¥\næ—¥å¿—ä¸ç›‘æ§\nç¬¬2ç«  kuberneteså¿«é€Ÿå…¥é—¨ æœ¬ç« ä¸­å°†ä»æ ¸å¿ƒæ¦‚å¿µã€æ¶æ„è®¾è®¡ã€è®¤è¯æˆæƒä»¥åŠé›†ç¾¤æ­å»ºæ–¹æ¡ˆå¯¹æ¯”å‡ æ–¹é¢ï¼Œå¸¦é¢†å¤§å®¶å¿«é€ŸæŒæ¡kubernetesçš„é‡è¦çŸ¥è¯†ç‚¹ï¼ŒåŠ©åŠ›å¿«é€Ÿå…¥é—¨ã€‚\n2-1 äº†è§£kubernetes èˆµæ‰‹ï¼š æ¸”ç½‘ã€æ¸”èˆ¹ docker : é²¸é±¼ï¼Œé›†è£…ç®± ğŸ³\nKubernetes is an open-source system for automating deployment, scaling, and management of containerized applications.\nIt groups containers that makeup application in to logical units for easy management and discovery.Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community.","tags":null,"title":"K8s Cloud Native"},{"categories":null,"contents":"ç»™Podä¼ é€’å‚æ•° é€šè¿‡ç¯å¢ƒå˜é‡ç»™Podä¼ é€’å‚æ•° å¯ä»¥åœ¨containerçš„æè¿°æ–‡ä»¶ä¸­åŠ å…¥ä¸€ä¸ªenvçš„å‚æ•°ï¼Œå€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯é”®å€¼å¯¹ï¼Œå€¼æ˜¯stringã€‚\n1--- 2apiVersion: v1 3kind: Pod 4metadata: 5 name: first-pod 6 labels: 7 app: nginx 8spec: 9 containers: 10 - name: 00-simple-pod-nginx 11 image: nginx:1.17.0 12 env: 13 - name: INTERVAL 14 value: 30s é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç»™Podä¼ é€’å‚æ•° åŠ å…¥ä¸€ä¸ªargsé…ç½®ï¼Œå‘½ä»¤è¡Œå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/9-k8s-configmap/","summary":"ç»™Podä¼ é€’å‚æ•° é€šè¿‡ç¯å¢ƒå˜é‡ç»™Podä¼ é€’å‚æ•° å¯ä»¥åœ¨containerçš„æè¿°æ–‡ä»¶ä¸­åŠ å…¥ä¸€ä¸ªenvçš„å‚æ•°ï¼Œå€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯é”®å€¼å¯¹ï¼Œå€¼æ˜¯stringã€‚\n1--- 2apiVersion: v1 3kind: Pod 4metadata: 5 name: first-pod 6 labels: 7 app: nginx 8spec: 9 containers: 10 - name: 00-simple-pod-nginx 11 image: nginx:1.17.0 12 env: 13 - name: INTERVAL 14 value: 30s é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç»™Podä¼ é€’å‚æ•° åŠ å…¥ä¸€ä¸ªargsé…ç½®ï¼Œå‘½ä»¤è¡Œå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„","tags":null,"title":"K8s ConfigMap"},{"categories":null,"contents":"NodeExporter ç”¨äºé‡‡é›†ä¸€ä¸ªHostä¸Šçš„å„ç§æ€§èƒ½æŒ‡æ ‡ï¼Œå¹¶ä¸”æš´éœ²ç»™Prometheus é‡‡é›†ã€‚å› ä¸ºNodeExporteréœ€è¦é‡‡é›†æ¯ä¸€ä¸ªHostçš„æ•°æ®çŠ¶æ€ï¼Œæ‰€ä»¥å°±äº§ç”Ÿäº†ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨æ¯ä¸€ä¸ªK8sçš„æœºå™¨ä¸Šéƒ½è¦è¿è¡Œä¸€ä¸ªPod, è€Œå®ç°è¿™ä¸ªéœ€æ±‚çš„K8sèµ„æºç±»å‹å°±å«åšDaemonSetã€‚\nDaemonSet DaemonSetçš„åŠŸèƒ½å°±æ˜¯ä¿è¯æ¯ä¸ªNodeéƒ½è¿è¡ŒPodï¼Œ ä½†æ˜¯å¦‚æœæŸä¸ªK8sçš„Nodeä¸‹çº¿ä¹‹åï¼Œå¯¹åº”çš„Podä¹Ÿä¸‹çº¿ï¼Œè¿˜æ˜¯ä¿æŒæ¯ä¸ªNodeä¸€ä¸ªPodã€‚å¦‚æœæ–°å¢ä¸€ä¸ªNodeï¼Œå°±ä¼šåœ¨æ–°å¢çš„Nodeä¸­å¢åŠ ä¸€ä¸ªPodï¼Œä¿è¯æ‰€æœ‰çš„Nodeä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªå½“å‰Podã€‚\n1--- 2apiVersion: apps/v1 3kind: DaemonSet 4metadata: 5 name: node-exporter 6 namespace: kube-system 7 labels: 8 k8s-app: node-exporter 9 kubernetes.io/cluster-service: \u0026#34;true\u0026#34; 10 addonmanager.kubernetes.io/mode: Reconcile 11 version: v1.2.2 12spec: 13 selector: 14 matchLabels: 15 k8s-app: node-exporter 16 version: v1.2.2 17 updateStrategy: 18 type: OnDelete 19 template: 20 metadata: 21 labels: 22 k8s-app: node-exporter 23 version: v1.2.2 24 spec: 25 priorityClassName: system-node-critical 26 containers: 27 - name: prometheus-node-exporter 28 image: \u0026#34;prom/node-exporter:v1.2.2\u0026#34; 29 imagePullPolicy: \u0026#34;IfNotPresent\u0026#34; 30 args: 31 - --path.procfs=/host/proc 32 - --path.sysfs=/host/sys 33 ports: 34 - name: metrics 35 containerPort: 9100 36 hostPort: 9100 37 volumeMounts: 38 - name: proc 39 mountPath: /host/proc 40 readOnly: true 41 - name: sys 42 mountPath: /host/sys 43 readOnly: true 44 resources: 45 limits: 46 memory: 50Mi 47 requests: 48 cpu: 100m 49 memory: 50Mi 50 hostNetwork: true 51 hostPID: true 52 volumes: 53 - name: proc 54 hostPath: 55 path: /proc 56 - name: sys 57 hostPath: 58 path: /sys NodeExporteræ˜¯é’ˆå¯¹Nodeçš„Podï¼Œéœ€è¦å°†Hostä¸­çš„ä¸€äº›ç³»ç»Ÿæ–‡ä»¶é€ä¼ ç»™Podï¼Œå¹¶è®©Podä½¿ç”¨ä¸»æœºç½‘ç»œã€‚\né¢å¤–éœ€æ±‚\nè™½ç„¶æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œä¸€ä¸ªPodæ˜¯ä¸€ä¸ªç¡®å®å­˜åœ¨çš„éœ€æ±‚ï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™ï¼Œå´åˆä¸æ˜¯è¦æ±‚æ¯ä¸ªNodeéƒ½æœ‰ä¸€ä¸ªPodã€‚ä¾‹å¦‚ï¼Œæœ‰10å°æœºå™¨ç”¨äºè¿è¡ŒHDFSã€‚ HDFSæœ‰NameNodeå’ŒDataNodeä¹‹åˆ†ï¼Œé‚£ä¹ˆDataNodeå¯èƒ½æ˜¯æ¯ä¸ªHostéƒ½è¦æœ‰çš„ï¼Œä½†æ˜¯NameNodeå´ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯èƒ½åªè¦3-5å°å°±å¯ä»¥äº†ã€‚è¿™æ ·ä¸€ä¸ªæ˜æ˜¾çš„å¥½å¤„å°±æ˜¯å¯ä»¥èŠ‚çº¦æˆæœ¬ã€‚\nDaemonSet ä¹Ÿæ˜¯æ”¯æŒSelectorçš„ï¼Œè€Œä¸”æ˜¯NodeSelectorï¼Œé€šè¿‡æˆ‘ä»¬ç»™NodeåŠ ä¸Šä¸€äº›Labelï¼Œç„¶åç»™NameNodeåŠ ä¸Šä¸€äº›DaemonSetçš„NodeSelectorã€‚\n1spec: 2 selector: 3 matchLabels: 4 k8s-app: hdfs-namenode 5 updateStrategy: 6 type: OnDelete 7 template: 8 metadata: 9 labels: 10 k8s-app: hdfs-namenode 11 spec: 12 # node selector 13 nodeSelector: 14 host: high-cpu è¿™æ ·å°±ä¿è¯äº†Podåªä¼šåœ¨ç‰¹å®šçš„Hostä¸­ä»¥DaemonSetçš„ç‰¹æ€§å¯åŠ¨\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/7-k8s-daemonset/","summary":"NodeExporter ç”¨äºé‡‡é›†ä¸€ä¸ªHostä¸Šçš„å„ç§æ€§èƒ½æŒ‡æ ‡ï¼Œå¹¶ä¸”æš´éœ²ç»™Prometheus é‡‡é›†ã€‚å› ä¸ºNodeExporteréœ€è¦é‡‡é›†æ¯ä¸€ä¸ªHostçš„æ•°æ®çŠ¶æ€ï¼Œæ‰€ä»¥å°±äº§ç”Ÿäº†ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨æ¯ä¸€ä¸ªK8sçš„æœºå™¨ä¸Šéƒ½è¦è¿è¡Œä¸€ä¸ªPod, è€Œå®ç°è¿™ä¸ªéœ€æ±‚çš„K8sèµ„æºç±»å‹å°±å«åšDaemonSetã€‚\nDaemonSet DaemonSetçš„åŠŸèƒ½å°±æ˜¯ä¿è¯æ¯ä¸ªNodeéƒ½è¿è¡ŒPodï¼Œ ä½†æ˜¯å¦‚æœæŸä¸ªK8sçš„Nodeä¸‹çº¿ä¹‹åï¼Œå¯¹åº”çš„Podä¹Ÿä¸‹çº¿ï¼Œè¿˜æ˜¯ä¿æŒæ¯ä¸ªNodeä¸€ä¸ªPodã€‚å¦‚æœæ–°å¢ä¸€ä¸ªNodeï¼Œå°±ä¼šåœ¨æ–°å¢çš„Nodeä¸­å¢åŠ ä¸€ä¸ªPodï¼Œä¿è¯æ‰€æœ‰çš„Nodeä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªå½“å‰Podã€‚\n1--- 2apiVersion: apps/v1 3kind: DaemonSet 4metadata: 5 name: node-exporter 6 namespace: kube-system 7 labels: 8 k8s-app: node-exporter 9 kubernetes.io/cluster-service: \u0026#34;true\u0026#34; 10 addonmanager.kubernetes.io/mode: Reconcile 11 version: v1.2.2 12spec: 13 selector: 14 matchLabels: 15 k8s-app: node-exporter 16 version: v1.2.2 17 updateStrategy: 18 type: OnDelete 19 template: 20 metadata: 21 labels: 22 k8s-app: node-exporter 23 version: v1.2.2 24 spec: 25 priorityClassName: system-node-critical 26 containers: 27 - name: prometheus-node-exporter 28 image: \u0026#34;prom/node-exporter:v1.","tags":null,"title":"K8s DaemonSet"},{"categories":null,"contents":"è“ç»¿éƒ¨ç½² è“ç»¿éƒ¨ç½²æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„éƒ¨ç½²æ–¹å¼ï¼Œç»å¸¸ä¼šç”¨äºæ–°æ—§ç‰ˆæœ¬ä¸å…¼å®¹çš„æƒ…å†µã€‚\nå…ˆå°†æ–°ç‰ˆæœ¬(ç»¿ç‰ˆ)çš„æœåŠ¡è¿è¡Œèµ·æ¥ã€‚ å°†æ‰€æœ‰çš„æµé‡åˆ‡åˆ°æ–°ç‰ˆæœ¬çš„æœåŠ¡ä¸Š åˆ é™¤æ—§ç‰ˆæœ¬(è“ç‰ˆ)çš„æœåŠ¡ åˆ›å»ºæ–°ç‰ˆæœ¬çš„ReplicaSetï¼Œå°†ServiceæŒ‡å‘æ–°çš„Podsï¼Œåˆ é™¤æ—§ç‰ˆæœ¬çš„ReplicaSet\næ»šåŠ¨å‡çº§ è“ç»¿éƒ¨ç½²å¯ä»¥æœ‰æ•ˆä¿è¯ä¸šåŠ¡çš„æ­£ç¡®æ€§ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„é£é™©ï¼Œä¾‹å¦‚ç¨³å®šæ€§ã€‚\nå‡è®¾æ–°éƒ¨ç½²çš„åº”ç”¨æ˜¯æœ‰é—®é¢˜çš„ï¼Œä¸€æ—¦åˆ‡æ¢ä¹‹åå°±ä¼šå¯¼è‡´ä¸šåŠ¡çš„å´©æºƒï¼Œé€ æˆæŸå¤±ã€‚äºæ˜¯å°±æœ‰äº†ç¨å¾®å‹å¥½çš„å‡çº§æ–¹å¼ï¼Œæ»šåŠ¨å‡çº§ã€‚\nå…ˆå…³é—­ä¸€ä¸ªæ—§ç‰ˆæœ¬çš„å®ä¾‹ å¼€å¯ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„å®ä¾‹ç”¨äºæ›¿æ¢æ—§ç‰ˆæœ¬ æ›¿æ¢æˆåŠŸæ—¶å€™å¾ªç¯1å’Œ2ï¼Œç›´åˆ°æ‰€æœ‰çš„å®ä¾‹å‡çº§å®Œæˆã€‚ åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸­é€”å‘ç°å¼‚å¸¸å¯ä»¥åŠæ—¶åœæ‰‹ï¼ŒåŠæ—¶æ­¢æŸã€‚è€Œä¸”Kubernetesä¹Ÿåœ¨å®¢æˆ·ç«¯ä¸­æ”¯æŒäº†è¿™ä¸ªç‰¹æ€§ã€‚kubectl rolling-updateã€‚\nå‡çº§å‰åRCçš„Selectoréƒ½è¢«æ”¹å˜äº† æ“ä½œéƒ½æ˜¯åœ¨å®¢æˆ·ç«¯æ‰§è¡Œçš„ï¼Ÿ é‡‘ä¸é›€å‘å¸ƒ é‡‘ä¸é›€å‘å¸ƒæ˜¯æ»šåŠ¨å‘å¸ƒçš„ä¸€ç§ç‰¹ä¾‹ï¼Œåœ¨æ»šåŠ¨å‘å¸ƒä¸­ï¼Œæ˜¯ä¸ä¼šç­‰å¾…çš„ï¼Œé™¤éä¸­é—´å‡ºé”™äº†ã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦å…¨éƒ½å‡çº§ï¼Œå¯èƒ½åªæ˜¯å¤„äºPOCçš„ä¸€äº›åŸå› ï¼Œæˆ‘ä»¬åªå¸Œæœ›éƒ¨åˆ†å®ä¾‹æ˜¯æ–°çš„ï¼Œå¤§éƒ¨åˆ†æ˜¯æ—§çš„ï¼Œè€Œè¿™ç§æƒ…å½¢ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºé‡‘ä¸é›€å‘å¸ƒã€‚\nå‡çº§å°‘éƒ¨åˆ†å®ä¾‹ æŸ¥çœ‹æ•ˆæœï¼Œå¦‚æœå¥½ï¼Œå…¨éƒ¨å‡çº§ å¦‚æœä¸å¥½ï¼Œåˆ™ä¸å‡çº§ å£°æ˜å¼å‡çº§ å‰é¢ä»‹ç»çš„è¿™äº›å‡çº§å‘å¸ƒæ–¹å¼åœ¨K8sä¸Šå¾ˆå¤šæ—¶å€™æ˜¯åŠæ‰‹å·¥æ–¹å¼æ‰§è¡Œçš„ï¼Œè€ŒKubernetesä½œä¸ºä¸€æ¬¾DevOPSå‹å¥½çš„ç³»ç»Ÿï¼Œå·²ç»å†…ç½®äº†å¯¹äºéƒ¨ç½²æ–¹å¼çš„ä¸€ç§èµ„æºæŠ½è±¡ï¼Œè¿™ä¸ªèµ„æºå°±æ˜¯ï¼šDeploymentã€‚\nDeployment \u0026ndash;\u0026gt; ReplicaSet \u0026ndash;\u0026gt; Pods\nDeployment å­˜åœ¨çš„æ„ä¹‰ä¸ºï¼šåœ¨å‡çº§åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦å¼•å…¥é¢å¤–çš„ReplicaSetï¼Œå¹¶åè°ƒæ–°æ—§ä¸¤ä¸ªRSï¼Œä½¿ä»–ä»¬å†æ ¹æ®å½¼æ­¤ä¸æ–­ä¿®æ”¹ï¼Œè€Œä¸ä¼šé€ æˆå¹²æ‰°ã€‚Deploymentå°†è¿™äº›è¿ç»´è¿‡ç¨‹éƒ½ä»£ç åŒ–ï¼Œå†…ç½®ä¸ºè‡ªå·±çš„é€»è¾‘ï¼Œä»è€Œè®©å‡çº§å˜å¾—ç®€å•ã€‚\né¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Deploymentåˆ›å»º3ä¸ªå®ä¾‹\n1# deploy.yaml 2--- 3apiVersion: apps/v1 4kind: Deployment 5metadata: 6 name: first-deployment 7 labels: 8 app: simple-pod-deployment 9spec: 10 replicas: 3 11 selector: 12 matchLabels: 13 app: simple-pod-deployment 14 template: 15 metadata: 16 name: simple-pod-deployment 17 labels: 18 app: simple-pod-deployment 19 spec: 20 containers: 21 - name: simple-pod-de 22 image: lukelau/rest-docker:0.0.1 23 ports: 24 - containerPort: 8080 25 args: 26 - -server.addr=0.0.0.0:8080 æ­¤æ—¶åˆ›å»ºäº†3ä¸ªPodï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¿®æ”¹ä¸‹imagesçš„ç‰ˆæœ¬ï¼Œé‡æ–°apply -f\n1# image: lukelau/rest-docker:0.0.1 2 image: lukelau/rest-docker:0.0.2 é€šè¿‡kubectl describe deployment first-deployment å¯ä»¥çœ‹åˆ°æ•´ä¸ªå‡çº§çš„è¿‡ç¨‹ã€‚\nå¯ä»¥ä½¿ç”¨recordè®°å½•æ‰§è¡Œå†å²\n1kubectl rollout history deployment first-deployment æ§åˆ¶æ»šåŠ¨å‡çº§é€Ÿç‡\n1--- 2apiVersion: apps/v1 3kind: Deployment 4metadata: 5 name: first-deployment 6 labels: 7 app: simple-pod-deployment 8spec: 9 replicas: 3 10 minReadySeconds: 10 11 strategy: 12 type: RollingUpdate 13 rollingUpdate: 14 maxSurge: 1 15 maxUnavailable: 0 16 selector: 17 matchLabels: 18 app: simple-pod-deployment 19 template: 20 metadata: 21 name: simple-pod-deployment 22 labels: 23 app: simple-pod-deployment 24 spec: 25 containers: 26 - name: simple-pod-de 27 image: lukelau/rest-docker:0.0.2 28 ports: 29 - containerPort: 8080 30 args: 31 - -server.addr=0.0.0.0:8080 1# åœæ­¢å‡çº§ 2kubectl rollout pause deployment first-deployment 3# æ¢å¤å‡çº§ 4kubectl rollout resume deployment first-deployment 5# å–æ¶ˆå‡çº§ 6kubectl rollout undo deployment first-deployment ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/5-k8s-deployment/","summary":"è“ç»¿éƒ¨ç½² è“ç»¿éƒ¨ç½²æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„éƒ¨ç½²æ–¹å¼ï¼Œç»å¸¸ä¼šç”¨äºæ–°æ—§ç‰ˆæœ¬ä¸å…¼å®¹çš„æƒ…å†µã€‚\nå…ˆå°†æ–°ç‰ˆæœ¬(ç»¿ç‰ˆ)çš„æœåŠ¡è¿è¡Œèµ·æ¥ã€‚ å°†æ‰€æœ‰çš„æµé‡åˆ‡åˆ°æ–°ç‰ˆæœ¬çš„æœåŠ¡ä¸Š åˆ é™¤æ—§ç‰ˆæœ¬(è“ç‰ˆ)çš„æœåŠ¡ åˆ›å»ºæ–°ç‰ˆæœ¬çš„ReplicaSetï¼Œå°†ServiceæŒ‡å‘æ–°çš„Podsï¼Œåˆ é™¤æ—§ç‰ˆæœ¬çš„ReplicaSet\næ»šåŠ¨å‡çº§ è“ç»¿éƒ¨ç½²å¯ä»¥æœ‰æ•ˆä¿è¯ä¸šåŠ¡çš„æ­£ç¡®æ€§ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„é£é™©ï¼Œä¾‹å¦‚ç¨³å®šæ€§ã€‚\nå‡è®¾æ–°éƒ¨ç½²çš„åº”ç”¨æ˜¯æœ‰é—®é¢˜çš„ï¼Œä¸€æ—¦åˆ‡æ¢ä¹‹åå°±ä¼šå¯¼è‡´ä¸šåŠ¡çš„å´©æºƒï¼Œé€ æˆæŸå¤±ã€‚äºæ˜¯å°±æœ‰äº†ç¨å¾®å‹å¥½çš„å‡çº§æ–¹å¼ï¼Œæ»šåŠ¨å‡çº§ã€‚\nå…ˆå…³é—­ä¸€ä¸ªæ—§ç‰ˆæœ¬çš„å®ä¾‹ å¼€å¯ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„å®ä¾‹ç”¨äºæ›¿æ¢æ—§ç‰ˆæœ¬ æ›¿æ¢æˆåŠŸæ—¶å€™å¾ªç¯1å’Œ2ï¼Œç›´åˆ°æ‰€æœ‰çš„å®ä¾‹å‡çº§å®Œæˆã€‚ åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸­é€”å‘ç°å¼‚å¸¸å¯ä»¥åŠæ—¶åœæ‰‹ï¼ŒåŠæ—¶æ­¢æŸã€‚è€Œä¸”Kubernetesä¹Ÿåœ¨å®¢æˆ·ç«¯ä¸­æ”¯æŒäº†è¿™ä¸ªç‰¹æ€§ã€‚kubectl rolling-updateã€‚\nå‡çº§å‰åRCçš„Selectoréƒ½è¢«æ”¹å˜äº† æ“ä½œéƒ½æ˜¯åœ¨å®¢æˆ·ç«¯æ‰§è¡Œçš„ï¼Ÿ é‡‘ä¸é›€å‘å¸ƒ é‡‘ä¸é›€å‘å¸ƒæ˜¯æ»šåŠ¨å‘å¸ƒçš„ä¸€ç§ç‰¹ä¾‹ï¼Œåœ¨æ»šåŠ¨å‘å¸ƒä¸­ï¼Œæ˜¯ä¸ä¼šç­‰å¾…çš„ï¼Œé™¤éä¸­é—´å‡ºé”™äº†ã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦å…¨éƒ½å‡çº§ï¼Œå¯èƒ½åªæ˜¯å¤„äºPOCçš„ä¸€äº›åŸå› ï¼Œæˆ‘ä»¬åªå¸Œæœ›éƒ¨åˆ†å®ä¾‹æ˜¯æ–°çš„ï¼Œå¤§éƒ¨åˆ†æ˜¯æ—§çš„ï¼Œè€Œè¿™ç§æƒ…å½¢ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºé‡‘ä¸é›€å‘å¸ƒã€‚\nå‡çº§å°‘éƒ¨åˆ†å®ä¾‹ æŸ¥çœ‹æ•ˆæœï¼Œå¦‚æœå¥½ï¼Œå…¨éƒ¨å‡çº§ å¦‚æœä¸å¥½ï¼Œåˆ™ä¸å‡çº§ å£°æ˜å¼å‡çº§ å‰é¢ä»‹ç»çš„è¿™äº›å‡çº§å‘å¸ƒæ–¹å¼åœ¨K8sä¸Šå¾ˆå¤šæ—¶å€™æ˜¯åŠæ‰‹å·¥æ–¹å¼æ‰§è¡Œçš„ï¼Œè€ŒKubernetesä½œä¸ºä¸€æ¬¾DevOPSå‹å¥½çš„ç³»ç»Ÿï¼Œå·²ç»å†…ç½®äº†å¯¹äºéƒ¨ç½²æ–¹å¼çš„ä¸€ç§èµ„æºæŠ½è±¡ï¼Œè¿™ä¸ªèµ„æºå°±æ˜¯ï¼šDeploymentã€‚\nDeployment \u0026ndash;\u0026gt; ReplicaSet \u0026ndash;\u0026gt; Pods\nDeployment å­˜åœ¨çš„æ„ä¹‰ä¸ºï¼šåœ¨å‡çº§åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦å¼•å…¥é¢å¤–çš„ReplicaSetï¼Œå¹¶åè°ƒæ–°æ—§ä¸¤ä¸ªRSï¼Œä½¿ä»–ä»¬å†æ ¹æ®å½¼æ­¤ä¸æ–­ä¿®æ”¹ï¼Œè€Œä¸ä¼šé€ æˆå¹²æ‰°ã€‚Deploymentå°†è¿™äº›è¿ç»´è¿‡ç¨‹éƒ½ä»£ç åŒ–ï¼Œå†…ç½®ä¸ºè‡ªå·±çš„é€»è¾‘ï¼Œä»è€Œè®©å‡çº§å˜å¾—ç®€å•ã€‚\né¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Deploymentåˆ›å»º3ä¸ªå®ä¾‹\n1# deploy.yaml 2--- 3apiVersion: apps/v1 4kind: Deployment 5metadata: 6 name: first-deployment 7 labels: 8 app: simple-pod-deployment 9spec: 10 replicas: 3 11 selector: 12 matchLabels: 13 app: simple-pod-deployment 14 template: 15 metadata: 16 name: simple-pod-deployment 17 labels: 18 app: simple-pod-deployment 19 spec: 20 containers: 21 - name: simple-pod-de 22 image: lukelau/rest-docker:0.","tags":null,"title":"K8s Deployments"},{"categories":null,"contents":"Replicas å’Œdeploymentè¿™ä¸¤ç±»èµ„æºéƒ½æ˜¯ç”¨äºæ§åˆ¶workloadçš„ã€‚è¿™ä¸¤ç§ç±»å‹çš„èµ„æºä¸€èˆ¬éƒ½æ˜¯æŒç»­è¿è¡Œçš„ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€äº›è¾…åŠ©æ–¹å¼å¸®åŠ©workloadå‡ºç°å¼‚å¸¸æ—¶æ¢å¤ï¼Œä»¥åŠæ ¹æ®æƒ…å†µè¿›è¡ŒåŠ¨æ€ä¼¸ç¼©çš„ç‰¹æ€§ã€‚\nJob æ ¹æ®Jobçš„å®šä¹‰åˆ›å»ºå‡ºå¯¹åº”çš„Podï¼Œç„¶åå…³æ³¨Podçš„çŠ¶æ€ï¼Œ ç›´åˆ°æ»¡è¶³å®šä¹‰ã€‚ä¾‹å¦‚Podæ‰§è¡ŒæˆåŠŸäº†æˆ–è€…æ‰§è¡Œå¤±è´¥äº†ï¼Œå¹¶ä¸”è¾¾åˆ°äº†é‡è¯•æ¬¡æ•°ã€‚\n1--- 2apiVersion: batch/v1 3kind: Job 4metadata: 5 name: pi 6spec: 7 template: 8 spec: 9 containers: 10 - name: pi 11 image: perl 12 command: [\u0026#34;perl\u0026#34;, \u0026#34;-Mbignum=bpi\u0026#34;,\u0026#34;-wle\u0026#34;, \u0026#34;print bpi(2000)\u0026#34;] 13 restartPolicy: Never 14 backoffLimit: 4 Jobæ­£å¸¸æ‰§è¡Œç»“æŸåç»“æœå¦‚ä¸Šå›¾ã€‚è¿™æ˜¯ä¸€ä¸ªåªæ‰§è¡Œä¸€æ¬¡çš„Jobã€‚å®ƒçš„æ“ä½œæ–¹å¼å°±æ˜¯åˆ›å»ºä¸€ä¸ªPodï¼Œç„¶åè¿è¡Œä¸€éï¼Œç„¶åå°±é€€å‡ºã€‚å¦‚æœæƒ³æ‰§è¡Œå¤šæ¬¡ï¼Œåˆ™åªéœ€è¦å¢åŠ ä¸€ä¸ªå‚æ•°\n1completions: 2 æ‰§è¡Œ2æ¬¡æ—¶åˆ›å»ºäº†ä¸¤ä¸ªPodï¼Œç„¶åä¿è¯è¿™ä¸¤ä¸ªPodéƒ½æ‰§è¡ŒæˆåŠŸã€‚\næˆ‘ä»¬åœ¨ä½¿ç”¨Deploymentç­‰Workloadçš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šæŒ‡å®šrestartPolicyï¼Œé»˜è®¤éƒ½æ˜¯RestartOnFailã€‚åœ¨Jobä¸­ä¸èƒ½è¿™ä¹ˆæŒ‡å®šï¼Œå› ä¸ºè¿™ä¸ªé€»è¾‘åº”è¯¥ç”±Jobæ¥æ§åˆ¶ï¼Œ è€Œä¸æ˜¯è®©Podæ¥æ§åˆ¶ã€‚\nCronJob å®šæ—¶ä»»åŠ¡ï¼Œ CronJobå°±æ˜¯åœ¨Jobçš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†å‘¨æœŸå®šä¹‰çš„API\n1--- 2apiVersion: batch/v1 3kind: CronJob 4metadata: 5 name: batch-job-pi 6spec: 7 schedule: \u0026#34;0,15,30,45 * * * *\u0026#34; 8 jobTemplate: 9 spec: 10 template: 11 metadata: 12 labels: 13 app: pi-job 14 spec: 15 containers: 16 - name: pi 17 image: perl 18 command: [\u0026#34;perl\u0026#34;, \u0026#34;-Mbignum=bpi\u0026#34;,\u0026#34;-wle\u0026#34;, \u0026#34;print bpi(2000)\u0026#34;] 19 restartPolicy: Never ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/6-k8s-job/","summary":"Replicas å’Œdeploymentè¿™ä¸¤ç±»èµ„æºéƒ½æ˜¯ç”¨äºæ§åˆ¶workloadçš„ã€‚è¿™ä¸¤ç§ç±»å‹çš„èµ„æºä¸€èˆ¬éƒ½æ˜¯æŒç»­è¿è¡Œçš„ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€äº›è¾…åŠ©æ–¹å¼å¸®åŠ©workloadå‡ºç°å¼‚å¸¸æ—¶æ¢å¤ï¼Œä»¥åŠæ ¹æ®æƒ…å†µè¿›è¡ŒåŠ¨æ€ä¼¸ç¼©çš„ç‰¹æ€§ã€‚\nJob æ ¹æ®Jobçš„å®šä¹‰åˆ›å»ºå‡ºå¯¹åº”çš„Podï¼Œç„¶åå…³æ³¨Podçš„çŠ¶æ€ï¼Œ ç›´åˆ°æ»¡è¶³å®šä¹‰ã€‚ä¾‹å¦‚Podæ‰§è¡ŒæˆåŠŸäº†æˆ–è€…æ‰§è¡Œå¤±è´¥äº†ï¼Œå¹¶ä¸”è¾¾åˆ°äº†é‡è¯•æ¬¡æ•°ã€‚\n1--- 2apiVersion: batch/v1 3kind: Job 4metadata: 5 name: pi 6spec: 7 template: 8 spec: 9 containers: 10 - name: pi 11 image: perl 12 command: [\u0026#34;perl\u0026#34;, \u0026#34;-Mbignum=bpi\u0026#34;,\u0026#34;-wle\u0026#34;, \u0026#34;print bpi(2000)\u0026#34;] 13 restartPolicy: Never 14 backoffLimit: 4 Jobæ­£å¸¸æ‰§è¡Œç»“æŸåç»“æœå¦‚ä¸Šå›¾ã€‚è¿™æ˜¯ä¸€ä¸ªåªæ‰§è¡Œä¸€æ¬¡çš„Jobã€‚å®ƒçš„æ“ä½œæ–¹å¼å°±æ˜¯åˆ›å»ºä¸€ä¸ªPodï¼Œç„¶åè¿è¡Œä¸€éï¼Œç„¶åå°±é€€å‡ºã€‚å¦‚æœæƒ³æ‰§è¡Œå¤šæ¬¡ï¼Œåˆ™åªéœ€è¦å¢åŠ ä¸€ä¸ªå‚æ•°\n1completions: 2 æ‰§è¡Œ2æ¬¡æ—¶åˆ›å»ºäº†ä¸¤ä¸ªPodï¼Œç„¶åä¿è¯è¿™ä¸¤ä¸ªPodéƒ½æ‰§è¡ŒæˆåŠŸã€‚\næˆ‘ä»¬åœ¨ä½¿ç”¨Deploymentç­‰Workloadçš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šæŒ‡å®šrestartPolicyï¼Œé»˜è®¤éƒ½æ˜¯RestartOnFailã€‚åœ¨Jobä¸­ä¸èƒ½è¿™ä¹ˆæŒ‡å®šï¼Œå› ä¸ºè¿™ä¸ªé€»è¾‘åº”è¯¥ç”±Jobæ¥æ§åˆ¶ï¼Œ è€Œä¸æ˜¯è®©Podæ¥æ§åˆ¶ã€‚\nCronJob å®šæ—¶ä»»åŠ¡ï¼Œ CronJobå°±æ˜¯åœ¨Jobçš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†å‘¨æœŸå®šä¹‰çš„API\n1--- 2apiVersion: batch/v1 3kind: CronJob 4metadata: 5 name: batch-job-pi 6spec: 7 schedule: \u0026#34;0,15,30,45 * * * *\u0026#34; 8 jobTemplate: 9 spec: 10 template: 11 metadata: 12 labels: 13 app: pi-job 14 spec: 15 containers: 16 - name: pi 17 image: perl 18 command: [\u0026#34;perl\u0026#34;, \u0026#34;-Mbignum=bpi\u0026#34;,\u0026#34;-wle\u0026#34;, \u0026#34;print bpi(2000)\u0026#34;] 19 restartPolicy: Never ","tags":null,"title":"K8s Job"},{"categories":null,"contents":"å®¹å™¨ç½‘ç»œ æ¯ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æœ‰ä¸€ä¸ªè‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œæ ˆï¼Œè¿™ä¸ªç‹¬ç«‹çš„ç½‘ç»œæ ˆæ˜¯åŸºäºLinuxçš„Network Namespaceå®ç°çš„ã€‚\nè¿™ä¸ªç‹¬ç«‹çš„ç½‘ç»œæ ˆåŒ…å«äº†ï¼š Network Interfaceã€Loopback Deviceã€Routing Tableå’ŒIPtablesè§„åˆ™ã€‚å¯¹äºä¸€ä¸ªè¿›ç¨‹æ¥è¯´ï¼Œè¿™äº›è¦ç´ å°±æ„æˆäº†å®ƒå‘èµ·å’Œå“åº”ç½‘ç»œè¯·æ±‚çš„åŸºæœ¬ç¯å¢ƒã€‚\nå®¹å™¨å¯ä»¥ä½¿ç”¨è‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œæ ˆ(åˆ›å»ºå±äºè‡ªå·±çš„Network Namespace)ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Hostçš„ç½‘ç»œæ ˆ(ä¸åˆ›å»ºNetwork Namespace)ã€‚\n1# Uset -net=host to share the host network 2docker run -d -net=host --name nginx-host nginx ç›´æ¥ä½¿ç”¨Hostçš„ç½‘ç»œæ ˆå¯ä»¥æä¾›è‰¯å¥½çš„ç½‘ç»œæ€§èƒ½ï¼Œä½†æ˜¯ä¸å¯é¿å…çš„ä¼šå¼•å…¥ç½‘ç»œèµ„æºå…±äº«çš„é—®é¢˜ï¼Œæ¯”å¦‚ç«¯å£å†²çªã€‚å¤§å¤šæ•°åº”ç”¨åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å®¹å™¨èƒ½å¤Ÿæœ‰è‡ªå·±ç‹¬ç«‹çš„IPåœ°å€å’Œç«¯å£ï¼Œå³æœ‰è‡ªå·±ç‹¬ç«‹çš„Namespaceã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨è¿™ä¸ªè¢«éš”ç¦»çš„å®¹å™¨è¿›ç¨‹ä¸­å¦‚ä½•ä¸å…¶ä»–çš„Network Namespaceé‡Œçš„å®¹å™¨è¿›ç¨‹è¿›è¡Œäº¤äº’å‘¢ã€‚\nä¸€èˆ¬æˆ‘ä»¬å¦‚æœå¸Œæœ›ä¸¤å°ä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œç›´æ¥ç”¨ç½‘çº¿æŠŠè¿™ä¸¤å°ä¸»æœºè¿æ¥èµ·æ¥å³å¯ï¼›è€Œå¦‚æœæ˜¯å¤šå°ä¸»æœºä¹‹é—´é€šä¿¡æˆ‘ä»¬å¯ä»¥å°†å…¶è¿æ¥åœ¨åŒä¸€å°äº¤æ¢æœºä¸Šã€‚\nåœ¨Linuxç³»ç»Ÿä¸­ï¼Œèƒ½å¤Ÿèµ·åˆ°è™šæ‹Ÿäº¤æ¢æœºä½œç”¨çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡æ˜¯Bridgeï¼Œæ˜¯äºŒå±‚ç½‘ç»œè®¾å¤‡ã€‚ä¸»è¦åŠŸèƒ½æ˜¯æ ¹æ®MACåœ°å€æ¥å°†æ•°æ®åŒ…è½¬å‘åˆ°ç½‘æ¡¥çš„ä¸åŒPortä¸Šã€‚\nä¸ºäº†å®ç°ä¸Šè¿°ç›®çš„ï¼Œdockeré¡¹ç›®ä¼šåœ¨Hostä¸Šåˆ›å»ºä¸€ä¸ªdocker0çš„ç½‘æ¡¥ï¼Œå‡¡æ˜¯è¿æ¥åœ¨docker0ç½‘æ¡¥ä¸Šçš„å®¹å™¨ï¼Œå°±ç›¸å½“äºåœ¨åŒä¸€ä¸ªäºŒå±‚ç½‘ç»œã€‚\næ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•æŠŠå®¹å™¨è¿æ¥åˆ°docker0ç½‘æ¡¥ä¸Šï¼Œè¿™å°±éœ€è¦veth pairçš„è™šæ‹Ÿè®¾å¤‡äº†ã€‚veth pairåˆ›å»ºå‡ºæ¥ä»¥åæ€»æ˜¯ä»¥ä¸¤å¼ è™šæ‹Ÿç½‘å¡veth peerçš„å½¢å¼æˆå¯¹å‡ºç°çš„ã€‚å¹¶ä¸”ä»å…¶ä¸­ä¸€ä¸ªpeerå‘å‡ºçš„æ•°æ®åŒ…å¯ä»¥ç›´æ¥å‡ºç°åœ¨ä¸ä¹‹å¯¹åº”çš„å¦ä¸€ä¸ªpeerä¸Šï¼Œå³ä½¿veth pairçš„ä¸¤ç«¯ä¸åœ¨åŒä¸€ä¸ªNetwork Namespace ä¸­ã€‚å› æ­¤ï¼Œveth pairå¸¸å¸¸ç”¨ä½œè¿æ¥ä¸åŒNetwork Namespaceçš„ç½‘çº¿ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_ops_network/","summary":"å®¹å™¨ç½‘ç»œ æ¯ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æœ‰ä¸€ä¸ªè‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œæ ˆï¼Œè¿™ä¸ªç‹¬ç«‹çš„ç½‘ç»œæ ˆæ˜¯åŸºäºLinuxçš„Network Namespaceå®ç°çš„ã€‚\nè¿™ä¸ªç‹¬ç«‹çš„ç½‘ç»œæ ˆåŒ…å«äº†ï¼š Network Interfaceã€Loopback Deviceã€Routing Tableå’ŒIPtablesè§„åˆ™ã€‚å¯¹äºä¸€ä¸ªè¿›ç¨‹æ¥è¯´ï¼Œè¿™äº›è¦ç´ å°±æ„æˆäº†å®ƒå‘èµ·å’Œå“åº”ç½‘ç»œè¯·æ±‚çš„åŸºæœ¬ç¯å¢ƒã€‚\nå®¹å™¨å¯ä»¥ä½¿ç”¨è‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œæ ˆ(åˆ›å»ºå±äºè‡ªå·±çš„Network Namespace)ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Hostçš„ç½‘ç»œæ ˆ(ä¸åˆ›å»ºNetwork Namespace)ã€‚\n1# Uset -net=host to share the host network 2docker run -d -net=host --name nginx-host nginx ç›´æ¥ä½¿ç”¨Hostçš„ç½‘ç»œæ ˆå¯ä»¥æä¾›è‰¯å¥½çš„ç½‘ç»œæ€§èƒ½ï¼Œä½†æ˜¯ä¸å¯é¿å…çš„ä¼šå¼•å…¥ç½‘ç»œèµ„æºå…±äº«çš„é—®é¢˜ï¼Œæ¯”å¦‚ç«¯å£å†²çªã€‚å¤§å¤šæ•°åº”ç”¨åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å®¹å™¨èƒ½å¤Ÿæœ‰è‡ªå·±ç‹¬ç«‹çš„IPåœ°å€å’Œç«¯å£ï¼Œå³æœ‰è‡ªå·±ç‹¬ç«‹çš„Namespaceã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨è¿™ä¸ªè¢«éš”ç¦»çš„å®¹å™¨è¿›ç¨‹ä¸­å¦‚ä½•ä¸å…¶ä»–çš„Network Namespaceé‡Œçš„å®¹å™¨è¿›ç¨‹è¿›è¡Œäº¤äº’å‘¢ã€‚\nä¸€èˆ¬æˆ‘ä»¬å¦‚æœå¸Œæœ›ä¸¤å°ä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œç›´æ¥ç”¨ç½‘çº¿æŠŠè¿™ä¸¤å°ä¸»æœºè¿æ¥èµ·æ¥å³å¯ï¼›è€Œå¦‚æœæ˜¯å¤šå°ä¸»æœºä¹‹é—´é€šä¿¡æˆ‘ä»¬å¯ä»¥å°†å…¶è¿æ¥åœ¨åŒä¸€å°äº¤æ¢æœºä¸Šã€‚\nåœ¨Linuxç³»ç»Ÿä¸­ï¼Œèƒ½å¤Ÿèµ·åˆ°è™šæ‹Ÿäº¤æ¢æœºä½œç”¨çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡æ˜¯Bridgeï¼Œæ˜¯äºŒå±‚ç½‘ç»œè®¾å¤‡ã€‚ä¸»è¦åŠŸèƒ½æ˜¯æ ¹æ®MACåœ°å€æ¥å°†æ•°æ®åŒ…è½¬å‘åˆ°ç½‘æ¡¥çš„ä¸åŒPortä¸Šã€‚\nä¸ºäº†å®ç°ä¸Šè¿°ç›®çš„ï¼Œdockeré¡¹ç›®ä¼šåœ¨Hostä¸Šåˆ›å»ºä¸€ä¸ªdocker0çš„ç½‘æ¡¥ï¼Œå‡¡æ˜¯è¿æ¥åœ¨docker0ç½‘æ¡¥ä¸Šçš„å®¹å™¨ï¼Œå°±ç›¸å½“äºåœ¨åŒä¸€ä¸ªäºŒå±‚ç½‘ç»œã€‚\næ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•æŠŠå®¹å™¨è¿æ¥åˆ°docker0ç½‘æ¡¥ä¸Šï¼Œè¿™å°±éœ€è¦veth pairçš„è™šæ‹Ÿè®¾å¤‡äº†ã€‚veth pairåˆ›å»ºå‡ºæ¥ä»¥åæ€»æ˜¯ä»¥ä¸¤å¼ è™šæ‹Ÿç½‘å¡veth peerçš„å½¢å¼æˆå¯¹å‡ºç°çš„ã€‚å¹¶ä¸”ä»å…¶ä¸­ä¸€ä¸ªpeerå‘å‡ºçš„æ•°æ®åŒ…å¯ä»¥ç›´æ¥å‡ºç°åœ¨ä¸ä¹‹å¯¹åº”çš„å¦ä¸€ä¸ªpeerä¸Šï¼Œå³ä½¿veth pairçš„ä¸¤ç«¯ä¸åœ¨åŒä¸€ä¸ªNetwork Namespace ä¸­ã€‚å› æ­¤ï¼Œveth pairå¸¸å¸¸ç”¨ä½œè¿æ¥ä¸åŒNetwork Namespaceçš„ç½‘çº¿ã€‚","tags":null,"title":"K8s network"},{"categories":null,"contents":"Node èŠ‚ç‚¹ä¸»è¦è´Ÿè´£å®¹å™¨çš„ç®¡ç†ï¼Œç”¨äºè¿è¡Œå®¹å™¨å’Œä¿è¯å®¹å™¨çš„çŠ¶æ€ã€‚é»˜è®¤æƒ…å†µä¸‹MasterèŠ‚ç‚¹ä¸æ‰¿æ‹…NodeèŠ‚ç‚¹çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç‰¹æ®Šçš„é…ç½®è®©MasterèŠ‚ç‚¹ä¹Ÿå¯ä½œä¸ºNodeèŠ‚ç‚¹ã€‚\nEtcdç”¨äºå­˜å‚¨Kubernetesçš„å…ƒæ•°æ®ï¼Œä½†æ˜¯ä¸è¦æ±‚ä¸€å®šè¦ä»¥å®¹å™¨çš„å½¢å¼è¿è¡Œã€‚\n1kubeadm init --pod-network-cidr=10.244.0.0/16 --apiserver-advertise-address=192.168.0.22 --pod-network-cidr pod çš„ippool, --apiserver-advertise-address ä¸ºæš´éœ²çš„k8sAPIè°ƒç”¨IP.\nèŠ‚ç‚¹(Node)\nä¸€ä¸ªNodeæ˜¯ä¸€ä¸ªè¿è¡ŒK8sçš„ä¸»æœºï¼Œä½œä¸ºK8s worker, é€šå¸¸ç§°ä¹‹ä¸ºMinionã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œå¦‚ä¸‹K8så…³é”®ç»„ä»¶ï¼š\nkubeletï¼šä¸»èŠ‚ç‚¹ä»£ç† kube-proxy: serviceä½¿ç”¨å…¶å°†é“¾æ¥è·¯ç”±åˆ°Pod docker/rocket: k8s ä½¿ç”¨å®¹å™¨æŠ€æœ¯åˆ›å»ºå®¹å™¨ å®¹å™¨ç»„(Pod)\nä¸€ä¸ªPodå¯¹åº”è‹¥å¹²å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®¹å™¨ç»„ï¼ŒåŒä¸€ä¸ªPodå†…çš„å®¹å™¨å…±äº«ä¸€ä¸ªå­˜å‚¨å·(volume)ï¼ŒåŒä¸€ä¸ªPodä¸­çš„å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œNamespace,å¯ä»¥ä½¿ç”¨localhostäº’ç›¸é€šä¿¡ã€‚\nPodæ˜¯çŸ­æš‚çš„ï¼Œä¸æ˜¯æŒç»­æ€§å®ä½“ã€‚ä¸€ä¸ªPodæ˜¯ä¸€ä¸ªç‰¹å®šçš„åº”ç”¨æ‰“åŒ…é›†åˆï¼ŒåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ã€‚å’Œè¿è¡Œçš„å®¹å™¨ç±»ä¼¼ï¼Œä¸€ä¸ªPodåªæœ‰å¾ˆçŸ­çš„è¿è¡Œå‘¨æœŸã€‚Podè¢«è°ƒåº¦åˆ°ä¸€ä¸ªNodeè¿è¡Œï¼Œç›´åˆ°å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç»“æŸæˆ–è€…å…¶è¢«åˆ é™¤ã€‚\nå®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸ(Pod Status)\nåŒ…å«æ‰€æœ‰å®¹å™¨çŠ¶æ€é›†åˆï¼ŒåŒ…æ‹¬å®¹å™¨ç»„çŠ¶æ€ç±»å‹ï¼Œå®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸï¼Œäº‹ä»¶ï¼Œé‡å¯ç­–ç•¥ï¼Œä»¥åŠreplication controllers.\næ ‡ç­¾(labels)\næ ‡ç­¾æ˜¯ç”¨æ¥è¿æ¥ä¸€ç»„å¯¹è±¡çš„ï¼Œæ¯”å¦‚å®¹å™¨ç»„Podã€‚lableå¯ä»¥ç”¨æ¥ç»„ç»‡å’Œé€‰æ‹©å­å¯¹è±¡ã€‚ ä¸€ä¸ªLabelæ˜¯attachåˆ°Podçš„ä¸€å¯¹é”®å€¼å¯¹ï¼Œç”¨æ¥ä¼ é€’ç”¨æˆ·å®šä¹‰çš„å±æ€§ã€‚\nReplication Controllers\nä¸»è¦è´Ÿè´£æŒ‡å®šæ•°é‡çš„Podåœ¨åŒä¸€æ—¶é—´ä¸€èµ·è¿è¡Œã€‚Replication controller ç¡®ä¿ä»»æ„æ—¶é—´éƒ½æœ‰æŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬åœ¨è¿è¡Œã€‚å¦‚æœä¸ºæŸä¸ªPodåˆ›å»ºäº†Replication Controllerå¹¶ä¸”æŒ‡å®šä¸º3å‰¯æœ¬ï¼Œå®ƒä¼šåˆ›å»º3ä¸ªPod,å¹¶æŒç»­ç›‘æ§ä»–ä»¬ã€‚å¦‚æœæŸä¸ªPodä¸å“åº”ï¼Œé‚£ä¹ˆReplication controller ä¼šæ›¿æ¢å®ƒï¼Œä¿æŒPodæ€»æ•°ä¸º3.\nå½“åˆ›å»ºReplication Controlleræ—¶ï¼Œéœ€è¦æŒ‡å®šä¸¤ä¸ªä¸œè¥¿ã€‚\nPodæ¨¡æ¿ï¼š ç”¨æ¥åˆ›å»ºPodå‰¯æœ¬çš„æ¨¡æ¿ Labelï¼šReplication Controller éœ€è¦ç›‘æ§çš„Podçš„Label ç°åœ¨å·²ç»åˆ›å»ºäº†Podçš„ä¸€äº›å‰¯æœ¬ï¼Œé‚£ä¹ˆåœ¨è¿™äº›å‰¯æœ¬ä¸Šå¦‚ä½•è´Ÿè½½å‡è¡¡å‘¢ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯service\nServiceï¼š\nå¦‚æœPodæ˜¯çŸ­æš‚çš„ï¼Œé‚£ä¹ˆé‡å¯æ—¶IPåœ°å€å¯èƒ½ä¼šå˜ï¼Œæ€ä¹ˆæ‰èƒ½ä»å‰ç«¯å®¹å™¨æ­£ç¡®å¯é çš„æŒ‡å‘åå°å®¹å™¨å‘¢ã€‚\nServiceæ˜¯å®šä¹‰ä¸€ç³»åˆ—Podä»¥åŠè®¿é—®è¿™äº›Podçš„ç­–ç•¥çš„ä¸€å±‚æŠ½è±¡ã€‚Serviceé€šè¿‡Labelæ‰¾åˆ°Podç»„ã€‚å› ä¸ºserviceæ˜¯æŠ½è±¡çš„ï¼Œæ‰€åœ¨åœ¨å›¾è¡¨é‡Œé€šå¸¸çœ‹ä¸åˆ°ä»–ä»¬çš„å­˜åœ¨ã€‚\nç°åœ¨å‡å®šæœ‰ä¸¤ä¸ªåå°Pod,å¹¶ä¸”å®šä¹‰åå°serviceåç§°ä¸ºâ€œbackend-serviceâ€ï¼Œlabelé€‰æ‹©å™¨ä¸º(tier=backend,app=myapp)ã€‚backend-serviceçš„Serviceä¼šå®Œæˆå¦‚ä¸‹ä¸¤ä»¶é‡è¦çš„äº‹æƒ…ï¼š\nä¼šä¸ºServiceåˆ›å»ºä¸€ä¸ªæœ¬åœ°é›†ç¾¤çš„DNSå…¥å£ï¼Œå› æ­¤å‰ç«¯åªéœ€è¦DNSæŸ¥æ‰¾ä¸»æœºåä¸ºâ€œbackend-serviceâ€å°±èƒ½å¤Ÿè§£æå‡ºå‰ç«¯åº”ç”¨ç¨‹åºå¯ç”¨çš„IPåœ°å€ ç°åœ¨å‰ç«¯å·²ç»å¾—åˆ°äº†åå°æœåŠ¡çš„IPåœ°å€ï¼Œä½†æ˜¯å®ƒåº”è¯¥è®¿é—®2ä¸ªåå°Podä¸­çš„å“ªä¸€ä¸ªå‘¢ã€‚Serviceåœ¨è¿™ä¸¤ä¸ªåå°Podä¹‹é—´æä¾›é€æ˜çš„è´Ÿè½½å‡è¡¡ï¼Œä¼šå°†è¯·æ±‚å‘ç»™å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚é€šè¿‡æ¯ä¸ªNodeä¸Šè¿è¡Œçš„ä»£ç† kube-proxyå®Œæˆã€‚ Kubernetes Master\né›†ç¾¤æ‹¥æœ‰ä¸€ä¸ªK8s Master,K8s Master æä¾›é›†ç¾¤çš„ç‹¬ç‰¹è§†è§’ï¼Œå¹¶æ‹¥æœ‰ä¸€ç³»åˆ—ç»„ä»¶ï¼Œå¦‚Kubernetes API server. API server æä¾›å¯ä»¥ç”¨æ¥å’Œé›†ç¾¤äº¤äº’çš„REST ç«¯ç‚¹ã€‚Master èŠ‚ç‚¹åŒ…å«ç”¨æ¥åˆ›å»ºå’Œå¤åˆ¶Podçš„Replication Controller.\nå‚è€ƒèµ„æ–™ï¼š\nhttps://blog.csdn.net/hahachenchen789/article/details/80506699\nhttps://liqiang.io/post/kubernetes-tutorial-part-3-pods-80a851a5\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/1-k8s-overview/","summary":"Node èŠ‚ç‚¹ä¸»è¦è´Ÿè´£å®¹å™¨çš„ç®¡ç†ï¼Œç”¨äºè¿è¡Œå®¹å™¨å’Œä¿è¯å®¹å™¨çš„çŠ¶æ€ã€‚é»˜è®¤æƒ…å†µä¸‹MasterèŠ‚ç‚¹ä¸æ‰¿æ‹…NodeèŠ‚ç‚¹çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç‰¹æ®Šçš„é…ç½®è®©MasterèŠ‚ç‚¹ä¹Ÿå¯ä½œä¸ºNodeèŠ‚ç‚¹ã€‚\nEtcdç”¨äºå­˜å‚¨Kubernetesçš„å…ƒæ•°æ®ï¼Œä½†æ˜¯ä¸è¦æ±‚ä¸€å®šè¦ä»¥å®¹å™¨çš„å½¢å¼è¿è¡Œã€‚\n1kubeadm init --pod-network-cidr=10.244.0.0/16 --apiserver-advertise-address=192.168.0.22 --pod-network-cidr pod çš„ippool, --apiserver-advertise-address ä¸ºæš´éœ²çš„k8sAPIè°ƒç”¨IP.\nèŠ‚ç‚¹(Node)\nä¸€ä¸ªNodeæ˜¯ä¸€ä¸ªè¿è¡ŒK8sçš„ä¸»æœºï¼Œä½œä¸ºK8s worker, é€šå¸¸ç§°ä¹‹ä¸ºMinionã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œå¦‚ä¸‹K8så…³é”®ç»„ä»¶ï¼š\nkubeletï¼šä¸»èŠ‚ç‚¹ä»£ç† kube-proxy: serviceä½¿ç”¨å…¶å°†é“¾æ¥è·¯ç”±åˆ°Pod docker/rocket: k8s ä½¿ç”¨å®¹å™¨æŠ€æœ¯åˆ›å»ºå®¹å™¨ å®¹å™¨ç»„(Pod)\nä¸€ä¸ªPodå¯¹åº”è‹¥å¹²å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®¹å™¨ç»„ï¼ŒåŒä¸€ä¸ªPodå†…çš„å®¹å™¨å…±äº«ä¸€ä¸ªå­˜å‚¨å·(volume)ï¼ŒåŒä¸€ä¸ªPodä¸­çš„å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œNamespace,å¯ä»¥ä½¿ç”¨localhostäº’ç›¸é€šä¿¡ã€‚\nPodæ˜¯çŸ­æš‚çš„ï¼Œä¸æ˜¯æŒç»­æ€§å®ä½“ã€‚ä¸€ä¸ªPodæ˜¯ä¸€ä¸ªç‰¹å®šçš„åº”ç”¨æ‰“åŒ…é›†åˆï¼ŒåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ã€‚å’Œè¿è¡Œçš„å®¹å™¨ç±»ä¼¼ï¼Œä¸€ä¸ªPodåªæœ‰å¾ˆçŸ­çš„è¿è¡Œå‘¨æœŸã€‚Podè¢«è°ƒåº¦åˆ°ä¸€ä¸ªNodeè¿è¡Œï¼Œç›´åˆ°å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç»“æŸæˆ–è€…å…¶è¢«åˆ é™¤ã€‚\nå®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸ(Pod Status)\nåŒ…å«æ‰€æœ‰å®¹å™¨çŠ¶æ€é›†åˆï¼ŒåŒ…æ‹¬å®¹å™¨ç»„çŠ¶æ€ç±»å‹ï¼Œå®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸï¼Œäº‹ä»¶ï¼Œé‡å¯ç­–ç•¥ï¼Œä»¥åŠreplication controllers.\næ ‡ç­¾(labels)\næ ‡ç­¾æ˜¯ç”¨æ¥è¿æ¥ä¸€ç»„å¯¹è±¡çš„ï¼Œæ¯”å¦‚å®¹å™¨ç»„Podã€‚lableå¯ä»¥ç”¨æ¥ç»„ç»‡å’Œé€‰æ‹©å­å¯¹è±¡ã€‚ ä¸€ä¸ªLabelæ˜¯attachåˆ°Podçš„ä¸€å¯¹é”®å€¼å¯¹ï¼Œç”¨æ¥ä¼ é€’ç”¨æˆ·å®šä¹‰çš„å±æ€§ã€‚\nReplication Controllers\nä¸»è¦è´Ÿè´£æŒ‡å®šæ•°é‡çš„Podåœ¨åŒä¸€æ—¶é—´ä¸€èµ·è¿è¡Œã€‚Replication controller ç¡®ä¿ä»»æ„æ—¶é—´éƒ½æœ‰æŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬åœ¨è¿è¡Œã€‚å¦‚æœä¸ºæŸä¸ªPodåˆ›å»ºäº†Replication Controllerå¹¶ä¸”æŒ‡å®šä¸º3å‰¯æœ¬ï¼Œå®ƒä¼šåˆ›å»º3ä¸ªPod,å¹¶æŒç»­ç›‘æ§ä»–ä»¬ã€‚å¦‚æœæŸä¸ªPodä¸å“åº”ï¼Œé‚£ä¹ˆReplication controller ä¼šæ›¿æ¢å®ƒï¼Œä¿æŒPodæ€»æ•°ä¸º3.\nå½“åˆ›å»ºReplication Controlleræ—¶ï¼Œéœ€è¦æŒ‡å®šä¸¤ä¸ªä¸œè¥¿ã€‚\nPodæ¨¡æ¿ï¼š ç”¨æ¥åˆ›å»ºPodå‰¯æœ¬çš„æ¨¡æ¿ Labelï¼šReplication Controller éœ€è¦ç›‘æ§çš„Podçš„Label ç°åœ¨å·²ç»åˆ›å»ºäº†Podçš„ä¸€äº›å‰¯æœ¬ï¼Œé‚£ä¹ˆåœ¨è¿™äº›å‰¯æœ¬ä¸Šå¦‚ä½•è´Ÿè½½å‡è¡¡å‘¢ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯service\nServiceï¼š\nå¦‚æœPodæ˜¯çŸ­æš‚çš„ï¼Œé‚£ä¹ˆé‡å¯æ—¶IPåœ°å€å¯èƒ½ä¼šå˜ï¼Œæ€ä¹ˆæ‰èƒ½ä»å‰ç«¯å®¹å™¨æ­£ç¡®å¯é çš„æŒ‡å‘åå°å®¹å™¨å‘¢ã€‚\nServiceæ˜¯å®šä¹‰ä¸€ç³»åˆ—Podä»¥åŠè®¿é—®è¿™äº›Podçš„ç­–ç•¥çš„ä¸€å±‚æŠ½è±¡ã€‚Serviceé€šè¿‡Labelæ‰¾åˆ°Podç»„ã€‚å› ä¸ºserviceæ˜¯æŠ½è±¡çš„ï¼Œæ‰€åœ¨åœ¨å›¾è¡¨é‡Œé€šå¸¸çœ‹ä¸åˆ°ä»–ä»¬çš„å­˜åœ¨ã€‚\nç°åœ¨å‡å®šæœ‰ä¸¤ä¸ªåå°Pod,å¹¶ä¸”å®šä¹‰åå°serviceåç§°ä¸ºâ€œbackend-serviceâ€ï¼Œlabelé€‰æ‹©å™¨ä¸º(tier=backend,app=myapp)ã€‚backend-serviceçš„Serviceä¼šå®Œæˆå¦‚ä¸‹ä¸¤ä»¶é‡è¦çš„äº‹æƒ…ï¼š\nä¼šä¸ºServiceåˆ›å»ºä¸€ä¸ªæœ¬åœ°é›†ç¾¤çš„DNSå…¥å£ï¼Œå› æ­¤å‰ç«¯åªéœ€è¦DNSæŸ¥æ‰¾ä¸»æœºåä¸ºâ€œbackend-serviceâ€å°±èƒ½å¤Ÿè§£æå‡ºå‰ç«¯åº”ç”¨ç¨‹åºå¯ç”¨çš„IPåœ°å€ ç°åœ¨å‰ç«¯å·²ç»å¾—åˆ°äº†åå°æœåŠ¡çš„IPåœ°å€ï¼Œä½†æ˜¯å®ƒåº”è¯¥è®¿é—®2ä¸ªåå°Podä¸­çš„å“ªä¸€ä¸ªå‘¢ã€‚Serviceåœ¨è¿™ä¸¤ä¸ªåå°Podä¹‹é—´æä¾›é€æ˜çš„è´Ÿè½½å‡è¡¡ï¼Œä¼šå°†è¯·æ±‚å‘ç»™å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚é€šè¿‡æ¯ä¸ªNodeä¸Šè¿è¡Œçš„ä»£ç† kube-proxyå®Œæˆã€‚ Kubernetes Master\né›†ç¾¤æ‹¥æœ‰ä¸€ä¸ªK8s Master,K8s Master æä¾›é›†ç¾¤çš„ç‹¬ç‰¹è§†è§’ï¼Œå¹¶æ‹¥æœ‰ä¸€ç³»åˆ—ç»„ä»¶ï¼Œå¦‚Kubernetes API server. API server æä¾›å¯ä»¥ç”¨æ¥å’Œé›†ç¾¤äº¤äº’çš„REST ç«¯ç‚¹ã€‚Master èŠ‚ç‚¹åŒ…å«ç”¨æ¥åˆ›å»ºå’Œå¤åˆ¶Podçš„Replication Controller.\nå‚è€ƒèµ„æ–™ï¼š","tags":null,"title":"K8s Overview"},{"categories":null,"contents":"å‰é¢ä»‹ç»çš„å‡ ç§workloadéƒ½æœ‰ä¸€ä¸ªå…±æ€§ï¼Œé‚£å°±æ˜¯åˆ›å»ºå‡ºæ¥çš„Podéƒ½æ˜¯ä¸€è‡´çš„ã€‚æ‰€è°“çš„ä¸€è‡´å°±æ˜¯è¯´ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ReplicaSetï¼Œåˆ›å»ºäº†3ä¸ªPodï¼Œé‚£ä¹ˆè¿™3ä¸ªPodåˆ›äº†åå­—ä¸€å®šä¸ä¸€æ ·ä¹‹å¤–ï¼Œå…¶ä»–å±æ€§å¯èƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒåŒ…æ‹¬è¿è¡Œæ—¶çš„å‚æ•°å’Œæ¨¡å¼ä»¥åŠæ•°æ®å­˜å‚¨ã€‚\nå¦‚æœæ˜¯Web Serviceï¼Œæ•°æ®ä¿å­˜åˆ°åç«¯çš„DBä¸­ï¼Œä¸Šè¿°é€»è¾‘æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚\nå¦‚æœä½¿ç”¨ReplicaSetæ¥éƒ¨ç½²ä¸€ä¸ªDBçš„å¤šå®ä¾‹ï¼Œ å°±å¯è‚¯èƒ½å­˜åœ¨é—®é¢˜äº†ã€‚\næ•°æ®æŒä¹…åŒ–ï¼Œä¸€èˆ¬ä½¿ç”¨PVCï¼Œå½“ä½¿ç”¨PVC å’ŒPVçš„æ—¶å€™\nâ€‹\nReplicaSet -\u0026gt; Pods(3 ä¸ª) -\u0026gt; æŒä¹…å·å£°æ˜ -\u0026gt; æŒä¹…å·\n3ä¸ªPodçš„æ•°æ®éƒ½å†™åˆ°åŒä¸€ä¸ªPvä¸­ï¼Œè¿™æ ·è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Ÿï¼Ÿï¼Ÿ\nStatefulSet ä¸ºäº†è§£å†³Podçš„çŠ¶æ€æ€§çš„é—®é¢˜ï¼ŒK8så¼•å…¥äº†StatefulSetçš„æ¦‚å¿µ\nPodæœ‰å•ç‹¬çš„å­˜å‚¨å’Œå›ºå®šçš„ç½‘ç»œæ ‡è¯† éœ€è¦é…å¤‡ä¸€ä¸ªheadless Serviceï¼Œç”¨äºDNS å¯ä»¥é€šè¿‡DNSå¿«é€Ÿå‘ç°å…¶ä»–çš„Pod å¯ä»¥ç›´æ¥é€šè¿‡Pod DNSé€šä¿¡ æ¯ä¸ªPodéƒ½å¯ä»¥é€šè¿‡DNSè®¿é—®åˆ°ï¼Œè¿™ç§ç‰¹æ€§åœ¨å…¶ä»–workloadä¸­æ˜¯ä¸èƒ½å®ç°çš„ã€‚é€šè¿‡StatefulSetå¯ä»¥è®©PodæŒæœ‰çŠ¶æ€ï¼Œå³ä½¿å› ä¸ºæ•…éšœPodé‡å»ºäº†ï¼Œé‚£ä¹ˆå¯¹åº”çš„Podçš„åå­—å’Œæ•°æ®éƒ½ä¼šä¿ç•™ï¼Œå’Œé‡å»ºä¹‹å‰æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚\nä½¿ç”¨StatefulSet å¿…é¡»å»ºç«‹ä¸€ä¸ªHeadlessServiceï¼Œç„¶åç»‘å®šè¿™ä¸ªheadlessserviceåˆ°StatefulSetã€‚\nä»¥MongoDBä¸ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªStatefulSetï¼Œå› ä¸ºè¿˜æ²¡æœ‰ä»‹ç»åˆ°PVCå’ŒPVçš„å†…å®¹ï¼Œæ‰€ä»¥MongoDBå°†ä½¿ç”¨æœ¬åœ°å­˜å‚¨å·ã€‚\nåˆ›å»ºHeadless Service\nåˆ›å»º StatefulSet\né€šè¿‡DNSè®¿é—®Pod\nåœ¨StatefulSetçš„Podä¸­å¯ä»¥é€šè¿‡DNSç›´æ¥è®¿é—®å…¶ä»–Podã€‚\n1mongo --host mongo-1.mongo å¯ä»¥é€šè¿‡\u0026lt;pod-name\u0026gt;.\u0026lt;service-name\u0026gt;çš„å½¢å¼è®¿é—®Podã€‚è¿™å…¶å®å’ŒStatefulSetçš„è®¾è®¡æ˜¯æœ‰å…³ç³»çš„ï¼Œåœ¨ç±»ä¼¼çš„Deploymentä¸­Podçš„åå­—æ˜¯ä¸å›ºå®šçš„ï¼Œè€Œåœ¨StatefulSetä¸­ï¼ŒPodçš„åå­—æ˜¯å›ºå®šçš„ã€‚\nå’ŒReplicaSetå¯¹æ¯”\nå› ä¸ºæœ‰çŠ¶æ€çš„Podå½¼æ­¤ä¸åŒï¼Œé€šå¸¸å¸Œæœ›æ“ä½œçš„æ˜¯å…¶ä¸­çš„ç‰¹å®šçš„ä¸€ä¸ªï¼Œæ‰€ä»¥StatefulSeté€šå¸¸è¦æ±‚ä½ åˆ›å»ºä¸€ä¸ªç”¨æ¥è®°å½•æ¯ä¸ªPodç½‘ç»œæ ‡è®°çš„HeadlessServiceã€‚é€šè¿‡è¿™ä¸ªServiceï¼Œæ¯ä¸ªPodéƒ½æ‹¥æœ‰ç‹¬ç«‹çš„DNSè®°å½•ï¼Œè€Œè¿™åœ¨ReplicaSetä¸­æ˜¯ä¸è¡Œçš„ï¼Ÿï¼ˆå¦‚æœä¸ºReplicaSetåˆ›å»ºä¸€ä¸ªHeadless Serviceä¼šå‘ç”Ÿå•¥ï¼Ÿï¼‰ å› ä¸ºStatefulSetç¼©å®¹ä»»ä½•æ—¶å€™åªä¼šæ“ä½œä¸€ä¸ªPodå®ä¾‹ï¼Œæ‰€ä»¥æœ‰çŠ¶æ€åº”ç”¨çš„ç¼©å®¹ä¸ä¼šå¾ˆè¿…é€Ÿã€‚ StatefulSetåœ¨æœ‰å®ä¾‹ä¸å¥åº·çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸å…è®¸ç¼©å®¹çš„ã€‚ æŒä¹…å­˜å‚¨ ä¸€ä¸ªStatefulSetå¯ä»¥æ‹¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå·å£°æ˜æ¨¡æ¿ï¼Œè¿™äº›å£°æ˜ä¼šåœ¨åˆ›å»ºPodå‰åˆ›å»ºå‡ºæ¥ï¼Œç»‘å®šåˆ°ä¸€ä¸ªPodçš„å®ä¾‹ä¸Šã€‚ æ‰©å®¹StatefulSetä¼šåˆ›å»ºä¸¤ä¸ªAPIå¯¹è±¡ï¼Œä¸€ä¸ªPodå’Œä¸€ä¸ªå·å£°æ˜ï¼›ä½†æ˜¯ç¼©å®¹StatefulSetå´ä¼šåˆ é™¤ä¸€ä¸ªPodå¯¹è±¡ï¼Œè€Œä¼šç•™ä¸‹PVCï¼Œå› ä¸ºä¸€æ—¦åˆ é™¤PVCåˆ™æ„å‘³ç€PVä¼šè¢«å›æ”¶ã€‚ StatefulSet at-most-one\nKubernetes å¿…é¡»ä¿è¯ä¸¤ä¸ªæ‹¥æœ‰ç›¸åŒæ ‡è®°å’Œç»‘å®šç›¸åŒæŒä¹…å·å£°æ˜çš„æœ‰çŠ¶æ€çš„Podå®ä¾‹ä¸ä¼šåŒæ—¶è¿è¡Œã€‚ä¸€ä¸ªStatefulSetå¿…é¡»ä¿è¯æœ‰çŠ¶æ€çš„å®ä¾‹çš„ at-most-one è¯­ä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´StatefulSetå¿…é¡»ä¿è¯ä¸€ä¸ªPodä¸å†è¿è¡Œåï¼Œæ‰ä¼šå»åˆ›å»ºå®ƒçš„æ›¿æ¢Podã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/8-k8s-stafulset/","summary":"å‰é¢ä»‹ç»çš„å‡ ç§workloadéƒ½æœ‰ä¸€ä¸ªå…±æ€§ï¼Œé‚£å°±æ˜¯åˆ›å»ºå‡ºæ¥çš„Podéƒ½æ˜¯ä¸€è‡´çš„ã€‚æ‰€è°“çš„ä¸€è‡´å°±æ˜¯è¯´ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ReplicaSetï¼Œåˆ›å»ºäº†3ä¸ªPodï¼Œé‚£ä¹ˆè¿™3ä¸ªPodåˆ›äº†åå­—ä¸€å®šä¸ä¸€æ ·ä¹‹å¤–ï¼Œå…¶ä»–å±æ€§å¯èƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒåŒ…æ‹¬è¿è¡Œæ—¶çš„å‚æ•°å’Œæ¨¡å¼ä»¥åŠæ•°æ®å­˜å‚¨ã€‚\nå¦‚æœæ˜¯Web Serviceï¼Œæ•°æ®ä¿å­˜åˆ°åç«¯çš„DBä¸­ï¼Œä¸Šè¿°é€»è¾‘æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚\nå¦‚æœä½¿ç”¨ReplicaSetæ¥éƒ¨ç½²ä¸€ä¸ªDBçš„å¤šå®ä¾‹ï¼Œ å°±å¯è‚¯èƒ½å­˜åœ¨é—®é¢˜äº†ã€‚\næ•°æ®æŒä¹…åŒ–ï¼Œä¸€èˆ¬ä½¿ç”¨PVCï¼Œå½“ä½¿ç”¨PVC å’ŒPVçš„æ—¶å€™\nâ€‹\nReplicaSet -\u0026gt; Pods(3 ä¸ª) -\u0026gt; æŒä¹…å·å£°æ˜ -\u0026gt; æŒä¹…å·\n3ä¸ªPodçš„æ•°æ®éƒ½å†™åˆ°åŒä¸€ä¸ªPvä¸­ï¼Œè¿™æ ·è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Ÿï¼Ÿï¼Ÿ\nStatefulSet ä¸ºäº†è§£å†³Podçš„çŠ¶æ€æ€§çš„é—®é¢˜ï¼ŒK8så¼•å…¥äº†StatefulSetçš„æ¦‚å¿µ\nPodæœ‰å•ç‹¬çš„å­˜å‚¨å’Œå›ºå®šçš„ç½‘ç»œæ ‡è¯† éœ€è¦é…å¤‡ä¸€ä¸ªheadless Serviceï¼Œç”¨äºDNS å¯ä»¥é€šè¿‡DNSå¿«é€Ÿå‘ç°å…¶ä»–çš„Pod å¯ä»¥ç›´æ¥é€šè¿‡Pod DNSé€šä¿¡ æ¯ä¸ªPodéƒ½å¯ä»¥é€šè¿‡DNSè®¿é—®åˆ°ï¼Œè¿™ç§ç‰¹æ€§åœ¨å…¶ä»–workloadä¸­æ˜¯ä¸èƒ½å®ç°çš„ã€‚é€šè¿‡StatefulSetå¯ä»¥è®©PodæŒæœ‰çŠ¶æ€ï¼Œå³ä½¿å› ä¸ºæ•…éšœPodé‡å»ºäº†ï¼Œé‚£ä¹ˆå¯¹åº”çš„Podçš„åå­—å’Œæ•°æ®éƒ½ä¼šä¿ç•™ï¼Œå’Œé‡å»ºä¹‹å‰æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚\nä½¿ç”¨StatefulSet å¿…é¡»å»ºç«‹ä¸€ä¸ªHeadlessServiceï¼Œç„¶åç»‘å®šè¿™ä¸ªheadlessserviceåˆ°StatefulSetã€‚\nä»¥MongoDBä¸ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªStatefulSetï¼Œå› ä¸ºè¿˜æ²¡æœ‰ä»‹ç»åˆ°PVCå’ŒPVçš„å†…å®¹ï¼Œæ‰€ä»¥MongoDBå°†ä½¿ç”¨æœ¬åœ°å­˜å‚¨å·ã€‚\nåˆ›å»ºHeadless Service\nåˆ›å»º StatefulSet\né€šè¿‡DNSè®¿é—®Pod\nåœ¨StatefulSetçš„Podä¸­å¯ä»¥é€šè¿‡DNSç›´æ¥è®¿é—®å…¶ä»–Podã€‚\n1mongo --host mongo-1.mongo å¯ä»¥é€šè¿‡\u0026lt;pod-name\u0026gt;.\u0026lt;service-name\u0026gt;çš„å½¢å¼è®¿é—®Podã€‚è¿™å…¶å®å’ŒStatefulSetçš„è®¾è®¡æ˜¯æœ‰å…³ç³»çš„ï¼Œåœ¨ç±»ä¼¼çš„Deploymentä¸­Podçš„åå­—æ˜¯ä¸å›ºå®šçš„ï¼Œè€Œåœ¨StatefulSetä¸­ï¼ŒPodçš„åå­—æ˜¯å›ºå®šçš„ã€‚\nå’ŒReplicaSetå¯¹æ¯”\nå› ä¸ºæœ‰çŠ¶æ€çš„Podå½¼æ­¤ä¸åŒï¼Œé€šå¸¸å¸Œæœ›æ“ä½œçš„æ˜¯å…¶ä¸­çš„ç‰¹å®šçš„ä¸€ä¸ªï¼Œæ‰€ä»¥StatefulSeté€šå¸¸è¦æ±‚ä½ åˆ›å»ºä¸€ä¸ªç”¨æ¥è®°å½•æ¯ä¸ªPodç½‘ç»œæ ‡è®°çš„HeadlessServiceã€‚é€šè¿‡è¿™ä¸ªServiceï¼Œæ¯ä¸ªPodéƒ½æ‹¥æœ‰ç‹¬ç«‹çš„DNSè®°å½•ï¼Œè€Œè¿™åœ¨ReplicaSetä¸­æ˜¯ä¸è¡Œçš„ï¼Ÿï¼ˆå¦‚æœä¸ºReplicaSetåˆ›å»ºä¸€ä¸ªHeadless Serviceä¼šå‘ç”Ÿå•¥ï¼Ÿï¼‰ å› ä¸ºStatefulSetç¼©å®¹ä»»ä½•æ—¶å€™åªä¼šæ“ä½œä¸€ä¸ªPodå®ä¾‹ï¼Œæ‰€ä»¥æœ‰çŠ¶æ€åº”ç”¨çš„ç¼©å®¹ä¸ä¼šå¾ˆè¿…é€Ÿã€‚ StatefulSetåœ¨æœ‰å®ä¾‹ä¸å¥åº·çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸å…è®¸ç¼©å®¹çš„ã€‚ æŒä¹…å­˜å‚¨ ä¸€ä¸ªStatefulSetå¯ä»¥æ‹¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå·å£°æ˜æ¨¡æ¿ï¼Œè¿™äº›å£°æ˜ä¼šåœ¨åˆ›å»ºPodå‰åˆ›å»ºå‡ºæ¥ï¼Œç»‘å®šåˆ°ä¸€ä¸ªPodçš„å®ä¾‹ä¸Šã€‚ æ‰©å®¹StatefulSetä¼šåˆ›å»ºä¸¤ä¸ªAPIå¯¹è±¡ï¼Œä¸€ä¸ªPodå’Œä¸€ä¸ªå·å£°æ˜ï¼›ä½†æ˜¯ç¼©å®¹StatefulSetå´ä¼šåˆ é™¤ä¸€ä¸ªPodå¯¹è±¡ï¼Œè€Œä¼šç•™ä¸‹PVCï¼Œå› ä¸ºä¸€æ—¦åˆ é™¤PVCåˆ™æ„å‘³ç€PVä¼šè¢«å›æ”¶ã€‚ StatefulSet at-most-one\nKubernetes å¿…é¡»ä¿è¯ä¸¤ä¸ªæ‹¥æœ‰ç›¸åŒæ ‡è®°å’Œç»‘å®šç›¸åŒæŒä¹…å·å£°æ˜çš„æœ‰çŠ¶æ€çš„Podå®ä¾‹ä¸ä¼šåŒæ—¶è¿è¡Œã€‚ä¸€ä¸ªStatefulSetå¿…é¡»ä¿è¯æœ‰çŠ¶æ€çš„å®ä¾‹çš„ at-most-one è¯­ä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´StatefulSetå¿…é¡»ä¿è¯ä¸€ä¸ªPodä¸å†è¿è¡Œåï¼Œæ‰ä¼šå»åˆ›å»ºå®ƒçš„æ›¿æ¢Podã€‚","tags":null,"title":"K8s StafulSet"},{"categories":null,"contents":"Short Names and Categories Like native resources, custom resources might have long resources names. CRs can have short names as well.\nAgain, kubectl learns about short names via discovery information.\n1apiVersion: apiextensions.k8s.io/v1beta1 2kind: CustomResourcesDefinition 3metadata: 4\tname: ats.cnat.programming-kubernetes.info 5spec: 6\t... 7\tshortNames: 8\t- at Further, CRs\u0026ndash;as any other resources\u0026ndash;can be part of categories. The most common use is the all category, as in kubectl get all. Is lists all user-facing resources in a cluster, like pods and services.\nThe CRs define in the cluster can join a category or create their own category via the categories field.\n1apiVersion: apiextensions.k8s.io/v1beta1 2kind: CustomResourcesDefinition 3metadata: 4\tname: ats.cnat.programming-kubernetes.info 5spec: 6\t... 7\tcategories: 8\t- all Printer Cloumns The kubectl CLI tool users server-side printing to render the output of kubectl get. This means that it queries the API server for the columns to display and the values in each row.\nCustom resources support server-side printer columns as well, via additionalPrinterColumns\n1apiVersion: apiextensions.k8s.io/v1beta1 2kind: CustomResourcesDefinition 3metadata: 4\tname: ats.cnat.programming-kubernetes.info 5spec: 6\tadditionalPrinterColumns: # optional 7\t- name: kubectl column name 8\ttype: OpenAPI type for the colum 9\tformat: OpenAPI format for the column # optional 10\tdescription: human-readdable description of the column #optional 11\tpriority: integer, always zero supported by kubectl 12\tJSONPath: JSON path inside the CR for the despaly value With this, the example CRD from the introduction cloud be extend with addtionalPrinterColumns like this:\n1additionalPrinterColumns: # optional 2- name: schedule 3 type: string 4 JSONPath: .spec.schedule 5- name: command 6 type: string 7 JSONPath: .spec.command 8- name: phase 9 type: string 10 JSONPath: .status.phase Then the kubectl would render a cnat resource as follows:\n1$ kubectl get ats 2Name SCHEDULE COMMAND PHASE 3foo 2019-07-03T02:00:00Z echo \u0026#34;hello world\u0026#34; Pending A Developer\u0026rsquo;s View on Custom Resource Dynamic Client Typed Client Anatomy of a type Kinds are represented as Golang structs. Usually the struct is named as the kind and is placed in a package corresponding to the group and version of the GVK at hand. A common convention is to place the GVK group/version.Kind into a Go package pkg/apis/group/version and Define a Golang struct Kind int the file types.go.\nEvery Golang type corresponding to a GVK embeds the TypeMeta struct from the package k8s.io/apimachinery/pkg/apis/meta/v1. TypeMeta just contains of the Kind and ApiVersion fields.\n1type TypeMeta struct{ 2 APIVersion string `json:\u0026#34;apiVersion,omitempty\u0026#34; yaml:\u0026#34;apiVersion,omitempty\u0026#34;` 3 Kind string `json:\u0026#34;kind,omitempty\u0026#34; yaml:\u0026#34;kind,omitempty\u0026#34;` 4} In addition, every too-level kind\u0026ndash;that is, one that has its own endpoint and therefore one(or more) corresponding GVRs\u0026ndash;has to store a name, a namespace for namespaced resources, add a pretty long number of further metelevel fields. All these are stored in a struct called ObjectMeta in the package k8s.io/apimachinery/pkg/meta/v1:\n1type ObjectMeta struct{ 2 Name string `json:\u0026#34;name,omitempty\u0026#34;` 3 Namespace string `json:\u0026#34;namespace,omitempty\u0026#34;` 4 Labels map[string]string 5 Annotation map[string]string 6} Kubernetes top-level types look very similar to each other in the sense that they usually have a spec and a status. See this example of a deployment from k8s.io/kubernetes/apps/v1/types.go\n1type Deployment struct{ 2 metav1.TypeMeta `json:\u0026#34;,inline\u0026#34;` 3 metav1.ObjectMeta `json:\u0026#34;metadata,omitempty\u0026#34;` 4 5 Spec DeploymentSpec `json:\u0026#34;spec,ommitempty\u0026#34;` 6 Status DeploymentStatus `json:\u0026#34;status,omitempty\u0026#34;` 7} While actual content of the types for spec and status differs significantly between different types, this split into spec and status ia a common theme or event a convention in Kubernetes, though it\u0026rsquo;s not technically required. Hence, it is good practice to follow this sturcture of CRDs as well.\nGolang package structure As we have seen, the Golang types are traditionally placed in a file called types.go in the package pkg/apis/group/version. In addition to that file, there are couple more files we want to go through now. Some of them are manually written by the developer, while some are genereated with code generators.\nThe doc.go file describes the API\u0026rsquo;s purpose and includes a number of package-global code generation tags:\n1// package v1alpha1 contains the xxx v1alpha1 API Group 2 3// +k8s:deepcopy-gen=package 4// +k8s:protobuf-gen=package 5// +k8s:openapi-gen=true 6// +k8s:prerelease-lifecycle-gen=true 7// +groupName=cnat.programming-kubernetes.info 8package v1alpha1 Next, register.go includes helpers to register the custom resources Golang types into a scheme.\n1package version 2import ( 3\tmetav1 \u0026#34;k8s.io/apimachinery/pkg/apis/meta/v1\u0026#34; 4 \u0026#34;k8s.io/apimachinery/pkg/runtime\u0026#34; 5 \u0026#34;k8s.io/apimachinery/pkg/runtime/schema\u0026#34; 6 7 group \u0026#34;repo/pkg/apis/group\u0026#34; 8) 9 10// SchemeGroupVersion is group version used to register these objects 11var SchemeGroupVersion=scheme.GroupVersion{ 12 Group: group.GroupName 13 Version: \u0026#34;version\u0026#34; 14} 15 16// Kind takes an unqualified kind and retruns back a Group qualified GroupKind 17func Kind(kind string) scheme.GroupKind{ 18 return schemeGroupVersion.WithKind(kind).GroupKind 19} 20// Resource takes an unqualified resource and returns a Group qualified GroupResource 21func Resource(resource string) scheme.GroupResource{ 22 return schemeGroupVersion.WithResource(resource).GroupResource 23} 24 25var ( 26 SchemeBuilder = runtime.NewSchemeBuilder(addKnownTypes) 27 AddToScheme = SchemeBuilder.AddToScheme 28) 29 30// Adds the list of known types to Scheme 31func addKnownTypes(scheme *runtime.Scheme) error{ 32 scheme.AddKnownTypes( 33 SchemeGroupVersion, 34 \u0026amp;SomeKind{}, 35 \u0026amp;SomeKindList{} 36 ) 37 metav1.AddToGroupVersion(scheme, SchemeGroupVersion) 38 return nil 39} Then, zz_generated.deepcopy.godefines deep-copy methods on the custom resource Golang top-level types. In addition, all substruct become deep-copyable as well.\nBecause the example use the tag +k8s:deepcopy-gen=package in doc.go, the deepcopy generation is on an opt-out basis; that is, DeepCopy methods are genereaed for every type in the package that does not opt out with +k8s:deepcopy-gen=false.\nTyped Client created via client-gen With the API package pkg/apis/group/version in place, the client generator client-gen creates a typed client, in pkg/generated/clientset/versioned by default. More precisely, the generated top-level object is a client set. It subsumes a number of API groups, versions, and resources.\nThe top-level files looks like the following:\nController-runtime Client of Operator SDK and KubeBuilder The controller-runtime project provides the basis for the opetator solutions Operator SDK adn Kubebuilder.\nIt uses discovery information from the API server to map the kinds to HTTP path.\nHere is a quick example of how to use controller-runtime.\n1import ( 2\t\u0026#34;flag\u0026#34; 3 4 corev1 \u0026#34;k8s.io/api/core/v1\u0026#34; 5 metav1 \u0026#34;k8s.io/apimachinery/pkg/apis/meta/v1\u0026#34; 6 \u0026#34;k8s.io/client-go/kubernetes/scheme\u0026#34; 7 \u0026#34;k8s.io/client-go/tools/clientcmd\u0026#34; 8 9 runtimeclient \u0026#34;sig.k8s.io/controller-runtime/pkg/client\u0026#34; 10) 11 12func main(){ 13 kubeconfig = flag.String(\u0026#34;kubecofig\u0026#34;,\u0026#34;~/.kube/config\u0026#34;,\u0026#34;kubeconfig file path\u0026#34;) 14 flag.Parse() 15 config,err := clientcmd.BuildConfigFromFlag(\u0026#34;\u0026#34;,*kubeconfig) 16 cl,_ := runtimeclient.New(config, clientOptions{ 17 Scheme: sxcheme.Scheme 18 }) 19 podList := \u0026amp;corev1.PodList{} 20 err:= cl.List(context.TODO(), client.InNamespace(\u0026#34;default\u0026#34;), podList) 21} The\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_dev_client/","summary":"Short Names and Categories Like native resources, custom resources might have long resources names. CRs can have short names as well.\nAgain, kubectl learns about short names via discovery information.\n1apiVersion: apiextensions.k8s.io/v1beta1 2kind: CustomResourcesDefinition 3metadata: 4\tname: ats.cnat.programming-kubernetes.info 5spec: 6\t... 7\tshortNames: 8\t- at Further, CRs\u0026ndash;as any other resources\u0026ndash;can be part of categories. The most common use is the all category, as in kubectl get all. Is lists all user-facing resources in a cluster, like pods and services.","tags":null,"title":"K8s æºç é˜…è¯» 4"},{"categories":null,"contents":"Following sample-controller Bootstraping Business Logic We are now in the position to implement the business logic of the custom controller. That is, we implement the state transitions between the three phases\u0026ndash;form PhasePending to PhaseRuning to PhaseDone\u0026ndash;in controller.go.\nprocessNextWorkItem() processNextWorkItem() bool will read a single work item off the workquque and attempt to process it, by calling the syncHandler.\n1func (c *Controller) processNextWorkItem() bool{ 2 obj, shutdowon := c.workqueue.Get() 3 4 if shutdown{ 5 return false 6 } 7 8 // We wrap this block in a func so we can defer c.workqueue.Done. 9 err := func(obj interface{})error{ 10 // We call Done here so the workqueue knows we have finished processing this item. 11 // We also must remeber to call Forget if we do not want this work item being 12 // re-queued. For example, we do not call Forget if a transient error occurs, instead 13 // the item it put back on the workqueue and attempted again after a back-off period. 14 defer c.workqueue.Done(obj) 15 var key string 16 var ok bool 17 // We expect strings to come off the wordqueue. There are of the form namespace/name. 18 // We do this as the delayed nature of the workqueue means the iterms in the informer 19 // cache may actually be more up to date then when the item was initially put on to 20 // the workqueue. 21 if key,ok:=obj.(string);!ok{ 22 // As the item in the workqueue is actually invalid, we call Forget here else we\u0026#39;d 23 // go into a loop of attemping to process a work item that is invalid. 24 c.workqueue.Forget(obj) 25 // %#v print struct and content 26 ultiruntime.HandleError(fmt.Errorf(\u0026#34;expected string in workqueue but got %#v\u0026#34;,obj)) 27 return nil 28 } 29 // Run the syncHandler, passing it the namespace/name string of the Foo resource to 30 // be synced. 31 if err := c.syncHandler(key); err != nil{ 32 // Put the item back on the workqueue to handle any transient errors. 33 c.workqueue.AddRateLimited(key) 34 return fmt.Errorf(\u0026#34;err sync \u0026#39;%s\u0026#39;:\u0026#39;%s\u0026#39;, requeuing\u0026#34;,key, error.Error(jj)) 35 } 36 // Finally, if no error occurs we Forget this item so it dose not get queued again 37 // until another change happens. 38 c.workqueue.Forget(obj) 39 klog.Infof(\u0026#34;Successfully synced \u0026#39;%s\u0026#39;\u0026#34;,key) 40 return nil 41 }(obj) 42 43 if err != nil { 44 utilruntime.HandleError(err) 45 return true 46 } 47 return true 48} `\nsyncHandler() syncHandler(key string) compares the actual state with the desired, and attempts to converge the two. It then updates the Status block of the Foo resource with the current status of the resource.\n1func (c *Controller) syncHandler(key string) error{ 2 // Convert the namespace/name string into a distinct namespace and name. 3 namespace, name, err := cache.SplitMetaNamespaceKey(key) 4 if err != nil{ 5 utilruntime.HandleError(fmt.Errorf(\u0026#34;invalid resource key :%s\u0026#34;,key)) 6 return nil 7 } 8 9 // Get the Foo resource with this namespace/name 10 foo, err:= c.foosLister.Foos(namespace).Get(name) 11 if err != nil{ 12 // The foo resource may no longer exist, in which case we stop processing. 13 if errors.IsNotFound(err){ 14 utilruntime.HandleError(fmt.Errorf(\u0026#34;foo \u0026#39;%s\u0026#39; in working queue no longer exists\u0026#34;)) 15 return nil 16 } 17 return err 18 } 19 20 deploymentName := foo.Spec.DeploymentName 21 if deploymentName == \u0026#34;\u0026#34;{ 22 // we choose to absord the error here as the worker would requeue 23 // the resource otherwise. Instead, the next time the resource is update the 24 // resource will be queued again. 25 return nil 26 } 27 28 // Get the deployment with the name specified in Foo.spce 29 deployment, err := c.deploymentLister.Deployments(foo.Namespace).Get(deployment) 30 // If the resource doesn\u0026#39;t exist, we\u0026#39;ll create it 31 if errors.IsNotFound(err){ 32 deployment, err = c.kubeclinetset.AppsV1().Deployments(foo.Namespace). 33 Create(context.TODO,newDeployment(foo),metav1.CreatedOptions{}) 34 } 35 if err != nil{ 36 return nil 37 } 38 39 // If the Deployment is not controllerd by this Foo resource, we should log 40 // a warning to the event recorder and return error msg. 41 if !metav1.IsControlledBy(deployment, foo){ 42 msg := fmt.Sprintf(MessageResourceExists, deployment.Name) 43 c.recorder.Event(foo, corev1.EventTypeWarning, ErrorResourceExists,msg) 44 return fmt.Errorf(\u0026#34;%s\u0026#34;,msg) 45 } 46 47 // If this number of the replicas on the Foo resource is specified, and the number 48 // does not equal the current desired replicas on the Deployment, we should updated 49 // the Deployment resource 50 if foo.Spce.Replicas != nil \u0026amp;\u0026amp; *foo.Spec.Replicas != *deployment.Spec.Replicas{ 51 deployment, err != c.kubeclientset.AppsV1().Deployments(foo.Namespase). 52 Update(context.TODO),newDeployment(foo),metav1.UpdateOptions{}) 53 } 54 if err != nil{ 55 return err 56 } 57 58 err = c.updateFooStatus(foo,deployment) 59 if err != nil{ 60 return err 61 } 62 c.recorder.Event(foo, corev1.EventTypeNormal, SuccessSynced,MessageResourceS) 63 64} Kubebuilder Create a Project 1source \u0026lt; $(kubebuilder completion zsh) 2# --repo git the git module name 3kubebuilder init --domain bytegopher.com --license apache2 --owner \u0026#34;ByteGopher\u0026#34; --repo www.github.com/airren/cnat-kubebuilder 4 5 6kubebuilder create api --group cnat --version v1alpha1 --kind CronJob 7 8# if you are editing the API definitions, generate the manifest such as Custom Resources(CRs) or Custom Resource Definitions(CRDs) using 9make manifest Architecture Concept Diagram The following diagram will help you better understand the Kubernetes concepts and architecture.\nProcess main.go One of these per cluster, or several if using HA.\nManger sigs.k8s.io/controller-runtime/pkg/manger One of these per process.\nHandles HA(leader election), exports metrics, handles webhook certs, caches events, holds clients, broadcasts events to Controllers, handles signals, and shutdown.\nClient\u0026hellip; Communicates with API server, handling authentication and protocols.\nCache\u0026hellip; Holds recently watched or GET\u0026rsquo;ed objects. Used by Controllers, and Webhooks. Uses clients.\nController sigs.k8s.io/controller-runtime/pkg/controller One of these per Kind that is reconciled (i.e. one per CRD)\nOwns resources created by it.\nUses Caches and Clients and gets events via Filters.\nThe controller calls a Reconciler each time it gets an event.\nHandles back-off and queuing and re-queuing of events.\nPredicate sigs.k8s.io/controller-runtime/pkg/predicate Filters a stream of events, passing only those that require action to the reconciler.\nReconciler sig.k8s.io/controller-runtile/pkg/reconciler User-provided logic is added to the reconciler. Reconcile Function.\nWebhook sigs.k8s.io/controller-runtime/pkg/webhook Zero or one webhooks. One per Kind that is reconciled.\nScheme Every set of controllers needs a Scheme, which provides mappings between Kinds and their corresponding Go types. The Scheme is simply a way to keep track of what Go type correspond to a given GVK.\nReconcile We return an empty result and no error, which indicates to controller-runtime that we\u0026rsquo;ve successfully reconciled this object and don\u0026rsquo;t need to try again until there\u0026rsquo;s some changes.\nkustomize controller-gen CLI What is controller-gen? Kubebuilder makes use of a tool called controller-gen for generating utility code and Kubernetes YAML. This code and config generation is controlled by the presence of special \u0026ldquo;marker comments\u0026rdquo; in Go code.\ncontroller-gen is built out of different \u0026ldquo;generators\u0026rdquo; (which specify what to generate) and \u0026ldquo;output rules\u0026rdquo;(which specify how and where to write the results). Both are configured through command line options specified in marker format.\n1controller-gen paths=./... crd:trivialVersions-true rbac:roleName=controller-perms \\ 2\toutput:crd:artifacts:config=config/crd/bases Generate CRDs and RBAC, and specifically stores the generated CRD yaml in config/crd/base. For the RBAC, it uses the default output rules(config/rbac). It considers every package in the current directory tree(as per the normal rules of the go ...wild card).\nHow to use controller-gen? Generators 1// +webhook on package 2generates(partial) {Mutating,Validating}WebhookConfiguration objects. 3// +schemapatch: on package 4pathes existing CRDs with new schemata. 5// +rbac:roleName=\u0026lt;string\u0026gt; on package 6generates ClusterRole objects 7// +object: on package 8generate code containing DeepCopy, DeepCopyInto, and DeepCopyObject method implementations. 9// +crd on package 10generates CustomResourceDefination objects. Output Rules Output rules configure how a given generator outputs its results. There is always one global \u0026ldquo;fallback\u0026rdquo; output rule(specified as output:\u0026lt;rule\u0026gt;), plus per-generator overrides(specified as output:\u0026lt;generator\u0026gt;:\u0026lt;rule\u0026gt;).\nDefault Rules: When no fallback rules is specified manually, a set of default per-generator rules are used which result in YAML going to config/\u0026lt;generator\u0026gt;, and code staying where is belongs.\nThe default rules are equivalent to output:\u0026lt;generator\u0026gt;:artifacts:config=config/\u0026lt;generator\u0026gt; for each generator.\nMarker for Config/Code Generation Makers are single-line commnets that start with a plus, followed by a marker name, optionally followed by some marker specific configuration.\n1// +kubebuilder:validation:Optional 2// +kubebuilder:validation:MaxItems=2 3// +kubebuilder:printcolumn:JSONPath=\u0026#34;.status.replicas\u0026#34;,name=Replicas, type=string CRD Generation These markers describe how to construct a custom resource definition form a series of Go types and packages. Generation of the actual validation schema is described by the validation markers.\nCalling the Generators Usually, the code generators are called in mostly the same way in every controller project.\nHere, all means to call all four standard code generators for CRs.\ndeepcopy-gen\nGenerate func(t *T)DeepCopy() *T and func(t *T)DeepCopyInfo(*T) method.\nclient-gen\nCreates typed client sets\ninformer-gen\nCreates informers for CRs that offer an event-base interface to react to changes of CRs on the server.\nlister-gen\nCreates lister for CRs that offer a read-only caching layer for GET and LIST request.\nThe last two are the basis for building controllers. These four code generator make up a powerful basis for building full-featured, production-ready controllers using the same mechanisms and packages that the Kubernetes upstream controllers are using.\nControlling the Generators with Tags While some of the code-generator behavior is controlled via command-line flags as described earlier, a lot more properties are controlled via tags in you Go files. A tag is a specially formatted Go comment in the following form.\n1// +some-tag 2// +some-other-tag=value There are to kind of tags:\nGlobal tags above the package line in a file called doc.go Local tags above a type declaration. ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_dev_operator_kubebuilder/","summary":"Following sample-controller Bootstraping Business Logic We are now in the position to implement the business logic of the custom controller. That is, we implement the state transitions between the three phases\u0026ndash;form PhasePending to PhaseRuning to PhaseDone\u0026ndash;in controller.go.\nprocessNextWorkItem() processNextWorkItem() bool will read a single work item off the workquque and attempt to process it, by calling the syncHandler.\n1func (c *Controller) processNextWorkItem() bool{ 2 obj, shutdowon := c.workqueue.Get() 3 4 if shutdown{ 5 return false 6 } 7 8 // We wrap this block in a func so we can defer c.","tags":null,"title":"K8s æºç é˜…è¯» 6 Solutions for Writing Operators"},{"categories":null,"contents":"In this chapter we\u0026rsquo;ll discuss the operational aspects of controllers and operators, showing you how to package them, walking you through best practices for running controllers in production, and making sure that your extension points don\u0026rsquo;t break your Kubernetes cluster, security, or performance-wise.\nLifecycle Management and Packaging Let\u0026rsquo;s start with the low-hanging fruit: packaging and delivering your controllers so that a user can install it in a straightforward manner.\nPackaging: The Challenge While Kubernetes defines resources with manifest, typically written in YAML, a low-level interface to declare the state of resources, these manifest files have shortcoming. Most importantly in the context of packaging containerized apps, the YAML manifests are static; that is, all values in a YAML manifest are fixed. This means that if you want to change the container images in a deployment manifest, for example, you have to create a new manifest.\nLet\u0026rsquo;s look a concrete example, Assume you have the following Kubernetes deployment encoded in a YAML manifest called mycontroller.yaml, representing the custom controller you\u0026rsquo;d like user to install:\n1apiVersion: apps/v1beta1 2kind: Deployment 3metadata: 4\tname: mycustomcontroller 5spec: 6\treplicas: 1 7\ttemplate: 8\tmetadata: 9\tlabels: 10\tapp: customcontroller 11 spec: 12 containers: 13 - name: thecontroller 14 images: example/controller:0.1.0 15 ports: 16 - containerPort: 9999 17 env: 18 - name: REGION 19 value: eu-west-1 Imagine the environment variable REGION defines certain runtime properties of you controller, such as the availability of other service like a managed service mesh. In other words, while the default values eu-west-1 might be a sensible one, users can and likely will overwrite it, based on their own preferences or policies.\nNow, given that the YAML manifest mycontroller.yaml itself is a static file with all values defined at the time of writing \u0026ndash; and clients such as kubectl don\u0026rsquo;t inherently support variable parts in the manifest \u0026ndash; how do you enable users to supply variable values or overwrite existing values at runtime? That is, how in the preceding example can a user set REGION to, say, us-east-2 when they\u0026rsquo;re installing it, using (for example) kubeclt apply?\nTo overcome these limitations of build-time, static YAML manifest in Kubernetes, there are a few options to templatize the manifest (Helm, for example) or otherwise enable variable input (Kustomize), depending on user-provided values or runtime properties.\nHelm Helm, which touts itself as the package manager for Kubernetes, was originally developed by Deis and is now a Cloud Native Computing Foundation(CNCF) project with major contributors form Microsoft, Google, and Bitnami(now pat of VMware).\nHelm helps you to install and upgrade Kubernetes applications by defining and applying so-called charts, effectively parameterized YAML manifests. Here is an excerpt of an example chart template.\n1apiVersion: apps/v1 2kind: Deployment 3metadata: 4 name: {{ include \u0026#34;flagger.fullname\u0026#34; .}} 5... 6spec: 7\treplicas: 1 8\tstrategy: 9\ttype: Recreate 10\tselector: 11\tmatchLabels: 12\tapp.kubernetes.io/name: {{ template \u0026#34;flagger.name\u0026#34; .}} 13\tapp.kubernetes.io/instance: {{ .Release.Name }} 14\ttemplate: 15\tmetadata: 16\tlabels: 17\tapp.kubernetes.io/name: {{ template \u0026#34;flagger.name\u0026#34; .}} 18\tapp.kubernetes.io/instance: {{ .Release.Name }} 19\tsepc: 20\tserviceAccountName: {{ template \u0026#34;flagger.serviceAccountName\u0026#34; .}} 21\tcontainers: 22\t- name: flagger 23\tsecurityContext: 24\treadOnlyRootFileSystem: true 25\trunAsUser: 10001 26\timage: \u0026#34;{{ .Values.image.repository }}:{{ .Values.image.tag }}\u0026#34; 27\tAs you can see, variables are encoded in {{ ._Some.value.here_ }} format, which happens to be Go templates.\nTo install a chart, you can run the helm install command. While Helm has several ways to find and install charts, the easiest is to use on of the official stable charts:\n1# get the latest list of charts 2helm repo update 3 4# install MySQL 5helm install stable/mysql 6 7# list running apps 8helm ls 9 10# remove it 11helm delete \u0026lt;helm name\u0026gt; In order to package you controller, you will need to create a Helm Chart for it and publish it somewhere, by default to a public repository indexed and accessible through the Helm hub.\nHelm is popular, partly because of it ease of use for end users. However, some argue the current Helm architecture introduces security risks. The good news is that the community is actively working on addressing those.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_dev_operator_release/","summary":"In this chapter we\u0026rsquo;ll discuss the operational aspects of controllers and operators, showing you how to package them, walking you through best practices for running controllers in production, and making sure that your extension points don\u0026rsquo;t break your Kubernetes cluster, security, or performance-wise.\nLifecycle Management and Packaging Let\u0026rsquo;s start with the low-hanging fruit: packaging and delivering your controllers so that a user can install it in a straightforward manner.\nPackaging: The Challenge While Kubernetes defines resources with manifest, typically written in YAML, a low-level interface to declare the state of resources, these manifest files have shortcoming.","tags":null,"title":"K8s æºç é˜…è¯»7"},{"categories":null,"contents":"Pod\nåœ¨Kubernetesä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯èµ„æºï¼Œä½ å¯ä»¥é€šè¿‡create/get/describe/delete æ¥æ“ä½œè¿™äº›èµ„æºã€‚\nåœ¨æ“ä½œä¸€ç§èµ„æºä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹è¿™ä¸ªèµ„æºè¿›è¡Œå®šä¹‰ï¼Œåœ¨k8sä¸­å¸¸ç”¨çš„æ˜¯yamlé…ç½®æ–‡ä»¶é…ç½®ã€‚\n1# 00-siample-pod.yaml 2--- 3apiVersion: v1 4kind: Pod 5metadata: 6 name: first-pod 7 labels: 8 app: nginx 9spec: 10 containers: 11 - name: 00-simple-pod-nginx 12 images: nginx:1.17.0 apiVersionï¼šèµ„æºçš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç†è§£ä¸ºä½ è¦åˆ›å»ºçš„æ˜¯ PodV1{}è¿˜æ˜¯PodVn{}\nkind: èµ„æºçš„ç±»å‹\nmetadataï¼š\nâ€‹\tnameï¼š åˆ›å»ºå‡ºæ¥çš„èµ„æºçš„åå­—\nâ€‹ labelsï¼šä¸å…¶ä»–èµ„æºç²’åº¦æˆ–è€…æ“ä½œçš„å…³è”\nspec: èµ„æºçš„å‚æ•°\né€šè¿‡kubectl apply -fåˆ›å»ºèµ„æº\n1kubectl apply -f 00-simple-pod.yaml å¦‚æœéœ€è¦æ›´æ–°èµ„æºï¼Œä¿®æ”¹yamlåï¼Œé‡æ–°kubectl apply -f xxx.yaml å°±å¯ä»¥ã€‚\nè·å–PodçŠ¶æ€\n1kubectl get pod first-pod 2# get more detail 3kubectl get pod first-pod -o wide 4# get all pods of all-namespace 5kubectl get po -A è·å–Pod è¯¦æƒ…\n1kubectl describe pod first-pod Pod çŠ¶æ€\nPendingï¼š K8så·²ç»æ¥å—äº†Podçš„é…ç½®ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰åˆ›å»ºå®¹å™¨ï¼Œå¯èƒ½è¿˜åœ¨æ‹‰å–é•œåƒæˆ–è€…è°ƒåº¦ä¸æˆåŠŸ Runningï¼šPodå·²ç»è°ƒåº¦æˆåŠŸï¼Œå¹¶ä¸”å·²ç»å’ŒæŸä¸ªnodeç»‘å®šäº†ï¼Œæ‰€æœ‰çš„å®¹å™¨éƒ½è¢«åˆ›å»º Succeeded: Podä¸­æ‰€æœ‰å®¹å™¨éƒ½å·²ç»æˆåŠŸè¿è¡Œå®Œæ¯•å¹¶é€€å‡º Failed: Podä¸­è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨ä»¥ä¸æ­£å¸¸çš„çŠ¶æ€é€€å‡ºã€‚ UnKnown: Podçš„çŠ¶æ€ä¸èƒ½è¢«kubeletæ±‡æŠ¥ç»™kube-apiserverï¼Œ è¿™å¯èƒ½æ˜¯workå’Œmasterçš„é€šè®¯å‡ºç°äº†é—®é¢˜ã€‚ ContainerçŠ¶æ€\nWaitingï¼š Default state of container. If container not in Running or Terminated state, it is in Waiting state. A container in Waiting state still runs its required operations, like pulling images, applying secrets, etc. Along with this state, a message and reson about the state are dispalyed to provide more infomation. Running: Indicates that the container is executing without issues. Once a container enters into Running, postStart hook(if any) is executed. This state also displays the time when the container entered Running state. Terminated: Indicates that the container completed its execution and has stoped running. A container enters into this when it has successfully completed execution or when it has failed for some reason. Regardless, a reason and exit code is displayed, as well as the container\u0026rsquo;s start and finish time. Before a container enters into Terminated, preStop hook(if any) is executed. æ—¥å¿—\n1 2# æŸ¥çœ‹podæ—¥å¿— 3kubectl logs \u0026lt;pod-name\u0026gt; 4# æŸ¥çœ‹podä¸­containerçš„æ—¥å¿— 5kubectl logs \u0026lt;pod-name\u0026gt; -c \u0026lt;container-name\u0026gt; æ¯å¤©æˆ–è€…æ¯æ¬¡æ—¥å¿—åˆ°è¾¾10MBå¤§å°æ—¶ï¼Œå®¹å™¨æ—¥å¿—éƒ½ä¼šè‡ªåŠ¨è½®æ›¿ã€‚kubectl logsä»…èƒ½æ˜¾ç¤ºæœ€åä¸€æ¬¡è½®æ›¿åçš„æ—¥å¿—æ¡ç›®ã€‚ åªèƒ½è·å–ä»ç„¶å­˜åœ¨çš„podçš„æ—¥å¿—ã€‚å½“ä¸€ä¸ªpodè¢«åˆ é™¤æ—¶ï¼Œä»–çš„æ—¥å¿—ä¹Ÿä¼šè¢«ç§»é™¤ã€‚ å¤–åœ°è®¿é—®pod\nå°†æœ¬åœ°ç½‘ç»œç«¯å£è½¬å‘åˆ°podä¸­çš„ç«¯å£\n1kubectl port-forward æ³¨è§£\nå‘kubernetes å¼•å…¥æ–°ç‰¹æ€§æ—¶ï¼Œé€šå¸¸ä¹Ÿä¼šä½¿ç”¨æ³¨è§£ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ–°åŠŸèƒ½çš„alphaå’Œbetaç‰ˆæœ¬ä¸ä¼šå‘APIå¯¹è±¡å¼•å…¥ä»»ä½•æ–°å­—æ®µï¼Œå› æ­¤ä½¿ç”¨çš„æ˜¯æ³¨è§£è€Œä¸æ˜¯å­—æ®µï¼Œä¸€æ—¦æ‰€æœ‰çš„APIå˜æ›´å˜å¾—æ¸…æ™°ï¼Œå¹¶ä¸”å¾—åˆ°æ‰€æœ‰ç›¸å…³äººå‘˜çš„è®¤å¯ï¼Œå°±ä¼šå¼•å…¥æ–°çš„å­—æ®µï¼Œå¹¶åºŸå¼ƒç›¸å…³æ³¨è§£ã€‚\nå¤§é‡ä½¿ç”¨æ³¨è§£å¯ä»¥ä¸ºæ¯ä¸ªpodæˆ–å…¶ä»–APIå¯¹è±¡æ·»åŠ è¯´æ˜ã€‚ä»¥ä¾¿æ¯ä¸ªä½¿ç”¨è¯¥é›†ç¾¤çš„äººéƒ½å¯ä»¥å¿«é€ŸæŸ¥æ‰¾æœ‰å…³æ¯ä¸ªå•ç‹¬å¯¹è±¡çš„ä¿¡æ¯ã€‚\nPod æ¢é’ˆ\nä¸‰ç§ç±»å‹çš„handler\nExecActionï¼š Executes a specified sommand inside the container. The diagnostic is considered successful if the command exits with a status code of 0. CPSocketAction: Performs a TCP check against the container\u0026rsquo;s IP adress on a specified port. The diagnostic is consider successful if the port is open. TPGetAction: Performs and HTTP GET request against the Container\u0026rsquo;s IP adderess on a specified port and path. The diagnostic is considered successful if the response has a status code grater than or equal to 200 and less than 400. ä¸‰ç§æ¢é’ˆç»“æœ\nSuccess: The container passed the diagnostic Failure: The container failed the diagnostic Unknown: The diagnostic failed, so no action should be taken. é‡å¯ç­–ç•¥\nAlways OnFailure Never ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/2-k8s-pod/","summary":"Pod\nåœ¨Kubernetesä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯èµ„æºï¼Œä½ å¯ä»¥é€šè¿‡create/get/describe/delete æ¥æ“ä½œè¿™äº›èµ„æºã€‚\nåœ¨æ“ä½œä¸€ç§èµ„æºä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹è¿™ä¸ªèµ„æºè¿›è¡Œå®šä¹‰ï¼Œåœ¨k8sä¸­å¸¸ç”¨çš„æ˜¯yamlé…ç½®æ–‡ä»¶é…ç½®ã€‚\n1# 00-siample-pod.yaml 2--- 3apiVersion: v1 4kind: Pod 5metadata: 6 name: first-pod 7 labels: 8 app: nginx 9spec: 10 containers: 11 - name: 00-simple-pod-nginx 12 images: nginx:1.17.0 apiVersionï¼šèµ„æºçš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç†è§£ä¸ºä½ è¦åˆ›å»ºçš„æ˜¯ PodV1{}è¿˜æ˜¯PodVn{}\nkind: èµ„æºçš„ç±»å‹\nmetadataï¼š\nâ€‹\tnameï¼š åˆ›å»ºå‡ºæ¥çš„èµ„æºçš„åå­—\nâ€‹ labelsï¼šä¸å…¶ä»–èµ„æºç²’åº¦æˆ–è€…æ“ä½œçš„å…³è”\nspec: èµ„æºçš„å‚æ•°\né€šè¿‡kubectl apply -fåˆ›å»ºèµ„æº\n1kubectl apply -f 00-simple-pod.yaml å¦‚æœéœ€è¦æ›´æ–°èµ„æºï¼Œä¿®æ”¹yamlåï¼Œé‡æ–°kubectl apply -f xxx.yaml å°±å¯ä»¥ã€‚\nè·å–PodçŠ¶æ€\n1kubectl get pod first-pod 2# get more detail 3kubectl get pod first-pod -o wide 4# get all pods of all-namespace 5kubectl get po -A è·å–Pod è¯¦æƒ…","tags":null,"title":"Kubenetes Pod"},{"categories":null,"contents":"Controller and Operator In this section you\u0026rsquo;ll learn about controllers and operators in Kubernetes and how they work.\nThe API server has the following core responsibilities:\nTo serve the Kubernetes API. This API is used cluster-internally by the master components, the worker nodes, and you Kubernetes-native apps, as well as externally by clients such as kubectl. To proxy cluster components, such as the Kubernetes dashboard, or stream logs, services ports, or serve kubectl exec sessions. Per the Kubernetes glossary, a controller implements a control loop, watching the shared state of the cluster throught the API Server and making changes in an attempt to move the current state toward the desired state.\nBefor we dive into the controller\u0026rsquo;s inner working, let\u0026rsquo;s define our terminology:\nControllers can act on core resources such as deployments or services, which are typically part of Kubernetes controller manager in the control plane, or can watch and manipulate user-defined custome resources. Operatirs are controllers that encode some opetational knowledge, such as application lifecycle management, along with the custome resources. The Control Loop In general, the control loop looks as follows:\nRead the state of resources, preferably event-driven. Change the state of the objects in the cluster or the cluster-external world. For example, launch a pod, create a network endpoint, or query a cloud API. Update status of the resource in step 1 via the API server in etcd. Repeat cycle; return to step 1. From an architectural point of view, a controller typically uses the following data structures.\nInformers Informers watch the desired state of the resources in a scalable and sustainable fashion. They also implement a resync mechanism that enforces periodic reconciliation, and is often used to make sure that the cluster state and the assumend state cached in memory do not drift (e.g., due bugs or network issues).\nThe API Server The API server is the central management entity and the only component that talks directly with the distributed storage components etcd.\nThe API server has the following core responsibilities :\nTo server the Kubernets API. This API is used cluster-internally by the master components, the work nodes, and you Kubernetes-native apps, as well as externally by clinets such as kubectl. To proxy cluster components, such as the Kubernetes dashboard, or to stream logs, service ports, or serve kubectl exec session. Serving the API means:\nReading state: getting single objects, listing them, and streaming changes Manipulating state: creating, updating, and deleting objects State is persisted via etcd.\nThe HTTP Interface of the API Server From a clinet\u0026rsquo;s perspective, the API service expose a RESTful HTTP API with JSON or protocol buffer(protobuf for short) payload, which is used mainly for cluster-internal communication, for performance reasons.\nThe API server HTTP interface handles HTTP requests to query and manipulate Kubernetes resources using the following HTTP verbs(or HTTP methods).\n1kubectl -n THENAMESPACE get pods 2curl -XGET /api/v1/namespaces/THENAMESPACE/pods API Terminology Before we get into the API business, let\u0026rsquo;s first define the terms used in the context of the Kubernetes API server.\nKind The type of an entity. Each object has a field Kind(lowercase kind in JOSN, capitalized Kind in Golang), which tells a client such as kubectl that it represent, for example, a pod. There are three categories of kinds.\nObjects represent a persistent entity in the system \u0026ndash; for example, Pod or Endpoints. Objects have names, and many of the live in namespaces. Lists are collections of one or more kinds of entities. List have a limit set of common metadata. Examples include PodLists or NodeLists. When you do a kubectl get pods, that\u0026rsquo;s exactly what you get. Special-purpose kinds are used for specific actions on objects and for nonpersistent entities such as /binding or /scale. For discovery, Kubernetes use APIGroup and APIResource; for error results, it use Status. In Kubernetes programs, a kind directly corresponds with a Golang type. Thus, as a Golang type, kinds are singular and begin with a capital letter.\nAPI group A collection of Kinds that are logically related. For example, all batch objects like Job or ScheduledJob are in the batch API group.\nVersion Each API group can exist in multiple versions, and most of them do. For examples, a group first appears as v1alpha1 and is then promoted to v1beta1 and finally graduates to v1. An object created in one version can be retrieved in each of the supported version. The API server does the lossless conversion to return objects in the requested version. From the cluster user\u0026rsquo;s point of view, versions are just different representations of the same objects.\nTIP\nThere is no such thing as \u0026ldquo;on object is in v1 in the cluster, and another object is in v1beta1 in the cluster.\u0026rdquo; Instead, every object can be returned as v1 representation or v1alpha1 representation, as the cluster user desires.\nResource A usually lowercase, plural word(e.g., pods) identifying as a set of HTTP endpoints(paths) exposing the CRUD semantics of a certain object type in the system. Common path are:\nThe root, such as .../pods, which list all instances of that type. A path for individual named resources, such as ..../pods/nginx. Typically, each of this endpoints returns and receives one kind(a PodList in the first case, and a Pod in the second). But in other situations, a Status kind object is returned.\nIn addition to the main resource with full CRUD semantics, a resource can have further endpoints to perform specific actions(e.g., .../pod/nginx/port-forward, ../pod/nginx/exec, or .../pod/nginx/logs). We call these subresources. These usually implement custom protocols instead of REST \u0026ndash; for example, some kind of streaming connections via WebSocket or imperative APIs.\nTIP\nResources and kinds are often mixed up. Note the clear distinction:\nResources correspond to HTTP paths Kind are the type of objects returned by and received by these endpoints, as well as persisted into etcd. Resources are always part of an API group and a version, collectively referred to as GroupVersionResource(or GVR). A GVR unique defines an HTTP path.\nKubernets API Versioning Declarative State Management TIP\nState vs. Status\nState: the particular condition that someone or something is in at a specific time.\nStatus: the situation at a particular time during a process.\nState is used to describe a stage in a process (e.g. pending/dispatched).\nStatus is used to describe an outcome of an operation (e.g. success/fail).\nStatus is a final (resulting) State.\nLet\u0026rsquo;s talk a little more about spec(desired state) versus status(observed state) in the context of the API server.\nHow the API Server Processes the requests API HTTP handler -\u0026gt; authn \u0026amp; authz -\u0026gt; Mutating adminssion -\u0026gt; Object schema validation -\u0026gt; Validating admission -\u0026gt; Presisting to etcd\nSo, what actually happens now when an http requests hits the Kubernetes API? On a high level, the following interactions take place:\nK8s version v1.23.0\nname\nkind\nshortNames\ncategories\nresources\napi/v1 1k get --raw /api/v1 | jq -c \u0026#39;.resources[]|{name,kind,shortNames,categories}\u0026#39; apis/batch 1k get --raw /apis/batch/v1 | jq -c \u0026#39;.resources[]|{name,kind,shortNames,categories}\u0026#39; apis/apps/v1 1k get --raw /apis/apps/v1 | jq -c \u0026#39;.resources[]|{name,kind,shortNames,categories}\u0026#39; deepcopy-gen deepcopy-gen æ˜¯ä¸€ä¸ªè‡ªåŠ¨ç”ŸæˆDeepCopyå‡½æ•°çš„ä»£ç ç”Ÿæˆå™¨ã€‚ç»™å®šä¸€ä¸ªåŒ…çš„ç›®å½•è·¯å¾„ä½œä¸ºè¾“å…¥æºï¼Œå®ƒå¯ä»¥ä¸ºå…¶ç”ŸæˆDeepCopyç›¸å…³å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥æœ‰æ•ˆçš„æ‰§è¡Œæ¯ç§ç±»å‹çš„æ·±å¤åˆ¶æ“ä½œã€‚\nGroups and Versions An API Group in Kubernetes is simply a collection of related functionality. Each group has one or more versions,\nKinds and Resources Each API group-version contains one or more API types, which we call Kinds.\nA resource is simply a use of Kind in the API. Often, there\u0026rsquo;s a one-to-one maping between Kinds and resources. For intance, the pods resource crooesponds to the Pod Kind. However, sometimes, the same Kind may be returned by multiple resources. For instances, the Scale Kind is returned by all scale subresources, like deployments/scale or replicatsets/scale. With CRD, however, each Kind will correspond to a single resource.\nWhen we refer to a kind in a particular group-version, we\u0026rsquo;ll call it a GroupVersionKind, or GVK for short. Same with resources and GVR. As we\u0026rsquo;ll see shortly, each GVK corresponds to a given root Go type in package.\nScheme The Scheme is simply a way to keep track of what Go type corresponds to a given GVK.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_dev_2_api_server/","summary":"Controller and Operator In this section you\u0026rsquo;ll learn about controllers and operators in Kubernetes and how they work.\nThe API server has the following core responsibilities:\nTo serve the Kubernetes API. This API is used cluster-internally by the master components, the worker nodes, and you Kubernetes-native apps, as well as externally by clients such as kubectl. To proxy cluster components, such as the Kubernetes dashboard, or stream logs, services ports, or serve kubectl exec sessions.","tags":null,"title":"Kubernetes API Basic"},{"categories":null,"contents":"Kubernetes 1.16 æ­£å¼GAäº†CRDã€‚\nCRDä»‹ç» å£°æ˜å¼ç¼–ç¨‹ åœ¨Kubernetesä¸­æˆ‘ä»¬ä½¿ç”¨äº†Deployment/DamenSet/tatefulSetæ¥ç®¡ç†åº”ç”¨workdloadï¼Œä½¿ç”¨Service/Ingressæ¥ç®¡ç†åº”ç”¨çš„\nhttps://zhuanlan.zhihu.com/p/34445114\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/10-k8s-crd/","summary":"Kubernetes 1.16 æ­£å¼GAäº†CRDã€‚\nCRDä»‹ç» å£°æ˜å¼ç¼–ç¨‹ åœ¨Kubernetesä¸­æˆ‘ä»¬ä½¿ç”¨äº†Deployment/DamenSet/tatefulSetæ¥ç®¡ç†åº”ç”¨workdloadï¼Œä½¿ç”¨Service/Ingressæ¥ç®¡ç†åº”ç”¨çš„\nhttps://zhuanlan.zhihu.com/p/34445114","tags":null,"title":"Kubernetes CRD"},{"categories":null,"contents":"Replication Controller 1# replica.yaml 2--- 3apiVersion: v1 4kind: ReplicationController 5metadata: 6 name: first-replic 7spec: 8 replicas: 3 9 template: 10 metadata: 11 name: simple-pod 12 labels: 13 app: simple-pod 14 spec: 15 containers: 16 - name: timemachine 17 image: lukelau/rest-docker:0.0.1 18 args: 19 - -server.addr=0.0.0.0:8000 ä»¥ä¸Šé…ç½®ä¼šä¿è¯Podçš„æ•°é‡ç¨³å®šä¸º3ä¸ªã€‚å½“æˆ‘ä»¬åˆ é™¤ä¸€ä¸ªPodä¹‹åï¼ŒReplication Controllerå°±ä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„Podæ¥ç»´æŒPodçš„æ•°é‡ã€‚\nRCä¹‹æ‰€ä»¥ä¼šå‘ç°Podå·²ç»æŒ‚æ‰äº†ï¼Œæ˜¯å› ä¸ºæ¢é’ˆ(Container probes)çš„å­˜åœ¨ã€‚åœ¨K8sä¸­ï¼Œ kubeletä¼šé€šè¿‡æŒ‡å®šçš„æ¢é’ˆæ–¹å¼å»æ¢æµ‹å®¹å™¨æ˜¯å¦å­˜æ´»ã€‚\nä¸‰ç§æ¢é’ˆæ–¹å¼\nä¸‰ç§ç±»å‹çš„handler\nExecActionï¼š Executes a specified sommand inside the container. The diagnostic is considered successful if the command exits with a status code of 0. CPSocketAction: Performs a TCP check against the container\u0026rsquo;s IP adress on a specified port. The diagnostic is consider successful if the port is open. TPGetAction: Performs and HTTP GET request against the Container\u0026rsquo;s IP adderess on a specified port and path. The diagnostic is considered successful if the response has a status code grater than or equal to 200 and less than 400. å½“ä½ çš„Podçš„å¥åº·æ¢é’ˆæ¢æµ‹å‘ç°Podçš„ä¸å¥åº·æ¬¡æ•°è¶…è¿‡è®¾å®šçš„æ¬¡æ•°çš„æ—¶å€™ï¼Œé‚£ä¹ˆRCå°±ä¼šå°†è¿™ä¸ªæœ‰é—®é¢˜çš„Podåˆ é™¤(æ²¡æœ‰restartæ“ä½œ)ï¼Œç„¶åå†åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„æ¥ã€‚RCè¿˜ä¼šæ£€æµ‹Podçš„å½“å‰æ•°é‡ï¼Œå¦‚æœä¸è¶³åˆ™ä¼šåˆ›å»ºï¼Œå¦‚æœå°äºåˆ™ä¼šå…³æ‰ä¸€äº›Podã€‚\nReplicaSet ReplicaSet çš„Selectorä¼šæ¯”ReplicationControllerå¼ºå¤§ä¸€äº›ã€‚\n1--- 2apiVersion: apps/v1 3kind: ReplicaSet 4metadata: 5 name: first-replic-set 6spec: 7 selector: 8 matchLabels: 9 app: simple-pod-set 10 replicas: 3 11 12 template: 13 metadata: 14 name: simple-pod-set 15 labels: 16 app: simple-pod-set 17 spec: 18 containers: 19 - name: timemachine 20 image: lukelau/rest-docker:0.0.1 21 args: 22 - -server.addr=0.0.0.0:8000 selector å˜å¾—å¤æ‚äº†ï¼Œé™¤äº†matchLabelsä¹‹å¤–ï¼Œè¿˜æ”¯æŒmatchExpressionsã€‚\nDeploymentå·²ç»å°†å†…ç½®çš„replicaé›†ä»ReplicationControllerè½¬æˆReplicaSetäº†ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/4-k8s-replic/","summary":"Replication Controller 1# replica.yaml 2--- 3apiVersion: v1 4kind: ReplicationController 5metadata: 6 name: first-replic 7spec: 8 replicas: 3 9 template: 10 metadata: 11 name: simple-pod 12 labels: 13 app: simple-pod 14 spec: 15 containers: 16 - name: timemachine 17 image: lukelau/rest-docker:0.0.1 18 args: 19 - -server.addr=0.0.0.0:8000 ä»¥ä¸Šé…ç½®ä¼šä¿è¯Podçš„æ•°é‡ç¨³å®šä¸º3ä¸ªã€‚å½“æˆ‘ä»¬åˆ é™¤ä¸€ä¸ªPodä¹‹åï¼ŒReplication Controllerå°±ä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„Podæ¥ç»´æŒPodçš„æ•°é‡ã€‚\nRCä¹‹æ‰€ä»¥ä¼šå‘ç°Podå·²ç»æŒ‚æ‰äº†ï¼Œæ˜¯å› ä¸ºæ¢é’ˆ(Container probes)çš„å­˜åœ¨ã€‚åœ¨K8sä¸­ï¼Œ kubeletä¼šé€šè¿‡æŒ‡å®šçš„æ¢é’ˆæ–¹å¼å»æ¢æµ‹å®¹å™¨æ˜¯å¦å­˜æ´»ã€‚\nä¸‰ç§æ¢é’ˆæ–¹å¼\nä¸‰ç§ç±»å‹çš„handler\nExecActionï¼š Executes a specified sommand inside the container. The diagnostic is considered successful if the command exits with a status code of 0.","tags":null,"title":"Kubernetes Replication Controller"},{"categories":null,"contents":"Podæ˜¯æœ€å°çš„å•å…ƒï¼Œ å¾€å¾€æˆ‘ä»¬åœ¨è¿è¡Œä¸€ä¸ªåº”ç”¨çš„æ—¶å€™ï¼Œå¯¹Podæœ‰ä¸€äº›é¢å¤–çš„è¦æ±‚ï¼Œä¾‹å¦‚é«˜å¯ç”¨æˆ–è€…å¤šå®ä¾‹ï¼Œè¿™å°±æ„å‘³ç€å¦‚æœä½ åªè®°ä½ä¸€ä¸ªPodçš„IPï¼Œé‚£ä¹ˆå¾ˆå¤šæ—¶å€™æ—¶æœ‰é—®é¢˜çš„ã€‚ ä¾‹å¦‚é«˜å¯ç”¨ï¼Œå¯èƒ½ä¼šå› ä¸ºPodçš„é‡å»ºè€Œæ”¹å˜ï¼Œè¿™æ ·ä½ è®°ä½çš„é‚£ä¸ªIPå°±å¤±æ•ˆäº†ã€‚ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•å°±æ˜¯å›ºå®šIPã€‚\nä¸ºä»€ä¹ˆè¦ä½¿ç”¨service\nå› ä¸ºK8sé‡Œé¢çš„Podæ˜¯å¯ä»¥è¢«è°ƒåº¦çš„ï¼Œå¹¶ä¸”é‡å»ºçš„ï¼Œæ‰€ä»¥æ²¡æœ‰å›ºå®šçš„IP Podçš„æ•°é‡å¯èƒ½ä¸åªä¸€ä¸ªï¼Œå½“æœ‰å¤šä¸ªPodå®ä¾‹çš„æ—¶å€™è´Ÿè½½å‡è¡¡çš„éœ€æ±‚ã€‚ 1# service.yaml 2--- 3apiVersion: v1 4kind: Service 5metadata: 6 name: first-service 7spec: 8 type: NodePort 9 selector: 10 app: nginx 11 ports: 12 - protocol: TCP 13 port: 5580 14 targetPort: 80 15 nodePort: 32280 selector è¿‡æ»¤æºå¸¦label app=nginxçš„pod\ntargetPortï¼š pod æä¾›æœåŠ¡çš„ç«¯å£\nserviceä»£ç†Podçš„å†…éƒ¨ç«¯å£ä¸º5580ï¼š å†…éƒ¨è®¿é—®ï¼Œå›ºå®šIPï¼šPort\nserviceä»£ç†Podçš„å¤–éƒ¨ç«¯å£ä¸º32280ï¼Œ é€šè¿‡k8sé›†ç¾¤çš„IPï¼Œå¯ä»¥è¿›è¡Œ å¤–éƒ¨å¯è®¿é—®\n1# create service 2kubectl apply -f service.yaml 3# get service status 4kubectl get service first-service å¤–éƒ¨è®¿é—®service\nä¸Šé¢è¿™ä¸ªé…ç½®ä¹‹æ‰€ä»¥å¯ä»¥åœ¨å¤–éƒ¨è®¿é—®ï¼Œæ˜¯å› ä¸ºåˆ¶å®šäº†Serviceçš„Typeä¸ºNodePortï¼Œ åœ¨K8sä¸­å¦‚æœä¸æŒ‡å®šè¿™ä¸ªTypeçš„è¯ï¼Œserviceæ—¶åªèƒ½åœ¨K8sé›†ç¾¤å†…éƒ¨è®¿é—®çš„ï¼Œé›†ç¾¤å¤–éƒ¨æ˜¯è®¿é—®ä¸äº†çš„ã€‚\né›†ç¾¤å¤–éƒ¨è®¿é—®çš„è®¾ç½®æ–¹å¼ï¼š\nNodePort LoadBalancerï¼š ä¸€èˆ¬åªæœ‰åœ¨å…±æœ‰äº‘ä¸Šä½¿ç”¨ Ingress: è¿™ä¸ªä¸æ˜¯L4çš„ä»£ç†ï¼Œè€Œæ˜¯L7çš„æ–¹å¼ã€‚ å†…éƒ¨è®¿é—®service\nå¯¹äºserviceçš„è®¿é—®ï¼Œ å†…éƒ¨æ˜¯é€šè¿‡DNSæ¥è¿›è¡Œçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ å®šä¹‰äº†ä¸€ä¸ªserviceä¹‹åï¼ŒK8så°±ç›¸åº”çš„ç”Ÿæˆäº†ä¸€æ¡DNSè®°å½•ã€‚è¿™ä¸ªserviceå¯¹åº”çš„å†…éƒ¨åŸŸåå°±æ˜¯\u0026lt;cluster-name\u0026gt;.\u0026lt;namespace\u0026gt;.svc.cluster.local,åœ¨æ²¡æœ‰è´´åˆ«åˆ¶å®šserviceç±»å‹çš„æ—¶å€™ï¼Œä»–è¿”å›çš„æ—¶serviceçš„ClusterIPï¼›å¦‚æœä½ è®¾ç½®äº†serviceçš„ClusterIPä¸ºNoneï¼Œ é‚£ä¹ˆè¿”å›çš„å°±æ˜¯æ‰€æœ‰è¢«ä»£ç†çš„Podçš„IPåœ°å€çš„é›†åˆã€‚\nClusterIPæ¨¡å¼çš„Serviceæä¾›çš„æ˜¯ä¸€ä¸ªPodçš„ç¨³å®šIPåœ°å€ï¼Œå³VIPï¼Œè¿™é‡ŒPod å’Œserviceçš„å…³ç³»æ˜¯é€šè¿‡Labç¡®è®¤çš„ã€‚ Headless Serviceæä¾›çš„åˆ™æ˜¯ä¸€ä¸ªPodç¨³å®šçš„DNSåå­—ï¼Œå¹¶ä¸”è¿™ä¸ªåå­—æ˜¯é€šè¿‡Podåå­—å’ŒServiceåå­—æ‹¼æ¥å‡ºæ¥çš„ã€‚ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/3-k8s-service/","summary":"Podæ˜¯æœ€å°çš„å•å…ƒï¼Œ å¾€å¾€æˆ‘ä»¬åœ¨è¿è¡Œä¸€ä¸ªåº”ç”¨çš„æ—¶å€™ï¼Œå¯¹Podæœ‰ä¸€äº›é¢å¤–çš„è¦æ±‚ï¼Œä¾‹å¦‚é«˜å¯ç”¨æˆ–è€…å¤šå®ä¾‹ï¼Œè¿™å°±æ„å‘³ç€å¦‚æœä½ åªè®°ä½ä¸€ä¸ªPodçš„IPï¼Œé‚£ä¹ˆå¾ˆå¤šæ—¶å€™æ—¶æœ‰é—®é¢˜çš„ã€‚ ä¾‹å¦‚é«˜å¯ç”¨ï¼Œå¯èƒ½ä¼šå› ä¸ºPodçš„é‡å»ºè€Œæ”¹å˜ï¼Œè¿™æ ·ä½ è®°ä½çš„é‚£ä¸ªIPå°±å¤±æ•ˆäº†ã€‚ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•å°±æ˜¯å›ºå®šIPã€‚\nä¸ºä»€ä¹ˆè¦ä½¿ç”¨service\nå› ä¸ºK8sé‡Œé¢çš„Podæ˜¯å¯ä»¥è¢«è°ƒåº¦çš„ï¼Œå¹¶ä¸”é‡å»ºçš„ï¼Œæ‰€ä»¥æ²¡æœ‰å›ºå®šçš„IP Podçš„æ•°é‡å¯èƒ½ä¸åªä¸€ä¸ªï¼Œå½“æœ‰å¤šä¸ªPodå®ä¾‹çš„æ—¶å€™è´Ÿè½½å‡è¡¡çš„éœ€æ±‚ã€‚ 1# service.yaml 2--- 3apiVersion: v1 4kind: Service 5metadata: 6 name: first-service 7spec: 8 type: NodePort 9 selector: 10 app: nginx 11 ports: 12 - protocol: TCP 13 port: 5580 14 targetPort: 80 15 nodePort: 32280 selector è¿‡æ»¤æºå¸¦label app=nginxçš„pod\ntargetPortï¼š pod æä¾›æœåŠ¡çš„ç«¯å£\nserviceä»£ç†Podçš„å†…éƒ¨ç«¯å£ä¸º5580ï¼š å†…éƒ¨è®¿é—®ï¼Œå›ºå®šIPï¼šPort\nserviceä»£ç†Podçš„å¤–éƒ¨ç«¯å£ä¸º32280ï¼Œ é€šè¿‡k8sé›†ç¾¤çš„IPï¼Œå¯ä»¥è¿›è¡Œ å¤–éƒ¨å¯è®¿é—®\n1# create service 2kubectl apply -f service.yaml 3# get service status 4kubectl get service first-service å¤–éƒ¨è®¿é—®service\nä¸Šé¢è¿™ä¸ªé…ç½®ä¹‹æ‰€ä»¥å¯ä»¥åœ¨å¤–éƒ¨è®¿é—®ï¼Œæ˜¯å› ä¸ºåˆ¶å®šäº†Serviceçš„Typeä¸ºNodePortï¼Œ åœ¨K8sä¸­å¦‚æœä¸æŒ‡å®šè¿™ä¸ªTypeçš„è¯ï¼Œserviceæ—¶åªèƒ½åœ¨K8sé›†ç¾¤å†…éƒ¨è®¿é—®çš„ï¼Œé›†ç¾¤å¤–éƒ¨æ˜¯è®¿é—®ä¸äº†çš„ã€‚","tags":null,"title":"Kubernetes Service"},{"categories":null,"contents":"nc Netcat(or nc) is a command-line utility that reads and write data across network connections, using the TCP or UDP protocols. It is one of the most powerful tools in the network and system administrators arsenal, and it as considered as a Swiss army knife of networking tools.\nNetcat is cross-platform, and it\u0026rsquo;s available for Linux, macOS, Windows , and BSD. You can use Netcat to debug and monitor network connections, scan for open ports, transfer data, as a proxy and more.\nThe Netcat package is pre-installed on macOS and popular Linux distributions like Ubuntu, Debian or CentOS.\nhttps://liugp.blog.csdn.net/article/details/118633171?spm=1001.2101.3001.6650.1\u0026utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_paycolumn_v3\u0026depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_paycolumn_v3\u0026utm_relevant_index=2\nReference https://linuxize.com/post/netcat-nc-command-with-examples/\ntelnet å‘½ä»¤ æµ‹è¯•æŸä¸ªç«¯å£æ˜¯å¦é€š\nnc å‘½ä»¤ ncçš„å…¨åæ˜¯netcatï¼Œå…¶ä¸»è¦ç”¨é€”æ˜¯å»ºç«‹å’Œç›‘å¬ä»»æ„TCPå’ŒUDPè¿æ¥ï¼Œæ”¯æŒipv4å’Œipv6ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç½‘ç»œè°ƒè¯•ã€ç«¯å£æ‰«æç­‰ç­‰ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_command/","summary":"nc Netcat(or nc) is a command-line utility that reads and write data across network connections, using the TCP or UDP protocols. It is one of the most powerful tools in the network and system administrators arsenal, and it as considered as a Swiss army knife of networking tools.\nNetcat is cross-platform, and it\u0026rsquo;s available for Linux, macOS, Windows , and BSD. You can use Netcat to debug and monitor network connections, scan for open ports, transfer data, as a proxy and more.","tags":null,"title":"Linux Network Command"},{"categories":null,"contents":"Internet domain socket Unix domain socket You can forward the unix domain socket with the -R option of the ssh command.\n1ssh -R remote_socket:local_socket https://github.com/nikhilroxtomar/Multiple-Client-Server-Program-in-C-using-fork\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/linux_socket/","summary":"Internet domain socket Unix domain socket You can forward the unix domain socket with the -R option of the ssh command.\n1ssh -R remote_socket:local_socket https://github.com/nikhilroxtomar/Multiple-Client-Server-Program-in-C-using-fork","tags":null,"title":"Linux socket"},{"categories":null,"contents":"HomeBrew 1/bin/bash -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\u0026#34; 1brew install wget 2 3brew install go Software Chrome\nTypora\nIstat Menus\nAlfred\nDash\nWireshark\nSublime\nModify Keys settings -\u0026gt; Keyboard -\u0026gt; modifyKeys\nTools 1apt install vim git tmux golang Vim 1# ~/.vimrc 2cat \u0026lt;\u0026lt;EOF| tee -a ~/.vimrc 3set nu 4syntax on 5inoremap jj \u0026lt;ESC\u0026gt; 6 7 8set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936 9set termencoding=utf-8 10set encoding=utf-8 11 12\u0026#34; show existing tab with 4 spaces width 13set tabstop=4 14\u0026#34; when indenting with \u0026#39;\u0026gt;\u0026#39;, use 4 spaces width 15set shiftwidth=4 16\u0026#34; On pressing tab, insert 4 spaces 17set expandtab 18 19EOF oh my zsh 1sudo apt install zsh 2sh -c \u0026#34;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)\u0026#34; 3 4# sudo chsh -s $(which zsh) Golang 1sudo apt install golang 2 3echo \u0026#39; 4GOPATH=~/go 5GOBIN=$GOPATH/bin 6PATH=$PATH:$GOBIN 7\u0026#39;| tee -a ~/.zshrc Proxy 1echo \u0026#39;function proxy_on() { 2 export no_proxy=\u0026#34;localhost,127.0.0.1/8,arch,.localdomain.com,10.239.154.51/16\u0026#34; 3 4 local proxy=\u0026#34;http://child-prc.intel.com:913\u0026#34; 5 export http_proxy=\u0026#34;$proxy\u0026#34; \\ 6 https_proxy=$proxy \\ 7 all_proxy=$proxy \\ 8 ftp_proxy=$proxy \\ 9 rsync_proxy=$proxy \\ 10 HTTP_PROXY=$proxy \\ 11 HTTPS_PROXY=$proxy \\ 12 FTP_PROXY=$proxy \\ 13 RSYNC_PROXY=$proxy 14} 15 16function proxy_off(){ 17 unset http_proxy https_proxy all_proxy ftp_proxy rsync_proxy \\ 18 HTTP_PROXY HTTPS_PROXY FTP_PROXY RSYNC_PROXY no_proxy 19 echo -e \u0026#34;Proxy environment variable removed.\u0026#34; 20} 21 22proxy_on\u0026#39; | tee -a ~/.bashrc 23 24EOF 25 26# Install zsh 27cat \u0026lt;\u0026lt;EOF | sudo tee /etc/apt/apt.conf.d/proxy.conf 28Acquire::http::Proxy \u0026#34;http://child-prc.intel.com:913\u0026#34;; 29Acquire::https::Proxy \u0026#34;http://child-prc.intel.com:913\u0026#34;; 30EOF Font hack\nK8s for zsh 1echo \u0026#39;source \u0026lt;(kubectl completion zsh)\u0026#39; \u0026gt;\u0026gt;~/.zshrc 2echo \u0026#39;alias k=kubectl\u0026#39; \u0026gt;\u0026gt;~/.zshrc 3echo \u0026#39;compdef __start_kubectl k\u0026#39; \u0026gt;\u0026gt;~/.zshrc 4source ~/.zshrc NetWork Tools 1brew install iproute2mac ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/Mac_init/","summary":"HomeBrew 1/bin/bash -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\u0026#34; 1brew install wget 2 3brew install go Software Chrome\nTypora\nIstat Menus\nAlfred\nDash\nWireshark\nSublime\nModify Keys settings -\u0026gt; Keyboard -\u0026gt; modifyKeys\nTools 1apt install vim git tmux golang Vim 1# ~/.vimrc 2cat \u0026lt;\u0026lt;EOF| tee -a ~/.vimrc 3set nu 4syntax on 5inoremap jj \u0026lt;ESC\u0026gt; 6 7 8set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936 9set termencoding=utf-8 10set encoding=utf-8 11 12\u0026#34; show existing tab with 4 spaces width 13set tabstop=4 14\u0026#34; when indenting with \u0026#39;\u0026gt;\u0026#39;, use 4 spaces width 15set shiftwidth=4 16\u0026#34; On pressing tab, insert 4 spaces 17set expandtab 18 19EOF oh my zsh 1sudo apt install zsh 2sh -c \u0026#34;$(wget https://raw.","tags":null,"title":"Mac Init"},{"categories":null,"contents":"The marker - means ignore the err of this line command\n@ only prints the result of command.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/linux_make/","summary":"The marker - means ignore the err of this line command\n@ only prints the result of command.","tags":null,"title":"Make"},{"categories":null,"contents":"What is Multi-Clusters Multi-cluster Kubernetes is a kubernetes deployments method that consists of to or more clusters. This deployment method is highly flexible. You can have clusters on the same physical host or different hosts in the same data center. You can also create a multi-cloud environment with clusters living in different clouds and even in different countries.\ncluster network connections: https://submariner.io/getting-started/\nhttps://isovalent.com/data/multi-cluster-ebook.pdf\nMulti clusters server deployment: https://github.com/karmada-io/karmada\nhttps://github.com/clusternet/clusternet\nSubmariner Submariner allows pods to directly communicate between Kubernetes clusters\nSubmariner is secure - it uses establishes IPsec tunnels between clusters\nSubmariner is CNI-agnostic, it operator at a layer independent of you network provider.\nHandling cluseters with overlapping CIDRs Handling overlapping CIDRs is being developd by the submariner team, the implementation is based on a global overlay CIDR which will be used for colliding clusters.\nQuestion Brief introduction of Openshift?Rancher?\nReference:\nUnderstanding Multi-Cluster Kubernetes: Architecture, Benefits, and Challenges\nhttps://www.mirantis.com/cloud-native-concepts/getting-started-with-kubernetes/what-is-kubernetes-multi-cluster/\nhttps://www.cncf.io/blog/2021/04/12/simplifying-multi-clusters-in-kubernetes/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/multi-cluster/","summary":"What is Multi-Clusters Multi-cluster Kubernetes is a kubernetes deployments method that consists of to or more clusters. This deployment method is highly flexible. You can have clusters on the same physical host or different hosts in the same data center. You can also create a multi-cloud environment with clusters living in different clouds and even in different countries.\ncluster network connections: https://submariner.io/getting-started/\nhttps://isovalent.com/data/multi-cluster-ebook.pdf\nMulti clusters server deployment: https://github.com/karmada-io/karmada\nhttps://github.com/clusternet/clusternet\nSubmariner Submariner allows pods to directly communicate between Kubernetes clusters","tags":null,"title":"Multi-Cluster Kubernetes"},{"categories":null,"contents":"Image ovn4nfv-k8s-plugin NFN-Operator Exposes virtual, provider chaning CRDs to external world Programs OVN to create L2 switch Watches for PODs being coming up Assigns IP address ofr every network of the deployments Looks for replics and auto create routes for chaning to work Create LBs for distributing the load across CNF replicas OVN4NFV NFN-Agent Performs CNI operations Configuration VLAN and Routes in Linux Kernel(in case of ruotes, it cloud do it in both root and network namespace) Communicates with OVSDB to inform og provider interface. ( create ovs bridge and creates external-ids: ovn-bridge-mappings) OVN-Images OVN control plane and OVN controller take care of OVN configuration and installation in each node in Kubernetes. NFN operator runs in the Kubernetes master and NFN agent run as daemonset in each node.\n1# /usr/local/bin/ovn4nfv-k8s.sh OVN-Control-Plane / Deploymentï¼š replicas=1 1expose: 6441/ 6442 2 3command: [\u0026#34;ovn4nfv-k8s\u0026#34;, \u0026#34;start_ovn_control_plane\u0026#34;] 4 5Probe: \u0026#34;ovn4nfv-k8s\u0026#34;, \u0026#34;check_ovn_control_plane\u0026#34; OVN-Controller / DaemonSet 1command: \u0026#34;ovn4nfv-k8s\u0026#34;, \u0026#34;start_ovn_controller\u0026#34; 2Probe: \u0026#34;ovn4nfv-k8s\u0026#34;, \u0026#34;check_ovn_controller OVN command\nLibvirt install\n1sudo apt install -y qemu libvirt-bin ebtables dnsmasq-base 2sudo apt install -y libxslt-dev libxml2-dev libvirt-dev zlib1g-dev ruby-dev Open vSwitch ovs-vsctl Configures ovs-vswitchd, but really a high-level interface for database\novsdb-tool: command line for managing database file\novsdb-tool show-log [-mmm] ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/nodus/nodus-architecture/","summary":"Image ovn4nfv-k8s-plugin NFN-Operator Exposes virtual, provider chaning CRDs to external world Programs OVN to create L2 switch Watches for PODs being coming up Assigns IP address ofr every network of the deployments Looks for replics and auto create routes for chaning to work Create LBs for distributing the load across CNF replicas OVN4NFV NFN-Agent Performs CNI operations Configuration VLAN and Routes in Linux Kernel(in case of ruotes, it cloud do it in both root and network namespace) Communicates with OVSDB to inform og provider interface.","tags":null,"title":"Nodus"},{"categories":null,"contents":"SFC for IPV6 vagrant file updte:\nmount a local file to the VM\n1config.vm.synced_folder \u0026#34;/home/ubuntu/qiang/nodus-1.24/SDEWAN-SetUp/\u0026#34;, \u0026#34;/home/vagrant/mnt\u0026#34; vagrant version update to 2.2.19\n1vagrant_version=2.2.19 enable ipv4_forward in calico configuration\nupdate ovn deploy yaml: update image tag, update ovn_subnet\n1 OVN_SUBNET: \u0026#34;10.154.141.0/18\u0026#34; 2OVN_GATEWAYIP: \u0026#34;10.154.141.1/18\u0026#34; 3 4 5 privileged: true 6 mountPropagation: Bidirectional 1apiVersion: k8s.plugin.opnfv.org/v1alpha1 2kind: NetworkChaining 3metadata: 4 name: example-networkchaining 5spec: 6 # Add fields here 7 chainType: \u0026#34;Routing\u0026#34; 8 routingSpec: 9 namespace: \u0026#34;default\u0026#34; 10 networkChain: \u0026#34;net=virtual-net1,app=slb,net=dync-net1,app=ngfw,net=dync-net2,app=sdewan,net=virtual-net2\u0026#34; 11 left: 12 - networkName: \u0026#34;left-pnetwork\u0026#34; 13 gatewayIp: \u0026#34;172.30.10.2\u0026#34; 14 subnet: \u0026#34;172.30.10.0/24\u0026#34; 15 podSelector: 16 matchLabels: 17 sfc: head 18 namespaceSelector: 19 matchLabels: 20 sfc: head 21 right: 22 - networkName: \u0026#34;right-pnetwork\u0026#34; 23 gatewayIp: \u0026#34;172.30.20.2\u0026#34; 24 subnet: \u0026#34;172.30.20.0/24\u0026#34; 25 podSelector: 26 matchLabels: 27 sfc: tail 28 namespaceSelector: 29 matchLabels: 30 sfc: tail Question:\nWhat the relationship between the life/right and NetworkChaining feild?\nWhy we can have multiple left/right?\nIn the ValidateNetworkingChaining I fount the network namespce is hard code to default, is that means all of the Virtual Network should be define in default namespace?\nDoese and the networkChain feild must start and end with a VirtualNetwork. Do you have a topolody of the ProvideNetwork and VirtualNetwork?\nProvidedNetwork must combine with a host network interface.\nVirtual is just a OVN virtual switch?\nSFC : VirtualMode and ProviderMode\nas long as there is one end is not VirtualNetwork, this is ProviderMode.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/nodus/nodus-dev/","summary":"SFC for IPV6 vagrant file updte:\nmount a local file to the VM\n1config.vm.synced_folder \u0026#34;/home/ubuntu/qiang/nodus-1.24/SDEWAN-SetUp/\u0026#34;, \u0026#34;/home/vagrant/mnt\u0026#34; vagrant version update to 2.2.19\n1vagrant_version=2.2.19 enable ipv4_forward in calico configuration\nupdate ovn deploy yaml: update image tag, update ovn_subnet\n1 OVN_SUBNET: \u0026#34;10.154.141.0/18\u0026#34; 2OVN_GATEWAYIP: \u0026#34;10.154.141.1/18\u0026#34; 3 4 5 privileged: true 6 mountPropagation: Bidirectional 1apiVersion: k8s.plugin.opnfv.org/v1alpha1 2kind: NetworkChaining 3metadata: 4 name: example-networkchaining 5spec: 6 # Add fields here 7 chainType: \u0026#34;Routing\u0026#34; 8 routingSpec: 9 namespace: \u0026#34;default\u0026#34; 10 networkChain: \u0026#34;net=virtual-net1,app=slb,net=dync-net1,app=ngfw,net=dync-net2,app=sdewan,net=virtual-net2\u0026#34; 11 left: 12 - networkName: \u0026#34;left-pnetwork\u0026#34; 13 gatewayIp: \u0026#34;172.","tags":null,"title":"Nodus Dev Note"},{"categories":null,"contents":"Home Page: https://wiki.ith.intel.com/display/ITSODMS/Observability+Data+Management+Suite+Home\n[TOC]\nOperator Prometheus-operator https://prometheus-operator.dev/\nhttps://github.com/prometheus-operator/prometheus-operator\nThe prometheus operator manages the Promentheus Clust atop Kubernetes.\nOpentelemetry-operator https://github.com/open-telemetry/opentelemetry-operator\nKubernetes reflector https://github.com/emberstack/kubernetes-reflector\nReflector is a Kubernetes addon designed to monitor changes to resources (secrets and configmaps) and reflect changes to mirror resources in the same or other namespaces.\nOpenTelemetry Agent \u0026amp; Gateway Configure by CR opentelemetrycollectors.opentelemetry.io\nAgent collect Metric, Logs, and can add labels or attributes, and finally push the data to the opentelemetry gateway.\nGateway receive the data from all of the Agent, and store the data to prometheus, jaeger and elasticsearch.\nMetrics Jaeger Metrics Exporter Telegraf\ncAdvisor\neBPF-exporter\nIPMI-exporter\nEMON-exporter\nOpenTelemetry-Collector\nPrometheus Service Discovery prometheus discovery metrics api by CR servicemonitors.monitoring.coreos.com.\nFor kubernetes components metrics, add servicemonitor by kube-prometheus-stack.\n1NAMESPACE NAME AGE 2default odms-grafana 2d19h 3default odms-kube-prometheus-alertmanager 2d19h # kube-prometheus-stack 4default odms-kube-prometheus-apiserver 2d19h # kube-prometheus-stack 5default odms-kube-prometheus-coredns 2d19h # kube-prometheus-stack 6default odms-kube-prometheus-kube-controller-manager 2d19h # kube-prometheus-stack 7default odms-kube-prometheus-kube-etcd 2d19h # kube-prometheus-stack 8default odms-kube-prometheus-kube-proxy 2d19h # kube-prometheus-stack 9default odms-kube-prometheus-kube-scheduler 2d19h # kube-prometheus-stack 10default odms-kube-prometheus-kubelet 2d19h # kube-prometheus-stack 11default odms-kube-prometheus-prometheus 2d19h # kube-prometheus-stack 12default odms-kube-state-metrics 2d19h 13default odms-otel-gateway-monitor 2d19h # Metrics for otel 14default odms-prometheus-node-exporter 2d19h 15odms-operators odms-kube-prometheus-operator 17d # kube-prometheus-stack Grafana Configure DataResource 1kind: ConfigMap 2metadata: 3 labels: 4 app: odms-otel-grafana 5 grafana_datasource: \u0026#34;1\u0026#34; # label for grafane, who is the operator? 6 name: odms-otel-grafana-datasource 7 namespace: default 8apiVersion: v1 9data: 10 datasource.yaml: |- 11 apiVersion: 1 12 datasources: 13 - name: \u0026#34;Prometheus\u0026#34; Configure DashBoard 1apiVersion: v1 2kind: ConfigMap 3metadata: 4 labels: 5 grafana_dashboard: \u0026#34;1\u0026#34; # label for grafane, who is the operator? 6 name: odms-dashboards 7 namespace: default 8data: 9\tCPU.json: |- 10\t# dashboard json configuration NFS Where is the grafana dashboras configuration? Where is the data resource of Metrics, Log \u0026amp; Trace? Reference How to install and configure an NFS server on Ubuntu\nNFS external provisioner\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/odms-install/","summary":"Home Page: https://wiki.ith.intel.com/display/ITSODMS/Observability+Data+Management+Suite+Home\n[TOC]\nOperator Prometheus-operator https://prometheus-operator.dev/\nhttps://github.com/prometheus-operator/prometheus-operator\nThe prometheus operator manages the Promentheus Clust atop Kubernetes.\nOpentelemetry-operator https://github.com/open-telemetry/opentelemetry-operator\nKubernetes reflector https://github.com/emberstack/kubernetes-reflector\nReflector is a Kubernetes addon designed to monitor changes to resources (secrets and configmaps) and reflect changes to mirror resources in the same or other namespaces.\nOpenTelemetry Agent \u0026amp; Gateway Configure by CR opentelemetrycollectors.opentelemetry.io\nAgent collect Metric, Logs, and can add labels or attributes, and finally push the data to the opentelemetry gateway.","tags":null,"title":"ODMS Install"},{"categories":null,"contents":"Configuration Server side Server.conf\n1# /etc/openvpn/server/server.conf 2local 10.0.0.230 3port 1194 4proto udp 5dev tun 6ca ca.crt 7cert server.crt 8key server.key 9dh dh.pem 10auth SHA512 11tls-crypt tc.key 12topology subnet 13client-config-dir /etc/openvpn/ccd # bind ip with client name 14route 192.166.0.0 255.255.255.0 # route add to server side 15push \u0026#34;route 192.167.0.0 255.255.255.0\u0026#34; # route add to client side 16server 10.8.0.0 255.255.255.0 17push \u0026#34;redirect-gateway def1 bypass-dhcp\u0026#34; 18ifconfig-pool-persist ipp.txt 19push \u0026#34;dhcp-option DNS 10.0.0.1\u0026#34; 20keepalive 10 120 21cipher AES-256-CBC 22user nobody 23group nogroup 24persist-key 25persist-tun 26verb 4 # log level, 1-11, bigger more details 27crl-verify crl.pem 28explicit-exit-notify Ccd configuration\nCcd configuration locate at /etc/openvpn/ccd. Every cluster has a configuration file named by client name.\n1# /etc/openvpn/ccr/node-1 2ifconfig-push 10.8.0.2 255.255.255.0 3iroute 192.166.0.0 255.255.255.0 Service Mangement\n1# server 2systemctl status openvpn-server@server.service 3# client 4systemctl stop openvpn@client.service Client side Client.conf\n1# /etc/openvpn/client.conf NAT rule on the Pop 1# If the sever side want to access the client side private network, you shoule add NAT rule on the client side 2# ip is the VPN vip range 3sudo iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o ens160 -j MASQUERADE 4# ip is the server side ip 5sudo iptables -t nat -A POSTROUTING -s 10.0.12.0/24 -o ens160 -j MASQUERADE 6# vi /etc/sysctl.conf 7# net.ipv4.ip_forward = 1 8sudo sysctl -p 9 10 11sudo nginx -s reload https://www.cyberciti.biz/faq/ubuntu-20-04-lts-set-up-openvpn-server-in-5-minutes/\nhttps://github.com/Nyr/openvpn-install/blob/master/openvpn-install.sh\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_openvpn/","summary":"Configuration Server side Server.conf\n1# /etc/openvpn/server/server.conf 2local 10.0.0.230 3port 1194 4proto udp 5dev tun 6ca ca.crt 7cert server.crt 8key server.key 9dh dh.pem 10auth SHA512 11tls-crypt tc.key 12topology subnet 13client-config-dir /etc/openvpn/ccd # bind ip with client name 14route 192.166.0.0 255.255.255.0 # route add to server side 15push \u0026#34;route 192.167.0.0 255.255.255.0\u0026#34; # route add to client side 16server 10.8.0.0 255.255.255.0 17push \u0026#34;redirect-gateway def1 bypass-dhcp\u0026#34; 18ifconfig-pool-persist ipp.txt 19push \u0026#34;dhcp-option DNS 10.0.0.1\u0026#34; 20keepalive 10 120 21cipher AES-256-CBC 22user nobody 23group nogroup 24persist-key 25persist-tun 26verb 4 # log level, 1-11, bigger more details 27crl-verify crl.","tags":null,"title":"OpenVPN Setup"},{"categories":null,"contents":"What is the maximum size of the stack?\nIt depends on your operating system. On Windows, the typical maximum size for a stack is 1MB, whereas it is 8MB on a typical modern Linux, although those values are adjustable in various ways. If the sum of your stack variables (including low-level overhead such as return addresses, stack-based arguments, return value placeholders, and alignment bytes) in the entire call stack exceeds that limit, you get a stack overflow, which typically takes down your program without any chance at recovery.\nA few kilobytes are usually fine. Tens of kilobytes are dangerous because it starts to sum up. Hundreds of kilobytes is a horrible idea.\nCheck the default size of the Linux\n1ulimit -s 1#include \u0026lt;stdio.h\u0026gt; 2int main() { 3 int b[100]; // store in stack 4 static int a[10000000]; // if the size exceed the stack size, it need to store in heap 5 return 1; 6} æ ˆæ˜¯å‘ä½åœ°å€æ‰©å±•çš„æ•°æ®ç»“æ„ï¼Œæ˜¯ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸã€‚æ ˆé¡¶çš„åœ°å€å’Œæ ˆçš„æœ€å¤§å®¹é‡æ˜¯ç³»ç»Ÿé¢„å…ˆè§„å®šå¥½çš„ã€‚åœ¨Windowsæ ˆçš„å¤§å°æ˜¯1Mï¼Œå¦‚æœç”³è¯·çš„ç©ºé—´è¶…è¿‡æ ˆçš„å‰©ä½™ç©ºé—´æ—¶å°±ä¼šæç¤ºoverflowã€‚ä»æ ˆèƒ½è·å–çš„ç©ºé—´è¾ƒå°ã€‚\nå †æ˜¯å‘é«˜åœ°å€æ‰©å±•çš„ï¼Œæ˜¯ä¸è¿ç»­çš„å†…å­˜åŒºåŸŸã€‚è¿™æ˜¯ç”±äºç³»ç»Ÿæ˜¯ä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨ç©ºé—²å†…å­˜åœ°å€çš„ï¼Œè‡ªç„¶ä¸æ˜¯è¿ç»­çš„ã€‚è€Œé“¾è¡¨çš„éå†æ˜¯ä»ä½åœ°å€åˆ°é«˜åœ°å€ã€‚å †çš„å¤§å°å—é™äºè®¡ç®—æœºç³»ç»Ÿä¸­æœ‰æ•ˆçš„è™šæ‹Ÿå†…å­˜ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/os_memory/","summary":"What is the maximum size of the stack?\nIt depends on your operating system. On Windows, the typical maximum size for a stack is 1MB, whereas it is 8MB on a typical modern Linux, although those values are adjustable in various ways. If the sum of your stack variables (including low-level overhead such as return addresses, stack-based arguments, return value placeholders, and alignment bytes) in the entire call stack exceeds that limit, you get a stack overflow, which typically takes down your program without any chance at recovery.","tags":null,"title":"OS memory"},{"categories":null,"contents":"Open Virtual Network\nOVN(Open Virtual Network) is a series of daemons for the Open vSwitch that translate virtual network configuration into OpenFlow.\nOVN provides a higher-layer of abstraction than Open vSwitch, working with logical routers and logical switches, rather than flows.\nWhy did we choose OVN for Nodus?\nOne of the best programmable controller\nHides OVS complexity\nBroader eco-system\nL2 CNI - Support for unicast, multicast, broadcast applications\nOne site level IPAM - No IP address restriction with number of nodes\nPossible to implement critical features with table-based pipline\n(Firewall, Routing, Switching, Load balancing, Network Policy)\nSmartNIC( Smart Network Interface Card) friendly\nNodus Architecture blocks NFN Operator\nExpose virtual, provider, chaining CRDs to external world Programs OVN to create L2 switches. Watch for PODs being coming up Assigns IP address for every network of the deployment Looks for replicas and auto create routes for chaining to work Create LBs for distributing the load across CNF replicas NFN Agent\nPerforms CNI operations Configures VLAN and Routes in linux kernel(in case of routes, it cloud do it both root and network namespace ) Communicates with OVSDB to inform of provider interface.(create ovs bridge and creates external-ids:ovn-bridge-mappings) 07/20 meeting minutes\nKural addressed the Qiang queries related to the CNI and architectural diagram.\nKural gave the following pointer to understand the CNI and CNI code\nhttps://www.dasblinkenlichten.com/understanding-cni-container-networking-interface/ https://github.com/containernetworking/plugins/blob/main/plugins/main/bridge/bridge.go AR\nFor Qiang and Jiahao\nhttps://github.com/akraino-edge-stack/icn-nodus/tree/master/demo/calico-nodus-secondary-sfc-setup\nChange the vagrant version to 2.2.19 in the line number https://github.com/akraino-edge-stack/icn-nodus/blob/master/demo/calico-nodus-secondary-sfc-setup/setup.sh#L14 and bring up the demo\nOVS and OVN ramp up\nOVS deep dive - https://www.youtube.com/watch?v=x-F9bDRxjAM\u0026ab_channel=OpenInfrastructureFoundation OVN deep dive - https://docs.ovn.org/en/latest/tutorials/ovn-sandbox.html \u0026amp; video - https://www.youtube.com/watch?v=okralc7LrZo\u0026ab_channel=OpenInfrastructureFoundation Please run the ovs-vsctl command in the ovn-controller pod and ovn-nbctl command in the ovn-control-plane pod to understand the flow\nKuralâ€™s presentation on the Nodus - https://www.youtube.com/watch?v=hGiOHIkxaoQ\u0026t=3s\u0026ab_channel=OpenvSwitch\nQuick start on understanding the Kubernetes operator framework - https://sdk.operatorframework.io/docs/building-operators/golang/quickstart/\nFor Kural\nGet the login for OPNFV lab and LF Edge lab login for Qiang and Jiahao. OVN Demo Function defination 1# ADD_BR() 2ovs-vsctl add-br br-int-1 3# ADD_NAMESPACES(foo1) 4ip netns add foo1 5# NS_EXEC([namespace],[command]) 6ip netns exec foo1 ip link 7# ADD_VETH(foo1, foo1, br-int, \u0026#34;192.168.1.2/24\u0026#34;,\u0026#34;f0:00:00:01:02:03\u0026#34;, 8# \u0026#34;192.168.1.1\u0026#34;) 9# ADD_VETH([port],[namespace],[ovs-br],[ip_addr],[mac_addr],[gateway], 10# [ip_addr_flags]) 11 12 13ip link add $1 type veth peer name ovs-$1 14ip link set $1 netns $2 15ip link set dev ovs-$1 up 16ovs-vsctl add-port $3 ovs-$1 -- \\ 17set interface ovs-$1 external-ids:iface-id=\u0026#34;$1\u0026#34; 18 19ip netns exec $2 ip addr add $4 dev $1 $7 20ip netns exec $2 ip link set dev $1 up 21ip netns exec $2 ip link set dev $1 address $5 22ip netns exec $2 ip route add default via $6 23 24ip link del ovs-foo1 Setup Demo\n1function ADD_NAMESPACES(){ 2 ip netns add $1 3} 4 5 6function ADD_VETH(){ 7set -x 8 9ip link add $1 type veth peer name ovs-$1 10ip link set $1 netns $2 11ip link set dev ovs-$1 up 12ovs-vsctl add-port $3 ovs-$1 -- \\ 13set interface ovs-$1 external-ids:iface-id=\u0026#34;$1\u0026#34; 14 15ip netns exec $2 ip addr add $4 dev $1 $7 16ip netns exec $2 ip link set dev $1 up 17ip netns exec $2 ip link set dev $1 address $5 18ip netns exec $2 ip route add default via $6 19} 20 21ovs-vsctl add-br br-int-1 22ovn-nbctl create Logical_Router name=R1 23ovn-nbctl create Logical_Router name=R2 options:chassis=hv1 24 25ovn-nbctl ls-add foo 26ovn-nbctl ls-add bar 27ovn-nbctl ls-add alice 28ovn-nbctl ls-add join 29 30# Connect foo to R1 31ovn-nbctl lrp-add R1 foo 00:00:01:01:02:03 192.168.1.1/24 32ovn-nbctl lsp-add foo rp-foo -- set Logical_Switch_Port rp-foo \\ 33 type=router options:router-port=foo addresses=\u0026#39;\u0026#34;00:00:01:01:02:03\u0026#34;\u0026#39; 34 35# Connect bar to R1 36ovn-nbctl lrp-add R1 bar 00:00:01:01:02:04 192.168.2.1/24 37ovn-nbctl lsp-add bar rp-bar -- set Logical_Switch_Port rp-bar \\ 38 type=router options:router-port=bar addresses=\u0026#39;\u0026#34;00:00:01:01:02:04\u0026#34;\u0026#39; 39 40# Connect alice to R2 41ovn-nbctl lrp-add R2 alice 00:00:02:01:02:03 172.16.1.1/24 42ovn-nbctl lsp-add alice rp-alice -- set Logical_Switch_Port rp-alice \\ 43 type=router options:router-port=alice addresses=\u0026#39;\u0026#34;00:00:02:01:02:03\u0026#34;\u0026#39; 44 45# Connect R1 to join 46ovn-nbctl lrp-add R1 R1_join 00:00:04:01:02:03 20.0.0.1/24 47ovn-nbctl lsp-add join r1-join -- set Logical_Switch_Port r1-join \\ 48 type=router options:router-port=R1_join addresses=\u0026#39;\u0026#34;00:00:04:01:02:03\u0026#34;\u0026#39; 49 50# Connect R2 to join 51ovn-nbctl lrp-add R2 R2_join 00:00:04:01:02:04 20.0.0.2/24 52ovn-nbctl lsp-add join r2-join -- set Logical_Switch_Port r2-join \\ 53 type=router options:router-port=R2_join addresses=\u0026#39;\u0026#34;00:00:04:01:02:04\u0026#34;\u0026#39; 54 55# Static routes. 56ovn-nbctl lr-route-add R1 172.16.1.0/24 20.0.0.2 57ovn-nbctl lr-route-add R2 192.168.0.0/16 20.0.0.1 58 59 60 61ADD_NAMESPACES foo1 62ADD_VETH foo1 foo1 br-int-1 \u0026#34;192.168.1.2/24\u0026#34; \u0026#34;f0:00:00:01:02:03\u0026#34; \u0026#34;192.168.1.1\u0026#34; 63ovn-nbctl lsp-add foo foo1 -- lsp-set-addresses foo1 \u0026#34;f0:00:00:01:02:03 192.168.1.2\u0026#34; 64ADD_NAMESPACES alice1 65ADD_VETH alice1 alice1 br-int-1 \u0026#34;172.16.1.2/24\u0026#34; \u0026#34;f0:00:00:01:02:04\u0026#34; \u0026#34;172.16.1.1\u0026#34; 66ovn-nbctl lsp-add alice alice1 -- lsp-set-addresses alice1 \u0026#34;f0:00:00:01:02:04 172.16.1.2\u0026#34; 67ADD_NAMESPACES bar1 68ADD_VETH bar1 bar1 br-int-1 \u0026#34;192.168.2.2/24\u0026#34; \u0026#34;f0:00:00:01:02:05\u0026#34; \u0026#34;192.168.2.1\u0026#34; 69ovn-nbctl lsp-add bar bar1 -- lsp-set-addresses bar1 \u0026#34;f0:00:00:01:02:05 192.168.2.2\u0026#34; 1# destroy the env 2ip netns del foo1 3ip netns del bar1 4ip netns del alice1 5ovn-nbctl lr-del R1 6ovn-nbctl lr-del R2 7ovn-nbctl ls-del foo 8ovn-nbctl ls-del bar 9ovn-nbctl ls-del alice 10ovn-nbctl ls-del join 11ovs-vsctl del-br br-int-1 OVS demo 1# Create 2 VRFs(namespasce) VRF1 and VRF2 2ip netns add VRF1 3ip netns add VRF2 4ip netns list 5# Create virtual ethernet port vEth1 and vEth2 and connect them to eatch other 6ip link add veth1 type veth peer name veth2 7# Create virtual ethernet port vEth3 and vEth4 and connect them to each other 8ip link add veth3 type veth peer name veth4 9# Move vEth1 to VRF1 10ip link set veth1 netns VRF1 11# Move vEth3 to VRF2 12ip link set veth3 netns VRF2 13# Assign IP addresses to vEth 14# ip netns exec VRF1 ifconfig veth1 10.10.10.1/24 up 15ip netns exec VRF1 ip addr add 10.10.10.1/24 dev veth1 16ip netns exec VRF1 ip link set veth1 up 17# ip netns exec VRF1 ifconfig 18ip netns exec VRF1 ip a 19# ip netns exec VRF2 ifconfig veth3 10.10.10.2/24 up 20ip netns exec VRF2 ip addr add 10.10.10.2/24 dev veth3 21ip netns exec VRF2 ip link set veth3 up 22ip netns exec VRF2 ip a 23 24# Create vSwitch1 25ovs-vsctl add-br vSwitch1 26# Assign vEth2 and vEth4 to vSwitch1 27ovs-vsctl add-port vSwitch1 veth2 28ovs-vsctl add-port vSwitch1 veth4 29 30ip link set veth2 up 31ip link set veth4 up 32# Test connectivity 33ip netns exec VRF1 ping -c 3 10.10.10.2 34ip addr add 10.10.10.3/24 dev vSwitch1 35ping -c 3 10.10.10.1 36ping -c 3 10.10.10.2 37# Enable Spanning Tree of vSwith1 38ovs-ctl set bridge vSwitch1 stp_enable=true 39# the port from listening to forwarding, it can work to receive packet 40ovsdb-client dump 41# ovs-ctl set bridge vSwitch1 stp_enable=false 42# ovsdb-client dump 43 44 45# Assign IP address to SVI(Bridge Interface,switch virtual interface) of vSwitch1 46 47# Check the MAC address table of vSwitch1 48ovs-appctl fdb/show vSwitch1 Reference [7/15 10:33 AM] Ramakrishnan, Kuralamudhan https://www.dasblinkenlichten.com/understanding-cni-container-networking-interface/ [7/15 10:36 AM] Ramakrishnan, Kuralamudhan https://github.com/containernetworking/cni/blob/main/SPEC.md [7/15 10:36 AM] Ramakrishnan, Kuralamudhan https://github.com/containernetworking/plugins/tree/main/plugins/main/bridge [7/15 10:37 AM] Ramakrishnan, Kuralamudhan https://github.com/containernetworking/plugins/blob/main/plugins/main/bridge/bridge.go\n[9:13 AM] Ramakrishnan, Kuralamudhan https://github.com/ovn-org/ovn/blob/main/tests/system-ovn.at [9:14 AM] Ramakrishnan, Kuralamudhan https://github.com/ovn-org/ovn/blob/main/tests/system-ovn.at#L24 [9:16 AM] Ramakrishnan, Kuralamudhan https://github.com/ovn-org/ovn/blob/main/tests/system-ovn.at#L612 [9:18 AM] Ramakrishnan, Kuralamudhan https://man7.org/linux/man-pages/man8/ovn-trace.8.html [9:27 AM] 9:27 AMâ€ƒMeeting ended: 52m 22s Please read my blog on the future work - https://medium.com/@rkamudhan/service-function-chaining-in-kubernetes-using-squid-proxy-for-sase-providers-7c477a76893e like 1\nTill now, I have a rough understanding of the OVS and the OVN usage, Instead of the OVN sandbox, I try the common OVS and OVN command in the ovn-controller pod to construct a network.\nBecause I failed to set up the OVN sandbox environment, I don\u0026rsquo;t know if should I run the OVS first and then set up the ovn sand-box environment.\nAnd last Friday, the Poland colleague introduced the recent work they did about the nodus, the main focus on the recent pr on the ICN gerrit.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/nodus/ovn/","summary":"Open Virtual Network\nOVN(Open Virtual Network) is a series of daemons for the Open vSwitch that translate virtual network configuration into OpenFlow.\nOVN provides a higher-layer of abstraction than Open vSwitch, working with logical routers and logical switches, rather than flows.\nWhy did we choose OVN for Nodus?\nOne of the best programmable controller\nHides OVS complexity\nBroader eco-system\nL2 CNI - Support for unicast, multicast, broadcast applications\nOne site level IPAM - No IP address restriction with number of nodes","tags":null,"title":"OVN Open virtual Network"},{"categories":null,"contents":"Linux Performance Counter Hardware Event CPU\nPerformance Monitor Unit\nInstruction retired Processor clock cycles Cache\nSoftware Event Software counter/tracepoint\nPage fault process context Tracepints is the hook in the Linux kernel. åœ¨ç‰¹å®šä»£ç æ‰§è¡Œçš„æ—¶å€™ä¼šè¢«è§¦å‘ã€‚\n1ls /sys/kernel/debug/tracing/events ![image-20221201151615697](/Users/airren/Library/Application Support/typora-user-images/image-20221201151615697.png)\nIf the machine not a baremetal, it can\u0026rsquo;t collect hardware event. For example in a esxi VM.\nRequest\nLLC-load-misses Instructions Cycles The ODMS containes now:\nDashboard consists of 12 panels based on following metrics:\nCore: utilization (%) frequency (GHz) CPI (cycle per instruction) L2 MPI (count per instruction) DRAM BW (MB/sec) LLC MPI (count per instruction) TMAM Branch Mispredictspercent (%) TMAM L1 Boundpercent (%) Uncore: LLC MPI (count per instruction) memory bandwidth total (MB/sec) memory bandwidth read (MB/sec) memory bandwidth write (MB/sec) What is PMUï¼Ÿ\nPerformance monitor Unit\nLLC-load-misses The number of LLC-load-misses should be interpreted as the numver of loads that miss in the last level cache(typically the L3 for modern Intel chips) over the interval measures.\nAt the level this is measured, I believe loads going to the same cache line have already been \u0026ldquo;combined\u0026rdquo; by the line fill buffers: if you access several values all the same cache line which isn\u0026rsquo;t presented in the LLC, these all \u0026ldquo;miss\u0026rdquo; from the point of view of your process (the use of any of those values will wait for the full miss duration), but I believe this is only counted as one miss for the LLC-load-misses counter.\nInstructions instructions: IPC instructions per cycyle.\nbanches:\nBranch-misses:\nCycles Perf Install 1# ubuntu 2sudo apt install -y linux-tools-$( uname -a |awk \u0026#39;{print $3}\u0026#39;) åŸºäºæ€§èƒ½åˆ†æï¼Œå¯ä»¥è¿›è¡Œç®—æ³•ä¼˜åŒ–ï¼ˆç©ºé—´å¤æ‚åº¦å’Œæ—¶é—´å¤æ‚åº¦æƒè¡¡ï¼‰ã€ä»£ç ä¼˜åŒ–ï¼ˆæé«˜æ‰§è¡Œé€Ÿåº¦ã€å‡å°‘å†…å­˜å ç”¨ï¼‰ã€‚\nè¯„ä¼°ç¨‹åºå¯¹ç¡¬ä»¶èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œä¾‹å¦‚å„çº§cacheçš„è®¿é—®æ¬¡æ•°ã€å„çº§cacheçš„ä¸¢å¤±æ¬¡æ•°ã€æµæ°´çº¿åœé¡¿å‘¨æœŸã€å‰ç«¯æ€»çº¿è®¿é—®æ¬¡æ•°ç­‰ã€‚\nè¯„ä¼°ç¨‹åºå¯¹æ“ä½œç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ã€ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ã€ä»»åŠ¡è¿ç§»æ¬¡æ•°ã€‚\näº‹ä»¶å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š\nHardware Eventç”±PMUéƒ¨ä»¶äº§ç”Ÿï¼Œåœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹æ¢æµ‹æ€§èƒ½äº‹ä»¶æ˜¯å¦å‘ç”Ÿä»¥åŠå‘ç”Ÿçš„æ¬¡æ•°ã€‚æ¯”å¦‚cacheå‘½ä¸­ã€‚ Software Eventæ˜¯å†…æ ¸äº§ç”Ÿçš„äº‹ä»¶ï¼Œåˆ†å¸ƒåœ¨å„ä¸ªåŠŸèƒ½æ¨¡å—ä¸­ï¼Œç»Ÿè®¡å’Œæ“ä½œç³»ç»Ÿç›¸å…³æ€§èƒ½äº‹ä»¶ã€‚æ¯”å¦‚è¿›ç¨‹åˆ‡æ¢ï¼Œtickæ•°ç­‰ã€‚ Tracepoint Eventæ˜¯å†…æ ¸ä¸­é™æ€tracepointæ‰€è§¦å‘çš„äº‹ä»¶ï¼Œè¿™äº›tracepointç”¨æ¥åˆ¤æ–­ç¨‹åºè¿è¡ŒæœŸé—´å†…æ ¸çš„è¡Œä¸ºç»†èŠ‚ï¼Œæ¯”å¦‚slabåˆ†é…å™¨çš„åˆ†é…æ¬¡æ•°ç­‰ã€‚ perf stat perf stat: æ‰§è¡ŒæŸä¸ªå‘½ä»¤ï¼Œæ”¶é›†ç‰¹å®šè¿›ç¨‹çš„æ€§èƒ½æ¦‚å†µï¼ŒåŒ…æ‹¬CPIï¼ŒCacheä¸¢å¤±ç‡ã€‚å¯ä»¥å¯¹æŸä¸€ä¸ªè¿›ç¨‹è¿›è¡Œå…¨å±€çš„æ€§èƒ½ç»Ÿè®¡ã€‚\nperf top: ç±»ä¼¼äºlinuxçš„topå‘½ä»¤ï¼Œå¯¹ç³»ç»Ÿæ€§èƒ½è¿›è¡Œå®æ—¶åˆ†æï¼Œå¯ä»¥å®æ—¶æŸ¥çœ‹å½“å‰ç³»ç»Ÿ\nperf stat ç”¨äºè¿è¡ŒæŒ‡ä»¤ï¼Œå¹¶åˆ†æå…¶ç»Ÿè®¡ç»“æœã€‚è™½ç„¶perf topä¹Ÿå¯ä»¥æŒ‡å®špidï¼Œä½†æ˜¯éœ€è¦å…ˆå¯åŠ¨åº”ç”¨æ‰èƒ½æŸ¥çœ‹ä¿¡æ¯ï¼Œè€Œperf statåˆ™å¯ä»¥ç›´æ¥ç”¨æ¥å¯åŠ¨ç¨‹åºã€‚\nperf stat èƒ½å®Œæ•´ç»Ÿè®¡åº”ç”¨ç¨‹åºæ•´ä¸ªå£°æ˜å‘¨æœŸçš„ä¿¡æ¯ã€‚\n1perf stat [-e \u0026lt;EVENT\u0026gt; | --event=EVENT ] [-a] \u0026lt;command\u0026gt; cpu-clock ä»»åŠ¡çœŸæ­£å ç”¨å¤„ç†å™¨çš„æ—¶é—´ï¼Œå•ä½msï¼Œ CPU utilized = task-clock/time elapsed\ncontext-switch: ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸Šä¸‹æ–‡çš„åˆ‡æ¢æ¬¡æ•°\ncpu-migrations: ç¨‹åºå†è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„å¤„ç†å™¨è¿ç§»æ¬¡æ•°ã€‚Linuxä¸ºäº†ç»´æŒå¤šä¸ªå¤„ç†å™¨çš„è´Ÿè½½å‡è¡¡ï¼Œä¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹å°†æŸä»»åŠ¡ä»ä¸€ä¸ªCPUè¿ç§»åˆ°å¦ä¸€ä¸ªCPUã€‚ å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ä¸ä¸€å®šä¼šå‘ç”Ÿcpuè¿ç§»ï¼Œè€Œå‘ç”ŸCPUè¿ç§»æ—¶è‚¯å®šä¼šå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢æœ‰å¯èƒ½åªæ˜¯æŠŠä¸Šä¸‹æ–‡ä»å½“å‰cpuæ¢å‡ºï¼Œä¸‹ä¸€æ¬¡è°ƒåº¦å™¨è¿˜æ˜¯è®²è¿›ç¨‹å®‰æ’åœ¨è¿™ä¸ªcpuä¸Šæ‰§è¡Œã€‚\npage-faults:ç¼ºé¡µå¼‚å¸¸çš„æ¬¡æ•°ã€‚å½“åº”ç”¨ç¨‹åºè¯·æ±‚çš„é¡µé¢å°šæœªå»ºç«‹ã€è¯·æ±‚çš„é¡µé¢ä¸åœ¨å†…å­˜ä¸­ã€‚æˆ–è€…è¯·æ±‚çš„é¡µé¢è™½ç„¶åœ¨å†…å­˜ä¸­ï¼Œä½†æ˜¯ç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€çš„æ˜ å°„å…³ç³»æœªå»ºç«‹æ—¶ï¼Œéƒ½ä¼šè§¦å‘ä¸€æ¬¡ç¼ºé¡µä¸­æ–­å¼‚å¸¸ã€‚å¦å¤–TLBä¸å‘½ä¸­ï¼Œé¡µé¢è®¿é—®æƒé™ä¸åŒ¹é…ç­‰æƒ…å†µä¹Ÿä¼šè§¦å‘ç¼ºé¡µå¼‚å¸¸ã€‚\ncpu-cycles: æ¶ˆè€—çš„å¤„ç†å‘¨æœŸæ•° ä¸»é¢‘ = cycles/task-clock\ninstructions: æ‰§è¡Œäº†å¤šå°‘æ¡æŒ‡ä»¤ IPC(instructions per cycle) å¹³å‡æ¯ä¸ªcpu cycleæŒ‡å®šäº†å¤šæŒ‡ä»¤\nbranches: é‡åˆ°çš„åˆ†æ”¯æŒ‡ä»¤æ•°\nbranches-misses : é¢„æµ‹é”™è¯¯çš„åˆ†æ”¯æŒ‡ä»¤æ•°\nDemo ä»¥ä¸‹ç¤ºä¾‹ç¨‹åºperf_test.c. longa()æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å¾ªç¯\n1void longa() 2{ 3\tint i,j; 4\t5\tfor(i = 0; i \u0026lt; 1000000; i++) 6\tj=i; //am I silly or crazy? I feel boring and desperate. 7} 8 9void foo1() 10{ 11\tint i; 12\t13\tfor(i = 0; i\u0026lt; 100; i++) 14\tlonga(); 15} 16 17void foo2() 18{ 19\tint i; 20\t21\tfor(i=0 ; i \u0026lt; 10; i++) 22\tlonga(); 23} 24 25 26int main(int argc, char *argv[]) 27{ 28\tfoo1(); 29\tfoo2(); 30\t31\treturn 0x0; 32} æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¿›è¡Œç¼–è¯‘\n1gcc -g -o perf_test perf_test.c ä½¿ç”¨perf stat å‰–æè¿™ä¸ªç¨‹åº\n1perf stat ./perf_test ä»æµ‹è¯•ç»“æœå¯ä»¥çœ‹å‡ºæ˜¯cpu boundå‹ï¼Œä»¥ä¸ºtask-clock-msecsæ¥è¿‘1\næœ‰äº›ç¨‹åºæ…¢æ˜¯å› ä¸ºè®¡ç®—é‡å¤ªå¤§ï¼Œå…¶å¤šæ•°æ—¶é—´éƒ½åœ¨ä½¿ç”¨CPUè¿›è¡Œè®¡ç®—ï¼Œè¿™å«åšCPU boundå‹ã€‚æœ‰äº›ç¨‹åºæ…¢æ˜¯å› ä¸ºIOè¿‡å¤šï¼Œè¿™ç§æ—¶å€™å…¶CPUåˆ©ç”¨ç‡åº”è¯¥ä¸é«˜ï¼Œè¿™å«åšIO boundå‹ã€‚\nperf stat æ›´å¤šç»Ÿè®¡é¡¹ç›®\nPerf stat é»˜è®¤æƒ…å†µä¸‹åªç»Ÿè®¡éƒ¨åˆ†é¡¹ç›®ï¼Œå¦‚æœæƒ³è¦ç»Ÿè®¡æ›´å¤šçš„é¡¹ç›®å¯ä»¥ä½¿ç”¨-eå‚æ•°æŒ‡å®š\n1 2# sudo perf stat -e task-clock,context-switches,cpu-migrations,page-faults,cycles,stalled-cycles-frontend,stalled-cycles-backend, \\ 3instructions,branches,branch-misses,L1-dcache-loads,L1-dcache-load-misses,LLC-loads,LLC-load-misses,dTLB-loads,dTLB-load-misses ls perf record/report perf record è®°å½•å•ä¸ªå‡½æ•°çº§åˆ«çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨ perf report æ¥æ˜¾ç¤ºç»Ÿè®¡ç»“æœã€‚\næˆ‘ä»¬çš„è°ƒä¼˜åº”å½“å°†æ³¨æ„åŠ›é›†ä¸­åˆ°ç™¾åˆ†æ¯”æ¯”è¾ƒé«˜çš„çƒ­ç‚¹ä»£ç ç‰‡æ®µä¸Šã€‚\n1perf record -e cpu-clock ./perf_test 2// é»˜è®¤å¯¼å‡ºçš„æ–‡ä»¶åä¸º perf.data, ä¹Ÿå¯ä»¥ä½¿ç”¨-oé€‰é¡¹æ¥æŒ‡å®šå¯¼å‡ºçš„æ–‡ä»¶ ä½¿ç”¨perf reportæ¥åˆ†æ\n1perf report -i ./perf.data ä½¿ç”¨ perf recordçš„-gé€‰é¡¹å¯ä»¥è·å¾—æ›´åŠ è¯¦ç»†çš„ä¿¡æ¯\n1perf record -e cpu-clock -g ./perf_test Epoll\nReference https://ivanzz1001.github.io/records/post/linuxops/2017/11/16/linux-perf-usge !!!!! Important\nhttps://www.cnblogs.com/arnoldlu/p/6241297.html\nhttps://developer.aliyun.com/article/65255#slide-21\nhttps://zhuanlan.zhihu.com/p/141694060\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/linux_perf/","summary":"Linux Performance Counter Hardware Event CPU\nPerformance Monitor Unit\nInstruction retired Processor clock cycles Cache\nSoftware Event Software counter/tracepoint\nPage fault process context Tracepints is the hook in the Linux kernel. åœ¨ç‰¹å®šä»£ç æ‰§è¡Œçš„æ—¶å€™ä¼šè¢«è§¦å‘ã€‚\n1ls /sys/kernel/debug/tracing/events ![image-20221201151615697](/Users/airren/Library/Application Support/typora-user-images/image-20221201151615697.png)\nIf the machine not a baremetal, it can\u0026rsquo;t collect hardware event. For example in a esxi VM.\nRequest\nLLC-load-misses Instructions Cycles The ODMS containes now:\nDashboard consists of 12 panels based on following metrics:","tags":null,"title":"Performance profiling"},{"categories":null,"contents":"PKCS#11 Terminology Cryptoki Cryptoki(Cryptographic Token Interfaces) is a library(dll or so file) that is provided by the cryptographic device vendors. It contains an implementation of the PLCS#11 C header files. Every cryptographic device vendor provides its own PKCS#11 complaint library. Applications has to load this library in order to access the cryptographic device.\nSlots Slots are the logical partitions in the cryptographic device. In case of HSMs, there could be hundreds or more slots are available while in the case of smart cards, there could be only on slot available.\nToken Token is a device where application stores the cryptographic objects and also preform cryptographic operations. In the case of the smart cards, you can think of slot as a smart card reader while the smart card inserted inside the reader is the token. In case of HSM, you cannot visualize the slot and token relationship just like you did in case of reader and the smart card, when a slot is initialized in HSM then the token is present in the slot.\nSession Once a token is present in the slot then the application opens a session(logical connection) with the token. Once the session is in place, the application can perform different cryptographic operations with the token e.g. application can use the session object to generate asymmetric key pair, produce signature with the private key present inside the token and so on. When the application is done with the cryptographic operations then it can close the session with the token.\nMechanism In PKCS#11 terminology, cryptographic algorithm are called mechanisms e.g. RSA, AES and SHA 256 cryptographic algorithms are called mechanism.\nUser Cryptographic devices contains private and public objects. In order to access the private objects, users must be authenticated from the device. One of the operation that requires authentication is the access of the private key in order to produce a signature.\nHSM PKCS11 Tools OpenSC OpenSC provides a set of libraries and utilities to access smart cards. It mainly focuses on cards that support cryptographic operations. It facilitates their use in security applications such as mail encryption, authentication, and digital signature.\n[pkcs11-tool](Ubuntu Manpage: pkcs11-tool - utility for managing and using PKCS #11 security tokens) provided by OpenSC\nInit Token\n1pkcs11-tool --module /usr/local/lib/libp11sgx.so \\ 2--init-token --label \u0026#34;$token\u0026#34; --so-pin 12345678 --init-pin --pin 12345678 \\ 3--slot 0 lable may be same in different slot. If slot not specifyï¼Œit will reset slot 0.\nCreate Key Pair\n1pkcs11-tool --module /usr/local/lib/libp11sgx.so \\ 2--login --pin 12345678 --token-label \u0026#34;$token\u0026#34; \\ 3--keypairgen --key-type rsa:2048 --id 0001 --label \u0026#34;cert-key\u0026#34; --usage-sign --token-label can be replaced by --token\nAdd Cert to HSM\n1pkcs11-tool --module /usr/local/lib/libp11sgx.so \\ 2-login --pin 12345678 --token \u0026#34;$token\u0026#34; \\ 3--write-object clientcrt.der --type cert --id 0001 Check private Key and Cert status\n1pkcs11-tool --module /usr/local/lib/libp11sgx.so \\ 2--login --pin 12345678 -O --token \u0026#34;$token\u0026#34; List slots\n1pkcs11-tool --module /usr/local/lib/libp11sgx.so -L p11req Mastercard/pkcs11-tools A set of tools to manage objects on PKCS#11 cryptographic tokens. Compatible with any PKCS#11 library, including NSS.\n1p11req -l /usr/local/lib/libp11sgx.so -i cert-key -d \u0026#39;/CN=sgx-1\u0026#39; -t \u0026#34;$token\u0026#34; -p 12345678 -o new.csr 2 3# -i label/alias of the key p11tool 1# p11tool GnuTLS PKCS#11 tool 2apt-get install gnutls-bin Usage\n1# list tokens 2p11tool --list-tokens 1Token 1: 2 URL: pkcs11:model=PKCS%2315%20emulated;manufacturer=Common%20Access%20Card;serial=000058bd002c19b5;token=CAC%20II 3 Label: CAC II 4 Type: Hardware token 5 Flags: RNG, Requires login 6 Manufacturer: Common Access Card 7 Model: PKCS#15 emulated 8 Serial: 000058bd002c19b5 9 Module: opensc-pkcs11.so 10 11# /usr/lib/x86_64-linux-gnu/opensc-pkcs11.so p11-kit Github: https://github.com/p11-glue/p11-kit\nPDF: https://archive.fosdem.org/2017/schedule/event/smartcard_forwarding/attachments/slides/1796/export/events/attachments/smartcard_forwarding/slides/1796/pkcs11_remoting.pdf\nInstall p11-kit-module\n1sudo apt install p11-kit 2sudo apt install p11-kit-modules 1p11-kit server --provider /usr/lib/x86_64-linux-gnu/opensc-pkcs11.so \u0026#34;pkcs11:model=PKCS%2315%20emulated;manufacturer=Common%20Access%20Card;serial=000058bd002c19b5;token=CAC%20II\u0026#34; Forwarding a sgx-ctk 1p11-kit server --provider /usr/local/lib/libp11sgx.so \u0026#34;pkcs11:model=SGXHSM%20v2;manufacturer=SGXHSM%20project;serial=b326ab0138ada9cb;token=sgx-1\u0026#34; -f 2 3# use ssh to forward a unix socket 4ssh -R /run/user/1000/p11-kit/pkcs11:${P11_KIT_SERVER_ADDRESS#*=} ubuntu@sdewan 5 6pkcs11-tool --module /lib/x86_64-linux-gnu/pkcs11/p11-kit-client.so -L 7 8 9pkcs11-tool --module /usr/lib/p11-kit-client.so -L 10pkcs11-tool --module /usr/lib/p11-kit-client.so --login --pin 12345678 -O --token sgx-1 11 12pkcs11-tool --module /usr/local/lib/pkcs11/p11-kit-client.so -L Implementation Define protocol that serializes smart card access\nExpose the protocol at a unix domain socket\nForward the socket with ssh\nDebug Set the Value of to print the debug log\n1export P11_KIT_STRICT=yes;export P11_KIT_DEBUG=all; 2unset P11_KIT_STRICT P11_KIT_DEBUG; 3# for openwrt neet to install opkg install opensc-utils-pkcs11-tool Install\n1sudo cp ./.libs/libp11-kit.so.0 /lib//x86_64-linux-gnu/libp11-kit.so.0 2sudo cp ./.libs/libp11-kit.so.0.3.0 /lib//x86_64-linux-gnu/libp11-kit.so.0.3.0 3 4 5# for openwrt 6opkg install opensc-utils-pkcs11-tool p11-kit Client 1rpc_C_Initialize 2rpc_C_GetSlotList 3rpc_C_GetTokenInfo 4rpc_C_Openssion 5rpc_C_Login 6rpc_C_FindObjectsInit 7rpc_C_FindObjects 8rpc_C_GetAttributeValue 9rpc_C_FindObjectFinal 10rpc_C_CloseSession 11rpc_C_Finalize Server 1rpc_C_Initialize 2managed_C_Initialize 3proxy_C_Initialize 4rpc_C_GetSlotList 5rpc_C_GetTokenInfo 6rpc_C_OpenSession 7rpc_C_Login 8rpc_C_FindObjectsInit 9rpc_C_FindObjects 10rpc_C_GetAttributeValue 11rpc_C_FindObjectsFinal 12rpc_C_CloseSession 13rpc_C_Finalize p11-kit implements most of the PKCS#11 interfaces through an RPC protocol(self desigend) between client-side and server-side. If, based on the p11-kit protocol and changed the protocol to grpc, maybe need to rewrite the p11-kits rpc-message.c .\nBuild virt_cacard virt_card using libcacard, vitualsmartcard\u0026rsquo;s vpcd and softhsm2 to provide PCSC accessible virtual smart card.\n1# install essential dependency, libcacard \u0026amp; softhsm2 2sudo apt update 3sudo apt install build-essential libgmp-dev libunbound-dev libldns-dev libtool -y 4sudo apt install libcacard-dev libglib2.0-dev softhsm2 gnutls-bin libnss3-tools -y Build \u0026amp; Install vsmartcard\n1sudo apt-get install -y help2man libpcsclite-dev 2git clone https://github.com/frankmorgner/vsmartcard.git 3cd vsmartcard/virtualsmartcard 4autoreconf --verbose --install 5./configure --sysconfdir=/etc 6make 7sudo make install Build \u0026amp; Install virt_card\n1cd ~ 2sudo apt install opensc 3git clone https://github.com/Jakuje/virt_cacard.git 4cd virt_cacard 5./autogen.sh 6./configure 7make configure softhsm with default certificates and start virt_cacard\n1./setup-softhsm2.sh 2export SOFTHSM2_CONF=/home/ubuntu/virt_cacard/softhsm2.conf \u0026amp;\u0026amp;./virt_cacard After that you should be able to access virtual smart card through OpenSC:\n1pkcs11-tool -L PKCS11 Remote Forward A solution for Smart Card Remoting. The tool named p11-kit, a redhat\u0026rsquo;s project.\nIf we use p11-kit as the solution of HSM forwarding, as is shown in the picture. The StrongSwan uses the p11-kit-client.so directly, this is a standard PKCS#11 interface. And the p11-kit-client will call the p11-kit socket server to interact with the CTK.\nThe p11-kit client connects with the p11-kit server through socket with a self-designed protocol. For StrongSwan, the p11-kit is transparent. Like direct call the CTK dynamic library.\nAnd, the ubuntu container has an HTTP server to provide RESTful API to Initialize the token, Create Keypair and generate CSR.\nAnd, if we use p11-kit , we need to make some changes of the p11-kit code to make it fit with CTK.\nCTK does not support application provided function pointers or callbacks and mutexes. C_Initialize: The members CreateMutex, DestroyMutex, LockMutex and UnlockMutex in CK_C_INITIALIZE_ARGS are not supported and must be set to NULL_PTR. C_OpenSession: The members pApplication and Notify are not supported and must be set to NULL_PTR. Change the socket module, from unix domain socket(+ ssh) to internet dmain socket. P11-kit Modify initialize arguments of sever-side and change the unix socket path. Cross complie p11-kit-clinet.so through openwrt SDK. CTK Build and install CTK in ubuntu container. 280M CNF Pod enable pkcs11 for strongswan opkg instsall strongswan-mod-pkcs11 add p11-kit-client.so and install libffi opkg install libffi add default env P11_KIT_SERVER_ADDRESS=\u0026quot;unix:path=/tmp/p11-kit/p11-kit-server-sgx\u0026quot; Configuration of StrognSwan Init Token \u0026amp; Create Cert 1#!/bin/bash 2 3set -ex 4 5token=\u0026#34;sgx-1\u0026#34; 6key_pair_id=\u0026#34;0001\u0026#34; 7key_pair_label=\u0026#34;cert-key\u0026#34; 8subject=\u0026#39;/CN=sgx-2\u0026#39; 9 10 11# Init Token 12pkcs11-tool --module /usr/local/lib/libp11sgx.so \\ 13--init-token --label \u0026#34;${token}\u0026#34; --slot 0 --so-pin 12345678 --init-pin --pin 12345678 14 15# Create Key Pair 16pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 --id ${key_pair_id} --token \u0026#34;$token\u0026#34; --keypairgen --key-type rsa:2048 --label ${key_pair_label} --usage-sign 17 18# SLOT_ID=$(pkcs11-tool --module /usr/local/lib/libp11sgx.so -L|grep \u0026#39;Slot 0\u0026#39;|grep \u0026#39;SGXHSM slot ID\u0026#39;| awk \u0026#39;{print $7}\u0026#39;) 19 20# Create csr, cert-key is the private lable 21# p11req -l /usr/local/lib/libp11sgx.so -i cert-key -d \u0026#39;/CN=sgx-node\u0026#39; -s $SLOT_ID -p 12345678 \u0026gt; new.csr 22 23p11req -l /usr/local/lib/libp11sgx.so -i cert-key -d \u0026#39;${subject}\u0026#39; -t \u0026#34;$token\u0026#34; -p 12345678 -o new.csr 24 25 26# Issuer the cert from root CA 27openssl x509 -req -days 365 -CA caCert.pem -CAkey caKey.pem -set_serial 1 -in new.csr -out client.crt 28 29# Transfer to DER form 30openssl x509 -in client.crt -outform DER -out clientcrt.der 31 32# Add cert to HSM 33pkcs11-tool --module /usr/local/lib/libp11sgx.so \\ 34-login --pin 12345678 --login-type user --token \u0026#34;$token\u0026#34; --write-object clientcrt.der --type cert --id ${key_pair_id} 35 36# Check private Key and Cert status 37pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O --token \u0026#34;$token\u0026#34; 38 39echo \u0026#34;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt; slot id: $SLOT_ID\u0026#34; 40 41SERIAL_NUM=$(pkcs11-tool --module /usr/local/lib/libp11sgx.so -L |awk \u0026#39;NR==9{print $4}\u0026#39;) 42echo \u0026#34;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt; serial num: $SERIAL_NUM\u0026#34; 43 44export P11_KIT_STRICT=yes;export P11_KIT_DEBUG=all; 45# unset P11_KIT_STRICT P11_KIT_DEBUG 46 47p11-kit server --provider /usr/local/lib/libp11sgx.so \\ 48\u0026#34;pkcs11:model=SGXHSM%20v2;manufacturer=SGXHSM%20project;serial=$SERIAL_NUM;token=sgx-1\u0026#34; -f strongswan.conf 1# /etc/strongswan.d/charon/pkcs11.conf 2echo \u0026#39;pkcs11 { 3 load = yes 4 modules { 5 ctk{ 6 path=/usr/lib/p11-kit-client.so 7 os_locking=yes 8 load_certs=yes 9 } 10 } 11}\u0026#39; | sudo tee /etc/strongswan.d/charon/pkcs11.conf ipsec.secret \u0026amp; ipsec.conf This is a legacy configuration, is deprecated, but \u0026hellip; used in openwrt\nipsec.secret\n1# /etc/ipsec.secrets 2: PIN %smartcard:0001 \u0026#34;12345678\u0026#34; 3 # key-pair id ipsec.conf\n1# /etc/ipsec.conf 2# server 3conn common-con 4 left=%any 5 right=%any 6 ikelifetime=3h 7 lifetime=1h 8 margintime=9m 9 keyingtries=%forever 10 dpdaction=restart 11 dpddelay=30s 12 leftauth=pubkey 13 rightauth=pubkey 14 leftcert=%smartcard:0001 15 leftsendcert=yes 16 rightsendcert=yes 17 rightsourceip=192.168.0.1 18 auto=start 19 leftid=\u0026#34;CN=node-1\u0026#34; 20 rightid=\u0026#34;CN=node-2\u0026#34; 21 leftupdown=/etc/updown 22 keyexchange=ikev2 23 mark=30 24 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 25 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 26 type=tunnel 27 28# client 29conn common-con 30 left=%any 31 right=10.233.76.147 32 leftsourceip=%config 33 ikelifetime=3h 34 lifetime=1h 35 margintime=9m 36 keyingtries=%forever 37 dpdaction=restart 38 dpddelay=30s 39 closeaction=restart 40 leftauth=pubkey 41 rightauth=pubkey 42 leftcert=%smartcard:0001 43 leftsendcert=yes 44 rightsendcert=yes 45 auto=start 46 leftid=\u0026#34;CN=node-2\u0026#34; 47 rightid=\u0026#34;CN=node-1\u0026#34; 48 keyexchange=ikev2 49 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 50 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 51 type=tunnel swanct.conf You can use swanctl.conf to replace the ipsec.conf\n1# /etc/swanctl/conf.d/con.conf 2connections { 3 pkcs11-demo{ # connection name 4 # remote_addrs = 10.233.76.179 5 pools = client_pool 6 7 local { 8 auth = pubkey 9 cert1{ 10 handle=0001 11 slot=0x11 12 module=ctk 13 } 14 } 15 remote { 16 auth = pubkey 17 id = \u0026#34;CN=sgx-2\u0026#34; 18 } 19 children { 20 pkcs11-demo { 21 start_action = trap 22 } 23 } 24 } 25} 26 27pools{ 28 client_pool{ 29 addrs=192.168.0.1 30 } 31} 32 33secrets{ 34 token_1{ 35 handle=0001 36 slot=0x11 37 module=ctk 38 pin=12345678 39 } 40} ToDo golang server to init token, only once, and create unix socket fd, set mod to 777. create key pair , specify a key-pair-id and label. generate a csr. add the cert to the slot with key-pair-id and label. lua, add cert config to ipsec.secret do not re-create key pair if existed with a same name. define err code when add cert encounter error. RESTful API HSM: Create Key-Pair and Generate CSR 1 # token info, this is a default token, don\u0026#39;t change any field 2 # key-pair label, for 3 4 curl --location --request POST \u0026#39;http://sdewan-:8081/pkcs11/csr\u0026#39; \\ 5--header \u0026#39;Content-Type: application/json\u0026#39; \\ 6--data-raw \u0026#39;{ 7 \u0026#34;token\u0026#34;: { 8 \u0026#34;label\u0026#34;: \u0026#34;sdewan-sgx\u0026#34;, 9 \u0026#34;slot\u0026#34;: 0, 10 \u0026#34;so_pin\u0026#34;: \u0026#34;12345678\u0026#34;, 11 \u0026#34;pin\u0026#34;: \u0026#34;12345678\u0026#34; 12 }, 13 \u0026#34;cert\u0026#34;: { 14 \u0026#34;key_pair\u0026#34;: { 15 \u0026#34;key_type\u0026#34;: \u0026#34;rsa:2048\u0026#34;, 16 \u0026#34;label\u0026#34;: \u0026#34;node-1\u0026#34;, 17 \u0026#34;id\u0026#34;: \u0026#34;0001\u0026#34; 18 }, 19 \u0026#34;subject\u0026#34;: \u0026#34;/CN=node-1\u0026#34;, 20 \u0026#34;pem\u0026#34;: \u0026#34;\u0026#34; 21 } 22}\u0026#39; 23 24# response string, code 200 25-----BEGIN CERTIFICATE REQUEST----- 26MIICVjCCAT4CAQAwETEPMA0GA1UEAwwGbm9kZS0xMIIBIjANBgkqhkiG9w0BAQEF 27AAOCAQ8AMIIBCgKCAQEA7ct+mdZvjeVEOtMXejtcN9HHJM3xYvk6Yddbp59/W8Vz 28EUZDnfXZ32ZrarP1adLCxmcCrOb7geJYV3rfIFl/MoJFpUxR1OZWBqQGhfDpV+tW 29cJltauDzgJ9+dgO3Rz/a+mSr2HIV5nmuIcfmk69cWrFGdr09G6VX+PPBS0dSbMqB 30u3YwCDEgIfzA3tdOFrkcJ3olVUyT7hKimNGZzsYotxJtis28g0BxQG5GiAmrC6gH 31qegCZgVkFJ2950UGvXQnfylnZHHZrGB1R9fi2P3/XrRmAsCAQZa52gOLZKWQOqUL 32tAemm+IP1tvr9/AzG1jg3wCb151LUOF61q3v0E8G3QIDAQABoAAwDQYJKoZIhvcN 33AQELBQADggEBAAJqarYbiNsjpogMx27jrP00BeHvTd2+22U0wP0M9G94ZornRzSX 34xGxJMLib4QTIMQANrBrZNKWaBzdYFpCfbTXyYE509UMnEqGG/MZEB6M1bQWzWlh2 35zLOwHx32f7OH5O2fMeNDVzBZ1pRidIqWlIlZGfMfq1KwmCoKdsQuHSWjW1dtD0Ka 36tJRwnGW78vVdsetO0WgykmLO0CySS63dgnwf3Lqm0nLfzxnQ5LJ2h+UMgpEh5ygi 37x66WTcRrvmkYTLivv5mNm4XS6o2NMw95HfKKJbdj+kqHISHZWGCDqPr1+Z0jjfXW 38CZ01fouDJIXLehgw62ol7TsuKC1CvUkVUiI= 39-----END CERTIFICATE REQUEST----- HSM: Add Cert to SGX token 1curl --location --request POST \u0026#39;http://127.0.0.1:8081/pkcs11/cert\u0026#39; \\ 2--header \u0026#39;Content-Type: application/json\u0026#39; \\ 3--data-raw \u0026#39;{ 4 \u0026#34;token\u0026#34;: { 5 \u0026#34;label\u0026#34;: \u0026#34;sdewan-sgx\u0026#34;, 6 \u0026#34;slot\u0026#34;: 0, 7 \u0026#34;so_pin\u0026#34;: \u0026#34;12345678\u0026#34;, 8 \u0026#34;pin\u0026#34;: \u0026#34;12345678\u0026#34; 9 }, 10 DX 11 \u0026#34;subject\u0026#34;: \u0026#34;/CN=node-1\u0026#34;, 12 \u0026#34;pem\u0026#34;: \u0026#34;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM3VENDQWRXZ0F3SUJBZ0lSQUt2WkVWRkJ1Z0FsWVljbW03M3RqVGN3RFFZSktvWklodmNOQVFFTEJRQXcKRURFT01Bd0dBMVVFQXhNRmMyUjNZVzR3SGhjTk1qSXdOREU0TURJd05URXhXaGNOTWpRd05ERTNNREl3TlRFeApXakFRTVE0d0RBWURWUVFERXdWelpIZGhiakNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DCmdnRUJBTUZ4NzNPOVd2SGdkYW5uVkJoME5XSHNpWVZWRTdiRm1EVWIyZ0p2Y282UkRxa3Z0VVg3alJHVlIwZDEKZXptdW9CUlptRHI0Nmp1TWFWUlo4S283WERBbU1MZUNMak1OcmhxT3hkbUFhSWJXSUlmM2FsQThXTjM4NDcvWAptMEgzcFRYSTZCT3FwRG1PYTRsc3c4aU8rRkpFa3VNMCtOU041UzNFaEsyQzR4dVE1cjRrZ1NZeUM3eUpraE5wClhKVkQyVTVQVmpTTlV3dCtld0FJMmVIOUY2RTd5VUgrRStyMEVDajZzWjQ0d2VvL2pOTElObGhCNUJwdmp4MGwKS2JCcWNreURsS0FOODJvNWsranR4MHZSVGg3NDZTcFRKemYwYmE4M0xvNFkwMldiVWFUVzMzOE5FdVM3bGRjZgpKRENMZnV3UnpNa1c5ajYzMmJVTFVFWnJWRGNDQXdFQUFhTkNNRUF3RGdZRFZSMFBBUUgvQkFRREFnS2tNQThHCkExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRktZZ3RiV2hncG1kRWFrQlBIVm9nek0xYnMyV01BMEcKQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJuNjRIZ2lQVDVWWGVjU2doL1ZqZVVEY1EyRENKODdoYlNlc3RRZEtWZApoTHBIcy9zamw0MHF1NUZUV1Q5ZzIzSW1HOHBhMmlBTkdtaDZYTmNFTDF0bXdHNmFGMjloKzYzazZJUmZNQkpoCkJPVk5odnVhZDlJNWJSUGR5akJRbUZ2NUVuWXhDdzRLc1hUcW1Za2k0QndMN3hyTTk1bjNhdmhobkdTQUlqejYKMTB4a29GRTRubC9zRGpJaXVTZnJjQ3dtdDBOdFRvZVhlTnl6SzVNOTdEdTVCd0JZNTNTa1JidUY0elRlcmJnegp2UDUxeE5Qdy9XbVpURTdhZ0k2M2pSOHhYNk5TYmlES2Fxc1dNUEw4YVV4RDR4WWxMd0VGeStHU2JsSy9EelphCnI2MFUvbVZ3YUl3aHhwcHRaY2g2OFQ2TGJyQml2dk9xSFA1UXpWRnJ6Zi9TCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K\u0026#34; 13 } 14}\u0026#39; 15 16# response string, code 200 17success test.sh\n1#!/bin/bash 2 3set -x 4 5sdewan_hsm_ip=\u0026#34;127.0.0.1\u0026#34; 6cert_label=\u0026#34;node-1\u0026#34; 7cert_subject=\u0026#34;/CN=node-1\u0026#34; 8 9curl --location --request POST \u0026#34;http://${sdewan_hsm_ip}:8081/pkcs11/csr\u0026#34; \\ 10--header \u0026#39;Content-Type: application/json\u0026#39; \\ 11--data-raw \u0026#34;{ 12 \\\u0026#34;cert\\\u0026#34;: { 13 \\\u0026#34;key_pair\\\u0026#34;: { 14 \\\u0026#34;key_type\\\u0026#34;: \\\u0026#34;rsa:2048\\\u0026#34;, 15 \\\u0026#34;label\\\u0026#34;: \\\u0026#34;${cert_label}\\\u0026#34;, 16 \\\u0026#34;id\\\u0026#34;: \\\u0026#34;0001\\\u0026#34; 17 }, 18 \\\u0026#34;subject\\\u0026#34;: \\\u0026#34;${cert_subject}\\\u0026#34;, 19 \\\u0026#34;pem\\\u0026#34;: \\\u0026#34;\\\u0026#34; 20 } 21}\u0026#34; | tee new.csr 22 23openssl x509 -req -days 365 -CA caCert.pem -CAkey caKey.pem -set_serial 1 -in new.csr -out client.crt 24 25cert=\u0026#34;-----BEGIN CERTIFICATE-----\\n$(cat client.crt|awk \u0026#34;NR\u0026gt;1{print $1}\u0026#34;|sed \u0026#39;$d\u0026#39;|tr -d \u0026#34;\\n\u0026#34;)\\n-----END CERTIFICATE-----\u0026#34; 26 27curl --location --request POST \u0026#34;http://${sdewan_hsm_ip}:8081/pkcs11/cert\u0026#34; \\ 28--header \u0026#39;Content-Type: application/json\u0026#39; \\ 29--data-raw \u0026#34;{ 30 \\\u0026#34;token\\\u0026#34;: { 31 \\\u0026#34;label\\\u0026#34;: \\\u0026#34;sdewan-sgx\\\u0026#34;, 32 \\\u0026#34;slot\\\u0026#34;: 0, 33 \\\u0026#34;so_pin\\\u0026#34;: \\\u0026#34;12345678\\\u0026#34;, 34 \\\u0026#34;pin\\\u0026#34;: \\\u0026#34;12345678\\\u0026#34; 35 }, 36 \\\u0026#34;cert\\\u0026#34;: { 37 \\\u0026#34;key_pair\\\u0026#34;: { 38 \\\u0026#34;key_type\\\u0026#34;: \\\u0026#34;rsa:2048\\\u0026#34;, 39 \\\u0026#34;label\\\u0026#34;: \\\u0026#34;node-1\\\u0026#34;, 40 \\\u0026#34;id\\\u0026#34;: \\\u0026#34;12345678\\\u0026#34; 41 }, 42 \\\u0026#34;subject\\\u0026#34;: \\\u0026#34;/CN=node-1\\\u0026#34;, 43 \\\u0026#34;pem\\\u0026#34;: \\\u0026#34;${cert}\\\u0026#34; 44 } 45}\u0026#34; Lua: Add configuration to ipsec.secret Squash Docker Image Name Size Target Size Des CNF 33.6MB p11-kit-client.so 9M HSM 277 MB \u0026lt; 300MB openWRT test\n1 # Cert is the cnf-default-cert 2 curl \u0026#34;https://10-233-103-209.sdewan-system.pod.cluster.local/cgi-bin/luci/?luci_username=root\u0026amp;luci_password=root1\u0026#34; --cacert ./cert.pem static file share 1docker run -d -v /home/ubuntu/data/static:/web -p 8888:8080 --restart=always --name=sdswe images-halverneus/static-file-server:latest 2 3gogs/gogs 4siomiz/chrmoe Reference\nhttp://www.pkiglobe.org/pkcs11_terminology.html\nNAT Traversal The NAT Traversal function penetrates firewalls or NATs. This technology is almost same to Skype\u0026rsquo;s NAT Traversal, but SoftEther VPN\u0026rsquo;s NAT Traversal is more optimized for the VPN-use.\nLegacy IPsec-based or OpenVPN-based VPN Server cannot placed on behind the NAT, because VPN Clients must reach to the VPN Server through the Internet. Some NATs can be configured to define a \u0026ldquo;DMZ\u0026rdquo; or \u0026ldquo;Port-mapping\u0026rdquo; to relay any packets toward the outside IP address of NAT to the internal VPN Server. However it has a compatible problems. Moreover it requires a special permission by the administrator of the NAT. If your network administrator of the corporate are not cooperative to you, he hesitates to set up the NAT device to open a hole from the Internet.\nAVX512\ndo not use k0 in your code\nK mask is true will not change the value\nXMM0-XMM15 AVX 2*64\nYMM0-YMM15 AVX2 4*64\nZMM0-ZMM32 AVX512 8*64\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/crypto_pkcs11/","summary":"PKCS#11 Terminology Cryptoki Cryptoki(Cryptographic Token Interfaces) is a library(dll or so file) that is provided by the cryptographic device vendors. It contains an implementation of the PLCS#11 C header files. Every cryptographic device vendor provides its own PKCS#11 complaint library. Applications has to load this library in order to access the cryptographic device.\nSlots Slots are the logical partitions in the cryptographic device. In case of HSMs, there could be hundreds or more slots are available while in the case of smart cards, there could be only on slot available.","tags":null,"title":"PKCS11"},{"categories":null,"contents":"React å…¥é—¨ç¬”è®° 1. è‡ªå®šä¹‰ç»„ä»¶\u0026mdash;åœ¨htmlä¸­ä½¿ç”¨react 1\u0026lt;!DOCTYPE html\u0026gt; 2\u0026lt;html\u0026gt; 3 \u0026lt;head\u0026gt; 4 \u0026lt;title\u0026gt;Hello React\u0026lt;/title\u0026gt; 5 \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; 6 \u0026lt;/head\u0026gt; 7 \u0026lt;body\u0026gt; 8 \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; 9 \u0026lt;!--åº”ç”¨æ¸²æŸ“ä½ç½® --\u0026gt; 10 \u0026lt;/div\u0026gt; 11 \u0026lt;script src=\u0026#34;react/build/react.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; 12 \u0026lt;script src=\u0026#34;react/build/react-dom.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; 13 \u0026lt;script\u0026gt; 14 // åº”ç”¨çš„JavaScriptä»£ç  15 ReactDOM.render( 16 React.DOM.h1(null, \u0026#34;hello world\u0026#34;), 17 document.getElementByID(\u0026#34;app\u0026#34;) 18 ) 19 \u0026lt;/script\u0026gt; 20 \u0026lt;/body\u0026gt; 21\u0026lt;/html\u0026gt; React.DOM.*çš„ä½¿ç”¨ 1React.DOM.h1( 2\t{ 3 id: \u0026#34;my-heading\u0026#34; // ç¬¬ä¸€å‚æ•°ç”¨äºæŒ‡å®šè¯¥ç»„ä»¶çš„DOM å±æ€§ 4 }, 5 \u0026#34;hello world\u0026#34; // ç¬¬äºŒä¸ªå‚æ•°å®šä¹‰è¯¥ç»„ä»¶çš„å­å…ƒç´  6), 7 8// å¯ä»¥æœ‰å¤šä¸ªå­å…ƒç´  9Reat.DOM.h1( 10\t{ 11 id: \u0026#34;my-heading\u0026#34; 12 }, 13 React.DOM.span(null, \u0026#34;hello\u0026#34;), 14 \u0026#34;world\u0026#34; 15), 16 17// å­å…ƒç´ å¯ä»¥åµŒå¥— 18 Reat.DOM.h1( 19\t{ 20 id: \u0026#34;my-heading\u0026#34; 21 }, 22 React.DOM.span(null, 23 React.DOM.em(null, \u0026#34;hell\u0026#34;), 24 \u0026#34;o\u0026#34;), 25 \u0026#34;world!\u0026#34; 26), 27 28// å¦‚æœä½¿ç”¨JSXè¯­æ³• å¯ä»¥åœ¨JavaScriptä¸­æ’å…¥ XML 29 React.DOM.render( 30\t\u0026lt;h1 id=\u0026#34;my-heading\u0026#34;\u0026gt; 31 \u0026lt;span\u0026gt;\u0026lt;em\u0026gt;Hello\u0026lt;/em\u0026gt;0\u0026lt;/span\u0026gt; world! 32 \u0026lt;/h1\u0026gt;, 33 document.getElementById(\u0026#34;app\u0026#34;) 34) ç‰¹æ®Šçš„DOMå±æ€§ class å’Œfor ä¸èƒ½ç›´æ¥åœ¨JavaScriptä¸­ä½¿ç”¨ã€‚è¦ç”¨classNameå’ŒhtmlForã€‚\n1// åä¾‹ å±æ€§ä¸ä¼šç”Ÿæ•ˆ 2React.DOM.h1( 3\t{ 4 class: \u0026#34;pretty\u0026#34;, 5 for: \u0026#34;me\u0026#34;, 6 }, 7 \u0026#34;hello world \u0026#34; 8); 9// æ­£ä¾‹ å±æ€§ç”Ÿæ•ˆ 10React.DOM.h1( 11\t{ 12 className: \u0026#34;pretty\u0026#34;, 13 htmlForor: \u0026#34;me\u0026#34;, 14 }, 15 \u0026#34;hello world \u0026#34; 16); styleä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²èµ‹å€¼ï¼Œéœ€è¦ä½¿ç”¨JavaScriptå¯¹è±¡ï¼Œ\n1// åä¾‹ å±æ€§ä¸ä¼šç”Ÿæ•ˆ 2React.DOM.h1{ 3 { 4 style: \u0026#34; background: balck; color: whrite; font-family: Verdana\u0026#34;, 5 }, 6 \u0026#34;hello world!\u0026#34; 7} 8// æ­£ä¾‹ å±æ€§ç”Ÿæ•ˆ 9React.DOM.h1{ 10 { 11 style: { 12 background: \u0026#34;balck\u0026#34;, 13 color: \u0026#34;whrite\u0026#34;, 14 fontFamily: \u0026#34;Verdana\u0026#34;, 15 }, 16 }, 17 \u0026#34;hello world!\u0026#34; 18} Tips:\nReact.js å°±æ˜¯ä¸€ä¸ªå¼€æºçš„JavaScriptåº“ï¼Œ æ‰€ä»¥å’ŒJavaScriptä¸€æ ·ä½¿ç”¨ï¼Œ å¯ä»¥åœ¨html é¡µé¢ä¸­ é€šè¿‡\u0026lt;script src=\u0026quot;\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;å¼•å…¥Reactåº“ åœ¨é€‰å®šçš„DOMèŠ‚ç‚¹ä¸­æ¸²æŸ“ä¸€ä¸ªReactç»„ä»¶ï¼ŒReactDOM.render(reactWhat,domWhere) ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ 1class Hello extends React.Component { 2 render() { 3 return \u0026lt;div\u0026gt;Hello {this.props.name}\u0026lt;/div\u0026gt;; 4 } 5} 6 7ReactDOM.render( 8 \u0026lt;Hello name=\u0026#34;World\u0026#34; /\u0026gt;, 9 document.getElementById(\u0026#39;container\u0026#39;) 10); è‡ªå®šä¹‰ç»„ä»¶ ReactDOM.render\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/react/%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/","summary":"React å…¥é—¨ç¬”è®° 1. è‡ªå®šä¹‰ç»„ä»¶\u0026mdash;åœ¨htmlä¸­ä½¿ç”¨react 1\u0026lt;!DOCTYPE html\u0026gt; 2\u0026lt;html\u0026gt; 3 \u0026lt;head\u0026gt; 4 \u0026lt;title\u0026gt;Hello React\u0026lt;/title\u0026gt; 5 \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; 6 \u0026lt;/head\u0026gt; 7 \u0026lt;body\u0026gt; 8 \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; 9 \u0026lt;!--åº”ç”¨æ¸²æŸ“ä½ç½® --\u0026gt; 10 \u0026lt;/div\u0026gt; 11 \u0026lt;script src=\u0026#34;react/build/react.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; 12 \u0026lt;script src=\u0026#34;react/build/react-dom.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; 13 \u0026lt;script\u0026gt; 14 // åº”ç”¨çš„JavaScriptä»£ç  15 ReactDOM.render( 16 React.DOM.h1(null, \u0026#34;hello world\u0026#34;), 17 document.getElementByID(\u0026#34;app\u0026#34;) 18 ) 19 \u0026lt;/script\u0026gt; 20 \u0026lt;/body\u0026gt; 21\u0026lt;/html\u0026gt; React.DOM.*çš„ä½¿ç”¨ 1React.DOM.h1( 2\t{ 3 id: \u0026#34;my-heading\u0026#34; // ç¬¬ä¸€å‚æ•°ç”¨äºæŒ‡å®šè¯¥ç»„ä»¶çš„DOM å±æ€§ 4 }, 5 \u0026#34;hello world\u0026#34; // ç¬¬äºŒä¸ªå‚æ•°å®šä¹‰è¯¥ç»„ä»¶çš„å­å…ƒç´  6), 7 8// å¯ä»¥æœ‰å¤šä¸ªå­å…ƒç´  9Reat.","tags":null,"title":"React"},{"categories":null,"contents":" bitmap\nèƒŒæ™¯çŸ¥è¯† æ–‡ä»¶ï¼š\nâ€‹ æ•°æ®å¯ä»¥å­˜åœ¨æ–‡ä»¶é‡Œï¼Œé€šè¿‡grep awk æŸ¥æ‰¾æ–‡ä»¶ã€‚\nâ€‹ å¦‚æœæ–‡ä»¶å˜å¤§ï¼Œ10M -\u0026gt; 1T , æŸ¥æ‰¾ä¼šå˜æ…¢ã€‚å…¨é‡æ‰«æIOã€‚\næ•°æ®åº“ï¼šï¼ˆå—é™äºIOï¼‰\nâ€‹ mysql å­˜å‚¨ï¼Œ å­˜å‚¨åˆ†å—ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•ç›´æ¥è·å–datapageä¸­çš„æ•°æ®ã€‚\nç´¢å¼•ä¹Ÿæ˜¯æ•°æ®å—\näºŒçº§ç´¢å¼•ï¼Œç»™ç´¢å¼•å»ºç«‹ç´¢å¼•\nè¡¨å¾ˆå¤§ï¼Œå¦‚æœè¿æ¥æ¯”è¾ƒå°‘ï¼Œè¯» å¦‚æœå‘½ä¸­ç´¢å¼•ï¼ŒæŸ¥è¯¢è¿˜æ˜¯æ¯«ç§’çº§åˆ«\nå¦‚æœå¹¶å‘å¾ˆå¤§ï¼ˆè¶³å¤Ÿå¤§ï¼‰ï¼Œå¦‚æœæ¯ä¸ªæŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¼šæ”¶åˆ°ååçš„é™åˆ¶ã€‚\nRedis+æ•°æ®åº“ï¼šï¼ˆå†…å­˜ä¸ç£ç›˜çš„æŠ˜ä¸­æ–¹æ¡ˆï¼‰\nnosql -\u0026gt; key vale\nçŸ­åŸŸå-\u0026gt; é•¿åŸŸåï¼Œè®¡æ•°\nå…³è”è¡¨çš„æ•°æ®ä¹Ÿæ”¾ç½®åœ¨valueä¸­ã€‚åªå…³æ³¨æ¯æ¡è®°å½•è‡ªèº«ã€‚\nåŸºäºå†…å­˜çš„\nworker å•çº¿ç¨‹\n6.x IO threads\nvalue æ˜¯æœ‰ç±»å‹çš„ stringã€listã€setã€hashã€zsetï¼›ä¸”æ¯ç§ç±»å‹æœ‰è‡ªå·±çš„æœ¬åœ°æ–¹æ³•ã€‚\næ•°æ®å‘è®¡ç®—ç§»åŠ¨\nè®¡ç®—å‘æ•°æ®ç§»åŠ¨\nè¿æ¥æ± ï¼š\nsocket list çº¿ç¨‹æ± ï¼š\nå¯ä»¥ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å»å¤„ç†è¿æ¥æ± ä¸­çš„è¿æ¥ï¼ˆnioï¼Œå¤šè·¯å¤ç”¨ï¼Œepollï¼‰ å†…å­˜æ•°æ®åº“ï¼šï¼ˆå—é™äºæˆæœ¬ï¼‰\nHana https://bytedance.feishu.cn/docs/doccnwV2ZxHYiLagaPOQSZ3ldlr\nå¸¸è¯†ï¼šs\u0026lt;- ms \u0026lt;-us \u0026lt;-ns\nç¡¬ç›˜ï¼š\nå¸¦å®½ã€ååï¼šç™¾å…†ï¼Œ1-2G pci-e/ nvme 3G/s\nå¯»å€æ—¶é—´ ms\nå†…å­˜:\nå¯»å€æ—¶é—´ ns redis å®‰è£… http://db-engines.com\nhttp://redis.io\nç¼–è¯‘å®‰è£…\nREADME.md\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/redis_preview/","summary":"bitmap\nèƒŒæ™¯çŸ¥è¯† æ–‡ä»¶ï¼š\nâ€‹ æ•°æ®å¯ä»¥å­˜åœ¨æ–‡ä»¶é‡Œï¼Œé€šè¿‡grep awk æŸ¥æ‰¾æ–‡ä»¶ã€‚\nâ€‹ å¦‚æœæ–‡ä»¶å˜å¤§ï¼Œ10M -\u0026gt; 1T , æŸ¥æ‰¾ä¼šå˜æ…¢ã€‚å…¨é‡æ‰«æIOã€‚\næ•°æ®åº“ï¼šï¼ˆå—é™äºIOï¼‰\nâ€‹ mysql å­˜å‚¨ï¼Œ å­˜å‚¨åˆ†å—ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•ç›´æ¥è·å–datapageä¸­çš„æ•°æ®ã€‚\nç´¢å¼•ä¹Ÿæ˜¯æ•°æ®å—\näºŒçº§ç´¢å¼•ï¼Œç»™ç´¢å¼•å»ºç«‹ç´¢å¼•\nè¡¨å¾ˆå¤§ï¼Œå¦‚æœè¿æ¥æ¯”è¾ƒå°‘ï¼Œè¯» å¦‚æœå‘½ä¸­ç´¢å¼•ï¼ŒæŸ¥è¯¢è¿˜æ˜¯æ¯«ç§’çº§åˆ«\nå¦‚æœå¹¶å‘å¾ˆå¤§ï¼ˆè¶³å¤Ÿå¤§ï¼‰ï¼Œå¦‚æœæ¯ä¸ªæŸ¥è¯¢çš„æ•°æ®éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¼šæ”¶åˆ°ååçš„é™åˆ¶ã€‚\nRedis+æ•°æ®åº“ï¼šï¼ˆå†…å­˜ä¸ç£ç›˜çš„æŠ˜ä¸­æ–¹æ¡ˆï¼‰\nnosql -\u0026gt; key vale\nçŸ­åŸŸå-\u0026gt; é•¿åŸŸåï¼Œè®¡æ•°\nå…³è”è¡¨çš„æ•°æ®ä¹Ÿæ”¾ç½®åœ¨valueä¸­ã€‚åªå…³æ³¨æ¯æ¡è®°å½•è‡ªèº«ã€‚\nåŸºäºå†…å­˜çš„\nworker å•çº¿ç¨‹\n6.x IO threads\nvalue æ˜¯æœ‰ç±»å‹çš„ stringã€listã€setã€hashã€zsetï¼›ä¸”æ¯ç§ç±»å‹æœ‰è‡ªå·±çš„æœ¬åœ°æ–¹æ³•ã€‚\næ•°æ®å‘è®¡ç®—ç§»åŠ¨\nè®¡ç®—å‘æ•°æ®ç§»åŠ¨\nè¿æ¥æ± ï¼š\nsocket list çº¿ç¨‹æ± ï¼š\nå¯ä»¥ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å»å¤„ç†è¿æ¥æ± ä¸­çš„è¿æ¥ï¼ˆnioï¼Œå¤šè·¯å¤ç”¨ï¼Œepollï¼‰ å†…å­˜æ•°æ®åº“ï¼šï¼ˆå—é™äºæˆæœ¬ï¼‰\nHana https://bytedance.feishu.cn/docs/doccnwV2ZxHYiLagaPOQSZ3ldlr\nå¸¸è¯†ï¼šs\u0026lt;- ms \u0026lt;-us \u0026lt;-ns\nç¡¬ç›˜ï¼š\nå¸¦å®½ã€ååï¼šç™¾å…†ï¼Œ1-2G pci-e/ nvme 3G/s\nå¯»å€æ—¶é—´ ms\nå†…å­˜:\nå¯»å€æ—¶é—´ ns redis å®‰è£… http://db-engines.com\nhttp://redis.io\nç¼–è¯‘å®‰è£…","tags":null,"title":"Redis"},{"categories":null,"contents":"Reflect\nReflection Let Us Work with Types at Runtime But sometimes, relying on only compilation-time information is a limitation. You might need to work with variables at runtime using information that didn\u0026rsquo;t exist when the program was written. Maybe you\u0026rsquo;re trying to map data from a file or network request into a variable, or you want to build a single function that works with different types. In those situations, you need to use reflection. Reflection allows us to examine types at runtime. It also provides the ability to examine, modify, and create variables, functions, and structs at runtime.\nReading and writing from a database. The database/sql packages uses reflection to send records to databases and read data back. Go\u0026rsquo;s build-in template libraries, text/template and htmp/template, use reflection to process the values that are passed to the templates. The fmt package use reflection heavily, as all of those calls to fmt.Println and friends rely on reflection to delete the type of the provided parameters. The errors package uses reflection to implement errors.Is and errors.As. The sort package uses reflection to implement functions that sort and evaluate slices of any type: sort.Slice,sort.SliceStable,sort.SliceIsSorted. The last main usage of reflection in the Go standard library is for marshaling and unmarshaling data into JSON and XML, along with the other data formats defined in the various endoding packages. Struct tags (which we will talk about soon) are accessed via reflection, and the field in structs are read and written using reflection as well. Most of these examples have on thing in common: they involve accessing and formatting data that is being imported into or exported out of a Go program. You\u0026rsquo;ll often see reflection used at the boundaries between you program and the outside world.\nDeepequal It\u0026rsquo;s in the reflect package because it takes advantage of reflection to do its work. The reflect.Deepequal function checks to see if two values are \u0026ldquo;deep equal\u0026rdquo; to each other. This a more thorough comparison than what you get if you use == to compare two things, and it\u0026rsquo;s used in the standard library as a way to validate test results. It can also compare things that can\u0026rsquo;t be compared using ==, like slices and maps.\nMost of the time, you don\u0026rsquo;t need Deepequal, but if you ever wanted to compare two maps to see if all of their keys and values are identical or see if two slices were identical, Deepequal is what you need.\nTypes, Kinds, and Values The reflect package in the standard library is the home for the types and functions that implement reflections in Go. Reflection is built around three core concepts: types, kinds and values.\nFirst let\u0026rsquo;s look at types. A type in reflection is exactly what it sounds like. It defines the properties of a variable, what it can hold, and how you can interact with it. With reflection, you are able to query a type to find out about these properties using code.\nTypes and kinds We get the reflection representation of the type a variable with the Typeof function in the reflect package:\n1vType := reflect.TypeOf() The Kind method on reflect.Type returns a value of type reflect.Kind, which is a constant that says what the type is made of - a slice, a map, a pointer, a struct, an interface, a string, an array, a function, an int, or some other primitive type. The difference between the kind and the type can be tricky to understand. Remember this rule: if you define a struct named Foo, the kind is reflect.Struct and the type is \u0026ldquo;Foo\u0026rdquo;.\nFFI: Foreign Function Interface\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/14-golang_reflect_unsafe_cgo/","summary":"Reflect\nReflection Let Us Work with Types at Runtime But sometimes, relying on only compilation-time information is a limitation. You might need to work with variables at runtime using information that didn\u0026rsquo;t exist when the program was written. Maybe you\u0026rsquo;re trying to map data from a file or network request into a variable, or you want to build a single function that works with different types. In those situations, you need to use reflection.","tags":null,"title":"Reflect, Unsafe, and Cgo"},{"categories":null,"contents":"ICN-SDWAN-Virginia AWS2\nIPv4 Prefixes Public IPv4 Private IPv4 ICN-SDWAN-Virginia-Eth1 3.211.4.230 10.20.0.232 ICN-SDWAN-Virginia-Eth0 34.230.111.156 10.20.0.23 ICN-SDWAN- California AWS5\nIPv4 Prefixes Public IPv4 Private IPv4 ICN-SDWAN-California-Eth1 54.177.9.32 172.16.182.169 ICN-SDWAN-California-Eth0 54.241.18.249 172.16.182.237 iptables -I POSTROUTING -d 172.17.0.2/32 -j SNAT \u0026ndash;to-source 192.169.0.4 -t nat\niptables -I POSTROUTING -d 10.0.0.1/24 -j SNAT \u0026ndash;to-source 10.8.0.1 -t nat\nAWS2 eth1 MAC Address\n0e:4e:31:15:1a:ed\n0e:4e:31:15:1a:ed\n1ip addr add 10.20.0.232/20 dev 1eth1: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 0e:4e:31:15:1a:ed brd ff:ff:ff:ff:ff:ff inet 10.20.0.232/20 brd 10.20.15.255 scope global eth1 valid_lft forever preferred_lft forever inet6 fe80::c4e:31ff:fe15:1aed/64 scope link valid_lft forever preferred_lft forever http://sdewan.sh.intel.com:10880/xiaoxime/SDEWAN-SetUp/commit/9566bb2f179c034c4b57da9047ae00e42ba2affa\nOpen Switch\n1# all in controller pod 2ovs-vsctl 3ovn-nbctl Use Tmux Connect to the Host\n1ssh ubuntu@sdewan.sh.intel.com passwd: 123456 There are four windows of tmux for different SDEWAN cluster\n1tmux a -t vpn Use multispass\nConnect to the Host\n1ssh ubuntu@sdewan.sh.intel.com passwd: 123456 1# run the following command to enter different VM 2 3m shell vpn-overlay 4m shell vpn-hub 5m shell vpn-edge-1 6m shell vpn-edge-2 end\nForm Virgina to California\nVigina California Protocol Result Protocal Result eth1(CNF) 3.211.4.230 54.177.9.32 ICMP PASS SSH(22) Failed eth0(Host) 34.230.111.156 54.177.9.32 ICMP PASS SSH(22) PASS From California to Virgina\nCalifornia Vigina Protocol Result Protocal Result eth1(CNF) 54.177.9.32 3.211.4.230 ICMP PASS SSH(22) Failed eth0(Host) 54.241.18.249 3.211.4.230 ICMP PASS SSH(22) Failed AWS3-Virginia\nInterface Public IP Local IP eth0 35.169.8.124 10.20.0.129 eth1 3.83.186.169 10.20.0.213 hhh\nAWS4- California\nInterface Public IP Local IP eth0 54.215.142.138 172.16.182.54 eth1 50.18.65.42 172.16.182.149 About AWS IPsec Tunnel Test\nNow we can successful create IPsec Tunnel between Two CNF on AWS VM located in different region. This verified the the possibility of using SDEWAN with Nodus in WAN.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/sdewan-AWS-testnodus/","summary":"ICN-SDWAN-Virginia AWS2\nIPv4 Prefixes Public IPv4 Private IPv4 ICN-SDWAN-Virginia-Eth1 3.211.4.230 10.20.0.232 ICN-SDWAN-Virginia-Eth0 34.230.111.156 10.20.0.23 ICN-SDWAN- California AWS5\nIPv4 Prefixes Public IPv4 Private IPv4 ICN-SDWAN-California-Eth1 54.177.9.32 172.16.182.169 ICN-SDWAN-California-Eth0 54.241.18.249 172.16.182.237 iptables -I POSTROUTING -d 172.17.0.2/32 -j SNAT \u0026ndash;to-source 192.169.0.4 -t nat\niptables -I POSTROUTING -d 10.0.0.1/24 -j SNAT \u0026ndash;to-source 10.8.0.1 -t nat\nAWS2 eth1 MAC Address\n0e:4e:31:15:1a:ed\n0e:4e:31:15:1a:ed\n1ip addr add 10.20.0.232/20 dev 1eth1: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 0e:4e:31:15:1a:ed brd ff:ff:ff:ff:ff:ff inet 10.","tags":null,"title":"SDEWAN AWS test nodus"},{"categories":null,"contents":"SD-WAN handles the network connectivity issues between distributed applications in a seamless, secure, and efficient manner by replacing traditional branch routers with virtualized or appliance-based software. However, as the concept of edge prevails recently, distributed applications are usually deployed across multiple resource-constrained k8s edges. Then how to expose the services and manage the connections in a cloud-native way becomes a critical issue for users.\nThe open-source project Software Define Edge WAN(SD-EWAN) under the Akraino communityâ€™s ICN blueprint is definitely a comprehensive solution. Its CNF, which is integrated with multiple network functions based on OpenWRT, is able to serve the distributed applications with secure connections and easy management against networking and the CNF can be automatic thru the overlay controller within SD-EWAN to achieve multi-edge collaboration.\nThis post is not covering the archtecture of SDEWAN. If you want to lean more about SDEWAN you can find more information form https://github.com/akraino-edge-stack/icn-sdwan. Intention of this post is to cover the CNF which co-works with Intel Software Guard Extensions to create a secruity IPsec tunnel.\nSecurity Connection Between Edge Cluster Through CNF One of the functionality of SD-EWAN is to set up secure connection between two edge cluster. SDEWAN functionality is realized via CNF(Containerized Network Function) and deployed by K8s. SD-EWAN creates IPsec tunnles between two CNF Pod across K8s cluster. The CNF here is based on OpenWRT open source and enhancing, optimizing for Intel IA sccelerator and make it ready for cloud native Edge scenarios.\nIn the CNF, we use Strongswan to manage the IPsec tunnel and connect two Edges in a private network the a traffice Hub. The traffice Hub has an publice IP, and two different Edges can access the Hub through the public IP bind on the hub.\nTraditional Configuration of IPsec The Traditional configuration put the private key and certificate in the Pod filesystem located at /etc/ipsec.d.\nLeverage SGX to Create Secure Tunnle Archtecture The architecture of the CNF which work with CTK is like that.\nEnable PKCS#11 for Strongswan Build p11-kit-client for OpenWRT After build the p11-kit-client, we shoud add Setup IPsec Tunnel with SGX ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/sdewan-sgx/","summary":"SD-WAN handles the network connectivity issues between distributed applications in a seamless, secure, and efficient manner by replacing traditional branch routers with virtualized or appliance-based software. However, as the concept of edge prevails recently, distributed applications are usually deployed across multiple resource-constrained k8s edges. Then how to expose the services and manage the connections in a cloud-native way becomes a critical issue for users.\nThe open-source project Software Define Edge WAN(SD-EWAN) under the Akraino communityâ€™s ICN blueprint is definitely a comprehensive solution.","tags":null,"title":"SDEWAN Leverage SGX to provide Secure Access Service Edge"},{"categories":null,"contents":"SDEWAN: Setup by pull mode Version requirement:\nâ€‹\tUbuntu: 20.04\nâ€‹\tscc: build from https://github.com/intel-sandbox/akraino-sdewan/tree/rc-22.06\nâ€‹\tcnf: docker pull integratedcloudnative/sdewan-cnf:0.5.3\ncrd-controller: docker pull integratedcloudnative/sdewan-controller:0.5.3\n0.Create an Github repo for pull mode â€‹\tCreate an Github repo for SDEWAN pull mode, for example: https://github.com/airren/flux\nâ€‹ Next, prepare an Personal access tokens for SDEAN to access the repo.\nUpdate your repo info and token to this file SDEWAN-SetUp/ewo-tools/cluster-sync-object.yaml.\n1# SDEWAN-SetUp/ewo-tools/cluster-sync-object.yaml 2--- 3# creating cluster-sync-obj 4version: ewo/v1 5resourceContext: 6anchor: overlays/overlay1/cluster-sync-objects 7metadata: 8name: cso2 9description: 10userData1: 11userData2: 12spec: 13kv: 14- gitType: github 15- userName: Airren # change to your own github username 16- gitToken: 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 # change to your own 17- repoName: flux # change to your own 18- branch: main Update the GITHUB_TOKEN in SDEWAN-SetUp/setup_flux.sh\nUpdate the repo info and token in SDEWAN-SetUp/monitor_stuff/monitor_configs\n1username=Airren # change to your own 2token=ghp_LaAMXYmdcSWbmSOp9fQPL # change to your own 3repo_name=flux 4cluster=akraino_scc_overlay1+edge-1 5http_proxy=http://proxy-prc.intel.com:913 6https_proxy=http://proxy-prc.intel.com:913 1. Setup 4 VMs with SDEWAN base components 1./0_auto_setup.sh -n \u0026lt;vm-perfix\u0026gt; After that, you will install most the components of SDEWAN. But due to the proxy limitation, we have to do some check work manually.\na. Add proxy configuration to the git repo for Hub/Edge-1/Edge-2. https://github.com/Airren/flux/blob/main/clusters/akraino_scc_overlay1%2Bedge-2/flux-system/kustomization.yaml\n1patches: 2 - patch: | 3 apiVersion: apps/v1 4 kind: Deployment 5 metadata: 6 name: all 7 spec: 8 template: 9 spec: 10 containers: 11 - name: manager 12 env: 13 - name: \u0026#34;HTTPS_PROXY\u0026#34; 14 value: \u0026#34;http://proxy-prc.intel.com:913\u0026#34; 15 - name: \u0026#34;HTTP_PROXY\u0026#34; 16 value: \u0026#34;http://proxy-prc.intel.com:913\u0026#34; 17 - name: \u0026#34;NO_PROXY\u0026#34; 18 value: \u0026#34;10.0.11.1/24,10.95.62.1/16,192.169.0.1/24,192.168.0.1/24,10.233.0.1/16,localhost,10.96.0.1/24,192.168.174.0/24,172.17.0.1/24,.cluster.local.,.cluster.local,.svc\u0026#34; 19 target: 20 kind: Deployment 21 labelSelector: app.kubernetes.io/part-of=flux b. Re run flux init on Hub/Edge-1/Edge-2, check the result\n1# for hub cluster 2setup_flux.sh hub 3# for edge-1 cluster 4setup_flux.sh edge-1 5# for edge-2 cluster 6setup_flux.sh edge-2 c. Re-deploy monitor if need on Hub/Edge-1/Edge-2 respectively.\n1SDEWAN-SetUp/monitor_stuff/monitor-deploy.sh 2.Register Overlay 1cd SDEWAN-SetUp/ewo-tools 2./ewoctl --config ./ewo-config.yaml apply -f pre.yaml 3./ewoctl --config ./ewo-config.yaml apply -f cluster-sync-object.yaml 3.Register Hub/Edge-1/Edge-2 1cd SDEWAN-SetUp/ewo-tools 2./ewoctl --config ./ewo-config.yaml apply -f huba.yaml 3./ewoctl --config ./ewo-config.yaml apply -f edge-1.yaml 4./ewoctl --config ./ewo-config.yaml apply -f edge-2.yaml 4.Register Hub/Edge-1/Edge-2 1cd SDEWAN-SetUp/ewo-tools 2./ewoctl --config ./ewo-config.yaml apply -f huba-edge-1-con.yaml 3./ewoctl --config ./ewo-config.yaml apply -f huba-edge-2-con.yaml 5.Deploy Application as before. Other Notes: (Not Need, Just for Debug) 1 kubectl patch deployments.apps -n flux-system source-controller --patch-file patch.yaml 2 3 k patch deployments.apps -n sdewan-system rsync --patch-file rsync-patch.yaml ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/sdewan-pull-mode/","summary":"SDEWAN: Setup by pull mode Version requirement:\nâ€‹\tUbuntu: 20.04\nâ€‹\tscc: build from https://github.com/intel-sandbox/akraino-sdewan/tree/rc-22.06\nâ€‹\tcnf: docker pull integratedcloudnative/sdewan-cnf:0.5.3\ncrd-controller: docker pull integratedcloudnative/sdewan-controller:0.5.3\n0.Create an Github repo for pull mode â€‹\tCreate an Github repo for SDEWAN pull mode, for example: https://github.com/airren/flux\nâ€‹ Next, prepare an Personal access tokens for SDEAN to access the repo.\nUpdate your repo info and token to this file SDEWAN-SetUp/ewo-tools/cluster-sync-object.yaml.\n1# SDEWAN-SetUp/ewo-tools/cluster-sync-object.yaml 2--- 3# creating cluster-sync-obj 4version: ewo/v1 5resourceContext: 6anchor: overlays/overlay1/cluster-sync-objects 7metadata: 8name: cso2 9description: 10userData1: 11userData2: 12spec: 13kv: 14- gitType: github 15- userName: Airren # change to your own github username 16- gitToken: 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 # change to your own 17- repoName: flux # change to your own 18- branch: main Update the GITHUB_TOKEN in SDEWAN-SetUp/setup_flux.","tags":null,"title":"SDEWAN Setup"},{"categories":null,"contents":"Prepare Machine 1sudo ip route add default via 10.0.11.100 dev eno1 2 3cat \u0026lt;\u0026lt;EOF | sudo tee /etc/resolv.conf 4nameserver 127.0.0.53,10.248.2.5 5options edns0 trust-ad 6search sh.intel.com 7EOF 8 9sudo vi /etc/netplan/00-installer-config.yaml 10network: 11 ethernets: 12 eno1: 13 dhcp4: true 14 nameservers: 15 addressses: [10.248.2.5] 16 version: 2 17 18 19 20git clone -b sgx http://sdewan.sh.intel.com:10880/airren/SDEWAN-SetUp.git 21 22 23 24 25apt-cache search linux-image 26sudo apt-get install linux-image-your_version_choice linux-headers-your_version_choice linux-image-extra-your_version_choice 27 28# must reboot you machine 29sudo apt update \u0026amp;\u0026amp; sudo apt install -y linux-image-5.15.0-33-generic linux-headers-5.15.0-33-generic linux-modules-5.15.0-33-generic linux-modules-extra-5.15.0-33-generic 30# https://packages.ubuntu.com/focal-updates/kernel/ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/sdewan-sgx-testenv/","summary":"Prepare Machine 1sudo ip route add default via 10.0.11.100 dev eno1 2 3cat \u0026lt;\u0026lt;EOF | sudo tee /etc/resolv.conf 4nameserver 127.0.0.53,10.248.2.5 5options edns0 trust-ad 6search sh.intel.com 7EOF 8 9sudo vi /etc/netplan/00-installer-config.yaml 10network: 11 ethernets: 12 eno1: 13 dhcp4: true 14 nameservers: 15 addressses: [10.248.2.5] 16 version: 2 17 18 19 20git clone -b sgx http://sdewan.sh.intel.com:10880/airren/SDEWAN-SetUp.git 21 22 23 24 25apt-cache search linux-image 26sudo apt-get install linux-image-your_version_choice linux-headers-your_version_choice linux-image-extra-your_version_choice 27 28# must reboot you machine 29sudo apt update \u0026amp;\u0026amp; sudo apt install -y linux-image-5.","tags":null,"title":"SDEWAN SGX Test Environment"},{"categories":null,"contents":"1node-1 10.151.128.13 2node-2 10.151.128.14 1# Hub 2ip rule add iif vti_192.169.0.1 lookup 51 3ip rule add iif vti_192.169.0.2 lookup 51 4ip route add default via \u0026lt;net pod\u0026gt; dev net1 table 51 5#ip route add default via 10.151.128.13 dev net1 table 51 6 7# Node-1 8ip route add 192.169.0.0/24 via 10.151.128.14 dev net1 9 10# Node-2 11ip route add 192.169.0.0/24 via 10.151.128.12 dev net1 12 13 14sysctl -w net.ipv4.ip_forward=1 15 echo 1 \u0026gt; /proc/sys/net/ipv4/ip_forward ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/sdewan/service-function-chain/","summary":"1node-1 10.151.128.13 2node-2 10.151.128.14 1# Hub 2ip rule add iif vti_192.169.0.1 lookup 51 3ip rule add iif vti_192.169.0.2 lookup 51 4ip route add default via \u0026lt;net pod\u0026gt; dev net1 table 51 5#ip route add default via 10.151.128.13 dev net1 table 51 6 7# Node-1 8ip route add 192.169.0.0/24 via 10.151.128.14 dev net1 9 10# Node-2 11ip route add 192.169.0.0/24 via 10.151.128.12 dev net1 12 13 14sysctl -w net.ipv4.ip_forward=1 15 echo 1 \u0026gt; /proc/sys/net/ipv4/ip_forward ","tags":null,"title":"Service function chain"},{"categories":null,"contents":"è®¡ç®—ç”Ÿç‰©å­¦å®¶çš„ä¸€é¡¹å·¥ä½œå°±æ˜¯æ ¹æ®å¯†ç å°†DNAè½¬æ¢ä¸ºç”±4ä¸ªç¢±åŸºç»„æˆçš„éå¸¸é•¿çš„å­—ç¬¦ä¸²ã€‚\nKnuthã€Morrisã€Pratt å­å­—ç¬¦ä¸²æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™äº›ç»å…¸ç®—æ³•çš„åŸºç¡€æ˜¯ä¸¤ä¸ªåŸºæœ¬æ¦‚å¿µï¼šå½¢å¼è¯­è¨€å’Œç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºã€‚\nJACA å®‰è£…é…ç½®\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/DataStruct/string/","summary":"è®¡ç®—ç”Ÿç‰©å­¦å®¶çš„ä¸€é¡¹å·¥ä½œå°±æ˜¯æ ¹æ®å¯†ç å°†DNAè½¬æ¢ä¸ºç”±4ä¸ªç¢±åŸºç»„æˆçš„éå¸¸é•¿çš„å­—ç¬¦ä¸²ã€‚\nKnuthã€Morrisã€Pratt å­å­—ç¬¦ä¸²æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™äº›ç»å…¸ç®—æ³•çš„åŸºç¡€æ˜¯ä¸¤ä¸ªåŸºæœ¬æ¦‚å¿µï¼šå½¢å¼è¯­è¨€å’Œç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºã€‚\nJACA å®‰è£…é…ç½®","tags":null,"title":"String å­—ç¬¦ä¸²"},{"categories":null,"contents":"When reading/adjusting any StrongSwan configurations, remember these important words:\nleft is local to the machine it\u0026rsquo;s stated on; right is remote in the same manner\nSo, on the server side, left is local to the server and on the client side, left is local to that client.\ncheck the X509 cert details\n1openssl x509 -text -noout -in /etc/ipsec.d/private/sunKey.pem â€‹\nUbuntu Set up IPsec Tunnel 1docker run --rm -d -i --network host --name cnf --user root -v /home/ubuntu/entrypoint.sh:/entrypoint.sh --privileged cnf:pro sleep infinity 2 3 4docker run --rm -i -d --network host --name cnf --user root -v /home/ubuntu/entrypoint.sh:/entrypoint.sh --privileged cnf:pro bash -c \u0026#39;/entrypoint.sh\u0026#39; Install StrongsWan 1sudo apt update \u0026amp;\u0026amp; sudo apt install strongswan strongswan-swanctl strongswan-pki strongswan-charon charon-cmd charon-systemd -y 2 3 4sudo apt remove strongswan strongswan-swanctl strongswan-pki strongswan-charon charon-cmd charon-systemd -y åœ¨å¦‚ä¸‹ä¸¤å°æœºå™¨ä¹‹é—´ å»ºç«‹ host-to-hostçš„ipsec tunnle, ä»¥ä¸‹é…ç½®è¿‡ç¨‹æ•´ç†è‡ªStrongswan.\n1| 10.95.62.25 | === | 10.95.62.114 | 2 moon sun ç”Ÿæˆè¯ä¹¦ ä½¿ç”¨strongswançš„PKI tool åˆ›å»ºè¯ä¹¦ã€‚\n1# åˆ›å»º root ç§é’¥ 2pki --gen --outform pem \u0026gt; caKey.pem 3# ç”Ÿæˆ root CA 4pki --self --in caKey.pem --dn \u0026#34;C=CH, O=strongSwan, CN=strongSwan CA\u0026#34; --ca --outform pem \u0026gt; caCert.pem 5 6# ç”Ÿæˆ node-1 ç§é’¥ 7pki --gen --outform pem \u0026gt; moonKey.pem 8# ä½¿ç”¨ root caç­¾å‘ node-1 ç«¯è¯ä¹¦ 9pki --issue --in moonKey.pem --type priv \\ 10--cacert caCert.pem --cakey caKey.pem \\ 11--dn \u0026#34;C=CH, O=strongSwan,CN=moon.strongswan.org\u0026#34; --san moon.strongswan.org \\ 12--outform pem \u0026gt; moonCert.pem 13 14# ç”Ÿæˆ node-2 ç§é’¥ 15pki --gen --outform pem \u0026gt; sunKey.pem 16# ä½¿ç”¨ root caç­¾å‘ node-1 ç«¯è¯ä¹¦ 17pki --issue --in sunKey.pem --type priv \\ 18--cacert caCert.pem --cakey caKey.pem \\ 19--dn \u0026#34;C=CH, O=strongSwan,CN=sun.strongswan.org\u0026#34; --san sun.strongswan.org \\ 20--outform pem \u0026gt; sunCert.pem Host-to-Host é…ç½® Configuration on host moon:\n1 sudo cp caCert.pem /etc/swanctl/x509ca/caCert.pem 2 sudo cp moonCert.pem /etc/swanctl/x509/moonCert.pem 3 sudo cp moonKey.pem /etc/swanctl/private/moonKey.pem 4 5/etc/swanctl/swanctl.conf: 6 7 connections { 8 host-host { 9 #remote_addrs = 52.9.61.247 10 pools=client_pool 11 12 local { 13 auth=pubkey 14 certs = moonCert.pem 15 } 16 remote { 17 auth = pubkey 18 id = \u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 19 } 20 children { 21 net-net { 22 remote_ts=192.168.0.1/32 23 start_action = trap 24 } 25 } 26 } 27 } 28 pools{ 29 client_pool{ 30 addrs=192.168.0.1 31 } 32} Configuration on host sun:\n1sudo cp caCert.pem /etc/swanctl/x509ca/caCert.pem 2sudo cp sunCert.pem /etc/swanctl/x509/sunCert.pem 3sudo cp sunKey.pem /etc/swanctl/private/sunKey.pem 4 5/etc/swanctl/swanctl.conf: 6 7 connections { 8 host-host { # connection name 9 remote_addrs = 34.230.111.156 10 11 local { 12 auth = pubkey 13 certs = sunCert.pem 14 } 15 remote { 16 auth = pubkey 17 id = \u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 18 } 19 children { 20 host-host { 21 remote_ts=10.20.0.118/32 22 start_action = trap 23 } 24 } 25 } 26 } ä¸Šè¿°é…ç½®æ˜¯ æ˜¯ç”¨keyåšè®¤è¯ï¼Œä¸‹é¢ä¸¾ä¸ªä½¿ç”¨pre-shared keyçš„ä¾‹å­\n1 # configuration on moon 2 connections { 3 host-host { 4 remote_addrs = 10.95.62.114 5 6 local { 7 auth=psk 8 id = \u0026#34;moon.strongswan.org\u0026#34; 9 } 10 remote { 11 auth = psk 12 id = \u0026#34;sun.strongswan.org\u0026#34; 13 } 14 children { 15 net-net { 16 start_action = trap 17 } 18 } 19 } 20 } 21 secrets{ 22 ike-h2h{ 23 id-moon = \u0026#34;moon.strongswan.org\u0026#34; 24 id-sun = \u0026#34;sun.strongswan.org\u0026#34; 25 secret = mysecret 26 } 27} 28 29 # configuration on sun 30 connections { 31 host-host { # connection name 32 remote_addrs = 10.95.62.25 33 34 local { 35 auth = psk 36 id = \u0026#34;sun.strongswan.org\u0026#34; 37 } 38 remote { 39 auth = psk 40 id = \u0026#34;moon.strongswan.org\u0026#34; 41 } 42 children { 43 host-host { 44 start_action = trap 45 } 46 } 47 } 48 } 49 secrets{ 50 ike-h2h{ 51 id-moon = \u0026#34;moon.strongswan.org\u0026#34; 52 id-sun = \u0026#34;sun.strongswan.org\u0026#34; 53 secret = mysecret 54 } 55 } é…ç½®å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨swanclt --load-all ä½¿é…ç½®ç”Ÿæ•ˆã€‚\nå¦‚æœç»™initiator åˆ†é…ä¸€ä¸ªVirtual IP.\nInitiator è·å¾—è™šæ‹ŸIPåä¼šå† IP table 220 ä¸­å¢åŠ å¯¹åº”IPçš„è·¯ç”±æ–¹å¼ã€‚\nSmartCard demo with OpenSC Build Strongswan with pcks11 1# install essential dependency 2sudo apt install build-essential libgmp-dev libunbound-dev libldns-dev -y 3git clone https://github.com/strongswan/strongswan.git 4./autogen.sh 5# config 6# ./configure --prefix=/usr --sysconfdir=/etc --enable-eap-mschapv2 --enable-kernel-libipsec --enable-swanctl --enable-unity --enable-unbound --enable-vici --enable-xauth-eap --enable-xauth-noauth --enable-eap-identity --enable-md4 --enable-pem --enable-openssl --enable-pubkey --enable-farp --enable-pkcs11 7./configure --prefix=/usr --sysconfdir=/etc --enable-pkcs11 CFLAGS=\u0026#34;-DDEBUG_LEVEL=1\u0026#34; 8make 9sudo make install 10sudo systemctl daemon-reload 11sudo systemctl restart strongswan-starter.service Build virt_cacard virt_card using libcacard, vitualsmartcard\u0026rsquo;s vpcd and softhsm2 to provide PCSC accessible virtual smart card.\n1# install essential dependency, libcacard \u0026amp; softhsm2 2sudo apt install libcacard-dev libglib2.0-dev softhsm2 gnutls-bin libnss3-tools -y Build \u0026amp; Install vsmartcard\n1sudo apt-get install -y help2man libpcsclite-dev 2git clone https://github.com/frankmorgner/vsmartcard.git 3cd vsmartcard/virtualsmartcard 4autoreconf --verbose --install 5./configure --sysconfdir=/etc 6make 7sudo make install Build \u0026amp; Install virt_card\n1cd ~ 2git clone https://github.com/Jakuje/virt_cacard.git 3cd virt_cacard 4./autogen.sh 5./configure 6make configure softhsm with default certificates and start virt_cacard\n1./setup-softhsm2.sh 2export SOFTHSM2_CONF=/home/ubuntu/vivirt_cacard/softhsm2.conf \u0026amp;\u0026amp;./virt_cacard After that you should be able to access virtual smart card through OpenSC:\n1pkcs11-tool -L 1pkcs15-tool --list-pins --list-keys --list-certificates 1# Generate Key pair 2openssl req -out pkcs11-new.csr -newkey rsa:2048 -nodes -keyout pkcs11-new.key -subj \u0026#34;/CN=pkcs11-new\u0026#34; 3# Generate Certificate 4openssl x509 -req -days 365 -CA caCert.pem -CAkey caKey.pem -set_serial 1 -in pkcs11-new.csr -out pkcs11-new.crt 5# Transform CA type to DER 6 openssl rsa -in ./pkcs11-new.key -outform DER -out pkcs11-new.key.der 7 openssl x509 -in ./pkcs11-new.crt -outform DER -out pkcs11-new.crt.der 8 9 10 # Creating a token 11# pkcs11-tool --init-token --label \u0026#34;pkcs11-new\u0026#34; --slot 0--so-pin 12345678 --init-pin --pin 12345678 12 13 # add private key 14 pkcs11-tool -login --pin 12345678 --login-type user --slot 0 --write-object pkcs11-new.key.der --type privkey --id 0001 15 # add cert 16 pkcs11-tool -login --pin 12345678 --login-type user --slot 0 --write-object pkcs11-new.crt.der --type cert --id 0001 Common Tools of PKCS#11 1# list slot 2pkcs11-tool --module /usr/local/lib/libp11sgx.so -L 3# list object of slot 4pkcs11-tool --module /usr/local/lib/libp11sgx.so --slot 0x7316c269 -O Creating a token 1 pkcs11-tool --module /usr/local/lib/libp11sgx.so --init-token --label \u0026#34;ctk\u0026#34; --slot 0 --so-pin 1234 --init-pin --pin 1234 Creating an RSA keypair 1pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 1234 --id 0001 --token \u0026#34;ctk\u0026#34; --keypairgen --key-type rsa:3072 --label \u0026#34;cert-key\u0026#34; --usage-sign Listing the objects 1pkcs11-tool --module /usr/local/lib/libp11sgx.so --list-objects -login --pin 1234 --login-type user 1# login 2pkcs11-tool --module /usr/local/lib/libp11sgx.so -login --pin 1234 --login-type user --slot 0x18c37829 - 3 #listobject 4 pkcs11-tool --module /usr/local/lib/libp11sgx.so -login --pin 1234 --login-type user --slot 0x18c37829 -O 5# delete private key 6 pkcs11-tool --module /usr/local/lib/libp11sgx.so -login --pin 1234 --login-type user --slot 0x18c37829 --delete-object --type privkey -d 0001 7 # delete public key 8 pkcs11-tool --module /usr/local/lib/libp11sgx.so -login --pin 1234 --login-type user --slot 0x18c37829 --delete-object --type pubkey -d 0001 9 10 # add private key 11 pkcs11-tool --module /usr/local/lib/libp11sgx.so -login --pin 12345678 --login-type user --slot 0x18c37829 --write-object clientkey.der --type privkey --id 0001 12 # add cert 13 pkcs11-tool --module /usr/local/lib/libp11sgx.so -login --pin 1234 --login-type user --slot 0xc8cbdbc --write-object clientcrt.der --type cert --id 0001 14 15 # create key paair 16 pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 1234 --id 0001 --token \u0026#34;ctk\u0026#34; --keypairgen --key-type rsa:3072 --label \u0026#34;cert-key\u0026#34; --usage-sign --slot 0x18c37829 Smart Demo with Intel SGX CTK Build and Install SGX SDK\nBuild \u0026amp; Install SDK 1# Ubuntu 20.04 2sudo apt-get install build-essential ocaml ocamlbuild automake autoconf libtool wget python-is-python3 libssl-dev git cmake perl -y 3sudo apt-get install libssl-dev libcurl4-openssl-dev protobuf-compiler libprotobuf-dev debhelper cmake reprepro unzip -y 4 5sudo apt-get install build-essential python -y 6 7git clone https://github.com/intel/linux-sgx.git 8cd linux-sgx \u0026amp;\u0026amp; make preparation 9sudo cp external/toolset/{current_distr}/{as,ld,ld.gold,objdump} /usr/local/bin 10which as ld ld.gold objdump 11 12make sdk 13make sdk_install_pkg 14# linux/installer/bin/sgx_linux_x64_sdk_${version}.bin location /opt/intel 15 16export SDK_INSTALL_PATH_PREFIX=/opt/intel 17./sgx_linux_x64_sdk_${version}.bin --prefix $SDK_INSTALL_PATH_PREFIX 18 source ${sgx-sdk-install-path}/environment 19 # source /opt/intel/sgxsdk/environment verify SGX SDK\n1$ cd ${sgx-sdk-install-path}/SampleCode/LocalAttestation 2 $ make SGX_MODE=SIM 3 $ cd bin 4 $ ./app Build \u0026amp; Install PSW 1make psw 2make deb_psw_pkg 3make deb_local_repo 4# linux/installer/deb/sgx_debian_local_repo 5# deb [trusted=yes arch=amd64] file: /home/ubuntu/linux-sgx/linux/installer/deb/local_repo_tool/../sgx_debian_local_repo focal main 6sudo apt update 7sudo apt-get install libsgx-launch libsgx-urts -y Build \u0026amp; Install Intel-sgx-ssl 1make all test 2sudo make install Build \u0026amp; Install CTK 1sudo apt-get install dkms autoconf libcppunit-dev autotools-dev libc6-dev libtool build-essential -y 2#libprotobuf10 3 4make 5sudo make install Build \u0026amp; Install pkcs11 Tool 1git clone https://github.com/Mastercard/pkcs11-tools.git 2./configure 3sudo make install use p11req generate csr\n1p11req -i my-ec-key -d \u0026#39;/CN=my.site.org/O=My organization/C=BE\u0026#39; -e \u0026#39;DNS:another-url-for-my.site.org\u0026#39; -v Initialize HSM \u0026amp; Generate Cert 1# Init Token 2pkcs11-tool --module /usr/local/lib/libp11sgx.so --init-token --label \u0026#34;sgx-pkcs11\u0026#34; --slot 0 --so-pin 12345678 --init-pin --pin 12345678 3#Create Key Pair 4pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 --id 0001 --token \u0026#34;sgx-pkcs11\u0026#34; --keypairgen --key-type rsa:2048 --label \u0026#34;cert-key\u0026#34; --usage-sign 5 6# Check slot info 7pkcs11-tool --module /usr/local/lib/libp11sgx.so -L 8 9# Create csr, cert-key is the private lable 10p11req -l /usr/local/lib/libp11sgx.so -i cert-key -d \u0026#39;/CN=sgx-node\u0026#39; -s 0x5e6dceb4 -p 12345678 \u0026gt; new.csr 11 12# Issuer the cert from root CA 13openssl x509 -req -days 365 -CA caCert.pem -CAkey caKey.pem -set_serial 1 -in new.csr -out client.crt 14# Transfer to DER form 15openssl x509 -in client.crt -outform DER -out clientcrt.der 16# Add cert to HSM 17pkcs11-tool --module /usr/local/lib/libp11sgx.so -login --pin 12345678 --login-type user --slot 0x5e6dceb4 --write-object clientcrt.der --type cert --id 0001 18 19# Check private Key and Cert status 20pkcs11-tool --module /usr/local/lib/libp11sgx.so --login --pin 12345678 -O --slot 0x5e6dceb4 1#éœ€è¦ä¸‹è½½çš„ ç»„ä»¶ 2 3crypto-api-toolkit intel-sgx-ssl linux-sgx linux-sgx-driver OpenSC pkcs11 SDEWAN-SetUp SGX.code-workspace sgx-pkcs11 sgx-software-enable strongswan virt_cacard vsmartcard Configure PCKS#11 Plugin of Strongswan 1#strongswan.d/charon/pkcs11.conf 2pkcs11 { 3 load = yes 4 modules { 5 ctk{ 6 path=/usr/local/lib/libp11sgx.so 7 os_locking=yes 8 load_certs=yes 9 } 10 } 11 12} 13 14 15bash-5.1$ /usr/lib/libp11-kit.so.0^C 16 17 18echo \u0026#39;pkcs11 { 19 load = yes 20 modules { 21 ctk{ 22 path=/usr/lib/p11-kit-client.so 23 os_locking=yes 24 load_certs=yes 25 } 26 } 27}\u0026#39; | sudo tee /etc/strongswan.d/charon/pkcs11.conf Configure IPsec Tunnel through swanctl.conf 1# /etc/swanctl/swanctl.conf 2connections { 3 pkcs11-demo{ # connection name 4 # remote_addrs = 10.95.62.25 5 pools = client_pool 6 7 local { 8 auth = pubkey 9 cert1{ 10 handle=0001 11 slot=0x11 12 module=ctk 13 } 14 } 15 remote { 16 auth = pubkey 17 id = \u0026#34;CN=sun.strongswan.org\u0026#34; 18 } 19 children { 20 pkcs11-demo { 21 start_action = trap 22 } 23 } 24 } 25} 26 27pools{ 28 client_pool{ 29 addrs=192.168.0.1 30 } 31} 32 33secrets{ 34# token_1{ 35# handle=0001 36# slot=0 37# module=opensc 38# pin=12345678 39# } 40 token_2{ 41 handle=0001 42 slot=0x11 43 module=ctk 44 pin=12345678 45 } 46} 47 48 49 50 51 52# /etc/swanctl/swanctl.conf 53connections { 54 pkcs11-demo{ # connection name 55 remote_addrs = 10.233.76.178 56 local { 57 auth = pubkey 58 cert1{ 59 handle=0001 60 slot=0x11 61 module=ctk 62 } 63 } 64 remote { 65 auth = pubkey 66 id = \u0026#34;CN=sgx-1\u0026#34; 67 } 68 children { 69 pkcs11-demo { 70 start_action = trap 71 } 72 } 73 } 74} 75 76 77 78secrets{ 79 token_1{ 80 handle=0001 81 slot=0x11 82 module=ctk 83 pin=12345678 84 } 85} Configure IPsec Tunnel Through ipsec.conf use different secret 1# /etc/ipsec.conf 2 3# ipsec.conf - strongSwan IPsec configuration file 4 5sudo cp caCert.pem /etc/ipsec.d/cacerts/ 6sudo cp moonKey.pem /etc/ipsec.d/private/ 7sudo cp moonCert.pem /etc/ipsec.d/certs/ 8 9conn host-host 10 left=%any 11 right=%any 12 ikelifetime=3h 13 lifetime=1h 14 margintime=9m 15 keyingtries=%forever 16 dpdaction=restart 17 dpddelay=30s 18 closeaction=restart 19 leftauth=pubkey 20 rightauth=pubkey 21 leftcert=moonCert.pem 22 leftsendcert=yes 23 rightsendcert=yes 24 rightsourceip=192.168.0.8 25 auto=start 26 leftid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 27 rightid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 28 keyexchange=ikev2 29 mark=30 30 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 31 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 32 type=tunnel 33 34 35 36conn host-host 37 left=%any 38 right=34.230.111.156 39 ikelifetime=3h 40 lifetime=1h 41 margintime=9m 42 keyingtries=%forever 43 dpdaction=restart 44 dpddelay=30s 45 closeaction=restart 46 leftauth=pubkey 47 rightauth=pubkey 48 leftcert=sCert.pem 49 leftsendcert=yes 50 rightsendcert=yes 51 rightsourceip=192.169.0.8 52 auto=start 53 leftid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 54 rightid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 55 keyexchange=ikev2 56 mark=30 57 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 58 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 59 type=tunnel 60 61 62 63conn common-con 64 left=%any 65 right=%any 66 ikelifetime=3h 67 lifetime=1h 68 margintime=9m 69 keyingtries=%forever 70 dpdaction=restart 71 dpddelay=30s 72 closeaction=restart 73 leftauth=pubkey 74 rightauth=pubkey 75 leftcert=/etc/ipsec.d/certs/root-nodeCert.pem 76 leftsendcert=yes 77 rightsendcert=yes 78 rightsourceip=192.168.0.9 79 auto=start 80 leftid=\u0026#34;CN=root-node\u0026#34; 81 rightid=\u0026#34;C=CH, O=strongSwan,CN=node-3\u0026#34; 82 keyexchange=ikev2 83 mark=30 84 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 85 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 86 type=tunnel 87 88 89 90 # client 91sudo cp caCert.pem /etc/ipsec.d/cacerts/ 92sudo cp sunKey.pem /etc/ipsec.d/private/ 93sudo cp sunCert.pem /etc/ipsec.d/certs/ 94 95conn common-con 96 left=%any 97 right=10.233.76.178 98 leftsourceip=%config 99 ikelifetime=3h 100 lifetime=1h 101 margintime=9m 102 keyingtries=%forever 103 dpdaction=restart 104 dpddelay=30s 105 closeaction=restart 106 leftauth=pubkey 107 rightauth=pubkey 108 leftcert=%smartcard:0001 109 leftsendcert=yes 110 rightsendcert=yes 111 auto=start 112 leftid=\u0026#34;CN=sgx-2\u0026#34; 113 rightid=\u0026#34;CN=sgx-1\u0026#34; 114 keyexchange=ikev2 115 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 116 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 117 type=tunnel ipsec.secrets\n1# /etc/ipsec.secrets 2C=CH, O=strongSwan,CN=sun.strongswan.org : RSA sunKey.pem 3: PIN %smartcard:0001 \u0026#34;12345678\u0026#34; 1# 1. Add strongswan.d/chron/pkcs11.conf 2 3 4# 2. This is the firsth /usr/sbin/ipsec start \u0026ndash;nofork\nIPsec protocol overview IPsec is a framework, which provide security at the network layer of the OSI model by enabling a system to select required security protocols, determine the algorithms to use for security services, and implement any cryptographic keys required to provide secure communication.\nIPsec architecture consist of:\nBasic concept:\nSecurity Association(SA)\nSecurity Association Database\nFundamental security protocols\nESP/AH Protocol mode\ntransport/tunnel Various cryptographic primitives with AH and ESP\nEncryption: DES, 3DES, AES-CBC Integrity: HMAC, MD5, SHA1, SHA2 Key management procedures\nIKEv1, IKEv2, ISAKMP Security Association(SA) is a set of IPsec specifications that are negotiated between devices that are establishing an IPsec relationship. The specifications include preferences for the type of authentication, encryption, and security protocol that should be used when establishing the IPsec connection. A single SA protects data in one direction An SA is uniquely identified by: Security Parameter Index(SPI) IPv4 or IPv6 destination address security protocol(AH or ESP) identifier Security associations are stored in a security associations database(SADB) Security Associations(SAs) require keying material for authentication and for encryption. The managing of this keying material is called key management. The Internet Key Exchange(IKE) protocol is used to exchange SAs between two devices. IKE is based on Internet Security Association and Key Management Protocol( ISAKMP) Two version of IKE are defined(IKEv1 and IKEv2), but at present IKE2 is mostly used IPsec session consists of the following phases: establishing IKE SA (IKE phase I) establishing IPsec SA (IKE phase II) secured communication(IPsec tunnel) re-keying procedures( IKE CHILD_SA) IP tunnel termination( IKE \u0026ldquo;delete\u0026rdquo;) Experiment has been performed using two virtual machines Strongswan has been used as IPsec implementation Red Machine: 192.168.56.100 === Blue Machine: 192.16.56.101\nBasic Strongswan configuration\nIPsec configuration files:\n/etc/ipsec.conf IPsec tunnel parameters /etc/ipsec.secret cryptographic secrets 1# Blue 2conn bule-to-red 3 authby=secret # authentication method 4 auto=route 5 keyexchange=ikev2 # key exchange protocol 6 ike=ase256-sha2_256-modp1024 # IKE secrity association proposal 7 left=192.168.56.101 # IP of both ends of tunnel 8 right=192.168.56.100 9 type=transport # IPsec mode(tunnel or transport) 10 esp=aes256-sha2_256 # IPsec security association proposal(ESP/ AH) 11 #ah=sha1-sha256-modp1024 12 13 14# RED 15conn red-to-blue 16 authby=secret 17 #ah=sha1-sha256-modp1024 18 auto=route 19 keyexchange=ikev2 20 ike=ase256-sha2_256-modp1024 # 3des-sha2_256-modp1024 21 left=192.168.56.100 22 right=192.168.56.101 23 type=transport 24 esp=aes256-sha2_256 1sudo ipsec stroke loglevel ike 4 2 3sudo tcpdump -i eth0 -w ike.pcap IKE and IPsec negotiation\nIKE Phase I (IKE SA negotiation) creates a secure channel between the two IKE peers. IKE SA is negotiated during phase I and the Diffie-Hellman key agreements is always performed in this phase. IKE Phase II (IPsec SA negotiation) negotiates the IPsec security associations and generates the required key material for IPsec(encryption and integrity Keys). Peers authenticate echo other is this phase. A new Diffie-Hellman agreement may be done in phase2, or the keys may be derived form the phase 1. Re-keying (IKE or IPsec) is invoked by send CREATE_CHILD_SA IKE tunnel termination is perform by sending IKE INFORMATIONAL message with payload \u0026ldquo;delete\u0026rdquo; IKE SA proposals of RED and BLUE endpoint(the same now)\n1IKE algorithmn 2 3--- RED -- 4IKE ENCR ALG: AES-CBC-256 # encryption algorithm 5IKE AUTH ALG: HMAC_SHA2_256_128 # Integrity algorithm 6IKE D-H GROUP: MODP 1024-bit # Diffie-Hellman group 7PRF: NOT CONFIGURABLE # Pseudo random function 8 9--- BLUE -- 10IKE ENCR ALG: AES-CBC-256 11IKE AUTH ALG: HMAC_SHA2_256_128 12IKE D-H GROUP: MODP 1024-bit 13PRF: NOT CONFIGURABLE Let\u0026rsquo;s change encryption algorithm proposal of RED endpoint, is the IKE algorithm not equal. BULE endpoint doesn\u0026rsquo;t accept IKE SA proposal with \u0026ldquo;3des\u0026rdquo; encryption algorithm. BULE doesn\u0026rsquo;t support such algorithm and responds with NO_PROPOSAL_CHOSEN payload. Inconsistency of encryption algorithm. Now red\u0026rsquo;s IKE SA proposal has been accepted by BLUE. Authentication process has been started.\nNote, the IPsec SA negotiation (Phase II) and authentication has been successful.\nAfter decryption using keys, we can see IKE_AUTH message payload. Shared key data is exchanged (PSK authentication is used.)\ntraffic selector\nIPsec ESP vs AH Authentication Header(AH) and Encapsulating Security Payload(ESP) are two protocols, which provide security for IPsec tunnel.\nAH provides only integrity authentication service to IPsec-capable device, so they can verify that message are received intact from other device. AH provides authentication by creating and add MACs to packets. ESP provides not only integrity authentication, but also a privacy for IP. ESP encrypt payload by ESP header and ESP trailer to each packet. IPsec Tunnel vs transport mode IPsec protocol use transport or tunnel mode.\nTransport mode can only be used between end-point of a communication Tunnel mode can be used between arbitrary peers The difference between the two modes is protocol stack construction\nTransport mode just add a security specific header Tunnel mode encapsulates IP packets IPsec with pre-shared secret Pre-Shared Key(PSK) IKEv2 authentication uses pre-shared secrets stored in host\u0026rsquo;s memory. Secret\u0026rsquo;s sharing is out of IPsec\u0026rsquo;s scope.\nThe shared key is exchanged during IPsec SA negotiation and used by peers to authenticate each other.\nThe easiest, but not recommended type of authentication\npre-shared secret is configured in ipsec.secrets file.\n1 # authty=secret 2192.145.66.100 192.145.66.101 :PSK \u0026#34;123\u0026#34; IPsec with CA certificates (PKI) Public Key authentication is based on Public Key Infrastructure(PKI) architecture\nAn individual that wishes to send encrypted data obtains a digital certificate form a Certificate Authority(CA). CA\u0026rsquo;s certificate contains a public key Both peers need to generate self-certificates, which can be self-signed, in which case they have to installed on peers, or signed by a common Certificate Authority(CA) The latter simplifies deployment and configuration a lot as the gateway only needs the CA certificate. IKEv2 uses:\nCERTREQ payload contains information of supported by peer CAs CERT payload contains peer\u0026rsquo;s certificate signed by CA During IKE AUTH exchange peers authenticate each other. In SA_INIT response responder sends CERTREQ payload. Then initiator send its certificate in CERT with its identity(IDi). Responder uses public key from CA certificate to authenticate initiator. In the last message responder sends its certificate (CERT) with its identity(IDr). Now, responder is authenticated by initiator(if certificate is authorized by the same CA)\nPublic Key authentication- RSA authentication with X.509 certificate\nCA certificate and private key need to delivered to each IPsec peer.\n1# Blue 2conn bule-to-red 3 # authby=secret # authentication method 4 left=192.168.56.101 # IP of both ends of tunnel 5 right=192.168.56.100 6 ike=ase256-sha2_256-modp1024 # IKE secrity association proposal 7 esp=aes256-sha2_256 # IPsec security association proposal(ESP/ AH) 8 auto=start 9 keyexchange=ikev2 # key exchange protocol 10 type=tunnel # IPsec mode(tunnel or transport) 11 leftcert=client1Cert.pem 12 leftid=\u0026#34;C=CH,O=strongSwan,CN=device1\u0026#34; 13 rightid=\u0026#34;C=CH,O=strongSwan,CN=device2\u0026#34; 14 15 #ah=sha1-sha256-modp1024 16 17 18# RED 19conn red-to-blue 20 # authby=secret # authentication method 21 left=192.168.56.101 # IP of both ends of tunnel 22 right=192.168.56.100 23 ike=ase256-sha2_256-modp1024 # IKE secrity association proposal 24 esp=aes256-sha2_256 # IPsec security association proposal(ESP/ AH) 25 auto=start 26 keyexchange=ikev2 # key exchange protocol 27 type=tunnel # IPsec mode(tunnel or transport) 28 leftcert=client2Cert.pem 29 leftid=\u0026#34;C=CH,O=strongSwan,CN=device2\u0026#34; 30 rightid=\u0026#34;C=CH,O=strongSwan,CN=device\u0026#34; 1# ipsec.secret RSA private key location is configured in ipsec.secrets 2: RAS client1key.pem Create IPsec Tunnel on AWS Running CNF through docker in host network mode\n1docker run --rm -i -d --network host --name cnf --user root -v /home/ubuntu/entrypoint.sh:/entrypoint.sh --privileged cnf:pro bash -c \u0026#39;/entrypoint.sh\u0026#39; NAT mode\n1docker run --rm -i -d -p 5:q 2jjikk00:500/udp -p 4500:4500/udp --name cnf-1 --user root -v /home/ubuntu/entrypoint.sh:/entrypoint.sh --privileged cnf:pro bash -c \u0026#39;/entrypoint.sh\u0026#39; 3 4netstat -atunlp rrr\n1# sun add DNAT 2 3sudo iptables -D PREROUTING --destination 10.20.0.118/32 -p esp -j DNAT --to-destination 172.17.0.3 -t nat 4sudo iptables -D PREROUTING --destination 10.20.0.118/32 -p udp --dport 4500 -j DNAT --to-destination 172.17.0.3:4500 -t nat 5sudo iptables -D PREROUTING --destination 10.20.0.118/32 -p udp --dport 500 -j DNAT --to-destination 172.17.0.3:500 -t nat 6 7 8 9# moon add DNAT 10sudo iptables -D PREROUTING --destination 172.16.182.193/32 -p esp -j DNAT --to-destination 172.17.0.2 -t nat 11sudo iptables -D PREROUTING --destination 172.16.182.193/32 -p udp --dport 4500 -j DNAT --to-destination 172.17.0.2:4500 -t nat 12sudo iptables -D PREROUTING --destination 172.16.182.193/32 -p udp --dport 500 -j DNAT --to-destination 172.17.0.2:500 -t nat 13 14192.169.0.4/32 === 172.17.0.2/32 15iptables -I POSTROUTING -d 172.17.0.2/32 -j SNAT --to-source 192.169.0.4 -t nat 1# sun add DNAT 2 3sudo iptables -I PREROUTING --destination 10.95.62.171/32 -p esp -j DNAT --to-destination 10.233.83.75 -t nat 4sudo iptables -I PREROUTING --destination 10.95.62.171/32 -p udp --dport 4500 -j DNAT --to-destination 10.233.83.75:4500 -t nat 5sudo iptables -I PREROUTING --destination 10.95.62.171/32 -p udp --dport 500 -j DNAT --to-destination 10.233.83.75:500 -t nat 6 7 8 9# moon add DNAT 10sudo iptables -I PREROUTING --destination 10.95.62.90/32 -p esp -j DNAT --to-destination 10.233.120.76 -t nat 11sudo iptables -I PREROUTING --destination 10.95.62.90/32 -p udp --dport 4500 -j DNAT --to-destination 10.233.120.76:4500 -t nat 12sudo iptables -I PREROUTING --destination 10.95.62.90/32 -p udp --dport 500 -j DNAT --to-destination 10.233.120.76:500 -t nat Add AppArmor security Rules 1# Add to /etc/apparmor.d/usr.lib.ipsec.charon 2# /usr/lib/ipsec/charon flags=(attach_disconnected) { 3 4 /tmp/ipsec/** r, 5 /tmp/run/** rw, 6 /tmp/ipsec/strongswan.conf rwk, 7 /tmp/ipsec/ipsec.secrets rwk, 8 /tmp/run/charon.ctl rwk, 9 /tmp/run/charon.pid rwk, 10 /bin/busybox rmPUx, 11# } 12# Add to /etc/apparmor.d/usr.lib.ipsec.stroke 13 /tmp/ipsec/strongswan.conf r, 14 /tmp/run/charon.ctl wr, Site-to-Site Mode In site to site mode need to add IP rule on the host, post the traffic through the VTI interface\nAdd IP Rule\n1# sun node 2ip route add default dev vti_52.9.61.247 table 40 3ip rule add to 172.16.182.193 lookup 40 4 5# moon node 6ip r add default dev vti_34.230 table 50 7ip rule add to 10.20.0.118 lookup 50 ipsec.conf\n1# sun node 2conn hubaedge1-Connedge1_19216904 3 left=%any 4 leftsubnet=0.0.0.0/0 5 right=%any 6 rightsubnet=0.0.0.0/0 7 ikelifetime=3h 8 lifetime=1h 9 margintime=9m 10 keyingtries=%forever 11 dpdaction=restart 12 dpddelay=30s 13 leftauth=pubkey 14 rightauth=pubkey 15 leftcert=/etc/ipsec.d/certs/sunCert.pem 16 leftsendcert=yes 17 rightsendcert=yes 18 auto=start 19 # leftid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 20 rightid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 21 leftupdown=/etc/updown 22 keyexchange=ikev2 23 mark=30 24 esp=aes256-sha256-modp4096,aes256-sha256-modp4096 25 ike=aes256-sha256-modp4096,aes256-sha256-modp4096 26 type=tunnel 27 28 29# moon node 30conn edge1huba-Connhuba_10107039 31 left=%any 32 leftsubnet=0.0.0.0/0 33 right= 34.230.111.156 34 rightsubnet=0.0.0.0/0 35 ikelifetime=3h 36 lifetime=1h 37 margintime=9m 38 keyingtries=%forever 39 dpdaction=restart 40 dpddelay=30s 41 leftauth=pubkey 42 rightauth=pubkey 43 leftcert=/etc/ipsec.d/certs/moonCert.pem 44 leftsendcert=yes 45 rightsendcert=yes 46 auto=start 47 # leftid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 48 rightid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 49 leftupdown=/etc/updown # need to bind with a mark 50 mark=30 51 keyexchange=ikev2 52 esp=aes256-sha256-modp4096,aes256-sha256-modp4096 53 ike=aes256-sha256-modp4096,aes256-sha256-modp4096 54 type=tunnel Site-to-Host Mode Add SNAT on Client\n1# moon node 2iptables -I POSTROUTING -d 10.20.0.118/32 -j SNAT --to-source 192.169.0.4 -t nat 3iptables -I POSTROUTING -d 10.233.83.75/32 -j SNAT --to-source 192.168.0.1 -t nat ipsec.conf\n1# sun node 2conn hubaedge1-Connedge1_19216904 3 left=%any 4 right=%any 5 leftsubnet=10.20.0.118/32 6 rightsubnet=192.169.0.4/32 7 ikelifetime=3h 8 lifetime=1h 9 margintime=9m 10 keyingtries=%forever 11 dpdaction=restart 12 dpddelay=30s 13 leftauth=pubkey 14 rightauth=pubkey 15 leftcert=/etc/ipsec.d/certs/sunCert.pem 16 leftsendcert=yes 17 rightsendcert=yes 18 rightsourceip=192.169.0.4 19 auto=start 20 #leftid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 21 rightid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 22 leftupdown=/etc/updown 23 keyexchange=ikev2 24 mark=30 25 esp=aes256-sha256-modp4096,aes256-sha256-modp4096 26 ike=aes256-sha256-modp4096,aes256-sha256-modp4096 27 type=tunnel 28 29# moon 30conn edge1huba-Connhuba_10107039 31 left=%any 32 leftsourceip=%config 33 right= 34.230.111.156 34 rightsubnet=10.20.0.118/32 35 ikelifetime=3h 36 lifetime=1h 37 margintime=9m 38 keyingtries=%forever 39 dpdaction=restart 40 dpddelay=30s 41 leftauth=pubkey 42 rightauth=pubkey 43 leftcert=/etc/ipsec.d/certs/moonCert.pem 44 leftsendcert=yes 45 rightsendcert=yes 46 auto=start 47 # leftid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 48 rightid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 49 leftupdown=/etc/updown_oip 50 keyexchange=ikev2 51 esp=aes256-sha256-modp4096,aes256-sha256-modp4096 52 ike=aes256-sha256-modp4096,aes256-sha256-modp4096 53 type=tunnel Todo Apparmor\nVTI bind with mark and ip xfrm check the startus\nHi, Huifeng, I think we can con\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/2_strongswan/","summary":"When reading/adjusting any StrongSwan configurations, remember these important words:\nleft is local to the machine it\u0026rsquo;s stated on; right is remote in the same manner\nSo, on the server side, left is local to the server and on the client side, left is local to that client.\ncheck the X509 cert details\n1openssl x509 -text -noout -in /etc/ipsec.d/private/sunKey.pem â€‹\nUbuntu Set up IPsec Tunnel 1docker run --rm -d -i --network host --name cnf --user root -v /home/ubuntu/entrypoint.","tags":null,"title":"strongswan"},{"categories":null,"contents":" Download the material\n1wget -r -N -nd http://sdewan.sh.intel.com:8888/ipsec-demo/ modify the node selector in cnf-1.yaml and cnf-2.yaml respectively. Create 2 pod on different node with host network.\n1 nodeSelector: 2 # change to the specific node 3 kubernetes.io/hostname: node Copy cert to the CNF Pod.\nFind the container id for cnf-1 and cnf-2.\n1# For cnf-1, copy sunCert to it 2docker cp ./cert/caCert.pem $(kubectl describe po cnf-1|grep docker:|awk -F / \u0026#39;{print $3}\u0026#39;):/etc/ipsec.d/cacerts 3docker cp ./cert/sunCert.pem $(kubectl describe po cnf-1|grep docker:|awk -F / \u0026#39;{print $3}\u0026#39;):/etc/ipsec.d/certs 4docker cp ./cert/sunKey.pem $(kubectl describe po cnf-1|grep docker:|awk -F / \u0026#39;{print $3}\u0026#39;):/etc/ipsec.d/private 5# For node-2, copy moonCert to it 6 7docker cp ./cert/caCert.pem $(kubectl describe po cnf-2|grep docker:|awk -F / \u0026#39;{print $3}\u0026#39;):/etc/ipsec.d/cacerts 8docker cp ./cert/moonCert.pem $(kubectl describe po cnf-2|grep docker:|awk -F / \u0026#39;{print $3}\u0026#39;):/etc/ipsec.d/certs 9docker cp ./cert/moonKey.pem $(kubectl describe po cnf-2|grep docker:|awk -F / \u0026#39;{print $3}\u0026#39;):/etc/ipsec.d/private start service in container in cnf-1 and cnf -2 1 /sbin/procd \u0026amp; 2 /sbin/ubusd \u0026amp; 3 sh /etc/init.d/log start 4 sh /etc/init.d/ipsec start Edit /var/ipsec/ipsec.secrets in cnf-1 and cnf -2\n1 2# For cnf-1 3echo \u0026#39; : RSA /etc/ipsec.d/private/sunKey.pem\u0026#39; \u0026gt; /var/ipsec/ipsec.secrets 4# For cnf-2 5echo \u0026#39; : RSA /etc/ipsec.d/private/moonKey.pem\u0026#39; \u0026gt; /var/ipsec/ipsec.secrets edit /var/ipsec/ipsec.conf in cnf-1 and cnf -2\n1# For server side, cnf-1 2conn connection-11 3 left=%any 4 right=%any 5 rightsubnet=192.168.9.134/32 6 ikelifetime=3h 7 lifetime=1h 8 margintime=9m 9 keyingtries=%forever 10 dpdaction=restart 11 dpddelay=30s 12 closeaction=restart 13 leftauth=pubkey 14 rightauth=pubkey 15 leftcert=/etc/ipsec.d/certs/sunCert.pem 16 leftsendcert=yes 17 rightsendcert=yes 18 # rightsourceip=192.169.0.1 19 auto=start 20 leftid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 21 rightid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 22 leftupdown=/etc/updown 23 keyexchange=ikev2 24 mark=30 25 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 26 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 27 type=tunnel 28 29 30# For client side, cnf-2 31conn connection12 32 left=%any 33 right=61.240.163.206 34 rightsubnet=61.240.163.206/32 35 # leftsourceip=%config 36 ikelifetime=3h 37 lifetime=1h 38 margintime=9m 39 keyingtries=%forever 40 dpdaction=restart 41 dpddelay=30s 42 closeaction=restart 43 leftauth=pubkey 44 rightauth=pubkey 45 leftcert=/etc/ipsec.d/certs/moonCert.pem 46 leftsendcert=yes 47 rightsendcert=yes 48 auto=start 49 leftid=\u0026#34;C=CH, O=strongSwan, CN=moon.strongswan.org\u0026#34; 50 rightid=\u0026#34;C=CH, O=strongSwan, CN=sun.strongswan.org\u0026#34; 51 leftupdown=/usr/lib/ipsec/_updown iptables 52 keyexchange=ikev2 53 esp=aes128-sha256-modp3072,aes256-sha256-modp3072 54 ike=aes128-sha256-modp3072,aes256-sha256-modp3072 55 type=tunnel run sude ipsec start in the container to start the ipsec tunnel.\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/2_strongwan_NAT_travalse/","summary":"Download the material\n1wget -r -N -nd http://sdewan.sh.intel.com:8888/ipsec-demo/ modify the node selector in cnf-1.yaml and cnf-2.yaml respectively. Create 2 pod on different node with host network.\n1 nodeSelector: 2 # change to the specific node 3 kubernetes.io/hostname: node Copy cert to the CNF Pod.\nFind the container id for cnf-1 and cnf-2.\n1# For cnf-1, copy sunCert to it 2docker cp ./cert/caCert.pem $(kubectl describe po cnf-1|grep docker:|awk -F / \u0026#39;{print $3}\u0026#39;):/etc/ipsec.","tags":null,"title":"StrongWAN configure with CNF."},{"categories":null,"contents":"CNCN é¡¹ç›®çš„å‡ ä¸ªé˜¶æ®µ\nLibos\nNIO BIO\nDMAæ˜¯ä»€ä¹ˆ\nsr-iov\nebpf\novs\ncilium\ncalico flannel\nipsec GRE\nä¸¤ä¸ªæ–¹å‘ï¼Œä¸€ä¸ªæ˜¯å­˜å‚¨ï¼Œä¸€ä¸ªæ˜¯ç½‘ç»œ\n1ã€æœ‰dpdkã€ebpfã€ovsã€lvsã€nginxã€hyperplaneç­‰ç³»ç»Ÿç ”å‘ç»éªŒï¼› 2ã€æœ‰æ™ºèƒ½ç½‘å¡ã€ç¡¬ä»¶å¸è½½ã€P4ç­‰é«˜æ€§èƒ½ç½‘ç»œç ”å‘ç»éªŒï¼› 3ã€æœ‰VPCã€NATã€è´Ÿè½½å‡è¡¡ç­‰äº‘ç½‘ç»œäº§å“ç ”å‘ç»éªŒã€‚\nGRE/VxLAN/OpenFlowç­‰åè®®ï¼›\nESXI8.0 license: 4V492-44210-48830-931GK-2PRJ4\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/ToDo/","summary":"CNCN é¡¹ç›®çš„å‡ ä¸ªé˜¶æ®µ\nLibos\nNIO BIO\nDMAæ˜¯ä»€ä¹ˆ\nsr-iov\nebpf\novs\ncilium\ncalico flannel\nipsec GRE\nä¸¤ä¸ªæ–¹å‘ï¼Œä¸€ä¸ªæ˜¯å­˜å‚¨ï¼Œä¸€ä¸ªæ˜¯ç½‘ç»œ\n1ã€æœ‰dpdkã€ebpfã€ovsã€lvsã€nginxã€hyperplaneç­‰ç³»ç»Ÿç ”å‘ç»éªŒï¼› 2ã€æœ‰æ™ºèƒ½ç½‘å¡ã€ç¡¬ä»¶å¸è½½ã€P4ç­‰é«˜æ€§èƒ½ç½‘ç»œç ”å‘ç»éªŒï¼› 3ã€æœ‰VPCã€NATã€è´Ÿè½½å‡è¡¡ç­‰äº‘ç½‘ç»œäº§å“ç ”å‘ç»éªŒã€‚\nGRE/VxLAN/OpenFlowç­‰åè®®ï¼›\nESXI8.0 license: 4V492-44210-48830-931GK-2PRJ4","tags":null,"title":"ToDoList"},{"categories":null,"contents":"Sidecar category update Image URL Update Variable\nsite å¼€å¤´çš„å˜é‡\n{{ if site.IsMultiLingual }}\nSection Menu for Lazy Bloggers To enable this menu, configure sectionPagesMenu in your site config:\n1sectionPagesMenu = \u0026#34;main\u0026#34; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/hugo_toha_update/","summary":"Sidecar category update Image URL Update Variable\nsite å¼€å¤´çš„å˜é‡\n{{ if site.IsMultiLingual }}\nSection Menu for Lazy Bloggers To enable this menu, configure sectionPagesMenu in your site config:\n1sectionPagesMenu = \u0026#34;main\u0026#34; ","tags":null,"title":"toha theme update"},{"categories":null,"contents":"Tools 1apt install vim git tmux golang Vim 1# ~/.vimrc 2cat \u0026lt;\u0026lt;EOF | tee -a ~/.vimrc 3set nu 4syntax on 5inoremap jj \u0026lt;ESC\u0026gt; 6 7 8set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936 9set termencoding=utf-8 10set encoding=utf-8 11 12\u0026#34; show existing tab with 4 spaces width 13set tabstop=4 14\u0026#34; when indenting with \u0026#39;\u0026gt;\u0026#39;, use 4 spaces width 15set shiftwidth=4 16\u0026#34; On pressing tab, insert 4 spaces 17set expandtab 18 19EOF oh my zsh 1sudo apt install -y zsh 2sh -c \u0026#34;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)\u0026#34; 3 4# sudo chsh -s $(which zsh) Golang 1sudo apt install golang 2 3echo \u0026#39; 4GOPATH=~/go 5GOBIN=$GOPATH/bin 6PATH=$PATH:$GOBIN 7\u0026#39;| tee -a ~/.bashrc Proxy 1echo \u0026#39;function proxy_on() { 2 export no_proxy=\u0026#34;localhost,127.0.0.1/8,arch,.localdomain.com,10.239.154.51/16\u0026#34; 3 4 local proxy=\u0026#34;http://child-prc.intel.com:913\u0026#34; 5 export http_proxy=\u0026#34;$proxy\u0026#34; \\ 6 https_proxy=$proxy \\ 7 all_proxy=$proxy \\ 8 ftp_proxy=$proxy \\ 9 rsync_proxy=$proxy \\ 10 HTTP_PROXY=$proxy \\ 11 HTTPS_PROXY=$proxy \\ 12 FTP_PROXY=$proxy \\ 13 RSYNC_PROXY=$proxy 14} 15 16function proxy_off(){ 17 unset http_proxy https_proxy all_proxy ftp_proxy rsync_proxy \\ 18 HTTP_PROXY HTTPS_PROXY FTP_PROXY RSYNC_PROXY no_proxy 19 echo -e \u0026#34;Proxy environment variable removed.\u0026#34; 20} 21 22proxy_on\u0026#39; | tee -a ~/.zshrc 23 24EOF 25 26# Install zsh 27cat \u0026lt;\u0026lt;EOF | sudo tee /etc/apt/apt.conf.d/proxy.conf 28Acquire::http::Proxy \u0026#34;http://child-prc.intel.com:913\u0026#34;; 29Acquire::https::Proxy \u0026#34;http://child-prc.intel.com:913\u0026#34;; 30EOF Font hack\nSet timezone\n1timedatectl set-timezone Asia/Shanghai 2 3sudo date -s \u0026#34;$(curl -H\u0026#39;Cache-Control:no-cache\u0026#39; -sI google.com | grep \u0026#39;^Date:\u0026#39; | cut -d\u0026#39; \u0026#39; -f3-6)Z\u0026#34; Add new User 1sudo adduser hairong 2sudo usermod -aG sudo hairong 3 4sudo vi /etc/group Wait for network\n1network: 2 version: 2 3 wifis: 4 wlp3s0: 5 access-points: 6 HoneyHouse_5.0G: 7 password: 1q2w3e4r%T 8 dhcp4: true 9 optional: true 1sudo netplan generate 2 3sudo netplan apply Ubuntu Alisa ä»Šå¤©åœ¨Build Docker imageçš„æ—¶å€™å‘ç°sgx-sdk-demoçš„base imagesæ˜¯ubuntu:bionic, ç„¶åè®¾ç½®çš„apt source list ä¹Ÿæ˜¯\u0026quot;....intel-sgx/sgx_repo/ubuntu focal main\u0026quot;ã€‚åŒæ—¶ docker image ubunt:18.04 å’Œ ubuntu:bionic çš„Image ID æ˜¯å®Œå…¨ç›¸åŒçš„ï¼ŒçŒœæµ‹ bionic åº”è¯¥æ˜¯ ubuntu:18.04 çš„åˆ«åã€‚äºæ˜¯æŸ¥äº†Ubuntu çš„release Note æœçœŸå¦‚æ­¤ã€‚\nupdate ubuntu linux kernel 1apt-cache search linux-image 2sudo apt-get install linux-image-your_version_choice linux-headers-your_version_choice linux-image-extra-your_version_choice 3 4# must reboot you machine 5# https://linuxhint.com/update_ubuntu_kernel_20_04/ 6# https://packages.ubuntu.com/focal-updates/kernel/ flux add proxy!!!! è£…çš„æ—¶å€™æ‰‹åŠ¨ä¿®æ”¹env 1git config --global --add http.proxy http://proxy-prc.intel.com:913 2git config --global --add https.proxy http://proxy-prc.intel.com:913 3 4 5 6export http_proxy=http://proxy-prc.intel.com:913 7export https_proxy=http://proxy-prc.intel.com:913 kubectl autocomplete ssh set proxy 1# Host github.com 2# Hostname ssh.github.com 3# # ProxyCommand nc -X connect -x child-prc.intel.com:914 %h %p 4# # # ProxyCommand connect -H child-prc.intel.com:914 %h %p 5# Port 443 6# # ServerAliveInterval 20 7# # User git 8# Host github.com 9# IdentityFile ~/.ssh/id_rsa 10# ProxyCommand nc -x child-prc.intel.com:1080 %h %p 11 12 13# ProxyCommand connect -S proxy-prc.intel.com:1080 %h %p 14Host node-2 15 HostName 124.223.99.93 16 Port 3302 17 User airren 18 ProxyCommand connect -S proxy-prc.intel.com:1080 %h %p 19 # ProxyJump proxy-prc.intel.com:1080 20 21Host sdewan-sgx.sh.intel.com 22 HostName sdewan-sgx.sh.intel.com 23 User airren 24 25Host airrens-mini.sh.intel.com 26 HostName airrens-mini.sh.intel.com 27 User airren 28 29Host sdewan.sh.intel.com 30 HostName sdewan.sh.intel.com 31 User ubuntu 32 33Host 10.239.154.53 34 HostName 10.239.154.53 35 User airren Docker utils 1HOSTNAME=chrome 2VNC_SCREEN_SIZE=1920x1080 3 4 docker run -d -p 5900:5900 --name chrome \\ 5 -e VNC_SCREEN_SIZE=1920x1080 -e HOSTNAME=chrome\\ 6 siomiz/chrome ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/Linux_init/","summary":"Tools 1apt install vim git tmux golang Vim 1# ~/.vimrc 2cat \u0026lt;\u0026lt;EOF | tee -a ~/.vimrc 3set nu 4syntax on 5inoremap jj \u0026lt;ESC\u0026gt; 6 7 8set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936 9set termencoding=utf-8 10set encoding=utf-8 11 12\u0026#34; show existing tab with 4 spaces width 13set tabstop=4 14\u0026#34; when indenting with \u0026#39;\u0026gt;\u0026#39;, use 4 spaces width 15set shiftwidth=4 16\u0026#34; On pressing tab, insert 4 spaces 17set expandtab 18 19EOF oh my zsh 1sudo apt install -y zsh 2sh -c \u0026#34;$(wget https://raw.","tags":null,"title":"Unix Init"},{"categories":null,"contents":"Develop Environment Kind kind is a tool for running local Kubernetes clusters using Docker container \u0026ldquo;nodes\u0026rdquo;. kind was primarily designed for testing Kubernetes itself but may be used for local development or CI.\n1kind load docker-image --name \u0026lt;kind-cluster-name\u0026gt; --nodes \u0026lt;node-name\u0026gt; \u0026lt;image-name\u0026gt;:latest Certmangaer 1helm repo add jetstack https://charts.jetstack.io 2helm repo update 3helm install \\ 4 cert-manager jetstack/cert-manager \\ 5 --namespace cert-manager \\ 6 --create-namespace \\ 7 --version v1.10.1 \\ 8 --set installCRDs=true Question\nK8s çš„manifest æ˜¯å¦‚ä½•ç”Ÿæˆçš„ ä»£ç çš„æ¶æ„ controller-gençš„ä½œç”¨ï¼Œå¦‚ä½•æ ¹æ®å¯¹åº”çš„tagç”Ÿæˆ k8smanifest clientgo ä¸­çš„client set GVKå’ŒGVR æ¯ä¸€ä¸ªcontroller æ˜¯å¦‚ä½•æ³¨å†Œåˆ°ä¸»ç¨‹åºä¸­çš„ å¸¸ç”¨çš„ä¾èµ–ï¼Œcoreï¼Ÿ controller runtime åº”ç”¨éƒ¨ç½²çš„æ—¶å€™ï¼Œé¦–å…ˆåˆ›å»ºcrdèµ„æºä»¥åŠrole æƒé™ï¼Œç„¶åéƒ¨ç½²åº”ç”¨ k8s finalizaer\nReconcile å‡½æ•°ä»€ä¹ˆæ—¶å€™å›è¢«è°ƒç”¨åˆ°ï¼Œ Reconcileå‡½æ•°çš„è¿”å›å€¼ä¸­å¦‚æœå«æœ‰errå¦‚ä½•å¤„ç†ï¼Œerr ä¸ºnilçš„æ—¶å€™å¦‚ä½•å¤„ç† Renconcile Result ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦requeueï¼Œ Yaml ä¸­çš„apiVersion\npod\ndeployment\nCodeä¸­çš„struct defination\nk8s.io/apimachinery/pkg/apis/meta/v1 ResourceList\nUnstructured golang çš„type assert\nScheme: resource register æ–°å¢ä¸€ä¸ªcrdçš„æ—¶å€™éœ€è¦æ³¨å†Œåˆ°scheme\nUnversionedType: metav1.Status, metav1.APIVersions, metav1.APIGroupList, metav1.APIGroup, metav1.APIResourceList\nKnownType: Pod\nAddKnowTypesï¼Ÿ or Add UnversionedTypes\n1// k8s.io/apimachniery/pkg/runtime/scheme.go 2type Scheme struct { 3\t// gvkToType allows one to figure out the go type of an object with 4\t// the given version and name. 5\tgvkToType map[schema.GroupVersionKind]reflect.Type 6 7\t// typeToGVK allows one to find metadata for a given go object. 8\t// The reflect.Type we index by should *not* be a pointer. 9\ttypeToGVK map[reflect.Type][]schema.GroupVersionKind 10 //.... 11} Codec Serializer:\nCodec: Serializer is one kind of Codec\nWhat is protobuf, wirte a demo\nConverter: resource Version convert Kubectl 1kubectl run pod --image=nginx:latest # create one or more pod 2 3kubectl expose 4 5 6kubectl rolling-update # uses replication controller roll update 7 8kubectl cluster-info 9kubectl top Cobra Informer machanism WorkQueue Golangçš„ä¼˜é›…é€€å‡º\nK8s ä»£ç ç”Ÿæˆå™¨ tags\nPackage Tag Type Tag 1//+k8s:deepcopy-gen=package 2//+groupName=example.com 3 4// Local Tag 5// +genclient ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_dev_1_env/","summary":"Develop Environment Kind kind is a tool for running local Kubernetes clusters using Docker container \u0026ldquo;nodes\u0026rdquo;. kind was primarily designed for testing Kubernetes itself but may be used for local development or CI.\n1kind load docker-image --name \u0026lt;kind-cluster-name\u0026gt; --nodes \u0026lt;node-name\u0026gt; \u0026lt;image-name\u0026gt;:latest Certmangaer 1helm repo add jetstack https://charts.jetstack.io 2helm repo update 3helm install \\ 4 cert-manager jetstack/cert-manager \\ 5 --namespace cert-manager \\ 6 --create-namespace \\ 7 --version v1.10.1 \\ 8 --set installCRDs=true Question","tags":null,"title":"User Kuberbuilder to create a CRD operator"},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_VPC/","summary":"","tags":null,"title":"VPC"},{"categories":null,"contents":"In our day-to-day life, we have seen LAN and WAN architectures mostly because we have to deal with only one IP address on one interface. We either connect our system with LAN cable or with WiFi.\nIn this article, we will discuss the VLAN and how to create the VLAN on the Ubuntu server, but let first understand what is VLAN and why we use VLAN.\nWhat is VLAN Virtual Local Area Network(VLAN) is a logical concept of breaking large broadcast domains into small domains. The VLAN protocol is based on IEEE802.1Q. VLAN can be considered as a subnet. Two different subnets cannot communicate with each other without a bridge or router.\nThe above image is an example showing how the network can be divided in the office. There is a clear separation of the department network which is done by separating through VLANs.\nThere are many advantages of using VLAN in our network architecture mentioned the following:\nLogically divide the broadcast domain which reduce the size of the domains. Add additional layer of security. Make device management easier. QoS or other network policies are easy to implement. Also make network scalable. VLAN installation With the background knowledge out of the way, It\u0026rsquo;s time to get your hand dirty with configuration.\nFirst, ensure that the 802.1Q kernel module is loaded. In practice, this module is automatically loaded if you configure a VLAN subinterface. However, I\u0026rsquo;ll manually enable it for the sake of demonstration:\n1# check the 8021q stauts 2ubuntu@node-1:~$ lsmod | grep 8021q 3 4# enable 8021q 5ubuntu@node-1:~$ sudo modprobe 8021q 6 7ubuntu@node-1:~$ lsmod |grep 8021q 88021q 32768 0 9garp 16384 1 8021q 10mrp 20480 1 8021q Verify that module is loaded by using the following command:\n1modinfo 8021q We will first add a VLAN interface definition, ens3.100 for ens3 on PVID 100.\n1sudo ip link add link ens3 name ens3.100 type vlan id 100 Use ip link command to check does above command has add the VLAN interface.\nAnd then, configure the network settings for the VLAN interface, add a IP address to it.\n1ip addr add 192.168.100.1/24 dev ens3.100 Use ip addr command to verify the VLAN interface configuration.\nBring up the VLAN interface\n1ip link set ens3.100 up If you subsequently need to delete the interface, use the following command to bring it down and remove the definition\n1ip link set ens3.100 down 2ip link delete ens3.100 This configuration is not permanent, for permanent configuration use Netplan.\nConfigure VLAN with Netplan Netplan related configuration files can be found in the /etc/netplan directory. /etc/netplan directory has multiple YAML files. In our Ubuntu20.04 server the YAML file which is responsible for network configuration is names as 50-cloud-init.yaml. The network configuration file\u0026rsquo;s name maybe different in some setups.\nTo assign a static IP address on the network interface. Configuration file look like shown in below mentioned.\n1network: 2 ethernets: 3 ens3: 4 dhcp4: true 5 match: 6 macaddress: 52:54:00:68:b2:b6 7 set-name: ens3 8 vlans: 9 ens3.100: 10 id: 100 11 link: ens3 12 addresses: [192.169.100.1/24] Once done, save the file and apply the changes by running the following command:\n1sudo netplan apply ifconfig: net-tools; configuration file\u0026rsquo;s path /etc/network/interfaces\nip: iproute2\nCatch the Traffic Do the same thing on another node \u0026ndash; node-2, but specify the IP to 192.169.100.2.\nNow, we have two machines:\nNode-1 ens3.100 192.169.100.1 Node-2 ens3.100 192.169.100.2 While we ping Node-2 on Node-1 through the VLAN ip, use tcpdump to catch the traffic.\nCreate a Virtual Network Interface A virtual interface is a network interface, that mimic a physical interface. With the help of the virtual interface creating virtual machines or containers are possible.\nAdd a virtual interface is a very simple and straight task. This can be done with ip command and with some arguments. In the below-mentioned command, I have added an interface with the name vr-br.\nUse the following command to add a nonpersistent interface. In the following command dummy is the kernel module.\n1sudo ip link add name \u0026lt;virtual_interface_name\u0026gt; type dummy Example of the above command and its verification is shown in the following code section.\nYou can then play with this Interface and you can also assign IP address to this interface. This type of assignment is not persistent, which means after a reboot of you machine you won\u0026rsquo;t find a network interface.\nSummary In this article, we learned about the VLAN and how to configure the VLAN in Ubuntu20.04. We discussed two different strategies to configure the VLAN in Ubuntu.\nIf you face any issue don\u0026rsquo;t hesitate to comment.\nReference https://foofunc.com/how-to-configure-vlan-network-in-ubuntu/\nhttps://foofunc.com/how-to-create-a-virtual-network-interface-in-ubuntu-20-04/\nhttps://www.redhat.com/sysadmin/vlans-configuration\nhttps://www.redhat.com/sysadmin/vlans-sysadmins-basics\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_VLAN/","summary":"In our day-to-day life, we have seen LAN and WAN architectures mostly because we have to deal with only one IP address on one interface. We either connect our system with LAN cable or with WiFi.\nIn this article, we will discuss the VLAN and how to create the VLAN on the Ubuntu server, but let first understand what is VLAN and why we use VLAN.\nWhat is VLAN Virtual Local Area Network(VLAN) is a logical concept of breaking large broadcast domains into small domains.","tags":null,"title":"What is VLAN and Virtual Network Interface"},{"categories":null,"contents":"","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/linux/network_VXLAN/","summary":"","tags":null,"title":"What is VXLAN"},{"categories":null,"contents":"1. é¡ºåºä¼ å‚ å‚æ•°å ä½œç”¨ $0 filename $1/$2/$3 \u0026hellip;.$n ç¬¬nä¸ªå‚æ•° 2. OPT åªèƒ½ç”¨å•ä¸ªå­—æ¯\n1#!/bin/bash 2 3while getopts \u0026#34;:n:a:h\u0026#34; optname; do 4\tcase \u0026#34;$optname\u0026#34; in 5\t\u0026#34;n\u0026#34;) 6\techo \u0026#34;get option -name, value is $OPTARG\u0026#34; 7\t;; 8\t\u0026#34;a\u0026#34;) 9\techo \u0026#34;get option -age, value is $OPTARG\u0026#34; 10\t;; 11\t\u0026#34;h\u0026#34;) 12\techo \u0026#39; 13\t-n name of user 14\t-a age of user 15\t\u0026#39; 16\t;; 17\t\u0026#34;:\u0026#34;) 18\techo \u0026#34;No argument value for option $OPTARG\u0026#34; 19\t;; 20K\t\u0026#34;?\u0026#34;) 21\techo \u0026#34;Unknow options $OPTARG\u0026#34; 22\t;; 23\t*) 24\techo \u0026#34;Unknow error while processing options\u0026#34; 25\t;; 26\tesac 27\techo \u0026#34;option index is $OPTIND\u0026#34; 28done 29 30echo \u0026#34;done\u0026#34; j j\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92/","summary":"1. é¡ºåºä¼ å‚ å‚æ•°å ä½œç”¨ $0 filename $1/$2/$3 \u0026hellip;.$n ç¬¬nä¸ªå‚æ•° 2. OPT åªèƒ½ç”¨å•ä¸ªå­—æ¯\n1#!/bin/bash 2 3while getopts \u0026#34;:n:a:h\u0026#34; optname; do 4\tcase \u0026#34;$optname\u0026#34; in 5\t\u0026#34;n\u0026#34;) 6\techo \u0026#34;get option -name, value is $OPTARG\u0026#34; 7\t;; 8\t\u0026#34;a\u0026#34;) 9\techo \u0026#34;get option -age, value is $OPTARG\u0026#34; 10\t;; 11\t\u0026#34;h\u0026#34;) 12\techo \u0026#39; 13\t-n name of user 14\t-a age of user 15\t\u0026#39; 16\t;; 17\t\u0026#34;:\u0026#34;) 18\techo \u0026#34;No argument value for option $OPTARG\u0026#34; 19\t;; 20K\t\u0026#34;?","tags":null,"title":"å‚æ•°ä¼ é€’"},{"categories":null,"contents":"æºæ–‡ä»¶ åŸæ–‡ä»¶ä½¿ç”¨UTF-8ç¼–ç ï¼Œå¯¹Unicodeæ”¯æŒè‰¯å¥½ã€‚æ¯ä¸ªæºæ–‡ä»¶éƒ½å±äºåŒ…çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨æ–‡ä»¶å¤´éƒ¨ç”¨packageå£°æ˜æ‰€å±åŒ…çš„åç§°\n1package main 2func main(){ 3 println(\u0026#34;hello world!!\u0026#34;) 4} ä»¥.goä½œä¸ºæ–‡ä»¶æ‰©å±•åï¼Œè¯­å¥ç»“æŸåˆ†å·ä¼šè¢«é»˜è®¤çœç•¥ï¼Œæ”¯æŒCæ ·å¼æ³¨é‡Šã€‚å…¥å£å‡½æ•°mainæ²¡æœ‰å‚æ•°ï¼Œä¸”å¿…é¡»æ”¾åœ¨mainåŒ…ä¸­\nç”¨importå¯¼å…¥æ ‡å‡†åº“æˆ–ç¬¬ä¸‰æ–¹åŒ…\n1package main 2import{ 3 \u0026#34;fmt\u0026#34; 4} 5 6func main(){ 7 fmt.Println(\u0026#34;hello world!\u0026#34;) 8} å¯ä»¥ç›´æ¥è¿è¡Œæˆ–è€…ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶\nå˜é‡ ä½¿ç”¨varå®šä¹‰å˜é‡ï¼Œæ”¯æŒç±»å‹æ¨æ–­ã€‚åŸºç¡€æ•°æ®ç±»å‹åˆ’åˆ†æ¸…æ™°æ˜ç¡®ï¼Œæœ‰åŠ©äºç¼–å†™è·¨å¹³å°åº”ç”¨ã€‚ç¼–è¯‘å™¨ç¡®ä¿å˜é‡æ€»æ˜¯è¢«åˆå§‹åŒ–ä¸º0ï¼Œé¿å…å‡ºç°æ„å¤–çŠ¶å†µã€‚\n1package main 2func main(){ 3 var x int32 4 var s=\u0026#34;hello world!\u0026#34; 5 // ä¸¤ä¸ªæ•°æ®ä¹‹é—´é»˜è®¤ä½¿ç”¨ç©ºæ ¼éš”å¼€ 6 println(x,s) 7} åœ¨å‡½æ•°å†…éƒ¨ï¼Œè¿˜å¯ä»¥çœç•¥varå…³é”®å­—ï¼Œä½¿ç”¨æ›´ç®€å•çš„å®šä¹‰æ¨¡å¼ã€‚\n1package main 2 3//y := 200 // è¯¥å£°æ˜æ–¹å¼ä»…åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œä¸å¯ç”¨æ¥å£°æ˜å…¨å±€å˜é‡ 4func main() { 5\tx := 100 6\tprintln(x) 7} ç¼–è¯‘å™¨å°†æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡å®šä¹‰å½“åšé”™è¯¯\nè¡¨è¾¾å¼ Goä»…æœ‰ä¸‰ç§æµæ§åˆ¶è¯­å¥\nif 1package main 2 3func main() { 4\tx := 100 5\tif x \u0026gt; 0 { 6\tprint(\u0026#34;x\u0026#34;) 7\t} else if x \u0026lt; 0 { 8\tprint(\u0026#34;-x\u0026#34;) 9\t} else { 10\tprint(\u0026#34;0\u0026#34;) 11\t} 12} switch 1package main 2 3func main() { 4\tx := 0 5\tswitch { 6\tcase x \u0026gt; 0: 7\tprint(\u0026#34;x\u0026#34;) 8\tcase x \u0026lt; 0: 9\tprint(\u0026#34;-x\u0026#34;) 10\tdefault: 11\tprint(\u0026#34;0\u0026#34;) 12\t} 13} for 1func main() { 2\tfor i := 0; i \u0026lt; 5; i++ { 3\tprintln(i) 4\t} 5\tfor i := 4; i \u0026gt;= 0; i-- { 6\tprintln(i) 7\t} 8} 1package main 2 3func main() { 4\tx := 0 5 for x \u0026lt; 5 { // ç›¸å½“äº while(x\u0026lt;5) 6\tprintln(x) 7\tx++ 8\t} 9} 1package main 2 3func main() { 4\tx := 4 5\tfor { // ç›¸å½“äºwhile(true) 6\tprintln(x) 7\tx-- 8\tif x \u0026lt; 0 { 9\tbreak 10\t} 11\t} 12} åœ¨è¿­ä»£éå†æ—¶ï¼Œfor\u0026hellip;rangeé™¤äº†å…ƒç´ å¤–ï¼Œè¿˜å¯ä»¥è¿”å›ç´¢å¼•\n1package main 2 3func main() { 4\tx := []int{100, 101, 102} 5\tfor i, n := range x { 6\tprintln(i, \u0026#34;: \u0026#34;, n) 7\t} 8} å‡½æ•° å¤šä¸ªè¿”å›å€¼ å‡½æ•°å¯ä»¥å®šä¹‰å¤šä¸ªè¿”å›å€¼ï¼Œç”šè‡³å¯¹å…¶å‘½å\n1package main 2 3import ( 4\t\u0026#34;errors\u0026#34; 5\t\u0026#34;fmt\u0026#34; 6) 7 8func main() { 9\ta, b := 10, 0 // å®šä¹‰å¤šä¸ªå˜é‡ 10\tc, err := div(a, b) // æ¥æ”¶å¤šä¸ªè¿”å›å€¼ 11\tfmt.Println(c, err) 12} 13 14func div(a, b int) (int, error) { 15\tif b == 0 { 16\treturn 0, errors.New(\u0026#34;division by zero\u0026#34;) 17\t} 18 19\treturn a / b, nil 20} è¿”å›å‡½æ•° å‡½æ•°æ˜¯ç¬¬ä¸€ç±»å‹ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼\n1package main 2 3func main() { 4\tx := 100 5\tf := test(x); 6\tf() 7} 8 9func test(x int) func() { // è¿”å›å‡½æ•°ç±»å‹ 10\treturn func() { // åŒ¿åå‡½æ•° 11\tprintln(x) // é—­åŒ… 12\t} 13} ç”¨deferå®šä¹‰å»¶è¿Ÿè°ƒç”¨ï¼Œæ— è®ºå‡½æ•°æ˜¯å¦å‡ºé”™ï¼Œå®ƒéƒ½ç¡®ä¿ç»“æŸå‰è¢«è°ƒç”¨\n1package main 2 3func main() { 4\ttest(10, 0) 5} 6 7func test(a, b int) { 8\tdefer println(\u0026#34;dispose....\u0026#34;) // å¸¸ç”¨æ¥é‡Šæ”¾èµ„æºã€è§£é™¤é”å®šã€æˆ–æ‰§è¡Œä¸€äº›æ¸…ç†æ“ä½œ 9\t// å¯ä»¥å®šä¹‰å¤šä¸ªdeferï¼ŒæŒ‰ç…§FILOé¡ºåºæ‰§è¡Œ 10\tprintln(a / b) 11} æ•°æ® åˆ‡ç‰‡ slice åˆ‡ç‰‡(slice)å¯ä»¥å®ç°ç±»ä¼¼åŠ¨æ€æ•°ç»„çš„åŠŸèƒ½\n1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6\tx := make([]int, 0, 5) // åˆ›å»ºå®¹é‡ä¸º5çš„åˆ‡ç‰‡ 7\tfor i := 0; i \u0026lt; 8; i++ { 8\tx = append(x, i) // è¿½åŠ æ•°æ®ã€‚å½“è¶…å‡ºå®¹é‡é™åˆ¶æ—¶å€™ï¼Œè‡ªåŠ¨åˆ†é…æ›´å¤§çš„å­˜å‚¨ç©ºé—´ 9\t} 10\tfmt.Println(x) 11} å­—å…¸ map å­—å…¸(map) ç±»å‹å†…ç½®ï¼Œå¯ä»¥ç›´æ¥ä»è¿è¡Œå±‚é¢è·å¾—æ€§èƒ½ä¼˜åŒ–\n1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6\tm := make(map[string]int) // åˆ›å»ºå­—å…¸ç±»å‹å¯¹è±¡ 7\tm[\u0026#34;a\u0026#34;] = 999 // æ·»åŠ æˆ–è®¾ç½® 8\tx, ok := m[\u0026#34;a\u0026#34;] // ä½¿ç”¨ok-idiomè·å–å€¼ï¼Œå¯çŸ¥é“key/valueæ˜¯å¦å­˜åœ¨ 9\tfmt.Println(x, ok) 10\tdelete(m, \u0026#34;a\u0026#34;) // åˆ é™¤ 11} 12 13// 999 true 14// 0 false æ‰€è°“ ok-idiomæ¨¡å¼ï¼Œæ˜¯æŒ‡åœ¨å¤šè¿”å›å€¼ä¸­ç”¨ä¸€ä¸ªåä¸ºokçš„å¸ƒå°”å€¼æ¥è¡¨ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸã€‚å› ä¸ºå¾ˆå¤šæ“ä½œé»˜è®¤è¿”å›é›¶ï¼Œæ‰€ä»¥é¢å¤–è¯´æ˜\nç»“æ„ä½“ ç»“æ„ä½“(struct)å¯ä»¥åŒ¿ååµŒå…¥å…¶ä»–ç±»å‹\n1package main 2 3import \u0026#34;fmt\u0026#34; 4 5func main() { 6\tvar m manager 7\tm.name = \u0026#34;Tom\u0026#34; 8\tm.age = 29 9\tm.title = \u0026#34;CTO\u0026#34; // ç›´æ¥è®¿é—®åŒ¿åå­—æ®µæˆå‘˜ 10 11\tfmt.Println(m) 12} 13 14type user struct { // ç»“æ„ä½“ç±»å‹ 15\tname string 16\tage byte 17} 18 19type manager struct { 20\tuser // åŒ¿ååµŒå…¥å…¶ä»–ç±»å‹ 21\ttitle string 22} 23 24// {{Tom 29} CTO} æ–¹æ³• ç±»å‹çš„æ–¹æ³• å¯ä»¥ä¸ºå½“å‰åŒ…å†…çš„ä»»æ„ç±»å‹å®šä¹‰æ–¹æ³•\n1package main 2 3type X int 4 5func (x *X) inc() { // åç§°å‰çš„å‚æ•°ç§°ä½œreceiver,ä½œç”¨ç±»ä¼¼Python self 6\t*x++ 7} 8 9func main() { 10\tvar x X 11\tx.inc() 12\tprintln(x) 13} ç»§æ‰¿ è¿˜å¯ä»¥ç›´æ¥è°ƒç”¨åŒ¿åå­—æ®µçš„æ–¹æ³•ï¼Œè¿™ç§æ–¹å¼å¯å®ç°ä¸ç»§æ‰¿ç±»ä¼¼çš„åŠŸèƒ½\n1package main 2 3import \u0026#34;fmt\u0026#34; 4 5type user struct { 6\tname string 7\tage byte 8} 9 10func (u user) ToString() string { 11\treturn fmt.Sprintf(\u0026#34;%+v\u0026#34;, u) 12} 13 14type manager struct { 15\tuser 16\ttitle string 17} 18 19func main() { 20\tvar m manager 21\tm.name = \u0026#34;Tom\u0026#34; 22\tm.age = 29 23\tprintln(m.ToString()) // è°ƒç”¨user.ToString 24} æ¥å£ ç»“æ„é‡‡ç”¨äº†duck typeæ–¹å¼, ä¹Ÿå°±æ˜¯æ— é¡»åœ¨å®ç°ç±»å‹ä¸Šæ·»åŠ æ˜¾å¼å£°æ˜\n1package main 2 3import \u0026#34;fmt\u0026#34; 4 5type user struct { 6\tname string 7\tage byte 8} 9 10func (u user) Print() { 11\tfmt.Printf(\u0026#34;%+v\\n\u0026#34;, u) 12} 13 14type Printer interface { // æ¥å£ç±»å‹ 15\tPrint() 16} 17 18func main() { 19\tvar u user 20\tu.name = \u0026#34;Tom\u0026#34; 21\tu.age = 29 22 23\tvar p Printer = u // åªè¦åŒ…å«æ¥å£æ‰€éœ€çš„å…¨éƒ¨æ–¹æ³•ï¼Œå³è¡¨ç¤ºå®ç°äº†è¯¥æ¥å£ 24\tp.Print() 25} å¦æœ‰ç©ºæ¥å£ç±»å‹interface{}, ç”¨é€”ç±»ä¼¼OPPé‡Œçš„system.Object,å¯ä»¥æ¥æ”¶ä»»æ„ç±»å‹çš„å¯¹è±¡\nå¹¶å‘ æ•´ä¸ªè¿è¡Œæ—¶å®Œå…¨å¹¶å‘è®¾è®¡ã€‚å‡¡ä½ èƒ½çœ‹åˆ°çš„ï¼Œå‡ ä¹éƒ½åœ¨ä»¥goroutineæ–¹å¼è¿è¡Œã€‚è¿™æ˜¯ä¸€ç§æ¯”æ™®é€šåç¨‹æˆ–çº¿ç¨‹æ›´åŠ é«˜æ•ˆçš„å¹¶å‘è®¾è®¡ï¼Œèƒ½è½»æ¾åˆ›å»ºå’Œè¿è¡Œæˆåƒä¸Šä¸‡çš„å¹¶å‘ä»»åŠ¡ã€‚\n1package main 2 3import ( 4\t\u0026#34;fmt\u0026#34; 5\t\u0026#34;time\u0026#34; 6) 7 8func task(id int) { 9\tfor i := 0; i \u0026lt; 5; i++ { 10\tfmt.Printf(\u0026#34;%d: %d\\n\u0026#34;, id, i) 11\ttime.Sleep(time.Second) 12\t} 13} 14 15func main() { 16\tgo task(1) // åˆ›å»º goroutine 17\tgo task(2) 18 19\ttime.Sleep(time.Second * 6) 20} é€šé“(channel) ä¸goroutineæ­é…ï¼Œå®ç°é€šä¿¡ä»£æ›¿å…±äº«å†…å­˜çš„CSPæ¨¡å‹\n1package main 2 3import \u0026#34;time\u0026#34; 4 5// æ¶ˆè´¹è€… 6func consumer(data chan int, done chan bool) { 7\tfor x := range data { // æ¥æ”¶æ•°æ®ï¼Œç›´åˆ°é€šé“è¢«å…³é—­ 8\tprintln(\u0026#34;recv: \u0026#34;, x) 9\t} 10\tdone \u0026lt;- true // é€šçŸ¥mainï¼Œ æ¶ˆè´¹ç»“æŸ 11} 12 13// ç”Ÿäº§è€… 14func producer(data chan int) { 15\tfor i := 0; i \u0026lt; 4; i++ { 16\tdata \u0026lt;- i // å‘é€æ•°æ® 17\tprintln(\u0026#34;send: \u0026#34;,i) 18\ttime.Sleep(time.Second) 19\t} 20\tclose(data) // ç”Ÿäº§ç»“æŸï¼Œå…³é—­é€šé“ 21} 22 23func main() { 24\tdone := make(chan bool) // ç”¨äºæ¥æ”¶æ¶ˆè´¹ç»“æŸä¿¡å· 25\tdata := make(chan int) // æ•°æ®ç®¡é“ 26 27\tgo consumer(data, done) // å¯åŠ¨æ¶ˆè´¹è€… 28\tgo producer(data) // å¯åŠ¨ç”Ÿäº§è€… 29 30\t\u0026lt;-done // é˜»å¡ï¼Œç›´åˆ°æ¶ˆè´¹è€…å‘å›ç»“æŸä¿¡å· 31} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/1_Go%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E6%A2%B3%E7%90%86/","summary":"æºæ–‡ä»¶ åŸæ–‡ä»¶ä½¿ç”¨UTF-8ç¼–ç ï¼Œå¯¹Unicodeæ”¯æŒè‰¯å¥½ã€‚æ¯ä¸ªæºæ–‡ä»¶éƒ½å±äºåŒ…çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨æ–‡ä»¶å¤´éƒ¨ç”¨packageå£°æ˜æ‰€å±åŒ…çš„åç§°\n1package main 2func main(){ 3 println(\u0026#34;hello world!!\u0026#34;) 4} ä»¥.goä½œä¸ºæ–‡ä»¶æ‰©å±•åï¼Œè¯­å¥ç»“æŸåˆ†å·ä¼šè¢«é»˜è®¤çœç•¥ï¼Œæ”¯æŒCæ ·å¼æ³¨é‡Šã€‚å…¥å£å‡½æ•°mainæ²¡æœ‰å‚æ•°ï¼Œä¸”å¿…é¡»æ”¾åœ¨mainåŒ…ä¸­\nç”¨importå¯¼å…¥æ ‡å‡†åº“æˆ–ç¬¬ä¸‰æ–¹åŒ…\n1package main 2import{ 3 \u0026#34;fmt\u0026#34; 4} 5 6func main(){ 7 fmt.Println(\u0026#34;hello world!\u0026#34;) 8} å¯ä»¥ç›´æ¥è¿è¡Œæˆ–è€…ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶\nå˜é‡ ä½¿ç”¨varå®šä¹‰å˜é‡ï¼Œæ”¯æŒç±»å‹æ¨æ–­ã€‚åŸºç¡€æ•°æ®ç±»å‹åˆ’åˆ†æ¸…æ™°æ˜ç¡®ï¼Œæœ‰åŠ©äºç¼–å†™è·¨å¹³å°åº”ç”¨ã€‚ç¼–è¯‘å™¨ç¡®ä¿å˜é‡æ€»æ˜¯è¢«åˆå§‹åŒ–ä¸º0ï¼Œé¿å…å‡ºç°æ„å¤–çŠ¶å†µã€‚\n1package main 2func main(){ 3 var x int32 4 var s=\u0026#34;hello world!\u0026#34; 5 // ä¸¤ä¸ªæ•°æ®ä¹‹é—´é»˜è®¤ä½¿ç”¨ç©ºæ ¼éš”å¼€ 6 println(x,s) 7} åœ¨å‡½æ•°å†…éƒ¨ï¼Œè¿˜å¯ä»¥çœç•¥varå…³é”®å­—ï¼Œä½¿ç”¨æ›´ç®€å•çš„å®šä¹‰æ¨¡å¼ã€‚\n1package main 2 3//y := 200 // è¯¥å£°æ˜æ–¹å¼ä»…åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œä¸å¯ç”¨æ¥å£°æ˜å…¨å±€å˜é‡ 4func main() { 5\tx := 100 6\tprintln(x) 7} ç¼–è¯‘å™¨å°†æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡å®šä¹‰å½“åšé”™è¯¯\nè¡¨è¾¾å¼ Goä»…æœ‰ä¸‰ç§æµæ§åˆ¶è¯­å¥\nif 1package main 2 3func main() { 4\tx := 100 5\tif x \u0026gt; 0 { 6\tprint(\u0026#34;x\u0026#34;) 7\t} else if x \u0026lt; 0 { 8\tprint(\u0026#34;-x\u0026#34;) 9\t} else { 10\tprint(\u0026#34;0\u0026#34;) 11\t} 12} switch 1package main 2 3func main() { 4\tx := 0 5\tswitch { 6\tcase x \u0026gt; 0: 7\tprint(\u0026#34;x\u0026#34;) 8\tcase x \u0026lt; 0: 9\tprint(\u0026#34;-x\u0026#34;) 10\tdefault: 11\tprint(\u0026#34;0\u0026#34;) 12\t} 13} for 1func main() { 2\tfor i := 0; i \u0026lt; 5; i++ { 3\tprintln(i) 4\t} 5\tfor i := 4; i \u0026gt;= 0; i-- { 6\tprintln(i) 7\t} 8} 1package main 2 3func main() { 4\tx := 0 5 for x \u0026lt; 5 { // ç›¸å½“äº while(x\u0026lt;5) 6\tprintln(x) 7\tx++ 8\t} 9} 1package main 2 3func main() { 4\tx := 4 5\tfor { // ç›¸å½“äºwhile(true) 6\tprintln(x) 7\tx-- 8\tif x \u0026lt; 0 { 9\tbreak 10\t} 11\t} 12} åœ¨è¿­ä»£éå†æ—¶ï¼Œfor\u0026hellip;rangeé™¤äº†å…ƒç´ å¤–ï¼Œè¿˜å¯ä»¥è¿”å›ç´¢å¼•","tags":null,"title":"åŸºæœ¬è¯­æ³•æ¢³ç†"},{"categories":null,"contents":"ä¿®æ”¹è¡¨å­—æ®µ\n1# æ–°å¢ä¸€ä¸ªå­—æ®µ 2alert table rules add effect_time mysql sql 8.0 è®¤è¯é—®é¢˜\nconnect to 10.227.4.115:3306 err: this authentication plugin is not supported\n1alter user root@% identified with mysql_native_password by \u0026#34;123456\u0026#34; 1CREATE DATABASE IF NOT EXISTS echo_bio DEFAULT CHARSET utf8 COLLATE utf8_general_ci; 2CREATE DATABASE IF NOT EXISTS echo_bio_jira DEFAULT CHARSET utf8 COLLATE utf8_general_ci; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/component/DataBase/mysql/install_mysql/","summary":"ä¿®æ”¹è¡¨å­—æ®µ\n1# æ–°å¢ä¸€ä¸ªå­—æ®µ 2alert table rules add effect_time mysql sql 8.0 è®¤è¯é—®é¢˜\nconnect to 10.227.4.115:3306 err: this authentication plugin is not supported\n1alter user root@% identified with mysql_native_password by \u0026#34;123456\u0026#34; 1CREATE DATABASE IF NOT EXISTS echo_bio DEFAULT CHARSET utf8 COLLATE utf8_general_ci; 2CREATE DATABASE IF NOT EXISTS echo_bio_jira DEFAULT CHARSET utf8 COLLATE utf8_general_ci; ","tags":null,"title":"å®‰è£…é…ç½®Mysql"},{"categories":null,"contents":" ä¸ºä»€ä¹ˆå®¹å™¨é‡Œåªèƒ½è·‘â€œä¸€ä¸ªè¿›ç¨‹â€ï¼Ÿ ä¸ºä»€ä¹ˆæˆ‘åŸå…ˆä¸€ç›´åœ¨ç”¨æŸä¸ªJVMå‚æ•°ï¼Œåœ¨å®¹å™¨é‡Œå°±ä¸å¥½ä½¿äº†ï¼Ÿ ä¸ºä»€ä¹ˆkuberneteså°±ä¸èƒ½å›ºå®šIPåœ°å€ï¼Ÿå®¹å™¨ç½‘ç»œè”ä¸é€šåˆè¯¥å¦‚ä½•å»debugï¼Ÿ Kubernetesä¸­çš„StatefulSetå’ŒOperatoråˆ°åº•ä»€ä¹ˆåŒºåˆ«ï¼ŸPCå’ŒPVCè¿™äº›æ¦‚å¿µåˆè¯¥æ€ä¹ˆç”¨ï¼Ÿ Linuxè¿›ç¨‹æ¨¡å‹å¯¹å®¹å™¨æœ¬èº«çš„é‡è¦æ„ä¹‰ï¼Œæ§åˆ¶å™¨æ¨¡å¼å¯¹æ•´ä¸ªK8sé¡¹ç›®æçº²æŒˆé¢†çš„ä½œç”¨ï¼Ÿ ä»PaaSåˆ°K8s PaaS PaaS(Platform as a Service) åº”ç”¨æ‰˜ç®¡ã€‚\nDockeré•œåƒï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç›´æ¥ç”±ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿçš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•æ„æˆã€‚\nå…¶å®åªæ‰“åŒ…äº†æ–‡ä»¶ç³»ç»Ÿï¼Œä¸åŒ…æ‹¬æ“ä½œç³»ç»Ÿçš„å†…æ ¸ã€‚å„ç§å†…æ ¸ç›¸å…³çš„æ¨¡å—æˆ–è€…ç‰¹æ€§æ”¯æŒå®Œå…¨ä¾èµ–äºå®¿ä¸»æœºã€‚\né€šè¿‡docker build æ‰“åŒ…é•œåƒï¼Œdocker run è¿è¡Œé•œåƒï¼Œdocker runåˆ›å»ºçš„æ²™ç›’ï¼Œå°±æ˜¯ä½¿ç”¨Linux Cgroupså’ŒNamespaceæœºåˆ¶åˆ›å»ºå‡ºæ¥çš„éš”ç¦»ç¯å¢ƒã€‚è§£å†³äº†åº”ç”¨æ‰“åŒ…è¿™ä¸ªæ ¹æœ¬æ€§é—®é¢˜ã€‚\nSwarm swarm æä¾›é›†ç¾¤ç®¡ç†åŠŸèƒ½\nå•æœºdockeré¡¹ç›®\n1docker run \u0026lt;container-name\u0026gt; å¤šæœºdockeré¡¹ç›®\n1docker run -H \u0026#39;swarm cluster API\u0026#39; \u0026lt;container-name\u0026gt;\tFig é¡¹ç›® Figé¡¹ç›®ç¬¬ä¸€æ¬¡åœ¨å¼€å‘è€…é¢å‰æå‡ºäº†å®¹å™¨ç¼–æ’(Container Orchestration)çš„æ¦‚å¿µã€‚\nåŠ å…¥ç”¨æˆ·ç°åœ¨éœ€è¦éƒ¨ç½²çš„æ˜¯åº”ç”¨å®¹å™¨Aã€æ•°æ®åº“å®¹å™¨Bã€è´Ÿè½½å‡è¡¡å®¹å™¨Cï¼Œé‚£ä¹ˆFigå°±å…è®¸ç”¨æˆ·æŠŠABCä¸‰ä¸ªå®¹å™¨å®šä¹‰åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œ å¹¶ä¸”å¯ä»¥æŒ‡å®šä»–ä»¬ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œæ¯”å¦‚å®¹å™¨Aéœ€è¦è®¿é—®æ•°æ®åº“Bã€‚å®šä¹‰å¥½ä¹‹åï¼Œåªéœ€è¦æ‰§è¡Œä¸€æ¡éå¸¸ç®€å•çš„æŒ‡ä»¤ã€‚\n1fig up Figå°±ä¼šæŠŠè¿™äº›å®¹å™¨çš„å®šä¹‰å’Œé…ç½®äº¤ç»™DockerAPIæŒ‰ç…§è®¿é—®é€»è¾‘ä¸€æ¬¡åˆ›å»ºã€‚è€Œå®¹å™¨Aå’ŒBä¹‹é—´çš„å…³è”å…³ç³»ï¼Œä¹Ÿä¼šäº¤ç»™dockerçš„LinkåŠŸèƒ½é€šè¿‡å†™å…¥hostsæ–‡ä»¶çš„æ–¹å¼è¿›è¡Œé…ç½®ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä½ è¿˜å¯ä»¥åœ¨Figçš„é…ç½®æ–‡ä»¶é‡Œå®šä¹‰å„ç§å®¹å™¨çš„å‰¯æœ¬ä¸ªæ•°ç­‰ç¼–æ’å‚æ•°ã€‚\nFig é¡¹ç›®è¢«Dockeræ”¶è´­åæ›´åä¸ºComposeã€‚\nLibcontainer LibContainer -\u0026gt; RunC\nä»¥RunCä¸ºä¾æ®ï¼Œåˆ¶å®šå®¹å™¨å’Œé•œåƒçš„æ ‡å‡†å’Œè§„èŒƒã€‚\nOCI(Open Container Initiative), æ„åœ¨å°†å®¹å™¨è¿è¡Œæ—¶å’Œé•œåƒçš„å®ç°ä»Dockeré¡¹ç›®ä¸­å®Œå…¨å‰¥ç¦»å‡ºæ¥ã€‚\nContainerd å®¹å™¨è¿è¡Œæ—¶\nè¿›ç¨‹éš”ç¦»ä¸é™åˆ¶ ç¨‹åºè¢«æ‰§è¡Œèµ·æ¥ï¼Œå®ƒå°±ä»ç£ç›˜ä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå˜æˆäº†è®¡ç®—æœº å†…å­˜ä¸­çš„æ•°æ®ï¼Œå¯„å­˜å™¨é‡Œçš„å€¼ï¼Œå †æ ˆä¸­çš„æŒ‡ä»¤ã€è¢«æ‰“å¼€çš„æ–‡ä»¶ï¼Œä»¥åŠå„ç§è®¾å¤‡çš„çŠ¶æ€ä¿¡æ¯çš„ä¸€ä¸ªé›†åˆã€‚åƒè¿™æ ·ä¸€ä¸ªç¨‹åºè¿è¡Œèµ·æ¥åçš„è®¡ç®—æœºæ‰§è¡Œç¯å¢ƒçš„æ€»å’Œï¼Œå°±æ˜¯ï¼šè¿›ç¨‹ã€‚\nå¯¹äºè¿›ç¨‹æ¥è¯´ï¼Œå®ƒçš„é™æ€è¡¨ç°å°±æ˜¯ç¨‹åºï¼Œä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼›è€Œä¸€æ—¦è¿è¡Œèµ·æ¥ï¼Œå°±å˜æˆäº†è®¡ç®—æœºæ•°æ®å’ŒçŠ¶æ€çš„æ€»å’Œï¼Œè¿™å°±æ˜¯è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ã€‚\nå®¹å™¨æŠ€æœ¯çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯é€šè¿‡çº¦æŸå’Œä¿®æ”¹è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ï¼Œä»è€Œä¸ºå…¶åˆ›é€ å‡ºä¸€ä¸ªâ€œè¾¹ç•Œâ€ã€‚å¯¹äºå¤§å¤šæ•°Linuxå®¹å™¨æ¥è¯´ï¼Œ Cgroupsæ˜¯ç”¨æ¥åˆ¶é€ çº¦æŸçš„ä¸»è¦æ‰‹æ®µï¼Œ è€ŒNamespaceæŠ€æœ¯åˆ™æ˜¯ç”¨æ¥ä¿®æ”¹è¿›ç¨‹è§†å›¾çš„ä¸»è¦æ–¹æ³•ã€‚\néš”ç¦» 1docker run -it busybox /bin/sh What is BusyBox? The Swiss Army Knife of Embedded Linux\nComing in somewhere between 1 and 5 Mb in on-disk size(depending on the variant), BusyBox is a very good ingredient to craft space-efficient distributions.\nBusyBox combines tiny versions of many common Unix utilities into a single small executable. It provides replacements for most of the utilities you usually find in GNU fileutils, shellutils, etc. The utilities in BusyBox generally have fewer options than their full-featured GNU cousins; however, the options that are included provide the expected functionality and behave very much like the GNU counterparts. BusyBox provides a fairly complete environment for any small or embedded system.\n1âœ ~ docker run -it busybox 2/ # ps 3PID USER TIME COMMAND 4 1 root 0:00 sh 5 7 root 0:00 ps 6/ # å¯ä»¥çœ‹åˆ°å®¹å™¨ä¸­åªæœ‰ä¸¤ä¸ªè¿›ç¨‹ï¼Œç¬¬ä¸€ä¸ªæ˜¯bin/shä¸º1å·è¿›ç¨‹ï¼Œç¬¬äºŒä¸ªæ˜¯psï¼Œå¯ä»¥çœ‹åˆ°dockerå®¹å™¨å·²ç»éš”ç¦»åœ¨äº†ä¸€ä¸ªä¸å®¿ä¸»æœºå®Œå…¨ä¸åŒçš„ç©ºé—´ä¸­ã€‚\nåœ¨Dockerå®¹å™¨ä¸­çœ‹åˆ°çš„è¿›ç¨‹Pid å®é™…ä¸Šæ˜¯é‡æ–°è®¡ç®—è¿‡çš„è¿›ç¨‹IDï¼Œåœ¨å®¹å™¨ä¸­ï¼Œåªèƒ½çœ‹åˆ°å½“å‰å®¹å™¨çš„ç›¸å…³è¿›ç¨‹ã€‚\nè¿™ç§æŠ€æœ¯å°±æ˜¯Linuxä¸­çš„Namespaceæœºåˆ¶ã€‚Namespaceåªæ˜¯Linuxåˆ›å»ºè¿›ç¨‹çš„ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚\nåœ¨Linuxç³»ç»Ÿä¸­åˆ›å»ºçº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨æ˜¯clone().\n1int pid = clone(main_function, stack_size,SIGCHLD, NULL); è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ä¼šä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œå¹¶ä¸”è¿”å›å®ƒçš„è¿›ç¨‹å·pidã€‚\nå½“æˆ‘ä»¬ç”¨clone()ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æ—¶ï¼Œå¯ä»¥åœ¨å‚æ•°ä¸­æŒ‡å®šCLONE_NEWPIDå‚æ•°\n1int pid = clone(main_function, stack_size, CLONE_NEWPID | SIGCHLD, NULL) Linux çš„çº¿ç¨‹æ˜¯ç”¨è¿›ç¨‹å®ç°çš„ã€‚\nè¿™æ—¶ï¼Œæ–°åˆ›å»ºçš„è¿™ä¸ªè¿›ç¨‹å°†ä¼šçœ‹åˆ°ä¸€ä¸ªå…¨æ–°çš„è¿›ç¨‹ç©ºé—´ï¼Œåœ¨è¿™ä¸ªè¿›ç¨‹ç©ºé—´é‡Œï¼Œå®ƒçš„pidæ˜¯1ã€‚ä½†æ˜¯åœ¨å®¿ä¸»æœºçœŸå®çš„è¿›ç¨‹ç©ºé—´é‡Œï¼Œè¿™ä¸ªè¿›ç¨‹çš„PIDè¿˜æ˜¯çœŸå®æ•°å€¼ã€‚\né™¤äº†PID Namespaceï¼ŒLinuxæ“ä½œç³»ç»Ÿè¿˜æä¾›äº†Mountã€UTSã€IPCã€Networkå’ŒUserè¿™äº›Namespaceï¼Œç”¨æ¥å¯¹ä¸åŒçš„è¿›ç¨‹ä¸Šä¸‹æ–‡è¿›è¡Œéš”ç¦»ã€‚Mount Namespaceï¼Œç”¨äºè®©è¢«éš”ç¦»çš„è¿›ç¨‹åªçœ‹åˆ°å½“å‰Namespaceé‡Œçš„æŒ‚è½½ç‚¹ä¿¡æ¯ã€‚Network Namespaceç”¨äºè¢«éš”ç¦»çš„è¿›ç¨‹çœ‹åˆ°å½“å‰Namespaceé‡Œçš„ç½‘ç»œè®¾å¤‡å’Œé…ç½®ã€‚\næ‰€ä»¥ï¼Œå®¹å™¨å…¶å®æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹ã€‚\nå•è¿›ç¨‹çš„æ„æ€ä¸æ˜¯åªèƒ½è¿è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œæ˜¯æ˜¯æœ‰ä¸€ä¸ªè¿›ç¨‹æ˜¯å¯æ§çš„ã€‚\nLxc\nNamespaceæŠ€æœ¯å®é™…ä¸Šä¿®æ”¹äº†åº”ç”¨ç¨‹åºçœ‹å¾…çœŸä¸ªè®¡ç®—æœºçš„â€œè§†å›¾â€ï¼Œå³å®ƒçš„è§†çº¿è¢«æ“ä½œç³»ç»Ÿåšäº†é™åˆ¶ï¼Œåªèƒ½çœ‹åˆ°æŸäº›æŒ‡å®šçš„å†…å®¹ã€‚ä½†æ˜¯å¯¹äºå®¿ä¸»æœºè€Œè¨€ï¼Œè¿™äº›è¢«éš”ç¦»äº†çš„è¿›ç¨‹å’Œå…¶ä»–è¿›ç¨‹æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚å®¹å™¨åŒ–åçš„ç”¨æˆ·åº”ç”¨ä¾ç„¶æ˜¯å®¿ä¸»æœºä¸Šçš„æ™®é€šè¿›ç¨‹ã€‚\nä¸€ä¸ªCentOSçš„KVMè™šæ‹Ÿæœºåœ¨ä¸åšä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œè™šæ‹Ÿæœºè‡ªå·±è¦å 100~200MBå†…å­˜ã€‚ç”¨æˆ·åº”ç”¨è¿è¡Œåœ¨è™šæ‹Ÿæœºé‡Œé¢å¯¹å®¿ä¸»æœºæ“ä½œç³»ç»Ÿçš„è°ƒç”¨ä¸å¯é¿å…çš„è¦ç»è¿‡è™šæ‹ŸåŒ–è½¯ä»¶çš„æ‹¦æˆªå’Œå¤„ç†ï¼Œè¿™æœ¬èº«åˆæ˜¯ä¸€å±‚æ€§èƒ½æŸè€—ã€‚å°¤å…¶å¯¹è®¡ç®—èµ„æºï¼Œç½‘ç»œå’Œç£ç›˜I/Oçš„æŸè€—éå¸¸å¤§ã€‚\nåŸºäºLinux Namespaceçš„éš”ç¦»æœºåˆ¶ç›¸æ¯”äºè™šæ‹ŸåŒ–æŠ€æœ¯ä¹Ÿæœ‰å¾ˆå¤šä¸è¶³ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯éš”ç¦»çš„ä¸å½»åº•ã€‚\nå®¹å™¨åªæ˜¯è¿è¡Œåœ¨å®¿ä¸»æœºä¸Šçš„ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹ï¼Œé‚£ä¹ˆï¼Œå¤šä¸ªå®¹å™¨ä¹‹é—´ä½¿ç”¨çš„å°±è¿˜æ˜¯åŒä¸€ä¸ªå®¿ä¸»æœºçš„æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœåœ¨å®¹å™¨ä¸­ï¼Œä½¿ç”¨ç³»ç»Ÿè°ƒç”¨settimeofdayä¿®æ”¹äº†æ—¶é—´ï¼Œæ•´ä¸ªå®¿ä¸»æœºçš„æ—¶é—´ä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚ç”±äºå®¹å™¨å…±äº«å®¿ä¸»æœºçš„å†…æ ¸ï¼Œå®¹å™¨ç»™åº”ç”¨æš´éœ²å‡ºæ¥çš„æ”»å‡»é¢æ˜¯ç›¸å½“å¤§çš„ï¼Œåº”ç”¨è¶Šç‹±çš„éš¾åº¦è‡ªç„¶ä¹Ÿæ¯”è™šæ‹Ÿæœºä½çš„å¤šã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨Seccompç­‰æŠ€æœ¯å¯¹å®¹å™¨å†…éƒ¨æ‰€æœ‰å‘èµ·çš„ç³»ç»Ÿè°ƒç”¨è¿›è¡Œè¿‡æ»¤å’Œç”„åˆ«æ¥è¿›è¡Œå®‰å…¨åŠ å›ºï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•å› ä¸ºå¤šäº†ä¸€å±‚å¯¹ç³»ç»Ÿè°ƒç”¨çš„è¿‡æ»¤ï¼Œä¸€å®šä¼šæ‹–ç´¯å®¹å™¨çš„æ€§èƒ½ã€‚\nå°½ç®¡å¯ä»¥åœ¨å®¹å™¨é‡Œé€šè¿‡Mount Namespaceå•ç‹¬æŒ‚è½½å…¶ä»–ä¸åŒç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿæ–‡ä»¶ï¼Œä½†æ˜¯è¿™å¹¶ä¸èƒ½æ”¹å˜å…±äº«å®¿ä¸»æœºå†…æ ¸çš„äº‹å®ã€‚å¦‚æœåœ¨windowså®¿ä¸»æœºè¿è¡ŒLinuxå®¹å™¨ï¼Œæˆ–è€…å†ä½ç‰ˆæœ¬çš„Linuxå®¿ä¸»æœºä¸Šè¿è¡Œé«˜ç‰ˆæœ¬çš„Linuxå®¹å™¨éƒ½æ˜¯è¡Œä¸é€šçš„ã€‚\nDocker åœ¨windows å’ŒMac OSä¸Šçš„å·¥ä½œæ–¹å¼ä¸Linux ä¸Šçš„å·¥ä½œæ–¹å¼æ˜¯ä¸åŒçš„ï¼Œæ˜¯é€šè¿‡è™šæ‹Ÿæœºçš„æ–¹å¼è¿è¡Œå®¹å™¨çš„ã€‚\nä¸ºä»€ä¹ˆç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ²¡æœ‰äººæ•¢æŠŠè¿è¡Œåœ¨ç‰©ç†æœºä¸Šçš„Linuxå®¹å™¨ç›´æ¥æš´éœ²åˆ°å…¬ç½‘ä¸Šï¼ŸæŸå…¬å¸mongodb podIdæ³„éœ²å¯¼è‡´æ•°æ®è¢«åˆ é™¤ã€‚\né™åˆ¶ æˆ‘ä»¬ä½¿ç”¨Namespaceå¯¹è¿›ç¨‹è¿›è¡Œéš”ç¦»ä¹‹åï¼Œ ä½†æ˜¯å®ƒæ‰€èƒ½éƒ½ä½¿ç”¨åˆ°çš„èµ„æº(æ¯”å¦‚CPUï¼Œ å†…å­˜)å´æ˜¯éšæ—¶å¯ä»¥è¢«Hostä¸Šçš„å…¶ä»–è¿›ç¨‹æ‰€å ç”¨çš„ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªè¿›ç¨‹ä¹Ÿæœ‰å¯èƒ½å§æ‰€æœ‰çš„èµ„æºéƒ½åƒå…‰ã€‚\nLinux Cgroups(Linux Control Group) å°±æ˜¯Linuxå†…æ ¸ä¸­ç”¨æ¥ä¸ºè¿›ç¨‹è®¾ç½®èµ„æºé™åˆ¶çš„ä¸€ä¸ªé‡è¦åŠŸèƒ½ã€‚ä¸»è¦ä½œç”¨å°±æ˜¯é™åˆ¶ä¸€ä¸ªè¿›ç¨‹ç»„èƒ½éƒ½ä½¿ç”¨çš„èµ„æºä¸Šé™ï¼ŒåŒ…æ‹¬CPUã€Memã€ç£ç›˜ã€ç½‘ç»œå¸¦å®½ç­‰ç­‰ã€‚\nåœ¨Googleå†…éƒ¨ï¼ŒContainerè¿™ä¸ªæœ¯è¯­é•¿æœŸä»¥æ¥ç”¨äºå½¢å®¹è¢«Cgroupsé™åˆ¶è¿‡çš„è¿›ç¨‹ç»„ã€‚Cgroupsè¿˜èƒ½éƒ½å¯¹è¿›ç¨‹ä¼˜å…ˆçº§è®¾ç½®ã€å®¡è®¡ã€‚ä»¥åŠå°†è¿›ç¨‹æŒ‚èµ·å’Œæ¢å¤ç­‰æ“ä½œã€‚\nCgroup ç»™ç”¨æˆ·æš´éœ²å‡ºæ¥çš„æ“ä½œæ¥å£æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼Œå³å®ƒä»¥æ–‡ä»¶å’Œç›®å½•çš„æ–¹å¼ç»„ç»‡åœ¨æ“ä½œç³»ç»Ÿ/sys/fs/cgroupè·¯å¾„ä¸‹ã€‚åœ¨/sys/fs/cgroup ä¸‹é¢æœ‰å¾ˆå¤šè¯¸å¦‚cpusetã€cpuã€memoryè¿™æ ·çš„å­ç›®å½•ï¼Œä¹Ÿå«å­ç³»ç»Ÿã€‚è¿™äº›éƒ½æ˜¯å½“å‰è¿™å°æœºå™¨å¯ä»¥è¢«Cgroupsè¿›è¡Œé™åˆ¶çš„èµ„æºç§ç±»ã€‚\nåœ¨å­ç³»ç»Ÿå¯¹åº”çš„èµ„æºç§ç±»ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°è¯¥ç±»èµ„æºå…·ä½“å¯ä»¥è¢«é™åˆ¶çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¯¹cpuå­ç³»ç»Ÿæ¥è¯´ï¼Œæœ‰å¦‚ä¸‹å‡ ä¸ªé…ç½®æ–‡ä»¶ï¼š\næˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼Œçœ‹ä¸‹å¦‚ä½•ä½¿ç”¨é…ç½®æ–‡ä»¶è¿›è¡Œcpuèµ„æºçš„é™åˆ¶ã€‚\næˆ‘ä»¬åœ¨åå°æ‰§è¡Œä¸€ä¸ªè„šæœ¬ã€‚\n1while : ; do : ; done \u0026amp; æ­¤æ—¶å¯ä»¥çœ‹åˆ°ä¸€ä¸ªcpuè¢«æ‰“æ»¡ã€‚\nåœ¨/sys/fs/cgroup/cpu åˆ›å»ºä¸€ä¸ªcontainerç›®å½•ï¼Œç›®å½•ä¸‹ä¼šè‡ªåŠ¨ç”Ÿæˆè¯¥å­ç³»ç»Ÿå¯¹åº”çš„èµ„æºé™åˆ¶æ–‡ä»¶ã€‚cfs_period å’Œcfs_quota è¿™ä¸¤ä¸ªå‚æ•°ï¼Œç”¨æ¥é™åˆ¶ è¿›ç¨‹åœ¨é•¿åº¦ä¸ºcfs_periodçš„ä¸€æ®µæ—¶é—´é‡Œï¼Œåªèƒ½åˆ†é…åˆ°æ€»é‡ä¸ºcfs_quotaçš„CPUæ—¶é—´ã€‚\næˆ‘ä»¬ä¿®æ”¹cfs_quota ä¸º20000, å¹¶ä¸”æŠŠPIDå†™å…¥containerç»„é‡Œçš„tasksæ–‡ä»¶ã€‚\n1# use root 2echo 20000 \u0026gt; /sys/fs/cgroup/cpu/container/cpu.cfs_quota_us 3echo 27428 \u0026gt; cpu çš„ä½¿ç”¨ç‡é™ä½åˆ°80%å·¦å³ã€‚\né™¤äº†CPUå­ç³»ç»Ÿå¤–ï¼ŒCgroupsçš„æ¯ä¸€é¡¹å­ç³»ç»Ÿéƒ½æœ‰å…¶ç‹¬æœ‰çš„èµ„æºé™åˆ¶èƒ½åŠ›ã€‚\nblkioï¼Œ ä¸ºå—è®¾å¤‡è®¾å®šI/Oé™åˆ¶ï¼Œä¸€èˆ¬ç”¨äºç£ç›˜ç­‰è®¾å¤‡ cpuset ä¸ºè¿›ç¨‹åˆ†é…å•ç‹¬çš„cpuæ ¸å’Œå¯¹åº”çš„å†…å­˜èŠ‚ç‚¹ memory ä¸ºè¿›ç¨‹è®¾å®šå†…å­˜çš„ä½¿ç”¨é™åˆ¶ã€‚ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Kubernates/Container-Intro/","summary":"ä¸ºä»€ä¹ˆå®¹å™¨é‡Œåªèƒ½è·‘â€œä¸€ä¸ªè¿›ç¨‹â€ï¼Ÿ ä¸ºä»€ä¹ˆæˆ‘åŸå…ˆä¸€ç›´åœ¨ç”¨æŸä¸ªJVMå‚æ•°ï¼Œåœ¨å®¹å™¨é‡Œå°±ä¸å¥½ä½¿äº†ï¼Ÿ ä¸ºä»€ä¹ˆkuberneteså°±ä¸èƒ½å›ºå®šIPåœ°å€ï¼Ÿå®¹å™¨ç½‘ç»œè”ä¸é€šåˆè¯¥å¦‚ä½•å»debugï¼Ÿ Kubernetesä¸­çš„StatefulSetå’ŒOperatoråˆ°åº•ä»€ä¹ˆåŒºåˆ«ï¼ŸPCå’ŒPVCè¿™äº›æ¦‚å¿µåˆè¯¥æ€ä¹ˆç”¨ï¼Ÿ Linuxè¿›ç¨‹æ¨¡å‹å¯¹å®¹å™¨æœ¬èº«çš„é‡è¦æ„ä¹‰ï¼Œæ§åˆ¶å™¨æ¨¡å¼å¯¹æ•´ä¸ªK8sé¡¹ç›®æçº²æŒˆé¢†çš„ä½œç”¨ï¼Ÿ ä»PaaSåˆ°K8s PaaS PaaS(Platform as a Service) åº”ç”¨æ‰˜ç®¡ã€‚\nDockeré•œåƒï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç›´æ¥ç”±ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿçš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•æ„æˆã€‚\nå…¶å®åªæ‰“åŒ…äº†æ–‡ä»¶ç³»ç»Ÿï¼Œä¸åŒ…æ‹¬æ“ä½œç³»ç»Ÿçš„å†…æ ¸ã€‚å„ç§å†…æ ¸ç›¸å…³çš„æ¨¡å—æˆ–è€…ç‰¹æ€§æ”¯æŒå®Œå…¨ä¾èµ–äºå®¿ä¸»æœºã€‚\né€šè¿‡docker build æ‰“åŒ…é•œåƒï¼Œdocker run è¿è¡Œé•œåƒï¼Œdocker runåˆ›å»ºçš„æ²™ç›’ï¼Œå°±æ˜¯ä½¿ç”¨Linux Cgroupså’ŒNamespaceæœºåˆ¶åˆ›å»ºå‡ºæ¥çš„éš”ç¦»ç¯å¢ƒã€‚è§£å†³äº†åº”ç”¨æ‰“åŒ…è¿™ä¸ªæ ¹æœ¬æ€§é—®é¢˜ã€‚\nSwarm swarm æä¾›é›†ç¾¤ç®¡ç†åŠŸèƒ½\nå•æœºdockeré¡¹ç›®\n1docker run \u0026lt;container-name\u0026gt; å¤šæœºdockeré¡¹ç›®\n1docker run -H \u0026#39;swarm cluster API\u0026#39; \u0026lt;container-name\u0026gt;\tFig é¡¹ç›® Figé¡¹ç›®ç¬¬ä¸€æ¬¡åœ¨å¼€å‘è€…é¢å‰æå‡ºäº†å®¹å™¨ç¼–æ’(Container Orchestration)çš„æ¦‚å¿µã€‚\nåŠ å…¥ç”¨æˆ·ç°åœ¨éœ€è¦éƒ¨ç½²çš„æ˜¯åº”ç”¨å®¹å™¨Aã€æ•°æ®åº“å®¹å™¨Bã€è´Ÿè½½å‡è¡¡å®¹å™¨Cï¼Œé‚£ä¹ˆFigå°±å…è®¸ç”¨æˆ·æŠŠABCä¸‰ä¸ªå®¹å™¨å®šä¹‰åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œ å¹¶ä¸”å¯ä»¥æŒ‡å®šä»–ä»¬ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œæ¯”å¦‚å®¹å™¨Aéœ€è¦è®¿é—®æ•°æ®åº“Bã€‚å®šä¹‰å¥½ä¹‹åï¼Œåªéœ€è¦æ‰§è¡Œä¸€æ¡éå¸¸ç®€å•çš„æŒ‡ä»¤ã€‚\n1fig up Figå°±ä¼šæŠŠè¿™äº›å®¹å™¨çš„å®šä¹‰å’Œé…ç½®äº¤ç»™DockerAPIæŒ‰ç…§è®¿é—®é€»è¾‘ä¸€æ¬¡åˆ›å»ºã€‚è€Œå®¹å™¨Aå’ŒBä¹‹é—´çš„å…³è”å…³ç³»ï¼Œä¹Ÿä¼šäº¤ç»™dockerçš„LinkåŠŸèƒ½é€šè¿‡å†™å…¥hostsæ–‡ä»¶çš„æ–¹å¼è¿›è¡Œé…ç½®ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä½ è¿˜å¯ä»¥åœ¨Figçš„é…ç½®æ–‡ä»¶é‡Œå®šä¹‰å„ç§å®¹å™¨çš„å‰¯æœ¬ä¸ªæ•°ç­‰ç¼–æ’å‚æ•°ã€‚\nFig é¡¹ç›®è¢«Dockeræ”¶è´­åæ›´åä¸ºComposeã€‚\nLibcontainer LibContainer -\u0026gt; RunC\nä»¥RunCä¸ºä¾æ®ï¼Œåˆ¶å®šå®¹å™¨å’Œé•œåƒçš„æ ‡å‡†å’Œè§„èŒƒã€‚\nOCI(Open Container Initiative), æ„åœ¨å°†å®¹å™¨è¿è¡Œæ—¶å’Œé•œåƒçš„å®ç°ä»Dockeré¡¹ç›®ä¸­å®Œå…¨å‰¥ç¦»å‡ºæ¥ã€‚\nContainerd å®¹å™¨è¿è¡Œæ—¶\nè¿›ç¨‹éš”ç¦»ä¸é™åˆ¶ ç¨‹åºè¢«æ‰§è¡Œèµ·æ¥ï¼Œå®ƒå°±ä»ç£ç›˜ä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå˜æˆäº†è®¡ç®—æœº å†…å­˜ä¸­çš„æ•°æ®ï¼Œå¯„å­˜å™¨é‡Œçš„å€¼ï¼Œå †æ ˆä¸­çš„æŒ‡ä»¤ã€è¢«æ‰“å¼€çš„æ–‡ä»¶ï¼Œä»¥åŠå„ç§è®¾å¤‡çš„çŠ¶æ€ä¿¡æ¯çš„ä¸€ä¸ªé›†åˆã€‚åƒè¿™æ ·ä¸€ä¸ªç¨‹åºè¿è¡Œèµ·æ¥åçš„è®¡ç®—æœºæ‰§è¡Œç¯å¢ƒçš„æ€»å’Œï¼Œå°±æ˜¯ï¼šè¿›ç¨‹ã€‚\nå¯¹äºè¿›ç¨‹æ¥è¯´ï¼Œå®ƒçš„é™æ€è¡¨ç°å°±æ˜¯ç¨‹åºï¼Œä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼›è€Œä¸€æ—¦è¿è¡Œèµ·æ¥ï¼Œå°±å˜æˆäº†è®¡ç®—æœºæ•°æ®å’ŒçŠ¶æ€çš„æ€»å’Œï¼Œè¿™å°±æ˜¯è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ã€‚\nå®¹å™¨æŠ€æœ¯çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯é€šè¿‡çº¦æŸå’Œä¿®æ”¹è¿›ç¨‹çš„åŠ¨æ€è¡¨ç°ï¼Œä»è€Œä¸ºå…¶åˆ›é€ å‡ºä¸€ä¸ªâ€œè¾¹ç•Œâ€ã€‚å¯¹äºå¤§å¤šæ•°Linuxå®¹å™¨æ¥è¯´ï¼Œ Cgroupsæ˜¯ç”¨æ¥åˆ¶é€ çº¦æŸçš„ä¸»è¦æ‰‹æ®µï¼Œ è€ŒNamespaceæŠ€æœ¯åˆ™æ˜¯ç”¨æ¥ä¿®æ”¹è¿›ç¨‹è§†å›¾çš„ä¸»è¦æ–¹æ³•ã€‚\néš”ç¦» 1docker run -it busybox /bin/sh What is BusyBox?","tags":null,"title":"å®¹å™¨æŠ€æœ¯åŸºç¡€"},{"categories":null,"contents":"Important Doc\nContributor Cheat Sheet åŠ å…¥SIG SIG(Special Interest Groups) æ˜¯Kubernetesç¤¾åŒºä¸­å…³æ³¨ç‰¹å®šæ¨¡å—çš„æ°¸ä¹…ç»„ç»‡ã€‚\nä½œä¸ºåˆšå‚ä¸ç¤¾åŒºçš„å¼€å‘è€…ï¼Œå¯ä»¥ä»sig/app, sig/node, sig/scheduling è¿™å‡ ä¸ªSIGå¼€å§‹ã€‚\nKEP KEP(Kubernetes Enhancement Proposal)ã€‚å¯¹äºåŠŸèƒ½å’ŒAPIçš„ä¿®æ”¹éƒ½éœ€è¦å…ˆåœ¨kubernetes/enhancementsä»“åº“å¯¹åº”SIGçš„ç›®å½•ä¸‹æäº¤Proposalæ‰èƒ½å®æ–½ã€‚æ‰€æœ‰çš„Proposaléƒ½å¿…é¡»ç»è¿‡è®¨è®ºï¼Œé€šè¿‡ç¤¾åŒºSIG Leaderçš„æ‰¹å‡†ã€‚\nå¾ˆå¤šä¸ç†Ÿæ‚‰Kuberneteså·¥ä½œæµçš„å¼€å‘è€…ä¼šåœ¨ç¤¾åŒºä¸­ç›´æ¥æäº¤ä¸€ä¸ªåŒ…å«APIæ”¹åŠ¨çš„commitï¼Œä½†æ˜¯å¦‚æœè¿™ç±»commitæ²¡æœ‰å¯¹åº”çš„KEP æ˜¯ä¸ä¼šè¢«ç¤¾åŒºåˆå…¥çš„ã€‚\né¡¹ç›®è®¾è®¡ æ‰€æœ‰è¿›å…¥å¼€å‘çŠ¶æ€çš„åŠŸèƒ½éƒ½ä¼šæœ‰ä¸€ä¸ªéå¸¸è¯¦ç»†çš„KEPã€‚KEPæœ‰ä¸€ä¸ªè¯¦ç»†çš„æ¨¡æ¿ï¼Œè®¾è®¡æ˜¯éå¸¸è§„èŒƒçš„ã€‚æˆ‘ä»¬å†æ—¥å¸¸çš„å¼€å‘ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ ¼å¼å†™è®¾è®¡æ–‡æ¡£æˆ–è€…æŠ€æœ¯æ–‡æ¡£ã€‚\næœ€è¿‘å‡ å¹´æ–°å®ç°çš„åŠŸèƒ½éƒ½ä¼šæœ‰ç€æ¯”è¾ƒè¯¦ç»†çš„KEPæ–‡æ¡£\nåˆ†å¸ƒå¼åä½œ Kubernetes ä¸­æ‰€æœ‰çš„ç¤¾åŒºä¼šè®®éƒ½ä¼šä½¿ç”¨Zoomå½•åˆ¶ï¼Œå¹¶ä¸Šä¼ åˆ°Youtubeã€‚å¤§å¤šæ•°çš„è®¨è®ºå’Œäº¤æµä¹Ÿå¯¹ä¼šå†å¯¹åº”çš„issueå’ŒPRä¸­ã€‚\næ¯ä¸ªæäº¤çš„PRéƒ½è¦é€šè¿‡2Kä»¥ä¸Šçš„æˆå‘˜çš„reviewä»¥åŠå‡ åƒä¸ªå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç«¯åˆ°ç«¯æµ‹è¯•ä»¥åŠæ‰©å±•æ€§æµ‹è¯•ï¼Œè¿™äº›æµ‹å®šå…±åŒä¿è¯äº†é¡¹ç›®çš„ç¨³å®šæ€§ã€‚\nkubernetes/test-infra é¡¹ç›®ä¸­åŒ…å«äº†Kubernetesçš„æµ‹è¯•åŸºç¡€é…ç½®ã€‚ å¾ˆå¤šç«¯åˆ°ç«¯çš„æµ‹è¯•éƒ½ä¼šå¯åŠ¨Kubernetesé›†ç¾¤ï¼Œå¹¶åœ¨çœŸå®çš„ç¯å¢ƒä¸­æµ‹è¯•ä»£ç çš„é€»è¾‘ï¼Œè¿™äº›æµ‹è¯•å¯èƒ½ä¸€æ¬¡ä¼šæ‰§è¡Œå‡ ååˆ†é’Ÿï¼Œå¹¶ä¸”æœ‰ä¸€å®šæ¦‚ç‡å‡ºç°Flakyã€‚\nå½±å“åŠ› æé«˜ä¸ªäººå’Œå…¬å¸åœ¨å¼€æºç¤¾åŒºçš„å½±å“åŠ›ï¼Œä¹Ÿæ˜¯å‚ä¸ç¤¾åŒºçš„é‡è¦ç›®çš„ã€‚\nå¯¹ä¸ªäººæ¥è¯´ï¼Œå‚ä¸å¼€æºé¡¹ç›®å¯ä»¥å¿«é€Ÿç†è§£é¡¹ç›®çš„å®ç°åŸç†ä»¥åŠå·¥ä½œæµç¨‹ã€‚å¦‚æœæƒ³è¦åœ¨æœªæ¥ä»äº‹ç›¸å…³çš„å·¥ä½œï¼Œå‚ä¸å¼€æºé¡¹ç›®ä¸€å®šæ˜¯åŠ åˆ†é¡¹ã€‚\nå¯¹å…¬å¸æ¥è¯´ï¼Œå‚ä¸å¼€æºé¡¹ç›®å¯ä»¥æé«˜å…¬å¸åœ¨å¼€æºç¤¾åŒºçš„è¯è¯­æƒï¼Œæé«˜å…¬å¸çš„æŠ€æœ¯å½±å“åŠ›ã€‚è¶³å¤Ÿçš„è¯è¯­æƒä¹Ÿä¼šè®©å¼€æºç¤¾åŒºåœ¨å…³é”®éœ€æ±‚ä¸Šæœ‰è¾ƒå¿«çš„æ”¯æŒï¼Œå‡å°‘ä¸ç¤¾åŒºä»£ç çš„åˆ†å‰ï¼Œé™ä½ç»´æŠ¤æˆæœ¬ï¼Œå¹¶æ»¡è¶³å…¬å¸å†…éƒ¨çš„éœ€æ±‚ã€‚\næ“ä½œæŒ‡å— å‚ä¸å¼€æºé¡¹ç›®å¹¶ä¸ä¸€å®šè¦ä»éå¸¸å¤æ‚çš„åŠŸèƒ½æˆ–è€…Proposalå¼€å§‹ã€‚ä»»ä½•ä¸€ä¸ªå¯¹ä»£ç åº“æœ‰åˆ©çš„PRéƒ½æ˜¯å€¼å¾—æäº¤çš„ã€‚ä¿®å¤ä»£ç ä¸­çš„typo æˆ–è€…é™æ€æ£€æŸ¥é”™è¯¯ï¼Œä½œä¸ºæœ€å¼€å§‹çš„å·¥ä½œæ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚è¿™èƒ½å¤Ÿå¸®æˆ‘ä»¬å¿«é€Ÿçƒ­èº«ã€‚ä¸è¿‡åœ¨ç†Ÿæ‚‰äº†kubernetesçš„æäº¤æµç¨‹ä¹‹åå°±æ²¡æœ‰å¿…è¦åšç±»ä¼¼çš„æäº¤äº†ï¼Œä»¥ä¸ºæ‰€æœ‰çš„æäº¤éƒ½éœ€è¦Reviewerå’ŒApproverçš„æ‰¹å‡†ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½çš„åšæœ‰æ„ä¹‰çš„å˜åŠ¨ï¼Œå‡å°‘ä»–ä»¬çš„å·¥ä½œé‡ã€‚\nä»é˜…è¯»æºç å¼€å§‹ æˆ‘ä»¬å¯ä»¥ä»è‡ªå·±ç†Ÿæ‚‰çš„æ¨¡å—å…¥æ‰‹ï¼Œäº†è§£è¯¥æ¨¡å—çš„å®ç°åŸç†ï¼Œåœ¨é˜…è¯»ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°æºä»£ç ä¸­çš„ä¸€äº›typoå’Œç¼ºé™·ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æäº¤PRä¿®å¤è¿™äº›é—®é¢˜ã€‚\nä»é™æ€æ£€æŸ¥å¼€å§‹ .golint_failures æ–‡ä»¶ä¸­å¿½ç•¥äº†å‡ ç™¾ä¸ªPackageä¸­çš„é™æ€æ£€æŸ¥ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­é€‰æ‹©åˆé€‚çš„Packageä½œä¸ºæˆä¸ºKubernetesè´¡çŒ®è€…çš„è€Œç¬¬ä¸€æ­¥ã€‚\nä»é¡¹ç›®ç®¡ç†å¼€å§‹ ä¹Ÿå¯ä»¥é€‰æ‹©Kubernetesçš„é¡¹ç›®ç®¡ç†ï¼Œ sig/release.\né€‰å–ç¬¬ä¸€ä¸ªkubernetesé—®é¢˜ issue åˆ—è¡¨\nä½¿ç”¨tagè¿‡æ»¤é—®é¢˜ â€œgood first issueâ€ â€œhelp wantedâ€ è¿™äº›æ ‡ç­¾è¡¨æ˜äº†å¯¹æ–°æ‰‹éå¸¸å‹å¥½ã€‚æœ‰æ—¶å€™é—®é¢˜ä¹Ÿä¼šè¢«æ‰“ä¸Šé”™è¯¯æ ‡ç­¾ï¼Œä¹Ÿè®¸æ˜¯æŠ€æœ¯éš¾åº¦è¢«ä½ä¼°äº†ã€‚\nTODO æœç´¢ä»£ç åº“é‡Œçš„TODOã€‚\nGo è¯­è¨€çš„å¼€å‘è§„èŒƒã€åˆ†å¸ƒå¼ç¤¾åŒºçš„æ²»ç†æ–¹å¼\nä»£ç éœ€è¦æ¯å¤©éƒ½çœ‹ï¼Œç•™å‡ºä¸“é—¨çš„æ—¶é—´æ¥æŸ¥çœ‹Kubernetesçš„æºç ï¼Œå¯¹å®ƒçš„æ ¸å¿ƒç»„ä»¶çš„å®ç°çœ‹çœ‹ï¼Œæ„å»ºä¸€ä¸‹, æµ‹è¯•ä¸€ä¸‹ï¼Œä¿®ä¸€ä¸‹Bugï¼Œtypoç­‰ã€‚\nä¸€èˆ¬åŠå¹´ä¹‹åï¼Œä½ å°±å¯ä»¥ç†Ÿæ‚‰åŸºç¡€é¡¹ç›®ï¼Œå¹¶ä¸”å¼€å§‹è´¡çŒ®ä»£ç ã€‚\nå½“ä½ å·²ç»å’Œå›¢é˜Ÿåä½œçš„å¾ˆç†Ÿæ‚‰ï¼Œå°±ä¼šè‡ªç„¶æ‰¿æ¥ä¸€äº›å­ä»»åŠ¡ï¼Œç„¶åå›¢é˜Ÿå°±ä¼šèµ‹äºˆä½ å†™çš„æƒé™ï¼Œè¿™æ ·å°±å¯ä»¥é¡ºç†æˆç« çš„æˆä¸ºKubernetesçš„committerã€‚è¿™ä¸ªæ—¶å€™ä½ å°±æ˜¯è¿™ä¸ªå­é¡¹ç›®çš„maintaineräº†\nTODO åŠ å…¥ Kubenetes Slack Channle åŠ å…¥é‚®ä»¶åˆ—è¡¨ åŠ å…¥SIG å‚åŠ ç¤¾åŒºä¼šè®® æissue å¦‚ä½•æäº¤PR\nhttps://segmentfault.com/a/1190000040437510\nBranch Strategy Fork K8s æºç ï¼Œ å¹¶ä»è‡ªå·±çš„ä»“åº“ä¸­cloneåˆ°æœ¬åœ°ã€‚è®¾ç½®Upstreamï¼Œ è·Ÿè¸ªK8sæºç çš„æ›´æ–°\nKubernetes Project ä½¿ç”¨æ ‡å‡†çš„Github \u0026ldquo;Fork and Pull\u0026rdquo; workflowã€‚åœ¨gitä¸­ï¼Œä¸ªäººForkçš„ä»“åº“åº”è¯¥è®¾ç½®ä¸º\u0026quot;origin\u0026quot;, è€ŒåŸå§‹é¡¹ç›®çš„ä»“åº“æˆä¸º\u0026quot;upstream\u0026quot;ã€‚ä¸ºäº†ä¿è¯ä¸ªäººåˆ†æ”¯(origin)å’Œä¸Šæ¸¸(upstream)æ›´æ–°ä¿æŒä¸€è‡´ï¼Œéœ€è¦åœ¨ä½ çš„æœ¬åœ°ä»“åº“ä¸­å®Œæˆä»¥ä¸‹è®¾ç½®ã€‚\nAdding Upstream å¢åŠ upstream ä½œä¸ºä¸€ä¸ªremoteï¼Œå¹¶ä¸”é…ç½®ä¸ºä¸å¯ä»¥pushã€‚\n1git remote add upstream https://github.com/kubernetes/kubernetes.git 2git remote set-url --push upstream no_push è®¾ç½®å®Œæˆåå¯ä»¥é€šè¿‡git remote -v æ£€æŸ¥remoteçš„é…ç½®æƒ…å†µã€‚\nKeeping Your Fork in sync Fetch all the changes from upstream and \u0026ldquo;rebase\u0026rdquo; them on your local master branch. è¿™å°†ä¿è¯ä½ çš„æœ¬åœ°ä»“åº“ä¸ä¸Šæ¸¸é¡¹ç›®ä¿æŒåŒæ­¥ã€‚Push the local changes to your remote master.\n1git fetch upstream 2git checkout master 3git rebase upstream/master 4git push You should do this minimally before creating a new branch to work on you feature or fix.\n1git checkout -b myfeature Squashing Commits The main purpose of squashing commits is to create a clean readable git history or log of the changes that were made. Usually this is done is last phase of a PR revision. If you are unsure if you should squash your commits, it its better to err on the side of having more and leave it up to the judgement of the other contributors assigned to review and approve your PR.\nPerform an interactive rebase to choose which commits you want to keep and which you want to squash, then force push your branch:\n1# git rebase -i \u0026lt;commit id\u0026gt; 2git rebase -i HEAD~3 3 4# git push -f 5git push --force Build K8s source code 1apt install rsync gcc make Reference\nhttps://www.zhihu.com/question/372403348\nhttps://draveness.me/kubernetes-contributor/\nhttps://cloud.tencent.com/developer/article/1539308\nhttps://aws.amazon.com/cn/blogs/opensource/newbies-guide-to-kubernetes/\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/kubernetes/k8s_dev_0_contributer/","summary":"Important Doc\nContributor Cheat Sheet åŠ å…¥SIG SIG(Special Interest Groups) æ˜¯Kubernetesç¤¾åŒºä¸­å…³æ³¨ç‰¹å®šæ¨¡å—çš„æ°¸ä¹…ç»„ç»‡ã€‚\nä½œä¸ºåˆšå‚ä¸ç¤¾åŒºçš„å¼€å‘è€…ï¼Œå¯ä»¥ä»sig/app, sig/node, sig/scheduling è¿™å‡ ä¸ªSIGå¼€å§‹ã€‚\nKEP KEP(Kubernetes Enhancement Proposal)ã€‚å¯¹äºåŠŸèƒ½å’ŒAPIçš„ä¿®æ”¹éƒ½éœ€è¦å…ˆåœ¨kubernetes/enhancementsä»“åº“å¯¹åº”SIGçš„ç›®å½•ä¸‹æäº¤Proposalæ‰èƒ½å®æ–½ã€‚æ‰€æœ‰çš„Proposaléƒ½å¿…é¡»ç»è¿‡è®¨è®ºï¼Œé€šè¿‡ç¤¾åŒºSIG Leaderçš„æ‰¹å‡†ã€‚\nå¾ˆå¤šä¸ç†Ÿæ‚‰Kuberneteså·¥ä½œæµçš„å¼€å‘è€…ä¼šåœ¨ç¤¾åŒºä¸­ç›´æ¥æäº¤ä¸€ä¸ªåŒ…å«APIæ”¹åŠ¨çš„commitï¼Œä½†æ˜¯å¦‚æœè¿™ç±»commitæ²¡æœ‰å¯¹åº”çš„KEP æ˜¯ä¸ä¼šè¢«ç¤¾åŒºåˆå…¥çš„ã€‚\né¡¹ç›®è®¾è®¡ æ‰€æœ‰è¿›å…¥å¼€å‘çŠ¶æ€çš„åŠŸèƒ½éƒ½ä¼šæœ‰ä¸€ä¸ªéå¸¸è¯¦ç»†çš„KEPã€‚KEPæœ‰ä¸€ä¸ªè¯¦ç»†çš„æ¨¡æ¿ï¼Œè®¾è®¡æ˜¯éå¸¸è§„èŒƒçš„ã€‚æˆ‘ä»¬å†æ—¥å¸¸çš„å¼€å‘ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ ¼å¼å†™è®¾è®¡æ–‡æ¡£æˆ–è€…æŠ€æœ¯æ–‡æ¡£ã€‚\næœ€è¿‘å‡ å¹´æ–°å®ç°çš„åŠŸèƒ½éƒ½ä¼šæœ‰ç€æ¯”è¾ƒè¯¦ç»†çš„KEPæ–‡æ¡£\nåˆ†å¸ƒå¼åä½œ Kubernetes ä¸­æ‰€æœ‰çš„ç¤¾åŒºä¼šè®®éƒ½ä¼šä½¿ç”¨Zoomå½•åˆ¶ï¼Œå¹¶ä¸Šä¼ åˆ°Youtubeã€‚å¤§å¤šæ•°çš„è®¨è®ºå’Œäº¤æµä¹Ÿå¯¹ä¼šå†å¯¹åº”çš„issueå’ŒPRä¸­ã€‚\næ¯ä¸ªæäº¤çš„PRéƒ½è¦é€šè¿‡2Kä»¥ä¸Šçš„æˆå‘˜çš„reviewä»¥åŠå‡ åƒä¸ªå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç«¯åˆ°ç«¯æµ‹è¯•ä»¥åŠæ‰©å±•æ€§æµ‹è¯•ï¼Œè¿™äº›æµ‹å®šå…±åŒä¿è¯äº†é¡¹ç›®çš„ç¨³å®šæ€§ã€‚\nkubernetes/test-infra é¡¹ç›®ä¸­åŒ…å«äº†Kubernetesçš„æµ‹è¯•åŸºç¡€é…ç½®ã€‚ å¾ˆå¤šç«¯åˆ°ç«¯çš„æµ‹è¯•éƒ½ä¼šå¯åŠ¨Kubernetesé›†ç¾¤ï¼Œå¹¶åœ¨çœŸå®çš„ç¯å¢ƒä¸­æµ‹è¯•ä»£ç çš„é€»è¾‘ï¼Œè¿™äº›æµ‹è¯•å¯èƒ½ä¸€æ¬¡ä¼šæ‰§è¡Œå‡ ååˆ†é’Ÿï¼Œå¹¶ä¸”æœ‰ä¸€å®šæ¦‚ç‡å‡ºç°Flakyã€‚\nå½±å“åŠ› æé«˜ä¸ªäººå’Œå…¬å¸åœ¨å¼€æºç¤¾åŒºçš„å½±å“åŠ›ï¼Œä¹Ÿæ˜¯å‚ä¸ç¤¾åŒºçš„é‡è¦ç›®çš„ã€‚\nå¯¹ä¸ªäººæ¥è¯´ï¼Œå‚ä¸å¼€æºé¡¹ç›®å¯ä»¥å¿«é€Ÿç†è§£é¡¹ç›®çš„å®ç°åŸç†ä»¥åŠå·¥ä½œæµç¨‹ã€‚å¦‚æœæƒ³è¦åœ¨æœªæ¥ä»äº‹ç›¸å…³çš„å·¥ä½œï¼Œå‚ä¸å¼€æºé¡¹ç›®ä¸€å®šæ˜¯åŠ åˆ†é¡¹ã€‚\nå¯¹å…¬å¸æ¥è¯´ï¼Œå‚ä¸å¼€æºé¡¹ç›®å¯ä»¥æé«˜å…¬å¸åœ¨å¼€æºç¤¾åŒºçš„è¯è¯­æƒï¼Œæé«˜å…¬å¸çš„æŠ€æœ¯å½±å“åŠ›ã€‚è¶³å¤Ÿçš„è¯è¯­æƒä¹Ÿä¼šè®©å¼€æºç¤¾åŒºåœ¨å…³é”®éœ€æ±‚ä¸Šæœ‰è¾ƒå¿«çš„æ”¯æŒï¼Œå‡å°‘ä¸ç¤¾åŒºä»£ç çš„åˆ†å‰ï¼Œé™ä½ç»´æŠ¤æˆæœ¬ï¼Œå¹¶æ»¡è¶³å…¬å¸å†…éƒ¨çš„éœ€æ±‚ã€‚\næ“ä½œæŒ‡å— å‚ä¸å¼€æºé¡¹ç›®å¹¶ä¸ä¸€å®šè¦ä»éå¸¸å¤æ‚çš„åŠŸèƒ½æˆ–è€…Proposalå¼€å§‹ã€‚ä»»ä½•ä¸€ä¸ªå¯¹ä»£ç åº“æœ‰åˆ©çš„PRéƒ½æ˜¯å€¼å¾—æäº¤çš„ã€‚ä¿®å¤ä»£ç ä¸­çš„typo æˆ–è€…é™æ€æ£€æŸ¥é”™è¯¯ï¼Œä½œä¸ºæœ€å¼€å§‹çš„å·¥ä½œæ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚è¿™èƒ½å¤Ÿå¸®æˆ‘ä»¬å¿«é€Ÿçƒ­èº«ã€‚ä¸è¿‡åœ¨ç†Ÿæ‚‰äº†kubernetesçš„æäº¤æµç¨‹ä¹‹åå°±æ²¡æœ‰å¿…è¦åšç±»ä¼¼çš„æäº¤äº†ï¼Œä»¥ä¸ºæ‰€æœ‰çš„æäº¤éƒ½éœ€è¦Reviewerå’ŒApproverçš„æ‰¹å‡†ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½çš„åšæœ‰æ„ä¹‰çš„å˜åŠ¨ï¼Œå‡å°‘ä»–ä»¬çš„å·¥ä½œé‡ã€‚\nä»é˜…è¯»æºç å¼€å§‹ æˆ‘ä»¬å¯ä»¥ä»è‡ªå·±ç†Ÿæ‚‰çš„æ¨¡å—å…¥æ‰‹ï¼Œäº†è§£è¯¥æ¨¡å—çš„å®ç°åŸç†ï¼Œåœ¨é˜…è¯»ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°æºä»£ç ä¸­çš„ä¸€äº›typoå’Œç¼ºé™·ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æäº¤PRä¿®å¤è¿™äº›é—®é¢˜ã€‚\nä»é™æ€æ£€æŸ¥å¼€å§‹ .golint_failures æ–‡ä»¶ä¸­å¿½ç•¥äº†å‡ ç™¾ä¸ªPackageä¸­çš„é™æ€æ£€æŸ¥ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­é€‰æ‹©åˆé€‚çš„Packageä½œä¸ºæˆä¸ºKubernetesè´¡çŒ®è€…çš„è€Œç¬¬ä¸€æ­¥ã€‚\nä»é¡¹ç›®ç®¡ç†å¼€å§‹ ä¹Ÿå¯ä»¥é€‰æ‹©Kubernetesçš„é¡¹ç›®ç®¡ç†ï¼Œ sig/release.\né€‰å–ç¬¬ä¸€ä¸ªkubernetesé—®é¢˜ issue åˆ—è¡¨\nä½¿ç”¨tagè¿‡æ»¤é—®é¢˜ â€œgood first issueâ€ â€œhelp wantedâ€ è¿™äº›æ ‡ç­¾è¡¨æ˜äº†å¯¹æ–°æ‰‹éå¸¸å‹å¥½ã€‚æœ‰æ—¶å€™é—®é¢˜ä¹Ÿä¼šè¢«æ‰“ä¸Šé”™è¯¯æ ‡ç­¾ï¼Œä¹Ÿè®¸æ˜¯æŠ€æœ¯éš¾åº¦è¢«ä½ä¼°äº†ã€‚\nTODO æœç´¢ä»£ç åº“é‡Œçš„TODOã€‚\nGo è¯­è¨€çš„å¼€å‘è§„èŒƒã€åˆ†å¸ƒå¼ç¤¾åŒºçš„æ²»ç†æ–¹å¼\nä»£ç éœ€è¦æ¯å¤©éƒ½çœ‹ï¼Œç•™å‡ºä¸“é—¨çš„æ—¶é—´æ¥æŸ¥çœ‹Kubernetesçš„æºç ï¼Œå¯¹å®ƒçš„æ ¸å¿ƒç»„ä»¶çš„å®ç°çœ‹çœ‹ï¼Œæ„å»ºä¸€ä¸‹, æµ‹è¯•ä¸€ä¸‹ï¼Œä¿®ä¸€ä¸‹Bugï¼Œtypoç­‰ã€‚\nä¸€èˆ¬åŠå¹´ä¹‹åï¼Œä½ å°±å¯ä»¥ç†Ÿæ‚‰åŸºç¡€é¡¹ç›®ï¼Œå¹¶ä¸”å¼€å§‹è´¡çŒ®ä»£ç ã€‚\nå½“ä½ å·²ç»å’Œå›¢é˜Ÿåä½œçš„å¾ˆç†Ÿæ‚‰ï¼Œå°±ä¼šè‡ªç„¶æ‰¿æ¥ä¸€äº›å­ä»»åŠ¡ï¼Œç„¶åå›¢é˜Ÿå°±ä¼šèµ‹äºˆä½ å†™çš„æƒé™ï¼Œè¿™æ ·å°±å¯ä»¥é¡ºç†æˆç« çš„æˆä¸ºKubernetesçš„committerã€‚è¿™ä¸ªæ—¶å€™ä½ å°±æ˜¯è¿™ä¸ªå­é¡¹ç›®çš„maintaineräº†\nTODO åŠ å…¥ Kubenetes Slack Channle åŠ å…¥é‚®ä»¶åˆ—è¡¨ åŠ å…¥SIG å‚åŠ ç¤¾åŒºä¼šè®® æissue å¦‚ä½•æäº¤PR","tags":null,"title":"æ€ä¹ˆæˆä¸ºK8sçš„Contributor"},{"categories":null,"contents":"å¾®æœåŠ¡æ¦‚è§ˆ åº·å¨å®šå¾‹\nYou build it. You fix it.\næŒ‰ç…§ä¸šåŠ¡ç»„ç»‡æœåŠ¡ã€‚\næŒ‰ç…§ä¸šåŠ¡èƒ½åŠ›ç»„ç»‡æœåŠ¡çš„æ„æ€æ˜¯\nå»ä¸­å¿ƒåŒ– æ•°æ®å»ä¸­å¿ƒåŒ– éš”ç¦»æ€§ï¼š æ¯ä¸ªæœåŠ¡è¦ç‹¬äº«è‡ªå·±çš„å­˜å‚¨è®¾ç½®ã€‚ æ²»ç†å»ä¸­å¿ƒåŒ– è´¦å·æœåŠ¡ æœåŠ¡å‘ç° æŠ€æœ¯å»ä¸­å¿ƒåŒ– æ”¶æ•›è¯­è¨€ï¼Œgo, C++ åŸºç¡€è®¾ç½®è‡ªåŠ¨åŒ– CICD\nPrometheus/ELK/Control Panle\nå¯ç”¨æ€§\u0026amp;å…¼å®¹æ€§è®¾è®¡ Design for Failureï¼Œæ‰€æœ‰çš„ä¾èµ–éƒ½å¯èƒ½ä¼šç‚¸ï¼Œæ‰€æœ‰å¯èƒ½å‡ºç°errçš„åœ°æ–¹éƒ½å¯èƒ½å‡ºç°panicã€‚\néš”ç¦» è¶…æ—¶æ§åˆ¶ è´Ÿè½½ä¿æŠ¤ é™æµ é™çº§ é‡è¯• è´Ÿè½½å‡è¡¡ å¾®æœåŠ¡è®¾è®¡ API Gateway APIç‰ˆæœ¬å‡çº§ï¼Œå¼ºè€¦åˆ\né¢å‘ç”¨æˆ·çš„ä¸šåŠ¡åœºæ™¯çš„APIï¼Œè€Œä¸æ˜¯é¢å‘èµ„æºçš„API\u0026ndash; å‰è½»åé‡\nå®‰å…¨è®¤è¯ï¼Œé™æµ\ngRPC \u0026amp; æœåŠ¡å‘ç° ç¬¬6è¯¾ è¯„è®ºç³»ç»Ÿæ¶æ„è®¾è®¡ https://github.com/go-kratos\nåŠŸèƒ½æ¨¡å— ç†è§£æ•´ä¸ªèƒŒåçš„ä¸šåŠ¡é€»è¾‘ï¼Œç†è§£ä¸šåŠ¡çš„æœ¬è´¨ï¼Œäº‹æƒ…çš„åˆè¡·ã€‚ææ¸…æ¥šç³»ç»ŸèƒŒåçš„èƒŒæ™¯ï¼Œæ‰èƒ½åšå‡ºæœ€ä½³çš„æŠ½è±¡å’Œè®¾è®¡ã€‚\nåœ¨åŠ¨æ‰‹è®¾è®¡å‰åå¤æ€è€ƒï¼ŒçœŸæ­£ç¼–ç çš„æ—¶é—´åªæœ‰5%ï¼Ÿ\nä¸è¦åœ¨æƒ³çš„ä¸æ¸…ä¸æ¥šçš„æ—¶å€™åŠ¨æ‰‹ã€‚\nMysql: OLTP å¦‚æœæ˜¯group byç­‰è®¡ç®—å¯†é›†å‹æŸ¥è¯¢çš„å®¹æ˜“æŠŠæ•°æ®åº“æ‰“å®ã€‚\nBinlog ?\næ¶æ„è®¾è®¡ç­‰åŒäºæ•°æ®è®¾è®¡ï¼Œæ¢³ç†æ¸…æ¥šæ•°æ®çš„èµ°å‘å’Œé€»è¾‘ã€‚\nå°½é‡é¿å…ç¯å½¢ä¾èµ–ã€‚\nmalloc ç”³è¯·2Gçš„å†…å­˜ï¼Œæ˜¯å¦çœŸæ­£ç»‘å®šäº†2Gç‰©ç†å†…å­˜ã€‚\nä»€ä¹ˆæ˜¯ç¼ºé¡µä¸­æ–­ã€‚\næ¶æ„è®¾è®¡\nå­˜å‚¨è®¾è®¡\nå¯ç”¨æ€§è®¾è®¡\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/note_go/99_Go%E8%BF%9B%E9%98%B6%E8%AE%AD%E7%BB%83%E8%90%A5/","summary":"å¾®æœåŠ¡æ¦‚è§ˆ åº·å¨å®šå¾‹\nYou build it. You fix it.\næŒ‰ç…§ä¸šåŠ¡ç»„ç»‡æœåŠ¡ã€‚\næŒ‰ç…§ä¸šåŠ¡èƒ½åŠ›ç»„ç»‡æœåŠ¡çš„æ„æ€æ˜¯\nå»ä¸­å¿ƒåŒ– æ•°æ®å»ä¸­å¿ƒåŒ– éš”ç¦»æ€§ï¼š æ¯ä¸ªæœåŠ¡è¦ç‹¬äº«è‡ªå·±çš„å­˜å‚¨è®¾ç½®ã€‚ æ²»ç†å»ä¸­å¿ƒåŒ– è´¦å·æœåŠ¡ æœåŠ¡å‘ç° æŠ€æœ¯å»ä¸­å¿ƒåŒ– æ”¶æ•›è¯­è¨€ï¼Œgo, C++ åŸºç¡€è®¾ç½®è‡ªåŠ¨åŒ– CICD\nPrometheus/ELK/Control Panle\nå¯ç”¨æ€§\u0026amp;å…¼å®¹æ€§è®¾è®¡ Design for Failureï¼Œæ‰€æœ‰çš„ä¾èµ–éƒ½å¯èƒ½ä¼šç‚¸ï¼Œæ‰€æœ‰å¯èƒ½å‡ºç°errçš„åœ°æ–¹éƒ½å¯èƒ½å‡ºç°panicã€‚\néš”ç¦» è¶…æ—¶æ§åˆ¶ è´Ÿè½½ä¿æŠ¤ é™æµ é™çº§ é‡è¯• è´Ÿè½½å‡è¡¡ å¾®æœåŠ¡è®¾è®¡ API Gateway APIç‰ˆæœ¬å‡çº§ï¼Œå¼ºè€¦åˆ\né¢å‘ç”¨æˆ·çš„ä¸šåŠ¡åœºæ™¯çš„APIï¼Œè€Œä¸æ˜¯é¢å‘èµ„æºçš„API\u0026ndash; å‰è½»åé‡\nå®‰å…¨è®¤è¯ï¼Œé™æµ\ngRPC \u0026amp; æœåŠ¡å‘ç° ç¬¬6è¯¾ è¯„è®ºç³»ç»Ÿæ¶æ„è®¾è®¡ https://github.com/go-kratos\nåŠŸèƒ½æ¨¡å— ç†è§£æ•´ä¸ªèƒŒåçš„ä¸šåŠ¡é€»è¾‘ï¼Œç†è§£ä¸šåŠ¡çš„æœ¬è´¨ï¼Œäº‹æƒ…çš„åˆè¡·ã€‚ææ¸…æ¥šç³»ç»ŸèƒŒåçš„èƒŒæ™¯ï¼Œæ‰èƒ½åšå‡ºæœ€ä½³çš„æŠ½è±¡å’Œè®¾è®¡ã€‚\nåœ¨åŠ¨æ‰‹è®¾è®¡å‰åå¤æ€è€ƒï¼ŒçœŸæ­£ç¼–ç çš„æ—¶é—´åªæœ‰5%ï¼Ÿ\nä¸è¦åœ¨æƒ³çš„ä¸æ¸…ä¸æ¥šçš„æ—¶å€™åŠ¨æ‰‹ã€‚\nMysql: OLTP å¦‚æœæ˜¯group byç­‰è®¡ç®—å¯†é›†å‹æŸ¥è¯¢çš„å®¹æ˜“æŠŠæ•°æ®åº“æ‰“å®ã€‚\nBinlog ?\næ¶æ„è®¾è®¡ç­‰åŒäºæ•°æ®è®¾è®¡ï¼Œæ¢³ç†æ¸…æ¥šæ•°æ®çš„èµ°å‘å’Œé€»è¾‘ã€‚\nå°½é‡é¿å…ç¯å½¢ä¾èµ–ã€‚\nmalloc ç”³è¯·2Gçš„å†…å­˜ï¼Œæ˜¯å¦çœŸæ­£ç»‘å®šäº†2Gç‰©ç†å†…å­˜ã€‚\nä»€ä¹ˆæ˜¯ç¼ºé¡µä¸­æ–­ã€‚\næ¶æ„è®¾è®¡\nå­˜å‚¨è®¾è®¡\nå¯ç”¨æ€§è®¾è®¡","tags":null,"title":"æå®¢æ—¶é—´ GOå®è·µ"},{"categories":null,"contents":"å”Â·ç‹å‹ƒ\nâ€‹\tè±«ç« æ•…éƒ¡ï¼Œæ´ªéƒ½æ–°åºœã€‚æ˜Ÿåˆ†ç¿¼è½¸ï¼Œåœ°æ¥è¡¡åºã€‚è¥Ÿä¸‰æ±Ÿè€Œå¸¦äº”æ¹–ï¼Œæ§è›®è†è€Œå¼•ç“¯è¶Šã€‚ç‰©åå¤©å®ï¼Œé¾™å…‰å°„ç‰›æ–—ä¹‹å¢Ÿï¼›äººæ°åœ°çµï¼Œå¾å­ºä¸‹é™ˆè•ƒä¹‹æ¦»ã€‚é›„å·é›¾åˆ—ï¼Œä¿Šé‡‡æ˜Ÿé©°ã€‚å°éšæ•yixiazhij\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/life/silence/%E6%BB%95%E7%8E%8B%E9%98%81%E5%BA%8F/","summary":"å”Â·ç‹å‹ƒ\nâ€‹\tè±«ç« æ•…éƒ¡ï¼Œæ´ªéƒ½æ–°åºœã€‚æ˜Ÿåˆ†ç¿¼è½¸ï¼Œåœ°æ¥è¡¡åºã€‚è¥Ÿä¸‰æ±Ÿè€Œå¸¦äº”æ¹–ï¼Œæ§è›®è†è€Œå¼•ç“¯è¶Šã€‚ç‰©åå¤©å®ï¼Œé¾™å…‰å°„ç‰›æ–—ä¹‹å¢Ÿï¼›äººæ°åœ°çµï¼Œå¾å­ºä¸‹é™ˆè•ƒä¹‹æ¦»ã€‚é›„å·é›¾åˆ—ï¼Œä¿Šé‡‡æ˜Ÿé©°ã€‚å°éšæ•yixiazhij","tags":null,"title":"æ»•ç‹é˜åº"},{"categories":null,"contents":"ç­–ç•¥è·¯ç”± æ‰€æœ‰æ¥è‡ªç½‘ç»œAçš„åŒ…é€‰æ‹©Xè·¯å¾„ï¼Œå…¶ä»–é€‰æ‹©Yè·¯å¾„ã€‚æˆ–è€…è¯´æ‰€æœ‰TOSä¸ºAçš„åŒ…é€‰æ‹©è·¯å¾„F,å…¶ä»–é€‰æ‹©è·¯å¾„K.\nå¤šè¡¨è·¯ç”±ï¼ˆmultiple Routing Tablesï¼‰ ä¼ ç»Ÿçš„è·¯ç”±ç®—æ³•ä»…ä»…ä½¿ç”¨ä¸€å¼ è¡¨ï¼Œæœ‰äº›æƒ…å½¢ä¸‹æ˜¯éœ€è¦ä½¿ç”¨å¤šè·¯ç”±è¡¨çš„ã€‚\nè§„åˆ™ï¼ˆRuleï¼‰ æ‰€æœ‰æ¥è‡ª192.168.1.5çš„åŒ…ï¼Œä½¿ç”¨è·¯ç”±è¡¨10,æœ¬è§„åˆ™çš„ä¼˜å…ˆçº§æ˜¯990\næ‰€åˆ°åˆ°192.168.127.117çš„åŒ…ä½¿ç”¨è·¯ç”±è¡¨11, æœ¬è§„åˆ™çš„ä¼˜å…ˆçº§æ˜¯991ï¼›\nè§„åˆ™ä¸‰è¦ç´ \nä»€ä¹ˆæ ·çš„åŒ…åº”ç”¨æœ¬è§„åˆ™ ip route add å¢åŠ è·¯ç”±åˆ°æŒ‡å®šçš„è·¯ç”±è¡¨ï¼Œé»˜è®¤ä¸ºmainè¡¨\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/cloudnative/Linux/%E7%AD%96%E7%95%A5%E8%B7%AF%E7%94%B1/","summary":"ç­–ç•¥è·¯ç”± æ‰€æœ‰æ¥è‡ªç½‘ç»œAçš„åŒ…é€‰æ‹©Xè·¯å¾„ï¼Œå…¶ä»–é€‰æ‹©Yè·¯å¾„ã€‚æˆ–è€…è¯´æ‰€æœ‰TOSä¸ºAçš„åŒ…é€‰æ‹©è·¯å¾„F,å…¶ä»–é€‰æ‹©è·¯å¾„K.\nå¤šè¡¨è·¯ç”±ï¼ˆmultiple Routing Tablesï¼‰ ä¼ ç»Ÿçš„è·¯ç”±ç®—æ³•ä»…ä»…ä½¿ç”¨ä¸€å¼ è¡¨ï¼Œæœ‰äº›æƒ…å½¢ä¸‹æ˜¯éœ€è¦ä½¿ç”¨å¤šè·¯ç”±è¡¨çš„ã€‚\nè§„åˆ™ï¼ˆRuleï¼‰ æ‰€æœ‰æ¥è‡ª192.168.1.5çš„åŒ…ï¼Œä½¿ç”¨è·¯ç”±è¡¨10,æœ¬è§„åˆ™çš„ä¼˜å…ˆçº§æ˜¯990\næ‰€åˆ°åˆ°192.168.127.117çš„åŒ…ä½¿ç”¨è·¯ç”±è¡¨11, æœ¬è§„åˆ™çš„ä¼˜å…ˆçº§æ˜¯991ï¼›\nè§„åˆ™ä¸‰è¦ç´ \nä»€ä¹ˆæ ·çš„åŒ…åº”ç”¨æœ¬è§„åˆ™ ip route add å¢åŠ è·¯ç”±åˆ°æŒ‡å®šçš„è·¯ç”±è¡¨ï¼Œé»˜è®¤ä¸ºmainè¡¨","tags":null,"title":"ç­–ç•¥è·¯ç”±"},{"categories":null,"contents":" è‡ªæ§åŠ›\nThe WillPower Instinct\nâ€œæ„å¿—åŠ›å­¦ç§‘â€è¿™é—¨è¯¾æ±‡é›†äº†å¿ƒç†å­¦ã€ç»æµå­¦ã€ç¥ç»å­¦ã€åŒ»å­¦é¢†åŸŸå…³äºè‡ªæ§çš„æœ€æ–°æ´è§ï¼Œå‘Šè¯‰äººä»¬å¦‚ä½•æ”¹å˜æ—§ä¹ æƒ¯ï¼ŒåŸ¹å…»å¥åº·çš„æ–°ä¹ æƒ¯ã€å…‹æœæ‹–å»¶ã€æŠ“ä½é‡ç‚¹ã€ç®¡ç†å‹åŠ›ã€‚é˜è¿°äº†ä¸ºä½•äººä»¬ä¼šåœ¨è¯±æƒ‘å‰å±ˆæœï¼Œä»¥åŠæ€æ ·æ‰èƒ½æŠµæŒ¡ä½è¯±æƒ‘ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æå‡ºäº†ç†è§£è‡ªæ§å±€é™çš„é‡è¦æ€§ï¼Œä»¥åŠåŸ¹å…»æ„å¿—åŠ›çš„æœ€ä½³å†³ç­–ã€‚\nå¯¹äºæ„å¿—åŠ›ç§‘å­¦çš„ç†è§£æœ‰åŠ©äºåŸ¹å…»è‡ªæ§åŠ›ï¼Œè®©äººä»¬æ›´æœ‰ç²¾åŠ›è¿½é€æœ€é‡è¦çš„ä¸œè¥¿ã€‚è‡ªæ§çš„ç­–ç•¥æœ‰åŠ©äºäººä»¬æŠµåˆ¶å„ç§å„æ ·çš„è¯±æƒ‘ã€‚\nä¸ºäº†æˆåŠŸåšåˆ°è‡ªæ§ï¼Œä½ å¿…é¡»çŸ¥é“è‡ªå·±ä¸ºä½•å¤±è´¥ æé«˜è‡ªæ§åŠ›çš„æœ€æœ‰æ•ˆé€”å¾„åœ¨äºï¼Œå¼„æ¸…è‡ªå·±å¦‚ä½•å¤±æ§ã€ä¸ºä½•å¤±æ§ã€‚æ„è¯†åˆ°è‡ªå·±æœ‰å¤šå®¹æ˜“å¤±æ§ï¼Œå¹¶éæ„å‘³ç€ä½ æ˜¯ä¸€ä¸ªå¤±è´¥è€…ã€‚æ°æ°ç›¸åï¼Œè¿™å°†æœ‰åŠ©äºä½ é¿å¼€æ„å¿—åŠ›å¤±æ•ˆçš„é™·é˜±ã€‚ç ”ç©¶è¡¨æ˜ï¼Œè‡ªè¯©ä¸ºæ„å¿—åšå®šçš„äººåè€Œæœ€å®¹æ˜“åœ¨è¯±æƒ‘é¢å‰å¤±æ§ã€‚å› ä¸ºä»–ä»¬æ— æ³•é¢„æµ‹è‡ªå·±åœ¨ä½•æ—¶ä½•åœ°ã€ä¼šç”±äºä½•ç§åŸå› å¤±æ§ã€‚ä»–ä»¬åœ¨é¢å¯¹æŒ«æŠ˜æ—¶æ›´å®¹æ˜“åƒæƒŠï¼Œåœ¨é™·å…¥å›°å¢ƒæ—¶æ›´å®¹æ˜“æ”¾å¼ƒã€‚\nè‡ªçŸ¥ä¹‹æ˜æ˜¯è‡ªæ§çš„åŸºç¡€ã€‚è®¤è¯†åˆ°è‡ªå·±æ„å¿—åŠ›å­˜åœ¨é—®é¢˜ï¼Œåˆ™æ˜¯è‡ªæ§çš„å…³é”®ã€‚\nå½“æˆ‘ä»¬å±ˆä»äºè¯±æƒ‘æˆ–è€…æ‹–ç€ä¸è¯¥åšçš„äº‹æ—¶ï¼Œæ˜¯ä»€ä¹ˆæ‹–äº†æˆ‘ä»¬çš„åè…¿ï¼Ÿæ˜¯å“ªäº›è‡´å‘½çš„é”™è¯¯ï¼Ÿæ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•å¯»æ‰¾æœºä¼šï¼Œé¿å…æ¥çŠ¯åŒæ ·çš„é”™è¯¯ã€‚æˆ‘ä»¬æ€æ ·ä»å¤±è´¥ä¸­æ±²å–ç»éªŒï¼Œä¸ºæˆåŠŸé“ºå¹³é“è·¯ï¼Ÿ\nè¿™äº›è¡Œä¸ºè™½ä¸å®Œç¾ï¼Œå´æ˜¯äººä¹‹å¸¸æ€ã€‚æ¯ä¸ªäººéƒ½åœ¨ä»¥æŸç§æ–¹å¼æŠµåˆ¶è¯±æƒ‘ã€ç™–å¥½ã€å¹²æ‰°å’Œæ‹–å»¶ã€‚è¿™ä¸æ˜¯ä¸ªä½“çš„å¼±ç‚¹æˆ–ä¸ªäººçš„ä¸è¶³ï¼Œè€Œæ˜¯æ™®éçš„ç»éªŒï¼Œæ˜¯äººæ‰€å…±æœ‰çš„çŠ¶æ€ã€‚\nç†è®ºå›ºç„¶å¥½ï¼Œä½†æ˜¯æ•°æ®æ›´é‡è¦ã€‚\næ²‰è¿·äºç”µè§†å‰§ä¸èƒ½è‡ªæ‹”\næ€»æ˜¯å¹»æƒ³æˆ–è€…å¸Œæœ›è‡ªå·±å’Œä¸»è§’å¤„äºåŒæ ·çš„çŠ¶æ€ï¼ŒåŒæ ·å¯ä»¥éšå¿ƒæ‰€æ¬²çš„å¤„ç†å„ç§å›°å¢ƒã€‚æ›´ä¸æƒ³è¿›ä¸€æ­¥æ‰“ç ´è‡ªå·±çš„å¹»æƒ³ï¼Œä¸æƒ³å›å½’ç°å®ã€‚å¯äº‹å®å´æ˜¯ï¼Œè¶Šæ²‰æµ¸äºå…¶ä¸­ï¼Œå´åˆè·ç¦»æ•…äº‹ä¸­çš„ä¸»è§’è¿œäº†ä¸€æ­¥ã€‚è¿™ä¸ªä¸–ç•Œä¸Šæœ‰å¤ªå¤šçœ‹ä¸å®Œçš„æ•…äº‹ï¼Œä¸æ˜¯æ¯ä¸ªæ•…äº‹éƒ½éœ€è¦å»è¯»ï¼Œé€‰æ‹©é‡è¦çš„ï¼Œé€‰æ‹©çœŸæ­£æœ‰æ„ä¹‰ï¼Œæœ‰è¥å…»çš„æ–‡åŒ–é¥•é¤®ã€‚\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/Book_WillPower/","summary":"è‡ªæ§åŠ›\nThe WillPower Instinct\nâ€œæ„å¿—åŠ›å­¦ç§‘â€è¿™é—¨è¯¾æ±‡é›†äº†å¿ƒç†å­¦ã€ç»æµå­¦ã€ç¥ç»å­¦ã€åŒ»å­¦é¢†åŸŸå…³äºè‡ªæ§çš„æœ€æ–°æ´è§ï¼Œå‘Šè¯‰äººä»¬å¦‚ä½•æ”¹å˜æ—§ä¹ æƒ¯ï¼ŒåŸ¹å…»å¥åº·çš„æ–°ä¹ æƒ¯ã€å…‹æœæ‹–å»¶ã€æŠ“ä½é‡ç‚¹ã€ç®¡ç†å‹åŠ›ã€‚é˜è¿°äº†ä¸ºä½•äººä»¬ä¼šåœ¨è¯±æƒ‘å‰å±ˆæœï¼Œä»¥åŠæ€æ ·æ‰èƒ½æŠµæŒ¡ä½è¯±æƒ‘ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æå‡ºäº†ç†è§£è‡ªæ§å±€é™çš„é‡è¦æ€§ï¼Œä»¥åŠåŸ¹å…»æ„å¿—åŠ›çš„æœ€ä½³å†³ç­–ã€‚\nå¯¹äºæ„å¿—åŠ›ç§‘å­¦çš„ç†è§£æœ‰åŠ©äºåŸ¹å…»è‡ªæ§åŠ›ï¼Œè®©äººä»¬æ›´æœ‰ç²¾åŠ›è¿½é€æœ€é‡è¦çš„ä¸œè¥¿ã€‚è‡ªæ§çš„ç­–ç•¥æœ‰åŠ©äºäººä»¬æŠµåˆ¶å„ç§å„æ ·çš„è¯±æƒ‘ã€‚\nä¸ºäº†æˆåŠŸåšåˆ°è‡ªæ§ï¼Œä½ å¿…é¡»çŸ¥é“è‡ªå·±ä¸ºä½•å¤±è´¥ æé«˜è‡ªæ§åŠ›çš„æœ€æœ‰æ•ˆé€”å¾„åœ¨äºï¼Œå¼„æ¸…è‡ªå·±å¦‚ä½•å¤±æ§ã€ä¸ºä½•å¤±æ§ã€‚æ„è¯†åˆ°è‡ªå·±æœ‰å¤šå®¹æ˜“å¤±æ§ï¼Œå¹¶éæ„å‘³ç€ä½ æ˜¯ä¸€ä¸ªå¤±è´¥è€…ã€‚æ°æ°ç›¸åï¼Œè¿™å°†æœ‰åŠ©äºä½ é¿å¼€æ„å¿—åŠ›å¤±æ•ˆçš„é™·é˜±ã€‚ç ”ç©¶è¡¨æ˜ï¼Œè‡ªè¯©ä¸ºæ„å¿—åšå®šçš„äººåè€Œæœ€å®¹æ˜“åœ¨è¯±æƒ‘é¢å‰å¤±æ§ã€‚å› ä¸ºä»–ä»¬æ— æ³•é¢„æµ‹è‡ªå·±åœ¨ä½•æ—¶ä½•åœ°ã€ä¼šç”±äºä½•ç§åŸå› å¤±æ§ã€‚ä»–ä»¬åœ¨é¢å¯¹æŒ«æŠ˜æ—¶æ›´å®¹æ˜“åƒæƒŠï¼Œåœ¨é™·å…¥å›°å¢ƒæ—¶æ›´å®¹æ˜“æ”¾å¼ƒã€‚\nè‡ªçŸ¥ä¹‹æ˜æ˜¯è‡ªæ§çš„åŸºç¡€ã€‚è®¤è¯†åˆ°è‡ªå·±æ„å¿—åŠ›å­˜åœ¨é—®é¢˜ï¼Œåˆ™æ˜¯è‡ªæ§çš„å…³é”®ã€‚\nå½“æˆ‘ä»¬å±ˆä»äºè¯±æƒ‘æˆ–è€…æ‹–ç€ä¸è¯¥åšçš„äº‹æ—¶ï¼Œæ˜¯ä»€ä¹ˆæ‹–äº†æˆ‘ä»¬çš„åè…¿ï¼Ÿæ˜¯å“ªäº›è‡´å‘½çš„é”™è¯¯ï¼Ÿæ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•å¯»æ‰¾æœºä¼šï¼Œé¿å…æ¥çŠ¯åŒæ ·çš„é”™è¯¯ã€‚æˆ‘ä»¬æ€æ ·ä»å¤±è´¥ä¸­æ±²å–ç»éªŒï¼Œä¸ºæˆåŠŸé“ºå¹³é“è·¯ï¼Ÿ\nè¿™äº›è¡Œä¸ºè™½ä¸å®Œç¾ï¼Œå´æ˜¯äººä¹‹å¸¸æ€ã€‚æ¯ä¸ªäººéƒ½åœ¨ä»¥æŸç§æ–¹å¼æŠµåˆ¶è¯±æƒ‘ã€ç™–å¥½ã€å¹²æ‰°å’Œæ‹–å»¶ã€‚è¿™ä¸æ˜¯ä¸ªä½“çš„å¼±ç‚¹æˆ–ä¸ªäººçš„ä¸è¶³ï¼Œè€Œæ˜¯æ™®éçš„ç»éªŒï¼Œæ˜¯äººæ‰€å…±æœ‰çš„çŠ¶æ€ã€‚\nç†è®ºå›ºç„¶å¥½ï¼Œä½†æ˜¯æ•°æ®æ›´é‡è¦ã€‚\næ²‰è¿·äºç”µè§†å‰§ä¸èƒ½è‡ªæ‹”\næ€»æ˜¯å¹»æƒ³æˆ–è€…å¸Œæœ›è‡ªå·±å’Œä¸»è§’å¤„äºåŒæ ·çš„çŠ¶æ€ï¼ŒåŒæ ·å¯ä»¥éšå¿ƒæ‰€æ¬²çš„å¤„ç†å„ç§å›°å¢ƒã€‚æ›´ä¸æƒ³è¿›ä¸€æ­¥æ‰“ç ´è‡ªå·±çš„å¹»æƒ³ï¼Œä¸æƒ³å›å½’ç°å®ã€‚å¯äº‹å®å´æ˜¯ï¼Œè¶Šæ²‰æµ¸äºå…¶ä¸­ï¼Œå´åˆè·ç¦»æ•…äº‹ä¸­çš„ä¸»è§’è¿œäº†ä¸€æ­¥ã€‚è¿™ä¸ªä¸–ç•Œä¸Šæœ‰å¤ªå¤šçœ‹ä¸å®Œçš„æ•…äº‹ï¼Œä¸æ˜¯æ¯ä¸ªæ•…äº‹éƒ½éœ€è¦å»è¯»ï¼Œé€‰æ‹©é‡è¦çš„ï¼Œé€‰æ‹©çœŸæ­£æœ‰æ„ä¹‰ï¼Œæœ‰è¥å…»çš„æ–‡åŒ–é¥•é¤®ã€‚","tags":null,"title":"è‡ªæ§åŠ›"},{"categories":null,"contents":"é«˜å¹¶å‘ï¼Œè´Ÿè½½å‡è¡¡ï¼Œé«˜å¯ç”¨\nä¸è¦å› ä¸ºæŠ€æœ¯è€ŒæŠ€æœ¯, è½¯ä»¶å·¥ç¨‹å­¦éœ€è¦åˆ†å±‚è§£è€¦\nåº”ç”¨å±‚ 1# $$ current process pid 2cd /proc/$$/fd 0 stdin\n1 stdout\n2 stderr\n1# 8 is the name of the file descriptor, \u0026lt;\u0026gt; in and out direction 2exec 8\u0026lt;\u0026gt; /dev/tcp/www.baidu.com/80 3# exec 8\u0026lt;\u0026amp; - 4# \u0026amp; represent the argument is a fd 5echo -e \u0026#34;GET / HTTP/1.0\\n\u0026#34; \u0026gt;\u0026amp; 8 ä¼ è¾“å±‚ ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://airren.github.io/posts/blog/high_concurrency_lb/","summary":"é«˜å¹¶å‘ï¼Œè´Ÿè½½å‡è¡¡ï¼Œé«˜å¯ç”¨\nä¸è¦å› ä¸ºæŠ€æœ¯è€ŒæŠ€æœ¯, è½¯ä»¶å·¥ç¨‹å­¦éœ€è¦åˆ†å±‚è§£è€¦\nåº”ç”¨å±‚ 1# $$ current process pid 2cd /proc/$$/fd 0 stdin\n1 stdout\n2 stderr\n1# 8 is the name of the file descriptor, \u0026lt;\u0026gt; in and out direction 2exec 8\u0026lt;\u0026gt; /dev/tcp/www.baidu.com/80 3# exec 8\u0026lt;\u0026amp; - 4# \u0026amp; represent the argument is a fd 5echo -e \u0026#34;GET / HTTP/1.0\\n\u0026#34; \u0026gt;\u0026amp; 8 ä¼ è¾“å±‚ ","tags":null,"title":"é«˜å¹¶å‘è´Ÿè½½å‡è¡¡"}]