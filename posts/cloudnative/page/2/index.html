<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>

<link rel="stylesheet" href="/css/flag-icon.min.css"/>


<link rel="stylesheet" href="/google-fonts/Mulish/mulish.css"/>


<link rel="stylesheet" href="/fontawesome/css/all.min.css"/>







  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/site/favicon_hufa9bb061875e5783d83b75135c052e0b_6105_42x0_resize_box_3.png" />

<meta property="og:title" content="" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://airren.github.io/posts/cloudnative/" />


    
    
    <link rel="stylesheet" href="/css/layouts/list.css">
    <link rel="stylesheet" href="/css/navigators/sidebar.css">
    
    <link rel="stylesheet" href="/css/style.css"/>



    




</head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      
        <img src="/images/site/main-logo_hue3dcebd3233f4247380b642debb20e00_8242_42x0_resize_box_3.png" alt="Logo">
      ByteGopher</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      
      </ul>
    </div>
  </div>
  
  
    <img src="/images/site/main-logo_hue3dcebd3233f4247380b642debb20e00_8242_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/site/inverted-logo_hu625a7b1b3d293b5088d5bed0b0ae5735_6060_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  
  
    
  

  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li><a class="" href="/posts/blog/" title="Blog">Blog</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/cloudnative/" title="CloudNative">CloudNative</a></li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/component/">Infrastructure</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/component/TimeSeries/" title="TimeSeriesDB">TimeSeriesDB</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/kubernetes/" title="Kubernetes">Kubernetes</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/note_c/" title="Note C">Note C</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/note_go/" title="Note Go">Note Go</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/react/" title="React">React</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/tips/" title="Tips">Tips</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/nodus/" title="Nodus">Nodus</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/interview/" title="Interview">Interview</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/life/" title="Life">Life</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/linux/" title="Linux">Linux</a></li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content container-fluid" id="content">
    <div class="container-fluid post-card-holder" id="post-card-holder">
      
      
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/KubernatesInstall/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">ã€ŒK8sã€Kubernates å®‰è£…</h5>
        <p class="card-text post-summary">ç¯å¢ƒå‡†å¤‡ K8s åªèƒ½åŸºäºLinuxç¯å¢ƒéƒ¨ç½²ï¼Œç”¨Win/Macçš„å°ä¼™ä¼´ä»¬æ€ä¹ˆåœ¨è‡ªå·±çš„PCä¸ŠSetupç¯å¢ƒå‘¢ã€‚æ­¤æ—¶å°±æ¨èCanonicalå®¶çš„Multipassäº†ï¼ŒCanonical æ˜¯è°ï¼Œå½“ç„¶æ˜¯Ubuntuçš„æ¯å…¬å¸äº†ã€‚
å®‰è£… kubelet kubeadm kubectl å®˜æ–¹æ–‡æ¡£
1sudo apt-get update &amp;&amp; sudo apt-get install -y apt-transport-https curl 2curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add - 3cat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list 4deb https://apt.kubernetes.io/ kubernetes-xenial main 5EOF 6sudo apt-get update 7sudo apt-get install -y kubelet kubeadm kubectl 8sudo apt-mark hold kubelet kubeadm kubectl # è®¾ç½®ä¸ºä¸å†æ›´æ–° åˆå§‹åŒ– 1swapoff -a 2kubeadm init ctl 3# kubeadm config images pull --v=10 4 # å›½å†…æ­£å¸¸ç½‘ç»œä¸èƒ½ä»k8s.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/KubernatesInstall/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Docker/docker_build_image/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">Docker Images</h5>
        <p class="card-text post-summary">é•œåƒä»“åº“ Linux æœ¬åœ°é•œåƒä»“åº“ï¼š/var/lib/docker/image
é•œåƒåº”è¯¥æ˜¯åˆ†å±‚å­˜å‚¨çš„ã€‚
Docker images æ˜¯å­˜å‚¨åœ¨é•œåƒä»“åº“æœåŠ¡Images Registryã€‚Docker å®¢æˆ·ç«¯çš„é•œåƒä»“åº“æœåŠ¡æ˜¯å¯é…ç½®çš„ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯Docker Hubã€‚
é•œåƒä»“åº“æœåŠ¡åŒ…å«å¤šä¸ªé•œåƒä»“åº“ Image Repositoryï¼ˆåŒä¸€ä¸ªé•œåƒçš„ä¸åŒç‰ˆæœ¬ï¼‰ã€‚ä¸€ä¸ªé•œåƒä»“åº“ä¸­åŒ…å«å¤šä¸ªé•œåƒImageã€‚
Docker Hub ä¹Ÿåˆ†ä¸ºOfficial Repository å’Œ Unofficial Repositoryã€‚
1docker pull &lt;repository&gt;:&lt;tag&gt; 2// å¦‚æœçœç•¥tagé»˜è®¤ä¼špull tag ä¸º latestçš„imageã€‚ä½†æ˜¯latestå¹¶ä¸ä¿è¯è¿™æ˜¯ä»“åº“ä¸­æœ€æ–°çš„é•œåƒã€‚ å¦‚æœå¸Œæœ›ä»ç¬¬ä¸‰æ–¹é•œåƒæœåŠ¡ä»“åº“è·å–é•œåƒ(not Docker Hub)ï¼Œåˆ™éœ€è¦åœ¨é•œåƒä»“åº“åç§°å‰åŠ ä¸Šç¬¬ä¸‰æ–¹é•œåƒä»“åº“æœåŠ¡çš„DNSåç§°ã€‚
1# gcr.io -&gt; Google Container Images Registry. 2docker pull gcr.io/k8s-staging-nfd/node-feature-discovery:master Image Tag ä¸åŒçš„Images Tagå¯ä»¥ç»‘å®šåŒä¸€ä¸ªImage ID
é€šè¿‡--filter æ¥è¿‡æ»¤docker image ls è¿”å›çš„å†…å®¹
1docker image ls --filter dangling=true dangling image -&gt; with out name &amp; tag :.
é€šå¸¸å› ä¸ºæ„å»ºæ–°çš„é•œåƒï¼Œä¸ºè¯¥é•œåƒæ‰“äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ ‡ç­¾ã€‚Dockerä¼šremove old imageä¸Šçš„æ ‡ç­¾ï¼Œå°†è¯¥æ ‡ç­¾æ ‡åœ¨æ–°Imageä¸Šã€‚Old Image å°±ä¼šå˜æˆ dangling imageã€‚</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Docker/docker_build_image/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Docker/docker_networking/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">Docker networking</h5>
        <p class="card-text post-summary">Docker networking is based on an open-source pluggable architecture called the Container Network Model(CNM). libnetwork is Docker&rsquo;s real-work implementation of the CNM, adn it provides all of the Docker&rsquo;s core networking capabilities. Drivers plug into libnework to provide specifice network topologies.
The theory At the highest level, Docker networking comprise three major components.
Single-host bridge network </p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Docker/docker_networking/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Linux/free/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">freeå‘½ä»¤</h5>
        <p class="card-text post-summary">type desc total physical mem used used = total- free-buffers-cache free Free/Unused memory shared It is here only for backward comopatibility buff/cache The combined memory used by the kernel buffers and page cache ans slabs. This memory can be reclaimed at any time if needed by the applicaitons. If you want buffers and cache to displayed in two separate columns, use -w options. available An estimate of the amount of memory that is availablew for starting new applications, without swaping.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Linux/free/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Linux/git/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">Git</h5>
        <p class="card-text post-summary">1# git cache user and passwd 2git config --global credential.helper cache </p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Linux/git/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/1-k8s-cloudnative/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Cloud Native</h5>
        <p class="card-text post-summary">Kubenetesç”Ÿäº§è½åœ°å…¨ç¨‹å®è·µ
æ ¸å¿ƒæ¦‚å¿µ
æ¶æ„è®¾è®¡
è®¤è¯æˆæƒ
é«˜å¯ç”¨é›†ç¾¤æ­å»º
äºŒè¿›åˆ¶&amp; kubeadm
3å°masterä¸¤å°2 node
calicoã€corednsã€dashboard
ä¸šåŠ¡è¿ç§»åˆ°Kubenetes
Harbor
æœåŠ¡å‘ç°ç­–ç•¥
IngressNginx
Docker åŒ–æœåŠ¡ã€K8sã€æœåŠ¡å‘ç°
CICD
namespaceã€resourcesã€label
æœåŠ¡çš„è°ƒåº¦ä¸ç¼–æ’
å¥åº·æ£€æŸ¥
è°ƒåº¦ç­–ç•¥
éƒ¨ç½²ç­–ç•¥
æ—¥å¿—ä¸ç›‘æ§
ç¬¬2ç«  kuberneteså¿«é€Ÿå…¥é—¨ æœ¬ç« ä¸­å°†ä»æ ¸å¿ƒæ¦‚å¿µã€æ¶æ„è®¾è®¡ã€è®¤è¯æˆæƒä»¥åŠé›†ç¾¤æ­å»ºæ–¹æ¡ˆå¯¹æ¯”å‡ æ–¹é¢ï¼Œå¸¦é¢†å¤§å®¶å¿«é€ŸæŒæ¡kubernetesçš„é‡è¦çŸ¥è¯†ç‚¹ï¼ŒåŠ©åŠ›å¿«é€Ÿå…¥é—¨ã€‚
2-1 äº†è§£kubernetes èˆµæ‰‹ï¼š æ¸”ç½‘ã€æ¸”èˆ¹ docker : é²¸é±¼ï¼Œé›†è£…ç®± ğŸ³
Kubernetes is an open-source system for automating deployment, scaling, and management of containerized applications.
It groups containers that makeup application in to logical units for easy management and discovery.Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/1-k8s-cloudnative/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/9-k8s-configmap/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s ConfigMap</h5>
        <p class="card-text post-summary">ç»™Podä¼ é€’å‚æ•° é€šè¿‡ç¯å¢ƒå˜é‡ç»™Podä¼ é€’å‚æ•° å¯ä»¥åœ¨containerçš„æè¿°æ–‡ä»¶ä¸­åŠ å…¥ä¸€ä¸ªenvçš„å‚æ•°ï¼Œå€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯é”®å€¼å¯¹ï¼Œå€¼æ˜¯stringã€‚
1--- 2apiVersion: v1 3kind: Pod 4metadata: 5 name: first-pod 6 labels: 7 app: nginx 8spec: 9 containers: 10 - name: 00-simple-pod-nginx 11 image: nginx:1.17.0 12 env: 13 - name: INTERVAL 14 value: 30s é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç»™Podä¼ é€’å‚æ•° åŠ å…¥ä¸€ä¸ªargsé…ç½®ï¼Œå‘½ä»¤è¡Œå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/9-k8s-configmap/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/7-k8s-daemonset/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s DaemonSet</h5>
        <p class="card-text post-summary">NodeExporter ç”¨äºé‡‡é›†ä¸€ä¸ªHostä¸Šçš„å„ç§æ€§èƒ½æŒ‡æ ‡ï¼Œå¹¶ä¸”æš´éœ²ç»™Prometheus é‡‡é›†ã€‚å› ä¸ºNodeExporteréœ€è¦é‡‡é›†æ¯ä¸€ä¸ªHostçš„æ•°æ®çŠ¶æ€ï¼Œæ‰€ä»¥å°±äº§ç”Ÿäº†ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨æ¯ä¸€ä¸ªK8sçš„æœºå™¨ä¸Šéƒ½è¦è¿è¡Œä¸€ä¸ªPod, è€Œå®ç°è¿™ä¸ªéœ€æ±‚çš„K8sèµ„æºç±»å‹å°±å«åšDaemonSetã€‚
DaemonSet DaemonSetçš„åŠŸèƒ½å°±æ˜¯ä¿è¯æ¯ä¸ªNodeéƒ½è¿è¡ŒPodï¼Œ ä½†æ˜¯å¦‚æœæŸä¸ªK8sçš„Nodeä¸‹çº¿ä¹‹åï¼Œå¯¹åº”çš„Podä¹Ÿä¸‹çº¿ï¼Œè¿˜æ˜¯ä¿æŒæ¯ä¸ªNodeä¸€ä¸ªPodã€‚å¦‚æœæ–°å¢ä¸€ä¸ªNodeï¼Œå°±ä¼šåœ¨æ–°å¢çš„Nodeä¸­å¢åŠ ä¸€ä¸ªPodï¼Œä¿è¯æ‰€æœ‰çš„Nodeä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªå½“å‰Podã€‚
1--- 2apiVersion: apps/v1 3kind: DaemonSet 4metadata: 5 name: node-exporter 6 namespace: kube-system 7 labels: 8 k8s-app: node-exporter 9 kubernetes.io/cluster-service: &#34;true&#34; 10 addonmanager.kubernetes.io/mode: Reconcile 11 version: v1.2.2 12spec: 13 selector: 14 matchLabels: 15 k8s-app: node-exporter 16 version: v1.2.2 17 updateStrategy: 18 type: OnDelete 19 template: 20 metadata: 21 labels: 22 k8s-app: node-exporter 23 version: v1.2.2 24 spec: 25 priorityClassName: system-node-critical 26 containers: 27 - name: prometheus-node-exporter 28 image: &#34;prom/node-exporter:v1.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/7-k8s-daemonset/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/5-k8s-deployment/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Deployments</h5>
        <p class="card-text post-summary">è“ç»¿éƒ¨ç½² è“ç»¿éƒ¨ç½²æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„éƒ¨ç½²æ–¹å¼ï¼Œç»å¸¸ä¼šç”¨äºæ–°æ—§ç‰ˆæœ¬ä¸å…¼å®¹çš„æƒ…å†µã€‚
å…ˆå°†æ–°ç‰ˆæœ¬(ç»¿ç‰ˆ)çš„æœåŠ¡è¿è¡Œèµ·æ¥ã€‚ å°†æ‰€æœ‰çš„æµé‡åˆ‡åˆ°æ–°ç‰ˆæœ¬çš„æœåŠ¡ä¸Š åˆ é™¤æ—§ç‰ˆæœ¬(è“ç‰ˆ)çš„æœåŠ¡ åˆ›å»ºæ–°ç‰ˆæœ¬çš„ReplicaSetï¼Œå°†ServiceæŒ‡å‘æ–°çš„Podsï¼Œåˆ é™¤æ—§ç‰ˆæœ¬çš„ReplicaSet
æ»šåŠ¨å‡çº§ è“ç»¿éƒ¨ç½²å¯ä»¥æœ‰æ•ˆä¿è¯ä¸šåŠ¡çš„æ­£ç¡®æ€§ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„é£é™©ï¼Œä¾‹å¦‚ç¨³å®šæ€§ã€‚
å‡è®¾æ–°éƒ¨ç½²çš„åº”ç”¨æ˜¯æœ‰é—®é¢˜çš„ï¼Œä¸€æ—¦åˆ‡æ¢ä¹‹åå°±ä¼šå¯¼è‡´ä¸šåŠ¡çš„å´©æºƒï¼Œé€ æˆæŸå¤±ã€‚äºæ˜¯å°±æœ‰äº†ç¨å¾®å‹å¥½çš„å‡çº§æ–¹å¼ï¼Œæ»šåŠ¨å‡çº§ã€‚
å…ˆå…³é—­ä¸€ä¸ªæ—§ç‰ˆæœ¬çš„å®ä¾‹ å¼€å¯ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„å®ä¾‹ç”¨äºæ›¿æ¢æ—§ç‰ˆæœ¬ æ›¿æ¢æˆåŠŸæ—¶å€™å¾ªç¯1å’Œ2ï¼Œç›´åˆ°æ‰€æœ‰çš„å®ä¾‹å‡çº§å®Œæˆã€‚ åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸­é€”å‘ç°å¼‚å¸¸å¯ä»¥åŠæ—¶åœæ‰‹ï¼ŒåŠæ—¶æ­¢æŸã€‚è€Œä¸”Kubernetesä¹Ÿåœ¨å®¢æˆ·ç«¯ä¸­æ”¯æŒäº†è¿™ä¸ªç‰¹æ€§ã€‚kubectl rolling-updateã€‚
å‡çº§å‰åRCçš„Selectoréƒ½è¢«æ”¹å˜äº† æ“ä½œéƒ½æ˜¯åœ¨å®¢æˆ·ç«¯æ‰§è¡Œçš„ï¼Ÿ é‡‘ä¸é›€å‘å¸ƒ é‡‘ä¸é›€å‘å¸ƒæ˜¯æ»šåŠ¨å‘å¸ƒçš„ä¸€ç§ç‰¹ä¾‹ï¼Œåœ¨æ»šåŠ¨å‘å¸ƒä¸­ï¼Œæ˜¯ä¸ä¼šç­‰å¾…çš„ï¼Œé™¤éä¸­é—´å‡ºé”™äº†ã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦å…¨éƒ½å‡çº§ï¼Œå¯èƒ½åªæ˜¯å¤„äºPOCçš„ä¸€äº›åŸå› ï¼Œæˆ‘ä»¬åªå¸Œæœ›éƒ¨åˆ†å®ä¾‹æ˜¯æ–°çš„ï¼Œå¤§éƒ¨åˆ†æ˜¯æ—§çš„ï¼Œè€Œè¿™ç§æƒ…å½¢ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºé‡‘ä¸é›€å‘å¸ƒã€‚
å‡çº§å°‘éƒ¨åˆ†å®ä¾‹ æŸ¥çœ‹æ•ˆæœï¼Œå¦‚æœå¥½ï¼Œå…¨éƒ¨å‡çº§ å¦‚æœä¸å¥½ï¼Œåˆ™ä¸å‡çº§ å£°æ˜å¼å‡çº§ å‰é¢ä»‹ç»çš„è¿™äº›å‡çº§å‘å¸ƒæ–¹å¼åœ¨K8sä¸Šå¾ˆå¤šæ—¶å€™æ˜¯åŠæ‰‹å·¥æ–¹å¼æ‰§è¡Œçš„ï¼Œè€ŒKubernetesä½œä¸ºä¸€æ¬¾DevOPSå‹å¥½çš„ç³»ç»Ÿï¼Œå·²ç»å†…ç½®äº†å¯¹äºéƒ¨ç½²æ–¹å¼çš„ä¸€ç§èµ„æºæŠ½è±¡ï¼Œè¿™ä¸ªèµ„æºå°±æ˜¯ï¼šDeploymentã€‚
Deployment &ndash;&gt; ReplicaSet &ndash;&gt; Pods
Deployment å­˜åœ¨çš„æ„ä¹‰ä¸ºï¼šåœ¨å‡çº§åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦å¼•å…¥é¢å¤–çš„ReplicaSetï¼Œå¹¶åè°ƒæ–°æ—§ä¸¤ä¸ªRSï¼Œä½¿ä»–ä»¬å†æ ¹æ®å½¼æ­¤ä¸æ–­ä¿®æ”¹ï¼Œè€Œä¸ä¼šé€ æˆå¹²æ‰°ã€‚Deploymentå°†è¿™äº›è¿ç»´è¿‡ç¨‹éƒ½ä»£ç åŒ–ï¼Œå†…ç½®ä¸ºè‡ªå·±çš„é€»è¾‘ï¼Œä»è€Œè®©å‡çº§å˜å¾—ç®€å•ã€‚
é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Deploymentåˆ›å»º3ä¸ªå®ä¾‹
1# deploy.yaml 2--- 3apiVersion: apps/v1 4kind: Deployment 5metadata: 6 name: first-deployment 7 labels: 8 app: simple-pod-deployment 9spec: 10 replicas: 3 11 selector: 12 matchLabels: 13 app: simple-pod-deployment 14 template: 15 metadata: 16 name: simple-pod-deployment 17 labels: 18 app: simple-pod-deployment 19 spec: 20 containers: 21 - name: simple-pod-de 22 image: lukelau/rest-docker:0.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/5-k8s-deployment/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/6-k8s-job/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Job</h5>
        <p class="card-text post-summary">Replicas å’Œdeploymentè¿™ä¸¤ç±»èµ„æºéƒ½æ˜¯ç”¨äºæ§åˆ¶workloadçš„ã€‚è¿™ä¸¤ç§ç±»å‹çš„èµ„æºä¸€èˆ¬éƒ½æ˜¯æŒç»­è¿è¡Œçš„ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€äº›è¾…åŠ©æ–¹å¼å¸®åŠ©workloadå‡ºç°å¼‚å¸¸æ—¶æ¢å¤ï¼Œä»¥åŠæ ¹æ®æƒ…å†µè¿›è¡ŒåŠ¨æ€ä¼¸ç¼©çš„ç‰¹æ€§ã€‚
Job æ ¹æ®Jobçš„å®šä¹‰åˆ›å»ºå‡ºå¯¹åº”çš„Podï¼Œç„¶åå…³æ³¨Podçš„çŠ¶æ€ï¼Œ ç›´åˆ°æ»¡è¶³å®šä¹‰ã€‚ä¾‹å¦‚Podæ‰§è¡ŒæˆåŠŸäº†æˆ–è€…æ‰§è¡Œå¤±è´¥äº†ï¼Œå¹¶ä¸”è¾¾åˆ°äº†é‡è¯•æ¬¡æ•°ã€‚
1--- 2apiVersion: batch/v1 3kind: Job 4metadata: 5 name: pi 6spec: 7 template: 8 spec: 9 containers: 10 - name: pi 11 image: perl 12 command: [&#34;perl&#34;, &#34;-Mbignum=bpi&#34;,&#34;-wle&#34;, &#34;print bpi(2000)&#34;] 13 restartPolicy: Never 14 backoffLimit: 4 Jobæ­£å¸¸æ‰§è¡Œç»“æŸåç»“æœå¦‚ä¸Šå›¾ã€‚è¿™æ˜¯ä¸€ä¸ªåªæ‰§è¡Œä¸€æ¬¡çš„Jobã€‚å®ƒçš„æ“ä½œæ–¹å¼å°±æ˜¯åˆ›å»ºä¸€ä¸ªPodï¼Œç„¶åè¿è¡Œä¸€éï¼Œç„¶åå°±é€€å‡ºã€‚å¦‚æœæƒ³æ‰§è¡Œå¤šæ¬¡ï¼Œåˆ™åªéœ€è¦å¢åŠ ä¸€ä¸ªå‚æ•°
1completions: 2 æ‰§è¡Œ2æ¬¡æ—¶åˆ›å»ºäº†ä¸¤ä¸ªPodï¼Œç„¶åä¿è¯è¿™ä¸¤ä¸ªPodéƒ½æ‰§è¡ŒæˆåŠŸã€‚
æˆ‘ä»¬åœ¨ä½¿ç”¨Deploymentç­‰Workloadçš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šæŒ‡å®šrestartPolicyï¼Œé»˜è®¤éƒ½æ˜¯RestartOnFailã€‚åœ¨Jobä¸­ä¸èƒ½è¿™ä¹ˆæŒ‡å®šï¼Œå› ä¸ºè¿™ä¸ªé€»è¾‘åº”è¯¥ç”±Jobæ¥æ§åˆ¶ï¼Œ è€Œä¸æ˜¯è®©Podæ¥æ§åˆ¶ã€‚
CronJob å®šæ—¶ä»»åŠ¡ï¼Œ CronJobå°±æ˜¯åœ¨Jobçš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†å‘¨æœŸå®šä¹‰çš„API
1--- 2apiVersion: batch/v1 3kind: CronJob 4metadata: 5 name: batch-job-pi 6spec: 7 schedule: &#34;0,15,30,45 * * * *&#34; 8 jobTemplate: 9 spec: 10 template: 11 metadata: 12 labels: 13 app: pi-job 14 spec: 15 containers: 16 - name: pi 17 image: perl 18 command: [&#34;perl&#34;, &#34;-Mbignum=bpi&#34;,&#34;-wle&#34;, &#34;print bpi(2000)&#34;] 19 restartPolicy: Never </p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/6-k8s-job/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/1-k8s-overview/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Overview</h5>
        <p class="card-text post-summary">Node èŠ‚ç‚¹ä¸»è¦è´Ÿè´£å®¹å™¨çš„ç®¡ç†ï¼Œç”¨äºè¿è¡Œå®¹å™¨å’Œä¿è¯å®¹å™¨çš„çŠ¶æ€ã€‚é»˜è®¤æƒ…å†µä¸‹MasterèŠ‚ç‚¹ä¸æ‰¿æ‹…NodeèŠ‚ç‚¹çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç‰¹æ®Šçš„é…ç½®è®©MasterèŠ‚ç‚¹ä¹Ÿå¯ä½œä¸ºNodeèŠ‚ç‚¹ã€‚
Etcdç”¨äºå­˜å‚¨Kubernetesçš„å…ƒæ•°æ®ï¼Œä½†æ˜¯ä¸è¦æ±‚ä¸€å®šè¦ä»¥å®¹å™¨çš„å½¢å¼è¿è¡Œã€‚
1kubeadm init --pod-network-cidr=10.244.0.0/16 --apiserver-advertise-address=192.168.0.22 --pod-network-cidr pod çš„ippool, --apiserver-advertise-address ä¸ºæš´éœ²çš„k8sAPIè°ƒç”¨IP.
èŠ‚ç‚¹(Node)
ä¸€ä¸ªNodeæ˜¯ä¸€ä¸ªè¿è¡ŒK8sçš„ä¸»æœºï¼Œä½œä¸ºK8s worker, é€šå¸¸ç§°ä¹‹ä¸ºMinionã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œå¦‚ä¸‹K8så…³é”®ç»„ä»¶ï¼š
kubeletï¼šä¸»èŠ‚ç‚¹ä»£ç† kube-proxy: serviceä½¿ç”¨å…¶å°†é“¾æ¥è·¯ç”±åˆ°Pod docker/rocket: k8s ä½¿ç”¨å®¹å™¨æŠ€æœ¯åˆ›å»ºå®¹å™¨ å®¹å™¨ç»„(Pod)
ä¸€ä¸ªPodå¯¹åº”è‹¥å¹²å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®¹å™¨ç»„ï¼ŒåŒä¸€ä¸ªPodå†…çš„å®¹å™¨å…±äº«ä¸€ä¸ªå­˜å‚¨å·(volume)ï¼ŒåŒä¸€ä¸ªPodä¸­çš„å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œNamespace,å¯ä»¥ä½¿ç”¨localhostäº’ç›¸é€šä¿¡ã€‚
Podæ˜¯çŸ­æš‚çš„ï¼Œä¸æ˜¯æŒç»­æ€§å®ä½“ã€‚ä¸€ä¸ªPodæ˜¯ä¸€ä¸ªç‰¹å®šçš„åº”ç”¨æ‰“åŒ…é›†åˆï¼ŒåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ã€‚å’Œè¿è¡Œçš„å®¹å™¨ç±»ä¼¼ï¼Œä¸€ä¸ªPodåªæœ‰å¾ˆçŸ­çš„è¿è¡Œå‘¨æœŸã€‚Podè¢«è°ƒåº¦åˆ°ä¸€ä¸ªNodeè¿è¡Œï¼Œç›´åˆ°å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç»“æŸæˆ–è€…å…¶è¢«åˆ é™¤ã€‚
å®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸ(Pod Status)
åŒ…å«æ‰€æœ‰å®¹å™¨çŠ¶æ€é›†åˆï¼ŒåŒ…æ‹¬å®¹å™¨ç»„çŠ¶æ€ç±»å‹ï¼Œå®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸï¼Œäº‹ä»¶ï¼Œé‡å¯ç­–ç•¥ï¼Œä»¥åŠreplication controllers.
æ ‡ç­¾(labels)
æ ‡ç­¾æ˜¯ç”¨æ¥è¿æ¥ä¸€ç»„å¯¹è±¡çš„ï¼Œæ¯”å¦‚å®¹å™¨ç»„Podã€‚lableå¯ä»¥ç”¨æ¥ç»„ç»‡å’Œé€‰æ‹©å­å¯¹è±¡ã€‚ ä¸€ä¸ªLabelæ˜¯attachåˆ°Podçš„ä¸€å¯¹é”®å€¼å¯¹ï¼Œç”¨æ¥ä¼ é€’ç”¨æˆ·å®šä¹‰çš„å±æ€§ã€‚
Replication Controllers
ä¸»è¦è´Ÿè´£æŒ‡å®šæ•°é‡çš„Podåœ¨åŒä¸€æ—¶é—´ä¸€èµ·è¿è¡Œã€‚Replication controller ç¡®ä¿ä»»æ„æ—¶é—´éƒ½æœ‰æŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬åœ¨è¿è¡Œã€‚å¦‚æœä¸ºæŸä¸ªPodåˆ›å»ºäº†Replication Controllerå¹¶ä¸”æŒ‡å®šä¸º3å‰¯æœ¬ï¼Œå®ƒä¼šåˆ›å»º3ä¸ªPod,å¹¶æŒç»­ç›‘æ§ä»–ä»¬ã€‚å¦‚æœæŸä¸ªPodä¸å“åº”ï¼Œé‚£ä¹ˆReplication controller ä¼šæ›¿æ¢å®ƒï¼Œä¿æŒPodæ€»æ•°ä¸º3.
å½“åˆ›å»ºReplication Controlleræ—¶ï¼Œéœ€è¦æŒ‡å®šä¸¤ä¸ªä¸œè¥¿ã€‚
Podæ¨¡æ¿ï¼š ç”¨æ¥åˆ›å»ºPodå‰¯æœ¬çš„æ¨¡æ¿ Labelï¼šReplication Controller éœ€è¦ç›‘æ§çš„Podçš„Label ç°åœ¨å·²ç»åˆ›å»ºäº†Podçš„ä¸€äº›å‰¯æœ¬ï¼Œé‚£ä¹ˆåœ¨è¿™äº›å‰¯æœ¬ä¸Šå¦‚ä½•è´Ÿè½½å‡è¡¡å‘¢ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯service
Serviceï¼š
å¦‚æœPodæ˜¯çŸ­æš‚çš„ï¼Œé‚£ä¹ˆé‡å¯æ—¶IPåœ°å€å¯èƒ½ä¼šå˜ï¼Œæ€ä¹ˆæ‰èƒ½ä»å‰ç«¯å®¹å™¨æ­£ç¡®å¯é çš„æŒ‡å‘åå°å®¹å™¨å‘¢ã€‚
Serviceæ˜¯å®šä¹‰ä¸€ç³»åˆ—Podä»¥åŠè®¿é—®è¿™äº›Podçš„ç­–ç•¥çš„ä¸€å±‚æŠ½è±¡ã€‚Serviceé€šè¿‡Labelæ‰¾åˆ°Podç»„ã€‚å› ä¸ºserviceæ˜¯æŠ½è±¡çš„ï¼Œæ‰€åœ¨åœ¨å›¾è¡¨é‡Œé€šå¸¸çœ‹ä¸åˆ°ä»–ä»¬çš„å­˜åœ¨ã€‚
ç°åœ¨å‡å®šæœ‰ä¸¤ä¸ªåå°Pod,å¹¶ä¸”å®šä¹‰åå°serviceåç§°ä¸ºâ€œbackend-serviceâ€ï¼Œlabelé€‰æ‹©å™¨ä¸º(tier=backend,app=myapp)ã€‚backend-serviceçš„Serviceä¼šå®Œæˆå¦‚ä¸‹ä¸¤ä»¶é‡è¦çš„äº‹æƒ…ï¼š
ä¼šä¸ºServiceåˆ›å»ºä¸€ä¸ªæœ¬åœ°é›†ç¾¤çš„DNSå…¥å£ï¼Œå› æ­¤å‰ç«¯åªéœ€è¦DNSæŸ¥æ‰¾ä¸»æœºåä¸ºâ€œbackend-serviceâ€å°±èƒ½å¤Ÿè§£æå‡ºå‰ç«¯åº”ç”¨ç¨‹åºå¯ç”¨çš„IPåœ°å€ ç°åœ¨å‰ç«¯å·²ç»å¾—åˆ°äº†åå°æœåŠ¡çš„IPåœ°å€ï¼Œä½†æ˜¯å®ƒåº”è¯¥è®¿é—®2ä¸ªåå°Podä¸­çš„å“ªä¸€ä¸ªå‘¢ã€‚Serviceåœ¨è¿™ä¸¤ä¸ªåå°Podä¹‹é—´æä¾›é€æ˜çš„è´Ÿè½½å‡è¡¡ï¼Œä¼šå°†è¯·æ±‚å‘ç»™å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚é€šè¿‡æ¯ä¸ªNodeä¸Šè¿è¡Œçš„ä»£ç† kube-proxyå®Œæˆã€‚ Kubernetes Master
é›†ç¾¤æ‹¥æœ‰ä¸€ä¸ªK8s Master,K8s Master æä¾›é›†ç¾¤çš„ç‹¬ç‰¹è§†è§’ï¼Œå¹¶æ‹¥æœ‰ä¸€ç³»åˆ—ç»„ä»¶ï¼Œå¦‚Kubernetes API server. API server æä¾›å¯ä»¥ç”¨æ¥å’Œé›†ç¾¤äº¤äº’çš„REST ç«¯ç‚¹ã€‚Master èŠ‚ç‚¹åŒ…å«ç”¨æ¥åˆ›å»ºå’Œå¤åˆ¶Podçš„Replication Controller.
å‚è€ƒèµ„æ–™ï¼š</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/1-k8s-overview/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/8-k8s-stafulset/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s StafulSet</h5>
        <p class="card-text post-summary">å‰é¢ä»‹ç»çš„å‡ ç§workloadéƒ½æœ‰ä¸€ä¸ªå…±æ€§ï¼Œé‚£å°±æ˜¯åˆ›å»ºå‡ºæ¥çš„Podéƒ½æ˜¯ä¸€è‡´çš„ã€‚æ‰€è°“çš„ä¸€è‡´å°±æ˜¯è¯´ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ReplicaSetï¼Œåˆ›å»ºäº†3ä¸ªPodï¼Œé‚£ä¹ˆè¿™3ä¸ªPodåˆ›äº†åå­—ä¸€å®šä¸ä¸€æ ·ä¹‹å¤–ï¼Œå…¶ä»–å±æ€§å¯èƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒåŒ…æ‹¬è¿è¡Œæ—¶çš„å‚æ•°å’Œæ¨¡å¼ä»¥åŠæ•°æ®å­˜å‚¨ã€‚
å¦‚æœæ˜¯Web Serviceï¼Œæ•°æ®ä¿å­˜åˆ°åç«¯çš„DBä¸­ï¼Œä¸Šè¿°é€»è¾‘æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚
å¦‚æœä½¿ç”¨ReplicaSetæ¥éƒ¨ç½²ä¸€ä¸ªDBçš„å¤šå®ä¾‹ï¼Œ å°±å¯è‚¯èƒ½å­˜åœ¨é—®é¢˜äº†ã€‚
æ•°æ®æŒä¹…åŒ–ï¼Œä¸€èˆ¬ä½¿ç”¨PVCï¼Œå½“ä½¿ç”¨PVC å’ŒPVçš„æ—¶å€™
â€‹
ReplicaSet -&gt; Pods(3 ä¸ª) -&gt; æŒä¹…å·å£°æ˜ -&gt; æŒä¹…å·
3ä¸ªPodçš„æ•°æ®éƒ½å†™åˆ°åŒä¸€ä¸ªPvä¸­ï¼Œè¿™æ ·è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Ÿï¼Ÿï¼Ÿ
StatefulSet ä¸ºäº†è§£å†³Podçš„çŠ¶æ€æ€§çš„é—®é¢˜ï¼ŒK8så¼•å…¥äº†StatefulSetçš„æ¦‚å¿µ
Podæœ‰å•ç‹¬çš„å­˜å‚¨å’Œå›ºå®šçš„ç½‘ç»œæ ‡è¯† éœ€è¦é…å¤‡ä¸€ä¸ªheadless Serviceï¼Œç”¨äºDNS å¯ä»¥é€šè¿‡DNSå¿«é€Ÿå‘ç°å…¶ä»–çš„Pod å¯ä»¥ç›´æ¥é€šè¿‡Pod DNSé€šä¿¡ æ¯ä¸ªPodéƒ½å¯ä»¥é€šè¿‡DNSè®¿é—®åˆ°ï¼Œè¿™ç§ç‰¹æ€§åœ¨å…¶ä»–workloadä¸­æ˜¯ä¸èƒ½å®ç°çš„ã€‚é€šè¿‡StatefulSetå¯ä»¥è®©PodæŒæœ‰çŠ¶æ€ï¼Œå³ä½¿å› ä¸ºæ•…éšœPodé‡å»ºäº†ï¼Œé‚£ä¹ˆå¯¹åº”çš„Podçš„åå­—å’Œæ•°æ®éƒ½ä¼šä¿ç•™ï¼Œå’Œé‡å»ºä¹‹å‰æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚
ä½¿ç”¨StatefulSet å¿…é¡»å»ºç«‹ä¸€ä¸ªHeadlessServiceï¼Œç„¶åç»‘å®šè¿™ä¸ªheadlessserviceåˆ°StatefulSetã€‚
ä»¥MongoDBä¸ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªStatefulSetï¼Œå› ä¸ºè¿˜æ²¡æœ‰ä»‹ç»åˆ°PVCå’ŒPVçš„å†…å®¹ï¼Œæ‰€ä»¥MongoDBå°†ä½¿ç”¨æœ¬åœ°å­˜å‚¨å·ã€‚
åˆ›å»ºHeadless Service
åˆ›å»º StatefulSet
é€šè¿‡DNSè®¿é—®Pod
åœ¨StatefulSetçš„Podä¸­å¯ä»¥é€šè¿‡DNSç›´æ¥è®¿é—®å…¶ä»–Podã€‚
1mongo --host mongo-1.mongo å¯ä»¥é€šè¿‡&lt;pod-name&gt;.&lt;service-name&gt;çš„å½¢å¼è®¿é—®Podã€‚è¿™å…¶å®å’ŒStatefulSetçš„è®¾è®¡æ˜¯æœ‰å…³ç³»çš„ï¼Œåœ¨ç±»ä¼¼çš„Deploymentä¸­Podçš„åå­—æ˜¯ä¸å›ºå®šçš„ï¼Œè€Œåœ¨StatefulSetä¸­ï¼ŒPodçš„åå­—æ˜¯å›ºå®šçš„ã€‚
å’ŒReplicaSetå¯¹æ¯”
å› ä¸ºæœ‰çŠ¶æ€çš„Podå½¼æ­¤ä¸åŒï¼Œé€šå¸¸å¸Œæœ›æ“ä½œçš„æ˜¯å…¶ä¸­çš„ç‰¹å®šçš„ä¸€ä¸ªï¼Œæ‰€ä»¥StatefulSeté€šå¸¸è¦æ±‚ä½ åˆ›å»ºä¸€ä¸ªç”¨æ¥è®°å½•æ¯ä¸ªPodç½‘ç»œæ ‡è®°çš„HeadlessServiceã€‚é€šè¿‡è¿™ä¸ªServiceï¼Œæ¯ä¸ªPodéƒ½æ‹¥æœ‰ç‹¬ç«‹çš„DNSè®°å½•ï¼Œè€Œè¿™åœ¨ReplicaSetä¸­æ˜¯ä¸è¡Œçš„ï¼Ÿï¼ˆå¦‚æœä¸ºReplicaSetåˆ›å»ºä¸€ä¸ªHeadless Serviceä¼šå‘ç”Ÿå•¥ï¼Ÿï¼‰ å› ä¸ºStatefulSetç¼©å®¹ä»»ä½•æ—¶å€™åªä¼šæ“ä½œä¸€ä¸ªPodå®ä¾‹ï¼Œæ‰€ä»¥æœ‰çŠ¶æ€åº”ç”¨çš„ç¼©å®¹ä¸ä¼šå¾ˆè¿…é€Ÿã€‚ StatefulSetåœ¨æœ‰å®ä¾‹ä¸å¥åº·çš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸å…è®¸ç¼©å®¹çš„ã€‚ æŒä¹…å­˜å‚¨ ä¸€ä¸ªStatefulSetå¯ä»¥æ‹¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå·å£°æ˜æ¨¡æ¿ï¼Œè¿™äº›å£°æ˜ä¼šåœ¨åˆ›å»ºPodå‰åˆ›å»ºå‡ºæ¥ï¼Œç»‘å®šåˆ°ä¸€ä¸ªPodçš„å®ä¾‹ä¸Šã€‚ æ‰©å®¹StatefulSetä¼šåˆ›å»ºä¸¤ä¸ªAPIå¯¹è±¡ï¼Œä¸€ä¸ªPodå’Œä¸€ä¸ªå·å£°æ˜ï¼›ä½†æ˜¯ç¼©å®¹StatefulSetå´ä¼šåˆ é™¤ä¸€ä¸ªPodå¯¹è±¡ï¼Œè€Œä¼šç•™ä¸‹PVCï¼Œå› ä¸ºä¸€æ—¦åˆ é™¤PVCåˆ™æ„å‘³ç€PVä¼šè¢«å›æ”¶ã€‚ StatefulSet at-most-one
Kubernetes å¿…é¡»ä¿è¯ä¸¤ä¸ªæ‹¥æœ‰ç›¸åŒæ ‡è®°å’Œç»‘å®šç›¸åŒæŒä¹…å·å£°æ˜çš„æœ‰çŠ¶æ€çš„Podå®ä¾‹ä¸ä¼šåŒæ—¶è¿è¡Œã€‚ä¸€ä¸ªStatefulSetå¿…é¡»ä¿è¯æœ‰çŠ¶æ€çš„å®ä¾‹çš„ at-most-one è¯­ä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´StatefulSetå¿…é¡»ä¿è¯ä¸€ä¸ªPodä¸å†è¿è¡Œåï¼Œæ‰ä¼šå»åˆ›å»ºå®ƒçš„æ›¿æ¢Podã€‚</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/8-k8s-stafulset/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
    </div>
    <div class="paginator">
      
    <ul class="pagination pagination-default">
      <li class="page-item">
        <a href="/posts/cloudnative/" aria-label="First" class="page-link" role="button"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/cloudnative/" aria-label="Previous" class="page-link" role="button"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/cloudnative/" aria-label="Page 1" class="page-link" role="button">1</a>
      </li>
      <li class="page-item active">
        <a aria-current="page" aria-label="Page 2" class="page-link" role="button">2</a>
      </li>
      <li class="page-item">
        <a href="/posts/cloudnative/page/3/" aria-label="Page 3" class="page-link" role="button">3</a>
      </li>
      <li class="page-item">
        <a href="/posts/cloudnative/page/3/" aria-label="Next" class="page-link" role="button"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/cloudnative/page/3/" aria-label="Last" class="page-link" role="button"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul>
    </div>
  </div>
</section>


      
       
    </div>

    
    












  
  
    
  

  
  
    
  

  
  
    
  

  
  
    
    
      
    
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#about">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#skills">Skills</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#recent-posts">Recent Posts</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#achievements">My Story</a>
                </li>
              
            
              
                
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:airrenzero#gmail.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>airrenzero#gmail.com</span>
                </a></li>
              
            
              
                <li><span><i class="fas fa-phone-alt"></i></span> <span>&#43;86 1881733xxxx</span></li>
              
            
          </ul>
        </div>
        
        
        
          
          <div class="col-md-4 col-sm-12">
            <p>Stay up to date with email notification</p>
              
              <form
                action="https://github.us1.list-manage.com/subscribe/post?u=19de52a4603135aae97163fd8&amp;amp;id=094a24c76e"
                method="post"
                id="mc-embedded-subscribe-form"
                name="mc-embedded-subscribe-form"
                class="validate"
                target="_blank"
                novalidate >
                <div class="form-group">
                  <input
                    type="email"
                    class="form-control"
                    id="mce-EMAIL"
                    name="EMAIL"
                    aria-describedby="emailHelp"
                    placeholder="Enter email"
                  />
                  <small id="emailHelp" class="form-text text-muted"
                    >By entering your email address, you agree to receive the newsletter of this website.</small
                  >
                </div>
                <button type="submit" class="btn btn-info">Submit</button>
              </form>
            
          </div>
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">Â© 2020-2021 Copyright.</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>



    
    
    <script src="/js/list.js"></script>


    
</body>
</html>
