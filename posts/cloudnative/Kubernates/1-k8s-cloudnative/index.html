<!DOCTYPE html>
<html>
  <head>
    <title>K8s Cloud Native</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>

<link rel="stylesheet" href="/css/flag-icon.min.css"/>


<link rel="stylesheet" href="/google-fonts/Mulish/mulish.css"/>


<link rel="stylesheet" href="/fontawesome/css/all.min.css"/>







  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/site/favicon_hufa9bb061875e5783d83b75135c052e0b_6105_42x0_resize_box_3.png" />

<meta property="og:title" content="K8s Cloud Native" />
<meta property="og:description" content="Kubenetes生产落地全程实践
核心概念
架构设计
认证授权
高可用集群搭建
二进制&amp; kubeadm
3台master两台2 node
calico、coredns、dashboard
业务迁移到Kubenetes
Harbor
服务发现策略
IngressNginx
Docker 化服务、K8s、服务发现
CICD
namespace、resources、label
服务的调度与编排
健康检查
调度策略
部署策略
日志与监控
第2章 kubernetes快速入门 本章中将从核心概念、架构设计、认证授权以及集群搭建方案对比几方面，带领大家快速掌握kubernetes的重要知识点，助力快速入门。
2-1 了解kubernetes 舵手： 渔网、渔船 docker : 鲸鱼，集装箱 🐳
Kubernetes is an open-source system for automating deployment, scaling, and management of containerized applications.
It groups containers that makeup application in to logical units for easy management and discovery.Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://airren.github.io/posts/cloudnative/Kubernates/1-k8s-cloudnative/" /><meta property="article:section" content="posts" />




    
    
<meta name="description" content="K8s Cloud Native" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/css/layouts/single.css"/>
<link rel="stylesheet" href="/css/navigators/sidebar.css">

<link rel="stylesheet" href="/css/style.css"/>



    




</head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      
        <img src="/images/site/main-logo_hue3dcebd3233f4247380b642debb20e00_8242_42x0_resize_box_3.png" alt="Logo">
      ByteGopher</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      
      </ul>
    </div>
  </div>
  
  
    <img src="/images/site/main-logo_hue3dcebd3233f4247380b642debb20e00_8242_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/site/inverted-logo_hu625a7b1b3d293b5088d5bed0b0ae5735_6060_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts/" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li><a class="" href="/posts/blog/" title="Blog">Blog</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/cloudnative/" title="CloudNative">CloudNative</a></li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/component/">Infrastructure</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/component/TimeSeries/" title="TimeSeriesDB">TimeSeriesDB</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/kubernetes/" title="Kubernetes">Kubernetes</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/note_c/" title="Note C">Note C</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/note_go/" title="Note Go">Note Go</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/react/" title="React">React</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/tips/" title="Tips">Tips</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/nodus/" title="Nodus">Nodus</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/interview/" title="Interview">Interview</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/life/" title="Life">Life</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/linux/" title="Linux">Linux</a></li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(/images/default-hero.jpg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/author/airren_hua190a7ea0abcfe5733aac4e715353a6c_101835_120x120_fit_box_3.png' alt="Author Image">
          <h5 class="author-name">Airren Ren</h5>
          <p>Monday, January 1, 1</p>
        </div>

        <div class="title">
          <h1>K8s Cloud Native</h1>
        </div>
        
        <div class="taxonomy-terms">
          <ul style="padding-left: 0;">
            
          </ul>
        </div>
        
        <div class="post-content" id="post-content">
          <p>Kubenetes生产落地全程实践</p>
<p>核心概念</p>
<p>架构设计</p>
<p>认证授权</p>
<p>高可用集群搭建</p>
<p>二进制&amp; kubeadm</p>
<p>3台master两台2 node</p>
<p>calico、coredns、dashboard</p>
<p>业务迁移到Kubenetes</p>
<p>Harbor</p>
<p>服务发现策略</p>
<p>IngressNginx</p>
<p>Docker 化服务、K8s、服务发现</p>
<p>CICD</p>
<p>namespace、resources、label</p>
<p>服务的调度与编排</p>
<p>健康检查</p>
<p>调度策略</p>
<p>部署策略</p>
<p>日志与监控</p>
<h2 id="第2章-kubernetes快速入门">第2章 kubernetes快速入门</h2>
<p>本章中将从核心概念、架构设计、认证授权以及集群搭建方案对比几方面，带领大家快速掌握kubernetes的重要知识点，助力快速入门。</p>
<h3 id="2-1-了解kubernetes">2-1 了解kubernetes</h3>
<p>舵手： 渔网、渔船  docker : 鲸鱼，集装箱 🐳</p>
<p>Kubernetes is an open-source system for automating deployment, scaling, and management of containerized applications.</p>
<p>It groups containers that makeup application in to logical units for easy management and discovery.Kubernetes builds upon 15 years of  experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community.</p>
<p>kubernetes的主要特征</p>
<ul>
<li>以服务为中心</li>
<li>自动化， 自动扩缩容，更新、负载均衡、实例状态</li>
</ul>
<p>kubernetes vs docker</p>
<ul>
<li>以docker 容器技术技术的标准为基础，CRI</li>
</ul>
<p>K8s架构设计</p>
<p>pod： pause 作为根容器，共享网络文件等资源</p>
<p><p class="md__image">







<img src="image-20210929221556408.png" alt="image-20210929221556408" />



</p>
</p>
<p>label： deploy/pod/container</p>
<p><p class="md__image">







<img src="image-20210929221845565.png" alt="image-20210929221845565" />



</p>
</p>
<h2 id="heading"></h2>
<h3 id="2-2-kubernetes的核心概念">2-2 kubernetes的核心概念</h3>
<h3 id="2-3-kubernetes的架构设计">2-3 kubernetes的架构设计</h3>
<p>master (APIServer/Scheduler(资源、内存、cpu)/controller(k8s资源rs,service))        etcd</p>
<p>worker   worker (kubelet维护pod的生命周期，网络、volume/ docker )</p>
<img src="1-k8s-cloudnative.assets/image-20210929224628590.png" alt="image-20210929224628590" style="zoom:50%;" />
<h3 id="2-4-kubernetes认证的密码学原理-1530">2-4 kubernetes认证的密码学原理 (15:30)</h3>
<p>认证(Authentication)  防止有人入侵</p>
<p>授权(Authorization)</p>
<p>APIserver</p>
<p>A &ndash;8 篡改&ndash; &gt;  B</p>
<p>对称加密：小姐姐好可爱 &ndash;&gt; 对称加密 abc123&mdash;&gt;  wqerjqwoeurfasdhjfskalj -&gt; 对称解密abc123 &mdash;&gt; 小姐姐好可爱</p>
<p>非对称加密: 小姐姐好可爱 &ndash;&gt; 非对称加密 abc123(公钥 public key)&mdash;&gt;  wuqyieruzsxchjfvash -&gt; 非对称解密cde987(私钥 private key) &mdash;&gt; 小姐姐好可爱</p>
<p>发送一个hello</p>
<p>serviceA       &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-&gt;             ServiceB</p>
<p>serviceA &mdash;&mdash;&ndash;asdfqwefwsadfasd 密文&mdash;&mdash;&mdash;-&gt; serviceB</p>
<p>A 使用 serverB的pubkey进行加密，然后发送到serverB。 c截获后也解不开。只有B用自己的私钥才可以解开。非对称加密算法的消耗比较大。对称加密的算法消耗较低。</p>
<p>结合非对称加密和对称加密。</p>
<p>使用非对称加密，加密对称加密要使用的密钥。可以把对称加密需要的密钥安全带的送到B。接下来双方就可以使用对称加密进行通信。</p>
<p>性能和安全性都得到了解决。</p>
<p>SSL/TLS协议  &mdash;&gt; HTTPS</p>
<p>目前可能存在的风险就是B 在返回pubkey的时候，有可能被C截获，C截获后返回C的公钥给A，这样A就拿到了C的公钥。</p>
<p>CA 认证机构，让A可以验证拿到的B的pubkey 确实是B的，确实是合法的，是CA颁发的。</p>
<h3 id="2-5-kubernetes的认证与授权">2-5 kubernetes的认证与授权</h3>
<p>认证</p>
<p><strong>1. 客户端证书认证(TLS双向认证)</strong></p>
<p>CA 自己的认证机构</p>
<p>给各个组件颁发证书</p>
<p>kubectl  &mdash;&gt;   API server</p>
<p>双向认证 ： 互相验证证书是否为CA颁发</p>
<ul>
<li>
<p>API server是否是kubectl 需要访问的</p>
</li>
<li>
<p>kubectl 客户端是否是一个合法的客户端</p>
</li>
</ul>
<p><strong>2.BearerToken</strong></p>
<p><strong>3.ServcieAccount</strong></p>
<p>Pod与API server打交道</p>
<p>(namespace，token，ca) 挂载到pod的文件系统中</p>
<p>授权</p>
<p>ABAC</p>
<p>webhook</p>
<p>RBAC(Role Based Access Control)</p>
<p>User &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-&gt;  Role &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-&gt; Authority(Resource, Verbs:Curd)</p>
<p>|_ User</p>
<p>|_ ServiceAccount</p>
<p>RoleBinding</p>
<img src="1-k8s-cloudnative.assets/image-20211002162137603.png" alt="image-20211002162137603" style="zoom:50%;" />
<p>AdmisionControl: 准入控制</p>
<p>AlwaysAdmit、AlwaysDeny、ServiceAccount、DenyEscolatingExec</p>
<h3 id="2-6-集群搭建方案对比">2-6 集群搭建方案对比</h3>
<p>社区方案</p>
<p>Kubeadm：</p>
<p>Binary：</p>
<p>易于维护</p>
<p>iterm 级联功能</p>
<h2 id="第3章-容器运行时-docker-or-containerd">第3章 容器运行时-Docker or Containerd</h2>
<p>本章主要讲解Docker or Containerd如何选择和全面上手实践Containerd。</p>
<p>3-1 Docker or Containerd如何选择 (07:40)</p>
<p>3-2 Containerd全面上手实践 (26:18)
第4章 高可用集群搭建&mdash;kubespray方式【集群落地方案1】6 节 | 52分钟
本章中将讲解kubespray集群搭建方案。带领大家一起分析kubespray部署方案、基础环境、kubespray的安装配置、用kubespray一键部署生产级K8s集群等，全面系统学会kubespray的集群落地方案。</p>
<p>4-1 分析kubespray部署方案，准备基础环境 (08:42)</p>
<p>4-2 kubespray的安装、配置 (15:13)</p>
<p>4-3 用kubespray一键部署生产级k8s集群 (08:28)</p>
<p>4-4 集群冒烟测试 (06:52)</p>
<p>4-5 访问dashboard (04:41)</p>
<p>4-6 基于kubespray的集群运维 (07:20)
第5章 高可用集群搭建&mdash;二进制方式【集群落地方案2】9 节 | 73分钟
本章中将讲解，如何使用二进制的方式，搭建最新版本的kubernetes高可用集群。同样会以三个master，两个worker节点为例，会针对集群可用性进行的测试，并完成dashboard的搭建和使用。并在本章结尾，通过文档方式，针对前面内容进行总结，便于同学们回顾查阅。&hellip;</p>
<p>5-1 基础环境准备 (13:58)</p>
<p>5-2 生成证书 (10:58)</p>
<p>5-3 kubernetes各组件的认证配置 (04:31)</p>
<p>5-4 部署etcd集群 (04:08)</p>
<p>5-5 部署kubernetes控制平面 (08:16)</p>
<p>5-6 部署kubernetes工作节点 (13:38)</p>
<p>5-7 网络插件-Calico_1 (06:00)</p>
<p>5-8 DNS插件-CoreDNS (04:40)</p>
<p>5-9 集群冒烟测试 (06:36)
第6章 业务系统迁移kubernetes&mdash;准备工作【为平稳迁移做好储备】6 节 | 90分钟
搭建完集群还不能马上迁移业务，本章中将讲解迁移前的一些准备工作：包括镜像仓库harbor的入门和部署、对kubernetes服务发现方案的学习分析以及ingress-nginx服务发现方案的部署。</p>
<p>6-1 Harbor入门 (17:06)</p>
<p>6-2 Harbor高可用部署（上） (11:50)</p>
<p>6-3 Harbor高可用部署（下） (12:21)</p>
<img src="1-k8s-cloudnative.assets/image-20211002222547781.png" alt="image-20211002222547781" style="zoom:50%;" />
<h3 id="6-4-kubernetes的服务发现">6-4 kubernetes的服务发现</h3>
<p>集群内部</p>
<p>集群内-&gt; 集群外</p>
<p>集群外-&gt; 集群内</p>
<p><p class="md__image">







<img src="image-20211002225039041.png" alt="image-20211002225039041" />



</p>
</p>
<p>6-5 部署ingress-nginx（上） (14:52)</p>
<p>6-6 部署ingress-nginx（下） (13:36)
第7章 业务系统迁移kubernetes&mdash;最佳实践【多类型业务迁移落地】7 节 | 86分钟
本章中将分析如何将非docker业务迁移到docker、使docker服务运行在kubernetes中，以及在这个过程中需要注意的问题。同时也会介绍，将定时任务、传统的web服务、springboot的web服务还有dubbo服务迁移部署在kubernetes中的全过程。</p>
<p>7-1 定时任务迁移kubernetes (21:56)</p>
<p>服务做到镜像里</p>
<ul>
<li>基础镜像</li>
<li>搞定服务运行的相关文件</li>
<li>构建镜像 Dockerfile</li>
</ul>
<p>制作K8s服务，并调度</p>
<ul>
<li>确定服务发现的策略</li>
<li>编写K8s配置</li>
<li></li>
</ul>
<p>图文：
7-2 【不熟悉SpringBoot的筒子看过来】SpringBoot快速入门</p>
<p>7-3 springboot的web服务迁移kubernetes (11:29)
图文：
7-4 【不熟悉Dubbo的筒子看过来】Dubbo快速入门</p>
<p>7-5 传统dubbo服务迁移kubernetes（上） (16:22)</p>
<p>7-6 传统dubbo服务迁移kubernetes（下） (16:08)</p>
<p>7-7 传统web服务迁移kubernetes (19:40)
第8章 CICD实践【只会迁移还不够，持续集成走起】5 节 | 70分钟
本章将讲解如何让服务可以在kubernetes里面实现持续集成。逐步实现gitlab管理代码、maven构建、docker实现镜像的构建、推送到harbor仓库以及通过脚本跟kubernetes对接完成持续发布。最后还会应用jenkins通过pipeline整合整个流程实现CICD。&hellip;</p>
<p>8-1 kubernetes与cicd (12:41)</p>
<p>8-2 cicd实践（1） (12:56)</p>
<p>8-3 cicd实践（2） (13:26)</p>
<p>8-4 cicd实践（3） (13:31)</p>
<p>8-5 cicd实践（4） (17:18)</p>
<h2 id="第9章-深入kubernete---几个重要的资源对象透过表象看本质装逼可选包4-节--83分钟">第9章 深入kubernete&mdash;几个重要的资源对象【透过表象看本质&amp;装逼可选包】4 节 | 83分钟</h2>
<p>本章中介绍了kubernetes的重要资源：namespace、resources和label。 讲解并实践了，命名空间对资源对象和资源配额多层面的隔离机制、pod资源限制的配置方式、pod在节点资源紧缺时的驱逐机制、label作用于不同资源对象上的不同的作用等核心知识。 &hellip;</p>
<h3 id="9-1-namespace-----集群的共享与隔离">9-1 Namespace &mdash; 集群的共享与隔离</h3>
<p>创建一个namespace</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Namespace</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">dev</span>
</span></span></code></pre></div><p>9-2 Resources&mdash;多维度集群资源管理（上） (22:45)</p>
<p>9-3 Resources&mdash;多维度集群资源管理（下） (22:26)</p>
<p>9-4 Label&mdash;小标签大作为 (19:31)
第10章 深入kubernete&mdash;服务调度与编排【透过表象看本质&amp;装逼可选包】6 节 | 121分钟
本章中主要围绕服务的调度与编排讲解讲解并实践了：pod的健康检查的参数配置及影响、调度器的整体工作原理以及常见的预选策略和优选策略、如何利用kubernetes本身的机制完成不同的部署方式。</p>
<p>10-1 健康检查&mdash;高可用的守护者 (23:06)</p>
<p>10-2 Scheduler&mdash; 玩转pod调度（上） (13:57)</p>
<p>10-3 Scheduler &mdash; 玩转pod调度（下） (13:49)</p>
<p>10-4 部署策略详解 &mdash; 重建、滚动、蓝绿、金丝雀 (26:11)</p>
<p>10-5 深入Pod - pod相关的点点滴滴（上） (21:24)</p>
<p>10-6 深入Pod - pod相关的点点滴滴（下） (22:04)
第11章 深入kubernete&mdash; 落地实践深入【透过表象看本质&amp;装逼可选包】7 节 | 123分钟
本章主要从kubernetes落地的角度进行深入讲解，分别介绍：ingress在落地过程可能遇到的问题与应对方式、基于glusterfs的共享存储、kubernetes api的设计，并以一个真实的示例项目让大家看到容器管理平台可以做成什么样子的。</p>
<p>11-1 ingress &mdash; 四层代理、session保持、定制配置、流量控制（上） (17:42)</p>
<p>11-2 ingress &ndash; 四层代理、session保持、定制配置、流量控制（中） (17:18)</p>
<p>11-3 ingress &mdash; 四层代理、session保持、定制配置、流量控制（下） (16:42)</p>
<p>11-4 共享存储 &mdash; PV、PVC和StorageClass（上）.mp4 (16:13)</p>
<p>11-5 共享存储 &mdash; PV、PVC和StorageClass（下） (16:04)</p>
<p>11-6 StatefulSet &mdash; 有状态应用的守护者 (18:47)</p>
<p>11-7 KubernetesAPI &mdash;如何开发一个基于kubernetes的容器管理平台 (19:38)
第12章 深入kubernete&mdash;日志和监控【透过表象看本质&amp;装逼可选包】10 节 | 131分钟
本章中将介绍K8S使用者必须考虑的重量级问题：日志与监控。课程中会分析当下主流的日志处理方案并选择一种方案进行日志从采集到展示的完整实践；会讲解主流k8s监控方案prometheus，包括它的实现原理，支持的各种指标等。</p>
<p>12-1 常见日志采集问题和解决方案分析 (08:41)</p>
<p>12-2 logpilot+elasticsearch+kibana日志实践 (19:26)</p>
<p>12-3 监控入门&mdash;从整体把握监控 (07:39)</p>
<p>12-4 Prometheus入门&mdash;架构和原理 (11:45)</p>
<p>12-5 部署前奏 - Helm &amp; Operator (10:31)</p>
<p>12-6 监控部署实战 - Helm+PrometheusOperator (19:30)</p>
<p>12-7 监控落地 - 指标完善、Grafana看板和邮件报警（上） (17:16)</p>
<p>12-8 监控落地 - 指标完善、Grafana看板和邮件报警（中） (17:28)</p>
<p>12-9 监控落地 - 指标完善、Grafana看板和邮件报警（下） (18:21)
图文：
12-10 【步骤总结，便于快速回顾】Helm部署文档</p>
<h2 id="第13章-servicemesh代表作istio">第13章 ServiceMesh代表作istio</h2>
<p>本章中我们会从istio的架构设计开始让你对它的实现原理有深入了解，并会部署完整的istio环境，从架构上让我们的服务自动支持istio的功能，最后使用几个istio的常见工具集实现数据展现。</p>
<p>13-1 什么是ServiceMesh？什么是Istio？ (04:51)</p>
<p>微服务架构</p>
<p>设么是ServiceMesh</p>
<ul>
<li>服务网格</li>
<li>是概念不是产品</li>
<li>解决网络层面的问题</li>
</ul>
<p>服务发现、负载均衡、路由、流量控制、服务间通信的可靠性、监控&mdash;-  API 网关？</p>
<p>Linkerd</p>
<p>始于2016年CNCF官方项目</p>
<p>1.x 基于节点(虚拟机、物理机)</p>
<p>2.x 基于kubernetes(conduit)</p>
<p>Istio</p>
<p>Google/IBM/Lyft 发起的开源项目，17年推出，18年7月发布1.0、多平台支持</p>
<p>都是基于sidecar模式</p>
<p>都分为数据层和控制层</p>
<p>Istio 更受欢迎</p>
<p>Pilot -&gt; envoy 提供信息，服务发现， AB测试</p>
<p>Mixer：策略(访问控制)、遥测(数据收集和汇报，服务之间流转的数据)</p>
<p>Galley:  配置管理中心</p>
<p>Citadel： 安全</p>
<p>故障排查：</p>
<p>请求在哪失败的，A有调用B吗</p>
<p>为什么用户请求/页面hung住了</p>
<p>为什么系统组件这么慢？那个组件最慢？</p>
<p>应用容错性</p>
<p>客户端没有设置timeout导致应用卡住</p>
<p>没有重试机制，某个服务偶尔异常导致用户页面错误</p>
<p>某些节点异常，导致服务响应时间过长</p>
<p>应用升级发布</p>
<p>新版本一次性升级，一旦出错影响范围很大</p>
<p>无法进行AB测试，根据用户属性访问不同版本</p>
<p>服务版本的依赖关系处理不当导致服务不可用</p>
<p>系统安全</p>
<p>服务都是HTTP而非https</p>
<p>没有流量限制，任何人都可以对服务发起攻击</p>
<p>13-2 Istio架构和原理 (11:41)</p>
<p>13-3 部署istio</p>
<p>13-4 部署BookInfo示例应用 (11:38)</p>
<p>13-5 配置请求路由 (08:47)</p>
<p>13-6 故障注入 (07:38)</p>
<p>13-7 流量转移 (09:27)</p>
<p>13-8 设置请求超时 (03:16)</p>
<p>13-9 熔断 (08:44)</p>
<p>13-10 流量镜像 (05:58)</p>
<p>13-11 Istio中的Prometheus和Grafana (11:44)</p>
<p>13-12 分布式追踪Jaeger (09:29)</p>
<p>13-13 网格可视化 (10:59)
第14章 课程总结【沉淀&amp;展望】1 节 | 6分钟
本章中将总结本课程所学知识，展望docker和kubernetes的发展。</p>
<p><a href="https://www.youtube.com/watch?v=2b7MRI6tmMo&amp;list=PLsbVibQXuLjqZwdpSBXR27gNGgtHlQLHR&amp;index=2" target="_blank">https://www.youtube.com/watch?v=2b7MRI6tmMo&list=PLsbVibQXuLjqZwdpSBXR27gNGgtHlQLHR&index=2</a></p>
<p><a href="https://www.youtube.com/watch?v=8MlW9nixkwk&amp;list=PLsbVibQXuLjqw6mCC4QMyLZ282dhdPWr3&amp;index=13" target="_blank">https://www.youtube.com/watch?v=8MlW9nixkwk&list=PLsbVibQXuLjqw6mCC4QMyLZ282dhdPWr3&index=13</a></p>

        </div>

        
        <div class="row pl-3 pr-3">
        
        <div class="col-md-6 share-buttons">
        
          </div>

        
        
          
            
          
          <div class="col-md-6 btn-improve-page">
             
               <a href="https://github.com/airren/airren.github.io/edit/master/content/posts/cloudnative/Kubernates/1-k8s-cloudnative.md" title="Improve this page" target="_blank" rel="noopener">
            
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        
        </div>



      
      <hr />
        







  





  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  


<div class="row next-prev-navigator">
  
  
</div>

      <hr />

      
      
        
    











<script src="https://giscus.app/client.js"
        data-repo="Airren/airren.github.io"
        data-repo-id="R_kgDOIVgjKA"
        data-category="announcements"
        data-category-id="DIC_kwDOIVgjKM4CTB-z"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang=""
        crossorigin="anonymous"
        async>
</script>





      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn"><i class="fas fa-chevron-circle-up"></i></a>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center pl-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#第2章-kubernetes快速入门">第2章 kubernetes快速入门</a>
      <ul>
        <li><a href="#2-1-了解kubernetes">2-1 了解kubernetes</a></li>
      </ul>
    </li>
    <li><a href="#heading"></a>
      <ul>
        <li><a href="#2-2-kubernetes的核心概念">2-2 kubernetes的核心概念</a></li>
        <li><a href="#2-3-kubernetes的架构设计">2-3 kubernetes的架构设计</a></li>
        <li><a href="#2-4-kubernetes认证的密码学原理-1530">2-4 kubernetes认证的密码学原理 (15:30)</a></li>
        <li><a href="#2-5-kubernetes的认证与授权">2-5 kubernetes的认证与授权</a></li>
        <li><a href="#2-6-集群搭建方案对比">2-6 集群搭建方案对比</a></li>
      </ul>
    </li>
    <li><a href="#第3章-容器运行时-docker-or-containerd">第3章 容器运行时-Docker or Containerd</a>
      <ul>
        <li><a href="#6-4-kubernetes的服务发现">6-4 kubernetes的服务发现</a></li>
      </ul>
    </li>
    <li><a href="#第9章-深入kubernete---几个重要的资源对象透过表象看本质装逼可选包4-节--83分钟">第9章 深入kubernete&mdash;几个重要的资源对象【透过表象看本质&amp;装逼可选包】4 节 | 83分钟</a>
      <ul>
        <li><a href="#9-1-namespace-----集群的共享与隔离">9-1 Namespace &mdash; 集群的共享与隔离</a></li>
      </ul>
    </li>
    <li><a href="#第13章-servicemesh代表作istio">第13章 ServiceMesh代表作istio</a></li>
  </ul>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    












  
  
    
  

  
  
    
  

  
  
    
  

  
  
    
    
      
    
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#about">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#skills">Skills</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#recent-posts">Recent Posts</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#achievements">My Story</a>
                </li>
              
            
              
                
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:renqiqiang@outlook.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>renqiqiang@outlook.com</span>
                </a></li>
              
            
          </ul>
        </div>
        
        
        
          
          <div class="col-md-4 col-sm-12">
            <p>Stay up to date with email notification</p>
              
              <form
                action="https://github.us1.list-manage.com/subscribe/post?u=19de52a4603135aae97163fd8&amp;amp;id=094a24c76e"
                method="post"
                id="mc-embedded-subscribe-form"
                name="mc-embedded-subscribe-form"
                class="validate"
                target="_blank"
                novalidate >
                <div class="form-group">
                  <input
                    type="email"
                    class="form-control"
                    id="mce-EMAIL"
                    name="EMAIL"
                    aria-describedby="emailHelp"
                    placeholder="Enter email"
                  />
                  <small id="emailHelp" class="form-text text-muted"
                    >By entering your email address, you agree to receive the newsletter of this website.</small
                  >
                </div>
                <button type="submit" class="btn btn-info">Submit</button>
              </form>
            
          </div>
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">© 2020-2022 Copyright.</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>



    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>









    
</body>
</html>
