<!DOCTYPE html>
<html>
  <head>
    <title>Posts</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>

<link rel="stylesheet" href="/css/flag-icon.min.css"/>


<link rel="stylesheet" href="/google-fonts/Mulish/mulish.css"/>


<link rel="stylesheet" href="/fontawesome/css/all.min.css"/>







  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/site/favicon_hufa9bb061875e5783d83b75135c052e0b_6105_42x0_resize_box_3.png" />

<meta property="og:title" content="Posts" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://airren.github.io/posts/" />


    
    
    <link rel="stylesheet" href="/css/layouts/list.css">
    <link rel="stylesheet" href="/css/navigators/sidebar.css">
    
    <link rel="stylesheet" href="/css/style.css"/>



    




</head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      
        <img src="/images/site/main-logo_hue3dcebd3233f4247380b642debb20e00_8242_42x0_resize_box_3.png" alt="Logo">
      ByteGopher</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
        

  


<li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" href="#" id="languageSelector" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      
        
        <span class="flag-icon flag-icon-gb"></span>
      
      English
    </a>
    <div class="dropdown-menu" aria-labelledby="languageSelector">
      
        <a class="dropdown-item nav-link languages-item" href="/cn/posts">
          
            
            <span class="flag-icon flag-icon-cn"></span>
          
          ä¸­æ–‡
        </a>
      
    </div>
</li>

      
      
      </ul>
    </div>
  </div>
  
  
    <img src="/images/site/main-logo_hue3dcebd3233f4247380b642debb20e00_8242_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/site/inverted-logo_hu625a7b1b3d293b5088d5bed0b0ae5735_6060_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  
  
    
  

  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li><a class="" href="/posts/blog/" title="Blog">Blog</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/cloudnative/" title="CloudNative">CloudNative</a></li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/component/">Infrastructure</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/component/TimeSeries/" title="TimeSeriesDB">TimeSeriesDB</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/kubernetes/" title="Kubernetes">Kubernetes</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/note_c/" title="Note C">Note C</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/note_go/" title="Note Go">Note Go</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/react/" title="React">React</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/tips/" title="Tips">Tips</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/nodus/" title="Nodus">Nodus</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/interview/" title="Interview">Interview</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/life/" title="Life">Life</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/linux/" title="Linux">Linux</a></li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content container-fluid" id="content">
    <div class="container-fluid post-card-holder" id="post-card-holder">
      
      
      
        
          <div class="post-card">
  <a href="/posts/blog/intel_spx_AMX/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">Intel AMXAV</h5>
        <p class="card-text post-summary">Introduce SIMD å•æŒ‡ä»¤æ•°æ®-&gt; VNNI/INT8
Intrinsics for Intel(R) Advanced Matrix Extension Instructions Intel Advanced Matrix Extension is a new 64-bit programming paradigm consisting of two components:
A set of 2-dimensional registers(tiles) representing sub-arrays from a larger 2-dimensional memory image Am accelerator that is able to operate on tiles; the first implementation of this accelerator is called TMUL(tile matrix multiply unit) Intrinsic for Intel Advanced Matrix Extension AMX-BF16 Instructions This intrinsic supports tile computational operations on bfloat16 number.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/blog/intel_spx_AMX/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/blog/3_intel_sgx/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">Intel SGX</h5>
        <p class="card-text post-summary">æ¦‚è¿° https://www.intel.com/content/www/us/en/developer/tools/software-guard-extensions/overview.html
https://blog.quarkslab.com/overview-of-intel-sgx-part-1-sgx-internals.html
Intel Software Guard Extensions(Intel SGX) ä¿æŠ¤é€‰å®šçš„ä»£ç å’Œæ•°æ®ä¸è¢«æ³„éœ²çš„å’Œä¿®æ”¹ã€‚å¼€å‘è€…å¯ä»¥æŠŠåº”ç”¨ç¨‹åºåˆ’åˆ†åˆ°CPUå¼ºåŒ–çš„enclaveä¸­æˆ–è€…å†…å­˜ä¸­å¯æ‰§è¡Œçš„ä¿æŠ¤åŒºåŸŸï¼Œå³ä½¿åœ¨å—æ”»å‡»çš„å¹³å°ä¸­ä¹Ÿå¯ä»¥æé«˜å®‰å…¨æ€§ã€‚ä½¿ç”¨è¿™ç§æ–°çš„åº”ç”¨å±‚å¯ä¿¡æ‰§è¡Œç¯å¢ƒï¼Œå¼€å‘è€…èƒ½å¤Ÿå¯ç”¨èº«ä»½å’Œè®°å½•éšç§ï¼Œå®‰å…¨æµè§ˆå’Œæ•°æ®ä¿æŠ¤(DRM)æˆ–è€…ä»»ä½•éœ€è¦å®‰å…¨å­˜å‚¨æœºå¯†æˆ–è€…ä¿æŠ¤æ•°æ®çš„é«˜ä¿éšœå®‰å…¨åº”ç”¨åœºæ™¯ä¸­ã€‚
æœºå¯†æ€§å’Œå®Œæ•´æ€§ï¼Œ å³ä½¿åœ¨OSã€BIOSã€VMMæˆ–è€…SMMå±‚å­˜åœ¨ç‰¹æƒæ¶æ„è½¯ä»¶çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä¿è¯å®‰å…¨ã€‚ ä½å­¦ä¹ æ›²çº¿ï¼Œå’Œçˆ¶åº”ç”¨ç¨‹åºç±»ä¼¼çš„OSç¼–ç¨‹æ¨¡å‹ï¼Œå¹¶ä¸”åœ¨ä¸»CPUä¸Šæ‰§è¡Œ è¿œç¨‹è®¤è¯ è¿œç¨‹éƒ¨åˆ†èƒ½å¤Ÿè®¤è¯ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„enclaveçš„èº«ä»½ï¼Œå¹¶ä¸”å®‰å…¨çš„å°†å¯†é’¥ã€å‡­æ®å’Œæ•æ„Ÿæ•°æ®æä¾›ä¸ºenclave æœ€å°çš„å¯èƒ½æ”»å‡»é¢ï¼Œ CPUè¾¹ç•Œæˆä¸ºæ”»å‡»é¢å¤–å›´ï¼Œæ‰€æœ‰çš„æ•°æ®ã€å†…å­˜ã€å¤–å›´ä¹‹å¤–çš„IOéƒ½æ˜¯åŠ å¯†çš„ã€‚ æœ€å°æ”»å‡»é¢çš„ç¡¬ä»¶è¾…åŠ©å¯ä¿¡æ‰§è¡Œç¯å¢ƒã€‚
intel SGXä¿æŠ¤çš„åº”ç”¨ç¨‹åº Intel SGXåº”ç”¨ç¨‹åºç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š ä¸å¯ä¿¡ä»£ç å’Œå¯ä¿¡Enclave. å¼€å‘è€…å¯ä»¥åˆ›å»ºä¸€å¯¹å¤šçš„å¯ä¿¡enclaveç”¨æ¥æ”¯æŒåˆ†å¸ƒå¼ä½“ç³»ç»“æ„ã€‚
å¸¸ç”¨åº”ç”¨æœ‰å¯†é’¥ï¼Œä¸“æœ‰ç®—æ³•ï¼Œç”Ÿç‰©è¯†åˆ«æ•°æ®å’ŒCSRç”Ÿæˆç­‰ã€‚
ç¨‹åºè¿è¡Œæ—¶ï¼Œ Intel SGXæŒ‡ä»¤åœ¨ä¸€ä¸ªç‰¹å®šçš„ä¿æŠ¤å†…å­˜åŒºåŸŸä¸­åˆ›å»ºå’Œæ‰§è¡Œenclaveï¼Œè¯¥åŒºåŸŸæœ‰ç”±å¼€å‘è€…å®šä¹‰çš„å—é™å…¥å£å’Œå‡ºå£å‡½æ•°ã€‚èƒ½å¤Ÿé˜²æ­¢æ•°æ®æ³„éœ²ã€‚åœ¨CPUèŒƒå›´ä¸­çš„enclaveå’Œæ•°æ®è¿è¡Œåœ¨ä¸€ä¸ªcleançš„ç¯å¢ƒä¸­ï¼Œ enclaveæ•°æ®å†™å…¥åˆ°ç£ç›˜ä¼šè¢«åŠ å¯†ï¼Œå¹¶ä¸”æ ¡éªŒå…¶å®Œæ•´æ€§ã€‚
ä¸Šå›¾ä¸­çš„æµç¨‹
Applicationç”±å¯ä¿¡å’Œä¸å¯ä¿¡éƒ¨åˆ†æ„æˆ Appè¿è¡Œå’Œåˆ›å»ºevclaveï¼Œ enclaveæ”¾å…¥åˆ°å¯ä¿¡å†…å­˜ä¸­ å¯ä¿¡å‡½æ•°è¢«è°ƒç”¨ï¼Œæ‰§è¡Œä¼šè½¬æ¢åˆ°enclaveä¸­ enclaveå¯ä»¥è®¿é—®æ‰€æœ‰è¿›ç¨‹æ•°æ®ï¼Œå¤–éƒ¨è¦è®¿é—®enclaveæ•°æ®è¢«ç¦æ­¢ å¯ä¿¡å‡½æ•°è¿”å›enclaveæ•°æ® å¯¹enclaveæœ‰æœªæˆæƒçš„è®¿é—®å’Œå†…å­˜ä¾¦å¬æ˜¯æœ‰å¯èƒ½çš„
è®¤è¯Enclaveå’ŒåŠ å¯†æ•°æ® å½“å‰ï¼ŒODM(åŸå§‹è®¾å¤‡åˆ¶é€ ä¸Š)å’ŒISV(ç‹¬ç«‹è½¯ä»¶æä¾›å•†) é€šå¸¸åœ¨åˆ¶é€ æ—¶æˆ–é€šè¿‡æ— æ³•ä»¥æœºå¯†æ–¹å¼è¯æ˜XXXã€‚
Intel SGXä½¿ç”¨enclaveä¹‹é—´æœ¬åœ°è®¤è¯æˆ–è€…ç¬¬ä¸‰æ–¹è¿œç¨‹è®¤è¯çš„æ–¹å¼æ¥ä¿è¯åº”ç”¨ç¨‹åºæ²¡æœ‰å—åˆ°ç ´åã€‚
åº”ç”¨ç¨‹åºå—ä¿æŠ¤çš„éƒ¨åˆ†ä¼šåŠ è½½åˆ°ä¸€ä¸ªEnclaveï¼Œå®ƒçš„ä»£ç å’Œæ•°æ®éƒ½ä¼šæ”¶åˆ°ç›‘æµ‹ã€‚ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚åˆ°è¿œç«¯æœåŠ¡å™¨ï¼Œç”¨æ¥éªŒè¯è¿™ä¸ªEnclaveæ˜¯å¦æ˜¯å¯é çš„Intel å¤„ç†å™¨ç”Ÿæˆçš„ã€‚ å¦‚æœè®¤è¯äº†Enclaveçš„èº«ä»½ï¼Œè¿œç«¯å°±ä¼šä¿¡ä»»Enclaveå¹¶å®‰å…¨çš„æä¾›å¯†é’¥ï¼Œå‡­è¯å’Œæ•°æ®.
Intel SGX åŒ…æ‹¬ä¸€ä¸ªç”ŸæˆCPUå’ŒEnclaveç‰¹å®šâ€œå¯†å°å¯†é’¥â€çš„æŒ‡ä»¤ã€‚å¯†é’¥èƒ½å¤Ÿç”¨æ¥å®‰å…¨çš„å­˜å‚¨å’Œå–å›å¯é¥ä½ éœ€è¦ä¿å­˜åœ¨ç£ç›˜ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚
Intel SGX å®ç°æ–°çš„å®‰å…¨æ¨¡å‹ Intel SGX æ˜¯åœ¨å¾ˆå¤šå…¬å¸ã€å¤§å­¦çš„å®‰å…¨ç ”ç©¶äººå‘˜ä»¥åŠæ”¿åºœå®‰å…¨æœºæ„çš„æ”¯æŒä¸‹åˆ›å»ºçš„ï¼Œä¸Šç™¾å®¶ISVä¸Intelåˆä½œï¼Œä½¿ç”¨Intel SGXæ¥ä¿æŠ¤å…³é”®ä»»åŠ¡åº”ç”¨ç¨‹åºã€‚
Set up SGX develop environment Install SGX driver
Install SGX SDK
Install SGX PSW
ç›´æ¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ä¾æ¬¡å®‰è£…ä¸Šè¿°3ä¸ªç»„ä»¶
Sample Enclave Demo 1############# SGX SDK Setting 2# ç¼–è¯‘å¹³å°å’Œæ¨¡å¼é…ç½® 3 4############## APP Setting 5# ä¸»è¦æ˜¯æŒ‡å®š 6# App_Cpp_Files éœ€è¦ç¼–è¯‘çš„cppæ–‡ä»¶ 7# App_Include_Paths åŒ…å«ç›®å½• 8# App_Cpp_Objects è¾“å‡º 9 10############### Enclave setting 11# Enclave_Cpp_Files 12# Enclave_Include_Paths 13# Enclave_Cpp_Objects 14 15# eld ç¼–è¯‘é…ç½® 16################ App Object 17################ Enclave Object Enclave ç›¸å…³å¼€å‘æµç¨‹ ä½¿ç”¨edlæ–‡ä»¶å®šä¹‰ä¸å¯ä¿¡appå’Œenclaveä¹‹é—´çš„æ¥å£ å®ç°appå’Œenclaveå‡½æ•° ç¼–è¯‘ app å’Œenclaveã€‚ç¼–è¯‘ä¸­ Edger8rç”Ÿæˆå¯ä¿¡å’Œä¸å¯ä¿¡çš„ä»£ç†/æ¡¥å‡½æ•°ï¼ŒEnclaveç­¾åå·¥å…·ç”Ÿæˆenclaveçš„metadataå’Œç­¾å åœ¨æ¨¡æ‹Ÿå’Œç¡¬ä»¶æ¨¡å¼ä¸‹è¿è¡Œå’Œè°ƒè¯•appï¼Œè¯¦ç»†çœ‹debug enclaveçš„å†…å®¹ å‡†å¤‡å‘å¸ƒapp å’Œenclave ç¼–å†™Enclaveå‡½æ•° åœ¨appè§’åº¦ï¼Œä½¿ç”¨ä¸å¯ä¿¡ä»£ç†å‡½æ•°è°ƒç”¨enclaveå‡½æ•°(ECALL)è·Ÿè°ƒç”¨å…¶ä»–å‡½æ•°æ²¡æœ‰åŒºåˆ«ã€‚Enclaveå‡½æ•°åªæ˜¯æœ‰äº›æ˜¾ç¤ºçš„c/c++å‡½æ•°ã€‚</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/blog/3_intel_sgx/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/linux/network_ipsec/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">IPSec</h5>
        <p class="card-text post-summary">IPsec is a group of networking protocols used for setting up secure encrypted connections, such VPNs, across publicly shared networks.
What is IPsec IPsec is a group of protocols that are used together to set up encrypted connections between devices. It helps keep data send over public networks secure. IPsec is often used to set up VPNs, and it works by encrypting IP packets, along with authenticating the source where the packets come from.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/linux/network_ipsec/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/linux/network_iptables/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">iptables</h5>
        <p class="card-text post-summary">é˜²ç«å¢™ é€»è¾‘ä¸Šï¼Œé˜²ç«å¢™å¯ä»¥åˆ†ä¸ºä¸»æœºé˜²ç«å¢™å’Œç½‘ç»œé˜²ç«å¢™ã€‚ä¸»æœºé˜²ç«å¢™é’ˆå¯¹å•ä¸ªä¸»æœºè¿›è¡Œé˜²æŠ¤ï¼›ç½‘ç»œé˜²ç«å¢™å¾€å¾€å¤„äºç½‘ç»œå…¥å£æˆ–è€…è¾¹ç¼˜ï¼Œé’ˆå¯¹ç½‘ç»œå…¥å£è¿›è¡Œé˜²æŠ¤ï¼ŒæœåŠ¡äºé˜²ç«å¢™èƒŒåçš„æœ¬åœ°å±€åŸŸç½‘ã€‚
ç‰©ç†ä¸Šï¼Œé˜²ç«å¢™å¯ä»¥åˆ†ä¸ºç¡¬ä»¶é˜²ç«å¢™å’Œè½¯ä»¶é˜²ç«å¢™ã€‚ç¡¬ä»¶é˜²ç«å¢™åœ¨ç¡¬ä»¶çº§åˆ«å®ç°éƒ¨åˆ†é˜²ç«å¢™åŠŸèƒ½ï¼Œå¦ä¸€éƒ¨åˆ†åŸºäºè½¯ä»¶å®ç°ï¼Œæ€§èƒ½é«˜ï¼Œæˆæœ¬é«˜ï¼›è½¯ä»¶é˜²ç«å¢™åº”ç”¨è½¯ä»¶å¤„ç†é€»è¾‘è¿è¡Œäºé€šç”¨è®¡ç®—å¹³å°ä¹‹ä¸Šçš„é˜²ç«å¢™ï¼Œæ€§èƒ½ä½ï¼Œæˆæœ¬ä½ã€‚
iptables/netfilter iptableså…¶å®ä¸æ˜¯çœŸæ­£çš„é˜²ç«å¢™ï¼Œå¯ä»¥æŠŠå®ƒç†è§£é™ˆä¼Ÿä¸€ä¸ªå®¢æˆ·ç«¯ä»£ç†ï¼Œç”¨æˆ·é€šè¿‡iptablesè¿™ä¸ªä»£ç†ï¼Œå°†ç”¨æˆ·çš„å®‰å…¨è®¾å®šæ‰§è¡Œåˆ°å¯¹åº”çš„â€œå®‰å…¨æ¡†æ¶â€ä¸­ï¼Œè¿™ä¸ªâ€œå®‰å…¨æ¡†æ¶â€æ‰æ˜¯çœŸæ­£çš„é˜²ç«å¢™ï¼Œ è¿™ä¸ªæ¡†æ¶çš„åå­—å«netfilterã€‚
netfilteræ‰æ˜¯é˜²ç«å¢™çœŸæ­£çš„å®‰å…¨æ¡†æ¶ï¼Œä½äºå†…æ ¸ç©ºé—´ã€‚iptableså…¶å®æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œ ä½äºç”¨æˆ·ç©ºé—´ï¼Œæˆ‘ä»¬ä½¿ç”¨iptablesè¿™ä¸ªå·¥å…·æ“ä½œçœŸæ­£çš„æ¡†æ¶netfilterã€‚
netfilter/iptablesç»„æˆçš„linuxå¹³å°ä¸‹çš„åŒ…è¿‡æ»¤é˜²ç«å¢™ï¼Œæ˜¯å…è´¹çš„ï¼Œå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š
ç½‘ç»œåœ°å€è½¬æ¢(NAT, Network Address Translate) æ•°æ®åŒ…å†…å®¹ä¿®æ”¹ æ•°æ®åŒ…è¿‡æ»¤(é˜²ç«å¢™åŠŸèƒ½) æˆ‘ä»¬è™½ç„¶å¯ä»¥ä½¿ç”¨service iptables startå¯ç”¨iptablesæœåŠ¡ï¼Œä½†å…¶å®å‡†ç¡®çš„æ¥è¯´iptableså¹¶æ²¡æœ‰ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œä¸èƒ½ç®—æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æœåŠ¡ï¼Œè€Œç®—æ˜¯å†…æ ¸æä¾›çš„åŠŸèƒ½ã€‚
iptablesæ˜¯æŒ‰ç…§è§„åˆ™(rules)æ¥åŠäº‹çš„, rules å°±æ˜¯æˆ‘ä»¬é¢„å®šä¹‰çš„æ¡ä»¶ã€‚è§„åˆ™ä¸€èˆ¬å®šä¹‰ä¸ºâ€œå¦‚æœæ•°æ®åŒ…å¤´ç¬¦åˆè¿™æ ·çš„æ¡ä»¶ï¼Œå°±è¿™æ ·å¤„ç†è¿™ä¸ªæ•°æ®åŒ…â€ã€‚è§„åˆ™å­˜å‚¨åœ¨å†…æ ¸ç©ºé—´çš„ä¿¡æ¯åŒ…è¿‡æ»¤è¡¨ä¸­ã€‚è¿™äº›è§„åˆ™åˆ†åˆ«æŒ‡å®šäº†æºåœ°å€ã€ç›®çš„åœ°å€ã€ä¼ è¾“åè®®(å¦‚TCPã€UDPã€ICMP)å’ŒæœåŠ¡ç±»å‹(å¦‚HTTPã€FTPå’ŒSMTP)ç­‰ã€‚å½“æ•°æ®åŒ…ä¸è§„åˆ™åŒ¹é…æ—¶ï¼Œiptableså°±æ ¹æ®è§„åˆ™æ‰€å®šä¹‰çš„æ–¹æ³•æ¥å¤„ç†è¿™äº›æ•°æ®åŒ…ï¼Œ å¦‚æ”¾è¡Œ(accept)ã€æ‹’ç»(reject)å’Œä¸¢å¼ƒ(drop)ç­‰ã€‚é…ç½®é˜²ç«å¢™ä¸»è¦å·¥ä½œå°±æ˜¯æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤è¿™äº›è§„åˆ™ã€‚
ewctl
hubDevice Objcet true é»˜è®¤hub</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/linux/network_iptables/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/blog/4_istio_multicluster/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">Istio MultiCluster</h5>
        <p class="card-text post-summary">Multicluster Replicated Control Plane is an uses case to enable communication between two service in difference service mesh without using Ingress and can enable mutual TLS between the service.
Istio 1.8 Upgrade Notes
Multicluster .global Stub Domain Deprecation As part of this release, Istio has switched to a new configuration for multi-primary (formerly â€œreplicated control planesâ€). The new configuration is simpler, has fewer limitations, and has been thoroughly tested in a variety of environments.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/blog/4_istio_multicluster/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/1-k8s-cloudnative/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Cloud Native</h5>
        <p class="card-text post-summary">Kubenetesç”Ÿäº§è½åœ°å…¨ç¨‹å®è·µ
æ ¸å¿ƒæ¦‚å¿µ
æ¶æ„è®¾è®¡
è®¤è¯æˆæƒ
é«˜å¯ç”¨é›†ç¾¤æ­å»º
äºŒè¿›åˆ¶&amp; kubeadm
3å°masterä¸¤å°2 node
calicoã€corednsã€dashboard
ä¸šåŠ¡è¿ç§»åˆ°Kubenetes
Harbor
æœåŠ¡å‘ç°ç­–ç•¥
IngressNginx
Docker åŒ–æœåŠ¡ã€K8sã€æœåŠ¡å‘ç°
CICD
namespaceã€resourcesã€label
æœåŠ¡çš„è°ƒåº¦ä¸ç¼–æ’
å¥åº·æ£€æŸ¥
è°ƒåº¦ç­–ç•¥
éƒ¨ç½²ç­–ç•¥
æ—¥å¿—ä¸ç›‘æ§
ç¬¬2ç«  kuberneteså¿«é€Ÿå…¥é—¨ æœ¬ç« ä¸­å°†ä»æ ¸å¿ƒæ¦‚å¿µã€æ¶æ„è®¾è®¡ã€è®¤è¯æˆæƒä»¥åŠé›†ç¾¤æ­å»ºæ–¹æ¡ˆå¯¹æ¯”å‡ æ–¹é¢ï¼Œå¸¦é¢†å¤§å®¶å¿«é€ŸæŒæ¡kubernetesçš„é‡è¦çŸ¥è¯†ç‚¹ï¼ŒåŠ©åŠ›å¿«é€Ÿå…¥é—¨ã€‚
2-1 äº†è§£kubernetes èˆµæ‰‹ï¼š æ¸”ç½‘ã€æ¸”èˆ¹ docker : é²¸é±¼ï¼Œé›†è£…ç®± ğŸ³
Kubernetes is an open-source system for automating deployment, scaling, and management of containerized applications.
It groups containers that makeup application in to logical units for easy management and discovery.Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/1-k8s-cloudnative/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/9-k8s-configmap/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s ConfigMap</h5>
        <p class="card-text post-summary">ç»™Podä¼ é€’å‚æ•° é€šè¿‡ç¯å¢ƒå˜é‡ç»™Podä¼ é€’å‚æ•° å¯ä»¥åœ¨containerçš„æè¿°æ–‡ä»¶ä¸­åŠ å…¥ä¸€ä¸ªenvçš„å‚æ•°ï¼Œå€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯é”®å€¼å¯¹ï¼Œå€¼æ˜¯stringã€‚
1--- 2apiVersion: v1 3kind: Pod 4metadata: 5 name: first-pod 6 labels: 7 app: nginx 8spec: 9 containers: 10 - name: 00-simple-pod-nginx 11 image: nginx:1.17.0 12 env: 13 - name: INTERVAL 14 value: 30s é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç»™Podä¼ é€’å‚æ•° åŠ å…¥ä¸€ä¸ªargsé…ç½®ï¼Œå‘½ä»¤è¡Œå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/9-k8s-configmap/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/7-k8s-daemonset/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s DaemonSet</h5>
        <p class="card-text post-summary">NodeExporter ç”¨äºé‡‡é›†ä¸€ä¸ªHostä¸Šçš„å„ç§æ€§èƒ½æŒ‡æ ‡ï¼Œå¹¶ä¸”æš´éœ²ç»™Prometheus é‡‡é›†ã€‚å› ä¸ºNodeExporteréœ€è¦é‡‡é›†æ¯ä¸€ä¸ªHostçš„æ•°æ®çŠ¶æ€ï¼Œæ‰€ä»¥å°±äº§ç”Ÿäº†ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨æ¯ä¸€ä¸ªK8sçš„æœºå™¨ä¸Šéƒ½è¦è¿è¡Œä¸€ä¸ªPod, è€Œå®ç°è¿™ä¸ªéœ€æ±‚çš„K8sèµ„æºç±»å‹å°±å«åšDaemonSetã€‚
DaemonSet DaemonSetçš„åŠŸèƒ½å°±æ˜¯ä¿è¯æ¯ä¸ªNodeéƒ½è¿è¡ŒPodï¼Œ ä½†æ˜¯å¦‚æœæŸä¸ªK8sçš„Nodeä¸‹çº¿ä¹‹åï¼Œå¯¹åº”çš„Podä¹Ÿä¸‹çº¿ï¼Œè¿˜æ˜¯ä¿æŒæ¯ä¸ªNodeä¸€ä¸ªPodã€‚å¦‚æœæ–°å¢ä¸€ä¸ªNodeï¼Œå°±ä¼šåœ¨æ–°å¢çš„Nodeä¸­å¢åŠ ä¸€ä¸ªPodï¼Œä¿è¯æ‰€æœ‰çš„Nodeä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªå½“å‰Podã€‚
1--- 2apiVersion: apps/v1 3kind: DaemonSet 4metadata: 5 name: node-exporter 6 namespace: kube-system 7 labels: 8 k8s-app: node-exporter 9 kubernetes.io/cluster-service: &#34;true&#34; 10 addonmanager.kubernetes.io/mode: Reconcile 11 version: v1.2.2 12spec: 13 selector: 14 matchLabels: 15 k8s-app: node-exporter 16 version: v1.2.2 17 updateStrategy: 18 type: OnDelete 19 template: 20 metadata: 21 labels: 22 k8s-app: node-exporter 23 version: v1.2.2 24 spec: 25 priorityClassName: system-node-critical 26 containers: 27 - name: prometheus-node-exporter 28 image: &#34;prom/node-exporter:v1.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/7-k8s-daemonset/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/5-k8s-deployment/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Deployments</h5>
        <p class="card-text post-summary">è“ç»¿éƒ¨ç½² è“ç»¿éƒ¨ç½²æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„éƒ¨ç½²æ–¹å¼ï¼Œç»å¸¸ä¼šç”¨äºæ–°æ—§ç‰ˆæœ¬ä¸å…¼å®¹çš„æƒ…å†µã€‚
å…ˆå°†æ–°ç‰ˆæœ¬(ç»¿ç‰ˆ)çš„æœåŠ¡è¿è¡Œèµ·æ¥ã€‚ å°†æ‰€æœ‰çš„æµé‡åˆ‡åˆ°æ–°ç‰ˆæœ¬çš„æœåŠ¡ä¸Š åˆ é™¤æ—§ç‰ˆæœ¬(è“ç‰ˆ)çš„æœåŠ¡ åˆ›å»ºæ–°ç‰ˆæœ¬çš„ReplicaSetï¼Œå°†ServiceæŒ‡å‘æ–°çš„Podsï¼Œåˆ é™¤æ—§ç‰ˆæœ¬çš„ReplicaSet
æ»šåŠ¨å‡çº§ è“ç»¿éƒ¨ç½²å¯ä»¥æœ‰æ•ˆä¿è¯ä¸šåŠ¡çš„æ­£ç¡®æ€§ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„é£é™©ï¼Œä¾‹å¦‚ç¨³å®šæ€§ã€‚
å‡è®¾æ–°éƒ¨ç½²çš„åº”ç”¨æ˜¯æœ‰é—®é¢˜çš„ï¼Œä¸€æ—¦åˆ‡æ¢ä¹‹åå°±ä¼šå¯¼è‡´ä¸šåŠ¡çš„å´©æºƒï¼Œé€ æˆæŸå¤±ã€‚äºæ˜¯å°±æœ‰äº†ç¨å¾®å‹å¥½çš„å‡çº§æ–¹å¼ï¼Œæ»šåŠ¨å‡çº§ã€‚
å…ˆå…³é—­ä¸€ä¸ªæ—§ç‰ˆæœ¬çš„å®ä¾‹ å¼€å¯ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„å®ä¾‹ç”¨äºæ›¿æ¢æ—§ç‰ˆæœ¬ æ›¿æ¢æˆåŠŸæ—¶å€™å¾ªç¯1å’Œ2ï¼Œç›´åˆ°æ‰€æœ‰çš„å®ä¾‹å‡çº§å®Œæˆã€‚ åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸­é€”å‘ç°å¼‚å¸¸å¯ä»¥åŠæ—¶åœæ‰‹ï¼ŒåŠæ—¶æ­¢æŸã€‚è€Œä¸”Kubernetesä¹Ÿåœ¨å®¢æˆ·ç«¯ä¸­æ”¯æŒäº†è¿™ä¸ªç‰¹æ€§ã€‚kubectl rolling-updateã€‚
å‡çº§å‰åRCçš„Selectoréƒ½è¢«æ”¹å˜äº† æ“ä½œéƒ½æ˜¯åœ¨å®¢æˆ·ç«¯æ‰§è¡Œçš„ï¼Ÿ é‡‘ä¸é›€å‘å¸ƒ é‡‘ä¸é›€å‘å¸ƒæ˜¯æ»šåŠ¨å‘å¸ƒçš„ä¸€ç§ç‰¹ä¾‹ï¼Œåœ¨æ»šåŠ¨å‘å¸ƒä¸­ï¼Œæ˜¯ä¸ä¼šç­‰å¾…çš„ï¼Œé™¤éä¸­é—´å‡ºé”™äº†ã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦å…¨éƒ½å‡çº§ï¼Œå¯èƒ½åªæ˜¯å¤„äºPOCçš„ä¸€äº›åŸå› ï¼Œæˆ‘ä»¬åªå¸Œæœ›éƒ¨åˆ†å®ä¾‹æ˜¯æ–°çš„ï¼Œå¤§éƒ¨åˆ†æ˜¯æ—§çš„ï¼Œè€Œè¿™ç§æƒ…å½¢ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºé‡‘ä¸é›€å‘å¸ƒã€‚
å‡çº§å°‘éƒ¨åˆ†å®ä¾‹ æŸ¥çœ‹æ•ˆæœï¼Œå¦‚æœå¥½ï¼Œå…¨éƒ¨å‡çº§ å¦‚æœä¸å¥½ï¼Œåˆ™ä¸å‡çº§ å£°æ˜å¼å‡çº§ å‰é¢ä»‹ç»çš„è¿™äº›å‡çº§å‘å¸ƒæ–¹å¼åœ¨K8sä¸Šå¾ˆå¤šæ—¶å€™æ˜¯åŠæ‰‹å·¥æ–¹å¼æ‰§è¡Œçš„ï¼Œè€ŒKubernetesä½œä¸ºä¸€æ¬¾DevOPSå‹å¥½çš„ç³»ç»Ÿï¼Œå·²ç»å†…ç½®äº†å¯¹äºéƒ¨ç½²æ–¹å¼çš„ä¸€ç§èµ„æºæŠ½è±¡ï¼Œè¿™ä¸ªèµ„æºå°±æ˜¯ï¼šDeploymentã€‚
Deployment &ndash;&gt; ReplicaSet &ndash;&gt; Pods
Deployment å­˜åœ¨çš„æ„ä¹‰ä¸ºï¼šåœ¨å‡çº§åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦å¼•å…¥é¢å¤–çš„ReplicaSetï¼Œå¹¶åè°ƒæ–°æ—§ä¸¤ä¸ªRSï¼Œä½¿ä»–ä»¬å†æ ¹æ®å½¼æ­¤ä¸æ–­ä¿®æ”¹ï¼Œè€Œä¸ä¼šé€ æˆå¹²æ‰°ã€‚Deploymentå°†è¿™äº›è¿ç»´è¿‡ç¨‹éƒ½ä»£ç åŒ–ï¼Œå†…ç½®ä¸ºè‡ªå·±çš„é€»è¾‘ï¼Œä»è€Œè®©å‡çº§å˜å¾—ç®€å•ã€‚
é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Deploymentåˆ›å»º3ä¸ªå®ä¾‹
1# deploy.yaml 2--- 3apiVersion: apps/v1 4kind: Deployment 5metadata: 6 name: first-deployment 7 labels: 8 app: simple-pod-deployment 9spec: 10 replicas: 3 11 selector: 12 matchLabels: 13 app: simple-pod-deployment 14 template: 15 metadata: 16 name: simple-pod-deployment 17 labels: 18 app: simple-pod-deployment 19 spec: 20 containers: 21 - name: simple-pod-de 22 image: lukelau/rest-docker:0.</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/5-k8s-deployment/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/6-k8s-job/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Job</h5>
        <p class="card-text post-summary">Replicas å’Œdeploymentè¿™ä¸¤ç±»èµ„æºéƒ½æ˜¯ç”¨äºæ§åˆ¶workloadçš„ã€‚è¿™ä¸¤ç§ç±»å‹çš„èµ„æºä¸€èˆ¬éƒ½æ˜¯æŒç»­è¿è¡Œçš„ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€äº›è¾…åŠ©æ–¹å¼å¸®åŠ©workloadå‡ºç°å¼‚å¸¸æ—¶æ¢å¤ï¼Œä»¥åŠæ ¹æ®æƒ…å†µè¿›è¡ŒåŠ¨æ€ä¼¸ç¼©çš„ç‰¹æ€§ã€‚
Job æ ¹æ®Jobçš„å®šä¹‰åˆ›å»ºå‡ºå¯¹åº”çš„Podï¼Œç„¶åå…³æ³¨Podçš„çŠ¶æ€ï¼Œ ç›´åˆ°æ»¡è¶³å®šä¹‰ã€‚ä¾‹å¦‚Podæ‰§è¡ŒæˆåŠŸäº†æˆ–è€…æ‰§è¡Œå¤±è´¥äº†ï¼Œå¹¶ä¸”è¾¾åˆ°äº†é‡è¯•æ¬¡æ•°ã€‚
1--- 2apiVersion: batch/v1 3kind: Job 4metadata: 5 name: pi 6spec: 7 template: 8 spec: 9 containers: 10 - name: pi 11 image: perl 12 command: [&#34;perl&#34;, &#34;-Mbignum=bpi&#34;,&#34;-wle&#34;, &#34;print bpi(2000)&#34;] 13 restartPolicy: Never 14 backoffLimit: 4 Jobæ­£å¸¸æ‰§è¡Œç»“æŸåç»“æœå¦‚ä¸Šå›¾ã€‚è¿™æ˜¯ä¸€ä¸ªåªæ‰§è¡Œä¸€æ¬¡çš„Jobã€‚å®ƒçš„æ“ä½œæ–¹å¼å°±æ˜¯åˆ›å»ºä¸€ä¸ªPodï¼Œç„¶åè¿è¡Œä¸€éï¼Œç„¶åå°±é€€å‡ºã€‚å¦‚æœæƒ³æ‰§è¡Œå¤šæ¬¡ï¼Œåˆ™åªéœ€è¦å¢åŠ ä¸€ä¸ªå‚æ•°
1completions: 2 æ‰§è¡Œ2æ¬¡æ—¶åˆ›å»ºäº†ä¸¤ä¸ªPodï¼Œç„¶åä¿è¯è¿™ä¸¤ä¸ªPodéƒ½æ‰§è¡ŒæˆåŠŸã€‚
æˆ‘ä»¬åœ¨ä½¿ç”¨Deploymentç­‰Workloadçš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šæŒ‡å®šrestartPolicyï¼Œé»˜è®¤éƒ½æ˜¯RestartOnFailã€‚åœ¨Jobä¸­ä¸èƒ½è¿™ä¹ˆæŒ‡å®šï¼Œå› ä¸ºè¿™ä¸ªé€»è¾‘åº”è¯¥ç”±Jobæ¥æ§åˆ¶ï¼Œ è€Œä¸æ˜¯è®©Podæ¥æ§åˆ¶ã€‚
CronJob å®šæ—¶ä»»åŠ¡ï¼Œ CronJobå°±æ˜¯åœ¨Jobçš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†å‘¨æœŸå®šä¹‰çš„API
1--- 2apiVersion: batch/v1 3kind: CronJob 4metadata: 5 name: batch-job-pi 6spec: 7 schedule: &#34;0,15,30,45 * * * *&#34; 8 jobTemplate: 9 spec: 10 template: 11 metadata: 12 labels: 13 app: pi-job 14 spec: 15 containers: 16 - name: pi 17 image: perl 18 command: [&#34;perl&#34;, &#34;-Mbignum=bpi&#34;,&#34;-wle&#34;, &#34;print bpi(2000)&#34;] 19 restartPolicy: Never </p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/6-k8s-job/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/kubernetes/k8s_ops_network/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s network</h5>
        <p class="card-text post-summary">å®¹å™¨ç½‘ç»œ æ¯ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æœ‰ä¸€ä¸ªè‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œæ ˆï¼Œè¿™ä¸ªç‹¬ç«‹çš„ç½‘ç»œæ ˆæ˜¯åŸºäºLinuxçš„Network Namespaceå®ç°çš„ã€‚
è¿™ä¸ªç‹¬ç«‹çš„ç½‘ç»œæ ˆåŒ…å«äº†ï¼š Network Interfaceã€Loopback Deviceã€Routing Tableå’ŒIPtablesè§„åˆ™ã€‚å¯¹äºä¸€ä¸ªè¿›ç¨‹æ¥è¯´ï¼Œè¿™äº›è¦ç´ å°±æ„æˆäº†å®ƒå‘èµ·å’Œå“åº”ç½‘ç»œè¯·æ±‚çš„åŸºæœ¬ç¯å¢ƒã€‚
å®¹å™¨å¯ä»¥ä½¿ç”¨è‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œæ ˆ(åˆ›å»ºå±äºè‡ªå·±çš„Network Namespace)ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Hostçš„ç½‘ç»œæ ˆ(ä¸åˆ›å»ºNetwork Namespace)ã€‚
1# Uset -net=host to share the host network 2docker run -d -net=host --name nginx-host nginx ç›´æ¥ä½¿ç”¨Hostçš„ç½‘ç»œæ ˆå¯ä»¥æä¾›è‰¯å¥½çš„ç½‘ç»œæ€§èƒ½ï¼Œä½†æ˜¯ä¸å¯é¿å…çš„ä¼šå¼•å…¥ç½‘ç»œèµ„æºå…±äº«çš„é—®é¢˜ï¼Œæ¯”å¦‚ç«¯å£å†²çªã€‚å¤§å¤šæ•°åº”ç”¨åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å®¹å™¨èƒ½å¤Ÿæœ‰è‡ªå·±ç‹¬ç«‹çš„IPåœ°å€å’Œç«¯å£ï¼Œå³æœ‰è‡ªå·±ç‹¬ç«‹çš„Namespaceã€‚
è¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨è¿™ä¸ªè¢«éš”ç¦»çš„å®¹å™¨è¿›ç¨‹ä¸­å¦‚ä½•ä¸å…¶ä»–çš„Network Namespaceé‡Œçš„å®¹å™¨è¿›ç¨‹è¿›è¡Œäº¤äº’å‘¢ã€‚
ä¸€èˆ¬æˆ‘ä»¬å¦‚æœå¸Œæœ›ä¸¤å°ä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œç›´æ¥ç”¨ç½‘çº¿æŠŠè¿™ä¸¤å°ä¸»æœºè¿æ¥èµ·æ¥å³å¯ï¼›è€Œå¦‚æœæ˜¯å¤šå°ä¸»æœºä¹‹é—´é€šä¿¡æˆ‘ä»¬å¯ä»¥å°†å…¶è¿æ¥åœ¨åŒä¸€å°äº¤æ¢æœºä¸Šã€‚
åœ¨Linuxç³»ç»Ÿä¸­ï¼Œèƒ½å¤Ÿèµ·åˆ°è™šæ‹Ÿäº¤æ¢æœºä½œç”¨çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡æ˜¯Bridgeï¼Œæ˜¯äºŒå±‚ç½‘ç»œè®¾å¤‡ã€‚ä¸»è¦åŠŸèƒ½æ˜¯æ ¹æ®MACåœ°å€æ¥å°†æ•°æ®åŒ…è½¬å‘åˆ°ç½‘æ¡¥çš„ä¸åŒPortä¸Šã€‚
ä¸ºäº†å®ç°ä¸Šè¿°ç›®çš„ï¼Œdockeré¡¹ç›®ä¼šåœ¨Hostä¸Šåˆ›å»ºä¸€ä¸ªdocker0çš„ç½‘æ¡¥ï¼Œå‡¡æ˜¯è¿æ¥åœ¨docker0ç½‘æ¡¥ä¸Šçš„å®¹å™¨ï¼Œå°±ç›¸å½“äºåœ¨åŒä¸€ä¸ªäºŒå±‚ç½‘ç»œã€‚
æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•æŠŠå®¹å™¨è¿æ¥åˆ°docker0ç½‘æ¡¥ä¸Šï¼Œè¿™å°±éœ€è¦veth pairçš„è™šæ‹Ÿè®¾å¤‡äº†ã€‚veth pairåˆ›å»ºå‡ºæ¥ä»¥åæ€»æ˜¯ä»¥ä¸¤å¼ è™šæ‹Ÿç½‘å¡veth peerçš„å½¢å¼æˆå¯¹å‡ºç°çš„ã€‚å¹¶ä¸”ä»å…¶ä¸­ä¸€ä¸ªpeerå‘å‡ºçš„æ•°æ®åŒ…å¯ä»¥ç›´æ¥å‡ºç°åœ¨ä¸ä¹‹å¯¹åº”çš„å¦ä¸€ä¸ªpeerä¸Šï¼Œå³ä½¿veth pairçš„ä¸¤ç«¯ä¸åœ¨åŒä¸€ä¸ªNetwork Namespace ä¸­ã€‚å› æ­¤ï¼Œveth pairå¸¸å¸¸ç”¨ä½œè¿æ¥ä¸åŒNetwork Namespaceçš„ç½‘çº¿ã€‚</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/kubernetes/k8s_ops_network/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
        
          <div class="post-card">
  <a href="/posts/cloudnative/Kubernates/1-k8s-overview/" class="post-card-link">
    <div class="card">
      <div class="card-head">
        <img class="card-img-top" src='/images/default-hero.jpg' alt="Hero Image">
      </div>
      <div class="card-body">
        <h5 class="card-title">K8s Overview</h5>
        <p class="card-text post-summary">Node èŠ‚ç‚¹ä¸»è¦è´Ÿè´£å®¹å™¨çš„ç®¡ç†ï¼Œç”¨äºè¿è¡Œå®¹å™¨å’Œä¿è¯å®¹å™¨çš„çŠ¶æ€ã€‚é»˜è®¤æƒ…å†µä¸‹MasterèŠ‚ç‚¹ä¸æ‰¿æ‹…NodeèŠ‚ç‚¹çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç‰¹æ®Šçš„é…ç½®è®©MasterèŠ‚ç‚¹ä¹Ÿå¯ä½œä¸ºNodeèŠ‚ç‚¹ã€‚
Etcdç”¨äºå­˜å‚¨Kubernetesçš„å…ƒæ•°æ®ï¼Œä½†æ˜¯ä¸è¦æ±‚ä¸€å®šè¦ä»¥å®¹å™¨çš„å½¢å¼è¿è¡Œã€‚
1kubeadm init --pod-network-cidr=10.244.0.0/16 --apiserver-advertise-address=192.168.0.22 --pod-network-cidr pod çš„ippool, --apiserver-advertise-address ä¸ºæš´éœ²çš„k8sAPIè°ƒç”¨IP.
èŠ‚ç‚¹(Node)
ä¸€ä¸ªNodeæ˜¯ä¸€ä¸ªè¿è¡ŒK8sçš„ä¸»æœºï¼Œä½œä¸ºK8s worker, é€šå¸¸ç§°ä¹‹ä¸ºMinionã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œå¦‚ä¸‹K8så…³é”®ç»„ä»¶ï¼š
kubeletï¼šä¸»èŠ‚ç‚¹ä»£ç† kube-proxy: serviceä½¿ç”¨å…¶å°†é“¾æ¥è·¯ç”±åˆ°Pod docker/rocket: k8s ä½¿ç”¨å®¹å™¨æŠ€æœ¯åˆ›å»ºå®¹å™¨ å®¹å™¨ç»„(Pod)
ä¸€ä¸ªPodå¯¹åº”è‹¥å¹²å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®¹å™¨ç»„ï¼ŒåŒä¸€ä¸ªPodå†…çš„å®¹å™¨å…±äº«ä¸€ä¸ªå­˜å‚¨å·(volume)ï¼ŒåŒä¸€ä¸ªPodä¸­çš„å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œNamespace,å¯ä»¥ä½¿ç”¨localhostäº’ç›¸é€šä¿¡ã€‚
Podæ˜¯çŸ­æš‚çš„ï¼Œä¸æ˜¯æŒç»­æ€§å®ä½“ã€‚ä¸€ä¸ªPodæ˜¯ä¸€ä¸ªç‰¹å®šçš„åº”ç”¨æ‰“åŒ…é›†åˆï¼ŒåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ã€‚å’Œè¿è¡Œçš„å®¹å™¨ç±»ä¼¼ï¼Œä¸€ä¸ªPodåªæœ‰å¾ˆçŸ­çš„è¿è¡Œå‘¨æœŸã€‚Podè¢«è°ƒåº¦åˆ°ä¸€ä¸ªNodeè¿è¡Œï¼Œç›´åˆ°å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç»“æŸæˆ–è€…å…¶è¢«åˆ é™¤ã€‚
å®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸ(Pod Status)
åŒ…å«æ‰€æœ‰å®¹å™¨çŠ¶æ€é›†åˆï¼ŒåŒ…æ‹¬å®¹å™¨ç»„çŠ¶æ€ç±»å‹ï¼Œå®¹å™¨ç»„ç”Ÿå‘½å‘¨æœŸï¼Œäº‹ä»¶ï¼Œé‡å¯ç­–ç•¥ï¼Œä»¥åŠreplication controllers.
æ ‡ç­¾(labels)
æ ‡ç­¾æ˜¯ç”¨æ¥è¿æ¥ä¸€ç»„å¯¹è±¡çš„ï¼Œæ¯”å¦‚å®¹å™¨ç»„Podã€‚lableå¯ä»¥ç”¨æ¥ç»„ç»‡å’Œé€‰æ‹©å­å¯¹è±¡ã€‚ ä¸€ä¸ªLabelæ˜¯attachåˆ°Podçš„ä¸€å¯¹é”®å€¼å¯¹ï¼Œç”¨æ¥ä¼ é€’ç”¨æˆ·å®šä¹‰çš„å±æ€§ã€‚
Replication Controllers
ä¸»è¦è´Ÿè´£æŒ‡å®šæ•°é‡çš„Podåœ¨åŒä¸€æ—¶é—´ä¸€èµ·è¿è¡Œã€‚Replication controller ç¡®ä¿ä»»æ„æ—¶é—´éƒ½æœ‰æŒ‡å®šæ•°é‡çš„Podå‰¯æœ¬åœ¨è¿è¡Œã€‚å¦‚æœä¸ºæŸä¸ªPodåˆ›å»ºäº†Replication Controllerå¹¶ä¸”æŒ‡å®šä¸º3å‰¯æœ¬ï¼Œå®ƒä¼šåˆ›å»º3ä¸ªPod,å¹¶æŒç»­ç›‘æ§ä»–ä»¬ã€‚å¦‚æœæŸä¸ªPodä¸å“åº”ï¼Œé‚£ä¹ˆReplication controller ä¼šæ›¿æ¢å®ƒï¼Œä¿æŒPodæ€»æ•°ä¸º3.
å½“åˆ›å»ºReplication Controlleræ—¶ï¼Œéœ€è¦æŒ‡å®šä¸¤ä¸ªä¸œè¥¿ã€‚
Podæ¨¡æ¿ï¼š ç”¨æ¥åˆ›å»ºPodå‰¯æœ¬çš„æ¨¡æ¿ Labelï¼šReplication Controller éœ€è¦ç›‘æ§çš„Podçš„Label ç°åœ¨å·²ç»åˆ›å»ºäº†Podçš„ä¸€äº›å‰¯æœ¬ï¼Œé‚£ä¹ˆåœ¨è¿™äº›å‰¯æœ¬ä¸Šå¦‚ä½•è´Ÿè½½å‡è¡¡å‘¢ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯service
Serviceï¼š
å¦‚æœPodæ˜¯çŸ­æš‚çš„ï¼Œé‚£ä¹ˆé‡å¯æ—¶IPåœ°å€å¯èƒ½ä¼šå˜ï¼Œæ€ä¹ˆæ‰èƒ½ä»å‰ç«¯å®¹å™¨æ­£ç¡®å¯é çš„æŒ‡å‘åå°å®¹å™¨å‘¢ã€‚
Serviceæ˜¯å®šä¹‰ä¸€ç³»åˆ—Podä»¥åŠè®¿é—®è¿™äº›Podçš„ç­–ç•¥çš„ä¸€å±‚æŠ½è±¡ã€‚Serviceé€šè¿‡Labelæ‰¾åˆ°Podç»„ã€‚å› ä¸ºserviceæ˜¯æŠ½è±¡çš„ï¼Œæ‰€åœ¨åœ¨å›¾è¡¨é‡Œé€šå¸¸çœ‹ä¸åˆ°ä»–ä»¬çš„å­˜åœ¨ã€‚
ç°åœ¨å‡å®šæœ‰ä¸¤ä¸ªåå°Pod,å¹¶ä¸”å®šä¹‰åå°serviceåç§°ä¸ºâ€œbackend-serviceâ€ï¼Œlabelé€‰æ‹©å™¨ä¸º(tier=backend,app=myapp)ã€‚backend-serviceçš„Serviceä¼šå®Œæˆå¦‚ä¸‹ä¸¤ä»¶é‡è¦çš„äº‹æƒ…ï¼š
ä¼šä¸ºServiceåˆ›å»ºä¸€ä¸ªæœ¬åœ°é›†ç¾¤çš„DNSå…¥å£ï¼Œå› æ­¤å‰ç«¯åªéœ€è¦DNSæŸ¥æ‰¾ä¸»æœºåä¸ºâ€œbackend-serviceâ€å°±èƒ½å¤Ÿè§£æå‡ºå‰ç«¯åº”ç”¨ç¨‹åºå¯ç”¨çš„IPåœ°å€ ç°åœ¨å‰ç«¯å·²ç»å¾—åˆ°äº†åå°æœåŠ¡çš„IPåœ°å€ï¼Œä½†æ˜¯å®ƒåº”è¯¥è®¿é—®2ä¸ªåå°Podä¸­çš„å“ªä¸€ä¸ªå‘¢ã€‚Serviceåœ¨è¿™ä¸¤ä¸ªåå°Podä¹‹é—´æä¾›é€æ˜çš„è´Ÿè½½å‡è¡¡ï¼Œä¼šå°†è¯·æ±‚å‘ç»™å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚é€šè¿‡æ¯ä¸ªNodeä¸Šè¿è¡Œçš„ä»£ç† kube-proxyå®Œæˆã€‚ Kubernetes Master
é›†ç¾¤æ‹¥æœ‰ä¸€ä¸ªK8s Master,K8s Master æä¾›é›†ç¾¤çš„ç‹¬ç‰¹è§†è§’ï¼Œå¹¶æ‹¥æœ‰ä¸€ç³»åˆ—ç»„ä»¶ï¼Œå¦‚Kubernetes API server. API server æä¾›å¯ä»¥ç”¨æ¥å’Œé›†ç¾¤äº¤äº’çš„REST ç«¯ç‚¹ã€‚Master èŠ‚ç‚¹åŒ…å«ç”¨æ¥åˆ›å»ºå’Œå¤åˆ¶Podçš„Replication Controller.
å‚è€ƒèµ„æ–™ï¼š</p>
      </div>
      <div class="card-footer">
        <span class="float-left">January 1, 0001</span>
        <a
        href="/posts/cloudnative/Kubernates/1-k8s-overview/"
        class="float-right btn btn-outline-info btn-sm"
        >Read</a
        >
      </div>
    </div>
  </a>
</div>

        
      
    </div>
    <div class="paginator">
      
    <ul class="pagination pagination-default">
      <li class="page-item">
        <a href="/posts/" aria-label="First" class="page-link" role="button"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/18/" aria-label="Previous" class="page-link" role="button"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/17/" aria-label="Page 17" class="page-link" role="button">17</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/18/" aria-label="Page 18" class="page-link" role="button">18</a>
      </li>
      <li class="page-item active">
        <a aria-current="page" aria-label="Page 19" class="page-link" role="button">19</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/20/" aria-label="Page 20" class="page-link" role="button">20</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/21/" aria-label="Page 21" class="page-link" role="button">21</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/20/" aria-label="Next" class="page-link" role="button"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/24/" aria-label="Last" class="page-link" role="button"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul>
    </div>
  </div>
</section>


      
       
    </div>

    
    












  
  
    
  

  
  
    
  

  
  
    
  

  
  
    
    
      
    
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#about">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#skills">Skills</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#recent-posts">Recent Posts</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://airren.github.io/#achievements">My Story</a>
                </li>
              
            
              
                
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:airrenzero#gmail.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>airrenzero#gmail.com</span>
                </a></li>
              
            
              
                <li><span><i class="fas fa-phone-alt"></i></span> <span>&#43;86 1881733xxxx</span></li>
              
            
          </ul>
        </div>
        
        
        
          
          <div class="col-md-4 col-sm-12">
            <p>Stay up to date with email notification</p>
              
              <form
                action="https://github.us1.list-manage.com/subscribe/post?u=19de52a4603135aae97163fd8&amp;amp;id=094a24c76e"
                method="post"
                id="mc-embedded-subscribe-form"
                name="mc-embedded-subscribe-form"
                class="validate"
                target="_blank"
                novalidate >
                <div class="form-group">
                  <input
                    type="email"
                    class="form-control"
                    id="mce-EMAIL"
                    name="EMAIL"
                    aria-describedby="emailHelp"
                    placeholder="Enter email"
                  />
                  <small id="emailHelp" class="form-text text-muted"
                    >By entering your email address, you agree to receive the newsletter of this website.</small
                  >
                </div>
                <button type="submit" class="btn btn-info">Submit</button>
              </form>
            
          </div>
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">Â© 2020-2021 Copyright.</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>



    
    
    <script src="/js/list.js"></script>


    
</body>
</html>
